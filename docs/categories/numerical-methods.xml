<?xml version="1.0" encoding="utf-8"?>
<?xml-stylesheet type="text/xsl" href="../assets/xml/rss.xsl" media="all"?><rss version="2.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Nicolás' blog (Posts about numerical methods)</title><link>https://nicoguaro.github.io/</link><description></description><atom:link href="https://nicoguaro.github.io/categories/numerical-methods.xml" rel="self" type="application/rss+xml"></atom:link><language>en</language><copyright>Contents © 2022 &lt;a href="mailto:nicoguarin@gmail.com"&gt;Nicolás Guarín-Zapata&lt;/a&gt; 
&lt;a rel="license" href="http://creativecommons.org/licenses/by/4.0/"&gt;
&lt;img alt="Creative Commons License"
style="border-width:0"
src="https://i.creativecommons.org/l/by/4.0/88x31.png"&gt;&lt;/a&gt;</copyright><lastBuildDate>Fri, 21 Oct 2022 17:34:22 GMT</lastBuildDate><generator>Nikola (getnikola.com)</generator><docs>http://blogs.law.harvard.edu/tech/rss</docs><item><title>Coming back to the Boundary element method</title><link>https://nicoguaro.github.io/posts/bem_corrected/</link><dc:creator>Nicolás Guarín-Zapata</dc:creator><description>&lt;p&gt;During October (2017) I wrote a program per day for some well-known numerical
methods in both Python and Julia. It was intended to be an exercise to learn
some Julia. You can see a &lt;a class="reference external" href="https://nicoguaro.github.io/posts/numerical_summary"&gt;summary here&lt;/a&gt;. I succeeded
in 30 of the challenges, except for the BEM
(&lt;a class="reference external" href="https://en.wikipedia.org/wiki/Boundary_element_method"&gt;Boundary Element Method&lt;/a&gt;),
where I could not figure out what was wrong that day. The original
post is &lt;a class="reference external" href="https://nicoguaro.github.io/posts/numerical-26"&gt;here&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Thomas Klimpel found the mistake and wrote an email where he described my
mistakes. So, I am creating a new post with a correct implementation
of the BEM.&lt;/p&gt;
&lt;section id="the-boundary-element-method"&gt;
&lt;h2&gt;The Boundary Element Method&lt;/h2&gt;
&lt;p&gt;We want so solve the equation&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
\nabla^2 u = -f(x, y)\quad \forall (x, y) \in \Omega\, ,
\end{equation*}
&lt;/div&gt;
&lt;p&gt;with&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
u(x) = g(x, y), \quad \forall (x, y)\in \partial \Omega \, .
\end{equation*}
&lt;/div&gt;
&lt;p&gt;For this method, we need to use an integral representation of the equation,
that, in this case, is&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
u(\boldsymbol{\xi})  = \int_{S} [u(\mathbf{x}) F(\mathbf{x}, \boldsymbol{\xi})
    - q(\mathbf{x})G(\mathbf{x}, \boldsymbol{\xi})]\mathrm{d}S(\mathbf{x})
    + \int_{V} f(\mathbf{x}) G(\mathbf{x}, \boldsymbol{\xi}) \mathrm{d}V(\mathbf{x})
\end{equation*}
&lt;/div&gt;
&lt;p&gt;with&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
G(\mathbf{x}, \boldsymbol{\xi})= -\frac{1}{2\pi}\ln|\mathbf{x} - \xi|
\end{equation*}
&lt;/div&gt;
&lt;p&gt;and&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
F(\mathbf{x}, \boldsymbol{\xi}) =
  -\frac{1}{2\pi |\mathbf{x} - \boldsymbol{\xi}|^2}
  (\mathbf{x} - \boldsymbol{\xi})\cdot\hat{\mathbf{n}}
\end{equation*}
&lt;/div&gt;
&lt;p&gt;Then, we can form a system of equations&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
[G]\{q\} = [F]\{u\}\, ,
\end{equation*}
&lt;/div&gt;
&lt;p&gt;that we obtain by discretization of the boundary. If we take constant
variables over the discretization, the integral can be computed analytically
by&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
G_{nm} = -\frac{1}{2\pi}\left[r \sin\theta\left(\ln|r| - 1\right)
         + \theta r\cos\theta\right]^{\theta_B, r_B}_{\theta_A, r_A}
\end{equation*}
&lt;/div&gt;
&lt;p&gt;and&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
F_{nm} = \left[\frac{\theta}{2\pi}\right]^{\theta_B}_{\theta_A}
\end{equation*}
&lt;/div&gt;
&lt;p&gt;for points &lt;span class="math"&gt;\(n\)&lt;/span&gt; and &lt;span class="math"&gt;\(m\)&lt;/span&gt; in different elements, and the subindices
&lt;span class="math"&gt;\(A,B\)&lt;/span&gt; refer to the endpoints of the evaluation element. We should be
careful evaluating this expression since both &lt;span class="math"&gt;\(r_A\)&lt;/span&gt; and &lt;span class="math"&gt;\(r_B\)&lt;/span&gt; can
be (close to) zero and make it &lt;em&gt;explode&lt;/em&gt;. Also, here it was the main problem
since I forgot to compute the angles with respect to elements that are,
in general, not aligned with horizontal or vertical axes.&lt;/p&gt;
&lt;p&gt;For diagonal terms the integrals evaluate to&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
G_{nn} = -\frac{L}{2\pi}\left(\ln\left\vert\frac{L}{2}\right\vert - 1\right)
\end{equation*}
&lt;/div&gt;
&lt;p&gt;and&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
F_{nn} = - \frac{1}{2}
\end{equation*}
&lt;/div&gt;
&lt;p&gt;with &lt;span class="math"&gt;\(L\)&lt;/span&gt; the size of the element.&lt;/p&gt;
&lt;p&gt;Following is the code. Keep in mind that this code works for purely Dirichlet
problems. For mixed Dirichlet-Neumann the influence matrices would need
rearranging to separate known and unknowns in opposite sides of the equation.&lt;/p&gt;
&lt;p&gt;You can download the files for this &lt;a class="reference external" href="https://nicoguaro.github.io/downloads/bem.zip"&gt;project here&lt;/a&gt;.
It includes a YML file to create a conda environment with the dependencies
listed. For example, it uses version 3.0 of
&lt;a class="reference external" href="https://github.com/nschloe/meshio"&gt;Meshio&lt;/a&gt;.&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code python"&gt;&lt;a id="rest_code_0f17e139fda4463b9b06a9576d069e35-1" name="rest_code_0f17e139fda4463b9b06a9576d069e35-1" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_0f17e139fda4463b9b06a9576d069e35-1"&gt;&lt;/a&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;numpy&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;np&lt;/span&gt;
&lt;a id="rest_code_0f17e139fda4463b9b06a9576d069e35-2" name="rest_code_0f17e139fda4463b9b06a9576d069e35-2" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_0f17e139fda4463b9b06a9576d069e35-2"&gt;&lt;/a&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;numpy&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;log&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;arctan2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;pi&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;mean&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;arctan&lt;/span&gt;
&lt;a id="rest_code_0f17e139fda4463b9b06a9576d069e35-3" name="rest_code_0f17e139fda4463b9b06a9576d069e35-3" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_0f17e139fda4463b9b06a9576d069e35-3"&gt;&lt;/a&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;numpy.linalg&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;norm&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;solve&lt;/span&gt;
&lt;a id="rest_code_0f17e139fda4463b9b06a9576d069e35-4" name="rest_code_0f17e139fda4463b9b06a9576d069e35-4" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_0f17e139fda4463b9b06a9576d069e35-4"&gt;&lt;/a&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;matplotlib.pyplot&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;plt&lt;/span&gt;
&lt;a id="rest_code_0f17e139fda4463b9b06a9576d069e35-5" name="rest_code_0f17e139fda4463b9b06a9576d069e35-5" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_0f17e139fda4463b9b06a9576d069e35-5"&gt;&lt;/a&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;mpl_toolkits.mplot3d&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;Axes3D&lt;/span&gt;
&lt;a id="rest_code_0f17e139fda4463b9b06a9576d069e35-6" name="rest_code_0f17e139fda4463b9b06a9576d069e35-6" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_0f17e139fda4463b9b06a9576d069e35-6"&gt;&lt;/a&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;meshio&lt;/span&gt;
&lt;a id="rest_code_0f17e139fda4463b9b06a9576d069e35-7" name="rest_code_0f17e139fda4463b9b06a9576d069e35-7" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_0f17e139fda4463b9b06a9576d069e35-7"&gt;&lt;/a&gt;
&lt;a id="rest_code_0f17e139fda4463b9b06a9576d069e35-8" name="rest_code_0f17e139fda4463b9b06a9576d069e35-8" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_0f17e139fda4463b9b06a9576d069e35-8"&gt;&lt;/a&gt;
&lt;a id="rest_code_0f17e139fda4463b9b06a9576d069e35-9" name="rest_code_0f17e139fda4463b9b06a9576d069e35-9" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_0f17e139fda4463b9b06a9576d069e35-9"&gt;&lt;/a&gt;  &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;assem&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;elems&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_0f17e139fda4463b9b06a9576d069e35-10" name="rest_code_0f17e139fda4463b9b06a9576d069e35-10" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_0f17e139fda4463b9b06a9576d069e35-10"&gt;&lt;/a&gt;      &lt;span class="sd"&gt;"""Assembly matrices for the BEM problem&lt;/span&gt;
&lt;a id="rest_code_0f17e139fda4463b9b06a9576d069e35-11" name="rest_code_0f17e139fda4463b9b06a9576d069e35-11" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_0f17e139fda4463b9b06a9576d069e35-11"&gt;&lt;/a&gt;
&lt;a id="rest_code_0f17e139fda4463b9b06a9576d069e35-12" name="rest_code_0f17e139fda4463b9b06a9576d069e35-12" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_0f17e139fda4463b9b06a9576d069e35-12"&gt;&lt;/a&gt;&lt;span class="sd"&gt;      Parameters&lt;/span&gt;
&lt;a id="rest_code_0f17e139fda4463b9b06a9576d069e35-13" name="rest_code_0f17e139fda4463b9b06a9576d069e35-13" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_0f17e139fda4463b9b06a9576d069e35-13"&gt;&lt;/a&gt;&lt;span class="sd"&gt;      ----------&lt;/span&gt;
&lt;a id="rest_code_0f17e139fda4463b9b06a9576d069e35-14" name="rest_code_0f17e139fda4463b9b06a9576d069e35-14" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_0f17e139fda4463b9b06a9576d069e35-14"&gt;&lt;/a&gt;&lt;span class="sd"&gt;      coords : ndarray, float&lt;/span&gt;
&lt;a id="rest_code_0f17e139fda4463b9b06a9576d069e35-15" name="rest_code_0f17e139fda4463b9b06a9576d069e35-15" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_0f17e139fda4463b9b06a9576d069e35-15"&gt;&lt;/a&gt;&lt;span class="sd"&gt;          Coordinates for the nodes.&lt;/span&gt;
&lt;a id="rest_code_0f17e139fda4463b9b06a9576d069e35-16" name="rest_code_0f17e139fda4463b9b06a9576d069e35-16" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_0f17e139fda4463b9b06a9576d069e35-16"&gt;&lt;/a&gt;&lt;span class="sd"&gt;      elems : ndarray, int&lt;/span&gt;
&lt;a id="rest_code_0f17e139fda4463b9b06a9576d069e35-17" name="rest_code_0f17e139fda4463b9b06a9576d069e35-17" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_0f17e139fda4463b9b06a9576d069e35-17"&gt;&lt;/a&gt;&lt;span class="sd"&gt;          Connectivity for the elements.&lt;/span&gt;
&lt;a id="rest_code_0f17e139fda4463b9b06a9576d069e35-18" name="rest_code_0f17e139fda4463b9b06a9576d069e35-18" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_0f17e139fda4463b9b06a9576d069e35-18"&gt;&lt;/a&gt;
&lt;a id="rest_code_0f17e139fda4463b9b06a9576d069e35-19" name="rest_code_0f17e139fda4463b9b06a9576d069e35-19" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_0f17e139fda4463b9b06a9576d069e35-19"&gt;&lt;/a&gt;&lt;span class="sd"&gt;      Returns&lt;/span&gt;
&lt;a id="rest_code_0f17e139fda4463b9b06a9576d069e35-20" name="rest_code_0f17e139fda4463b9b06a9576d069e35-20" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_0f17e139fda4463b9b06a9576d069e35-20"&gt;&lt;/a&gt;&lt;span class="sd"&gt;      -------&lt;/span&gt;
&lt;a id="rest_code_0f17e139fda4463b9b06a9576d069e35-21" name="rest_code_0f17e139fda4463b9b06a9576d069e35-21" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_0f17e139fda4463b9b06a9576d069e35-21"&gt;&lt;/a&gt;&lt;span class="sd"&gt;      Gmat : ndarray, float&lt;/span&gt;
&lt;a id="rest_code_0f17e139fda4463b9b06a9576d069e35-22" name="rest_code_0f17e139fda4463b9b06a9576d069e35-22" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_0f17e139fda4463b9b06a9576d069e35-22"&gt;&lt;/a&gt;&lt;span class="sd"&gt;          Influence matrix for the flow.&lt;/span&gt;
&lt;a id="rest_code_0f17e139fda4463b9b06a9576d069e35-23" name="rest_code_0f17e139fda4463b9b06a9576d069e35-23" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_0f17e139fda4463b9b06a9576d069e35-23"&gt;&lt;/a&gt;&lt;span class="sd"&gt;      Fmat : ndarray, float&lt;/span&gt;
&lt;a id="rest_code_0f17e139fda4463b9b06a9576d069e35-24" name="rest_code_0f17e139fda4463b9b06a9576d069e35-24" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_0f17e139fda4463b9b06a9576d069e35-24"&gt;&lt;/a&gt;&lt;span class="sd"&gt;          Influence matrix for primary variable.&lt;/span&gt;
&lt;a id="rest_code_0f17e139fda4463b9b06a9576d069e35-25" name="rest_code_0f17e139fda4463b9b06a9576d069e35-25" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_0f17e139fda4463b9b06a9576d069e35-25"&gt;&lt;/a&gt;&lt;span class="sd"&gt;      """&lt;/span&gt;
&lt;a id="rest_code_0f17e139fda4463b9b06a9576d069e35-26" name="rest_code_0f17e139fda4463b9b06a9576d069e35-26" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_0f17e139fda4463b9b06a9576d069e35-26"&gt;&lt;/a&gt;      &lt;span class="n"&gt;nelems&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;elems&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;shape&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_0f17e139fda4463b9b06a9576d069e35-27" name="rest_code_0f17e139fda4463b9b06a9576d069e35-27" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_0f17e139fda4463b9b06a9576d069e35-27"&gt;&lt;/a&gt;      &lt;span class="n"&gt;Gmat&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="n"&gt;nelems&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;nelems&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_0f17e139fda4463b9b06a9576d069e35-28" name="rest_code_0f17e139fda4463b9b06a9576d069e35-28" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_0f17e139fda4463b9b06a9576d069e35-28"&gt;&lt;/a&gt;      &lt;span class="n"&gt;Fmat&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="n"&gt;nelems&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;nelems&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_0f17e139fda4463b9b06a9576d069e35-29" name="rest_code_0f17e139fda4463b9b06a9576d069e35-29" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_0f17e139fda4463b9b06a9576d069e35-29"&gt;&lt;/a&gt;      &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;ev_cont&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;elem1&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;enumerate&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;elems&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_0f17e139fda4463b9b06a9576d069e35-30" name="rest_code_0f17e139fda4463b9b06a9576d069e35-30" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_0f17e139fda4463b9b06a9576d069e35-30"&gt;&lt;/a&gt;          &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;col_cont&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;elem2&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;enumerate&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;elems&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_0f17e139fda4463b9b06a9576d069e35-31" name="rest_code_0f17e139fda4463b9b06a9576d069e35-31" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_0f17e139fda4463b9b06a9576d069e35-31"&gt;&lt;/a&gt;              &lt;span class="n"&gt;pt_col&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;mean&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;elem2&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;axis&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_0f17e139fda4463b9b06a9576d069e35-32" name="rest_code_0f17e139fda4463b9b06a9576d069e35-32" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_0f17e139fda4463b9b06a9576d069e35-32"&gt;&lt;/a&gt;              &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;ev_cont&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="n"&gt;col_cont&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a id="rest_code_0f17e139fda4463b9b06a9576d069e35-33" name="rest_code_0f17e139fda4463b9b06a9576d069e35-33" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_0f17e139fda4463b9b06a9576d069e35-33"&gt;&lt;/a&gt;                  &lt;span class="n"&gt;L&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;norm&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;elem1&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]]&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;elem1&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]])&lt;/span&gt;
&lt;a id="rest_code_0f17e139fda4463b9b06a9576d069e35-34" name="rest_code_0f17e139fda4463b9b06a9576d069e35-34" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_0f17e139fda4463b9b06a9576d069e35-34"&gt;&lt;/a&gt;                  &lt;span class="n"&gt;Gmat&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ev_cont&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;ev_cont&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;L&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;pi&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;log&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;L&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_0f17e139fda4463b9b06a9576d069e35-35" name="rest_code_0f17e139fda4463b9b06a9576d069e35-35" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_0f17e139fda4463b9b06a9576d069e35-35"&gt;&lt;/a&gt;                  &lt;span class="n"&gt;Fmat&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ev_cont&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;ev_cont&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="mf"&gt;0.5&lt;/span&gt;
&lt;a id="rest_code_0f17e139fda4463b9b06a9576d069e35-36" name="rest_code_0f17e139fda4463b9b06a9576d069e35-36" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_0f17e139fda4463b9b06a9576d069e35-36"&gt;&lt;/a&gt;              &lt;span class="k"&gt;else&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a id="rest_code_0f17e139fda4463b9b06a9576d069e35-37" name="rest_code_0f17e139fda4463b9b06a9576d069e35-37" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_0f17e139fda4463b9b06a9576d069e35-37"&gt;&lt;/a&gt;                  &lt;span class="n"&gt;Gij&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;Fij&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;influence_coeff&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;elem1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;pt_col&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_0f17e139fda4463b9b06a9576d069e35-38" name="rest_code_0f17e139fda4463b9b06a9576d069e35-38" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_0f17e139fda4463b9b06a9576d069e35-38"&gt;&lt;/a&gt;                  &lt;span class="n"&gt;Gmat&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ev_cont&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;col_cont&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Gij&lt;/span&gt;
&lt;a id="rest_code_0f17e139fda4463b9b06a9576d069e35-39" name="rest_code_0f17e139fda4463b9b06a9576d069e35-39" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_0f17e139fda4463b9b06a9576d069e35-39"&gt;&lt;/a&gt;                  &lt;span class="n"&gt;Fmat&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ev_cont&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;col_cont&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Fij&lt;/span&gt;
&lt;a id="rest_code_0f17e139fda4463b9b06a9576d069e35-40" name="rest_code_0f17e139fda4463b9b06a9576d069e35-40" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_0f17e139fda4463b9b06a9576d069e35-40"&gt;&lt;/a&gt;      &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;Gmat&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;Fmat&lt;/span&gt;
&lt;a id="rest_code_0f17e139fda4463b9b06a9576d069e35-41" name="rest_code_0f17e139fda4463b9b06a9576d069e35-41" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_0f17e139fda4463b9b06a9576d069e35-41"&gt;&lt;/a&gt;
&lt;a id="rest_code_0f17e139fda4463b9b06a9576d069e35-42" name="rest_code_0f17e139fda4463b9b06a9576d069e35-42" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_0f17e139fda4463b9b06a9576d069e35-42"&gt;&lt;/a&gt;
&lt;a id="rest_code_0f17e139fda4463b9b06a9576d069e35-43" name="rest_code_0f17e139fda4463b9b06a9576d069e35-43" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_0f17e139fda4463b9b06a9576d069e35-43"&gt;&lt;/a&gt;  &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;influence_coeff&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;elem&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;pt_col&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_0f17e139fda4463b9b06a9576d069e35-44" name="rest_code_0f17e139fda4463b9b06a9576d069e35-44" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_0f17e139fda4463b9b06a9576d069e35-44"&gt;&lt;/a&gt;      &lt;span class="sd"&gt;"""Compute influence coefficients&lt;/span&gt;
&lt;a id="rest_code_0f17e139fda4463b9b06a9576d069e35-45" name="rest_code_0f17e139fda4463b9b06a9576d069e35-45" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_0f17e139fda4463b9b06a9576d069e35-45"&gt;&lt;/a&gt;
&lt;a id="rest_code_0f17e139fda4463b9b06a9576d069e35-46" name="rest_code_0f17e139fda4463b9b06a9576d069e35-46" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_0f17e139fda4463b9b06a9576d069e35-46"&gt;&lt;/a&gt;&lt;span class="sd"&gt;      Parameters&lt;/span&gt;
&lt;a id="rest_code_0f17e139fda4463b9b06a9576d069e35-47" name="rest_code_0f17e139fda4463b9b06a9576d069e35-47" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_0f17e139fda4463b9b06a9576d069e35-47"&gt;&lt;/a&gt;&lt;span class="sd"&gt;      ----------&lt;/span&gt;
&lt;a id="rest_code_0f17e139fda4463b9b06a9576d069e35-48" name="rest_code_0f17e139fda4463b9b06a9576d069e35-48" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_0f17e139fda4463b9b06a9576d069e35-48"&gt;&lt;/a&gt;&lt;span class="sd"&gt;      elems : ndarray, int&lt;/span&gt;
&lt;a id="rest_code_0f17e139fda4463b9b06a9576d069e35-49" name="rest_code_0f17e139fda4463b9b06a9576d069e35-49" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_0f17e139fda4463b9b06a9576d069e35-49"&gt;&lt;/a&gt;&lt;span class="sd"&gt;          Connectivity for the elements.&lt;/span&gt;
&lt;a id="rest_code_0f17e139fda4463b9b06a9576d069e35-50" name="rest_code_0f17e139fda4463b9b06a9576d069e35-50" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_0f17e139fda4463b9b06a9576d069e35-50"&gt;&lt;/a&gt;&lt;span class="sd"&gt;      coords : ndarray, float&lt;/span&gt;
&lt;a id="rest_code_0f17e139fda4463b9b06a9576d069e35-51" name="rest_code_0f17e139fda4463b9b06a9576d069e35-51" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_0f17e139fda4463b9b06a9576d069e35-51"&gt;&lt;/a&gt;&lt;span class="sd"&gt;          Coordinates for the nodes.&lt;/span&gt;
&lt;a id="rest_code_0f17e139fda4463b9b06a9576d069e35-52" name="rest_code_0f17e139fda4463b9b06a9576d069e35-52" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_0f17e139fda4463b9b06a9576d069e35-52"&gt;&lt;/a&gt;&lt;span class="sd"&gt;      pt_col : ndarray&lt;/span&gt;
&lt;a id="rest_code_0f17e139fda4463b9b06a9576d069e35-53" name="rest_code_0f17e139fda4463b9b06a9576d069e35-53" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_0f17e139fda4463b9b06a9576d069e35-53"&gt;&lt;/a&gt;&lt;span class="sd"&gt;          Coordinates of the colocation point.&lt;/span&gt;
&lt;a id="rest_code_0f17e139fda4463b9b06a9576d069e35-54" name="rest_code_0f17e139fda4463b9b06a9576d069e35-54" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_0f17e139fda4463b9b06a9576d069e35-54"&gt;&lt;/a&gt;
&lt;a id="rest_code_0f17e139fda4463b9b06a9576d069e35-55" name="rest_code_0f17e139fda4463b9b06a9576d069e35-55" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_0f17e139fda4463b9b06a9576d069e35-55"&gt;&lt;/a&gt;&lt;span class="sd"&gt;      Returns&lt;/span&gt;
&lt;a id="rest_code_0f17e139fda4463b9b06a9576d069e35-56" name="rest_code_0f17e139fda4463b9b06a9576d069e35-56" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_0f17e139fda4463b9b06a9576d069e35-56"&gt;&lt;/a&gt;&lt;span class="sd"&gt;      -------&lt;/span&gt;
&lt;a id="rest_code_0f17e139fda4463b9b06a9576d069e35-57" name="rest_code_0f17e139fda4463b9b06a9576d069e35-57" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_0f17e139fda4463b9b06a9576d069e35-57"&gt;&lt;/a&gt;&lt;span class="sd"&gt;      G_coeff : float&lt;/span&gt;
&lt;a id="rest_code_0f17e139fda4463b9b06a9576d069e35-58" name="rest_code_0f17e139fda4463b9b06a9576d069e35-58" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_0f17e139fda4463b9b06a9576d069e35-58"&gt;&lt;/a&gt;&lt;span class="sd"&gt;          Influence coefficient for flows.&lt;/span&gt;
&lt;a id="rest_code_0f17e139fda4463b9b06a9576d069e35-59" name="rest_code_0f17e139fda4463b9b06a9576d069e35-59" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_0f17e139fda4463b9b06a9576d069e35-59"&gt;&lt;/a&gt;&lt;span class="sd"&gt;      F_coeff : float&lt;/span&gt;
&lt;a id="rest_code_0f17e139fda4463b9b06a9576d069e35-60" name="rest_code_0f17e139fda4463b9b06a9576d069e35-60" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_0f17e139fda4463b9b06a9576d069e35-60"&gt;&lt;/a&gt;&lt;span class="sd"&gt;          Influence coefficient for primary variable.&lt;/span&gt;
&lt;a id="rest_code_0f17e139fda4463b9b06a9576d069e35-61" name="rest_code_0f17e139fda4463b9b06a9576d069e35-61" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_0f17e139fda4463b9b06a9576d069e35-61"&gt;&lt;/a&gt;&lt;span class="sd"&gt;      """&lt;/span&gt;
&lt;a id="rest_code_0f17e139fda4463b9b06a9576d069e35-62" name="rest_code_0f17e139fda4463b9b06a9576d069e35-62" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_0f17e139fda4463b9b06a9576d069e35-62"&gt;&lt;/a&gt;      &lt;span class="n"&gt;dcos&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;elem&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]]&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;elem&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]]&lt;/span&gt;
&lt;a id="rest_code_0f17e139fda4463b9b06a9576d069e35-63" name="rest_code_0f17e139fda4463b9b06a9576d069e35-63" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_0f17e139fda4463b9b06a9576d069e35-63"&gt;&lt;/a&gt;      &lt;span class="n"&gt;dcos&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;dcos&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="n"&gt;norm&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;dcos&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_0f17e139fda4463b9b06a9576d069e35-64" name="rest_code_0f17e139fda4463b9b06a9576d069e35-64" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_0f17e139fda4463b9b06a9576d069e35-64"&gt;&lt;/a&gt;      &lt;span class="n"&gt;rotmat&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;([[&lt;/span&gt;&lt;span class="n"&gt;dcos&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;dcos&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]],&lt;/span&gt;
&lt;a id="rest_code_0f17e139fda4463b9b06a9576d069e35-65" name="rest_code_0f17e139fda4463b9b06a9576d069e35-65" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_0f17e139fda4463b9b06a9576d069e35-65"&gt;&lt;/a&gt;                      &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;dcos&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;dcos&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]]])&lt;/span&gt;
&lt;a id="rest_code_0f17e139fda4463b9b06a9576d069e35-66" name="rest_code_0f17e139fda4463b9b06a9576d069e35-66" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_0f17e139fda4463b9b06a9576d069e35-66"&gt;&lt;/a&gt;      &lt;span class="n"&gt;r_A&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;rotmat&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;dot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;elem&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]]&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;pt_col&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_0f17e139fda4463b9b06a9576d069e35-67" name="rest_code_0f17e139fda4463b9b06a9576d069e35-67" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_0f17e139fda4463b9b06a9576d069e35-67"&gt;&lt;/a&gt;      &lt;span class="n"&gt;r_B&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;rotmat&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;dot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;elem&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]]&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;pt_col&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_0f17e139fda4463b9b06a9576d069e35-68" name="rest_code_0f17e139fda4463b9b06a9576d069e35-68" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_0f17e139fda4463b9b06a9576d069e35-68"&gt;&lt;/a&gt;      &lt;span class="n"&gt;theta_A&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;arctan2&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;r_A&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;r_A&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_0f17e139fda4463b9b06a9576d069e35-69" name="rest_code_0f17e139fda4463b9b06a9576d069e35-69" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_0f17e139fda4463b9b06a9576d069e35-69"&gt;&lt;/a&gt;      &lt;span class="n"&gt;theta_B&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;arctan2&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;r_B&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;r_B&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_0f17e139fda4463b9b06a9576d069e35-70" name="rest_code_0f17e139fda4463b9b06a9576d069e35-70" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_0f17e139fda4463b9b06a9576d069e35-70"&gt;&lt;/a&gt;      &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;norm&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;r_A&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="mf"&gt;1e-6&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a id="rest_code_0f17e139fda4463b9b06a9576d069e35-71" name="rest_code_0f17e139fda4463b9b06a9576d069e35-71" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_0f17e139fda4463b9b06a9576d069e35-71"&gt;&lt;/a&gt;          &lt;span class="n"&gt;G_coeff&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;r_B&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;log&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;norm&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;r_B&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;theta_B&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;r_B&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_0f17e139fda4463b9b06a9576d069e35-72" name="rest_code_0f17e139fda4463b9b06a9576d069e35-72" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_0f17e139fda4463b9b06a9576d069e35-72"&gt;&lt;/a&gt;      &lt;span class="k"&gt;elif&lt;/span&gt; &lt;span class="n"&gt;norm&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;r_B&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="mf"&gt;1e-6&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a id="rest_code_0f17e139fda4463b9b06a9576d069e35-73" name="rest_code_0f17e139fda4463b9b06a9576d069e35-73" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_0f17e139fda4463b9b06a9576d069e35-73"&gt;&lt;/a&gt;          &lt;span class="n"&gt;G_coeff&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;r_A&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;log&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;norm&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;r_A&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;theta_A&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;r_A&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_0f17e139fda4463b9b06a9576d069e35-74" name="rest_code_0f17e139fda4463b9b06a9576d069e35-74" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_0f17e139fda4463b9b06a9576d069e35-74"&gt;&lt;/a&gt;      &lt;span class="k"&gt;else&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a id="rest_code_0f17e139fda4463b9b06a9576d069e35-75" name="rest_code_0f17e139fda4463b9b06a9576d069e35-75" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_0f17e139fda4463b9b06a9576d069e35-75"&gt;&lt;/a&gt;          &lt;span class="n"&gt;G_coeff&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;r_B&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;log&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;norm&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;r_B&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;theta_B&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;r_B&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;\
&lt;a id="rest_code_0f17e139fda4463b9b06a9576d069e35-76" name="rest_code_0f17e139fda4463b9b06a9576d069e35-76" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_0f17e139fda4463b9b06a9576d069e35-76"&gt;&lt;/a&gt;                  &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;r_A&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;log&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;norm&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;r_A&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;theta_A&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;r_A&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_0f17e139fda4463b9b06a9576d069e35-77" name="rest_code_0f17e139fda4463b9b06a9576d069e35-77" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_0f17e139fda4463b9b06a9576d069e35-77"&gt;&lt;/a&gt;      &lt;span class="n"&gt;F_coeff&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;theta_B&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;theta_A&lt;/span&gt;
&lt;a id="rest_code_0f17e139fda4463b9b06a9576d069e35-78" name="rest_code_0f17e139fda4463b9b06a9576d069e35-78" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_0f17e139fda4463b9b06a9576d069e35-78"&gt;&lt;/a&gt;      &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;G_coeff&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;pi&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;F_coeff&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;pi&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_0f17e139fda4463b9b06a9576d069e35-79" name="rest_code_0f17e139fda4463b9b06a9576d069e35-79" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_0f17e139fda4463b9b06a9576d069e35-79"&gt;&lt;/a&gt;
&lt;a id="rest_code_0f17e139fda4463b9b06a9576d069e35-80" name="rest_code_0f17e139fda4463b9b06a9576d069e35-80" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_0f17e139fda4463b9b06a9576d069e35-80"&gt;&lt;/a&gt;
&lt;a id="rest_code_0f17e139fda4463b9b06a9576d069e35-81" name="rest_code_0f17e139fda4463b9b06a9576d069e35-81" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_0f17e139fda4463b9b06a9576d069e35-81"&gt;&lt;/a&gt;  &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;eval_sol&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ev_coords&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;elems&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;u_boundary&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;q_boundary&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_0f17e139fda4463b9b06a9576d069e35-82" name="rest_code_0f17e139fda4463b9b06a9576d069e35-82" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_0f17e139fda4463b9b06a9576d069e35-82"&gt;&lt;/a&gt;      &lt;span class="sd"&gt;"""Evaluate the solution in a set of points&lt;/span&gt;
&lt;a id="rest_code_0f17e139fda4463b9b06a9576d069e35-83" name="rest_code_0f17e139fda4463b9b06a9576d069e35-83" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_0f17e139fda4463b9b06a9576d069e35-83"&gt;&lt;/a&gt;
&lt;a id="rest_code_0f17e139fda4463b9b06a9576d069e35-84" name="rest_code_0f17e139fda4463b9b06a9576d069e35-84" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_0f17e139fda4463b9b06a9576d069e35-84"&gt;&lt;/a&gt;&lt;span class="sd"&gt;      Parameters&lt;/span&gt;
&lt;a id="rest_code_0f17e139fda4463b9b06a9576d069e35-85" name="rest_code_0f17e139fda4463b9b06a9576d069e35-85" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_0f17e139fda4463b9b06a9576d069e35-85"&gt;&lt;/a&gt;&lt;span class="sd"&gt;      ----------&lt;/span&gt;
&lt;a id="rest_code_0f17e139fda4463b9b06a9576d069e35-86" name="rest_code_0f17e139fda4463b9b06a9576d069e35-86" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_0f17e139fda4463b9b06a9576d069e35-86"&gt;&lt;/a&gt;&lt;span class="sd"&gt;      ev_coords : ndarray, float&lt;/span&gt;
&lt;a id="rest_code_0f17e139fda4463b9b06a9576d069e35-87" name="rest_code_0f17e139fda4463b9b06a9576d069e35-87" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_0f17e139fda4463b9b06a9576d069e35-87"&gt;&lt;/a&gt;&lt;span class="sd"&gt;          Coordinates of the evaluation points.&lt;/span&gt;
&lt;a id="rest_code_0f17e139fda4463b9b06a9576d069e35-88" name="rest_code_0f17e139fda4463b9b06a9576d069e35-88" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_0f17e139fda4463b9b06a9576d069e35-88"&gt;&lt;/a&gt;&lt;span class="sd"&gt;      coords : ndarray, float&lt;/span&gt;
&lt;a id="rest_code_0f17e139fda4463b9b06a9576d069e35-89" name="rest_code_0f17e139fda4463b9b06a9576d069e35-89" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_0f17e139fda4463b9b06a9576d069e35-89"&gt;&lt;/a&gt;&lt;span class="sd"&gt;          Coordinates for the nodes.&lt;/span&gt;
&lt;a id="rest_code_0f17e139fda4463b9b06a9576d069e35-90" name="rest_code_0f17e139fda4463b9b06a9576d069e35-90" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_0f17e139fda4463b9b06a9576d069e35-90"&gt;&lt;/a&gt;&lt;span class="sd"&gt;      elems : ndarray, int&lt;/span&gt;
&lt;a id="rest_code_0f17e139fda4463b9b06a9576d069e35-91" name="rest_code_0f17e139fda4463b9b06a9576d069e35-91" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_0f17e139fda4463b9b06a9576d069e35-91"&gt;&lt;/a&gt;&lt;span class="sd"&gt;          Connectivity for the elements.&lt;/span&gt;
&lt;a id="rest_code_0f17e139fda4463b9b06a9576d069e35-92" name="rest_code_0f17e139fda4463b9b06a9576d069e35-92" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_0f17e139fda4463b9b06a9576d069e35-92"&gt;&lt;/a&gt;&lt;span class="sd"&gt;      u_boundary : ndarray, float&lt;/span&gt;
&lt;a id="rest_code_0f17e139fda4463b9b06a9576d069e35-93" name="rest_code_0f17e139fda4463b9b06a9576d069e35-93" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_0f17e139fda4463b9b06a9576d069e35-93"&gt;&lt;/a&gt;&lt;span class="sd"&gt;          Primary variable in the nodes.&lt;/span&gt;
&lt;a id="rest_code_0f17e139fda4463b9b06a9576d069e35-94" name="rest_code_0f17e139fda4463b9b06a9576d069e35-94" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_0f17e139fda4463b9b06a9576d069e35-94"&gt;&lt;/a&gt;&lt;span class="sd"&gt;      q_boundary : [type]&lt;/span&gt;
&lt;a id="rest_code_0f17e139fda4463b9b06a9576d069e35-95" name="rest_code_0f17e139fda4463b9b06a9576d069e35-95" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_0f17e139fda4463b9b06a9576d069e35-95"&gt;&lt;/a&gt;&lt;span class="sd"&gt;          Flows in the nodes.&lt;/span&gt;
&lt;a id="rest_code_0f17e139fda4463b9b06a9576d069e35-96" name="rest_code_0f17e139fda4463b9b06a9576d069e35-96" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_0f17e139fda4463b9b06a9576d069e35-96"&gt;&lt;/a&gt;
&lt;a id="rest_code_0f17e139fda4463b9b06a9576d069e35-97" name="rest_code_0f17e139fda4463b9b06a9576d069e35-97" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_0f17e139fda4463b9b06a9576d069e35-97"&gt;&lt;/a&gt;&lt;span class="sd"&gt;      Returns&lt;/span&gt;
&lt;a id="rest_code_0f17e139fda4463b9b06a9576d069e35-98" name="rest_code_0f17e139fda4463b9b06a9576d069e35-98" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_0f17e139fda4463b9b06a9576d069e35-98"&gt;&lt;/a&gt;&lt;span class="sd"&gt;      -------&lt;/span&gt;
&lt;a id="rest_code_0f17e139fda4463b9b06a9576d069e35-99" name="rest_code_0f17e139fda4463b9b06a9576d069e35-99" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_0f17e139fda4463b9b06a9576d069e35-99"&gt;&lt;/a&gt;&lt;span class="sd"&gt;      solution : ndarray, float&lt;/span&gt;
&lt;a id="rest_code_0f17e139fda4463b9b06a9576d069e35-100" name="rest_code_0f17e139fda4463b9b06a9576d069e35-100" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_0f17e139fda4463b9b06a9576d069e35-100"&gt;&lt;/a&gt;&lt;span class="sd"&gt;          Solution evaluated in the given points.&lt;/span&gt;
&lt;a id="rest_code_0f17e139fda4463b9b06a9576d069e35-101" name="rest_code_0f17e139fda4463b9b06a9576d069e35-101" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_0f17e139fda4463b9b06a9576d069e35-101"&gt;&lt;/a&gt;&lt;span class="sd"&gt;      """&lt;/span&gt;
&lt;a id="rest_code_0f17e139fda4463b9b06a9576d069e35-102" name="rest_code_0f17e139fda4463b9b06a9576d069e35-102" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_0f17e139fda4463b9b06a9576d069e35-102"&gt;&lt;/a&gt;      &lt;span class="n"&gt;npts&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;ev_coords&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;shape&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_0f17e139fda4463b9b06a9576d069e35-103" name="rest_code_0f17e139fda4463b9b06a9576d069e35-103" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_0f17e139fda4463b9b06a9576d069e35-103"&gt;&lt;/a&gt;      &lt;span class="n"&gt;solution&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;npts&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_0f17e139fda4463b9b06a9576d069e35-104" name="rest_code_0f17e139fda4463b9b06a9576d069e35-104" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_0f17e139fda4463b9b06a9576d069e35-104"&gt;&lt;/a&gt;      &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;k&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;npts&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_0f17e139fda4463b9b06a9576d069e35-105" name="rest_code_0f17e139fda4463b9b06a9576d069e35-105" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_0f17e139fda4463b9b06a9576d069e35-105"&gt;&lt;/a&gt;          &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;ev_cont&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;elem&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;enumerate&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;elems&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_0f17e139fda4463b9b06a9576d069e35-106" name="rest_code_0f17e139fda4463b9b06a9576d069e35-106" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_0f17e139fda4463b9b06a9576d069e35-106"&gt;&lt;/a&gt;              &lt;span class="n"&gt;pt_col&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;ev_coords&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;k&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_0f17e139fda4463b9b06a9576d069e35-107" name="rest_code_0f17e139fda4463b9b06a9576d069e35-107" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_0f17e139fda4463b9b06a9576d069e35-107"&gt;&lt;/a&gt;              &lt;span class="n"&gt;G&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;F&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;influence_coeff&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;elem&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;pt_col&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_0f17e139fda4463b9b06a9576d069e35-108" name="rest_code_0f17e139fda4463b9b06a9576d069e35-108" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_0f17e139fda4463b9b06a9576d069e35-108"&gt;&lt;/a&gt;              &lt;span class="n"&gt;solution&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;k&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;+=&lt;/span&gt; &lt;span class="n"&gt;u_boundary&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ev_cont&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;F&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;q_boundary&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ev_cont&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;G&lt;/span&gt;
&lt;a id="rest_code_0f17e139fda4463b9b06a9576d069e35-109" name="rest_code_0f17e139fda4463b9b06a9576d069e35-109" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_0f17e139fda4463b9b06a9576d069e35-109"&gt;&lt;/a&gt;      &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;solution&lt;/span&gt;
&lt;a id="rest_code_0f17e139fda4463b9b06a9576d069e35-110" name="rest_code_0f17e139fda4463b9b06a9576d069e35-110" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_0f17e139fda4463b9b06a9576d069e35-110"&gt;&lt;/a&gt;
&lt;a id="rest_code_0f17e139fda4463b9b06a9576d069e35-111" name="rest_code_0f17e139fda4463b9b06a9576d069e35-111" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_0f17e139fda4463b9b06a9576d069e35-111"&gt;&lt;/a&gt;
&lt;a id="rest_code_0f17e139fda4463b9b06a9576d069e35-112" name="rest_code_0f17e139fda4463b9b06a9576d069e35-112" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_0f17e139fda4463b9b06a9576d069e35-112"&gt;&lt;/a&gt;&lt;span class="c1"&gt;#%% Simulation&lt;/span&gt;
&lt;a id="rest_code_0f17e139fda4463b9b06a9576d069e35-113" name="rest_code_0f17e139fda4463b9b06a9576d069e35-113" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_0f17e139fda4463b9b06a9576d069e35-113"&gt;&lt;/a&gt;&lt;span class="n"&gt;mesh&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;meshio&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;read&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"disk.msh"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_0f17e139fda4463b9b06a9576d069e35-114" name="rest_code_0f17e139fda4463b9b06a9576d069e35-114" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_0f17e139fda4463b9b06a9576d069e35-114"&gt;&lt;/a&gt;&lt;span class="n"&gt;elems&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;mesh&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;cells&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;"line"&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_0f17e139fda4463b9b06a9576d069e35-115" name="rest_code_0f17e139fda4463b9b06a9576d069e35-115" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_0f17e139fda4463b9b06a9576d069e35-115"&gt;&lt;/a&gt;&lt;span class="n"&gt;bound_nodes&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;list&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;set&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;elems&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;flatten&lt;/span&gt;&lt;span class="p"&gt;()))&lt;/span&gt;
&lt;a id="rest_code_0f17e139fda4463b9b06a9576d069e35-116" name="rest_code_0f17e139fda4463b9b06a9576d069e35-116" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_0f17e139fda4463b9b06a9576d069e35-116"&gt;&lt;/a&gt;&lt;span class="n"&gt;coords&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;mesh&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;points&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;bound_nodes&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_0f17e139fda4463b9b06a9576d069e35-117" name="rest_code_0f17e139fda4463b9b06a9576d069e35-117" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_0f17e139fda4463b9b06a9576d069e35-117"&gt;&lt;/a&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;y&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;T&lt;/span&gt;
&lt;a id="rest_code_0f17e139fda4463b9b06a9576d069e35-118" name="rest_code_0f17e139fda4463b9b06a9576d069e35-118" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_0f17e139fda4463b9b06a9576d069e35-118"&gt;&lt;/a&gt;&lt;span class="n"&gt;x_m&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;y_m&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;0.5&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;elems&lt;/span&gt;&lt;span class="p"&gt;[:,&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]]&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;elems&lt;/span&gt;&lt;span class="p"&gt;[:,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]])&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;T&lt;/span&gt;
&lt;a id="rest_code_0f17e139fda4463b9b06a9576d069e35-119" name="rest_code_0f17e139fda4463b9b06a9576d069e35-119" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_0f17e139fda4463b9b06a9576d069e35-119"&gt;&lt;/a&gt;&lt;span class="n"&gt;theta&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;arctan2&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;y_m&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;x_m&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_0f17e139fda4463b9b06a9576d069e35-120" name="rest_code_0f17e139fda4463b9b06a9576d069e35-120" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_0f17e139fda4463b9b06a9576d069e35-120"&gt;&lt;/a&gt;&lt;span class="n"&gt;u_boundary&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;cos&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;6&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;theta&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_0f17e139fda4463b9b06a9576d069e35-121" name="rest_code_0f17e139fda4463b9b06a9576d069e35-121" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_0f17e139fda4463b9b06a9576d069e35-121"&gt;&lt;/a&gt;
&lt;a id="rest_code_0f17e139fda4463b9b06a9576d069e35-122" name="rest_code_0f17e139fda4463b9b06a9576d069e35-122" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_0f17e139fda4463b9b06a9576d069e35-122"&gt;&lt;/a&gt;
&lt;a id="rest_code_0f17e139fda4463b9b06a9576d069e35-123" name="rest_code_0f17e139fda4463b9b06a9576d069e35-123" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_0f17e139fda4463b9b06a9576d069e35-123"&gt;&lt;/a&gt;&lt;span class="c1"&gt;#%% Assembly&lt;/span&gt;
&lt;a id="rest_code_0f17e139fda4463b9b06a9576d069e35-124" name="rest_code_0f17e139fda4463b9b06a9576d069e35-124" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_0f17e139fda4463b9b06a9576d069e35-124"&gt;&lt;/a&gt;&lt;span class="n"&gt;Gmat&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;Fmat&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;assem&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;elems&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_0f17e139fda4463b9b06a9576d069e35-125" name="rest_code_0f17e139fda4463b9b06a9576d069e35-125" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_0f17e139fda4463b9b06a9576d069e35-125"&gt;&lt;/a&gt;
&lt;a id="rest_code_0f17e139fda4463b9b06a9576d069e35-126" name="rest_code_0f17e139fda4463b9b06a9576d069e35-126" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_0f17e139fda4463b9b06a9576d069e35-126"&gt;&lt;/a&gt;&lt;span class="c1"&gt;#%% Solution&lt;/span&gt;
&lt;a id="rest_code_0f17e139fda4463b9b06a9576d069e35-127" name="rest_code_0f17e139fda4463b9b06a9576d069e35-127" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_0f17e139fda4463b9b06a9576d069e35-127"&gt;&lt;/a&gt;&lt;span class="n"&gt;q_boundary&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;solve&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Gmat&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;Fmat&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;dot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;u_boundary&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_0f17e139fda4463b9b06a9576d069e35-128" name="rest_code_0f17e139fda4463b9b06a9576d069e35-128" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_0f17e139fda4463b9b06a9576d069e35-128"&gt;&lt;/a&gt;
&lt;a id="rest_code_0f17e139fda4463b9b06a9576d069e35-129" name="rest_code_0f17e139fda4463b9b06a9576d069e35-129" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_0f17e139fda4463b9b06a9576d069e35-129"&gt;&lt;/a&gt;&lt;span class="c1"&gt;#%% Evaluation&lt;/span&gt;
&lt;a id="rest_code_0f17e139fda4463b9b06a9576d069e35-130" name="rest_code_0f17e139fda4463b9b06a9576d069e35-130" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_0f17e139fda4463b9b06a9576d069e35-130"&gt;&lt;/a&gt;&lt;span class="n"&gt;ev_coords&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt;  &lt;span class="n"&gt;mesh&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;points&lt;/span&gt;&lt;span class="p"&gt;[:,&lt;/span&gt; &lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_0f17e139fda4463b9b06a9576d069e35-131" name="rest_code_0f17e139fda4463b9b06a9576d069e35-131" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_0f17e139fda4463b9b06a9576d069e35-131"&gt;&lt;/a&gt;&lt;span class="n"&gt;ev_x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;ev_y&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;ev_coords&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;T&lt;/span&gt;
&lt;a id="rest_code_0f17e139fda4463b9b06a9576d069e35-132" name="rest_code_0f17e139fda4463b9b06a9576d069e35-132" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_0f17e139fda4463b9b06a9576d069e35-132"&gt;&lt;/a&gt;&lt;span class="n"&gt;solution&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;eval_sol&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ev_coords&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;elems&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;u_boundary&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;q_boundary&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_0f17e139fda4463b9b06a9576d069e35-133" name="rest_code_0f17e139fda4463b9b06a9576d069e35-133" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_0f17e139fda4463b9b06a9576d069e35-133"&gt;&lt;/a&gt;
&lt;a id="rest_code_0f17e139fda4463b9b06a9576d069e35-134" name="rest_code_0f17e139fda4463b9b06a9576d069e35-134" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_0f17e139fda4463b9b06a9576d069e35-134"&gt;&lt;/a&gt;&lt;span class="c1"&gt;#%% Visualization&lt;/span&gt;
&lt;a id="rest_code_0f17e139fda4463b9b06a9576d069e35-135" name="rest_code_0f17e139fda4463b9b06a9576d069e35-135" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_0f17e139fda4463b9b06a9576d069e35-135"&gt;&lt;/a&gt;&lt;span class="n"&gt;tris&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;mesh&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;cells&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;"triangle"&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_0f17e139fda4463b9b06a9576d069e35-136" name="rest_code_0f17e139fda4463b9b06a9576d069e35-136" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_0f17e139fda4463b9b06a9576d069e35-136"&gt;&lt;/a&gt;&lt;span class="n"&gt;fig&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;figure&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a id="rest_code_0f17e139fda4463b9b06a9576d069e35-137" name="rest_code_0f17e139fda4463b9b06a9576d069e35-137" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_0f17e139fda4463b9b06a9576d069e35-137"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;fig&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;add_subplot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;111&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;projection&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'3d'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_0f17e139fda4463b9b06a9576d069e35-138" name="rest_code_0f17e139fda4463b9b06a9576d069e35-138" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_0f17e139fda4463b9b06a9576d069e35-138"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;plot_trisurf&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ev_x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;ev_y&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;solution&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;cmap&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;"RdYlBu"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;lw&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mf"&gt;0.3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;a id="rest_code_0f17e139fda4463b9b06a9576d069e35-139" name="rest_code_0f17e139fda4463b9b06a9576d069e35-139" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_0f17e139fda4463b9b06a9576d069e35-139"&gt;&lt;/a&gt;                &lt;span class="n"&gt;edgecolor&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;"#3c3c3c"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_0f17e139fda4463b9b06a9576d069e35-140" name="rest_code_0f17e139fda4463b9b06a9576d069e35-140" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_0f17e139fda4463b9b06a9576d069e35-140"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xticks&lt;/span&gt;&lt;span class="p"&gt;([])&lt;/span&gt;
&lt;a id="rest_code_0f17e139fda4463b9b06a9576d069e35-141" name="rest_code_0f17e139fda4463b9b06a9576d069e35-141" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_0f17e139fda4463b9b06a9576d069e35-141"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;yticks&lt;/span&gt;&lt;span class="p"&gt;([])&lt;/span&gt;
&lt;a id="rest_code_0f17e139fda4463b9b06a9576d069e35-142" name="rest_code_0f17e139fda4463b9b06a9576d069e35-142" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_0f17e139fda4463b9b06a9576d069e35-142"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_zticks&lt;/span&gt;&lt;span class="p"&gt;([])&lt;/span&gt;
&lt;a id="rest_code_0f17e139fda4463b9b06a9576d069e35-143" name="rest_code_0f17e139fda4463b9b06a9576d069e35-143" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_0f17e139fda4463b9b06a9576d069e35-143"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;savefig&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"bem_solution.png"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;bbox_inches&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;"tight"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;transparent&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;True&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;a id="rest_code_0f17e139fda4463b9b06a9576d069e35-144" name="rest_code_0f17e139fda4463b9b06a9576d069e35-144" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_0f17e139fda4463b9b06a9576d069e35-144"&gt;&lt;/a&gt;            &lt;span class="n"&gt;dpi&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;300&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;The result in this case is the following.&lt;/p&gt;
&lt;img alt="Solution of the differential equation using the BEM." class="align-center" src="https://nicoguaro.github.io/images/bem_solution.png" style="width: 600px;"&gt;
&lt;/section&gt;</description><category>boundary element method</category><category>numerical methods</category><category>python</category><category>scientific computing</category><guid>https://nicoguaro.github.io/posts/bem_corrected/</guid><pubDate>Mon, 22 Feb 2021 15:00:00 GMT</pubDate></item><item><title>Numerical methods challenge: Summary</title><link>https://nicoguaro.github.io/posts/numerical_challenge/numerical_summary/</link><dc:creator>Nicolás Guarín-Zapata</dc:creator><description>&lt;p&gt;During October (2017) I wrote a program per day for some well-known numerical
methods in both Python and Julia. It was intended to be an exercise, then don't
expect the code to be good enough for real use. Also, I should mention that I
had almost no experience with Julia, so it probably is not idiomatic Julia but
more Python-like Julia.&lt;/p&gt;
&lt;section id="summary"&gt;
&lt;h2&gt;Summary&lt;/h2&gt;
&lt;p&gt;This post is a summary of that challenge. For the source code you can check
&lt;a class="reference external" href="https://github.com/nicoguaro/numerical_challenge_2017"&gt;the repository&lt;/a&gt;.&lt;/p&gt;
&lt;section id="the-verdict"&gt;
&lt;h3&gt;The verdict&lt;/h3&gt;
&lt;p&gt;Since the challenge is with myself, and the main purpose was to learn some
Julia the verdict is: &lt;strong&gt;success&lt;/strong&gt;. Nevertheless, I failed during day 26
with the Boundary Element Method.&lt;/p&gt;
&lt;/section&gt;
&lt;section id="the-list-of-methods"&gt;
&lt;h3&gt;The list of methods&lt;/h3&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;&lt;th class="head"&gt;&lt;p&gt;Day&lt;/p&gt;&lt;/th&gt;
&lt;th class="head"&gt;&lt;p&gt;Numerical method&lt;/p&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;&lt;td&gt;&lt;p&gt;&lt;a class="reference external" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-01"&gt;01&lt;/a&gt;&lt;/p&gt;&lt;/td&gt;
&lt;td&gt;&lt;p&gt;Bisection&lt;/p&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;&lt;p&gt;&lt;a class="reference external" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-02"&gt;02&lt;/a&gt;&lt;/p&gt;&lt;/td&gt;
&lt;td&gt;&lt;p&gt;Regula falsi&lt;/p&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;&lt;p&gt;&lt;a class="reference external" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-03"&gt;03&lt;/a&gt;&lt;/p&gt;&lt;/td&gt;
&lt;td&gt;&lt;p&gt;Newton&lt;/p&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;&lt;p&gt;&lt;a class="reference external" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-04"&gt;04&lt;/a&gt;&lt;/p&gt;&lt;/td&gt;
&lt;td&gt;&lt;p&gt;Newton multivariate&lt;/p&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;&lt;p&gt;&lt;a class="reference external" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-05"&gt;05&lt;/a&gt;&lt;/p&gt;&lt;/td&gt;
&lt;td&gt;&lt;p&gt;Broyden&lt;/p&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;&lt;p&gt;&lt;a class="reference external" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-06"&gt;06&lt;/a&gt;&lt;/p&gt;&lt;/td&gt;
&lt;td&gt;&lt;p&gt;Gradient descent&lt;/p&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;&lt;p&gt;&lt;a class="reference external" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-07"&gt;07&lt;/a&gt;&lt;/p&gt;&lt;/td&gt;
&lt;td&gt;&lt;p&gt;Nelder-Mead&lt;/p&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;&lt;p&gt;&lt;a class="reference external" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-08"&gt;08&lt;/a&gt;&lt;/p&gt;&lt;/td&gt;
&lt;td&gt;&lt;p&gt;Newton for optimization&lt;/p&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;&lt;p&gt;&lt;a class="reference external" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-09"&gt;09&lt;/a&gt;&lt;/p&gt;&lt;/td&gt;
&lt;td&gt;&lt;p&gt;Lagrange interpolation&lt;/p&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;&lt;p&gt;&lt;a class="reference external" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-10"&gt;10&lt;/a&gt;&lt;/p&gt;&lt;/td&gt;
&lt;td&gt;&lt;p&gt;Lagrange interpolation with Lobatto sampling&lt;/p&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;&lt;p&gt;&lt;a class="reference external" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-11"&gt;11&lt;/a&gt;&lt;/p&gt;&lt;/td&gt;
&lt;td&gt;&lt;p&gt;Lagrange interpolation using Vandermonde matrix&lt;/p&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;&lt;p&gt;&lt;a class="reference external" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-12"&gt;12&lt;/a&gt;&lt;/p&gt;&lt;/td&gt;
&lt;td&gt;&lt;p&gt;Hermite interpolation&lt;/p&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;&lt;p&gt;&lt;a class="reference external" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-13"&gt;13&lt;/a&gt;&lt;/p&gt;&lt;/td&gt;
&lt;td&gt;&lt;p&gt;Spline interpolation&lt;/p&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;&lt;p&gt;&lt;a class="reference external" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-14"&gt;14&lt;/a&gt;&lt;/p&gt;&lt;/td&gt;
&lt;td&gt;&lt;p&gt;Trapezoid quadrature&lt;/p&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;&lt;p&gt;&lt;a class="reference external" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-15"&gt;15&lt;/a&gt;&lt;/p&gt;&lt;/td&gt;
&lt;td&gt;&lt;p&gt;Simpson quadrature&lt;/p&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;&lt;p&gt;&lt;a class="reference external" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-16"&gt;16&lt;/a&gt;&lt;/p&gt;&lt;/td&gt;
&lt;td&gt;&lt;p&gt;Clenshaw-Curtis quadrature&lt;/p&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;&lt;p&gt;&lt;a class="reference external" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-17"&gt;17&lt;/a&gt;&lt;/p&gt;&lt;/td&gt;
&lt;td&gt;&lt;p&gt;Euler integration&lt;/p&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;&lt;p&gt;&lt;a class="reference external" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-18"&gt;18&lt;/a&gt;&lt;/p&gt;&lt;/td&gt;
&lt;td&gt;&lt;p&gt;Runge-Kutta integration&lt;/p&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;&lt;p&gt;&lt;a class="reference external" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-19"&gt;19&lt;/a&gt;&lt;/p&gt;&lt;/td&gt;
&lt;td&gt;&lt;p&gt;Verlet integration&lt;/p&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;&lt;p&gt;&lt;a class="reference external" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-20"&gt;20&lt;/a&gt;&lt;/p&gt;&lt;/td&gt;
&lt;td&gt;&lt;p&gt;Shooting method&lt;/p&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;&lt;p&gt;&lt;a class="reference external" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-21"&gt;21&lt;/a&gt;&lt;/p&gt;&lt;/td&gt;
&lt;td&gt;&lt;p&gt;Finite differences with Jacobi method&lt;/p&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;&lt;p&gt;&lt;a class="reference external" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-22"&gt;22&lt;/a&gt;&lt;/p&gt;&lt;/td&gt;
&lt;td&gt;&lt;p&gt;Finite differences for eigenvalues&lt;/p&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;&lt;p&gt;&lt;a class="reference external" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-23"&gt;23&lt;/a&gt;&lt;/p&gt;&lt;/td&gt;
&lt;td&gt;&lt;p&gt;Ritz method&lt;/p&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;&lt;p&gt;&lt;a class="reference external" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24"&gt;24&lt;/a&gt;&lt;/p&gt;&lt;/td&gt;
&lt;td&gt;&lt;p&gt;Finite element method in 1D&lt;/p&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;&lt;p&gt;&lt;a class="reference external" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25"&gt;25&lt;/a&gt;&lt;/p&gt;&lt;/td&gt;
&lt;td&gt;&lt;p&gt;Finite element method in 2D&lt;/p&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;&lt;p&gt;&lt;a class="reference external" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-26"&gt;26&lt;/a&gt;&lt;/p&gt;&lt;/td&gt;
&lt;td&gt;&lt;p&gt;Boundary element method&lt;/p&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;&lt;p&gt;&lt;a class="reference external" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-27"&gt;27&lt;/a&gt;&lt;/p&gt;&lt;/td&gt;
&lt;td&gt;&lt;p&gt;Monte-Carlo integration&lt;/p&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;&lt;p&gt;&lt;a class="reference external" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-28"&gt;28&lt;/a&gt;&lt;/p&gt;&lt;/td&gt;
&lt;td&gt;&lt;p&gt;LU factorization&lt;/p&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;&lt;p&gt;&lt;a class="reference external" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-29"&gt;29&lt;/a&gt;&lt;/p&gt;&lt;/td&gt;
&lt;td&gt;&lt;p&gt;Cholesky factorization&lt;/p&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;&lt;p&gt;&lt;a class="reference external" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30"&gt;30&lt;/a&gt;&lt;/p&gt;&lt;/td&gt;
&lt;td&gt;&lt;p&gt;Conjugate gradient&lt;/p&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;&lt;p&gt;&lt;a class="reference external" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31"&gt;31&lt;/a&gt;&lt;/p&gt;&lt;/td&gt;
&lt;td&gt;&lt;p&gt;Finite element method with solver&lt;/p&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;/section&gt;
&lt;section id="conclusions"&gt;
&lt;h3&gt;Conclusions&lt;/h3&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;This was an exercise of code-kata to learn some of the details of Julia for
scientific computing. As such, it was really useful for me to get my hands
dirty with Julia.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Implementing the Boundary Element Method in one day seems to be rough. I
knew this beforehand, but I gave it a try anyways … without succcess.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Julia syntax is somewhat in a sweetspot between Python and MATLAB. This makes
it really easy to use, although the documentation of some packages is at
an arcane stage right now.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;I won't take a challenge like this in a while. It takes a lot of atttention
to get it done.&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/section&gt;
&lt;/section&gt;</description><category>julia</category><category>numerical methods</category><category>python</category><category>scientific computing</category><guid>https://nicoguaro.github.io/posts/numerical_challenge/numerical_summary/</guid><pubDate>Tue, 14 Nov 2017 16:22:23 GMT</pubDate></item><item><title>Numerical methods challenge: Day 31</title><link>https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/</link><dc:creator>Nicolás Guarín-Zapata</dc:creator><description>&lt;p&gt;During October (2017) I wrote a program per day for some well-known
numerical methods in both Python and Julia. It was intended to be an exercise,
then don't expect the code to be good enough for real use. Also,
I should mention that I had almost no experience with Julia, so it
probably is not idiomatic Julia but more Python-like Julia.&lt;/p&gt;
&lt;section id="putting-some-things-together"&gt;
&lt;h2&gt;Putting some things together&lt;/h2&gt;
&lt;p&gt;Today, I am putting some things together, namely, I am going to solve the
system of equations that results in the finite element using the conjugate
gradient.&lt;/p&gt;
&lt;p&gt;Following are the codes&lt;/p&gt;
&lt;section id="python"&gt;
&lt;h3&gt;Python&lt;/h3&gt;
&lt;div class="code"&gt;&lt;pre class="code python"&gt;&lt;a id="rest_code_3154a174caf147928a6d07c572330899-1" name="rest_code_3154a174caf147928a6d07c572330899-1" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_3154a174caf147928a6d07c572330899-1"&gt;&lt;/a&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;__future__&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;division&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;print_function&lt;/span&gt;
&lt;a id="rest_code_3154a174caf147928a6d07c572330899-2" name="rest_code_3154a174caf147928a6d07c572330899-2" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_3154a174caf147928a6d07c572330899-2"&gt;&lt;/a&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;numpy&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;np&lt;/span&gt;
&lt;a id="rest_code_3154a174caf147928a6d07c572330899-3" name="rest_code_3154a174caf147928a6d07c572330899-3" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_3154a174caf147928a6d07c572330899-3"&gt;&lt;/a&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;matplotlib.pyplot&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;plt&lt;/span&gt;
&lt;a id="rest_code_3154a174caf147928a6d07c572330899-4" name="rest_code_3154a174caf147928a6d07c572330899-4" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_3154a174caf147928a6d07c572330899-4"&gt;&lt;/a&gt;
&lt;a id="rest_code_3154a174caf147928a6d07c572330899-5" name="rest_code_3154a174caf147928a6d07c572330899-5" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_3154a174caf147928a6d07c572330899-5"&gt;&lt;/a&gt;
&lt;a id="rest_code_3154a174caf147928a6d07c572330899-6" name="rest_code_3154a174caf147928a6d07c572330899-6" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_3154a174caf147928a6d07c572330899-6"&gt;&lt;/a&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;FEM1D&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;source&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_3154a174caf147928a6d07c572330899-7" name="rest_code_3154a174caf147928a6d07c572330899-7" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_3154a174caf147928a6d07c572330899-7"&gt;&lt;/a&gt;    &lt;span class="n"&gt;N&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_3154a174caf147928a6d07c572330899-8" name="rest_code_3154a174caf147928a6d07c572330899-8" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_3154a174caf147928a6d07c572330899-8"&gt;&lt;/a&gt;    &lt;span class="n"&gt;stiff_loc&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;([[&lt;/span&gt;&lt;span class="mf"&gt;2.0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;2.0&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;2.0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;2.0&lt;/span&gt;&lt;span class="p"&gt;]])&lt;/span&gt;
&lt;a id="rest_code_3154a174caf147928a6d07c572330899-9" name="rest_code_3154a174caf147928a6d07c572330899-9" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_3154a174caf147928a6d07c572330899-9"&gt;&lt;/a&gt;    &lt;span class="n"&gt;eles&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="n"&gt;cont&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;cont&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;cont&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;N&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)]&lt;/span&gt;
&lt;a id="rest_code_3154a174caf147928a6d07c572330899-10" name="rest_code_3154a174caf147928a6d07c572330899-10" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_3154a174caf147928a6d07c572330899-10"&gt;&lt;/a&gt;    &lt;span class="n"&gt;stiff&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_3154a174caf147928a6d07c572330899-11" name="rest_code_3154a174caf147928a6d07c572330899-11" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_3154a174caf147928a6d07c572330899-11"&gt;&lt;/a&gt;    &lt;span class="n"&gt;rhs&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_3154a174caf147928a6d07c572330899-12" name="rest_code_3154a174caf147928a6d07c572330899-12" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_3154a174caf147928a6d07c572330899-12"&gt;&lt;/a&gt;    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;ele&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;eles&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a id="rest_code_3154a174caf147928a6d07c572330899-13" name="rest_code_3154a174caf147928a6d07c572330899-13" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_3154a174caf147928a6d07c572330899-13"&gt;&lt;/a&gt;        &lt;span class="n"&gt;jaco&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ele&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]]&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ele&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]]&lt;/span&gt;
&lt;a id="rest_code_3154a174caf147928a6d07c572330899-14" name="rest_code_3154a174caf147928a6d07c572330899-14" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_3154a174caf147928a6d07c572330899-14"&gt;&lt;/a&gt;        &lt;span class="n"&gt;rhs&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ele&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;rhs&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ele&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;jaco&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;source&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ele&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_3154a174caf147928a6d07c572330899-15" name="rest_code_3154a174caf147928a6d07c572330899-15" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_3154a174caf147928a6d07c572330899-15"&gt;&lt;/a&gt;        &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;cont1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;row&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;enumerate&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ele&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_3154a174caf147928a6d07c572330899-16" name="rest_code_3154a174caf147928a6d07c572330899-16" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_3154a174caf147928a6d07c572330899-16"&gt;&lt;/a&gt;            &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;cont2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;col&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;enumerate&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ele&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_3154a174caf147928a6d07c572330899-17" name="rest_code_3154a174caf147928a6d07c572330899-17" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_3154a174caf147928a6d07c572330899-17"&gt;&lt;/a&gt;                &lt;span class="n"&gt;stiff&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;row&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;stiff&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;row&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt;  &lt;span class="n"&gt;stiff_loc&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;cont1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;cont2&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;jaco&lt;/span&gt;
&lt;a id="rest_code_3154a174caf147928a6d07c572330899-18" name="rest_code_3154a174caf147928a6d07c572330899-18" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_3154a174caf147928a6d07c572330899-18"&gt;&lt;/a&gt;    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;stiff&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;rhs&lt;/span&gt;
&lt;a id="rest_code_3154a174caf147928a6d07c572330899-19" name="rest_code_3154a174caf147928a6d07c572330899-19" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_3154a174caf147928a6d07c572330899-19"&gt;&lt;/a&gt;
&lt;a id="rest_code_3154a174caf147928a6d07c572330899-20" name="rest_code_3154a174caf147928a6d07c572330899-20" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_3154a174caf147928a6d07c572330899-20"&gt;&lt;/a&gt;
&lt;a id="rest_code_3154a174caf147928a6d07c572330899-21" name="rest_code_3154a174caf147928a6d07c572330899-21" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_3154a174caf147928a6d07c572330899-21"&gt;&lt;/a&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;conj_grad&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;tol&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mf"&gt;1e-8&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_3154a174caf147928a6d07c572330899-22" name="rest_code_3154a174caf147928a6d07c572330899-22" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_3154a174caf147928a6d07c572330899-22"&gt;&lt;/a&gt;    &lt;span class="n"&gt;r&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;b&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;dot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_3154a174caf147928a6d07c572330899-23" name="rest_code_3154a174caf147928a6d07c572330899-23" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_3154a174caf147928a6d07c572330899-23"&gt;&lt;/a&gt;    &lt;span class="n"&gt;p&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;r&lt;/span&gt;
&lt;a id="rest_code_3154a174caf147928a6d07c572330899-24" name="rest_code_3154a174caf147928a6d07c572330899-24" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_3154a174caf147928a6d07c572330899-24"&gt;&lt;/a&gt;    &lt;span class="n"&gt;rsq_old&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;dot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_3154a174caf147928a6d07c572330899-25" name="rest_code_3154a174caf147928a6d07c572330899-25" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_3154a174caf147928a6d07c572330899-25"&gt;&lt;/a&gt;    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;cont&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;)):&lt;/span&gt;
&lt;a id="rest_code_3154a174caf147928a6d07c572330899-26" name="rest_code_3154a174caf147928a6d07c572330899-26" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_3154a174caf147928a6d07c572330899-26"&gt;&lt;/a&gt;        &lt;span class="n"&gt;Ap&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;dot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_3154a174caf147928a6d07c572330899-27" name="rest_code_3154a174caf147928a6d07c572330899-27" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_3154a174caf147928a6d07c572330899-27"&gt;&lt;/a&gt;        &lt;span class="n"&gt;alpha&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;rsq_old&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;dot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Ap&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_3154a174caf147928a6d07c572330899-28" name="rest_code_3154a174caf147928a6d07c572330899-28" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_3154a174caf147928a6d07c572330899-28"&gt;&lt;/a&gt;        &lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;alpha&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;p&lt;/span&gt;
&lt;a id="rest_code_3154a174caf147928a6d07c572330899-29" name="rest_code_3154a174caf147928a6d07c572330899-29" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_3154a174caf147928a6d07c572330899-29"&gt;&lt;/a&gt;        &lt;span class="n"&gt;r&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;r&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;alpha&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;Ap&lt;/span&gt;
&lt;a id="rest_code_3154a174caf147928a6d07c572330899-30" name="rest_code_3154a174caf147928a6d07c572330899-30" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_3154a174caf147928a6d07c572330899-30"&gt;&lt;/a&gt;        &lt;span class="n"&gt;rsq_new&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;dot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_3154a174caf147928a6d07c572330899-31" name="rest_code_3154a174caf147928a6d07c572330899-31" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_3154a174caf147928a6d07c572330899-31"&gt;&lt;/a&gt;        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sqrt&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;rsq_new&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;tol&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a id="rest_code_3154a174caf147928a6d07c572330899-32" name="rest_code_3154a174caf147928a6d07c572330899-32" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_3154a174caf147928a6d07c572330899-32"&gt;&lt;/a&gt;            &lt;span class="k"&gt;break&lt;/span&gt;
&lt;a id="rest_code_3154a174caf147928a6d07c572330899-33" name="rest_code_3154a174caf147928a6d07c572330899-33" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_3154a174caf147928a6d07c572330899-33"&gt;&lt;/a&gt;        &lt;span class="n"&gt;p&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;r&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;rsq_new&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="n"&gt;rsq_old&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;p&lt;/span&gt;
&lt;a id="rest_code_3154a174caf147928a6d07c572330899-34" name="rest_code_3154a174caf147928a6d07c572330899-34" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_3154a174caf147928a6d07c572330899-34"&gt;&lt;/a&gt;        &lt;span class="n"&gt;rsq_old&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;rsq_new&lt;/span&gt;
&lt;a id="rest_code_3154a174caf147928a6d07c572330899-35" name="rest_code_3154a174caf147928a6d07c572330899-35" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_3154a174caf147928a6d07c572330899-35"&gt;&lt;/a&gt;    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;cont&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sqrt&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;rsq_new&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_3154a174caf147928a6d07c572330899-36" name="rest_code_3154a174caf147928a6d07c572330899-36" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_3154a174caf147928a6d07c572330899-36"&gt;&lt;/a&gt;
&lt;a id="rest_code_3154a174caf147928a6d07c572330899-37" name="rest_code_3154a174caf147928a6d07c572330899-37" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_3154a174caf147928a6d07c572330899-37"&gt;&lt;/a&gt;
&lt;a id="rest_code_3154a174caf147928a6d07c572330899-38" name="rest_code_3154a174caf147928a6d07c572330899-38" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_3154a174caf147928a6d07c572330899-38"&gt;&lt;/a&gt;&lt;span class="n"&gt;fun&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;lambda&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;
&lt;a id="rest_code_3154a174caf147928a6d07c572330899-39" name="rest_code_3154a174caf147928a6d07c572330899-39" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_3154a174caf147928a6d07c572330899-39"&gt;&lt;/a&gt;&lt;span class="n"&gt;N_vec&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;logspace&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;0.5&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;50&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;dtype&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nb"&gt;int&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_3154a174caf147928a6d07c572330899-40" name="rest_code_3154a174caf147928a6d07c572330899-40" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_3154a174caf147928a6d07c572330899-40"&gt;&lt;/a&gt;&lt;span class="n"&gt;err_vec&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros_like&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N_vec&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;dtype&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nb"&gt;float&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_3154a174caf147928a6d07c572330899-41" name="rest_code_3154a174caf147928a6d07c572330899-41" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_3154a174caf147928a6d07c572330899-41"&gt;&lt;/a&gt;&lt;span class="n"&gt;niter_vec&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros_like&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N_vec&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_3154a174caf147928a6d07c572330899-42" name="rest_code_3154a174caf147928a6d07c572330899-42" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_3154a174caf147928a6d07c572330899-42"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;figure&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;figsize&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;8&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_3154a174caf147928a6d07c572330899-43" name="rest_code_3154a174caf147928a6d07c572330899-43" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_3154a174caf147928a6d07c572330899-43"&gt;&lt;/a&gt;&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;cont&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;N&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;enumerate&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N_vec&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_3154a174caf147928a6d07c572330899-44" name="rest_code_3154a174caf147928a6d07c572330899-44" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_3154a174caf147928a6d07c572330899-44"&gt;&lt;/a&gt;    &lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;linspace&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_3154a174caf147928a6d07c572330899-45" name="rest_code_3154a174caf147928a6d07c572330899-45" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_3154a174caf147928a6d07c572330899-45"&gt;&lt;/a&gt;    &lt;span class="n"&gt;stiff&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;rhs&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;FEM1D&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;fun&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_3154a174caf147928a6d07c572330899-46" name="rest_code_3154a174caf147928a6d07c572330899-46" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_3154a174caf147928a6d07c572330899-46"&gt;&lt;/a&gt;    &lt;span class="n"&gt;sol&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_3154a174caf147928a6d07c572330899-47" name="rest_code_3154a174caf147928a6d07c572330899-47" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_3154a174caf147928a6d07c572330899-47"&gt;&lt;/a&gt;    &lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;niter&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;_&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;conj_grad&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;stiff&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;rhs&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;rhs&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_3154a174caf147928a6d07c572330899-48" name="rest_code_3154a174caf147928a6d07c572330899-48" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_3154a174caf147928a6d07c572330899-48"&gt;&lt;/a&gt;    &lt;span class="n"&gt;err&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;linalg&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;norm&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;sol&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="mi"&gt;20&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;linalg&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;norm&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="mi"&gt;20&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_3154a174caf147928a6d07c572330899-49" name="rest_code_3154a174caf147928a6d07c572330899-49" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_3154a174caf147928a6d07c572330899-49"&gt;&lt;/a&gt;    &lt;span class="n"&gt;err_vec&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;cont&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;err&lt;/span&gt;
&lt;a id="rest_code_3154a174caf147928a6d07c572330899-50" name="rest_code_3154a174caf147928a6d07c572330899-50" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_3154a174caf147928a6d07c572330899-50"&gt;&lt;/a&gt;    &lt;span class="n"&gt;niter_vec&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;cont&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;niter&lt;/span&gt;
&lt;a id="rest_code_3154a174caf147928a6d07c572330899-51" name="rest_code_3154a174caf147928a6d07c572330899-51" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_3154a174caf147928a6d07c572330899-51"&gt;&lt;/a&gt;
&lt;a id="rest_code_3154a174caf147928a6d07c572330899-52" name="rest_code_3154a174caf147928a6d07c572330899-52" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_3154a174caf147928a6d07c572330899-52"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;subplot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;121&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_3154a174caf147928a6d07c572330899-53" name="rest_code_3154a174caf147928a6d07c572330899-53" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_3154a174caf147928a6d07c572330899-53"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;loglog&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N_vec&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;err_vec&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_3154a174caf147928a6d07c572330899-54" name="rest_code_3154a174caf147928a6d07c572330899-54" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_3154a174caf147928a6d07c572330899-54"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"Number of nodes"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_3154a174caf147928a6d07c572330899-55" name="rest_code_3154a174caf147928a6d07c572330899-55" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_3154a174caf147928a6d07c572330899-55"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ylabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"Relative error"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_3154a174caf147928a6d07c572330899-56" name="rest_code_3154a174caf147928a6d07c572330899-56" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_3154a174caf147928a6d07c572330899-56"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;subplot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;122&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_3154a174caf147928a6d07c572330899-57" name="rest_code_3154a174caf147928a6d07c572330899-57" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_3154a174caf147928a6d07c572330899-57"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;loglog&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N_vec&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;niter_vec&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_3154a174caf147928a6d07c572330899-58" name="rest_code_3154a174caf147928a6d07c572330899-58" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_3154a174caf147928a6d07c572330899-58"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"Number of nodes"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_3154a174caf147928a6d07c572330899-59" name="rest_code_3154a174caf147928a6d07c572330899-59" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_3154a174caf147928a6d07c572330899-59"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ylabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"Number of iterations"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_3154a174caf147928a6d07c572330899-60" name="rest_code_3154a174caf147928a6d07c572330899-60" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_3154a174caf147928a6d07c572330899-60"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;tight_layout&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a id="rest_code_3154a174caf147928a6d07c572330899-61" name="rest_code_3154a174caf147928a6d07c572330899-61" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_3154a174caf147928a6d07c572330899-61"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;show&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/section&gt;
&lt;section id="julia"&gt;
&lt;h3&gt;Julia&lt;/h3&gt;
&lt;div class="code"&gt;&lt;pre class="code julia"&gt;&lt;a id="rest_code_5ed1587c67024447878df9c32cca0b6e-1" name="rest_code_5ed1587c67024447878df9c32cca0b6e-1" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_5ed1587c67024447878df9c32cca0b6e-1"&gt;&lt;/a&gt;&lt;span class="k"&gt;using&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;PyPlot&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_5ed1587c67024447878df9c32cca0b6e-2" name="rest_code_5ed1587c67024447878df9c32cca0b6e-2" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_5ed1587c67024447878df9c32cca0b6e-2"&gt;&lt;/a&gt;
&lt;a id="rest_code_5ed1587c67024447878df9c32cca0b6e-3" name="rest_code_5ed1587c67024447878df9c32cca0b6e-3" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_5ed1587c67024447878df9c32cca0b6e-3"&gt;&lt;/a&gt;
&lt;a id="rest_code_5ed1587c67024447878df9c32cca0b6e-4" name="rest_code_5ed1587c67024447878df9c32cca0b6e-4" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_5ed1587c67024447878df9c32cca0b6e-4"&gt;&lt;/a&gt;&lt;span class="k"&gt;function&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;FEM1D&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;source&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_5ed1587c67024447878df9c32cca0b6e-5" name="rest_code_5ed1587c67024447878df9c32cca0b6e-5" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_5ed1587c67024447878df9c32cca0b6e-5"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;length&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_5ed1587c67024447878df9c32cca0b6e-6" name="rest_code_5ed1587c67024447878df9c32cca0b6e-6" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_5ed1587c67024447878df9c32cca0b6e-6"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;stiff_loc&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mf"&gt;2.0&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;2.0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;2.0&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;2.0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_5ed1587c67024447878df9c32cca0b6e-7" name="rest_code_5ed1587c67024447878df9c32cca0b6e-7" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_5ed1587c67024447878df9c32cca0b6e-7"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;eles&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;[[&lt;/span&gt;&lt;span class="n"&gt;cont&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;cont&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;for&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;cont&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;in&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_5ed1587c67024447878df9c32cca0b6e-8" name="rest_code_5ed1587c67024447878df9c32cca0b6e-8" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_5ed1587c67024447878df9c32cca0b6e-8"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;stiff&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_5ed1587c67024447878df9c32cca0b6e-9" name="rest_code_5ed1587c67024447878df9c32cca0b6e-9" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_5ed1587c67024447878df9c32cca0b6e-9"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;rhs&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_5ed1587c67024447878df9c32cca0b6e-10" name="rest_code_5ed1587c67024447878df9c32cca0b6e-10" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_5ed1587c67024447878df9c32cca0b6e-10"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;for&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ele&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;in&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;eles&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_5ed1587c67024447878df9c32cca0b6e-11" name="rest_code_5ed1587c67024447878df9c32cca0b6e-11" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_5ed1587c67024447878df9c32cca0b6e-11"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;jaco&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ele&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;]]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ele&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]]&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_5ed1587c67024447878df9c32cca0b6e-12" name="rest_code_5ed1587c67024447878df9c32cca0b6e-12" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_5ed1587c67024447878df9c32cca0b6e-12"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;rhs&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ele&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;rhs&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ele&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;jaco&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;source&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ele&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_5ed1587c67024447878df9c32cca0b6e-13" name="rest_code_5ed1587c67024447878df9c32cca0b6e-13" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_5ed1587c67024447878df9c32cca0b6e-13"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;stiff&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ele&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ele&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;stiff&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ele&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ele&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;stiff_loc&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;jaco&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_5ed1587c67024447878df9c32cca0b6e-14" name="rest_code_5ed1587c67024447878df9c32cca0b6e-14" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_5ed1587c67024447878df9c32cca0b6e-14"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;end&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_5ed1587c67024447878df9c32cca0b6e-15" name="rest_code_5ed1587c67024447878df9c32cca0b6e-15" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_5ed1587c67024447878df9c32cca0b6e-15"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;return&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;stiff&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;rhs&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_5ed1587c67024447878df9c32cca0b6e-16" name="rest_code_5ed1587c67024447878df9c32cca0b6e-16" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_5ed1587c67024447878df9c32cca0b6e-16"&gt;&lt;/a&gt;&lt;span class="k"&gt;end&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_5ed1587c67024447878df9c32cca0b6e-17" name="rest_code_5ed1587c67024447878df9c32cca0b6e-17" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_5ed1587c67024447878df9c32cca0b6e-17"&gt;&lt;/a&gt;
&lt;a id="rest_code_5ed1587c67024447878df9c32cca0b6e-18" name="rest_code_5ed1587c67024447878df9c32cca0b6e-18" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_5ed1587c67024447878df9c32cca0b6e-18"&gt;&lt;/a&gt;
&lt;a id="rest_code_5ed1587c67024447878df9c32cca0b6e-19" name="rest_code_5ed1587c67024447878df9c32cca0b6e-19" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_5ed1587c67024447878df9c32cca0b6e-19"&gt;&lt;/a&gt;&lt;span class="k"&gt;function&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;conj_grad&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;tol&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mf"&gt;1e-8&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_5ed1587c67024447878df9c32cca0b6e-20" name="rest_code_5ed1587c67024447878df9c32cca0b6e-20" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_5ed1587c67024447878df9c32cca0b6e-20"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_5ed1587c67024447878df9c32cca0b6e-21" name="rest_code_5ed1587c67024447878df9c32cca0b6e-21" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_5ed1587c67024447878df9c32cca0b6e-21"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_5ed1587c67024447878df9c32cca0b6e-22" name="rest_code_5ed1587c67024447878df9c32cca0b6e-22" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_5ed1587c67024447878df9c32cca0b6e-22"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;rsq_old&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;dot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_5ed1587c67024447878df9c32cca0b6e-23" name="rest_code_5ed1587c67024447878df9c32cca0b6e-23" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_5ed1587c67024447878df9c32cca0b6e-23"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;niter&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_5ed1587c67024447878df9c32cca0b6e-24" name="rest_code_5ed1587c67024447878df9c32cca0b6e-24" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_5ed1587c67024447878df9c32cca0b6e-24"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;for&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;cont&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="n"&gt;length&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_5ed1587c67024447878df9c32cca0b6e-25" name="rest_code_5ed1587c67024447878df9c32cca0b6e-25" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_5ed1587c67024447878df9c32cca0b6e-25"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;Ap&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_5ed1587c67024447878df9c32cca0b6e-26" name="rest_code_5ed1587c67024447878df9c32cca0b6e-26" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_5ed1587c67024447878df9c32cca0b6e-26"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;alpha&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;rsq_old&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;dot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Ap&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_5ed1587c67024447878df9c32cca0b6e-27" name="rest_code_5ed1587c67024447878df9c32cca0b6e-27" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_5ed1587c67024447878df9c32cca0b6e-27"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;alpha&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_5ed1587c67024447878df9c32cca0b6e-28" name="rest_code_5ed1587c67024447878df9c32cca0b6e-28" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_5ed1587c67024447878df9c32cca0b6e-28"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;alpha&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;Ap&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_5ed1587c67024447878df9c32cca0b6e-29" name="rest_code_5ed1587c67024447878df9c32cca0b6e-29" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_5ed1587c67024447878df9c32cca0b6e-29"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;rsq_new&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;dot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_5ed1587c67024447878df9c32cca0b6e-30" name="rest_code_5ed1587c67024447878df9c32cca0b6e-30" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_5ed1587c67024447878df9c32cca0b6e-30"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;sqrt&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;rsq_new&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;tol&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_5ed1587c67024447878df9c32cca0b6e-31" name="rest_code_5ed1587c67024447878df9c32cca0b6e-31" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_5ed1587c67024447878df9c32cca0b6e-31"&gt;&lt;/a&gt;&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="k"&gt;break&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_5ed1587c67024447878df9c32cca0b6e-32" name="rest_code_5ed1587c67024447878df9c32cca0b6e-32" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_5ed1587c67024447878df9c32cca0b6e-32"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="k"&gt;end&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_5ed1587c67024447878df9c32cca0b6e-33" name="rest_code_5ed1587c67024447878df9c32cca0b6e-33" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_5ed1587c67024447878df9c32cca0b6e-33"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;rsq_new&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;rsq_old&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_5ed1587c67024447878df9c32cca0b6e-34" name="rest_code_5ed1587c67024447878df9c32cca0b6e-34" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_5ed1587c67024447878df9c32cca0b6e-34"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;rsq_old&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;rsq_new&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_5ed1587c67024447878df9c32cca0b6e-35" name="rest_code_5ed1587c67024447878df9c32cca0b6e-35" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_5ed1587c67024447878df9c32cca0b6e-35"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;niter&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_5ed1587c67024447878df9c32cca0b6e-36" name="rest_code_5ed1587c67024447878df9c32cca0b6e-36" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_5ed1587c67024447878df9c32cca0b6e-36"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;end&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_5ed1587c67024447878df9c32cca0b6e-37" name="rest_code_5ed1587c67024447878df9c32cca0b6e-37" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_5ed1587c67024447878df9c32cca0b6e-37"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;return&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;niter&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;norm&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_5ed1587c67024447878df9c32cca0b6e-38" name="rest_code_5ed1587c67024447878df9c32cca0b6e-38" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_5ed1587c67024447878df9c32cca0b6e-38"&gt;&lt;/a&gt;&lt;span class="k"&gt;end&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_5ed1587c67024447878df9c32cca0b6e-39" name="rest_code_5ed1587c67024447878df9c32cca0b6e-39" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_5ed1587c67024447878df9c32cca0b6e-39"&gt;&lt;/a&gt;
&lt;a id="rest_code_5ed1587c67024447878df9c32cca0b6e-40" name="rest_code_5ed1587c67024447878df9c32cca0b6e-40" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_5ed1587c67024447878df9c32cca0b6e-40"&gt;&lt;/a&gt;
&lt;a id="rest_code_5ed1587c67024447878df9c32cca0b6e-41" name="rest_code_5ed1587c67024447878df9c32cca0b6e-41" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_5ed1587c67024447878df9c32cca0b6e-41"&gt;&lt;/a&gt;
&lt;a id="rest_code_5ed1587c67024447878df9c32cca0b6e-42" name="rest_code_5ed1587c67024447878df9c32cca0b6e-42" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_5ed1587c67024447878df9c32cca0b6e-42"&gt;&lt;/a&gt;&lt;span class="n"&gt;fun&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;.^&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_5ed1587c67024447878df9c32cca0b6e-43" name="rest_code_5ed1587c67024447878df9c32cca0b6e-43" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_5ed1587c67024447878df9c32cca0b6e-43"&gt;&lt;/a&gt;&lt;span class="n"&gt;N_vec&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;round&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;logspace&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;0.5&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;50&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_5ed1587c67024447878df9c32cca0b6e-44" name="rest_code_5ed1587c67024447878df9c32cca0b6e-44" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_5ed1587c67024447878df9c32cca0b6e-44"&gt;&lt;/a&gt;&lt;span class="n"&gt;err_vec&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N_vec&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_5ed1587c67024447878df9c32cca0b6e-45" name="rest_code_5ed1587c67024447878df9c32cca0b6e-45" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_5ed1587c67024447878df9c32cca0b6e-45"&gt;&lt;/a&gt;&lt;span class="n"&gt;niter_vec&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N_vec&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_5ed1587c67024447878df9c32cca0b6e-46" name="rest_code_5ed1587c67024447878df9c32cca0b6e-46" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_5ed1587c67024447878df9c32cca0b6e-46"&gt;&lt;/a&gt;&lt;span class="n"&gt;figure&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;figsize&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;8&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_5ed1587c67024447878df9c32cca0b6e-47" name="rest_code_5ed1587c67024447878df9c32cca0b6e-47" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_5ed1587c67024447878df9c32cca0b6e-47"&gt;&lt;/a&gt;&lt;span class="k"&gt;for&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;cont&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;in&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;enumerate&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N_vec&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_5ed1587c67024447878df9c32cca0b6e-48" name="rest_code_5ed1587c67024447878df9c32cca0b6e-48" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_5ed1587c67024447878df9c32cca0b6e-48"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;linspace&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;0.0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;1.0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_5ed1587c67024447878df9c32cca0b6e-49" name="rest_code_5ed1587c67024447878df9c32cca0b6e-49" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_5ed1587c67024447878df9c32cca0b6e-49"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;stiff&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;rhs&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;FEM1D&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;fun&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_5ed1587c67024447878df9c32cca0b6e-50" name="rest_code_5ed1587c67024447878df9c32cca0b6e-50" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_5ed1587c67024447878df9c32cca0b6e-50"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_5ed1587c67024447878df9c32cca0b6e-51" name="rest_code_5ed1587c67024447878df9c32cca0b6e-51" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_5ed1587c67024447878df9c32cca0b6e-51"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="k"&gt;end&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;niter&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;_&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;conj_grad&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;stiff&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="k"&gt;end&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="k"&gt;end&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_5ed1587c67024447878df9c32cca0b6e-52" name="rest_code_5ed1587c67024447878df9c32cca0b6e-52" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_5ed1587c67024447878df9c32cca0b6e-52"&gt;&lt;/a&gt;&lt;span class="w"&gt;                                &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;rhs&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="k"&gt;end&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;rhs&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="k"&gt;end&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_5ed1587c67024447878df9c32cca0b6e-53" name="rest_code_5ed1587c67024447878df9c32cca0b6e-53" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_5ed1587c67024447878df9c32cca0b6e-53"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;err&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;norm&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;.*&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;.^&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="mi"&gt;20&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;norm&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;.*&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;.^&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="mi"&gt;20&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_5ed1587c67024447878df9c32cca0b6e-54" name="rest_code_5ed1587c67024447878df9c32cca0b6e-54" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_5ed1587c67024447878df9c32cca0b6e-54"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;err_vec&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;cont&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;err&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_5ed1587c67024447878df9c32cca0b6e-55" name="rest_code_5ed1587c67024447878df9c32cca0b6e-55" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_5ed1587c67024447878df9c32cca0b6e-55"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;niter_vec&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;cont&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;niter&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_5ed1587c67024447878df9c32cca0b6e-56" name="rest_code_5ed1587c67024447878df9c32cca0b6e-56" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_5ed1587c67024447878df9c32cca0b6e-56"&gt;&lt;/a&gt;&lt;span class="k"&gt;end&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_5ed1587c67024447878df9c32cca0b6e-57" name="rest_code_5ed1587c67024447878df9c32cca0b6e-57" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_5ed1587c67024447878df9c32cca0b6e-57"&gt;&lt;/a&gt;&lt;span class="n"&gt;subplot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;121&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_5ed1587c67024447878df9c32cca0b6e-58" name="rest_code_5ed1587c67024447878df9c32cca0b6e-58" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_5ed1587c67024447878df9c32cca0b6e-58"&gt;&lt;/a&gt;&lt;span class="n"&gt;loglog&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N_vec&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;err_vec&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_5ed1587c67024447878df9c32cca0b6e-59" name="rest_code_5ed1587c67024447878df9c32cca0b6e-59" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_5ed1587c67024447878df9c32cca0b6e-59"&gt;&lt;/a&gt;&lt;span class="n"&gt;xlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;"Number of nodes"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_5ed1587c67024447878df9c32cca0b6e-60" name="rest_code_5ed1587c67024447878df9c32cca0b6e-60" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_5ed1587c67024447878df9c32cca0b6e-60"&gt;&lt;/a&gt;&lt;span class="n"&gt;ylabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;"Relative error"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_5ed1587c67024447878df9c32cca0b6e-61" name="rest_code_5ed1587c67024447878df9c32cca0b6e-61" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_5ed1587c67024447878df9c32cca0b6e-61"&gt;&lt;/a&gt;&lt;span class="n"&gt;subplot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;122&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_5ed1587c67024447878df9c32cca0b6e-62" name="rest_code_5ed1587c67024447878df9c32cca0b6e-62" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_5ed1587c67024447878df9c32cca0b6e-62"&gt;&lt;/a&gt;&lt;span class="n"&gt;loglog&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N_vec&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;niter_vec&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_5ed1587c67024447878df9c32cca0b6e-63" name="rest_code_5ed1587c67024447878df9c32cca0b6e-63" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_5ed1587c67024447878df9c32cca0b6e-63"&gt;&lt;/a&gt;&lt;span class="n"&gt;xlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;"Number of nodes"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_5ed1587c67024447878df9c32cca0b6e-64" name="rest_code_5ed1587c67024447878df9c32cca0b6e-64" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_5ed1587c67024447878df9c32cca0b6e-64"&gt;&lt;/a&gt;&lt;span class="n"&gt;ylabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;"Number of iterations"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_5ed1587c67024447878df9c32cca0b6e-65" name="rest_code_5ed1587c67024447878df9c32cca0b6e-65" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_5ed1587c67024447878df9c32cca0b6e-65"&gt;&lt;/a&gt;&lt;span class="n"&gt;tight_layout&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_5ed1587c67024447878df9c32cca0b6e-66" name="rest_code_5ed1587c67024447878df9c32cca0b6e-66" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_5ed1587c67024447878df9c32cca0b6e-66"&gt;&lt;/a&gt;&lt;span class="n"&gt;show&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;In this case, we are analyzing the error of the solution as a function
of the number of nodes. This, and the number of iterations required
in the conjugate gradient are shown in the following image&lt;/p&gt;
&lt;img alt="Relative error in the solution." class="align-center" src="https://nicoguaro.github.io/images/FEM1D_convergence.svg" style="width: 800px;"&gt;
&lt;/section&gt;
&lt;/section&gt;</description><category>conjugate gradient</category><category>finite element method</category><category>julia</category><category>numerical methods</category><category>python</category><category>scientific computing</category><guid>https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/</guid><pubDate>Wed, 01 Nov 2017 01:45:09 GMT</pubDate></item><item><title>Numerical methods challenge: Day 30</title><link>https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/</link><dc:creator>Nicolás Guarín-Zapata</dc:creator><description>&lt;p&gt;During October (2017) I will write a program per day for some well-known
numerical methods in both Python and Julia. It is intended to be an exercise
then don't expect the code to be good enough for real use. Also,
I should mention that I have almost no experience with Julia, so it
probably won't be idiomatic Julia but more Python-like Julia.&lt;/p&gt;
&lt;section id="conjugate-gradient"&gt;
&lt;h2&gt;Conjugate gradient&lt;/h2&gt;
&lt;p&gt;Today we have the &lt;a class="reference external" href="https://en.wikipedia.org/wiki/Conjugate_gradient_method"&gt;conjugate gradient method&lt;/a&gt;.
This method is commonly used to solve positive-definite linear systems of
equations. Compared with gradient descent, we choose as descent direction
a direction that is conjugated with the residual, that is, it is
orthogonal with the matrix as weighting.&lt;/p&gt;
&lt;p&gt;Following are the codes&lt;/p&gt;
&lt;section id="python"&gt;
&lt;h3&gt;Python&lt;/h3&gt;
&lt;div class="code"&gt;&lt;pre class="code python"&gt;&lt;a id="rest_code_4f7266360aed421f96ec9112a2634d64-1" name="rest_code_4f7266360aed421f96ec9112a2634d64-1" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_4f7266360aed421f96ec9112a2634d64-1"&gt;&lt;/a&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;__future__&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;division&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;print_function&lt;/span&gt;
&lt;a id="rest_code_4f7266360aed421f96ec9112a2634d64-2" name="rest_code_4f7266360aed421f96ec9112a2634d64-2" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_4f7266360aed421f96ec9112a2634d64-2"&gt;&lt;/a&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;numpy&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;np&lt;/span&gt;
&lt;a id="rest_code_4f7266360aed421f96ec9112a2634d64-3" name="rest_code_4f7266360aed421f96ec9112a2634d64-3" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_4f7266360aed421f96ec9112a2634d64-3"&gt;&lt;/a&gt;
&lt;a id="rest_code_4f7266360aed421f96ec9112a2634d64-4" name="rest_code_4f7266360aed421f96ec9112a2634d64-4" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_4f7266360aed421f96ec9112a2634d64-4"&gt;&lt;/a&gt;
&lt;a id="rest_code_4f7266360aed421f96ec9112a2634d64-5" name="rest_code_4f7266360aed421f96ec9112a2634d64-5" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_4f7266360aed421f96ec9112a2634d64-5"&gt;&lt;/a&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;conj_grad&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;tol&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mf"&gt;1e-8&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_4f7266360aed421f96ec9112a2634d64-6" name="rest_code_4f7266360aed421f96ec9112a2634d64-6" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_4f7266360aed421f96ec9112a2634d64-6"&gt;&lt;/a&gt;    &lt;span class="n"&gt;r&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;b&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;dot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_4f7266360aed421f96ec9112a2634d64-7" name="rest_code_4f7266360aed421f96ec9112a2634d64-7" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_4f7266360aed421f96ec9112a2634d64-7"&gt;&lt;/a&gt;    &lt;span class="n"&gt;p&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;r&lt;/span&gt;
&lt;a id="rest_code_4f7266360aed421f96ec9112a2634d64-8" name="rest_code_4f7266360aed421f96ec9112a2634d64-8" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_4f7266360aed421f96ec9112a2634d64-8"&gt;&lt;/a&gt;    &lt;span class="n"&gt;rsq_old&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;dot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_4f7266360aed421f96ec9112a2634d64-9" name="rest_code_4f7266360aed421f96ec9112a2634d64-9" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_4f7266360aed421f96ec9112a2634d64-9"&gt;&lt;/a&gt;    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;cont&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;)):&lt;/span&gt;
&lt;a id="rest_code_4f7266360aed421f96ec9112a2634d64-10" name="rest_code_4f7266360aed421f96ec9112a2634d64-10" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_4f7266360aed421f96ec9112a2634d64-10"&gt;&lt;/a&gt;        &lt;span class="n"&gt;Ap&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;dot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_4f7266360aed421f96ec9112a2634d64-11" name="rest_code_4f7266360aed421f96ec9112a2634d64-11" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_4f7266360aed421f96ec9112a2634d64-11"&gt;&lt;/a&gt;        &lt;span class="n"&gt;alpha&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;rsq_old&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;dot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Ap&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_4f7266360aed421f96ec9112a2634d64-12" name="rest_code_4f7266360aed421f96ec9112a2634d64-12" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_4f7266360aed421f96ec9112a2634d64-12"&gt;&lt;/a&gt;        &lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;alpha&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;p&lt;/span&gt;
&lt;a id="rest_code_4f7266360aed421f96ec9112a2634d64-13" name="rest_code_4f7266360aed421f96ec9112a2634d64-13" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_4f7266360aed421f96ec9112a2634d64-13"&gt;&lt;/a&gt;        &lt;span class="n"&gt;r&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;r&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;alpha&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;Ap&lt;/span&gt;
&lt;a id="rest_code_4f7266360aed421f96ec9112a2634d64-14" name="rest_code_4f7266360aed421f96ec9112a2634d64-14" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_4f7266360aed421f96ec9112a2634d64-14"&gt;&lt;/a&gt;        &lt;span class="n"&gt;rsq_new&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;dot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_4f7266360aed421f96ec9112a2634d64-15" name="rest_code_4f7266360aed421f96ec9112a2634d64-15" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_4f7266360aed421f96ec9112a2634d64-15"&gt;&lt;/a&gt;        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sqrt&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;rsq_new&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;tol&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a id="rest_code_4f7266360aed421f96ec9112a2634d64-16" name="rest_code_4f7266360aed421f96ec9112a2634d64-16" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_4f7266360aed421f96ec9112a2634d64-16"&gt;&lt;/a&gt;            &lt;span class="k"&gt;break&lt;/span&gt;
&lt;a id="rest_code_4f7266360aed421f96ec9112a2634d64-17" name="rest_code_4f7266360aed421f96ec9112a2634d64-17" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_4f7266360aed421f96ec9112a2634d64-17"&gt;&lt;/a&gt;        &lt;span class="n"&gt;p&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;r&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;rsq_new&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="n"&gt;rsq_old&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;p&lt;/span&gt;
&lt;a id="rest_code_4f7266360aed421f96ec9112a2634d64-18" name="rest_code_4f7266360aed421f96ec9112a2634d64-18" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_4f7266360aed421f96ec9112a2634d64-18"&gt;&lt;/a&gt;        &lt;span class="n"&gt;rsq_old&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;rsq_new&lt;/span&gt;
&lt;a id="rest_code_4f7266360aed421f96ec9112a2634d64-19" name="rest_code_4f7266360aed421f96ec9112a2634d64-19" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_4f7266360aed421f96ec9112a2634d64-19"&gt;&lt;/a&gt;    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;cont&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sqrt&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;rsq_new&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_4f7266360aed421f96ec9112a2634d64-20" name="rest_code_4f7266360aed421f96ec9112a2634d64-20" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_4f7266360aed421f96ec9112a2634d64-20"&gt;&lt;/a&gt;
&lt;a id="rest_code_4f7266360aed421f96ec9112a2634d64-21" name="rest_code_4f7266360aed421f96ec9112a2634d64-21" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_4f7266360aed421f96ec9112a2634d64-21"&gt;&lt;/a&gt;
&lt;a id="rest_code_4f7266360aed421f96ec9112a2634d64-22" name="rest_code_4f7266360aed421f96ec9112a2634d64-22" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_4f7266360aed421f96ec9112a2634d64-22"&gt;&lt;/a&gt;&lt;span class="n"&gt;N&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;1000&lt;/span&gt;
&lt;a id="rest_code_4f7266360aed421f96ec9112a2634d64-23" name="rest_code_4f7266360aed421f96ec9112a2634d64-23" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_4f7266360aed421f96ec9112a2634d64-23"&gt;&lt;/a&gt;&lt;span class="n"&gt;A&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;diag&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ones&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;diag&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ones&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt;\
&lt;a id="rest_code_4f7266360aed421f96ec9112a2634d64-24" name="rest_code_4f7266360aed421f96ec9112a2634d64-24" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_4f7266360aed421f96ec9112a2634d64-24"&gt;&lt;/a&gt;    &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;diag&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ones&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_4f7266360aed421f96ec9112a2634d64-25" name="rest_code_4f7266360aed421f96ec9112a2634d64-25" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_4f7266360aed421f96ec9112a2634d64-25"&gt;&lt;/a&gt;&lt;span class="n"&gt;b&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ones&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_4f7266360aed421f96ec9112a2634d64-26" name="rest_code_4f7266360aed421f96ec9112a2634d64-26" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_4f7266360aed421f96ec9112a2634d64-26"&gt;&lt;/a&gt;&lt;span class="n"&gt;x0&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ones&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_4f7266360aed421f96ec9112a2634d64-27" name="rest_code_4f7266360aed421f96ec9112a2634d64-27" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_4f7266360aed421f96ec9112a2634d64-27"&gt;&lt;/a&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;niter&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;accu&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;conj_grad&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;x0&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/section&gt;
&lt;section id="julia"&gt;
&lt;h3&gt;Julia&lt;/h3&gt;
&lt;div class="code"&gt;&lt;pre class="code julia"&gt;&lt;a id="rest_code_03bad472ba9f4c149bf93c856c972995-1" name="rest_code_03bad472ba9f4c149bf93c856c972995-1" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_03bad472ba9f4c149bf93c856c972995-1"&gt;&lt;/a&gt;&lt;span class="k"&gt;function&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;conj_grad&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;tol&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mf"&gt;1e-8&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_03bad472ba9f4c149bf93c856c972995-2" name="rest_code_03bad472ba9f4c149bf93c856c972995-2" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_03bad472ba9f4c149bf93c856c972995-2"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_03bad472ba9f4c149bf93c856c972995-3" name="rest_code_03bad472ba9f4c149bf93c856c972995-3" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_03bad472ba9f4c149bf93c856c972995-3"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_03bad472ba9f4c149bf93c856c972995-4" name="rest_code_03bad472ba9f4c149bf93c856c972995-4" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_03bad472ba9f4c149bf93c856c972995-4"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;rsq_old&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;dot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_03bad472ba9f4c149bf93c856c972995-5" name="rest_code_03bad472ba9f4c149bf93c856c972995-5" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_03bad472ba9f4c149bf93c856c972995-5"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;niter&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_03bad472ba9f4c149bf93c856c972995-6" name="rest_code_03bad472ba9f4c149bf93c856c972995-6" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_03bad472ba9f4c149bf93c856c972995-6"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;for&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;cont&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="n"&gt;length&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_03bad472ba9f4c149bf93c856c972995-7" name="rest_code_03bad472ba9f4c149bf93c856c972995-7" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_03bad472ba9f4c149bf93c856c972995-7"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;Ap&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_03bad472ba9f4c149bf93c856c972995-8" name="rest_code_03bad472ba9f4c149bf93c856c972995-8" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_03bad472ba9f4c149bf93c856c972995-8"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;alpha&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;rsq_old&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;dot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Ap&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_03bad472ba9f4c149bf93c856c972995-9" name="rest_code_03bad472ba9f4c149bf93c856c972995-9" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_03bad472ba9f4c149bf93c856c972995-9"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;alpha&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_03bad472ba9f4c149bf93c856c972995-10" name="rest_code_03bad472ba9f4c149bf93c856c972995-10" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_03bad472ba9f4c149bf93c856c972995-10"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;alpha&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;Ap&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_03bad472ba9f4c149bf93c856c972995-11" name="rest_code_03bad472ba9f4c149bf93c856c972995-11" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_03bad472ba9f4c149bf93c856c972995-11"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;rsq_new&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;dot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_03bad472ba9f4c149bf93c856c972995-12" name="rest_code_03bad472ba9f4c149bf93c856c972995-12" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_03bad472ba9f4c149bf93c856c972995-12"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;sqrt&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;rsq_new&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;tol&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_03bad472ba9f4c149bf93c856c972995-13" name="rest_code_03bad472ba9f4c149bf93c856c972995-13" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_03bad472ba9f4c149bf93c856c972995-13"&gt;&lt;/a&gt;&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="k"&gt;break&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_03bad472ba9f4c149bf93c856c972995-14" name="rest_code_03bad472ba9f4c149bf93c856c972995-14" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_03bad472ba9f4c149bf93c856c972995-14"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="k"&gt;end&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_03bad472ba9f4c149bf93c856c972995-15" name="rest_code_03bad472ba9f4c149bf93c856c972995-15" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_03bad472ba9f4c149bf93c856c972995-15"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;rsq_new&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;rsq_old&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_03bad472ba9f4c149bf93c856c972995-16" name="rest_code_03bad472ba9f4c149bf93c856c972995-16" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_03bad472ba9f4c149bf93c856c972995-16"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;rsq_old&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;rsq_new&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_03bad472ba9f4c149bf93c856c972995-17" name="rest_code_03bad472ba9f4c149bf93c856c972995-17" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_03bad472ba9f4c149bf93c856c972995-17"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;niter&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_03bad472ba9f4c149bf93c856c972995-18" name="rest_code_03bad472ba9f4c149bf93c856c972995-18" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_03bad472ba9f4c149bf93c856c972995-18"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;end&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_03bad472ba9f4c149bf93c856c972995-19" name="rest_code_03bad472ba9f4c149bf93c856c972995-19" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_03bad472ba9f4c149bf93c856c972995-19"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;return&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;niter&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;norm&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_03bad472ba9f4c149bf93c856c972995-20" name="rest_code_03bad472ba9f4c149bf93c856c972995-20" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_03bad472ba9f4c149bf93c856c972995-20"&gt;&lt;/a&gt;&lt;span class="k"&gt;end&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_03bad472ba9f4c149bf93c856c972995-21" name="rest_code_03bad472ba9f4c149bf93c856c972995-21" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_03bad472ba9f4c149bf93c856c972995-21"&gt;&lt;/a&gt;
&lt;a id="rest_code_03bad472ba9f4c149bf93c856c972995-22" name="rest_code_03bad472ba9f4c149bf93c856c972995-22" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_03bad472ba9f4c149bf93c856c972995-22"&gt;&lt;/a&gt;
&lt;a id="rest_code_03bad472ba9f4c149bf93c856c972995-23" name="rest_code_03bad472ba9f4c149bf93c856c972995-23" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_03bad472ba9f4c149bf93c856c972995-23"&gt;&lt;/a&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1000&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_03bad472ba9f4c149bf93c856c972995-24" name="rest_code_03bad472ba9f4c149bf93c856c972995-24" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_03bad472ba9f4c149bf93c856c972995-24"&gt;&lt;/a&gt;&lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;diagm&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;ones&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;diagm&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ones&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;diagm&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ones&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_03bad472ba9f4c149bf93c856c972995-25" name="rest_code_03bad472ba9f4c149bf93c856c972995-25" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_03bad472ba9f4c149bf93c856c972995-25"&gt;&lt;/a&gt;&lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ones&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_03bad472ba9f4c149bf93c856c972995-26" name="rest_code_03bad472ba9f4c149bf93c856c972995-26" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_03bad472ba9f4c149bf93c856c972995-26"&gt;&lt;/a&gt;&lt;span class="n"&gt;x0&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ones&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_03bad472ba9f4c149bf93c856c972995-27" name="rest_code_03bad472ba9f4c149bf93c856c972995-27" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_03bad472ba9f4c149bf93c856c972995-27"&gt;&lt;/a&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;niter&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;accu&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;conj_grad&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;x0&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;In this case, we are testing the method with a matrix that comes from
the discretization of the second order derivative using finite differences.&lt;/p&gt;
&lt;/section&gt;
&lt;section id="comparison-python-julia"&gt;
&lt;h3&gt;Comparison Python/Julia&lt;/h3&gt;
&lt;p&gt;Regarding number of lines we have: 27 in Python and 27 in Julia. The comparison
in execution time is done with &lt;code class="docutils literal"&gt;%timeit&lt;/code&gt; magic command in IPython and
&lt;code class="docutils literal"&gt;@benchmark&lt;/code&gt; in Julia.&lt;/p&gt;
&lt;p&gt;For Python:&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code IPython"&gt;&lt;a id="rest_code_a844ad8c2d1141638c6a8f0f039780e7-1" name="rest_code_a844ad8c2d1141638c6a8f0f039780e7-1" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_a844ad8c2d1141638c6a8f0f039780e7-1"&gt;&lt;/a&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="k"&gt;timeit&lt;/span&gt; conj_grad(A, b, x0)
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;with result&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code text"&gt;&lt;a id="rest_code_347e73da0aca40b19090d683136e947f-1" name="rest_code_347e73da0aca40b19090d683136e947f-1" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_347e73da0aca40b19090d683136e947f-1"&gt;&lt;/a&gt;10 loops, best of 3: 107 ms per loop
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;For Julia:&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code julia"&gt;&lt;a id="rest_code_c48264dc8d6e46399ce11d8ce142b6eb-1" name="rest_code_c48264dc8d6e46399ce11d8ce142b6eb-1" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_c48264dc8d6e46399ce11d8ce142b6eb-1"&gt;&lt;/a&gt;&lt;span class="nd"&gt;@benchmark&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;conj_grad&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;x0&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;with result&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code julia"&gt;&lt;a id="rest_code_6ce5811619434b5f83e1551d05b8cda5-1" name="rest_code_6ce5811619434b5f83e1551d05b8cda5-1" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_6ce5811619434b5f83e1551d05b8cda5-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;BenchmarkTools&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Trial&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_6ce5811619434b5f83e1551d05b8cda5-2" name="rest_code_6ce5811619434b5f83e1551d05b8cda5-2" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_6ce5811619434b5f83e1551d05b8cda5-2"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;memory&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;estimate&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="mf"&gt;27.13&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;MiB&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_6ce5811619434b5f83e1551d05b8cda5-3" name="rest_code_6ce5811619434b5f83e1551d05b8cda5-3" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_6ce5811619434b5f83e1551d05b8cda5-3"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;allocs&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;estimate&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="mi"&gt;3501&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_6ce5811619434b5f83e1551d05b8cda5-4" name="rest_code_6ce5811619434b5f83e1551d05b8cda5-4" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_6ce5811619434b5f83e1551d05b8cda5-4"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="o"&gt;--------------&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_6ce5811619434b5f83e1551d05b8cda5-5" name="rest_code_6ce5811619434b5f83e1551d05b8cda5-5" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_6ce5811619434b5f83e1551d05b8cda5-5"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;minimum&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;     &lt;/span&gt;&lt;span class="mf"&gt;128.477&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ms&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;0.54&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;GC&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_6ce5811619434b5f83e1551d05b8cda5-6" name="rest_code_6ce5811619434b5f83e1551d05b8cda5-6" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_6ce5811619434b5f83e1551d05b8cda5-6"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;median&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="mf"&gt;294.407&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ms&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;0.24&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;GC&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_6ce5811619434b5f83e1551d05b8cda5-7" name="rest_code_6ce5811619434b5f83e1551d05b8cda5-7" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_6ce5811619434b5f83e1551d05b8cda5-7"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;mean&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="mf"&gt;298.208&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ms&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;0.30&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;GC&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_6ce5811619434b5f83e1551d05b8cda5-8" name="rest_code_6ce5811619434b5f83e1551d05b8cda5-8" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_6ce5811619434b5f83e1551d05b8cda5-8"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;maximum&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;     &lt;/span&gt;&lt;span class="mf"&gt;464.223&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ms&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;0.30&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;GC&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_6ce5811619434b5f83e1551d05b8cda5-9" name="rest_code_6ce5811619434b5f83e1551d05b8cda5-9" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_6ce5811619434b5f83e1551d05b8cda5-9"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="o"&gt;--------------&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_6ce5811619434b5f83e1551d05b8cda5-10" name="rest_code_6ce5811619434b5f83e1551d05b8cda5-10" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_6ce5811619434b5f83e1551d05b8cda5-10"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;samples&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;          &lt;/span&gt;&lt;span class="mi"&gt;17&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_6ce5811619434b5f83e1551d05b8cda5-11" name="rest_code_6ce5811619434b5f83e1551d05b8cda5-11" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_6ce5811619434b5f83e1551d05b8cda5-11"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;evals&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;sample&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;     &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;In this case, we can say that the Python code is roughly 2 times faster than
Julia code.&lt;/p&gt;
&lt;/section&gt;
&lt;/section&gt;</description><category>conjugate gradient</category><category>julia</category><category>numerical methods</category><category>python</category><category>scientific computing</category><guid>https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/</guid><pubDate>Tue, 31 Oct 2017 00:38:03 GMT</pubDate></item><item><title>Numerical methods challenge: Day 29</title><link>https://nicoguaro.github.io/posts/numerical_challenge/numerical-29/</link><dc:creator>Nicolás Guarín-Zapata</dc:creator><description>&lt;p&gt;During October (2017) I will write a program per day for some well-known
numerical methods in both Python and Julia. It is intended to be an exercise
then don't expect the code to be good enough for real use. Also,
I should mention that I have almost no experience with Julia, so it
probably won't be idiomatic Julia but more Python-like Julia.&lt;/p&gt;
&lt;section id="cholesky-decomposition"&gt;
&lt;h2&gt;Cholesky decomposition&lt;/h2&gt;
&lt;p&gt;Today we have &lt;a class="reference external" href="https://en.wikipedia.org/wiki/Cholesky_decomposition"&gt;Cholesky decomposition&lt;/a&gt;.
It is a factorization of a Hermitian, positive-definite matrix into
a lower and upper matrix, the main difference with LU decomposition
is that it the lower matrix is the Hermitian transpose of the upper one.&lt;/p&gt;
&lt;p&gt;Following are the codes&lt;/p&gt;
&lt;section id="python"&gt;
&lt;h3&gt;Python&lt;/h3&gt;
&lt;div class="code"&gt;&lt;pre class="code python"&gt;&lt;a id="rest_code_1dcc7911fab046b38359f437397e370e-1" name="rest_code_1dcc7911fab046b38359f437397e370e-1" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-29/#rest_code_1dcc7911fab046b38359f437397e370e-1"&gt;&lt;/a&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;__future__&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;division&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;print_function&lt;/span&gt;
&lt;a id="rest_code_1dcc7911fab046b38359f437397e370e-2" name="rest_code_1dcc7911fab046b38359f437397e370e-2" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-29/#rest_code_1dcc7911fab046b38359f437397e370e-2"&gt;&lt;/a&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;numpy&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;np&lt;/span&gt;
&lt;a id="rest_code_1dcc7911fab046b38359f437397e370e-3" name="rest_code_1dcc7911fab046b38359f437397e370e-3" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-29/#rest_code_1dcc7911fab046b38359f437397e370e-3"&gt;&lt;/a&gt;
&lt;a id="rest_code_1dcc7911fab046b38359f437397e370e-4" name="rest_code_1dcc7911fab046b38359f437397e370e-4" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-29/#rest_code_1dcc7911fab046b38359f437397e370e-4"&gt;&lt;/a&gt;
&lt;a id="rest_code_1dcc7911fab046b38359f437397e370e-5" name="rest_code_1dcc7911fab046b38359f437397e370e-5" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-29/#rest_code_1dcc7911fab046b38359f437397e370e-5"&gt;&lt;/a&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;cholesky&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;mat&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_1dcc7911fab046b38359f437397e370e-6" name="rest_code_1dcc7911fab046b38359f437397e370e-6" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-29/#rest_code_1dcc7911fab046b38359f437397e370e-6"&gt;&lt;/a&gt;    &lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;_&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;mat&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;shape&lt;/span&gt;
&lt;a id="rest_code_1dcc7911fab046b38359f437397e370e-7" name="rest_code_1dcc7911fab046b38359f437397e370e-7" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-29/#rest_code_1dcc7911fab046b38359f437397e370e-7"&gt;&lt;/a&gt;    &lt;span class="n"&gt;mat&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;mat&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;copy&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a id="rest_code_1dcc7911fab046b38359f437397e370e-8" name="rest_code_1dcc7911fab046b38359f437397e370e-8" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-29/#rest_code_1dcc7911fab046b38359f437397e370e-8"&gt;&lt;/a&gt;    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;col&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_1dcc7911fab046b38359f437397e370e-9" name="rest_code_1dcc7911fab046b38359f437397e370e-9" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-29/#rest_code_1dcc7911fab046b38359f437397e370e-9"&gt;&lt;/a&gt;        &lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;mat&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;
&lt;a id="rest_code_1dcc7911fab046b38359f437397e370e-10" name="rest_code_1dcc7911fab046b38359f437397e370e-10" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-29/#rest_code_1dcc7911fab046b38359f437397e370e-10"&gt;&lt;/a&gt;               &lt;span class="n"&gt;mat&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;dot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;mat&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="p"&gt;]))&lt;/span&gt;
&lt;a id="rest_code_1dcc7911fab046b38359f437397e370e-11" name="rest_code_1dcc7911fab046b38359f437397e370e-11" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-29/#rest_code_1dcc7911fab046b38359f437397e370e-11"&gt;&lt;/a&gt;        &lt;span class="n"&gt;mat&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sqrt&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;mat&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;
&lt;a id="rest_code_1dcc7911fab046b38359f437397e370e-12" name="rest_code_1dcc7911fab046b38359f437397e370e-12" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-29/#rest_code_1dcc7911fab046b38359f437397e370e-12"&gt;&lt;/a&gt;               &lt;span class="n"&gt;mat&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;dot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;mat&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="p"&gt;]))&lt;/span&gt;
&lt;a id="rest_code_1dcc7911fab046b38359f437397e370e-13" name="rest_code_1dcc7911fab046b38359f437397e370e-13" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-29/#rest_code_1dcc7911fab046b38359f437397e370e-13"&gt;&lt;/a&gt;        &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;row&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;col&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_1dcc7911fab046b38359f437397e370e-14" name="rest_code_1dcc7911fab046b38359f437397e370e-14" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-29/#rest_code_1dcc7911fab046b38359f437397e370e-14"&gt;&lt;/a&gt;            &lt;span class="n"&gt;mat&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;row&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;mat&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;row&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;
&lt;a id="rest_code_1dcc7911fab046b38359f437397e370e-15" name="rest_code_1dcc7911fab046b38359f437397e370e-15" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-29/#rest_code_1dcc7911fab046b38359f437397e370e-15"&gt;&lt;/a&gt;               &lt;span class="n"&gt;mat&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;row&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;dot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;mat&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="p"&gt;]))&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;mat&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_1dcc7911fab046b38359f437397e370e-16" name="rest_code_1dcc7911fab046b38359f437397e370e-16" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-29/#rest_code_1dcc7911fab046b38359f437397e370e-16"&gt;&lt;/a&gt;    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;row&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_1dcc7911fab046b38359f437397e370e-17" name="rest_code_1dcc7911fab046b38359f437397e370e-17" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-29/#rest_code_1dcc7911fab046b38359f437397e370e-17"&gt;&lt;/a&gt;        &lt;span class="n"&gt;mat&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="n"&gt;row&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;row&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;
&lt;a id="rest_code_1dcc7911fab046b38359f437397e370e-18" name="rest_code_1dcc7911fab046b38359f437397e370e-18" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-29/#rest_code_1dcc7911fab046b38359f437397e370e-18"&gt;&lt;/a&gt;    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;mat&lt;/span&gt;
&lt;a id="rest_code_1dcc7911fab046b38359f437397e370e-19" name="rest_code_1dcc7911fab046b38359f437397e370e-19" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-29/#rest_code_1dcc7911fab046b38359f437397e370e-19"&gt;&lt;/a&gt;
&lt;a id="rest_code_1dcc7911fab046b38359f437397e370e-20" name="rest_code_1dcc7911fab046b38359f437397e370e-20" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-29/#rest_code_1dcc7911fab046b38359f437397e370e-20"&gt;&lt;/a&gt;
&lt;a id="rest_code_1dcc7911fab046b38359f437397e370e-21" name="rest_code_1dcc7911fab046b38359f437397e370e-21" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-29/#rest_code_1dcc7911fab046b38359f437397e370e-21"&gt;&lt;/a&gt;&lt;span class="n"&gt;A&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;
&lt;a id="rest_code_1dcc7911fab046b38359f437397e370e-22" name="rest_code_1dcc7911fab046b38359f437397e370e-22" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-29/#rest_code_1dcc7911fab046b38359f437397e370e-22"&gt;&lt;/a&gt;    &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;
&lt;a id="rest_code_1dcc7911fab046b38359f437397e370e-23" name="rest_code_1dcc7911fab046b38359f437397e370e-23" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-29/#rest_code_1dcc7911fab046b38359f437397e370e-23"&gt;&lt;/a&gt;    &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;4.25&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;2.75&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;
&lt;a id="rest_code_1dcc7911fab046b38359f437397e370e-24" name="rest_code_1dcc7911fab046b38359f437397e370e-24" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-29/#rest_code_1dcc7911fab046b38359f437397e370e-24"&gt;&lt;/a&gt;    &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;2.75&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;3.5&lt;/span&gt;&lt;span class="p"&gt;]],&lt;/span&gt; &lt;span class="n"&gt;dtype&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nb"&gt;float&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_1dcc7911fab046b38359f437397e370e-25" name="rest_code_1dcc7911fab046b38359f437397e370e-25" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-29/#rest_code_1dcc7911fab046b38359f437397e370e-25"&gt;&lt;/a&gt;&lt;span class="n"&gt;B&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;cholesky&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/section&gt;
&lt;section id="julia"&gt;
&lt;h3&gt;Julia&lt;/h3&gt;
&lt;div class="code"&gt;&lt;pre class="code julia"&gt;&lt;a id="rest_code_3cdace977abe4b79866ba19d256f8f38-1" name="rest_code_3cdace977abe4b79866ba19d256f8f38-1" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-29/#rest_code_3cdace977abe4b79866ba19d256f8f38-1"&gt;&lt;/a&gt;&lt;span class="k"&gt;function&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;cholesky&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;mat&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_3cdace977abe4b79866ba19d256f8f38-2" name="rest_code_3cdace977abe4b79866ba19d256f8f38-2" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-29/#rest_code_3cdace977abe4b79866ba19d256f8f38-2"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;_&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;size&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;mat&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_3cdace977abe4b79866ba19d256f8f38-3" name="rest_code_3cdace977abe4b79866ba19d256f8f38-3" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-29/#rest_code_3cdace977abe4b79866ba19d256f8f38-3"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;mat&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;copy&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;mat&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_3cdace977abe4b79866ba19d256f8f38-4" name="rest_code_3cdace977abe4b79866ba19d256f8f38-4" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-29/#rest_code_3cdace977abe4b79866ba19d256f8f38-4"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;for&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_3cdace977abe4b79866ba19d256f8f38-5" name="rest_code_3cdace977abe4b79866ba19d256f8f38-5" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-29/#rest_code_3cdace977abe4b79866ba19d256f8f38-5"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;mat&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;sqrt&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;mat&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_3cdace977abe4b79866ba19d256f8f38-6" name="rest_code_3cdace977abe4b79866ba19d256f8f38-6" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-29/#rest_code_3cdace977abe4b79866ba19d256f8f38-6"&gt;&lt;/a&gt;&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="n"&gt;dot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;mat&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;mat&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]))&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_3cdace977abe4b79866ba19d256f8f38-7" name="rest_code_3cdace977abe4b79866ba19d256f8f38-7" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-29/#rest_code_3cdace977abe4b79866ba19d256f8f38-7"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="k"&gt;for&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;row&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_3cdace977abe4b79866ba19d256f8f38-8" name="rest_code_3cdace977abe4b79866ba19d256f8f38-8" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-29/#rest_code_3cdace977abe4b79866ba19d256f8f38-8"&gt;&lt;/a&gt;&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="n"&gt;mat&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;row&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;mat&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;row&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_3cdace977abe4b79866ba19d256f8f38-9" name="rest_code_3cdace977abe4b79866ba19d256f8f38-9" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-29/#rest_code_3cdace977abe4b79866ba19d256f8f38-9"&gt;&lt;/a&gt;&lt;span class="w"&gt;               &lt;/span&gt;&lt;span class="n"&gt;dot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;mat&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;row&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;mat&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]))&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;mat&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_3cdace977abe4b79866ba19d256f8f38-10" name="rest_code_3cdace977abe4b79866ba19d256f8f38-10" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-29/#rest_code_3cdace977abe4b79866ba19d256f8f38-10"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="k"&gt;end&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_3cdace977abe4b79866ba19d256f8f38-11" name="rest_code_3cdace977abe4b79866ba19d256f8f38-11" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-29/#rest_code_3cdace977abe4b79866ba19d256f8f38-11"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;end&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_3cdace977abe4b79866ba19d256f8f38-12" name="rest_code_3cdace977abe4b79866ba19d256f8f38-12" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-29/#rest_code_3cdace977abe4b79866ba19d256f8f38-12"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;for&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;row&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_3cdace977abe4b79866ba19d256f8f38-13" name="rest_code_3cdace977abe4b79866ba19d256f8f38-13" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-29/#rest_code_3cdace977abe4b79866ba19d256f8f38-13"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;mat&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="n"&gt;row&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;row&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_3cdace977abe4b79866ba19d256f8f38-14" name="rest_code_3cdace977abe4b79866ba19d256f8f38-14" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-29/#rest_code_3cdace977abe4b79866ba19d256f8f38-14"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;end&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_3cdace977abe4b79866ba19d256f8f38-15" name="rest_code_3cdace977abe4b79866ba19d256f8f38-15" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-29/#rest_code_3cdace977abe4b79866ba19d256f8f38-15"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;return&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;mat&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_3cdace977abe4b79866ba19d256f8f38-16" name="rest_code_3cdace977abe4b79866ba19d256f8f38-16" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-29/#rest_code_3cdace977abe4b79866ba19d256f8f38-16"&gt;&lt;/a&gt;&lt;span class="k"&gt;end&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_3cdace977abe4b79866ba19d256f8f38-17" name="rest_code_3cdace977abe4b79866ba19d256f8f38-17" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-29/#rest_code_3cdace977abe4b79866ba19d256f8f38-17"&gt;&lt;/a&gt;
&lt;a id="rest_code_3cdace977abe4b79866ba19d256f8f38-18" name="rest_code_3cdace977abe4b79866ba19d256f8f38-18" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-29/#rest_code_3cdace977abe4b79866ba19d256f8f38-18"&gt;&lt;/a&gt;
&lt;a id="rest_code_3cdace977abe4b79866ba19d256f8f38-19" name="rest_code_3cdace977abe4b79866ba19d256f8f38-19" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-29/#rest_code_3cdace977abe4b79866ba19d256f8f38-19"&gt;&lt;/a&gt;&lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_3cdace977abe4b79866ba19d256f8f38-20" name="rest_code_3cdace977abe4b79866ba19d256f8f38-20" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-29/#rest_code_3cdace977abe4b79866ba19d256f8f38-20"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;4.25&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;2.75&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_3cdace977abe4b79866ba19d256f8f38-21" name="rest_code_3cdace977abe4b79866ba19d256f8f38-21" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-29/#rest_code_3cdace977abe4b79866ba19d256f8f38-21"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;2.75&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;3.5&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_3cdace977abe4b79866ba19d256f8f38-22" name="rest_code_3cdace977abe4b79866ba19d256f8f38-22" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-29/#rest_code_3cdace977abe4b79866ba19d256f8f38-22"&gt;&lt;/a&gt;&lt;span class="n"&gt;B&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;cholesky&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;As an example we have the matrix&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
A = \begin{bmatrix}
     4 &amp;amp;-1 &amp;amp;1\\
    -1 &amp;amp;4.25 &amp;amp;2.75\\
     1 &amp;amp;2.75 &amp;amp;3.5
    \end{bmatrix}
\end{equation*}
&lt;/div&gt;
&lt;p&gt;And, the answer of both codes is&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code text"&gt;&lt;a id="rest_code_d939f6ddb458483ab3304f86f05b9597-1" name="rest_code_d939f6ddb458483ab3304f86f05b9597-1" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-29/#rest_code_d939f6ddb458483ab3304f86f05b9597-1"&gt;&lt;/a&gt;2.0  0.0  0.0
&lt;a id="rest_code_d939f6ddb458483ab3304f86f05b9597-2" name="rest_code_d939f6ddb458483ab3304f86f05b9597-2" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-29/#rest_code_d939f6ddb458483ab3304f86f05b9597-2"&gt;&lt;/a&gt;-0.5  2.0  0.0
&lt;a id="rest_code_d939f6ddb458483ab3304f86f05b9597-3" name="rest_code_d939f6ddb458483ab3304f86f05b9597-3" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-29/#rest_code_d939f6ddb458483ab3304f86f05b9597-3"&gt;&lt;/a&gt;0.5  1.5  1.0
&lt;/pre&gt;&lt;/div&gt;
&lt;/section&gt;
&lt;section id="comparison-python-julia"&gt;
&lt;h3&gt;Comparison Python/Julia&lt;/h3&gt;
&lt;p&gt;Regarding number of lines we have: 23 in Python and 22 in Julia. The comparison
in execution time is done with &lt;code class="docutils literal"&gt;%timeit&lt;/code&gt; magic command in IPython and
&lt;code class="docutils literal"&gt;@benchmark&lt;/code&gt; in Julia.&lt;/p&gt;
&lt;p&gt;For Python:&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code IPython"&gt;&lt;a id="rest_code_c9c1657d99624d34a5c6bbe32c4f8f71-1" name="rest_code_c9c1657d99624d34a5c6bbe32c4f8f71-1" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-29/#rest_code_c9c1657d99624d34a5c6bbe32c4f8f71-1"&gt;&lt;/a&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="k"&gt;timeit&lt;/span&gt; cholesky(np.eye(100))
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;with result&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code text"&gt;&lt;a id="rest_code_ea60a943f53e43efbd900f80efebf885-1" name="rest_code_ea60a943f53e43efbd900f80efebf885-1" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-29/#rest_code_ea60a943f53e43efbd900f80efebf885-1"&gt;&lt;/a&gt;100 loops, best of 3: 13 ms per loop
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;For Julia:&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code julia"&gt;&lt;a id="rest_code_1a33a296ab004a4bac41721501597cc2-1" name="rest_code_1a33a296ab004a4bac41721501597cc2-1" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-29/#rest_code_1a33a296ab004a4bac41721501597cc2-1"&gt;&lt;/a&gt;&lt;span class="nd"&gt;@benchmark&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;cholesky&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;eye&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;100&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;with result&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code julia"&gt;&lt;a id="rest_code_f7c5153054204cb3acfc725713e43966-1" name="rest_code_f7c5153054204cb3acfc725713e43966-1" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-29/#rest_code_f7c5153054204cb3acfc725713e43966-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;BenchmarkTools&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Trial&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_f7c5153054204cb3acfc725713e43966-2" name="rest_code_f7c5153054204cb3acfc725713e43966-2" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-29/#rest_code_f7c5153054204cb3acfc725713e43966-2"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;memory&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;estimate&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="mf"&gt;4.01&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;MiB&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_f7c5153054204cb3acfc725713e43966-3" name="rest_code_f7c5153054204cb3acfc725713e43966-3" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-29/#rest_code_f7c5153054204cb3acfc725713e43966-3"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;allocs&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;estimate&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="mi"&gt;20303&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_f7c5153054204cb3acfc725713e43966-4" name="rest_code_f7c5153054204cb3acfc725713e43966-4" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-29/#rest_code_f7c5153054204cb3acfc725713e43966-4"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="o"&gt;--------------&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_f7c5153054204cb3acfc725713e43966-5" name="rest_code_f7c5153054204cb3acfc725713e43966-5" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-29/#rest_code_f7c5153054204cb3acfc725713e43966-5"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;minimum&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;     &lt;/span&gt;&lt;span class="mf"&gt;1.010&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ms&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;0.00&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;GC&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_f7c5153054204cb3acfc725713e43966-6" name="rest_code_f7c5153054204cb3acfc725713e43966-6" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-29/#rest_code_f7c5153054204cb3acfc725713e43966-6"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;median&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="mf"&gt;1.136&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ms&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;0.00&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;GC&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_f7c5153054204cb3acfc725713e43966-7" name="rest_code_f7c5153054204cb3acfc725713e43966-7" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-29/#rest_code_f7c5153054204cb3acfc725713e43966-7"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;mean&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="mf"&gt;1.370&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ms&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;17.85&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;GC&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_f7c5153054204cb3acfc725713e43966-8" name="rest_code_f7c5153054204cb3acfc725713e43966-8" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-29/#rest_code_f7c5153054204cb3acfc725713e43966-8"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;maximum&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;     &lt;/span&gt;&lt;span class="mf"&gt;4.652&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ms&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;40.37&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;GC&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_f7c5153054204cb3acfc725713e43966-9" name="rest_code_f7c5153054204cb3acfc725713e43966-9" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-29/#rest_code_f7c5153054204cb3acfc725713e43966-9"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="o"&gt;--------------&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_f7c5153054204cb3acfc725713e43966-10" name="rest_code_f7c5153054204cb3acfc725713e43966-10" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-29/#rest_code_f7c5153054204cb3acfc725713e43966-10"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;samples&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;          &lt;/span&gt;&lt;span class="mi"&gt;3637&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_f7c5153054204cb3acfc725713e43966-11" name="rest_code_f7c5153054204cb3acfc725713e43966-11" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-29/#rest_code_f7c5153054204cb3acfc725713e43966-11"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;evals&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;sample&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;     &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;In this case, we can say that the Python code is roughly 10 times slower than
Julia code.&lt;/p&gt;
&lt;/section&gt;
&lt;/section&gt;</description><category>cholesky decomposition</category><category>julia</category><category>numerical methods</category><category>python</category><category>scientific computing</category><guid>https://nicoguaro.github.io/posts/numerical_challenge/numerical-29/</guid><pubDate>Mon, 30 Oct 2017 02:10:08 GMT</pubDate></item><item><title>Numerical methods challenge: Day 28</title><link>https://nicoguaro.github.io/posts/numerical_challenge/numerical-28/</link><dc:creator>Nicolás Guarín-Zapata</dc:creator><description>&lt;p&gt;During October (2017) I will write a program per day for some well-known
numerical methods in both Python and Julia. It is intended to be an exercise
then don't expect the code to be good enough for real use. Also,
I should mention that I have almost no experience with Julia, so it
probably won't be idiomatic Julia but more Python-like Julia.&lt;/p&gt;
&lt;section id="lu-factorization"&gt;
&lt;h2&gt;LU factorization&lt;/h2&gt;
&lt;p&gt;Today we have &lt;a class="reference external" href="https://en.wikipedia.org/wiki/LU_decomposition"&gt;LU decomposition&lt;/a&gt;.
That is a factorization of a matrix into a lower (L) and upper (U) matrix.
Basically it stores de steps of a Gauss elimination in matrices.&lt;/p&gt;
&lt;p&gt;Following are the codes&lt;/p&gt;
&lt;section id="python"&gt;
&lt;h3&gt;Python&lt;/h3&gt;
&lt;div class="code"&gt;&lt;pre class="code python"&gt;&lt;a id="rest_code_f4f253d6a17e4be5b489e89faae71dca-1" name="rest_code_f4f253d6a17e4be5b489e89faae71dca-1" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-28/#rest_code_f4f253d6a17e4be5b489e89faae71dca-1"&gt;&lt;/a&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;__future__&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;division&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;print_function&lt;/span&gt;
&lt;a id="rest_code_f4f253d6a17e4be5b489e89faae71dca-2" name="rest_code_f4f253d6a17e4be5b489e89faae71dca-2" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-28/#rest_code_f4f253d6a17e4be5b489e89faae71dca-2"&gt;&lt;/a&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;numpy&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;np&lt;/span&gt;
&lt;a id="rest_code_f4f253d6a17e4be5b489e89faae71dca-3" name="rest_code_f4f253d6a17e4be5b489e89faae71dca-3" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-28/#rest_code_f4f253d6a17e4be5b489e89faae71dca-3"&gt;&lt;/a&gt;
&lt;a id="rest_code_f4f253d6a17e4be5b489e89faae71dca-4" name="rest_code_f4f253d6a17e4be5b489e89faae71dca-4" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-28/#rest_code_f4f253d6a17e4be5b489e89faae71dca-4"&gt;&lt;/a&gt;
&lt;a id="rest_code_f4f253d6a17e4be5b489e89faae71dca-5" name="rest_code_f4f253d6a17e4be5b489e89faae71dca-5" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-28/#rest_code_f4f253d6a17e4be5b489e89faae71dca-5"&gt;&lt;/a&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;LU&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;mat&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_f4f253d6a17e4be5b489e89faae71dca-6" name="rest_code_f4f253d6a17e4be5b489e89faae71dca-6" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-28/#rest_code_f4f253d6a17e4be5b489e89faae71dca-6"&gt;&lt;/a&gt;    &lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;_&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;mat&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;shape&lt;/span&gt;
&lt;a id="rest_code_f4f253d6a17e4be5b489e89faae71dca-7" name="rest_code_f4f253d6a17e4be5b489e89faae71dca-7" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-28/#rest_code_f4f253d6a17e4be5b489e89faae71dca-7"&gt;&lt;/a&gt;    &lt;span class="n"&gt;mat&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;mat&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;copy&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a id="rest_code_f4f253d6a17e4be5b489e89faae71dca-8" name="rest_code_f4f253d6a17e4be5b489e89faae71dca-8" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-28/#rest_code_f4f253d6a17e4be5b489e89faae71dca-8"&gt;&lt;/a&gt;    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;col&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;m&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_f4f253d6a17e4be5b489e89faae71dca-9" name="rest_code_f4f253d6a17e4be5b489e89faae71dca-9" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-28/#rest_code_f4f253d6a17e4be5b489e89faae71dca-9"&gt;&lt;/a&gt;        &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;row&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;col&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_f4f253d6a17e4be5b489e89faae71dca-10" name="rest_code_f4f253d6a17e4be5b489e89faae71dca-10" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-28/#rest_code_f4f253d6a17e4be5b489e89faae71dca-10"&gt;&lt;/a&gt;            &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;mat&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;row&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;!=&lt;/span&gt; &lt;span class="mf"&gt;0.0&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a id="rest_code_f4f253d6a17e4be5b489e89faae71dca-11" name="rest_code_f4f253d6a17e4be5b489e89faae71dca-11" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-28/#rest_code_f4f253d6a17e4be5b489e89faae71dca-11"&gt;&lt;/a&gt;                &lt;span class="n"&gt;lam&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;mat&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;row&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;mat&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_f4f253d6a17e4be5b489e89faae71dca-12" name="rest_code_f4f253d6a17e4be5b489e89faae71dca-12" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-28/#rest_code_f4f253d6a17e4be5b489e89faae71dca-12"&gt;&lt;/a&gt;                &lt;span class="n"&gt;mat&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;row&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;col&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;mat&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;row&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;col&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;\
&lt;a id="rest_code_f4f253d6a17e4be5b489e89faae71dca-13" name="rest_code_f4f253d6a17e4be5b489e89faae71dca-13" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-28/#rest_code_f4f253d6a17e4be5b489e89faae71dca-13"&gt;&lt;/a&gt;                                      &lt;span class="n"&gt;lam&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;mat&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;col&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_f4f253d6a17e4be5b489e89faae71dca-14" name="rest_code_f4f253d6a17e4be5b489e89faae71dca-14" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-28/#rest_code_f4f253d6a17e4be5b489e89faae71dca-14"&gt;&lt;/a&gt;                &lt;span class="n"&gt;mat&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;row&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;lam&lt;/span&gt;
&lt;a id="rest_code_f4f253d6a17e4be5b489e89faae71dca-15" name="rest_code_f4f253d6a17e4be5b489e89faae71dca-15" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-28/#rest_code_f4f253d6a17e4be5b489e89faae71dca-15"&gt;&lt;/a&gt;    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;mat&lt;/span&gt;
&lt;a id="rest_code_f4f253d6a17e4be5b489e89faae71dca-16" name="rest_code_f4f253d6a17e4be5b489e89faae71dca-16" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-28/#rest_code_f4f253d6a17e4be5b489e89faae71dca-16"&gt;&lt;/a&gt;
&lt;a id="rest_code_f4f253d6a17e4be5b489e89faae71dca-17" name="rest_code_f4f253d6a17e4be5b489e89faae71dca-17" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-28/#rest_code_f4f253d6a17e4be5b489e89faae71dca-17"&gt;&lt;/a&gt;
&lt;a id="rest_code_f4f253d6a17e4be5b489e89faae71dca-18" name="rest_code_f4f253d6a17e4be5b489e89faae71dca-18" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-28/#rest_code_f4f253d6a17e4be5b489e89faae71dca-18"&gt;&lt;/a&gt;&lt;span class="n"&gt;A&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;
&lt;a id="rest_code_f4f253d6a17e4be5b489e89faae71dca-19" name="rest_code_f4f253d6a17e4be5b489e89faae71dca-19" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-28/#rest_code_f4f253d6a17e4be5b489e89faae71dca-19"&gt;&lt;/a&gt;    &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;
&lt;a id="rest_code_f4f253d6a17e4be5b489e89faae71dca-20" name="rest_code_f4f253d6a17e4be5b489e89faae71dca-20" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-28/#rest_code_f4f253d6a17e4be5b489e89faae71dca-20"&gt;&lt;/a&gt;    &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;
&lt;a id="rest_code_f4f253d6a17e4be5b489e89faae71dca-21" name="rest_code_f4f253d6a17e4be5b489e89faae71dca-21" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-28/#rest_code_f4f253d6a17e4be5b489e89faae71dca-21"&gt;&lt;/a&gt;    &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;
&lt;a id="rest_code_f4f253d6a17e4be5b489e89faae71dca-22" name="rest_code_f4f253d6a17e4be5b489e89faae71dca-22" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-28/#rest_code_f4f253d6a17e4be5b489e89faae71dca-22"&gt;&lt;/a&gt;    &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]],&lt;/span&gt; &lt;span class="n"&gt;dtype&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nb"&gt;float&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_f4f253d6a17e4be5b489e89faae71dca-23" name="rest_code_f4f253d6a17e4be5b489e89faae71dca-23" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-28/#rest_code_f4f253d6a17e4be5b489e89faae71dca-23"&gt;&lt;/a&gt;&lt;span class="n"&gt;B&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;LU&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/section&gt;
&lt;section id="julia"&gt;
&lt;h3&gt;Julia&lt;/h3&gt;
&lt;div class="code"&gt;&lt;pre class="code julia"&gt;&lt;a id="rest_code_d3848446e79546e1a8feebe6d42abdbf-1" name="rest_code_d3848446e79546e1a8feebe6d42abdbf-1" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-28/#rest_code_d3848446e79546e1a8feebe6d42abdbf-1"&gt;&lt;/a&gt;&lt;span class="k"&gt;function&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;LU&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;mat&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_d3848446e79546e1a8feebe6d42abdbf-2" name="rest_code_d3848446e79546e1a8feebe6d42abdbf-2" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-28/#rest_code_d3848446e79546e1a8feebe6d42abdbf-2"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;_&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;size&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;mat&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_d3848446e79546e1a8feebe6d42abdbf-3" name="rest_code_d3848446e79546e1a8feebe6d42abdbf-3" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-28/#rest_code_d3848446e79546e1a8feebe6d42abdbf-3"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;mat&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;copy&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;mat&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_d3848446e79546e1a8feebe6d42abdbf-4" name="rest_code_d3848446e79546e1a8feebe6d42abdbf-4" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-28/#rest_code_d3848446e79546e1a8feebe6d42abdbf-4"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;for&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_d3848446e79546e1a8feebe6d42abdbf-5" name="rest_code_d3848446e79546e1a8feebe6d42abdbf-5" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-28/#rest_code_d3848446e79546e1a8feebe6d42abdbf-5"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="k"&gt;for&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;row&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_d3848446e79546e1a8feebe6d42abdbf-6" name="rest_code_d3848446e79546e1a8feebe6d42abdbf-6" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-28/#rest_code_d3848446e79546e1a8feebe6d42abdbf-6"&gt;&lt;/a&gt;&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;mat&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;row&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;!=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;0.0&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_d3848446e79546e1a8feebe6d42abdbf-7" name="rest_code_d3848446e79546e1a8feebe6d42abdbf-7" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-28/#rest_code_d3848446e79546e1a8feebe6d42abdbf-7"&gt;&lt;/a&gt;&lt;span class="w"&gt;                &lt;/span&gt;&lt;span class="n"&gt;lam&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;mat&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;row&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;mat&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_d3848446e79546e1a8feebe6d42abdbf-8" name="rest_code_d3848446e79546e1a8feebe6d42abdbf-8" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-28/#rest_code_d3848446e79546e1a8feebe6d42abdbf-8"&gt;&lt;/a&gt;&lt;span class="w"&gt;                &lt;/span&gt;&lt;span class="n"&gt;mat&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;row&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;mat&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;row&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_d3848446e79546e1a8feebe6d42abdbf-9" name="rest_code_d3848446e79546e1a8feebe6d42abdbf-9" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-28/#rest_code_d3848446e79546e1a8feebe6d42abdbf-9"&gt;&lt;/a&gt;&lt;span class="w"&gt;                                      &lt;/span&gt;&lt;span class="n"&gt;lam&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;mat&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_d3848446e79546e1a8feebe6d42abdbf-10" name="rest_code_d3848446e79546e1a8feebe6d42abdbf-10" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-28/#rest_code_d3848446e79546e1a8feebe6d42abdbf-10"&gt;&lt;/a&gt;&lt;span class="w"&gt;                &lt;/span&gt;&lt;span class="n"&gt;mat&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;row&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;lam&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_d3848446e79546e1a8feebe6d42abdbf-11" name="rest_code_d3848446e79546e1a8feebe6d42abdbf-11" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-28/#rest_code_d3848446e79546e1a8feebe6d42abdbf-11"&gt;&lt;/a&gt;&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="k"&gt;end&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_d3848446e79546e1a8feebe6d42abdbf-12" name="rest_code_d3848446e79546e1a8feebe6d42abdbf-12" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-28/#rest_code_d3848446e79546e1a8feebe6d42abdbf-12"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="k"&gt;end&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_d3848446e79546e1a8feebe6d42abdbf-13" name="rest_code_d3848446e79546e1a8feebe6d42abdbf-13" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-28/#rest_code_d3848446e79546e1a8feebe6d42abdbf-13"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;end&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_d3848446e79546e1a8feebe6d42abdbf-14" name="rest_code_d3848446e79546e1a8feebe6d42abdbf-14" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-28/#rest_code_d3848446e79546e1a8feebe6d42abdbf-14"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;return&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;mat&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_d3848446e79546e1a8feebe6d42abdbf-15" name="rest_code_d3848446e79546e1a8feebe6d42abdbf-15" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-28/#rest_code_d3848446e79546e1a8feebe6d42abdbf-15"&gt;&lt;/a&gt;&lt;span class="k"&gt;end&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_d3848446e79546e1a8feebe6d42abdbf-16" name="rest_code_d3848446e79546e1a8feebe6d42abdbf-16" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-28/#rest_code_d3848446e79546e1a8feebe6d42abdbf-16"&gt;&lt;/a&gt;
&lt;a id="rest_code_d3848446e79546e1a8feebe6d42abdbf-17" name="rest_code_d3848446e79546e1a8feebe6d42abdbf-17" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-28/#rest_code_d3848446e79546e1a8feebe6d42abdbf-17"&gt;&lt;/a&gt;
&lt;a id="rest_code_d3848446e79546e1a8feebe6d42abdbf-18" name="rest_code_d3848446e79546e1a8feebe6d42abdbf-18" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-28/#rest_code_d3848446e79546e1a8feebe6d42abdbf-18"&gt;&lt;/a&gt;&lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mf"&gt;1.0&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;1.0&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;0.0&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;3.0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_d3848446e79546e1a8feebe6d42abdbf-19" name="rest_code_d3848446e79546e1a8feebe6d42abdbf-19" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-28/#rest_code_d3848446e79546e1a8feebe6d42abdbf-19"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="mf"&gt;2.0&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;1.0&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;1.0&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;1.0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_d3848446e79546e1a8feebe6d42abdbf-20" name="rest_code_d3848446e79546e1a8feebe6d42abdbf-20" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-28/#rest_code_d3848446e79546e1a8feebe6d42abdbf-20"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="mf"&gt;3.0&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;1.0&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;1.0&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;2.0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_d3848446e79546e1a8feebe6d42abdbf-21" name="rest_code_d3848446e79546e1a8feebe6d42abdbf-21" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-28/#rest_code_d3848446e79546e1a8feebe6d42abdbf-21"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;1.0&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;2.0&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;3.0&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;1.0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_d3848446e79546e1a8feebe6d42abdbf-22" name="rest_code_d3848446e79546e1a8feebe6d42abdbf-22" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-28/#rest_code_d3848446e79546e1a8feebe6d42abdbf-22"&gt;&lt;/a&gt;&lt;span class="n"&gt;B&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;LU&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;As an example we have the matrix&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
A = \begin{bmatrix}
    1 &amp;amp;1 &amp;amp;0 &amp;amp;3\\
    2 &amp;amp;1 &amp;amp;-1 &amp;amp;1\\
    3 &amp;amp;-1 &amp;amp;-1 &amp;amp;2\\
    -1 &amp;amp;2 &amp;amp;3 &amp;amp;-1
    \end{bmatrix} =
    \begin{bmatrix}
    1 &amp;amp;1 &amp;amp;0 &amp;amp;0\\
    2 &amp;amp;1 &amp;amp;0 &amp;amp;0\\
    3 &amp;amp;4 &amp;amp;1 &amp;amp;2\\
    -1 &amp;amp;-3 &amp;amp;0 &amp;amp;1
    \end{bmatrix}
    \begin{bmatrix}
    1 &amp;amp;1 &amp;amp;0 &amp;amp;3\\
    0 &amp;amp;-1 &amp;amp;-1 &amp;amp;-5\\
    0 &amp;amp;0 &amp;amp;3 &amp;amp;13\\
    0 &amp;amp;0 &amp;amp;0 &amp;amp;-13
    \end{bmatrix}
\end{equation*}
&lt;/div&gt;
&lt;p&gt;And, the answer of both codes is&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code text"&gt;&lt;a id="rest_code_68db081633154cf89a5ab95fa9c50869-1" name="rest_code_68db081633154cf89a5ab95fa9c50869-1" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-28/#rest_code_68db081633154cf89a5ab95fa9c50869-1"&gt;&lt;/a&gt;[[  1.,   1.,   0.,   3.],
&lt;a id="rest_code_68db081633154cf89a5ab95fa9c50869-2" name="rest_code_68db081633154cf89a5ab95fa9c50869-2" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-28/#rest_code_68db081633154cf89a5ab95fa9c50869-2"&gt;&lt;/a&gt; [  2.,  -1.,  -1.,  -5.],
&lt;a id="rest_code_68db081633154cf89a5ab95fa9c50869-3" name="rest_code_68db081633154cf89a5ab95fa9c50869-3" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-28/#rest_code_68db081633154cf89a5ab95fa9c50869-3"&gt;&lt;/a&gt; [  3.,   4.,   3.,  13.],
&lt;a id="rest_code_68db081633154cf89a5ab95fa9c50869-4" name="rest_code_68db081633154cf89a5ab95fa9c50869-4" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-28/#rest_code_68db081633154cf89a5ab95fa9c50869-4"&gt;&lt;/a&gt; [ -1.,  -3.,   0., -13.]]
&lt;/pre&gt;&lt;/div&gt;
&lt;/section&gt;
&lt;section id="comparison-python-julia"&gt;
&lt;h3&gt;Comparison Python/Julia&lt;/h3&gt;
&lt;p&gt;Regarding number of lines we have: 23 in Python and 22 in Julia. The comparison
in execution time is done with &lt;code class="docutils literal"&gt;%timeit&lt;/code&gt; magic command in IPython and
&lt;code class="docutils literal"&gt;@benchmark&lt;/code&gt; in Julia.&lt;/p&gt;
&lt;p&gt;For Python:&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code IPython"&gt;&lt;a id="rest_code_b95828294fa84514975087bc3d9a1f59-1" name="rest_code_b95828294fa84514975087bc3d9a1f59-1" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-28/#rest_code_b95828294fa84514975087bc3d9a1f59-1"&gt;&lt;/a&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="k"&gt;timeit&lt;/span&gt; LU(np.random.rand(10, 10))
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;with result&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code text"&gt;&lt;a id="rest_code_5120c636e0b14b519f25ae3df36b2345-1" name="rest_code_5120c636e0b14b519f25ae3df36b2345-1" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-28/#rest_code_5120c636e0b14b519f25ae3df36b2345-1"&gt;&lt;/a&gt;1000 loops, best of 3: 303 µs per loop
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;For Julia:&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code julia"&gt;&lt;a id="rest_code_f22592feb7e946c3b76208228e45f853-1" name="rest_code_f22592feb7e946c3b76208228e45f853-1" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-28/#rest_code_f22592feb7e946c3b76208228e45f853-1"&gt;&lt;/a&gt;&lt;span class="nd"&gt;@benchmark&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;LU&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;rand&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;with result&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code julia"&gt;&lt;a id="rest_code_cf74b2e3bcd747778bcf6fc38b4c3be4-1" name="rest_code_cf74b2e3bcd747778bcf6fc38b4c3be4-1" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-28/#rest_code_cf74b2e3bcd747778bcf6fc38b4c3be4-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;BenchmarkTools&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Trial&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_cf74b2e3bcd747778bcf6fc38b4c3be4-2" name="rest_code_cf74b2e3bcd747778bcf6fc38b4c3be4-2" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-28/#rest_code_cf74b2e3bcd747778bcf6fc38b4c3be4-2"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;memory&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;estimate&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="mf"&gt;29.25&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;KiB&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_cf74b2e3bcd747778bcf6fc38b4c3be4-3" name="rest_code_cf74b2e3bcd747778bcf6fc38b4c3be4-3" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-28/#rest_code_cf74b2e3bcd747778bcf6fc38b4c3be4-3"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;allocs&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;estimate&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="mi"&gt;310&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_cf74b2e3bcd747778bcf6fc38b4c3be4-4" name="rest_code_cf74b2e3bcd747778bcf6fc38b4c3be4-4" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-28/#rest_code_cf74b2e3bcd747778bcf6fc38b4c3be4-4"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="o"&gt;--------------&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_cf74b2e3bcd747778bcf6fc38b4c3be4-5" name="rest_code_cf74b2e3bcd747778bcf6fc38b4c3be4-5" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-28/#rest_code_cf74b2e3bcd747778bcf6fc38b4c3be4-5"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;minimum&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;     &lt;/span&gt;&lt;span class="mf"&gt;9.993&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;μs&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;0.00&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;GC&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_cf74b2e3bcd747778bcf6fc38b4c3be4-6" name="rest_code_cf74b2e3bcd747778bcf6fc38b4c3be4-6" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-28/#rest_code_cf74b2e3bcd747778bcf6fc38b4c3be4-6"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;median&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="mf"&gt;11.725&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;μs&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;0.00&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;GC&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_cf74b2e3bcd747778bcf6fc38b4c3be4-7" name="rest_code_cf74b2e3bcd747778bcf6fc38b4c3be4-7" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-28/#rest_code_cf74b2e3bcd747778bcf6fc38b4c3be4-7"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;mean&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="mf"&gt;14.943&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;μs&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;15.90&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;GC&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_cf74b2e3bcd747778bcf6fc38b4c3be4-8" name="rest_code_cf74b2e3bcd747778bcf6fc38b4c3be4-8" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-28/#rest_code_cf74b2e3bcd747778bcf6fc38b4c3be4-8"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;maximum&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;     &lt;/span&gt;&lt;span class="mf"&gt;3.285&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ms&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;95.64&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;GC&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_cf74b2e3bcd747778bcf6fc38b4c3be4-9" name="rest_code_cf74b2e3bcd747778bcf6fc38b4c3be4-9" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-28/#rest_code_cf74b2e3bcd747778bcf6fc38b4c3be4-9"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="o"&gt;--------------&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_cf74b2e3bcd747778bcf6fc38b4c3be4-10" name="rest_code_cf74b2e3bcd747778bcf6fc38b4c3be4-10" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-28/#rest_code_cf74b2e3bcd747778bcf6fc38b4c3be4-10"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;samples&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;          &lt;/span&gt;&lt;span class="mi"&gt;10000&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_cf74b2e3bcd747778bcf6fc38b4c3be4-11" name="rest_code_cf74b2e3bcd747778bcf6fc38b4c3be4-11" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-28/#rest_code_cf74b2e3bcd747778bcf6fc38b4c3be4-11"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;evals&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;sample&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;     &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;In this case, we can say that the Python code is roughly 30 times slower than
Julia code.&lt;/p&gt;
&lt;/section&gt;
&lt;/section&gt;</description><category>julia</category><category>lu factorization</category><category>numerical methods</category><category>python</category><category>scientific computing</category><guid>https://nicoguaro.github.io/posts/numerical_challenge/numerical-28/</guid><pubDate>Sat, 28 Oct 2017 22:02:38 GMT</pubDate></item><item><title>Numerical methods challenge: Day 27</title><link>https://nicoguaro.github.io/posts/numerical_challenge/numerical-27/</link><dc:creator>Nicolás Guarín-Zapata</dc:creator><description>&lt;p&gt;During October (2017) I will write a program per day for some well-known
numerical methods in both Python and Julia. It is intended to be an exercise
then don't expect the code to be good enough for real use. Also,
I should mention that I have almost no experience with Julia, so it
probably won't be idiomatic Julia but more Python-like Julia.&lt;/p&gt;
&lt;section id="monte-carlo-integration"&gt;
&lt;h2&gt;Monte Carlo integration&lt;/h2&gt;
&lt;p&gt;Today we have &lt;a class="reference external" href="https://en.wikipedia.org/wiki/Monte_Carlo_integration"&gt;Monte Carlo integration&lt;/a&gt;.
Where we use random sampling to numerically compute an integral. This
method is important when we want to evaluate higher-dimensional
integrals since common quadrature techniques imply an exponential
growing in the number of sampling points.&lt;/p&gt;
&lt;p&gt;The method computes an integral&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
I = \int_\Omega f(x) dx
\end{equation*}
&lt;/div&gt;
&lt;p&gt;where &lt;span class="math"&gt;\(\Omega\)&lt;/span&gt; has volume &lt;span class="math"&gt;\(V\)&lt;/span&gt;.&lt;/p&gt;
&lt;p&gt;The integral is approximated as&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
I \approx \frac{V}{N} \sum_{i=1}^{N} f(x_i)
\end{equation*}
&lt;/div&gt;
&lt;p&gt;where the &lt;span class="math"&gt;\(x_i\)&lt;/span&gt; distribute uniform over &lt;span class="math"&gt;\(\Omega\)&lt;/span&gt;.&lt;/p&gt;
&lt;p&gt;Following are the codes&lt;/p&gt;
&lt;section id="python"&gt;
&lt;h3&gt;Python&lt;/h3&gt;
&lt;div class="code"&gt;&lt;pre class="code python"&gt;&lt;a id="rest_code_8d6f5a4436944e9d9dcbd78f430d2e41-1" name="rest_code_8d6f5a4436944e9d9dcbd78f430d2e41-1" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-27/#rest_code_8d6f5a4436944e9d9dcbd78f430d2e41-1"&gt;&lt;/a&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;__future__&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;division&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;print_function&lt;/span&gt;
&lt;a id="rest_code_8d6f5a4436944e9d9dcbd78f430d2e41-2" name="rest_code_8d6f5a4436944e9d9dcbd78f430d2e41-2" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-27/#rest_code_8d6f5a4436944e9d9dcbd78f430d2e41-2"&gt;&lt;/a&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;numpy&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;np&lt;/span&gt;
&lt;a id="rest_code_8d6f5a4436944e9d9dcbd78f430d2e41-3" name="rest_code_8d6f5a4436944e9d9dcbd78f430d2e41-3" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-27/#rest_code_8d6f5a4436944e9d9dcbd78f430d2e41-3"&gt;&lt;/a&gt;
&lt;a id="rest_code_8d6f5a4436944e9d9dcbd78f430d2e41-4" name="rest_code_8d6f5a4436944e9d9dcbd78f430d2e41-4" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-27/#rest_code_8d6f5a4436944e9d9dcbd78f430d2e41-4"&gt;&lt;/a&gt;
&lt;a id="rest_code_8d6f5a4436944e9d9dcbd78f430d2e41-5" name="rest_code_8d6f5a4436944e9d9dcbd78f430d2e41-5" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-27/#rest_code_8d6f5a4436944e9d9dcbd78f430d2e41-5"&gt;&lt;/a&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;monte_carlo_int&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;fun&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;low&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;high&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;args&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;()):&lt;/span&gt;
&lt;a id="rest_code_8d6f5a4436944e9d9dcbd78f430d2e41-6" name="rest_code_8d6f5a4436944e9d9dcbd78f430d2e41-6" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-27/#rest_code_8d6f5a4436944e9d9dcbd78f430d2e41-6"&gt;&lt;/a&gt;    &lt;span class="n"&gt;ndims&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;low&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_8d6f5a4436944e9d9dcbd78f430d2e41-7" name="rest_code_8d6f5a4436944e9d9dcbd78f430d2e41-7" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-27/#rest_code_8d6f5a4436944e9d9dcbd78f430d2e41-7"&gt;&lt;/a&gt;    &lt;span class="n"&gt;pts&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;random&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;uniform&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;low&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;low&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;high&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;high&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;size&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;ndims&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_8d6f5a4436944e9d9dcbd78f430d2e41-8" name="rest_code_8d6f5a4436944e9d9dcbd78f430d2e41-8" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-27/#rest_code_8d6f5a4436944e9d9dcbd78f430d2e41-8"&gt;&lt;/a&gt;    &lt;span class="n"&gt;V&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;prod&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;asarray&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;high&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;asarray&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;low&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_8d6f5a4436944e9d9dcbd78f430d2e41-9" name="rest_code_8d6f5a4436944e9d9dcbd78f430d2e41-9" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-27/#rest_code_8d6f5a4436944e9d9dcbd78f430d2e41-9"&gt;&lt;/a&gt;    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;V&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sum&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;fun&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;pts&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;args&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;
&lt;a id="rest_code_8d6f5a4436944e9d9dcbd78f430d2e41-10" name="rest_code_8d6f5a4436944e9d9dcbd78f430d2e41-10" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-27/#rest_code_8d6f5a4436944e9d9dcbd78f430d2e41-10"&gt;&lt;/a&gt;
&lt;a id="rest_code_8d6f5a4436944e9d9dcbd78f430d2e41-11" name="rest_code_8d6f5a4436944e9d9dcbd78f430d2e41-11" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-27/#rest_code_8d6f5a4436944e9d9dcbd78f430d2e41-11"&gt;&lt;/a&gt;
&lt;a id="rest_code_8d6f5a4436944e9d9dcbd78f430d2e41-12" name="rest_code_8d6f5a4436944e9d9dcbd78f430d2e41-12" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-27/#rest_code_8d6f5a4436944e9d9dcbd78f430d2e41-12"&gt;&lt;/a&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;circ&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;rad&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_8d6f5a4436944e9d9dcbd78f430d2e41-13" name="rest_code_8d6f5a4436944e9d9dcbd78f430d2e41-13" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-27/#rest_code_8d6f5a4436944e9d9dcbd78f430d2e41-13"&gt;&lt;/a&gt;    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="mf"&gt;0.5&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sign&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[:,&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[:,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;rad&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_8d6f5a4436944e9d9dcbd78f430d2e41-14" name="rest_code_8d6f5a4436944e9d9dcbd78f430d2e41-14" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-27/#rest_code_8d6f5a4436944e9d9dcbd78f430d2e41-14"&gt;&lt;/a&gt;
&lt;a id="rest_code_8d6f5a4436944e9d9dcbd78f430d2e41-15" name="rest_code_8d6f5a4436944e9d9dcbd78f430d2e41-15" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-27/#rest_code_8d6f5a4436944e9d9dcbd78f430d2e41-15"&gt;&lt;/a&gt;
&lt;a id="rest_code_8d6f5a4436944e9d9dcbd78f430d2e41-16" name="rest_code_8d6f5a4436944e9d9dcbd78f430d2e41-16" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-27/#rest_code_8d6f5a4436944e9d9dcbd78f430d2e41-16"&gt;&lt;/a&gt;&lt;span class="n"&gt;N&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;1000000&lt;/span&gt;
&lt;a id="rest_code_8d6f5a4436944e9d9dcbd78f430d2e41-17" name="rest_code_8d6f5a4436944e9d9dcbd78f430d2e41-17" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-27/#rest_code_8d6f5a4436944e9d9dcbd78f430d2e41-17"&gt;&lt;/a&gt;&lt;span class="n"&gt;low&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_8d6f5a4436944e9d9dcbd78f430d2e41-18" name="rest_code_8d6f5a4436944e9d9dcbd78f430d2e41-18" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-27/#rest_code_8d6f5a4436944e9d9dcbd78f430d2e41-18"&gt;&lt;/a&gt;&lt;span class="n"&gt;high&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_8d6f5a4436944e9d9dcbd78f430d2e41-19" name="rest_code_8d6f5a4436944e9d9dcbd78f430d2e41-19" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-27/#rest_code_8d6f5a4436944e9d9dcbd78f430d2e41-19"&gt;&lt;/a&gt;&lt;span class="n"&gt;rad&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;
&lt;a id="rest_code_8d6f5a4436944e9d9dcbd78f430d2e41-20" name="rest_code_8d6f5a4436944e9d9dcbd78f430d2e41-20" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-27/#rest_code_8d6f5a4436944e9d9dcbd78f430d2e41-20"&gt;&lt;/a&gt;&lt;span class="n"&gt;inte&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;monte_carlo_int&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;circ&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;low&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;high&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;args&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;rad&lt;/span&gt;&lt;span class="p"&gt;,))&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/section&gt;
&lt;section id="julia"&gt;
&lt;h3&gt;Julia&lt;/h3&gt;
&lt;div class="code"&gt;&lt;pre class="code julia"&gt;&lt;a id="rest_code_379898cf7698416d914d5b1c6ae1ffe6-1" name="rest_code_379898cf7698416d914d5b1c6ae1ffe6-1" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-27/#rest_code_379898cf7698416d914d5b1c6ae1ffe6-1"&gt;&lt;/a&gt;&lt;span class="k"&gt;using&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Distributions&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_379898cf7698416d914d5b1c6ae1ffe6-2" name="rest_code_379898cf7698416d914d5b1c6ae1ffe6-2" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-27/#rest_code_379898cf7698416d914d5b1c6ae1ffe6-2"&gt;&lt;/a&gt;
&lt;a id="rest_code_379898cf7698416d914d5b1c6ae1ffe6-3" name="rest_code_379898cf7698416d914d5b1c6ae1ffe6-3" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-27/#rest_code_379898cf7698416d914d5b1c6ae1ffe6-3"&gt;&lt;/a&gt;
&lt;a id="rest_code_379898cf7698416d914d5b1c6ae1ffe6-4" name="rest_code_379898cf7698416d914d5b1c6ae1ffe6-4" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-27/#rest_code_379898cf7698416d914d5b1c6ae1ffe6-4"&gt;&lt;/a&gt;&lt;span class="k"&gt;function&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;monte_carlo_int&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;fun&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;low&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;high&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;args&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_379898cf7698416d914d5b1c6ae1ffe6-5" name="rest_code_379898cf7698416d914d5b1c6ae1ffe6-5" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-27/#rest_code_379898cf7698416d914d5b1c6ae1ffe6-5"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;ndims&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;length&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;low&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_379898cf7698416d914d5b1c6ae1ffe6-6" name="rest_code_379898cf7698416d914d5b1c6ae1ffe6-6" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-27/#rest_code_379898cf7698416d914d5b1c6ae1ffe6-6"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;pts&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;rand&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Uniform&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ndims&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_379898cf7698416d914d5b1c6ae1ffe6-7" name="rest_code_379898cf7698416d914d5b1c6ae1ffe6-7" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-27/#rest_code_379898cf7698416d914d5b1c6ae1ffe6-7"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;for&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;cont&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="n"&gt;ndims&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_379898cf7698416d914d5b1c6ae1ffe6-8" name="rest_code_379898cf7698416d914d5b1c6ae1ffe6-8" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-27/#rest_code_379898cf7698416d914d5b1c6ae1ffe6-8"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;pts&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;cont&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;pts&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;cont&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;high&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;cont&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;low&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;cont&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;low&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;cont&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_379898cf7698416d914d5b1c6ae1ffe6-9" name="rest_code_379898cf7698416d914d5b1c6ae1ffe6-9" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-27/#rest_code_379898cf7698416d914d5b1c6ae1ffe6-9"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;end&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_379898cf7698416d914d5b1c6ae1ffe6-10" name="rest_code_379898cf7698416d914d5b1c6ae1ffe6-10" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-27/#rest_code_379898cf7698416d914d5b1c6ae1ffe6-10"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;V&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;prod&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;high&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;low&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_379898cf7698416d914d5b1c6ae1ffe6-11" name="rest_code_379898cf7698416d914d5b1c6ae1ffe6-11" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-27/#rest_code_379898cf7698416d914d5b1c6ae1ffe6-11"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;return&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;V&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;sum&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;fun&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;pts&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;args&lt;/span&gt;&lt;span class="o"&gt;...&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_379898cf7698416d914d5b1c6ae1ffe6-12" name="rest_code_379898cf7698416d914d5b1c6ae1ffe6-12" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-27/#rest_code_379898cf7698416d914d5b1c6ae1ffe6-12"&gt;&lt;/a&gt;&lt;span class="k"&gt;end&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_379898cf7698416d914d5b1c6ae1ffe6-13" name="rest_code_379898cf7698416d914d5b1c6ae1ffe6-13" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-27/#rest_code_379898cf7698416d914d5b1c6ae1ffe6-13"&gt;&lt;/a&gt;
&lt;a id="rest_code_379898cf7698416d914d5b1c6ae1ffe6-14" name="rest_code_379898cf7698416d914d5b1c6ae1ffe6-14" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-27/#rest_code_379898cf7698416d914d5b1c6ae1ffe6-14"&gt;&lt;/a&gt;
&lt;a id="rest_code_379898cf7698416d914d5b1c6ae1ffe6-15" name="rest_code_379898cf7698416d914d5b1c6ae1ffe6-15" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-27/#rest_code_379898cf7698416d914d5b1c6ae1ffe6-15"&gt;&lt;/a&gt;&lt;span class="k"&gt;function&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;circ&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;rad&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_379898cf7698416d914d5b1c6ae1ffe6-16" name="rest_code_379898cf7698416d914d5b1c6ae1ffe6-16" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-27/#rest_code_379898cf7698416d914d5b1c6ae1ffe6-16"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;return&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;0.5&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;sign&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.^&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.^&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;rad&lt;/span&gt;&lt;span class="o"&gt;^&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_379898cf7698416d914d5b1c6ae1ffe6-17" name="rest_code_379898cf7698416d914d5b1c6ae1ffe6-17" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-27/#rest_code_379898cf7698416d914d5b1c6ae1ffe6-17"&gt;&lt;/a&gt;&lt;span class="k"&gt;end&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_379898cf7698416d914d5b1c6ae1ffe6-18" name="rest_code_379898cf7698416d914d5b1c6ae1ffe6-18" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-27/#rest_code_379898cf7698416d914d5b1c6ae1ffe6-18"&gt;&lt;/a&gt;
&lt;a id="rest_code_379898cf7698416d914d5b1c6ae1ffe6-19" name="rest_code_379898cf7698416d914d5b1c6ae1ffe6-19" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-27/#rest_code_379898cf7698416d914d5b1c6ae1ffe6-19"&gt;&lt;/a&gt;
&lt;a id="rest_code_379898cf7698416d914d5b1c6ae1ffe6-20" name="rest_code_379898cf7698416d914d5b1c6ae1ffe6-20" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-27/#rest_code_379898cf7698416d914d5b1c6ae1ffe6-20"&gt;&lt;/a&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1000000&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_379898cf7698416d914d5b1c6ae1ffe6-21" name="rest_code_379898cf7698416d914d5b1c6ae1ffe6-21" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-27/#rest_code_379898cf7698416d914d5b1c6ae1ffe6-21"&gt;&lt;/a&gt;&lt;span class="n"&gt;low&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_379898cf7698416d914d5b1c6ae1ffe6-22" name="rest_code_379898cf7698416d914d5b1c6ae1ffe6-22" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-27/#rest_code_379898cf7698416d914d5b1c6ae1ffe6-22"&gt;&lt;/a&gt;&lt;span class="n"&gt;high&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_379898cf7698416d914d5b1c6ae1ffe6-23" name="rest_code_379898cf7698416d914d5b1c6ae1ffe6-23" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-27/#rest_code_379898cf7698416d914d5b1c6ae1ffe6-23"&gt;&lt;/a&gt;&lt;span class="n"&gt;rad&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_379898cf7698416d914d5b1c6ae1ffe6-24" name="rest_code_379898cf7698416d914d5b1c6ae1ffe6-24" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-27/#rest_code_379898cf7698416d914d5b1c6ae1ffe6-24"&gt;&lt;/a&gt;&lt;span class="n"&gt;inte&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;monte_carlo_int&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;circ&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;low&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;high&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;args&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;rad&lt;/span&gt;&lt;span class="p"&gt;,))&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;One of the most common examples is the computation of &lt;span class="math"&gt;\(\pi\)&lt;/span&gt;, this
is illustrated in the following animation.&lt;/p&gt;
&lt;img alt="Pi approximation using Monte Carlo." class="align-center" src="https://upload.wikimedia.org/wikipedia/commons/8/84/Pi_30K.gif" style="width: 500px;"&gt;
&lt;/section&gt;
&lt;section id="comparison-python-julia"&gt;
&lt;h3&gt;Comparison Python/Julia&lt;/h3&gt;
&lt;p&gt;Regarding number of lines we have: 20 in Python and 24 in Julia. The comparison
in execution time is done with &lt;code class="docutils literal"&gt;%timeit&lt;/code&gt; magic command in IPython and
&lt;code class="docutils literal"&gt;@benchmark&lt;/code&gt; in Julia.&lt;/p&gt;
&lt;p&gt;For Python:&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code IPython"&gt;&lt;a id="rest_code_3367e348482a431bb239a1862a76b340-1" name="rest_code_3367e348482a431bb239a1862a76b340-1" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-27/#rest_code_3367e348482a431bb239a1862a76b340-1"&gt;&lt;/a&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="k"&gt;timeit&lt;/span&gt; monte_carlo_int(circ, N, low, high, args=(rad,))
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;with result&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code text"&gt;&lt;a id="rest_code_4bd59936f8e643c7968fea4a227da76f-1" name="rest_code_4bd59936f8e643c7968fea4a227da76f-1" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-27/#rest_code_4bd59936f8e643c7968fea4a227da76f-1"&gt;&lt;/a&gt;10 loops, best of 3: 53.2 ms per loop
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;For Julia:&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code julia"&gt;&lt;a id="rest_code_1869c4fee4d54c329f6e6245ce5aff9e-1" name="rest_code_1869c4fee4d54c329f6e6245ce5aff9e-1" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-27/#rest_code_1869c4fee4d54c329f6e6245ce5aff9e-1"&gt;&lt;/a&gt;&lt;span class="nd"&gt;@benchmark&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;monte_carlo_int&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;circ&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;low&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;high&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;args&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;rad&lt;/span&gt;&lt;span class="p"&gt;,))&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;with result&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code julia"&gt;&lt;a id="rest_code_7a957afc376742ee8fdf3eca019635b7-1" name="rest_code_7a957afc376742ee8fdf3eca019635b7-1" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-27/#rest_code_7a957afc376742ee8fdf3eca019635b7-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;BenchmarkTools&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Trial&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_7a957afc376742ee8fdf3eca019635b7-2" name="rest_code_7a957afc376742ee8fdf3eca019635b7-2" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-27/#rest_code_7a957afc376742ee8fdf3eca019635b7-2"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;memory&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;estimate&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="mf"&gt;129.70&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;MiB&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_7a957afc376742ee8fdf3eca019635b7-3" name="rest_code_7a957afc376742ee8fdf3eca019635b7-3" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-27/#rest_code_7a957afc376742ee8fdf3eca019635b7-3"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;allocs&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;estimate&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="mi"&gt;46&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_7a957afc376742ee8fdf3eca019635b7-4" name="rest_code_7a957afc376742ee8fdf3eca019635b7-4" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-27/#rest_code_7a957afc376742ee8fdf3eca019635b7-4"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="o"&gt;--------------&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_7a957afc376742ee8fdf3eca019635b7-5" name="rest_code_7a957afc376742ee8fdf3eca019635b7-5" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-27/#rest_code_7a957afc376742ee8fdf3eca019635b7-5"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;minimum&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;     &lt;/span&gt;&lt;span class="mf"&gt;60.131&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ms&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;5.15&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;GC&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_7a957afc376742ee8fdf3eca019635b7-6" name="rest_code_7a957afc376742ee8fdf3eca019635b7-6" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-27/#rest_code_7a957afc376742ee8fdf3eca019635b7-6"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;median&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="mf"&gt;164.018&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ms&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;55.64&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;GC&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_7a957afc376742ee8fdf3eca019635b7-7" name="rest_code_7a957afc376742ee8fdf3eca019635b7-7" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-27/#rest_code_7a957afc376742ee8fdf3eca019635b7-7"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;mean&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="mf"&gt;204.366&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ms&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;49.50&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;GC&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_7a957afc376742ee8fdf3eca019635b7-8" name="rest_code_7a957afc376742ee8fdf3eca019635b7-8" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-27/#rest_code_7a957afc376742ee8fdf3eca019635b7-8"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;maximum&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;     &lt;/span&gt;&lt;span class="mf"&gt;357.749&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ms&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;64.04&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;GC&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_7a957afc376742ee8fdf3eca019635b7-9" name="rest_code_7a957afc376742ee8fdf3eca019635b7-9" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-27/#rest_code_7a957afc376742ee8fdf3eca019635b7-9"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="o"&gt;--------------&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_7a957afc376742ee8fdf3eca019635b7-10" name="rest_code_7a957afc376742ee8fdf3eca019635b7-10" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-27/#rest_code_7a957afc376742ee8fdf3eca019635b7-10"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;samples&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;          &lt;/span&gt;&lt;span class="mi"&gt;25&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_7a957afc376742ee8fdf3eca019635b7-11" name="rest_code_7a957afc376742ee8fdf3eca019635b7-11" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-27/#rest_code_7a957afc376742ee8fdf3eca019635b7-11"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;evals&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;sample&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;     &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;In this case, we can say that the Python code is roughly 3 times faster than
Julia code.&lt;/p&gt;
&lt;/section&gt;
&lt;/section&gt;</description><category>julia</category><category>monte carlo</category><category>numerical methods</category><category>python</category><category>scientific computing</category><guid>https://nicoguaro.github.io/posts/numerical_challenge/numerical-27/</guid><pubDate>Sat, 28 Oct 2017 02:27:06 GMT</pubDate></item><item><title>Numerical methods challenge: Day 26</title><link>https://nicoguaro.github.io/posts/numerical_challenge/numerical-26/</link><dc:creator>Nicolás Guarín-Zapata</dc:creator><description>&lt;p&gt;During October (2017) I will write a program per day for some well-known
numerical methods in both Python and Julia. It is intended to be an exercise
then don't expect the code to be good enough for real use. Also,
I should mention that I have almost no experience with Julia, so it
probably won't be idiomatic Julia but more Python-like Julia.&lt;/p&gt;
&lt;section id="boundary-element-method"&gt;
&lt;h2&gt;Boundary element method&lt;/h2&gt;
&lt;p&gt;Today we have the &lt;a class="reference external" href="https://en.wikipedia.org/wiki/Boundary_element_method"&gt;Boundary element method&lt;/a&gt;
, or, an attempt. We want so solve the equation&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
\nabla^2 u = -f(x)
\end{equation*}
&lt;/div&gt;
&lt;p&gt;with&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
u(x) = g(x),\quad \forall (x, y)\in \partial \Omega
\end{equation*}
&lt;/div&gt;
&lt;p&gt;For this method, we need to use an integral representation of the equation,
that in this case is&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
u(\xi)  = \int_{S} [u(x) F(x, \xi) - q(x)G(x, \xi)]dS(x) +
          \int_{V} f(x) G(x, \xi) dV(x)
\end{equation*}
&lt;/div&gt;
&lt;p&gt;with&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
G(x,\xi)= -\frac{1}{2\pi}\ln|x- \xi|
\end{equation*}
&lt;/div&gt;
&lt;p&gt;and&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
F(x,\xi) = -\frac{1}{2\pi |x- \xi|^2}(x - \xi)\cdot\hat{n}
\end{equation*}
&lt;/div&gt;
&lt;p&gt;Then, we can form a system of equations&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
[G]\{q\} = [F]\{u\}\, ,
\end{equation*}
&lt;/div&gt;
&lt;p&gt;that we obtain by discretization of the boundary. If we take constant
variables over the discretization, the integral can be computed analytically
by&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
G_{nm} = -\frac{1}{2\pi}\left[r \sin\theta\left(\ln|r| - 1\right)
         + \theta r\cos\theta\right]^{\theta_B, r_B}_{\theta_A, r_A}
\end{equation*}
&lt;/div&gt;
&lt;p&gt;and&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
F_{nm} = \left[\frac{\theta}{2\pi}\right]^{\theta_B}_{\theta_A}
\end{equation*}
&lt;/div&gt;
&lt;p&gt;for points &lt;span class="math"&gt;\(n\)&lt;/span&gt; and &lt;span class="math"&gt;\(m\)&lt;/span&gt; in different elements, and the subindices
&lt;span class="math"&gt;\(A,B\)&lt;/span&gt; refer to the endpoints of the evaluation element. For diagonal
terms the integrals evaluate to&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
G_{nn} = -\frac{L}{2\pi}\left(\ln\left\vert\frac{L}{2}\right\vert - 1\right)
\end{equation*}
&lt;/div&gt;
&lt;p&gt;and&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
F_{nn} = - \frac{1}{2\pi}
\end{equation*}
&lt;/div&gt;
&lt;p&gt;with &lt;span class="math"&gt;\(L\)&lt;/span&gt; the size of the element.&lt;/p&gt;
&lt;p&gt;Below is the Python code. In this case, I did not succeed and the
code is not working right now.&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code python"&gt;&lt;a id="rest_code_7054b7f9b02f4ba9bececeb83519e1cb-1" name="rest_code_7054b7f9b02f4ba9bececeb83519e1cb-1" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-26/#rest_code_7054b7f9b02f4ba9bececeb83519e1cb-1"&gt;&lt;/a&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;__future__&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;division&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;print_function&lt;/span&gt;
&lt;a id="rest_code_7054b7f9b02f4ba9bececeb83519e1cb-2" name="rest_code_7054b7f9b02f4ba9bececeb83519e1cb-2" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-26/#rest_code_7054b7f9b02f4ba9bececeb83519e1cb-2"&gt;&lt;/a&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;numpy&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;np&lt;/span&gt;
&lt;a id="rest_code_7054b7f9b02f4ba9bececeb83519e1cb-3" name="rest_code_7054b7f9b02f4ba9bececeb83519e1cb-3" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-26/#rest_code_7054b7f9b02f4ba9bececeb83519e1cb-3"&gt;&lt;/a&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;numpy&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;log&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;sin&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;cos&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;arctan2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;pi&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;mean&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;arctan&lt;/span&gt;
&lt;a id="rest_code_7054b7f9b02f4ba9bececeb83519e1cb-4" name="rest_code_7054b7f9b02f4ba9bececeb83519e1cb-4" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-26/#rest_code_7054b7f9b02f4ba9bececeb83519e1cb-4"&gt;&lt;/a&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;numpy.linalg&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;norm&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;solve&lt;/span&gt;
&lt;a id="rest_code_7054b7f9b02f4ba9bececeb83519e1cb-5" name="rest_code_7054b7f9b02f4ba9bececeb83519e1cb-5" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-26/#rest_code_7054b7f9b02f4ba9bececeb83519e1cb-5"&gt;&lt;/a&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;matplotlib.pyplot&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;plt&lt;/span&gt;
&lt;a id="rest_code_7054b7f9b02f4ba9bececeb83519e1cb-6" name="rest_code_7054b7f9b02f4ba9bececeb83519e1cb-6" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-26/#rest_code_7054b7f9b02f4ba9bececeb83519e1cb-6"&gt;&lt;/a&gt;
&lt;a id="rest_code_7054b7f9b02f4ba9bececeb83519e1cb-7" name="rest_code_7054b7f9b02f4ba9bececeb83519e1cb-7" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-26/#rest_code_7054b7f9b02f4ba9bececeb83519e1cb-7"&gt;&lt;/a&gt;
&lt;a id="rest_code_7054b7f9b02f4ba9bececeb83519e1cb-8" name="rest_code_7054b7f9b02f4ba9bececeb83519e1cb-8" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-26/#rest_code_7054b7f9b02f4ba9bececeb83519e1cb-8"&gt;&lt;/a&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;assem&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;elems&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_7054b7f9b02f4ba9bececeb83519e1cb-9" name="rest_code_7054b7f9b02f4ba9bececeb83519e1cb-9" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-26/#rest_code_7054b7f9b02f4ba9bececeb83519e1cb-9"&gt;&lt;/a&gt;    &lt;span class="n"&gt;nelems&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;elems&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;shape&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_7054b7f9b02f4ba9bececeb83519e1cb-10" name="rest_code_7054b7f9b02f4ba9bececeb83519e1cb-10" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-26/#rest_code_7054b7f9b02f4ba9bececeb83519e1cb-10"&gt;&lt;/a&gt;    &lt;span class="n"&gt;Gmat&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="n"&gt;nelems&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;nelems&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_7054b7f9b02f4ba9bececeb83519e1cb-11" name="rest_code_7054b7f9b02f4ba9bececeb83519e1cb-11" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-26/#rest_code_7054b7f9b02f4ba9bececeb83519e1cb-11"&gt;&lt;/a&gt;    &lt;span class="n"&gt;Fmat&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="n"&gt;nelems&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;nelems&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_7054b7f9b02f4ba9bececeb83519e1cb-12" name="rest_code_7054b7f9b02f4ba9bececeb83519e1cb-12" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-26/#rest_code_7054b7f9b02f4ba9bececeb83519e1cb-12"&gt;&lt;/a&gt;    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;ev_cont&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;elem1&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;enumerate&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;elems&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_7054b7f9b02f4ba9bececeb83519e1cb-13" name="rest_code_7054b7f9b02f4ba9bececeb83519e1cb-13" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-26/#rest_code_7054b7f9b02f4ba9bececeb83519e1cb-13"&gt;&lt;/a&gt;        &lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;elem1&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]],&lt;/span&gt; &lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;elem1&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]])&lt;/span&gt;
&lt;a id="rest_code_7054b7f9b02f4ba9bececeb83519e1cb-14" name="rest_code_7054b7f9b02f4ba9bececeb83519e1cb-14" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-26/#rest_code_7054b7f9b02f4ba9bececeb83519e1cb-14"&gt;&lt;/a&gt;        &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;col_cont&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;elem2&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;enumerate&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;elems&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_7054b7f9b02f4ba9bececeb83519e1cb-15" name="rest_code_7054b7f9b02f4ba9bececeb83519e1cb-15" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-26/#rest_code_7054b7f9b02f4ba9bececeb83519e1cb-15"&gt;&lt;/a&gt;            &lt;span class="n"&gt;pt_col&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;mean&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;elem2&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;axis&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_7054b7f9b02f4ba9bececeb83519e1cb-16" name="rest_code_7054b7f9b02f4ba9bececeb83519e1cb-16" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-26/#rest_code_7054b7f9b02f4ba9bececeb83519e1cb-16"&gt;&lt;/a&gt;            &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;ev_cont&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="n"&gt;col_cont&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a id="rest_code_7054b7f9b02f4ba9bececeb83519e1cb-17" name="rest_code_7054b7f9b02f4ba9bececeb83519e1cb-17" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-26/#rest_code_7054b7f9b02f4ba9bececeb83519e1cb-17"&gt;&lt;/a&gt;                &lt;span class="n"&gt;L&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;norm&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;elem1&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]]&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;elem1&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]])&lt;/span&gt;
&lt;a id="rest_code_7054b7f9b02f4ba9bececeb83519e1cb-18" name="rest_code_7054b7f9b02f4ba9bececeb83519e1cb-18" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-26/#rest_code_7054b7f9b02f4ba9bececeb83519e1cb-18"&gt;&lt;/a&gt;                &lt;span class="n"&gt;Gmat&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ev_cont&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;ev_cont&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;L&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;pi&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;log&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;L&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_7054b7f9b02f4ba9bececeb83519e1cb-19" name="rest_code_7054b7f9b02f4ba9bececeb83519e1cb-19" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-26/#rest_code_7054b7f9b02f4ba9bececeb83519e1cb-19"&gt;&lt;/a&gt;                &lt;span class="n"&gt;Fmat&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ev_cont&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;ev_cont&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="mf"&gt;0.5&lt;/span&gt;
&lt;a id="rest_code_7054b7f9b02f4ba9bececeb83519e1cb-20" name="rest_code_7054b7f9b02f4ba9bececeb83519e1cb-20" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-26/#rest_code_7054b7f9b02f4ba9bececeb83519e1cb-20"&gt;&lt;/a&gt;            &lt;span class="k"&gt;else&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a id="rest_code_7054b7f9b02f4ba9bececeb83519e1cb-21" name="rest_code_7054b7f9b02f4ba9bececeb83519e1cb-21" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-26/#rest_code_7054b7f9b02f4ba9bececeb83519e1cb-21"&gt;&lt;/a&gt;                &lt;span class="n"&gt;Gij&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;Fij&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;influence_coeff&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;elem1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;pt_col&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_7054b7f9b02f4ba9bececeb83519e1cb-22" name="rest_code_7054b7f9b02f4ba9bececeb83519e1cb-22" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-26/#rest_code_7054b7f9b02f4ba9bececeb83519e1cb-22"&gt;&lt;/a&gt;                &lt;span class="n"&gt;Gmat&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ev_cont&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;col_cont&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Gij&lt;/span&gt;
&lt;a id="rest_code_7054b7f9b02f4ba9bececeb83519e1cb-23" name="rest_code_7054b7f9b02f4ba9bececeb83519e1cb-23" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-26/#rest_code_7054b7f9b02f4ba9bececeb83519e1cb-23"&gt;&lt;/a&gt;                &lt;span class="n"&gt;Fmat&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ev_cont&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;col_cont&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Fij&lt;/span&gt;
&lt;a id="rest_code_7054b7f9b02f4ba9bececeb83519e1cb-24" name="rest_code_7054b7f9b02f4ba9bececeb83519e1cb-24" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-26/#rest_code_7054b7f9b02f4ba9bececeb83519e1cb-24"&gt;&lt;/a&gt;    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;Gmat&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;Fmat&lt;/span&gt;
&lt;a id="rest_code_7054b7f9b02f4ba9bececeb83519e1cb-25" name="rest_code_7054b7f9b02f4ba9bececeb83519e1cb-25" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-26/#rest_code_7054b7f9b02f4ba9bececeb83519e1cb-25"&gt;&lt;/a&gt;
&lt;a id="rest_code_7054b7f9b02f4ba9bececeb83519e1cb-26" name="rest_code_7054b7f9b02f4ba9bececeb83519e1cb-26" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-26/#rest_code_7054b7f9b02f4ba9bececeb83519e1cb-26"&gt;&lt;/a&gt;
&lt;a id="rest_code_7054b7f9b02f4ba9bececeb83519e1cb-27" name="rest_code_7054b7f9b02f4ba9bececeb83519e1cb-27" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-26/#rest_code_7054b7f9b02f4ba9bececeb83519e1cb-27"&gt;&lt;/a&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;influence_coeff&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;elem&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;pt_col&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_7054b7f9b02f4ba9bececeb83519e1cb-28" name="rest_code_7054b7f9b02f4ba9bececeb83519e1cb-28" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-26/#rest_code_7054b7f9b02f4ba9bececeb83519e1cb-28"&gt;&lt;/a&gt;    &lt;span class="n"&gt;r_A&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;elem&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]]&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;pt_col&lt;/span&gt;
&lt;a id="rest_code_7054b7f9b02f4ba9bececeb83519e1cb-29" name="rest_code_7054b7f9b02f4ba9bececeb83519e1cb-29" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-26/#rest_code_7054b7f9b02f4ba9bececeb83519e1cb-29"&gt;&lt;/a&gt;    &lt;span class="n"&gt;r_B&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;elem&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]]&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;pt_col&lt;/span&gt;
&lt;a id="rest_code_7054b7f9b02f4ba9bececeb83519e1cb-30" name="rest_code_7054b7f9b02f4ba9bececeb83519e1cb-30" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-26/#rest_code_7054b7f9b02f4ba9bececeb83519e1cb-30"&gt;&lt;/a&gt;    &lt;span class="n"&gt;theta_A&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;arctan2&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;r_A&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;r_A&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_7054b7f9b02f4ba9bececeb83519e1cb-31" name="rest_code_7054b7f9b02f4ba9bececeb83519e1cb-31" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-26/#rest_code_7054b7f9b02f4ba9bececeb83519e1cb-31"&gt;&lt;/a&gt;    &lt;span class="n"&gt;theta_B&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;arctan2&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;r_B&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;r_B&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_7054b7f9b02f4ba9bececeb83519e1cb-32" name="rest_code_7054b7f9b02f4ba9bececeb83519e1cb-32" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-26/#rest_code_7054b7f9b02f4ba9bececeb83519e1cb-32"&gt;&lt;/a&gt;    &lt;span class="n"&gt;G_coeff&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;r_B&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;log&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;norm&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;r_B&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;theta_B&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;r_B&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;\
&lt;a id="rest_code_7054b7f9b02f4ba9bececeb83519e1cb-33" name="rest_code_7054b7f9b02f4ba9bececeb83519e1cb-33" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-26/#rest_code_7054b7f9b02f4ba9bececeb83519e1cb-33"&gt;&lt;/a&gt;              &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;r_A&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;log&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;norm&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;r_A&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;theta_A&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;r_A&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_7054b7f9b02f4ba9bececeb83519e1cb-34" name="rest_code_7054b7f9b02f4ba9bececeb83519e1cb-34" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-26/#rest_code_7054b7f9b02f4ba9bececeb83519e1cb-34"&gt;&lt;/a&gt;    &lt;span class="n"&gt;F_coeff&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;theta_B&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;theta_A&lt;/span&gt;
&lt;a id="rest_code_7054b7f9b02f4ba9bececeb83519e1cb-35" name="rest_code_7054b7f9b02f4ba9bececeb83519e1cb-35" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-26/#rest_code_7054b7f9b02f4ba9bececeb83519e1cb-35"&gt;&lt;/a&gt;    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;G_coeff&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;pi&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;F_coeff&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;pi&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_7054b7f9b02f4ba9bececeb83519e1cb-36" name="rest_code_7054b7f9b02f4ba9bececeb83519e1cb-36" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-26/#rest_code_7054b7f9b02f4ba9bececeb83519e1cb-36"&gt;&lt;/a&gt;
&lt;a id="rest_code_7054b7f9b02f4ba9bececeb83519e1cb-37" name="rest_code_7054b7f9b02f4ba9bececeb83519e1cb-37" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-26/#rest_code_7054b7f9b02f4ba9bececeb83519e1cb-37"&gt;&lt;/a&gt;
&lt;a id="rest_code_7054b7f9b02f4ba9bececeb83519e1cb-38" name="rest_code_7054b7f9b02f4ba9bececeb83519e1cb-38" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-26/#rest_code_7054b7f9b02f4ba9bececeb83519e1cb-38"&gt;&lt;/a&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;eval_sol&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ev_coords&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_7054b7f9b02f4ba9bececeb83519e1cb-39" name="rest_code_7054b7f9b02f4ba9bececeb83519e1cb-39" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-26/#rest_code_7054b7f9b02f4ba9bececeb83519e1cb-39"&gt;&lt;/a&gt;    &lt;span class="n"&gt;nelems&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;elems&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;shape&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_7054b7f9b02f4ba9bececeb83519e1cb-40" name="rest_code_7054b7f9b02f4ba9bececeb83519e1cb-40" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-26/#rest_code_7054b7f9b02f4ba9bececeb83519e1cb-40"&gt;&lt;/a&gt;    &lt;span class="n"&gt;Gmat&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="n"&gt;nelems&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;nelems&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_7054b7f9b02f4ba9bececeb83519e1cb-41" name="rest_code_7054b7f9b02f4ba9bececeb83519e1cb-41" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-26/#rest_code_7054b7f9b02f4ba9bececeb83519e1cb-41"&gt;&lt;/a&gt;    &lt;span class="n"&gt;Fmat&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="n"&gt;nelems&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;nelems&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_7054b7f9b02f4ba9bececeb83519e1cb-42" name="rest_code_7054b7f9b02f4ba9bececeb83519e1cb-42" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-26/#rest_code_7054b7f9b02f4ba9bececeb83519e1cb-42"&gt;&lt;/a&gt;    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;ev_cont&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;elem1&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;enumerate&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;elems&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_7054b7f9b02f4ba9bececeb83519e1cb-43" name="rest_code_7054b7f9b02f4ba9bececeb83519e1cb-43" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-26/#rest_code_7054b7f9b02f4ba9bececeb83519e1cb-43"&gt;&lt;/a&gt;        &lt;span class="n"&gt;L&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;norm&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;elem1&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]]&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;elem1&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]])&lt;/span&gt;
&lt;a id="rest_code_7054b7f9b02f4ba9bececeb83519e1cb-44" name="rest_code_7054b7f9b02f4ba9bececeb83519e1cb-44" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-26/#rest_code_7054b7f9b02f4ba9bececeb83519e1cb-44"&gt;&lt;/a&gt;        &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;col_cont&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;elem2&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;enumerate&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;elems&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_7054b7f9b02f4ba9bececeb83519e1cb-45" name="rest_code_7054b7f9b02f4ba9bececeb83519e1cb-45" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-26/#rest_code_7054b7f9b02f4ba9bececeb83519e1cb-45"&gt;&lt;/a&gt;            &lt;span class="n"&gt;pt_col&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;mean&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;elem2&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;axis&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_7054b7f9b02f4ba9bececeb83519e1cb-46" name="rest_code_7054b7f9b02f4ba9bececeb83519e1cb-46" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-26/#rest_code_7054b7f9b02f4ba9bececeb83519e1cb-46"&gt;&lt;/a&gt;            &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;ev_cont&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="n"&gt;col_cont&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a id="rest_code_7054b7f9b02f4ba9bececeb83519e1cb-47" name="rest_code_7054b7f9b02f4ba9bececeb83519e1cb-47" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-26/#rest_code_7054b7f9b02f4ba9bececeb83519e1cb-47"&gt;&lt;/a&gt;                &lt;span class="n"&gt;Gmat&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ev_cont&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;ev_cont&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;L&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;pi&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;log&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;L&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_7054b7f9b02f4ba9bececeb83519e1cb-48" name="rest_code_7054b7f9b02f4ba9bececeb83519e1cb-48" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-26/#rest_code_7054b7f9b02f4ba9bececeb83519e1cb-48"&gt;&lt;/a&gt;                &lt;span class="n"&gt;Fmat&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ev_cont&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;ev_cont&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="mf"&gt;0.5&lt;/span&gt;
&lt;a id="rest_code_7054b7f9b02f4ba9bececeb83519e1cb-49" name="rest_code_7054b7f9b02f4ba9bececeb83519e1cb-49" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-26/#rest_code_7054b7f9b02f4ba9bececeb83519e1cb-49"&gt;&lt;/a&gt;            &lt;span class="k"&gt;else&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a id="rest_code_7054b7f9b02f4ba9bececeb83519e1cb-50" name="rest_code_7054b7f9b02f4ba9bececeb83519e1cb-50" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-26/#rest_code_7054b7f9b02f4ba9bececeb83519e1cb-50"&gt;&lt;/a&gt;                &lt;span class="n"&gt;Gmat&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ev_cont&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;col_cont&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;Fmat&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ev_cont&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;col_cont&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; \
&lt;a id="rest_code_7054b7f9b02f4ba9bececeb83519e1cb-51" name="rest_code_7054b7f9b02f4ba9bececeb83519e1cb-51" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-26/#rest_code_7054b7f9b02f4ba9bececeb83519e1cb-51"&gt;&lt;/a&gt;                    &lt;span class="n"&gt;influence_coeff&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;elem1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;pt_col&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_7054b7f9b02f4ba9bececeb83519e1cb-52" name="rest_code_7054b7f9b02f4ba9bececeb83519e1cb-52" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-26/#rest_code_7054b7f9b02f4ba9bececeb83519e1cb-52"&gt;&lt;/a&gt;
&lt;a id="rest_code_7054b7f9b02f4ba9bececeb83519e1cb-53" name="rest_code_7054b7f9b02f4ba9bececeb83519e1cb-53" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-26/#rest_code_7054b7f9b02f4ba9bececeb83519e1cb-53"&gt;&lt;/a&gt;&lt;span class="n"&gt;nelems&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt;
&lt;a id="rest_code_7054b7f9b02f4ba9bececeb83519e1cb-54" name="rest_code_7054b7f9b02f4ba9bececeb83519e1cb-54" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-26/#rest_code_7054b7f9b02f4ba9bececeb83519e1cb-54"&gt;&lt;/a&gt;&lt;span class="n"&gt;rad&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;1.0&lt;/span&gt;
&lt;a id="rest_code_7054b7f9b02f4ba9bececeb83519e1cb-55" name="rest_code_7054b7f9b02f4ba9bececeb83519e1cb-55" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-26/#rest_code_7054b7f9b02f4ba9bececeb83519e1cb-55"&gt;&lt;/a&gt;&lt;span class="n"&gt;theta&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt;  &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;linspace&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;pi&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;nelems&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;endpoint&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;False&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_7054b7f9b02f4ba9bececeb83519e1cb-56" name="rest_code_7054b7f9b02f4ba9bececeb83519e1cb-56" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-26/#rest_code_7054b7f9b02f4ba9bececeb83519e1cb-56"&gt;&lt;/a&gt;&lt;span class="n"&gt;coords&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;rad&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;vstack&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="n"&gt;cos&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;theta&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;sin&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;theta&lt;/span&gt;&lt;span class="p"&gt;)))&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;T&lt;/span&gt;
&lt;a id="rest_code_7054b7f9b02f4ba9bececeb83519e1cb-57" name="rest_code_7054b7f9b02f4ba9bececeb83519e1cb-57" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-26/#rest_code_7054b7f9b02f4ba9bececeb83519e1cb-57"&gt;&lt;/a&gt;&lt;span class="n"&gt;elems&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;([[&lt;/span&gt;&lt;span class="n"&gt;cont&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;cont&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="n"&gt;nelems&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;cont&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;nelems&lt;/span&gt;&lt;span class="p"&gt;)])&lt;/span&gt;
&lt;a id="rest_code_7054b7f9b02f4ba9bececeb83519e1cb-58" name="rest_code_7054b7f9b02f4ba9bececeb83519e1cb-58" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-26/#rest_code_7054b7f9b02f4ba9bececeb83519e1cb-58"&gt;&lt;/a&gt;&lt;span class="n"&gt;Gmat&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;Fmat&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;assem&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;elems&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_7054b7f9b02f4ba9bececeb83519e1cb-59" name="rest_code_7054b7f9b02f4ba9bececeb83519e1cb-59" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-26/#rest_code_7054b7f9b02f4ba9bececeb83519e1cb-59"&gt;&lt;/a&gt;&lt;span class="n"&gt;u_boundary&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ones_like&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;theta&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_7054b7f9b02f4ba9bececeb83519e1cb-60" name="rest_code_7054b7f9b02f4ba9bececeb83519e1cb-60" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-26/#rest_code_7054b7f9b02f4ba9bececeb83519e1cb-60"&gt;&lt;/a&gt;&lt;span class="n"&gt;q_boundary&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;solve&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Gmat&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;Fmat&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;dot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;u_boundary&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/section&gt;</description><category>boundary element method</category><category>julia</category><category>numerical methods</category><category>python</category><category>scientific computing</category><guid>https://nicoguaro.github.io/posts/numerical_challenge/numerical-26/</guid><pubDate>Fri, 27 Oct 2017 00:15:08 GMT</pubDate></item><item><title>Numerical methods challenge: Day 25</title><link>https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/</link><dc:creator>Nicolás Guarín-Zapata</dc:creator><description>&lt;p&gt;During October (2017) I will write a program per day for some well-known
numerical methods in both Python and Julia. It is intended to be an exercise
then don't expect the code to be good enough for real use. Also,
I should mention that I have almost no experience with Julia, so it
probably won't be idiomatic Julia but more Python-like Julia.&lt;/p&gt;
&lt;section id="finite-element-method"&gt;
&lt;h2&gt;Finite element method&lt;/h2&gt;
&lt;p&gt;Today we have the &lt;a class="reference external" href="https://en.wikipedia.org/wiki/Finite_element_method"&gt;Finite element method&lt;/a&gt;
to solve the equation:&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
\nabla^2 u = -f(x)
\end{equation*}
&lt;/div&gt;
&lt;p&gt;with&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
u(\sqrt{3}, 1) = 0
\end{equation*}
&lt;/div&gt;
&lt;p&gt;As in the &lt;a class="reference external" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/posts/numerical-23"&gt;Ritz method&lt;/a&gt; we form
a functional that is &lt;em&gt;equivalent&lt;/em&gt; to the
differential equation, propose an approximation as a linear combination of
a set of basis functions and find the &lt;em&gt;best&lt;/em&gt; set of coefficients for that
combination. That &lt;em&gt;best&lt;/em&gt; solution is found minimizing the functional.&lt;/p&gt;
&lt;p&gt;The functional for this differential equation is&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
\Pi[u] = -\int_\Omega \left(\nabla u\right)^2 d\Omega
         -\int_\Omega  u f(x) d\Omega
\end{equation*}
&lt;/div&gt;
&lt;p&gt;Using linear triangles, the local stiffness matrices read&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
K_\text{local} =  \frac{1}{2|J|}
    \begin{bmatrix}
        2 &amp;amp; -1 &amp;amp;1\\
        -1 &amp;amp; 1 &amp;amp;0\\
        -1 &amp;amp; 0 &amp;amp;1\\
    \end{bmatrix}
\end{equation*}
&lt;/div&gt;
&lt;p&gt;and&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
b_\text{local} = -|J| f(x_m) \mathbf{1}_3\, ,
\end{equation*}
&lt;/div&gt;
&lt;p&gt;where &lt;span class="math"&gt;\(|J|\)&lt;/span&gt; is the Jacobian determinant of the transformation and
&lt;span class="math"&gt;\(x_m\)&lt;/span&gt; is the centroid of the triangle. I am
skipping a great deal about assembling, but it would be just too extensive
to describe the complete process.&lt;/p&gt;
&lt;p&gt;We will solve the problem in a mesh with 6 triangles forming
a regular hexagon&lt;/p&gt;
&lt;p&gt;Following are the codes.&lt;/p&gt;
&lt;section id="python"&gt;
&lt;h3&gt;Python&lt;/h3&gt;
&lt;div class="code"&gt;&lt;pre class="code python"&gt;&lt;a id="rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-1" name="rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-1" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-1"&gt;&lt;/a&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;__future__&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;division&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;print_function&lt;/span&gt;
&lt;a id="rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-2" name="rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-2" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-2"&gt;&lt;/a&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;numpy&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;np&lt;/span&gt;
&lt;a id="rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-3" name="rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-3" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-3"&gt;&lt;/a&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;matplotlib.pyplot&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;plt&lt;/span&gt;
&lt;a id="rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-4" name="rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-4" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-4"&gt;&lt;/a&gt;
&lt;a id="rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-5" name="rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-5" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-5"&gt;&lt;/a&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;assem&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;elems&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;source&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-6" name="rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-6" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-6"&gt;&lt;/a&gt;    &lt;span class="n"&gt;ncoords&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;shape&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-7" name="rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-7" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-7"&gt;&lt;/a&gt;    &lt;span class="n"&gt;stiff&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="n"&gt;ncoords&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;ncoords&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-8" name="rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-8" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-8"&gt;&lt;/a&gt;    &lt;span class="n"&gt;rhs&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="n"&gt;ncoords&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-9" name="rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-9" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-9"&gt;&lt;/a&gt;    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;el_cont&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;elem&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;enumerate&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;elems&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-10" name="rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-10" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-10"&gt;&lt;/a&gt;        &lt;span class="n"&gt;stiff_loc&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;jaco&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;local_stiff&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;elem&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-11" name="rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-11" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-11"&gt;&lt;/a&gt;        &lt;span class="n"&gt;rhs&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;elem&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;+=&lt;/span&gt; &lt;span class="n"&gt;jaco&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;mean&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;source&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;elem&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-12" name="rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-12" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-12"&gt;&lt;/a&gt;        &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;row&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-13" name="rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-13" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-13"&gt;&lt;/a&gt;            &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;col&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-14" name="rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-14" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-14"&gt;&lt;/a&gt;                &lt;span class="n"&gt;row_glob&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;col_glob&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;elem&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;row&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;elem&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-15" name="rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-15" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-15"&gt;&lt;/a&gt;                &lt;span class="n"&gt;stiff&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;row_glob&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;col_glob&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;+=&lt;/span&gt; &lt;span class="n"&gt;stiff_loc&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;row&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-16" name="rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-16" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-16"&gt;&lt;/a&gt;    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;stiff&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;rhs&lt;/span&gt;
&lt;a id="rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-17" name="rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-17" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-17"&gt;&lt;/a&gt;
&lt;a id="rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-18" name="rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-18" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-18"&gt;&lt;/a&gt;
&lt;a id="rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-19" name="rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-19" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-19"&gt;&lt;/a&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;local_stiff&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-20" name="rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-20" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-20"&gt;&lt;/a&gt;    &lt;span class="n"&gt;dHdr&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;([[&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]])&lt;/span&gt;
&lt;a id="rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-21" name="rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-21" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-21"&gt;&lt;/a&gt;    &lt;span class="n"&gt;jaco&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;dHdr&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;dot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-22" name="rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-22" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-22"&gt;&lt;/a&gt;    &lt;span class="n"&gt;stiff&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;0.5&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;([[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]])&lt;/span&gt;
&lt;a id="rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-23" name="rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-23" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-23"&gt;&lt;/a&gt;    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;stiff&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;linalg&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;det&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;jaco&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;linalg&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;det&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;jaco&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-24" name="rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-24" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-24"&gt;&lt;/a&gt;
&lt;a id="rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-25" name="rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-25" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-25"&gt;&lt;/a&gt;
&lt;a id="rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-26" name="rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-26" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-26"&gt;&lt;/a&gt;&lt;span class="n"&gt;sq3&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sqrt&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-27" name="rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-27" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-27"&gt;&lt;/a&gt;&lt;span class="n"&gt;coords&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;
&lt;a id="rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-28" name="rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-28" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-28"&gt;&lt;/a&gt;        &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;sq3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;
&lt;a id="rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-29" name="rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-29" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-29"&gt;&lt;/a&gt;        &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;
&lt;a id="rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-30" name="rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-30" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-30"&gt;&lt;/a&gt;        &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;sq3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;
&lt;a id="rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-31" name="rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-31" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-31"&gt;&lt;/a&gt;        &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;
&lt;a id="rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-32" name="rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-32" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-32"&gt;&lt;/a&gt;        &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;sq3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;
&lt;a id="rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-33" name="rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-33" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-33"&gt;&lt;/a&gt;        &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;sq3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;
&lt;a id="rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-34" name="rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-34" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-34"&gt;&lt;/a&gt;        &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;sq3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]])&lt;/span&gt;
&lt;a id="rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-35" name="rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-35" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-35"&gt;&lt;/a&gt;&lt;span class="n"&gt;elems&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;
&lt;a id="rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-36" name="rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-36" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-36"&gt;&lt;/a&gt;        &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;6&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;
&lt;a id="rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-37" name="rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-37" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-37"&gt;&lt;/a&gt;        &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;6&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;
&lt;a id="rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-38" name="rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-38" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-38"&gt;&lt;/a&gt;        &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;6&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;
&lt;a id="rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-39" name="rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-39" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-39"&gt;&lt;/a&gt;        &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;6&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;
&lt;a id="rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-40" name="rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-40" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-40"&gt;&lt;/a&gt;        &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;6&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;
&lt;a id="rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-41" name="rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-41" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-41"&gt;&lt;/a&gt;        &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;6&lt;/span&gt;&lt;span class="p"&gt;]])&lt;/span&gt;
&lt;a id="rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-42" name="rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-42" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-42"&gt;&lt;/a&gt;&lt;span class="n"&gt;source&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ones&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;7&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-43" name="rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-43" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-43"&gt;&lt;/a&gt;&lt;span class="n"&gt;stiff&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;rhs&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;assem&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;elems&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;source&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-44" name="rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-44" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-44"&gt;&lt;/a&gt;&lt;span class="n"&gt;free&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;6&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-45" name="rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-45" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-45"&gt;&lt;/a&gt;&lt;span class="n"&gt;sol&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;linalg&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;solve&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;stiff&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ix_&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;free&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;free&lt;/span&gt;&lt;span class="p"&gt;)],&lt;/span&gt; &lt;span class="n"&gt;rhs&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;free&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-46" name="rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-46" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-46"&gt;&lt;/a&gt;&lt;span class="n"&gt;sol_c&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;shape&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-47" name="rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-47" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-47"&gt;&lt;/a&gt;&lt;span class="n"&gt;sol_c&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;free&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;sol&lt;/span&gt;
&lt;a id="rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-48" name="rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-48" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-48"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;tricontourf&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;[:,&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;[:,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;sol_c&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;cmap&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;"hot"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-49" name="rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-49" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-49"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;colorbar&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a id="rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-50" name="rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-50" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-50"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;axis&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"image"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-51" name="rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-51" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-51"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;show&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/section&gt;
&lt;section id="julia"&gt;
&lt;h3&gt;Julia&lt;/h3&gt;
&lt;div class="code"&gt;&lt;pre class="code julia"&gt;&lt;a id="rest_code_560781e04afc45b1b9b1c1f2fcded3a4-1" name="rest_code_560781e04afc45b1b9b1c1f2fcded3a4-1" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_560781e04afc45b1b9b1c1f2fcded3a4-1"&gt;&lt;/a&gt;&lt;span class="k"&gt;using&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;PyPlot&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_560781e04afc45b1b9b1c1f2fcded3a4-2" name="rest_code_560781e04afc45b1b9b1c1f2fcded3a4-2" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_560781e04afc45b1b9b1c1f2fcded3a4-2"&gt;&lt;/a&gt;
&lt;a id="rest_code_560781e04afc45b1b9b1c1f2fcded3a4-3" name="rest_code_560781e04afc45b1b9b1c1f2fcded3a4-3" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_560781e04afc45b1b9b1c1f2fcded3a4-3"&gt;&lt;/a&gt;
&lt;a id="rest_code_560781e04afc45b1b9b1c1f2fcded3a4-4" name="rest_code_560781e04afc45b1b9b1c1f2fcded3a4-4" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_560781e04afc45b1b9b1c1f2fcded3a4-4"&gt;&lt;/a&gt;&lt;span class="k"&gt;function&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;assem&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;elems&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;source&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_560781e04afc45b1b9b1c1f2fcded3a4-5" name="rest_code_560781e04afc45b1b9b1c1f2fcded3a4-5" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_560781e04afc45b1b9b1c1f2fcded3a4-5"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;ncoords&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;size&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;)[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_560781e04afc45b1b9b1c1f2fcded3a4-6" name="rest_code_560781e04afc45b1b9b1c1f2fcded3a4-6" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_560781e04afc45b1b9b1c1f2fcded3a4-6"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;nelems&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;size&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;elems&lt;/span&gt;&lt;span class="p"&gt;)[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_560781e04afc45b1b9b1c1f2fcded3a4-7" name="rest_code_560781e04afc45b1b9b1c1f2fcded3a4-7" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_560781e04afc45b1b9b1c1f2fcded3a4-7"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;stiff&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ncoords&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ncoords&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_560781e04afc45b1b9b1c1f2fcded3a4-8" name="rest_code_560781e04afc45b1b9b1c1f2fcded3a4-8" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_560781e04afc45b1b9b1c1f2fcded3a4-8"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;rhs&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ncoords&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_560781e04afc45b1b9b1c1f2fcded3a4-9" name="rest_code_560781e04afc45b1b9b1c1f2fcded3a4-9" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_560781e04afc45b1b9b1c1f2fcded3a4-9"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;for&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;el_cont&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="n"&gt;nelems&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_560781e04afc45b1b9b1c1f2fcded3a4-10" name="rest_code_560781e04afc45b1b9b1c1f2fcded3a4-10" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_560781e04afc45b1b9b1c1f2fcded3a4-10"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;elem&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;elems&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;el_cont&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_560781e04afc45b1b9b1c1f2fcded3a4-11" name="rest_code_560781e04afc45b1b9b1c1f2fcded3a4-11" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_560781e04afc45b1b9b1c1f2fcded3a4-11"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;stiff_loc&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;jaco&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;local_stiff&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;elem&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_560781e04afc45b1b9b1c1f2fcded3a4-12" name="rest_code_560781e04afc45b1b9b1c1f2fcded3a4-12" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_560781e04afc45b1b9b1c1f2fcded3a4-12"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;rhs&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;elem&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;jaco&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;mean&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;source&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;elem&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_560781e04afc45b1b9b1c1f2fcded3a4-13" name="rest_code_560781e04afc45b1b9b1c1f2fcded3a4-13" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_560781e04afc45b1b9b1c1f2fcded3a4-13"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="k"&gt;for&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;row&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_560781e04afc45b1b9b1c1f2fcded3a4-14" name="rest_code_560781e04afc45b1b9b1c1f2fcded3a4-14" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_560781e04afc45b1b9b1c1f2fcded3a4-14"&gt;&lt;/a&gt;&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="k"&gt;for&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_560781e04afc45b1b9b1c1f2fcded3a4-15" name="rest_code_560781e04afc45b1b9b1c1f2fcded3a4-15" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_560781e04afc45b1b9b1c1f2fcded3a4-15"&gt;&lt;/a&gt;&lt;span class="w"&gt;                &lt;/span&gt;&lt;span class="n"&gt;row_glob&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;elem&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;row&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_560781e04afc45b1b9b1c1f2fcded3a4-16" name="rest_code_560781e04afc45b1b9b1c1f2fcded3a4-16" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_560781e04afc45b1b9b1c1f2fcded3a4-16"&gt;&lt;/a&gt;&lt;span class="w"&gt;                &lt;/span&gt;&lt;span class="n"&gt;col_glob&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;elem&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_560781e04afc45b1b9b1c1f2fcded3a4-17" name="rest_code_560781e04afc45b1b9b1c1f2fcded3a4-17" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_560781e04afc45b1b9b1c1f2fcded3a4-17"&gt;&lt;/a&gt;&lt;span class="w"&gt;                &lt;/span&gt;&lt;span class="n"&gt;stiff&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;row_glob&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;col_glob&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;stiff_loc&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;row&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_560781e04afc45b1b9b1c1f2fcded3a4-18" name="rest_code_560781e04afc45b1b9b1c1f2fcded3a4-18" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_560781e04afc45b1b9b1c1f2fcded3a4-18"&gt;&lt;/a&gt;&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="k"&gt;end&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_560781e04afc45b1b9b1c1f2fcded3a4-19" name="rest_code_560781e04afc45b1b9b1c1f2fcded3a4-19" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_560781e04afc45b1b9b1c1f2fcded3a4-19"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="k"&gt;end&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_560781e04afc45b1b9b1c1f2fcded3a4-20" name="rest_code_560781e04afc45b1b9b1c1f2fcded3a4-20" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_560781e04afc45b1b9b1c1f2fcded3a4-20"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;end&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_560781e04afc45b1b9b1c1f2fcded3a4-21" name="rest_code_560781e04afc45b1b9b1c1f2fcded3a4-21" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_560781e04afc45b1b9b1c1f2fcded3a4-21"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;return&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;stiff&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;rhs&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_560781e04afc45b1b9b1c1f2fcded3a4-22" name="rest_code_560781e04afc45b1b9b1c1f2fcded3a4-22" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_560781e04afc45b1b9b1c1f2fcded3a4-22"&gt;&lt;/a&gt;&lt;span class="k"&gt;end&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_560781e04afc45b1b9b1c1f2fcded3a4-23" name="rest_code_560781e04afc45b1b9b1c1f2fcded3a4-23" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_560781e04afc45b1b9b1c1f2fcded3a4-23"&gt;&lt;/a&gt;
&lt;a id="rest_code_560781e04afc45b1b9b1c1f2fcded3a4-24" name="rest_code_560781e04afc45b1b9b1c1f2fcded3a4-24" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_560781e04afc45b1b9b1c1f2fcded3a4-24"&gt;&lt;/a&gt;
&lt;a id="rest_code_560781e04afc45b1b9b1c1f2fcded3a4-25" name="rest_code_560781e04afc45b1b9b1c1f2fcded3a4-25" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_560781e04afc45b1b9b1c1f2fcded3a4-25"&gt;&lt;/a&gt;&lt;span class="k"&gt;function&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;local_stiff&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_560781e04afc45b1b9b1c1f2fcded3a4-26" name="rest_code_560781e04afc45b1b9b1c1f2fcded3a4-26" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_560781e04afc45b1b9b1c1f2fcded3a4-26"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;dHdr&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_560781e04afc45b1b9b1c1f2fcded3a4-27" name="rest_code_560781e04afc45b1b9b1c1f2fcded3a4-27" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_560781e04afc45b1b9b1c1f2fcded3a4-27"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;jaco&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;dHdr&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_560781e04afc45b1b9b1c1f2fcded3a4-28" name="rest_code_560781e04afc45b1b9b1c1f2fcded3a4-28" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_560781e04afc45b1b9b1c1f2fcded3a4-28"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;stiff&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;0.5&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_560781e04afc45b1b9b1c1f2fcded3a4-29" name="rest_code_560781e04afc45b1b9b1c1f2fcded3a4-29" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_560781e04afc45b1b9b1c1f2fcded3a4-29"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;return&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;stiff&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;det&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;jaco&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;det&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;jaco&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_560781e04afc45b1b9b1c1f2fcded3a4-30" name="rest_code_560781e04afc45b1b9b1c1f2fcded3a4-30" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_560781e04afc45b1b9b1c1f2fcded3a4-30"&gt;&lt;/a&gt;&lt;span class="k"&gt;end&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_560781e04afc45b1b9b1c1f2fcded3a4-31" name="rest_code_560781e04afc45b1b9b1c1f2fcded3a4-31" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_560781e04afc45b1b9b1c1f2fcded3a4-31"&gt;&lt;/a&gt;
&lt;a id="rest_code_560781e04afc45b1b9b1c1f2fcded3a4-32" name="rest_code_560781e04afc45b1b9b1c1f2fcded3a4-32" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_560781e04afc45b1b9b1c1f2fcded3a4-32"&gt;&lt;/a&gt;
&lt;a id="rest_code_560781e04afc45b1b9b1c1f2fcded3a4-33" name="rest_code_560781e04afc45b1b9b1c1f2fcded3a4-33" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_560781e04afc45b1b9b1c1f2fcded3a4-33"&gt;&lt;/a&gt;&lt;span class="n"&gt;sq3&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;sqrt&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_560781e04afc45b1b9b1c1f2fcded3a4-34" name="rest_code_560781e04afc45b1b9b1c1f2fcded3a4-34" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_560781e04afc45b1b9b1c1f2fcded3a4-34"&gt;&lt;/a&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;sq3&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_560781e04afc45b1b9b1c1f2fcded3a4-35" name="rest_code_560781e04afc45b1b9b1c1f2fcded3a4-35" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_560781e04afc45b1b9b1c1f2fcded3a4-35"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_560781e04afc45b1b9b1c1f2fcded3a4-36" name="rest_code_560781e04afc45b1b9b1c1f2fcded3a4-36" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_560781e04afc45b1b9b1c1f2fcded3a4-36"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;sq3&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_560781e04afc45b1b9b1c1f2fcded3a4-37" name="rest_code_560781e04afc45b1b9b1c1f2fcded3a4-37" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_560781e04afc45b1b9b1c1f2fcded3a4-37"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_560781e04afc45b1b9b1c1f2fcded3a4-38" name="rest_code_560781e04afc45b1b9b1c1f2fcded3a4-38" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_560781e04afc45b1b9b1c1f2fcded3a4-38"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;sq3&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_560781e04afc45b1b9b1c1f2fcded3a4-39" name="rest_code_560781e04afc45b1b9b1c1f2fcded3a4-39" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_560781e04afc45b1b9b1c1f2fcded3a4-39"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;sq3&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_560781e04afc45b1b9b1c1f2fcded3a4-40" name="rest_code_560781e04afc45b1b9b1c1f2fcded3a4-40" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_560781e04afc45b1b9b1c1f2fcded3a4-40"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;sq3&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_560781e04afc45b1b9b1c1f2fcded3a4-41" name="rest_code_560781e04afc45b1b9b1c1f2fcded3a4-41" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_560781e04afc45b1b9b1c1f2fcded3a4-41"&gt;&lt;/a&gt;&lt;span class="n"&gt;elems&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;7&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_560781e04afc45b1b9b1c1f2fcded3a4-42" name="rest_code_560781e04afc45b1b9b1c1f2fcded3a4-42" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_560781e04afc45b1b9b1c1f2fcded3a4-42"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;7&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_560781e04afc45b1b9b1c1f2fcded3a4-43" name="rest_code_560781e04afc45b1b9b1c1f2fcded3a4-43" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_560781e04afc45b1b9b1c1f2fcded3a4-43"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;7&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_560781e04afc45b1b9b1c1f2fcded3a4-44" name="rest_code_560781e04afc45b1b9b1c1f2fcded3a4-44" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_560781e04afc45b1b9b1c1f2fcded3a4-44"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;6&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;7&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_560781e04afc45b1b9b1c1f2fcded3a4-45" name="rest_code_560781e04afc45b1b9b1c1f2fcded3a4-45" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_560781e04afc45b1b9b1c1f2fcded3a4-45"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="mi"&gt;6&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;7&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_560781e04afc45b1b9b1c1f2fcded3a4-46" name="rest_code_560781e04afc45b1b9b1c1f2fcded3a4-46" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_560781e04afc45b1b9b1c1f2fcded3a4-46"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;7&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_560781e04afc45b1b9b1c1f2fcded3a4-47" name="rest_code_560781e04afc45b1b9b1c1f2fcded3a4-47" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_560781e04afc45b1b9b1c1f2fcded3a4-47"&gt;&lt;/a&gt;&lt;span class="n"&gt;source&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;ones&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;7&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_560781e04afc45b1b9b1c1f2fcded3a4-48" name="rest_code_560781e04afc45b1b9b1c1f2fcded3a4-48" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_560781e04afc45b1b9b1c1f2fcded3a4-48"&gt;&lt;/a&gt;&lt;span class="n"&gt;stiff&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;rhs&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;assem&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;elems&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;source&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_560781e04afc45b1b9b1c1f2fcded3a4-49" name="rest_code_560781e04afc45b1b9b1c1f2fcded3a4-49" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_560781e04afc45b1b9b1c1f2fcded3a4-49"&gt;&lt;/a&gt;&lt;span class="n"&gt;free&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;6&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_560781e04afc45b1b9b1c1f2fcded3a4-50" name="rest_code_560781e04afc45b1b9b1c1f2fcded3a4-50" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_560781e04afc45b1b9b1c1f2fcded3a4-50"&gt;&lt;/a&gt;&lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;stiff&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;free&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;free&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;\&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;rhs&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;free&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_560781e04afc45b1b9b1c1f2fcded3a4-51" name="rest_code_560781e04afc45b1b9b1c1f2fcded3a4-51" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_560781e04afc45b1b9b1c1f2fcded3a4-51"&gt;&lt;/a&gt;&lt;span class="n"&gt;sol_c&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;size&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;)[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_560781e04afc45b1b9b1c1f2fcded3a4-52" name="rest_code_560781e04afc45b1b9b1c1f2fcded3a4-52" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_560781e04afc45b1b9b1c1f2fcded3a4-52"&gt;&lt;/a&gt;&lt;span class="n"&gt;sol_c&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;free&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_560781e04afc45b1b9b1c1f2fcded3a4-53" name="rest_code_560781e04afc45b1b9b1c1f2fcded3a4-53" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_560781e04afc45b1b9b1c1f2fcded3a4-53"&gt;&lt;/a&gt;&lt;span class="n"&gt;tricontourf&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;sol_c&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;cmap&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;"hot"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_560781e04afc45b1b9b1c1f2fcded3a4-54" name="rest_code_560781e04afc45b1b9b1c1f2fcded3a4-54" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_560781e04afc45b1b9b1c1f2fcded3a4-54"&gt;&lt;/a&gt;&lt;span class="n"&gt;colorbar&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_560781e04afc45b1b9b1c1f2fcded3a4-55" name="rest_code_560781e04afc45b1b9b1c1f2fcded3a4-55" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_560781e04afc45b1b9b1c1f2fcded3a4-55"&gt;&lt;/a&gt;&lt;span class="n"&gt;axis&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;"image"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_560781e04afc45b1b9b1c1f2fcded3a4-56" name="rest_code_560781e04afc45b1b9b1c1f2fcded3a4-56" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_560781e04afc45b1b9b1c1f2fcded3a4-56"&gt;&lt;/a&gt;&lt;span class="n"&gt;show&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Both have the same result, as follows&lt;/p&gt;
&lt;img alt="Finite element method approximation." class="align-center" src="https://nicoguaro.github.io/images/FEM2D.svg" style="width: 500px;"&gt;
&lt;/section&gt;
&lt;section id="comparison-python-julia"&gt;
&lt;h3&gt;Comparison Python/Julia&lt;/h3&gt;
&lt;p&gt;Regarding number of lines we have: 51 in Python and 56 in Julia. The comparison
in execution time is done with &lt;code class="docutils literal"&gt;%timeit&lt;/code&gt; magic command in IPython and
&lt;code class="docutils literal"&gt;@benchmark&lt;/code&gt; in Julia. For the test we are just comparing the time it takes
to generate the matrices.&lt;/p&gt;
&lt;p&gt;For Python:&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code IPython"&gt;&lt;a id="rest_code_4b2801255ec5489f8c703780afe665ba-1" name="rest_code_4b2801255ec5489f8c703780afe665ba-1" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_4b2801255ec5489f8c703780afe665ba-1"&gt;&lt;/a&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="k"&gt;timeit&lt;/span&gt; assem(coords, elems, source)
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;with result&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code text"&gt;&lt;a id="rest_code_b58a521c6cc84738af1ca55ae6e84700-1" name="rest_code_b58a521c6cc84738af1ca55ae6e84700-1" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_b58a521c6cc84738af1ca55ae6e84700-1"&gt;&lt;/a&gt;1000 loops, best of 3: 671 µs per loop
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;For Julia:&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code julia"&gt;&lt;a id="rest_code_ca13b27e7cf34316a71cc686d2758691-1" name="rest_code_ca13b27e7cf34316a71cc686d2758691-1" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_ca13b27e7cf34316a71cc686d2758691-1"&gt;&lt;/a&gt;&lt;span class="nd"&gt;@benchmark&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;assem&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;elems&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;source&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;with result&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code julia"&gt;&lt;a id="rest_code_b0ea716e129b4cc38d2f7f29d3c6ace9-1" name="rest_code_b0ea716e129b4cc38d2f7f29d3c6ace9-1" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_b0ea716e129b4cc38d2f7f29d3c6ace9-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;BenchmarkTools&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Trial&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_b0ea716e129b4cc38d2f7f29d3c6ace9-2" name="rest_code_b0ea716e129b4cc38d2f7f29d3c6ace9-2" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_b0ea716e129b4cc38d2f7f29d3c6ace9-2"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;memory&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;estimate&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="mf"&gt;13.30&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;KiB&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_b0ea716e129b4cc38d2f7f29d3c6ace9-3" name="rest_code_b0ea716e129b4cc38d2f7f29d3c6ace9-3" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_b0ea716e129b4cc38d2f7f29d3c6ace9-3"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;allocs&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;estimate&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="mi"&gt;179&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_b0ea716e129b4cc38d2f7f29d3c6ace9-4" name="rest_code_b0ea716e129b4cc38d2f7f29d3c6ace9-4" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_b0ea716e129b4cc38d2f7f29d3c6ace9-4"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="o"&gt;--------------&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_b0ea716e129b4cc38d2f7f29d3c6ace9-5" name="rest_code_b0ea716e129b4cc38d2f7f29d3c6ace9-5" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_b0ea716e129b4cc38d2f7f29d3c6ace9-5"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;minimum&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;     &lt;/span&gt;&lt;span class="mf"&gt;7.777&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;μs&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;0.00&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;GC&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_b0ea716e129b4cc38d2f7f29d3c6ace9-6" name="rest_code_b0ea716e129b4cc38d2f7f29d3c6ace9-6" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_b0ea716e129b4cc38d2f7f29d3c6ace9-6"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;median&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="mf"&gt;8.934&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;μs&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;0.00&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;GC&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_b0ea716e129b4cc38d2f7f29d3c6ace9-7" name="rest_code_b0ea716e129b4cc38d2f7f29d3c6ace9-7" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_b0ea716e129b4cc38d2f7f29d3c6ace9-7"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;mean&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="mf"&gt;10.810&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;μs&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;14.54&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;GC&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_b0ea716e129b4cc38d2f7f29d3c6ace9-8" name="rest_code_b0ea716e129b4cc38d2f7f29d3c6ace9-8" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_b0ea716e129b4cc38d2f7f29d3c6ace9-8"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;maximum&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;     &lt;/span&gt;&lt;span class="mf"&gt;797.432&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;μs&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;95.85&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;GC&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_b0ea716e129b4cc38d2f7f29d3c6ace9-9" name="rest_code_b0ea716e129b4cc38d2f7f29d3c6ace9-9" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_b0ea716e129b4cc38d2f7f29d3c6ace9-9"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="o"&gt;--------------&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_b0ea716e129b4cc38d2f7f29d3c6ace9-10" name="rest_code_b0ea716e129b4cc38d2f7f29d3c6ace9-10" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_b0ea716e129b4cc38d2f7f29d3c6ace9-10"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;samples&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;          &lt;/span&gt;&lt;span class="mi"&gt;10000&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_b0ea716e129b4cc38d2f7f29d3c6ace9-11" name="rest_code_b0ea716e129b4cc38d2f7f29d3c6ace9-11" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_b0ea716e129b4cc38d2f7f29d3c6ace9-11"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;evals&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;sample&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;     &lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;In this case, we can say that the Python code is about 70 times slower than
Julia code.&lt;/p&gt;
&lt;/section&gt;
&lt;/section&gt;</description><category>finite element method</category><category>julia</category><category>numerical methods</category><category>python</category><category>scientific computing</category><guid>https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/</guid><pubDate>Thu, 26 Oct 2017 02:41:53 GMT</pubDate></item><item><title>Numerical methods challenge: Day 24</title><link>https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/</link><dc:creator>Nicolás Guarín-Zapata</dc:creator><description>&lt;p&gt;During October (2017) I will write a program per day for some well-known
numerical methods in both Python and Julia. It is intended to be an exercise
then don't expect the code to be good enough for real use. Also,
I should mention that I have almost no experience with Julia, so it
probably won't be idiomatic Julia but more Python-like Julia.&lt;/p&gt;
&lt;section id="finite-element-method"&gt;
&lt;h2&gt;Finite element method&lt;/h2&gt;
&lt;p&gt;Today we have the &lt;a class="reference external" href="https://en.wikipedia.org/wiki/Finite_element_method"&gt;Finite element method&lt;/a&gt;
to solve the equation:&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
\frac{d^2 u}{dx^2} = f(x)
\end{equation*}
&lt;/div&gt;
&lt;p&gt;with&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
u(0) = u(1)  = 0
\end{equation*}
&lt;/div&gt;
&lt;p&gt;As in the &lt;a class="reference external" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/posts/numerical-23"&gt;Ritz method&lt;/a&gt; we form
a functional that is &lt;em&gt;equivalent&lt;/em&gt; to the
differential equation, propose an approximation as a linear combination of
a set of basis functions and find the &lt;em&gt;best&lt;/em&gt; set of coefficients for that
combination. That &lt;em&gt;best&lt;/em&gt; solution is found minimizing the functional.&lt;/p&gt;
&lt;p&gt;The functional for this differential equation is&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
\Pi[u] = -\int_{0}^{1} \left(\frac{d u}{d x}\right)^2 dx
         -\int_{0}^{1}  u f(x) dx
\end{equation*}
&lt;/div&gt;
&lt;p&gt;The main difference is that we use a piecewise interpolation for the basis
functions,&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
\hat{u}(x) = \sum_{n=0}^{N} u_n N_n(x)\, ,
\end{equation*}
&lt;/div&gt;
&lt;p&gt;this leads to the system of equations&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
[K]\{\mathbf{c}\} = \{\mathbf{b}\}
\end{equation*}
&lt;/div&gt;
&lt;p&gt;where the local stiffness matrices read&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
K_\text{local} =  \frac{1}{|J|}\begin{bmatrix} 2 &amp;amp; -2\\ -2 &amp;amp;2\end{bmatrix}
\end{equation*}
&lt;/div&gt;
&lt;p&gt;and&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
b_\text{local} = -|J|\begin{bmatrix} f(x_m)\\ f(x_{n})\end{bmatrix}\, ,
\end{equation*}
&lt;/div&gt;
&lt;p&gt;where &lt;span class="math"&gt;\(|J|\)&lt;/span&gt; is the Jacobian determinant of the transformation. I am
skipping a great deal about assembling, but it would be just too extensive
to describe the complete process.&lt;/p&gt;
&lt;p&gt;We will test the implementation with the function &lt;span class="math"&gt;\(f(x) = x^3\)&lt;/span&gt;, that
leads to the solution&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
u(x) = \frac{x (x^4 - 1)}{20}
\end{equation*}
&lt;/div&gt;
&lt;p&gt;Following are the codes.&lt;/p&gt;
&lt;section id="python"&gt;
&lt;h3&gt;Python&lt;/h3&gt;
&lt;div class="code"&gt;&lt;pre class="code python"&gt;&lt;a id="rest_code_4d595eedf8704d82beb3f29365f103c0-1" name="rest_code_4d595eedf8704d82beb3f29365f103c0-1" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_4d595eedf8704d82beb3f29365f103c0-1"&gt;&lt;/a&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;__future__&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;division&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;print_function&lt;/span&gt;
&lt;a id="rest_code_4d595eedf8704d82beb3f29365f103c0-2" name="rest_code_4d595eedf8704d82beb3f29365f103c0-2" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_4d595eedf8704d82beb3f29365f103c0-2"&gt;&lt;/a&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;numpy&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;np&lt;/span&gt;
&lt;a id="rest_code_4d595eedf8704d82beb3f29365f103c0-3" name="rest_code_4d595eedf8704d82beb3f29365f103c0-3" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_4d595eedf8704d82beb3f29365f103c0-3"&gt;&lt;/a&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;matplotlib.pyplot&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;plt&lt;/span&gt;
&lt;a id="rest_code_4d595eedf8704d82beb3f29365f103c0-4" name="rest_code_4d595eedf8704d82beb3f29365f103c0-4" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_4d595eedf8704d82beb3f29365f103c0-4"&gt;&lt;/a&gt;
&lt;a id="rest_code_4d595eedf8704d82beb3f29365f103c0-5" name="rest_code_4d595eedf8704d82beb3f29365f103c0-5" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_4d595eedf8704d82beb3f29365f103c0-5"&gt;&lt;/a&gt;
&lt;a id="rest_code_4d595eedf8704d82beb3f29365f103c0-6" name="rest_code_4d595eedf8704d82beb3f29365f103c0-6" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_4d595eedf8704d82beb3f29365f103c0-6"&gt;&lt;/a&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;FEM1D&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;source&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_4d595eedf8704d82beb3f29365f103c0-7" name="rest_code_4d595eedf8704d82beb3f29365f103c0-7" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_4d595eedf8704d82beb3f29365f103c0-7"&gt;&lt;/a&gt;    &lt;span class="n"&gt;N&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_4d595eedf8704d82beb3f29365f103c0-8" name="rest_code_4d595eedf8704d82beb3f29365f103c0-8" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_4d595eedf8704d82beb3f29365f103c0-8"&gt;&lt;/a&gt;    &lt;span class="n"&gt;stiff_loc&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;([[&lt;/span&gt;&lt;span class="mf"&gt;2.0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;2.0&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;2.0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;2.0&lt;/span&gt;&lt;span class="p"&gt;]])&lt;/span&gt;
&lt;a id="rest_code_4d595eedf8704d82beb3f29365f103c0-9" name="rest_code_4d595eedf8704d82beb3f29365f103c0-9" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_4d595eedf8704d82beb3f29365f103c0-9"&gt;&lt;/a&gt;    &lt;span class="n"&gt;eles&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="n"&gt;cont&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;cont&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;cont&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;N&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)]&lt;/span&gt;
&lt;a id="rest_code_4d595eedf8704d82beb3f29365f103c0-10" name="rest_code_4d595eedf8704d82beb3f29365f103c0-10" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_4d595eedf8704d82beb3f29365f103c0-10"&gt;&lt;/a&gt;    &lt;span class="n"&gt;stiff&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_4d595eedf8704d82beb3f29365f103c0-11" name="rest_code_4d595eedf8704d82beb3f29365f103c0-11" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_4d595eedf8704d82beb3f29365f103c0-11"&gt;&lt;/a&gt;    &lt;span class="n"&gt;rhs&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_4d595eedf8704d82beb3f29365f103c0-12" name="rest_code_4d595eedf8704d82beb3f29365f103c0-12" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_4d595eedf8704d82beb3f29365f103c0-12"&gt;&lt;/a&gt;    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;ele&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;eles&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a id="rest_code_4d595eedf8704d82beb3f29365f103c0-13" name="rest_code_4d595eedf8704d82beb3f29365f103c0-13" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_4d595eedf8704d82beb3f29365f103c0-13"&gt;&lt;/a&gt;        &lt;span class="n"&gt;jaco&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ele&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]]&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ele&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]]&lt;/span&gt;
&lt;a id="rest_code_4d595eedf8704d82beb3f29365f103c0-14" name="rest_code_4d595eedf8704d82beb3f29365f103c0-14" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_4d595eedf8704d82beb3f29365f103c0-14"&gt;&lt;/a&gt;        &lt;span class="n"&gt;rhs&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ele&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;rhs&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ele&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;jaco&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;source&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ele&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_4d595eedf8704d82beb3f29365f103c0-15" name="rest_code_4d595eedf8704d82beb3f29365f103c0-15" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_4d595eedf8704d82beb3f29365f103c0-15"&gt;&lt;/a&gt;        &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;cont1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;row&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;enumerate&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ele&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_4d595eedf8704d82beb3f29365f103c0-16" name="rest_code_4d595eedf8704d82beb3f29365f103c0-16" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_4d595eedf8704d82beb3f29365f103c0-16"&gt;&lt;/a&gt;            &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;cont2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;col&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;enumerate&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ele&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_4d595eedf8704d82beb3f29365f103c0-17" name="rest_code_4d595eedf8704d82beb3f29365f103c0-17" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_4d595eedf8704d82beb3f29365f103c0-17"&gt;&lt;/a&gt;                &lt;span class="n"&gt;stiff&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;row&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;stiff&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;row&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt;  &lt;span class="n"&gt;stiff_loc&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;cont1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;cont2&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;jaco&lt;/span&gt;
&lt;a id="rest_code_4d595eedf8704d82beb3f29365f103c0-18" name="rest_code_4d595eedf8704d82beb3f29365f103c0-18" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_4d595eedf8704d82beb3f29365f103c0-18"&gt;&lt;/a&gt;    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;stiff&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;rhs&lt;/span&gt;
&lt;a id="rest_code_4d595eedf8704d82beb3f29365f103c0-19" name="rest_code_4d595eedf8704d82beb3f29365f103c0-19" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_4d595eedf8704d82beb3f29365f103c0-19"&gt;&lt;/a&gt;
&lt;a id="rest_code_4d595eedf8704d82beb3f29365f103c0-20" name="rest_code_4d595eedf8704d82beb3f29365f103c0-20" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_4d595eedf8704d82beb3f29365f103c0-20"&gt;&lt;/a&gt;
&lt;a id="rest_code_4d595eedf8704d82beb3f29365f103c0-21" name="rest_code_4d595eedf8704d82beb3f29365f103c0-21" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_4d595eedf8704d82beb3f29365f103c0-21"&gt;&lt;/a&gt;&lt;span class="n"&gt;N&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;100&lt;/span&gt;
&lt;a id="rest_code_4d595eedf8704d82beb3f29365f103c0-22" name="rest_code_4d595eedf8704d82beb3f29365f103c0-22" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_4d595eedf8704d82beb3f29365f103c0-22"&gt;&lt;/a&gt;&lt;span class="n"&gt;fun&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;lambda&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;
&lt;a id="rest_code_4d595eedf8704d82beb3f29365f103c0-23" name="rest_code_4d595eedf8704d82beb3f29365f103c0-23" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_4d595eedf8704d82beb3f29365f103c0-23"&gt;&lt;/a&gt;&lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;linspace&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_4d595eedf8704d82beb3f29365f103c0-24" name="rest_code_4d595eedf8704d82beb3f29365f103c0-24" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_4d595eedf8704d82beb3f29365f103c0-24"&gt;&lt;/a&gt;&lt;span class="n"&gt;stiff&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;rhs&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;FEM1D&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;fun&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_4d595eedf8704d82beb3f29365f103c0-25" name="rest_code_4d595eedf8704d82beb3f29365f103c0-25" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_4d595eedf8704d82beb3f29365f103c0-25"&gt;&lt;/a&gt;&lt;span class="n"&gt;sol&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_4d595eedf8704d82beb3f29365f103c0-26" name="rest_code_4d595eedf8704d82beb3f29365f103c0-26" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_4d595eedf8704d82beb3f29365f103c0-26"&gt;&lt;/a&gt;&lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;linalg&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;solve&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;stiff&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;rhs&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_4d595eedf8704d82beb3f29365f103c0-27" name="rest_code_4d595eedf8704d82beb3f29365f103c0-27" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_4d595eedf8704d82beb3f29365f103c0-27"&gt;&lt;/a&gt;
&lt;a id="rest_code_4d595eedf8704d82beb3f29365f103c0-28" name="rest_code_4d595eedf8704d82beb3f29365f103c0-28" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_4d595eedf8704d82beb3f29365f103c0-28"&gt;&lt;/a&gt;
&lt;a id="rest_code_4d595eedf8704d82beb3f29365f103c0-29" name="rest_code_4d595eedf8704d82beb3f29365f103c0-29" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_4d595eedf8704d82beb3f29365f103c0-29"&gt;&lt;/a&gt;&lt;span class="c1"&gt;#%% Plotting&lt;/span&gt;
&lt;a id="rest_code_4d595eedf8704d82beb3f29365f103c0-30" name="rest_code_4d595eedf8704d82beb3f29365f103c0-30" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_4d595eedf8704d82beb3f29365f103c0-30"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;figure&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;figsize&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_4d595eedf8704d82beb3f29365f103c0-31" name="rest_code_4d595eedf8704d82beb3f29365f103c0-31" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_4d595eedf8704d82beb3f29365f103c0-31"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;plot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_4d595eedf8704d82beb3f29365f103c0-32" name="rest_code_4d595eedf8704d82beb3f29365f103c0-32" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_4d595eedf8704d82beb3f29365f103c0-32"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;plot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="mi"&gt;20&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;linestyle&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;"dashed"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_4d595eedf8704d82beb3f29365f103c0-33" name="rest_code_4d595eedf8704d82beb3f29365f103c0-33" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_4d595eedf8704d82beb3f29365f103c0-33"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="sa"&gt;r&lt;/span&gt;&lt;span class="s2"&gt;"$x$"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_4d595eedf8704d82beb3f29365f103c0-34" name="rest_code_4d595eedf8704d82beb3f29365f103c0-34" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_4d595eedf8704d82beb3f29365f103c0-34"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ylabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="sa"&gt;r&lt;/span&gt;&lt;span class="s2"&gt;"$y$"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_4d595eedf8704d82beb3f29365f103c0-35" name="rest_code_4d595eedf8704d82beb3f29365f103c0-35" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_4d595eedf8704d82beb3f29365f103c0-35"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;legend&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="s2"&gt;"FEM solution"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;"Exact solution"&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_4d595eedf8704d82beb3f29365f103c0-36" name="rest_code_4d595eedf8704d82beb3f29365f103c0-36" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_4d595eedf8704d82beb3f29365f103c0-36"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;tight_layout&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a id="rest_code_4d595eedf8704d82beb3f29365f103c0-37" name="rest_code_4d595eedf8704d82beb3f29365f103c0-37" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_4d595eedf8704d82beb3f29365f103c0-37"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;show&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/section&gt;
&lt;section id="julia"&gt;
&lt;h3&gt;Julia&lt;/h3&gt;
&lt;div class="code"&gt;&lt;pre class="code julia"&gt;&lt;a id="rest_code_5552a0eeae7343259a0277485d2b58f0-1" name="rest_code_5552a0eeae7343259a0277485d2b58f0-1" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_5552a0eeae7343259a0277485d2b58f0-1"&gt;&lt;/a&gt;&lt;span class="k"&gt;using&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;PyPlot&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_5552a0eeae7343259a0277485d2b58f0-2" name="rest_code_5552a0eeae7343259a0277485d2b58f0-2" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_5552a0eeae7343259a0277485d2b58f0-2"&gt;&lt;/a&gt;
&lt;a id="rest_code_5552a0eeae7343259a0277485d2b58f0-3" name="rest_code_5552a0eeae7343259a0277485d2b58f0-3" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_5552a0eeae7343259a0277485d2b58f0-3"&gt;&lt;/a&gt;
&lt;a id="rest_code_5552a0eeae7343259a0277485d2b58f0-4" name="rest_code_5552a0eeae7343259a0277485d2b58f0-4" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_5552a0eeae7343259a0277485d2b58f0-4"&gt;&lt;/a&gt;&lt;span class="k"&gt;function&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;FEM1D&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;source&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_5552a0eeae7343259a0277485d2b58f0-5" name="rest_code_5552a0eeae7343259a0277485d2b58f0-5" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_5552a0eeae7343259a0277485d2b58f0-5"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;length&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_5552a0eeae7343259a0277485d2b58f0-6" name="rest_code_5552a0eeae7343259a0277485d2b58f0-6" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_5552a0eeae7343259a0277485d2b58f0-6"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;stiff_loc&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mf"&gt;2.0&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;2.0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;2.0&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;2.0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_5552a0eeae7343259a0277485d2b58f0-7" name="rest_code_5552a0eeae7343259a0277485d2b58f0-7" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_5552a0eeae7343259a0277485d2b58f0-7"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;eles&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;[[&lt;/span&gt;&lt;span class="n"&gt;cont&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;cont&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;for&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;cont&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;in&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_5552a0eeae7343259a0277485d2b58f0-8" name="rest_code_5552a0eeae7343259a0277485d2b58f0-8" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_5552a0eeae7343259a0277485d2b58f0-8"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;stiff&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_5552a0eeae7343259a0277485d2b58f0-9" name="rest_code_5552a0eeae7343259a0277485d2b58f0-9" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_5552a0eeae7343259a0277485d2b58f0-9"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;rhs&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_5552a0eeae7343259a0277485d2b58f0-10" name="rest_code_5552a0eeae7343259a0277485d2b58f0-10" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_5552a0eeae7343259a0277485d2b58f0-10"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;for&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ele&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;in&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;eles&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_5552a0eeae7343259a0277485d2b58f0-11" name="rest_code_5552a0eeae7343259a0277485d2b58f0-11" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_5552a0eeae7343259a0277485d2b58f0-11"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;jaco&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ele&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;]]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ele&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]]&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_5552a0eeae7343259a0277485d2b58f0-12" name="rest_code_5552a0eeae7343259a0277485d2b58f0-12" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_5552a0eeae7343259a0277485d2b58f0-12"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;rhs&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ele&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;rhs&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ele&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;jaco&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;source&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ele&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_5552a0eeae7343259a0277485d2b58f0-13" name="rest_code_5552a0eeae7343259a0277485d2b58f0-13" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_5552a0eeae7343259a0277485d2b58f0-13"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;stiff&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ele&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ele&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;stiff&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ele&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ele&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;stiff_loc&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;jaco&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_5552a0eeae7343259a0277485d2b58f0-14" name="rest_code_5552a0eeae7343259a0277485d2b58f0-14" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_5552a0eeae7343259a0277485d2b58f0-14"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;end&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_5552a0eeae7343259a0277485d2b58f0-15" name="rest_code_5552a0eeae7343259a0277485d2b58f0-15" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_5552a0eeae7343259a0277485d2b58f0-15"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;return&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;stiff&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;rhs&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_5552a0eeae7343259a0277485d2b58f0-16" name="rest_code_5552a0eeae7343259a0277485d2b58f0-16" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_5552a0eeae7343259a0277485d2b58f0-16"&gt;&lt;/a&gt;&lt;span class="k"&gt;end&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_5552a0eeae7343259a0277485d2b58f0-17" name="rest_code_5552a0eeae7343259a0277485d2b58f0-17" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_5552a0eeae7343259a0277485d2b58f0-17"&gt;&lt;/a&gt;
&lt;a id="rest_code_5552a0eeae7343259a0277485d2b58f0-18" name="rest_code_5552a0eeae7343259a0277485d2b58f0-18" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_5552a0eeae7343259a0277485d2b58f0-18"&gt;&lt;/a&gt;
&lt;a id="rest_code_5552a0eeae7343259a0277485d2b58f0-19" name="rest_code_5552a0eeae7343259a0277485d2b58f0-19" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_5552a0eeae7343259a0277485d2b58f0-19"&gt;&lt;/a&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;100&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_5552a0eeae7343259a0277485d2b58f0-20" name="rest_code_5552a0eeae7343259a0277485d2b58f0-20" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_5552a0eeae7343259a0277485d2b58f0-20"&gt;&lt;/a&gt;&lt;span class="n"&gt;fun&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;.^&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_5552a0eeae7343259a0277485d2b58f0-21" name="rest_code_5552a0eeae7343259a0277485d2b58f0-21" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_5552a0eeae7343259a0277485d2b58f0-21"&gt;&lt;/a&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;linspace&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_5552a0eeae7343259a0277485d2b58f0-22" name="rest_code_5552a0eeae7343259a0277485d2b58f0-22" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_5552a0eeae7343259a0277485d2b58f0-22"&gt;&lt;/a&gt;&lt;span class="n"&gt;stiff&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;rhs&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;FEM1D&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;fun&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_5552a0eeae7343259a0277485d2b58f0-23" name="rest_code_5552a0eeae7343259a0277485d2b58f0-23" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_5552a0eeae7343259a0277485d2b58f0-23"&gt;&lt;/a&gt;&lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_5552a0eeae7343259a0277485d2b58f0-24" name="rest_code_5552a0eeae7343259a0277485d2b58f0-24" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_5552a0eeae7343259a0277485d2b58f0-24"&gt;&lt;/a&gt;&lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="k"&gt;end&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;stiff&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="k"&gt;end&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="k"&gt;end&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;\&lt;/span&gt;&lt;span class="n"&gt;rhs&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="k"&gt;end&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_5552a0eeae7343259a0277485d2b58f0-25" name="rest_code_5552a0eeae7343259a0277485d2b58f0-25" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_5552a0eeae7343259a0277485d2b58f0-25"&gt;&lt;/a&gt;
&lt;a id="rest_code_5552a0eeae7343259a0277485d2b58f0-26" name="rest_code_5552a0eeae7343259a0277485d2b58f0-26" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_5552a0eeae7343259a0277485d2b58f0-26"&gt;&lt;/a&gt;
&lt;a id="rest_code_5552a0eeae7343259a0277485d2b58f0-27" name="rest_code_5552a0eeae7343259a0277485d2b58f0-27" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_5552a0eeae7343259a0277485d2b58f0-27"&gt;&lt;/a&gt;&lt;span class="c"&gt;#%% Plotting&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_5552a0eeae7343259a0277485d2b58f0-28" name="rest_code_5552a0eeae7343259a0277485d2b58f0-28" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_5552a0eeae7343259a0277485d2b58f0-28"&gt;&lt;/a&gt;&lt;span class="n"&gt;figure&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;figsize&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_5552a0eeae7343259a0277485d2b58f0-29" name="rest_code_5552a0eeae7343259a0277485d2b58f0-29" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_5552a0eeae7343259a0277485d2b58f0-29"&gt;&lt;/a&gt;&lt;span class="n"&gt;plot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_5552a0eeae7343259a0277485d2b58f0-30" name="rest_code_5552a0eeae7343259a0277485d2b58f0-30" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_5552a0eeae7343259a0277485d2b58f0-30"&gt;&lt;/a&gt;&lt;span class="n"&gt;plot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;.*&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;.^&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="mi"&gt;20&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;linestyle&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;"dashed"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_5552a0eeae7343259a0277485d2b58f0-31" name="rest_code_5552a0eeae7343259a0277485d2b58f0-31" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_5552a0eeae7343259a0277485d2b58f0-31"&gt;&lt;/a&gt;&lt;span class="n"&gt;xlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="sa"&gt;L&lt;/span&gt;&lt;span class="s"&gt;"&lt;/span&gt;&lt;span class="si"&gt;$x&lt;/span&gt;&lt;span class="s"&gt;$"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_5552a0eeae7343259a0277485d2b58f0-32" name="rest_code_5552a0eeae7343259a0277485d2b58f0-32" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_5552a0eeae7343259a0277485d2b58f0-32"&gt;&lt;/a&gt;&lt;span class="n"&gt;ylabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="sa"&gt;L&lt;/span&gt;&lt;span class="s"&gt;"&lt;/span&gt;&lt;span class="si"&gt;$y&lt;/span&gt;&lt;span class="s"&gt;$"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_5552a0eeae7343259a0277485d2b58f0-33" name="rest_code_5552a0eeae7343259a0277485d2b58f0-33" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_5552a0eeae7343259a0277485d2b58f0-33"&gt;&lt;/a&gt;&lt;span class="n"&gt;legend&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="s"&gt;"FEM solution"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s"&gt;"Exact solution"&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_5552a0eeae7343259a0277485d2b58f0-34" name="rest_code_5552a0eeae7343259a0277485d2b58f0-34" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_5552a0eeae7343259a0277485d2b58f0-34"&gt;&lt;/a&gt;&lt;span class="n"&gt;tight_layout&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_5552a0eeae7343259a0277485d2b58f0-35" name="rest_code_5552a0eeae7343259a0277485d2b58f0-35" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_5552a0eeae7343259a0277485d2b58f0-35"&gt;&lt;/a&gt;&lt;span class="n"&gt;show&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Both have the same result, as follows&lt;/p&gt;
&lt;img alt="Finite element method approximation." class="align-center" src="https://nicoguaro.github.io/images/FEM1D.svg" style="width: 400px;"&gt;
&lt;/section&gt;
&lt;section id="comparison-python-julia"&gt;
&lt;h3&gt;Comparison Python/Julia&lt;/h3&gt;
&lt;p&gt;Regarding number of lines we have: 37 in Python and 35 in Julia. The comparison
in execution time is done with &lt;code class="docutils literal"&gt;%timeit&lt;/code&gt; magic command in IPython and
&lt;code class="docutils literal"&gt;@benchmark&lt;/code&gt; in Julia. For the test we are just comparing the time it takes
to generate the matrices.&lt;/p&gt;
&lt;p&gt;For Python:&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code IPython"&gt;&lt;a id="rest_code_74b5e8a4f2f14f1cb154d5297b2d7ce7-1" name="rest_code_74b5e8a4f2f14f1cb154d5297b2d7ce7-1" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_74b5e8a4f2f14f1cb154d5297b2d7ce7-1"&gt;&lt;/a&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="k"&gt;timeit&lt;/span&gt; FEM1D(x, fun)
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;with result&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code text"&gt;&lt;a id="rest_code_624fb90b57684f9b9c104a275360abd9-1" name="rest_code_624fb90b57684f9b9c104a275360abd9-1" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_624fb90b57684f9b9c104a275360abd9-1"&gt;&lt;/a&gt;100 loops, best of 3: 2.15 ms per loop
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;For Julia:&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code julia"&gt;&lt;a id="rest_code_8b59473bd7dd4cda909c8392172c973f-1" name="rest_code_8b59473bd7dd4cda909c8392172c973f-1" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_8b59473bd7dd4cda909c8392172c973f-1"&gt;&lt;/a&gt;&lt;span class="nd"&gt;@benchmark&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;FEM1D&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;fun&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;with result&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code julia"&gt;&lt;a id="rest_code_d8e00aecf901466a965621a491e6a1ae-1" name="rest_code_d8e00aecf901466a965621a491e6a1ae-1" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_d8e00aecf901466a965621a491e6a1ae-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;BenchmarkTools&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Trial&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_d8e00aecf901466a965621a491e6a1ae-2" name="rest_code_d8e00aecf901466a965621a491e6a1ae-2" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_d8e00aecf901466a965621a491e6a1ae-2"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;memory&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;estimate&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="mf"&gt;183.73&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;KiB&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_d8e00aecf901466a965621a491e6a1ae-3" name="rest_code_d8e00aecf901466a965621a491e6a1ae-3" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_d8e00aecf901466a965621a491e6a1ae-3"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;allocs&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;estimate&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="mi"&gt;1392&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_d8e00aecf901466a965621a491e6a1ae-4" name="rest_code_d8e00aecf901466a965621a491e6a1ae-4" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_d8e00aecf901466a965621a491e6a1ae-4"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="o"&gt;--------------&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_d8e00aecf901466a965621a491e6a1ae-5" name="rest_code_d8e00aecf901466a965621a491e6a1ae-5" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_d8e00aecf901466a965621a491e6a1ae-5"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;minimum&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;     &lt;/span&gt;&lt;span class="mf"&gt;60.045&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;μs&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;0.00&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;GC&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_d8e00aecf901466a965621a491e6a1ae-6" name="rest_code_d8e00aecf901466a965621a491e6a1ae-6" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_d8e00aecf901466a965621a491e6a1ae-6"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;median&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="mf"&gt;70.445&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;μs&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;0.00&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;GC&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_d8e00aecf901466a965621a491e6a1ae-7" name="rest_code_d8e00aecf901466a965621a491e6a1ae-7" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_d8e00aecf901466a965621a491e6a1ae-7"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;mean&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="mf"&gt;98.276&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;μs&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;25.64&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;GC&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_d8e00aecf901466a965621a491e6a1ae-8" name="rest_code_d8e00aecf901466a965621a491e6a1ae-8" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_d8e00aecf901466a965621a491e6a1ae-8"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;maximum&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;     &lt;/span&gt;&lt;span class="mf"&gt;4.269&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ms&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;96.70&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;GC&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_d8e00aecf901466a965621a491e6a1ae-9" name="rest_code_d8e00aecf901466a965621a491e6a1ae-9" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_d8e00aecf901466a965621a491e6a1ae-9"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="o"&gt;--------------&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_d8e00aecf901466a965621a491e6a1ae-10" name="rest_code_d8e00aecf901466a965621a491e6a1ae-10" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_d8e00aecf901466a965621a491e6a1ae-10"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;samples&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;          &lt;/span&gt;&lt;span class="mi"&gt;10000&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_d8e00aecf901466a965621a491e6a1ae-11" name="rest_code_d8e00aecf901466a965621a491e6a1ae-11" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_d8e00aecf901466a965621a491e6a1ae-11"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;evals&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;sample&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;     &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;In this case, we can say that the Python code is roughly 30 times slower than
Julia code.&lt;/p&gt;
&lt;/section&gt;
&lt;/section&gt;</description><category>finite element method</category><category>julia</category><category>numerical methods</category><category>python</category><category>scientific computing</category><guid>https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/</guid><pubDate>Tue, 24 Oct 2017 20:17:58 GMT</pubDate></item></channel></rss>