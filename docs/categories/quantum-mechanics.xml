<?xml version="1.0" encoding="utf-8"?>
<?xml-stylesheet type="text/xsl" href="../assets/xml/rss.xsl" media="all"?><rss version="2.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Nicolás' blog (Posts about quantum mechanics)</title><link>https://nicoguaro.github.io/</link><description></description><atom:link href="https://nicoguaro.github.io/categories/quantum-mechanics.xml" rel="self" type="application/rss+xml"></atom:link><language>en</language><copyright>Contents © 2025 &lt;a href="mailto:nicoguarin@gmail.com"&gt;Nicolás Guarín-Zapata&lt;/a&gt; 
&lt;a rel="license" href="http://creativecommons.org/licenses/by/4.0/"&gt;
&lt;img alt="Creative Commons License"
style="border-width:0"
src="https://i.creativecommons.org/l/by/4.0/88x31.png"&gt;&lt;/a&gt;</copyright><lastBuildDate>Tue, 15 Apr 2025 20:33:32 GMT</lastBuildDate><generator>Nikola (getnikola.com)</generator><docs>http://blogs.law.harvard.edu/tech/rss</docs><item><title>Finite differences in infinite domains</title><link>https://nicoguaro.github.io/posts/infinite_fdm/</link><dc:creator>Nicolás Guarín-Zapata</dc:creator><description>&lt;section id="finite-differences-in-infinite-domains"&gt;
&lt;h2&gt;Finite differences in infinite domains&lt;/h2&gt;
&lt;p&gt;Because of my friend, &lt;a class="reference external" href="http://cosmoscalibur.com/"&gt;Edward Villegas&lt;/a&gt;, I
ended up thinking about using a change of variables when solving an
eigenvalue problem with finite difference.&lt;/p&gt;
&lt;section id="the-problem"&gt;
&lt;h3&gt;The problem&lt;/h3&gt;
&lt;p&gt;Let's say that we want to solve a differential equation over an infinite
domain. A common case is to solve the &lt;a class="reference external" href="https://en.wikipedia.org/wiki/Schr%C3%B6dinger_equation#Time-independent_equation"&gt;Time independent Schrödinger
equation&lt;/a&gt;
subject to a potential &lt;span class="math"&gt;\(V(x)\)&lt;/span&gt;. For example&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
-\frac{1}{2}\frac{\mathrm{d}^2}{\mathrm{d}x^2}\psi(x) + V(x) \psi(x) = E\psi(x),\quad \forall x\in (-\infty, \infty),
\end{equation*}
&lt;/div&gt;
&lt;p&gt;where we want to find the pairs of eigenvalues/eigenfunctions
&lt;span class="math"&gt;\((E_n, \psi_n(x))\)&lt;/span&gt;.&lt;/p&gt;
&lt;p&gt;What I normally do when using &lt;a class="reference external" href="https://en.wikipedia.org/wiki/Finite_difference_method"&gt;finite
differences&lt;/a&gt;
is to regularly divide the domain. Where I take a &lt;em&gt;large enough&lt;/em&gt; domain,
so the solution have decayed close to zero. What I do in this post is to
make a change of variable to render the interval finite first and then
regularly divide the transformed domain in finite intervals.&lt;/p&gt;
&lt;/section&gt;
&lt;section id="my-usual-approach"&gt;
&lt;h3&gt;My usual approach&lt;/h3&gt;
&lt;p&gt;My usual approach is to approach the second derivative with a &lt;a class="reference external" href="https://en.wikipedia.org/wiki/Finite_difference_coefficient"&gt;centered
difference&lt;/a&gt;
for the point &lt;span class="math"&gt;\(x_i\)&lt;/span&gt; like this&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
\frac{\mathrm{d}^2 f(x)}{\mathrm{d}x^2} \approx \frac{f(x + \Delta x) - 2 f(x_i) + f(x - \Delta x)}{\Delta x^2}\, ,
\end{equation*}
&lt;/div&gt;
&lt;p&gt;with &lt;span class="math"&gt;\(\Delta x\)&lt;/span&gt; the separation between points.&lt;/p&gt;
&lt;p&gt;We can solve this in Python with the following snippet:&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code ipython3"&gt;&lt;a id="rest_code_bb0e0a9a94b440c685ccf2ae6b15287b-1" name="rest_code_bb0e0a9a94b440c685ccf2ae6b15287b-1" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_bb0e0a9a94b440c685ccf2ae6b15287b-1"&gt;&lt;/a&gt;&lt;span class="kn"&gt;import&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nn"&gt;numpy&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;as&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nn"&gt;np&lt;/span&gt;
&lt;a id="rest_code_bb0e0a9a94b440c685ccf2ae6b15287b-2" name="rest_code_bb0e0a9a94b440c685ccf2ae6b15287b-2" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_bb0e0a9a94b440c685ccf2ae6b15287b-2"&gt;&lt;/a&gt;&lt;span class="kn"&gt;from&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nn"&gt;scipy.sparse&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;diags&lt;/span&gt;
&lt;a id="rest_code_bb0e0a9a94b440c685ccf2ae6b15287b-3" name="rest_code_bb0e0a9a94b440c685ccf2ae6b15287b-3" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_bb0e0a9a94b440c685ccf2ae6b15287b-3"&gt;&lt;/a&gt;&lt;span class="kn"&gt;from&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nn"&gt;scipy.sparse.linalg&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;eigs&lt;/span&gt;
&lt;a id="rest_code_bb0e0a9a94b440c685ccf2ae6b15287b-4" name="rest_code_bb0e0a9a94b440c685ccf2ae6b15287b-4" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_bb0e0a9a94b440c685ccf2ae6b15287b-4"&gt;&lt;/a&gt;
&lt;a id="rest_code_bb0e0a9a94b440c685ccf2ae6b15287b-5" name="rest_code_bb0e0a9a94b440c685ccf2ae6b15287b-5" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_bb0e0a9a94b440c685ccf2ae6b15287b-5"&gt;&lt;/a&gt;
&lt;a id="rest_code_bb0e0a9a94b440c685ccf2ae6b15287b-6" name="rest_code_bb0e0a9a94b440c685ccf2ae6b15287b-6" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_bb0e0a9a94b440c685ccf2ae6b15287b-6"&gt;&lt;/a&gt;&lt;span class="k"&gt;def&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nf"&gt;regular_FD&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;pot&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;npts&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;101&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;x_max&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;nvals&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;6&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_bb0e0a9a94b440c685ccf2ae6b15287b-7" name="rest_code_bb0e0a9a94b440c685ccf2ae6b15287b-7" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_bb0e0a9a94b440c685ccf2ae6b15287b-7"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="sd"&gt;"""&lt;/span&gt;
&lt;a id="rest_code_bb0e0a9a94b440c685ccf2ae6b15287b-8" name="rest_code_bb0e0a9a94b440c685ccf2ae6b15287b-8" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_bb0e0a9a94b440c685ccf2ae6b15287b-8"&gt;&lt;/a&gt;&lt;span class="sd"&gt;    Find eigenvalues/eigenfunctions for Schrodinger&lt;/span&gt;
&lt;a id="rest_code_bb0e0a9a94b440c685ccf2ae6b15287b-9" name="rest_code_bb0e0a9a94b440c685ccf2ae6b15287b-9" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_bb0e0a9a94b440c685ccf2ae6b15287b-9"&gt;&lt;/a&gt;&lt;span class="sd"&gt;    equation for the given potential `pot` using&lt;/span&gt;
&lt;a id="rest_code_bb0e0a9a94b440c685ccf2ae6b15287b-10" name="rest_code_bb0e0a9a94b440c685ccf2ae6b15287b-10" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_bb0e0a9a94b440c685ccf2ae6b15287b-10"&gt;&lt;/a&gt;&lt;span class="sd"&gt;    finite differences&lt;/span&gt;
&lt;a id="rest_code_bb0e0a9a94b440c685ccf2ae6b15287b-11" name="rest_code_bb0e0a9a94b440c685ccf2ae6b15287b-11" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_bb0e0a9a94b440c685ccf2ae6b15287b-11"&gt;&lt;/a&gt;&lt;span class="sd"&gt;    """&lt;/span&gt;
&lt;a id="rest_code_bb0e0a9a94b440c685ccf2ae6b15287b-12" name="rest_code_bb0e0a9a94b440c685ccf2ae6b15287b-12" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_bb0e0a9a94b440c685ccf2ae6b15287b-12"&gt;&lt;/a&gt;    &lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;linspace&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;x_max&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;x_max&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;npts&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_bb0e0a9a94b440c685ccf2ae6b15287b-13" name="rest_code_bb0e0a9a94b440c685ccf2ae6b15287b-13" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_bb0e0a9a94b440c685ccf2ae6b15287b-13"&gt;&lt;/a&gt;    &lt;span class="n"&gt;dx&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_bb0e0a9a94b440c685ccf2ae6b15287b-14" name="rest_code_bb0e0a9a94b440c685ccf2ae6b15287b-14" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_bb0e0a9a94b440c685ccf2ae6b15287b-14"&gt;&lt;/a&gt;    &lt;span class="n"&gt;D2&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;diags&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;shape&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;npts&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;npts&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;dx&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;
&lt;a id="rest_code_bb0e0a9a94b440c685ccf2ae6b15287b-15" name="rest_code_bb0e0a9a94b440c685ccf2ae6b15287b-15" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_bb0e0a9a94b440c685ccf2ae6b15287b-15"&gt;&lt;/a&gt;    &lt;span class="n"&gt;V&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;diags&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;pot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_bb0e0a9a94b440c685ccf2ae6b15287b-16" name="rest_code_bb0e0a9a94b440c685ccf2ae6b15287b-16" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_bb0e0a9a94b440c685ccf2ae6b15287b-16"&gt;&lt;/a&gt;    &lt;span class="n"&gt;H&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;0.5&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;D2&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;V&lt;/span&gt;
&lt;a id="rest_code_bb0e0a9a94b440c685ccf2ae6b15287b-17" name="rest_code_bb0e0a9a94b440c685ccf2ae6b15287b-17" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_bb0e0a9a94b440c685ccf2ae6b15287b-17"&gt;&lt;/a&gt;    &lt;span class="n"&gt;vals&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;vecs&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;eigs&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;H&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;k&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;nvals&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;which&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;"SM"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_bb0e0a9a94b440c685ccf2ae6b15287b-18" name="rest_code_bb0e0a9a94b440c685ccf2ae6b15287b-18" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_bb0e0a9a94b440c685ccf2ae6b15287b-18"&gt;&lt;/a&gt;    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;real&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;vals&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;vecs&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Let's setup the plotting details.&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code ipython3"&gt;&lt;a id="rest_code_b9dcd1d7354c43f7b78a78948a512074-1" name="rest_code_b9dcd1d7354c43f7b78a78948a512074-1" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_b9dcd1d7354c43f7b78a78948a512074-1"&gt;&lt;/a&gt;&lt;span class="c1"&gt;# Jupyter notebook plotting setup &amp;amp; imports&lt;/span&gt;
&lt;a id="rest_code_b9dcd1d7354c43f7b78a78948a512074-2" name="rest_code_b9dcd1d7354c43f7b78a78948a512074-2" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_b9dcd1d7354c43f7b78a78948a512074-2"&gt;&lt;/a&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="k"&gt;matplotlib&lt;/span&gt; notebook
&lt;a id="rest_code_b9dcd1d7354c43f7b78a78948a512074-3" name="rest_code_b9dcd1d7354c43f7b78a78948a512074-3" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_b9dcd1d7354c43f7b78a78948a512074-3"&gt;&lt;/a&gt;&lt;span class="kn"&gt;import&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nn"&gt;matplotlib.pyplot&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;as&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nn"&gt;plt&lt;/span&gt;
&lt;a id="rest_code_b9dcd1d7354c43f7b78a78948a512074-4" name="rest_code_b9dcd1d7354c43f7b78a78948a512074-4" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_b9dcd1d7354c43f7b78a78948a512074-4"&gt;&lt;/a&gt;
&lt;a id="rest_code_b9dcd1d7354c43f7b78a78948a512074-5" name="rest_code_b9dcd1d7354c43f7b78a78948a512074-5" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_b9dcd1d7354c43f7b78a78948a512074-5"&gt;&lt;/a&gt;&lt;span class="n"&gt;gray&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;'#757575'&lt;/span&gt;
&lt;a id="rest_code_b9dcd1d7354c43f7b78a78948a512074-6" name="rest_code_b9dcd1d7354c43f7b78a78948a512074-6" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_b9dcd1d7354c43f7b78a78948a512074-6"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;rcParams&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;"figure.figsize"&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;6&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;4&lt;/span&gt;
&lt;a id="rest_code_b9dcd1d7354c43f7b78a78948a512074-7" name="rest_code_b9dcd1d7354c43f7b78a78948a512074-7" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_b9dcd1d7354c43f7b78a78948a512074-7"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;rcParams&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;"mathtext.fontset"&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s2"&gt;"cm"&lt;/span&gt;
&lt;a id="rest_code_b9dcd1d7354c43f7b78a78948a512074-8" name="rest_code_b9dcd1d7354c43f7b78a78948a512074-8" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_b9dcd1d7354c43f7b78a78948a512074-8"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;rcParams&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;"text.color"&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;gray&lt;/span&gt;
&lt;a id="rest_code_b9dcd1d7354c43f7b78a78948a512074-9" name="rest_code_b9dcd1d7354c43f7b78a78948a512074-9" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_b9dcd1d7354c43f7b78a78948a512074-9"&gt;&lt;/a&gt;&lt;span class="n"&gt;fontsize&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;rcParams&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;"font.size"&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;12&lt;/span&gt;
&lt;a id="rest_code_b9dcd1d7354c43f7b78a78948a512074-10" name="rest_code_b9dcd1d7354c43f7b78a78948a512074-10" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_b9dcd1d7354c43f7b78a78948a512074-10"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;rcParams&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;"xtick.color"&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;gray&lt;/span&gt;
&lt;a id="rest_code_b9dcd1d7354c43f7b78a78948a512074-11" name="rest_code_b9dcd1d7354c43f7b78a78948a512074-11" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_b9dcd1d7354c43f7b78a78948a512074-11"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;rcParams&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;"ytick.color"&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;gray&lt;/span&gt;
&lt;a id="rest_code_b9dcd1d7354c43f7b78a78948a512074-12" name="rest_code_b9dcd1d7354c43f7b78a78948a512074-12" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_b9dcd1d7354c43f7b78a78948a512074-12"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;rcParams&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;"axes.labelcolor"&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;gray&lt;/span&gt;
&lt;a id="rest_code_b9dcd1d7354c43f7b78a78948a512074-13" name="rest_code_b9dcd1d7354c43f7b78a78948a512074-13" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_b9dcd1d7354c43f7b78a78948a512074-13"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;rcParams&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;"axes.edgecolor"&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;gray&lt;/span&gt;
&lt;a id="rest_code_b9dcd1d7354c43f7b78a78948a512074-14" name="rest_code_b9dcd1d7354c43f7b78a78948a512074-14" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_b9dcd1d7354c43f7b78a78948a512074-14"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;rcParams&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;"axes.spines.right"&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="kc"&gt;False&lt;/span&gt;
&lt;a id="rest_code_b9dcd1d7354c43f7b78a78948a512074-15" name="rest_code_b9dcd1d7354c43f7b78a78948a512074-15" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_b9dcd1d7354c43f7b78a78948a512074-15"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;rcParams&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;"axes.spines.top"&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="kc"&gt;False&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Let's consider the &lt;a class="reference external" href="https://en.wikipedia.org/wiki/Quantum_harmonic_oscillator"&gt;Quantum harmonic
oscillator&lt;/a&gt;,
that has as eigenvalues&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
E_n = n + \frac{1}{2},\quad \forall n = 0, 1, 2 \cdots
\end{equation*}
&lt;/div&gt;
&lt;p&gt;Using the finite difference method we have values that are really close
to the analytic ones.&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code ipython3"&gt;&lt;a id="rest_code_7b7b0f5829c84ef09d084d49b0597d14-1" name="rest_code_7b7b0f5829c84ef09d084d49b0597d14-1" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_7b7b0f5829c84ef09d084d49b0597d14-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;vals&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;vecs&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;regular_FD&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;lambda&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="mf"&gt;0.5&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;npts&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;201&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_7b7b0f5829c84ef09d084d49b0597d14-2" name="rest_code_7b7b0f5829c84ef09d084d49b0597d14-2" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_7b7b0f5829c84ef09d084d49b0597d14-2"&gt;&lt;/a&gt;&lt;span class="n"&gt;vals&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;with output&lt;/p&gt;
&lt;pre class="literal-block"&gt;array([0.4996873 , 1.49843574, 2.49593063, 3.49216962, 4.48715031,
       5.4808703 ])&lt;/pre&gt;
&lt;p&gt;With the analytic ones&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code text"&gt;&lt;a id="rest_code_e7679396f2514d88a1bbd0a4fd66f19d-1" name="rest_code_e7679396f2514d88a1bbd0a4fd66f19d-1" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_e7679396f2514d88a1bbd0a4fd66f19d-1"&gt;&lt;/a&gt;[0.5, 1.5, 2.5, 3.5, 4.5, 5.5])
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;If we plot these two, we obtain the following.&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code ipython3"&gt;&lt;a id="rest_code_ceeba1f940d7455fbb3f7cec2643e37b-1" name="rest_code_ceeba1f940d7455fbb3f7cec2643e37b-1" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_ceeba1f940d7455fbb3f7cec2643e37b-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;figure&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a id="rest_code_ceeba1f940d7455fbb3f7cec2643e37b-2" name="rest_code_ceeba1f940d7455fbb3f7cec2643e37b-2" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_ceeba1f940d7455fbb3f7cec2643e37b-2"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;plot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;anal_vals&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_ceeba1f940d7455fbb3f7cec2643e37b-3" name="rest_code_ceeba1f940d7455fbb3f7cec2643e37b-3" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_ceeba1f940d7455fbb3f7cec2643e37b-3"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;plot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;vals&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;"o"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_ceeba1f940d7455fbb3f7cec2643e37b-4" name="rest_code_ceeba1f940d7455fbb3f7cec2643e37b-4" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_ceeba1f940d7455fbb3f7cec2643e37b-4"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="sa"&gt;r&lt;/span&gt;&lt;span class="s2"&gt;"$n$"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;fontsize&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;16&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_ceeba1f940d7455fbb3f7cec2643e37b-5" name="rest_code_ceeba1f940d7455fbb3f7cec2643e37b-5" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_ceeba1f940d7455fbb3f7cec2643e37b-5"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ylabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="sa"&gt;r&lt;/span&gt;&lt;span class="s2"&gt;"$E_n$"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;fontsize&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;16&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_ceeba1f940d7455fbb3f7cec2643e37b-6" name="rest_code_ceeba1f940d7455fbb3f7cec2643e37b-6" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_ceeba1f940d7455fbb3f7cec2643e37b-6"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;legend&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="s2"&gt;"Analytic"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;"Finite differences"&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_ceeba1f940d7455fbb3f7cec2643e37b-7" name="rest_code_ceeba1f940d7455fbb3f7cec2643e37b-7" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_ceeba1f940d7455fbb3f7cec2643e37b-7"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;tight_layout&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;img alt="Eigenvalues for the regular finite difference" class="align-center" src="https://nicoguaro.github.io/images/infinite_fdm/eigvals_regular.svg" style="width: 600px;"&gt;
&lt;p&gt;Let's see the eigenfunctions.&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code ipython3"&gt;&lt;a id="rest_code_87f6265976274518a90f75749d6d6261-1" name="rest_code_87f6265976274518a90f75749d6d6261-1" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_87f6265976274518a90f75749d6d6261-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;figure&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a id="rest_code_87f6265976274518a90f75749d6d6261-2" name="rest_code_87f6265976274518a90f75749d6d6261-2" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_87f6265976274518a90f75749d6d6261-2"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;plot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;abs&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;vecs&lt;/span&gt;&lt;span class="p"&gt;[:,&lt;/span&gt; &lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_87f6265976274518a90f75749d6d6261-3" name="rest_code_87f6265976274518a90f75749d6d6261-3" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_87f6265976274518a90f75749d6d6261-3"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlim&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;6&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;6&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_87f6265976274518a90f75749d6d6261-4" name="rest_code_87f6265976274518a90f75749d6d6261-4" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_87f6265976274518a90f75749d6d6261-4"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="sa"&gt;r&lt;/span&gt;&lt;span class="s2"&gt;"$x$"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;fontsize&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;16&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_87f6265976274518a90f75749d6d6261-5" name="rest_code_87f6265976274518a90f75749d6d6261-5" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_87f6265976274518a90f75749d6d6261-5"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ylabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="sa"&gt;r&lt;/span&gt;&lt;span class="s2"&gt;"$|\psi_n(x)|^2$"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;fontsize&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;16&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_87f6265976274518a90f75749d6d6261-6" name="rest_code_87f6265976274518a90f75749d6d6261-6" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_87f6265976274518a90f75749d6d6261-6"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;yticks&lt;/span&gt;&lt;span class="p"&gt;([])&lt;/span&gt;
&lt;a id="rest_code_87f6265976274518a90f75749d6d6261-7" name="rest_code_87f6265976274518a90f75749d6d6261-7" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_87f6265976274518a90f75749d6d6261-7"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;tight_layout&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;img alt="Eigenfunctions for the regular finite difference" class="align-center" src="https://nicoguaro.github.io/images/infinite_fdm/eigvecs_regular.svg" style="width: 600px;"&gt;
&lt;p&gt;One inconvenient with this method is the redundant sampling towards the
extreme of the intervals, while under sample the middle part.&lt;/p&gt;
&lt;/section&gt;
&lt;section id="changing-the-domain"&gt;
&lt;h3&gt;Changing the domain&lt;/h3&gt;
&lt;p&gt;Let's now consider the case where we transform the infinite domain to a
finite one with a change of variable&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
\xi = \xi(x)
\end{equation*}
&lt;/div&gt;
&lt;p&gt;with &lt;span class="math"&gt;\(\xi \in (-1, 1)\)&lt;/span&gt;. Two options for this transformation are:&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;&lt;span class="math"&gt;\(\xi = \tanh x\)&lt;/span&gt;; and&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;span class="math"&gt;\(\xi = \frac{2}{\pi} \arctan x\)&lt;/span&gt;.&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Making this change of variable the equation we need to solve the
following equation&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
-\frac{1}{2}\left(\frac{\mathrm{d}\xi}{\mathrm{d}x}\right)^2\frac{\mathrm{d}^2}{\mathrm{d}\xi^2}\psi(\xi) - \frac{1}{2}\frac{\mathrm{d}^2\xi}{\mathrm{d}x^2}\frac{\mathrm{d}}{\mathrm{d}\xi}\psi(\xi) + V(\xi) \psi(\xi) = E\psi(\xi)
\end{equation*}
&lt;/div&gt;
&lt;p&gt;The following snippet solve the eigenproblem for the mapped domain:&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code ipython3"&gt;&lt;a id="rest_code_5a13894b72e84976a77dd6e694eb1827-1" name="rest_code_5a13894b72e84976a77dd6e694eb1827-1" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_5a13894b72e84976a77dd6e694eb1827-1"&gt;&lt;/a&gt;&lt;span class="k"&gt;def&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nf"&gt;mapped_FD&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;pot&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;fun&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;dxdxi&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;dxdxi2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;npts&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;101&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;nvals&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;6&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;xi_tol&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mf"&gt;1e-6&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_5a13894b72e84976a77dd6e694eb1827-2" name="rest_code_5a13894b72e84976a77dd6e694eb1827-2" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_5a13894b72e84976a77dd6e694eb1827-2"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="sd"&gt;"""&lt;/span&gt;
&lt;a id="rest_code_5a13894b72e84976a77dd6e694eb1827-3" name="rest_code_5a13894b72e84976a77dd6e694eb1827-3" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_5a13894b72e84976a77dd6e694eb1827-3"&gt;&lt;/a&gt;&lt;span class="sd"&gt;    Find eigenvalues/eigenfunctions for Schrodinger&lt;/span&gt;
&lt;a id="rest_code_5a13894b72e84976a77dd6e694eb1827-4" name="rest_code_5a13894b72e84976a77dd6e694eb1827-4" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_5a13894b72e84976a77dd6e694eb1827-4"&gt;&lt;/a&gt;&lt;span class="sd"&gt;    equation for the given potential `pot` using&lt;/span&gt;
&lt;a id="rest_code_5a13894b72e84976a77dd6e694eb1827-5" name="rest_code_5a13894b72e84976a77dd6e694eb1827-5" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_5a13894b72e84976a77dd6e694eb1827-5"&gt;&lt;/a&gt;&lt;span class="sd"&gt;    finite differences over a mapped domain on (-1, 1)&lt;/span&gt;
&lt;a id="rest_code_5a13894b72e84976a77dd6e694eb1827-6" name="rest_code_5a13894b72e84976a77dd6e694eb1827-6" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_5a13894b72e84976a77dd6e694eb1827-6"&gt;&lt;/a&gt;&lt;span class="sd"&gt;    """&lt;/span&gt;
&lt;a id="rest_code_5a13894b72e84976a77dd6e694eb1827-7" name="rest_code_5a13894b72e84976a77dd6e694eb1827-7" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_5a13894b72e84976a77dd6e694eb1827-7"&gt;&lt;/a&gt;    &lt;span class="n"&gt;xi&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;linspace&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;xi_tol&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;xi_tol&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;npts&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_5a13894b72e84976a77dd6e694eb1827-8" name="rest_code_5a13894b72e84976a77dd6e694eb1827-8" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_5a13894b72e84976a77dd6e694eb1827-8"&gt;&lt;/a&gt;    &lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;fun&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;xi&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_5a13894b72e84976a77dd6e694eb1827-9" name="rest_code_5a13894b72e84976a77dd6e694eb1827-9" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_5a13894b72e84976a77dd6e694eb1827-9"&gt;&lt;/a&gt;    &lt;span class="n"&gt;dxi&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;xi&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;xi&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_5a13894b72e84976a77dd6e694eb1827-10" name="rest_code_5a13894b72e84976a77dd6e694eb1827-10" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_5a13894b72e84976a77dd6e694eb1827-10"&gt;&lt;/a&gt;    &lt;span class="n"&gt;D2&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;diags&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;shape&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;npts&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;npts&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;dxi&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;
&lt;a id="rest_code_5a13894b72e84976a77dd6e694eb1827-11" name="rest_code_5a13894b72e84976a77dd6e694eb1827-11" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_5a13894b72e84976a77dd6e694eb1827-11"&gt;&lt;/a&gt;    &lt;span class="n"&gt;D1&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;0.5&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;diags&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;shape&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;npts&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;npts&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;dxi&lt;/span&gt;
&lt;a id="rest_code_5a13894b72e84976a77dd6e694eb1827-12" name="rest_code_5a13894b72e84976a77dd6e694eb1827-12" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_5a13894b72e84976a77dd6e694eb1827-12"&gt;&lt;/a&gt;    &lt;span class="n"&gt;V&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;diags&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;pot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_5a13894b72e84976a77dd6e694eb1827-13" name="rest_code_5a13894b72e84976a77dd6e694eb1827-13" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_5a13894b72e84976a77dd6e694eb1827-13"&gt;&lt;/a&gt;    &lt;span class="n"&gt;fac1&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;diags&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;dxdxi&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;xi&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_5a13894b72e84976a77dd6e694eb1827-14" name="rest_code_5a13894b72e84976a77dd6e694eb1827-14" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_5a13894b72e84976a77dd6e694eb1827-14"&gt;&lt;/a&gt;    &lt;span class="n"&gt;fac2&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;diags&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;dxdxi2&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;xi&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_5a13894b72e84976a77dd6e694eb1827-15" name="rest_code_5a13894b72e84976a77dd6e694eb1827-15" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_5a13894b72e84976a77dd6e694eb1827-15"&gt;&lt;/a&gt;    &lt;span class="n"&gt;H&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;0.5&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;fac1&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;dot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;D2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="mf"&gt;0.5&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;fac2&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;dot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;D1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;V&lt;/span&gt;
&lt;a id="rest_code_5a13894b72e84976a77dd6e694eb1827-16" name="rest_code_5a13894b72e84976a77dd6e694eb1827-16" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_5a13894b72e84976a77dd6e694eb1827-16"&gt;&lt;/a&gt;    &lt;span class="n"&gt;vals&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;vecs&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;eigs&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;H&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;k&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;nvals&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;which&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;"SM"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_5a13894b72e84976a77dd6e694eb1827-17" name="rest_code_5a13894b72e84976a77dd6e694eb1827-17" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_5a13894b72e84976a77dd6e694eb1827-17"&gt;&lt;/a&gt;    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;real&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;vals&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;vecs&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;section id="first-transformation-xi-tanh-x"&gt;
&lt;h4&gt;First transformation: &lt;span class="math"&gt;\(\xi = \tanh(x)\)&lt;/span&gt;&lt;/h4&gt;
&lt;p&gt;Let's consider first the transformation&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
\xi = \tanh(x)\, .
\end{equation*}
&lt;/div&gt;
&lt;p&gt;In this case&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
\frac{\mathrm{d}\xi}{\mathrm{d}x} = 1 - \tanh^2(x) = 1 - \xi^2\, ,
\end{equation*}
&lt;/div&gt;
&lt;p&gt;and&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
\frac{\mathrm{d}^2\xi}{\mathrm{d}x^2} = -2\tanh(x)[1 - \tanh^2(x)] = -2\xi[1 - \xi^2]\, .
\end{equation*}
&lt;/div&gt;
&lt;p&gt;We need to define the functions&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code ipython3"&gt;&lt;a id="rest_code_6a6ab075e9454fff9ea364052e9334e2-1" name="rest_code_6a6ab075e9454fff9ea364052e9334e2-1" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_6a6ab075e9454fff9ea364052e9334e2-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;pot&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;lambda&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="mf"&gt;0.5&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;
&lt;a id="rest_code_6a6ab075e9454fff9ea364052e9334e2-2" name="rest_code_6a6ab075e9454fff9ea364052e9334e2-2" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_6a6ab075e9454fff9ea364052e9334e2-2"&gt;&lt;/a&gt;&lt;span class="n"&gt;fun&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;lambda&lt;/span&gt; &lt;span class="n"&gt;xi&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;arctanh&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;xi&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_6a6ab075e9454fff9ea364052e9334e2-3" name="rest_code_6a6ab075e9454fff9ea364052e9334e2-3" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_6a6ab075e9454fff9ea364052e9334e2-3"&gt;&lt;/a&gt;&lt;span class="n"&gt;dxdxi&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;lambda&lt;/span&gt; &lt;span class="n"&gt;xi&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;xi&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;
&lt;a id="rest_code_6a6ab075e9454fff9ea364052e9334e2-4" name="rest_code_6a6ab075e9454fff9ea364052e9334e2-4" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_6a6ab075e9454fff9ea364052e9334e2-4"&gt;&lt;/a&gt;&lt;span class="n"&gt;dxdxi2&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;lambda&lt;/span&gt; &lt;span class="n"&gt;xi&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;xi&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;xi&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;and run the function&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code ipython3"&gt;&lt;a id="rest_code_cbdc4889a0c743098682adf70b42c116-1" name="rest_code_cbdc4889a0c743098682adf70b42c116-1" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_cbdc4889a0c743098682adf70b42c116-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;vals&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;vecs&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;mapped_FD&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;pot&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;fun&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;dxdxi&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;dxdxi2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;npts&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;201&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_cbdc4889a0c743098682adf70b42c116-2" name="rest_code_cbdc4889a0c743098682adf70b42c116-2" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_cbdc4889a0c743098682adf70b42c116-2"&gt;&lt;/a&gt;&lt;span class="n"&gt;vals&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;And we obtain the following&lt;/p&gt;
&lt;pre class="literal-block"&gt;array([0.49989989, 1.4984226 , 2.49003572, 3.46934257, 4.46935021,
       5.59552989])&lt;/pre&gt;
&lt;p&gt;If we compare with the analytic values we get the following.&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code ipython3"&gt;&lt;a id="rest_code_85df4e0d9f424bdb8c8b976d286b2614-1" name="rest_code_85df4e0d9f424bdb8c8b976d286b2614-1" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_85df4e0d9f424bdb8c8b976d286b2614-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;figure&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a id="rest_code_85df4e0d9f424bdb8c8b976d286b2614-2" name="rest_code_85df4e0d9f424bdb8c8b976d286b2614-2" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_85df4e0d9f424bdb8c8b976d286b2614-2"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;plot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;anal_vals&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_85df4e0d9f424bdb8c8b976d286b2614-3" name="rest_code_85df4e0d9f424bdb8c8b976d286b2614-3" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_85df4e0d9f424bdb8c8b976d286b2614-3"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;plot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;vals&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;"o"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_85df4e0d9f424bdb8c8b976d286b2614-4" name="rest_code_85df4e0d9f424bdb8c8b976d286b2614-4" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_85df4e0d9f424bdb8c8b976d286b2614-4"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;legend&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="s2"&gt;"Analytic"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;"Finite differences"&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_85df4e0d9f424bdb8c8b976d286b2614-5" name="rest_code_85df4e0d9f424bdb8c8b976d286b2614-5" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_85df4e0d9f424bdb8c8b976d286b2614-5"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="sa"&gt;r&lt;/span&gt;&lt;span class="s2"&gt;"$n$"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;fontsize&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;16&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_85df4e0d9f424bdb8c8b976d286b2614-6" name="rest_code_85df4e0d9f424bdb8c8b976d286b2614-6" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_85df4e0d9f424bdb8c8b976d286b2614-6"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ylabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="sa"&gt;r&lt;/span&gt;&lt;span class="s2"&gt;"$E_n$"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;fontsize&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;16&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_85df4e0d9f424bdb8c8b976d286b2614-7" name="rest_code_85df4e0d9f424bdb8c8b976d286b2614-7" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_85df4e0d9f424bdb8c8b976d286b2614-7"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;tight_layout&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;img alt="Eigenvalues for the first transformation" class="align-center" src="https://nicoguaro.github.io/images/infinite_fdm/eigvals_tanh.svg" style="width: 600px;"&gt;
&lt;p&gt;And the following are the eigenfunctions.&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code ipython3"&gt;&lt;a id="rest_code_26fe6f4c95da4fb38906feb14c1a773b-1" name="rest_code_26fe6f4c95da4fb38906feb14c1a773b-1" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_26fe6f4c95da4fb38906feb14c1a773b-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;figure&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a id="rest_code_26fe6f4c95da4fb38906feb14c1a773b-2" name="rest_code_26fe6f4c95da4fb38906feb14c1a773b-2" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_26fe6f4c95da4fb38906feb14c1a773b-2"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;plot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;abs&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;vecs&lt;/span&gt;&lt;span class="p"&gt;[:,&lt;/span&gt; &lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_26fe6f4c95da4fb38906feb14c1a773b-3" name="rest_code_26fe6f4c95da4fb38906feb14c1a773b-3" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_26fe6f4c95da4fb38906feb14c1a773b-3"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlim&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;6&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;6&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_26fe6f4c95da4fb38906feb14c1a773b-4" name="rest_code_26fe6f4c95da4fb38906feb14c1a773b-4" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_26fe6f4c95da4fb38906feb14c1a773b-4"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="sa"&gt;r&lt;/span&gt;&lt;span class="s2"&gt;"$x$"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;fontsize&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;16&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_26fe6f4c95da4fb38906feb14c1a773b-5" name="rest_code_26fe6f4c95da4fb38906feb14c1a773b-5" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_26fe6f4c95da4fb38906feb14c1a773b-5"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ylabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="sa"&gt;r&lt;/span&gt;&lt;span class="s2"&gt;"$|\psi_n(x)|^2$"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;fontsize&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;16&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_26fe6f4c95da4fb38906feb14c1a773b-6" name="rest_code_26fe6f4c95da4fb38906feb14c1a773b-6" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_26fe6f4c95da4fb38906feb14c1a773b-6"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;yticks&lt;/span&gt;&lt;span class="p"&gt;([])&lt;/span&gt;
&lt;a id="rest_code_26fe6f4c95da4fb38906feb14c1a773b-7" name="rest_code_26fe6f4c95da4fb38906feb14c1a773b-7" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_26fe6f4c95da4fb38906feb14c1a773b-7"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;tight_layout&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;img alt="Eigenfunctions for the first transformation" class="align-center" src="https://nicoguaro.github.io/images/infinite_fdm/eigvecs_tanh.svg" style="width: 600px;"&gt;
&lt;/section&gt;
&lt;section id="second-transformation-xi-frac-2-pi-mathrm-atan-x"&gt;
&lt;h4&gt;Second transformation: &lt;span class="math"&gt;\(\xi = \frac{2}{\pi}\mathrm{atan}(x)\)&lt;/span&gt;&lt;/h4&gt;
&lt;p&gt;Let's consider first the transformation&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
\xi = \frac{2}{\pi}\mathrm{atan}(x)\, .
\end{equation*}
&lt;/div&gt;
&lt;p&gt;In this case&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
\frac{\mathrm{d}\xi}{\mathrm{d}x} = \frac{2}{\pi(1 + x^2)} = \frac{2 \cos^2\xi}{\pi} \, ,
\end{equation*}
&lt;/div&gt;
&lt;p&gt;and&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
\frac{\mathrm{d}^2\xi}{\mathrm{d}x^2} = -\frac{4x}{\pi(1 + x^2)^2} = -\frac{4 \cos^4\xi \tan \xi}{\pi}\, .
\end{equation*}
&lt;/div&gt;
&lt;p&gt;Once, again, we define the functions.&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code ipython3"&gt;&lt;a id="rest_code_a25f72d532af4e7085bc025cfaddf219-1" name="rest_code_a25f72d532af4e7085bc025cfaddf219-1" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_a25f72d532af4e7085bc025cfaddf219-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;pot&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;lambda&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="mf"&gt;0.5&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;
&lt;a id="rest_code_a25f72d532af4e7085bc025cfaddf219-2" name="rest_code_a25f72d532af4e7085bc025cfaddf219-2" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_a25f72d532af4e7085bc025cfaddf219-2"&gt;&lt;/a&gt;&lt;span class="n"&gt;fun&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;lambda&lt;/span&gt; &lt;span class="n"&gt;xi&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;tan&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;0.5&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;pi&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;xi&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_a25f72d532af4e7085bc025cfaddf219-3" name="rest_code_a25f72d532af4e7085bc025cfaddf219-3" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_a25f72d532af4e7085bc025cfaddf219-3"&gt;&lt;/a&gt;&lt;span class="n"&gt;dxdxi&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;lambda&lt;/span&gt; &lt;span class="n"&gt;xi&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;pi&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;cos&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;0.5&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;pi&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;xi&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;
&lt;a id="rest_code_a25f72d532af4e7085bc025cfaddf219-4" name="rest_code_a25f72d532af4e7085bc025cfaddf219-4" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_a25f72d532af4e7085bc025cfaddf219-4"&gt;&lt;/a&gt;&lt;span class="n"&gt;dxdxi2&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;lambda&lt;/span&gt; &lt;span class="n"&gt;xi&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;pi&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;cos&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;0.5&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;pi&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;xi&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;tan&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;0.5&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;pi&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;xi&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;and run the function&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code ipython3"&gt;&lt;a id="rest_code_ee70737218d6447d98162f8d24d90f23-1" name="rest_code_ee70737218d6447d98162f8d24d90f23-1" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_ee70737218d6447d98162f8d24d90f23-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;vals&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;vecs&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;mapped_FD&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;pot&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;fun&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;dxdxi&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;dxdxi2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;npts&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;201&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_ee70737218d6447d98162f8d24d90f23-2" name="rest_code_ee70737218d6447d98162f8d24d90f23-2" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_ee70737218d6447d98162f8d24d90f23-2"&gt;&lt;/a&gt;&lt;span class="n"&gt;vals&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;to obtain the following eigenvalues&lt;/p&gt;
&lt;pre class="literal-block"&gt;array([0.49997815, 1.49979632, 2.49930872, 3.49824697, 4.49627555,
       5.49295665])&lt;/pre&gt;
&lt;p&gt;with this plot&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code ipython3"&gt;&lt;a id="rest_code_3fffec4963c2432bb2baf287c926d3e2-1" name="rest_code_3fffec4963c2432bb2baf287c926d3e2-1" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_3fffec4963c2432bb2baf287c926d3e2-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;figure&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a id="rest_code_3fffec4963c2432bb2baf287c926d3e2-2" name="rest_code_3fffec4963c2432bb2baf287c926d3e2-2" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_3fffec4963c2432bb2baf287c926d3e2-2"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;plot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;anal_vals&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_3fffec4963c2432bb2baf287c926d3e2-3" name="rest_code_3fffec4963c2432bb2baf287c926d3e2-3" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_3fffec4963c2432bb2baf287c926d3e2-3"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;plot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;vals&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;"o"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_3fffec4963c2432bb2baf287c926d3e2-4" name="rest_code_3fffec4963c2432bb2baf287c926d3e2-4" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_3fffec4963c2432bb2baf287c926d3e2-4"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;legend&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="s2"&gt;"Analytic"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;"Finite differences"&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_3fffec4963c2432bb2baf287c926d3e2-5" name="rest_code_3fffec4963c2432bb2baf287c926d3e2-5" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_3fffec4963c2432bb2baf287c926d3e2-5"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="sa"&gt;r&lt;/span&gt;&lt;span class="s2"&gt;"$n$"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;fontsize&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;16&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_3fffec4963c2432bb2baf287c926d3e2-6" name="rest_code_3fffec4963c2432bb2baf287c926d3e2-6" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_3fffec4963c2432bb2baf287c926d3e2-6"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ylabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="sa"&gt;r&lt;/span&gt;&lt;span class="s2"&gt;"$E_n$"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;fontsize&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;16&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_3fffec4963c2432bb2baf287c926d3e2-7" name="rest_code_3fffec4963c2432bb2baf287c926d3e2-7" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_3fffec4963c2432bb2baf287c926d3e2-7"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;tight_layout&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;img alt="Eigenvalues for the second transformation" class="align-center" src="https://nicoguaro.github.io/images/infinite_fdm/eigvals_atan.svg" style="width: 600px;"&gt;
&lt;p&gt;and the following eigenfunctions.&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code ipython3"&gt;&lt;a id="rest_code_3d0bccc339744af78121674b82d8f955-1" name="rest_code_3d0bccc339744af78121674b82d8f955-1" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_3d0bccc339744af78121674b82d8f955-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;figure&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a id="rest_code_3d0bccc339744af78121674b82d8f955-2" name="rest_code_3d0bccc339744af78121674b82d8f955-2" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_3d0bccc339744af78121674b82d8f955-2"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;plot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;abs&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;vecs&lt;/span&gt;&lt;span class="p"&gt;[:,&lt;/span&gt; &lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_3d0bccc339744af78121674b82d8f955-3" name="rest_code_3d0bccc339744af78121674b82d8f955-3" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_3d0bccc339744af78121674b82d8f955-3"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="sa"&gt;r&lt;/span&gt;&lt;span class="s2"&gt;"$x$"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;fontsize&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;16&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_3d0bccc339744af78121674b82d8f955-4" name="rest_code_3d0bccc339744af78121674b82d8f955-4" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_3d0bccc339744af78121674b82d8f955-4"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ylabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="sa"&gt;r&lt;/span&gt;&lt;span class="s2"&gt;"$|\psi|^2$"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;fontsize&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;16&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_3d0bccc339744af78121674b82d8f955-5" name="rest_code_3d0bccc339744af78121674b82d8f955-5" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_3d0bccc339744af78121674b82d8f955-5"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlim&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;6&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;6&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_3d0bccc339744af78121674b82d8f955-6" name="rest_code_3d0bccc339744af78121674b82d8f955-6" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_3d0bccc339744af78121674b82d8f955-6"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="sa"&gt;r&lt;/span&gt;&lt;span class="s2"&gt;"$x$"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;fontsize&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;16&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_3d0bccc339744af78121674b82d8f955-7" name="rest_code_3d0bccc339744af78121674b82d8f955-7" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_3d0bccc339744af78121674b82d8f955-7"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ylabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="sa"&gt;r&lt;/span&gt;&lt;span class="s2"&gt;"$|\psi_n(x)|^2$"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;fontsize&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;16&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_3d0bccc339744af78121674b82d8f955-8" name="rest_code_3d0bccc339744af78121674b82d8f955-8" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_3d0bccc339744af78121674b82d8f955-8"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;yticks&lt;/span&gt;&lt;span class="p"&gt;([])&lt;/span&gt;
&lt;a id="rest_code_3d0bccc339744af78121674b82d8f955-9" name="rest_code_3d0bccc339744af78121674b82d8f955-9" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_3d0bccc339744af78121674b82d8f955-9"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;tight_layout&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;img alt="Eigenfunctions for the second transformation" class="align-center" src="https://nicoguaro.github.io/images/infinite_fdm/eigvecs_atan.svg" style="width: 600px;"&gt;
&lt;/section&gt;
&lt;/section&gt;
&lt;section id="conclusion"&gt;
&lt;h3&gt;Conclusion&lt;/h3&gt;
&lt;p&gt;The method works fine, although the differential equation is more
convoluted due to the change of variable. Although there are more
elegant methods to consider infinite domains, this is simple enough to
be solved in 10 lines of code.&lt;/p&gt;
&lt;p&gt;We can see that the mapping &lt;span class="math"&gt;\(\xi = \mathrm{atan}(x)\)&lt;/span&gt;, covers
better the domain than &lt;span class="math"&gt;\(\xi = \tanh(x)\)&lt;/span&gt;, where most of the points
are placed in the center of the interval.&lt;/p&gt;
&lt;p&gt;Thanks for reading!&lt;/p&gt;
&lt;small&gt;
  &lt;i&gt;
    This post was written in the Jupyter notebook. You can
    &lt;a href="https://nicoguaro.github.io/downloads/notebooks/finite_diff_map.ipynb"&gt;download&lt;/a&gt;
    this notebook, or see a static view on
    &lt;a href="http://nbviewer.jupyter.org/url/nicoguaro.github.io/downloads/notebooks/finite_diff_map.ipynb"&gt;nbviewer&lt;/a&gt;.
  &lt;i&gt;
&lt;/i&gt;&lt;/i&gt;&lt;/small&gt;&lt;/section&gt;
&lt;/section&gt;</description><category>finite difference method</category><category>pde</category><category>python</category><category>quantum mechanics</category><category>scientific computing</category><guid>https://nicoguaro.github.io/posts/infinite_fdm/</guid><pubDate>Thu, 17 May 2018 20:57:00 GMT</pubDate></item><item><title>Solution of the Schrödinger equation using Ritz method</title><link>https://nicoguaro.github.io/posts/hermite_ritz_qm/</link><dc:creator>Nicolás Guarín-Zapata</dc:creator><description>&lt;p&gt;In this post, we describe the solution of the Schrödinger equation
using the Ritz method and
&lt;a class="reference external" href="https://en.wikipedia.org/wiki/Hermite_polynomials#Hermite_functions"&gt;Hermite functions&lt;/a&gt;
basis. This basis seems to be a good choice for the 1D Schrödinger equation
since its an orthogonal basis over &lt;span class="math"&gt;\((-\infty, \infty)\)&lt;/span&gt;.&lt;/p&gt;
&lt;section id="transforming-the-equation-to-an-algebraic-one"&gt;
&lt;h2&gt;Transforming the equation to an algebraic one&lt;/h2&gt;
&lt;p&gt;We want so solve the time-independent
&lt;a class="reference external" href="https://en.wikipedia.org/wiki/Schr%C3%B6dinger_equation"&gt;Schrödinger equation&lt;/a&gt;&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
\left[-\frac{1}{2}\nabla^2 + V(x)\right] \psi = E\psi\, ,
\end{equation*}
&lt;/div&gt;
&lt;p&gt;where we are using
&lt;a class="reference external" href="https://en.wikipedia.org/wiki/Natural_units"&gt;natural units&lt;/a&gt;
since they are a good choice for numeric calculations.&lt;/p&gt;
&lt;p&gt;Solving this equation is equivalent to solve the following
variational equation&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
\delta \Pi[\psi] = 0\, ,
\end{equation*}
&lt;/div&gt;
&lt;p&gt;with&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
\Pi[\psi] = \frac{1}{2} \langle \nabla \psi, \nabla\psi\rangle +
              \langle \psi, V(x) \psi\rangle -
               E\langle \psi, \psi\rangle \, ,
\end{equation*}
&lt;/div&gt;
&lt;p&gt;being &lt;span class="math"&gt;\(\psi\)&lt;/span&gt; the wave function, &lt;span class="math"&gt;\(V(x)\)&lt;/span&gt; the potential and
&lt;span class="math"&gt;\(E\)&lt;/span&gt; the energy. This variational formulation is equivalent to the
time-independent Schrödinger equation, and &lt;span class="math"&gt;\(E\)&lt;/span&gt; works as a Lagrange
multiplier to enforce that the probability over the whole domain is 1.&lt;/p&gt;
&lt;p&gt;We can expand the wave function in an orthonormal basis, namely&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
\psi = \sum_{n=0}^N c_n u_n(x)\, ,
\end{equation*}
&lt;/div&gt;
&lt;p&gt;where &lt;span class="math"&gt;\(u_n(x) \equiv \mu_n H_n(x) e^{-x^2/2}\)&lt;/span&gt; is a normalized
Hermite function, &lt;span class="math"&gt;\(\mu_n\)&lt;/span&gt; is the inverse of magnitude of the
&lt;span class="math"&gt;\(n\)&lt;/span&gt;-th Hermite polynomial&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
\mu_n = \frac{1}{\sqrt{\pi^{1/2} n! 2^n}}\, ,
\end{equation*}
&lt;/div&gt;
&lt;p&gt;and &lt;span class="math"&gt;\(c_n\)&lt;/span&gt; are the coefficients of the expansion. This
representation is exact in the limit &lt;span class="math"&gt;\(N \rightarrow \infty\)&lt;/span&gt;.&lt;/p&gt;
&lt;p&gt;If we replace the expansion in the functional, we obtain&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
\Pi_N = \sum_{m=0}^N\sum_{n=0}^N c_m c_n\left[
          \frac{1}{2} \langle \nabla u_m, \nabla u_n\rangle +
          \langle u_m, V(x) u_n\rangle -
          E^N \delta_{mn}\right]\, .
\end{equation*}
&lt;/div&gt;
&lt;p&gt;The integrand of the integral involving the two derivatives reads&lt;/p&gt;
&lt;div class="math"&gt;
\begin{align*}
u_m' u_n' =&amp;amp; \left[2m \frac{\mu_{m-1}}{\mu_m}u_{m-1} - x u_m\right]
            \left[2n \frac{\mu_{n-1}}{\mu_n}u_{n-1} - x u_n\right]\\
          =&amp;amp; 4mn\frac{\mu_{m-1} \mu_{n-1}}{\mu_m \mu_n} u_{n-1} u_{m-1}
           - 2m\frac{\mu_{m-1}}{\mu_{m}}x u_{m-1} u_n\\
           &amp;amp;- 2n\frac{\mu_{n-1}}{\mu_{n}}x u_{n-1} u_m + x^2 u_m u_n
\end{align*}
&lt;/div&gt;
&lt;p&gt;Thus, the kinetic energy term reads&lt;/p&gt;
&lt;div class="math"&gt;
\begin{align*}
\langle \nabla u_m, \nabla u_n \rangle =&amp;amp;
    4mn\frac{\mu_{m-1} \mu_{n-1}}{\mu_m \mu_n} \langle u_{n-1}, u_{m-1}\rangle
    - 2m\frac{\mu_{m-1}}{\mu_{m}} \langle u_{m-1}, x u_n\rangle\\
    &amp;amp;- 2n\frac{\mu_{n-1}}{\mu_{n}} \langle u_{m}, x u_{n - 1}\rangle
     + \langle u_m, x^2 u_n\rangle\\
    =&amp;amp; 4mn \frac{\mu_{m-1}^2}{\mu_m^2}\delta_{mn} -
      2m \frac{\mu_{m-1}}{\mu_m} \alpha_{m-1, n} -
      2n \frac{\mu_{n-1}}{\mu_n} \alpha_{m, n-1} + \beta_{mn} \, ,
\end{align*}
&lt;/div&gt;
&lt;p&gt;with&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
\alpha_{m,n} \equiv \langle u_{m}, x u_n\rangle = \begin{cases}
\sqrt{\frac{n + 1}{2}} &amp;amp; m=n +1\\
\sqrt{\frac{n}{2}} &amp;amp; m=n - 1\\
0 &amp;amp; \text{otherwise}\end{cases}\, ,
\end{equation*}
&lt;/div&gt;
&lt;p&gt;and&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
\beta_{m,n} \equiv \langle u_{m}, x^2 u_n\rangle = \begin{cases}
\frac{\sqrt{n(n-1)}}{2} &amp;amp; m = n - 2\\
\frac{2n + 1}{2} &amp;amp; m = n \\
\frac{\sqrt{(n+1)(n+1)}}{2} &amp;amp; m = n + 2 \\
0 &amp;amp; \text{otherwise}\end{cases}\, .
\end{equation*}
&lt;/div&gt;
&lt;p&gt;The functional is rewritten as&lt;/p&gt;
&lt;div class="math"&gt;
\begin{align*}
\Pi_N =&amp;amp; \sum_{m=0}^N \sum_{n=0}^N c_m c_n
  \left[2mn \frac{\mu^2_{m-1}}{\mu^2_m}\delta_{mn}
  - m\frac{\mu_{m-1}}{\mu_m}\alpha_{m - 1, n}
  - n\frac{\mu_{n-1}}{\mu_n}\delta_{m, n-1} \right.\nonumber \\
  &amp;amp;\left. - \frac{1}{2}\beta_{mn} + \langle u_m, V(x) u_n\rangle
  - E^N \delta_{mn}\right] \, .
\end{align*}
&lt;/div&gt;
&lt;p&gt;Taking the variation&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
\delta \Pi_N = 0\, ,
\end{equation*}
&lt;/div&gt;
&lt;p&gt;that in this case is equivalent to&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
\frac{\partial \Pi_N}{\partial c_i} = 0\quad \forall i=0, 1, \cdots N\, ,
\end{equation*}
&lt;/div&gt;
&lt;p&gt;yields to&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
[H]\lbrace c\rbrace = E^N\lbrace c\rbrace \, ,
\end{equation*}
&lt;/div&gt;
&lt;p&gt;where the components of the matrix &lt;span class="math"&gt;\([H]\)&lt;/span&gt; are given by&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
H_{mn} = 2mn \frac{\mu^2_{m-1}}{\mu^2_m}\delta_{mn}
  - m\frac{\mu_{m-1}}{\mu_m}\alpha_{m - 1, n}
  - n\frac{\mu_{n-1}}{\mu_n}\delta_{m, n-1}
  - \frac{1}{2}\beta_{mn} + \langle u_m, V(x) u_n\rangle\, .
\end{equation*}
&lt;/div&gt;
&lt;p&gt;The last integral can be computed using
&lt;a class="reference external" href="https://en.wikipedia.org/wiki/Gauss%E2%80%93Hermite_quadrature"&gt;Gauss-Hermite quadrature&lt;/a&gt;.
And we will need more Gauss points if we want to integrate higher-order
polynomials. This method would work fine for functions that can be
approximated by polynomials.&lt;/p&gt;
&lt;/section&gt;
&lt;section id="examples"&gt;
&lt;h2&gt;Examples&lt;/h2&gt;
&lt;p&gt;A Python implementation of this method is presented in
&lt;a class="reference external" href="https://github.com/nicoguaro/FEM_resources/blob/master/quantum_mechanics/hermite_QM.py"&gt;this repo&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;For all the examples we use the following imports&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code ipython"&gt;&lt;a id="rest_code_dec44032821743c9a98afd4f0d7ecb29-1" name="rest_code_dec44032821743c9a98afd4f0d7ecb29-1" href="https://nicoguaro.github.io/posts/hermite_ritz_qm/#rest_code_dec44032821743c9a98afd4f0d7ecb29-1"&gt;&lt;/a&gt;&lt;span class="kn"&gt;from&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nn"&gt;__future__&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;division&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;print_function&lt;/span&gt;
&lt;a id="rest_code_dec44032821743c9a98afd4f0d7ecb29-2" name="rest_code_dec44032821743c9a98afd4f0d7ecb29-2" href="https://nicoguaro.github.io/posts/hermite_ritz_qm/#rest_code_dec44032821743c9a98afd4f0d7ecb29-2"&gt;&lt;/a&gt;&lt;span class="kn"&gt;import&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nn"&gt;numpy&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;as&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nn"&gt;np&lt;/span&gt;
&lt;a id="rest_code_dec44032821743c9a98afd4f0d7ecb29-3" name="rest_code_dec44032821743c9a98afd4f0d7ecb29-3" href="https://nicoguaro.github.io/posts/hermite_ritz_qm/#rest_code_dec44032821743c9a98afd4f0d7ecb29-3"&gt;&lt;/a&gt;&lt;span class="kn"&gt;from&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nn"&gt;hermite_QM&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;section id="quantum-harmonic-oscilator-1"&gt;
&lt;h3&gt;&lt;a class="reference external" href="https://en.wikipedia.org/wiki/Quantum_harmonic_oscillator"&gt;Quantum harmonic oscilator&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;In this case the (normalized) potential is given by&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
V(x) = \frac{1}{2} x^2
\end{equation*}
&lt;/div&gt;
&lt;p&gt;and the exact normalized eigenvalues are given by&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
E_n = n + \frac{1}{2}
\end{equation*}
&lt;/div&gt;
&lt;p&gt;The following snippet computes the first 10 eigenvalues and plot
the corresponding eigenstates&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code ipython"&gt;&lt;a id="rest_code_f3f4ceaee90d406faae501dc5f4f79fe-1" name="rest_code_f3f4ceaee90d406faae501dc5f4f79fe-1" href="https://nicoguaro.github.io/posts/hermite_ritz_qm/#rest_code_f3f4ceaee90d406faae501dc5f4f79fe-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;potential&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;lambda&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="mf"&gt;0.5&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;
&lt;a id="rest_code_f3f4ceaee90d406faae501dc5f4f79fe-2" name="rest_code_f3f4ceaee90d406faae501dc5f4f79fe-2" href="https://nicoguaro.github.io/posts/hermite_ritz_qm/#rest_code_f3f4ceaee90d406faae501dc5f4f79fe-2"&gt;&lt;/a&gt;&lt;span class="n"&gt;vals&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;vecs&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;eigenstates&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;potential&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;nterms&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;11&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;ngpts&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;12&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_f3f4ceaee90d406faae501dc5f4f79fe-3" name="rest_code_f3f4ceaee90d406faae501dc5f4f79fe-3" href="https://nicoguaro.github.io/posts/hermite_ritz_qm/#rest_code_f3f4ceaee90d406faae501dc5f4f79fe-3"&gt;&lt;/a&gt;&lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;round&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;vals&lt;/span&gt;&lt;span class="p"&gt;[:&lt;/span&gt;&lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="mi"&gt;6&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_f3f4ceaee90d406faae501dc5f4f79fe-4" name="rest_code_f3f4ceaee90d406faae501dc5f4f79fe-4" href="https://nicoguaro.github.io/posts/hermite_ritz_qm/#rest_code_f3f4ceaee90d406faae501dc5f4f79fe-4"&gt;&lt;/a&gt;&lt;span class="n"&gt;fig&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;ax&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;subplots&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_f3f4ceaee90d406faae501dc5f4f79fe-5" name="rest_code_f3f4ceaee90d406faae501dc5f4f79fe-5" href="https://nicoguaro.github.io/posts/hermite_ritz_qm/#rest_code_f3f4ceaee90d406faae501dc5f4f79fe-5"&gt;&lt;/a&gt;&lt;span class="n"&gt;plot_eigenstates&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;vals&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;vecs&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;potential&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;with results&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code text"&gt;&lt;a id="rest_code_35d059720e184d78aef1f3ee71cfda90-1" name="rest_code_35d059720e184d78aef1f3ee71cfda90-1" href="https://nicoguaro.github.io/posts/hermite_ritz_qm/#rest_code_35d059720e184d78aef1f3ee71cfda90-1"&gt;&lt;/a&gt;[ 0.5  1.5  2.5  3.5  4.5  5.5  6.5  7.5  8.5  9.5]
&lt;/pre&gt;&lt;/div&gt;
&lt;img alt="/images/hermite_ritz_harmonic.svg" src="https://nicoguaro.github.io/images/hermite_ritz_harmonic.svg"&gt;
&lt;/section&gt;
&lt;section id="absolute-value-potential"&gt;
&lt;h3&gt;Absolute value potential&lt;/h3&gt;
&lt;div class="code"&gt;&lt;pre class="code ipython"&gt;&lt;a id="rest_code_238f1d86d68d4e5ab2816c3f6ef33cac-1" name="rest_code_238f1d86d68d4e5ab2816c3f6ef33cac-1" href="https://nicoguaro.github.io/posts/hermite_ritz_qm/#rest_code_238f1d86d68d4e5ab2816c3f6ef33cac-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;potential&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;lambda&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;abs&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_238f1d86d68d4e5ab2816c3f6ef33cac-2" name="rest_code_238f1d86d68d4e5ab2816c3f6ef33cac-2" href="https://nicoguaro.github.io/posts/hermite_ritz_qm/#rest_code_238f1d86d68d4e5ab2816c3f6ef33cac-2"&gt;&lt;/a&gt;&lt;span class="n"&gt;vals&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;vecs&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;eigenstates&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;potential&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_238f1d86d68d4e5ab2816c3f6ef33cac-3" name="rest_code_238f1d86d68d4e5ab2816c3f6ef33cac-3" href="https://nicoguaro.github.io/posts/hermite_ritz_qm/#rest_code_238f1d86d68d4e5ab2816c3f6ef33cac-3"&gt;&lt;/a&gt;&lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;round&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;vals&lt;/span&gt;&lt;span class="p"&gt;[:&lt;/span&gt;&lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="mi"&gt;6&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_238f1d86d68d4e5ab2816c3f6ef33cac-4" name="rest_code_238f1d86d68d4e5ab2816c3f6ef33cac-4" href="https://nicoguaro.github.io/posts/hermite_ritz_qm/#rest_code_238f1d86d68d4e5ab2816c3f6ef33cac-4"&gt;&lt;/a&gt;&lt;span class="n"&gt;fig&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;ax&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;subplots&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_238f1d86d68d4e5ab2816c3f6ef33cac-5" name="rest_code_238f1d86d68d4e5ab2816c3f6ef33cac-5" href="https://nicoguaro.github.io/posts/hermite_ritz_qm/#rest_code_238f1d86d68d4e5ab2816c3f6ef33cac-5"&gt;&lt;/a&gt;&lt;span class="n"&gt;plot_eigenstates&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;vals&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;vecs&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;potential&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;lims&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;8&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;8&lt;/span&gt;&lt;span class="p"&gt;));&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;with results&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code text"&gt;&lt;a id="rest_code_e0e6dc06919a414abbd26ac585c3d781-1" name="rest_code_e0e6dc06919a414abbd26ac585c3d781-1" href="https://nicoguaro.github.io/posts/hermite_ritz_qm/#rest_code_e0e6dc06919a414abbd26ac585c3d781-1"&gt;&lt;/a&gt;[ 0.811203  1.855725  2.57894   3.244576  3.826353  4.38189   4.895365
&lt;a id="rest_code_e0e6dc06919a414abbd26ac585c3d781-2" name="rest_code_e0e6dc06919a414abbd26ac585c3d781-2" href="https://nicoguaro.github.io/posts/hermite_ritz_qm/#rest_code_e0e6dc06919a414abbd26ac585c3d781-2"&gt;&lt;/a&gt;  5.396614  5.911591  6.421015]
&lt;/pre&gt;&lt;/div&gt;
&lt;img alt="/images/hermite_ritz_abs.svg" src="https://nicoguaro.github.io/images/hermite_ritz_abs.svg"&gt;
&lt;/section&gt;
&lt;section id="cubic-potential"&gt;
&lt;h3&gt;Cubic potential&lt;/h3&gt;
&lt;div class="code"&gt;&lt;pre class="code ipython"&gt;&lt;a id="rest_code_792c1864a02142e98c87729d4bb31f00-1" name="rest_code_792c1864a02142e98c87729d4bb31f00-1" href="https://nicoguaro.github.io/posts/hermite_ritz_qm/#rest_code_792c1864a02142e98c87729d4bb31f00-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;potential&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;lambda&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;abs&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;
&lt;a id="rest_code_792c1864a02142e98c87729d4bb31f00-2" name="rest_code_792c1864a02142e98c87729d4bb31f00-2" href="https://nicoguaro.github.io/posts/hermite_ritz_qm/#rest_code_792c1864a02142e98c87729d4bb31f00-2"&gt;&lt;/a&gt;&lt;span class="n"&gt;vals&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;vecs&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;eigenstates&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;potential&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_792c1864a02142e98c87729d4bb31f00-3" name="rest_code_792c1864a02142e98c87729d4bb31f00-3" href="https://nicoguaro.github.io/posts/hermite_ritz_qm/#rest_code_792c1864a02142e98c87729d4bb31f00-3"&gt;&lt;/a&gt;&lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;round&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;vals&lt;/span&gt;&lt;span class="p"&gt;[:&lt;/span&gt;&lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="mi"&gt;6&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_792c1864a02142e98c87729d4bb31f00-4" name="rest_code_792c1864a02142e98c87729d4bb31f00-4" href="https://nicoguaro.github.io/posts/hermite_ritz_qm/#rest_code_792c1864a02142e98c87729d4bb31f00-4"&gt;&lt;/a&gt;&lt;span class="n"&gt;fig&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;ax&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;subplots&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_792c1864a02142e98c87729d4bb31f00-5" name="rest_code_792c1864a02142e98c87729d4bb31f00-5" href="https://nicoguaro.github.io/posts/hermite_ritz_qm/#rest_code_792c1864a02142e98c87729d4bb31f00-5"&gt;&lt;/a&gt;&lt;span class="n"&gt;plot_eigenstates&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;vals&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;vecs&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;potential&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;lims&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;6&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;6&lt;/span&gt;&lt;span class="p"&gt;));&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;with results&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code text"&gt;&lt;a id="rest_code_3663a916212d4e588ea32feff3ee4dfc-1" name="rest_code_3663a916212d4e588ea32feff3ee4dfc-1" href="https://nicoguaro.github.io/posts/hermite_ritz_qm/#rest_code_3663a916212d4e588ea32feff3ee4dfc-1"&gt;&lt;/a&gt;[ 0.180588  0.609153  1.124594  1.681002  2.272087  2.889805  3.530901
&lt;a id="rest_code_3663a916212d4e588ea32feff3ee4dfc-2" name="rest_code_3663a916212d4e588ea32feff3ee4dfc-2" href="https://nicoguaro.github.io/posts/hermite_ritz_qm/#rest_code_3663a916212d4e588ea32feff3ee4dfc-2"&gt;&lt;/a&gt;  4.191962  4.871133  5.566413]
&lt;/pre&gt;&lt;/div&gt;
&lt;img alt="/images/hermite_ritz_cubic.svg" src="https://nicoguaro.github.io/images/hermite_ritz_cubic.svg"&gt;
&lt;/section&gt;
&lt;section id="harmonic-with-quartic-perturbation"&gt;
&lt;h3&gt;Harmonic with quartic perturbation&lt;/h3&gt;
&lt;div class="code"&gt;&lt;pre class="code ipython"&gt;&lt;a id="rest_code_44552ca9755c4ad0b6e533d9686ebd41-1" name="rest_code_44552ca9755c4ad0b6e533d9686ebd41-1" href="https://nicoguaro.github.io/posts/hermite_ritz_qm/#rest_code_44552ca9755c4ad0b6e533d9686ebd41-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;potential&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;lambda&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="mf"&gt;0.5&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mf"&gt;0.1&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;
&lt;a id="rest_code_44552ca9755c4ad0b6e533d9686ebd41-2" name="rest_code_44552ca9755c4ad0b6e533d9686ebd41-2" href="https://nicoguaro.github.io/posts/hermite_ritz_qm/#rest_code_44552ca9755c4ad0b6e533d9686ebd41-2"&gt;&lt;/a&gt;&lt;span class="n"&gt;vals&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;vecs&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;eigenstates&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;potential&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;nterms&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;20&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;ngpts&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;22&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_44552ca9755c4ad0b6e533d9686ebd41-3" name="rest_code_44552ca9755c4ad0b6e533d9686ebd41-3" href="https://nicoguaro.github.io/posts/hermite_ritz_qm/#rest_code_44552ca9755c4ad0b6e533d9686ebd41-3"&gt;&lt;/a&gt;&lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;round&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;vals&lt;/span&gt;&lt;span class="p"&gt;[:&lt;/span&gt;&lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="mi"&gt;6&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_44552ca9755c4ad0b6e533d9686ebd41-4" name="rest_code_44552ca9755c4ad0b6e533d9686ebd41-4" href="https://nicoguaro.github.io/posts/hermite_ritz_qm/#rest_code_44552ca9755c4ad0b6e533d9686ebd41-4"&gt;&lt;/a&gt;&lt;span class="n"&gt;fig&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;ax&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;subplots&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_44552ca9755c4ad0b6e533d9686ebd41-5" name="rest_code_44552ca9755c4ad0b6e533d9686ebd41-5" href="https://nicoguaro.github.io/posts/hermite_ritz_qm/#rest_code_44552ca9755c4ad0b6e533d9686ebd41-5"&gt;&lt;/a&gt;&lt;span class="n"&gt;plot_eigenstates&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;vals&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;vecs&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;potential&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;lims&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;with results&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code text"&gt;&lt;a id="rest_code_d15be4f7d51742a9aa4f4f5e5d59f085-1" name="rest_code_d15be4f7d51742a9aa4f4f5e5d59f085-1" href="https://nicoguaro.github.io/posts/hermite_ritz_qm/#rest_code_d15be4f7d51742a9aa4f4f5e5d59f085-1"&gt;&lt;/a&gt;[  0.559146   1.769503   3.138624   4.628884   6.220303   7.899789
&lt;a id="rest_code_d15be4f7d51742a9aa4f4f5e5d59f085-2" name="rest_code_d15be4f7d51742a9aa4f4f5e5d59f085-2" href="https://nicoguaro.github.io/posts/hermite_ritz_qm/#rest_code_d15be4f7d51742a9aa4f4f5e5d59f085-2"&gt;&lt;/a&gt;   9.658703  11.489094  13.38638   15.361055]
&lt;/pre&gt;&lt;/div&gt;
&lt;img alt="/images/hermite_ritz_pert_harm.svg" src="https://nicoguaro.github.io/images/hermite_ritz_pert_harm.svg"&gt;
&lt;p&gt;A Jupyter Notebook with the examples can be found
&lt;a class="reference external" href="https://github.com/nicoguaro/FEM_resources/blob/master/quantum_mechanics/Ritz_Hermite_QM.ipynb"&gt;here&lt;/a&gt;.&lt;/p&gt;
&lt;/section&gt;
&lt;/section&gt;</description><category>finite element method</category><category>Hermite polynomials</category><category>quantum mechanics</category><category>variational methods</category><guid>https://nicoguaro.github.io/posts/hermite_ritz_qm/</guid><pubDate>Wed, 12 Jul 2017 00:04:57 GMT</pubDate></item></channel></rss>