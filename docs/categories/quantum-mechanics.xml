<?xml version="1.0" encoding="utf-8"?>
<?xml-stylesheet type="text/xsl" href="../assets/xml/rss.xsl" media="all"?><rss version="2.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Nicolás' blog (Posts about quantum mechanics)</title><link>https://nicoguaro.github.io/</link><description></description><atom:link href="https://nicoguaro.github.io/categories/quantum-mechanics.xml" rel="self" type="application/rss+xml"></atom:link><language>en</language><copyright>Contents © 2022 &lt;a href="mailto:nicoguarin@gmail.com"&gt;Nicolás Guarín-Zapata&lt;/a&gt; 
&lt;a rel="license" href="http://creativecommons.org/licenses/by/4.0/"&gt;
&lt;img alt="Creative Commons License"
style="border-width:0"
src="https://i.creativecommons.org/l/by/4.0/88x31.png"&gt;&lt;/a&gt;</copyright><lastBuildDate>Mon, 11 Jul 2022 18:47:25 GMT</lastBuildDate><generator>Nikola (getnikola.com)</generator><docs>http://blogs.law.harvard.edu/tech/rss</docs><item><title>Finite differences in infinite domains</title><link>https://nicoguaro.github.io/posts/infinite_fdm/</link><dc:creator>Nicolás Guarín-Zapata</dc:creator><description>&lt;section id="finite-differences-in-infinite-domains"&gt;
&lt;h2&gt;Finite differences in infinite domains&lt;/h2&gt;
&lt;p&gt;Because of my friend, &lt;a class="reference external" href="http://cosmoscalibur.com/"&gt;Edward Villegas&lt;/a&gt;, I
ended up thinking about using a change of variables when solving an
eigenvalue problem with finite difference.&lt;/p&gt;
&lt;section id="the-problem"&gt;
&lt;h3&gt;The problem&lt;/h3&gt;
&lt;p&gt;Let's say that we want to solve a differential equation over an infinite
domain. A common case is to solve the &lt;a class="reference external" href="https://en.wikipedia.org/wiki/Schr%C3%B6dinger_equation#Time-independent_equation"&gt;Time independent Schrödinger
equation&lt;/a&gt;
subject to a potential &lt;span class="math"&gt;\(V(x)\)&lt;/span&gt;. For example&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
-\frac{1}{2}\frac{\mathrm{d}^2}{\mathrm{d}x^2}\psi(x) + V(x) \psi(x) = E\psi(x),\quad \forall x\in (-\infty, \infty),
\end{equation*}
&lt;/div&gt;
&lt;p&gt;where we want to find the pairs of eigenvalues/eigenfunctions
&lt;span class="math"&gt;\((E_n, \psi_n(x))\)&lt;/span&gt;.&lt;/p&gt;
&lt;p&gt;What I normally do when using &lt;a class="reference external" href="https://en.wikipedia.org/wiki/Finite_difference_method"&gt;finite
differences&lt;/a&gt;
is to regularly divide the domain. Where I take a &lt;em&gt;large enough&lt;/em&gt; domain,
so the solution have decayed close to zero. What I do in this post is to
make a change of variable to render the interval finite first and then
regularly divide the transformed domain in finite intervals.&lt;/p&gt;
&lt;/section&gt;
&lt;section id="my-usual-approach"&gt;
&lt;h3&gt;My usual approach&lt;/h3&gt;
&lt;p&gt;My usual approach is to approach the second derivative with a &lt;a class="reference external" href="https://en.wikipedia.org/wiki/Finite_difference_coefficient"&gt;centered
difference&lt;/a&gt;
for the point &lt;span class="math"&gt;\(x_i\)&lt;/span&gt; like this&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
\frac{\mathrm{d}^2 f(x)}{\mathrm{d}x^2} \approx \frac{f(x + \Delta x) - 2 f(x_i) + f(x - \Delta x)}{\Delta x^2}\, ,
\end{equation*}
&lt;/div&gt;
&lt;p&gt;with &lt;span class="math"&gt;\(\Delta x\)&lt;/span&gt; the separation between points.&lt;/p&gt;
&lt;p&gt;We can solve this in Python with the following snippet:&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code ipython3"&gt;&lt;a id="rest_code_12f48f1091c840fd998f65fe6bd60306-1" name="rest_code_12f48f1091c840fd998f65fe6bd60306-1" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_12f48f1091c840fd998f65fe6bd60306-1"&gt;&lt;/a&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;numpy&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;np&lt;/span&gt;
&lt;a id="rest_code_12f48f1091c840fd998f65fe6bd60306-2" name="rest_code_12f48f1091c840fd998f65fe6bd60306-2" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_12f48f1091c840fd998f65fe6bd60306-2"&gt;&lt;/a&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;scipy.sparse&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;diags&lt;/span&gt;
&lt;a id="rest_code_12f48f1091c840fd998f65fe6bd60306-3" name="rest_code_12f48f1091c840fd998f65fe6bd60306-3" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_12f48f1091c840fd998f65fe6bd60306-3"&gt;&lt;/a&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;scipy.sparse.linalg&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;eigs&lt;/span&gt;
&lt;a id="rest_code_12f48f1091c840fd998f65fe6bd60306-4" name="rest_code_12f48f1091c840fd998f65fe6bd60306-4" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_12f48f1091c840fd998f65fe6bd60306-4"&gt;&lt;/a&gt;
&lt;a id="rest_code_12f48f1091c840fd998f65fe6bd60306-5" name="rest_code_12f48f1091c840fd998f65fe6bd60306-5" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_12f48f1091c840fd998f65fe6bd60306-5"&gt;&lt;/a&gt;
&lt;a id="rest_code_12f48f1091c840fd998f65fe6bd60306-6" name="rest_code_12f48f1091c840fd998f65fe6bd60306-6" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_12f48f1091c840fd998f65fe6bd60306-6"&gt;&lt;/a&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;regular_FD&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;pot&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;npts&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;101&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;x_max&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;nvals&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;6&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_12f48f1091c840fd998f65fe6bd60306-7" name="rest_code_12f48f1091c840fd998f65fe6bd60306-7" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_12f48f1091c840fd998f65fe6bd60306-7"&gt;&lt;/a&gt;    &lt;span class="sd"&gt;"""&lt;/span&gt;
&lt;a id="rest_code_12f48f1091c840fd998f65fe6bd60306-8" name="rest_code_12f48f1091c840fd998f65fe6bd60306-8" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_12f48f1091c840fd998f65fe6bd60306-8"&gt;&lt;/a&gt;&lt;span class="sd"&gt;    Find eigenvalues/eigenfunctions for Schrodinger&lt;/span&gt;
&lt;a id="rest_code_12f48f1091c840fd998f65fe6bd60306-9" name="rest_code_12f48f1091c840fd998f65fe6bd60306-9" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_12f48f1091c840fd998f65fe6bd60306-9"&gt;&lt;/a&gt;&lt;span class="sd"&gt;    equation for the given potential `pot` using&lt;/span&gt;
&lt;a id="rest_code_12f48f1091c840fd998f65fe6bd60306-10" name="rest_code_12f48f1091c840fd998f65fe6bd60306-10" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_12f48f1091c840fd998f65fe6bd60306-10"&gt;&lt;/a&gt;&lt;span class="sd"&gt;    finite differences&lt;/span&gt;
&lt;a id="rest_code_12f48f1091c840fd998f65fe6bd60306-11" name="rest_code_12f48f1091c840fd998f65fe6bd60306-11" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_12f48f1091c840fd998f65fe6bd60306-11"&gt;&lt;/a&gt;&lt;span class="sd"&gt;    """&lt;/span&gt;
&lt;a id="rest_code_12f48f1091c840fd998f65fe6bd60306-12" name="rest_code_12f48f1091c840fd998f65fe6bd60306-12" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_12f48f1091c840fd998f65fe6bd60306-12"&gt;&lt;/a&gt;    &lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;linspace&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;x_max&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;x_max&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;npts&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_12f48f1091c840fd998f65fe6bd60306-13" name="rest_code_12f48f1091c840fd998f65fe6bd60306-13" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_12f48f1091c840fd998f65fe6bd60306-13"&gt;&lt;/a&gt;    &lt;span class="n"&gt;dx&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_12f48f1091c840fd998f65fe6bd60306-14" name="rest_code_12f48f1091c840fd998f65fe6bd60306-14" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_12f48f1091c840fd998f65fe6bd60306-14"&gt;&lt;/a&gt;    &lt;span class="n"&gt;D2&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;diags&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;shape&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;npts&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;npts&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;dx&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;
&lt;a id="rest_code_12f48f1091c840fd998f65fe6bd60306-15" name="rest_code_12f48f1091c840fd998f65fe6bd60306-15" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_12f48f1091c840fd998f65fe6bd60306-15"&gt;&lt;/a&gt;    &lt;span class="n"&gt;V&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;diags&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;pot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_12f48f1091c840fd998f65fe6bd60306-16" name="rest_code_12f48f1091c840fd998f65fe6bd60306-16" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_12f48f1091c840fd998f65fe6bd60306-16"&gt;&lt;/a&gt;    &lt;span class="n"&gt;H&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;0.5&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;D2&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;V&lt;/span&gt;
&lt;a id="rest_code_12f48f1091c840fd998f65fe6bd60306-17" name="rest_code_12f48f1091c840fd998f65fe6bd60306-17" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_12f48f1091c840fd998f65fe6bd60306-17"&gt;&lt;/a&gt;    &lt;span class="n"&gt;vals&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;vecs&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;eigs&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;H&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;k&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;nvals&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;which&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;"SM"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_12f48f1091c840fd998f65fe6bd60306-18" name="rest_code_12f48f1091c840fd998f65fe6bd60306-18" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_12f48f1091c840fd998f65fe6bd60306-18"&gt;&lt;/a&gt;    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;real&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;vals&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;vecs&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Let's setup the plotting details.&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code ipython3"&gt;&lt;a id="rest_code_c0b0d43523ce4b1492ebd6d05e14c3fa-1" name="rest_code_c0b0d43523ce4b1492ebd6d05e14c3fa-1" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_c0b0d43523ce4b1492ebd6d05e14c3fa-1"&gt;&lt;/a&gt;&lt;span class="c1"&gt;# Jupyter notebook plotting setup &amp;amp; imports&lt;/span&gt;
&lt;a id="rest_code_c0b0d43523ce4b1492ebd6d05e14c3fa-2" name="rest_code_c0b0d43523ce4b1492ebd6d05e14c3fa-2" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_c0b0d43523ce4b1492ebd6d05e14c3fa-2"&gt;&lt;/a&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="k"&gt;matplotlib&lt;/span&gt; notebook
&lt;a id="rest_code_c0b0d43523ce4b1492ebd6d05e14c3fa-3" name="rest_code_c0b0d43523ce4b1492ebd6d05e14c3fa-3" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_c0b0d43523ce4b1492ebd6d05e14c3fa-3"&gt;&lt;/a&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;matplotlib.pyplot&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;plt&lt;/span&gt;
&lt;a id="rest_code_c0b0d43523ce4b1492ebd6d05e14c3fa-4" name="rest_code_c0b0d43523ce4b1492ebd6d05e14c3fa-4" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_c0b0d43523ce4b1492ebd6d05e14c3fa-4"&gt;&lt;/a&gt;
&lt;a id="rest_code_c0b0d43523ce4b1492ebd6d05e14c3fa-5" name="rest_code_c0b0d43523ce4b1492ebd6d05e14c3fa-5" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_c0b0d43523ce4b1492ebd6d05e14c3fa-5"&gt;&lt;/a&gt;&lt;span class="n"&gt;gray&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;'#757575'&lt;/span&gt;
&lt;a id="rest_code_c0b0d43523ce4b1492ebd6d05e14c3fa-6" name="rest_code_c0b0d43523ce4b1492ebd6d05e14c3fa-6" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_c0b0d43523ce4b1492ebd6d05e14c3fa-6"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;rcParams&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;"figure.figsize"&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;6&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;4&lt;/span&gt;
&lt;a id="rest_code_c0b0d43523ce4b1492ebd6d05e14c3fa-7" name="rest_code_c0b0d43523ce4b1492ebd6d05e14c3fa-7" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_c0b0d43523ce4b1492ebd6d05e14c3fa-7"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;rcParams&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;"mathtext.fontset"&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s2"&gt;"cm"&lt;/span&gt;
&lt;a id="rest_code_c0b0d43523ce4b1492ebd6d05e14c3fa-8" name="rest_code_c0b0d43523ce4b1492ebd6d05e14c3fa-8" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_c0b0d43523ce4b1492ebd6d05e14c3fa-8"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;rcParams&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;"text.color"&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;gray&lt;/span&gt;
&lt;a id="rest_code_c0b0d43523ce4b1492ebd6d05e14c3fa-9" name="rest_code_c0b0d43523ce4b1492ebd6d05e14c3fa-9" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_c0b0d43523ce4b1492ebd6d05e14c3fa-9"&gt;&lt;/a&gt;&lt;span class="n"&gt;fontsize&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;rcParams&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;"font.size"&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;12&lt;/span&gt;
&lt;a id="rest_code_c0b0d43523ce4b1492ebd6d05e14c3fa-10" name="rest_code_c0b0d43523ce4b1492ebd6d05e14c3fa-10" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_c0b0d43523ce4b1492ebd6d05e14c3fa-10"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;rcParams&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;"xtick.color"&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;gray&lt;/span&gt;
&lt;a id="rest_code_c0b0d43523ce4b1492ebd6d05e14c3fa-11" name="rest_code_c0b0d43523ce4b1492ebd6d05e14c3fa-11" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_c0b0d43523ce4b1492ebd6d05e14c3fa-11"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;rcParams&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;"ytick.color"&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;gray&lt;/span&gt;
&lt;a id="rest_code_c0b0d43523ce4b1492ebd6d05e14c3fa-12" name="rest_code_c0b0d43523ce4b1492ebd6d05e14c3fa-12" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_c0b0d43523ce4b1492ebd6d05e14c3fa-12"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;rcParams&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;"axes.labelcolor"&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;gray&lt;/span&gt;
&lt;a id="rest_code_c0b0d43523ce4b1492ebd6d05e14c3fa-13" name="rest_code_c0b0d43523ce4b1492ebd6d05e14c3fa-13" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_c0b0d43523ce4b1492ebd6d05e14c3fa-13"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;rcParams&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;"axes.edgecolor"&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;gray&lt;/span&gt;
&lt;a id="rest_code_c0b0d43523ce4b1492ebd6d05e14c3fa-14" name="rest_code_c0b0d43523ce4b1492ebd6d05e14c3fa-14" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_c0b0d43523ce4b1492ebd6d05e14c3fa-14"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;rcParams&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;"axes.spines.right"&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="kc"&gt;False&lt;/span&gt;
&lt;a id="rest_code_c0b0d43523ce4b1492ebd6d05e14c3fa-15" name="rest_code_c0b0d43523ce4b1492ebd6d05e14c3fa-15" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_c0b0d43523ce4b1492ebd6d05e14c3fa-15"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;rcParams&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;"axes.spines.top"&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="kc"&gt;False&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Let's consider the &lt;a class="reference external" href="https://en.wikipedia.org/wiki/Quantum_harmonic_oscillator"&gt;Quantum harmonic
oscillator&lt;/a&gt;,
that has as eigenvalues&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
E_n = n + \frac{1}{2},\quad \forall n = 0, 1, 2 \cdots
\end{equation*}
&lt;/div&gt;
&lt;p&gt;Using the finite difference method we have values that are really close
to the analytic ones.&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code ipython3"&gt;&lt;a id="rest_code_c5b29b7b8a2e406dbc6094584cb49785-1" name="rest_code_c5b29b7b8a2e406dbc6094584cb49785-1" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_c5b29b7b8a2e406dbc6094584cb49785-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;vals&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;vecs&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;regular_FD&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;lambda&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="mf"&gt;0.5&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;npts&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;201&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_c5b29b7b8a2e406dbc6094584cb49785-2" name="rest_code_c5b29b7b8a2e406dbc6094584cb49785-2" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_c5b29b7b8a2e406dbc6094584cb49785-2"&gt;&lt;/a&gt;&lt;span class="n"&gt;vals&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;with output&lt;/p&gt;
&lt;pre class="literal-block"&gt;array([0.4996873 , 1.49843574, 2.49593063, 3.49216962, 4.48715031,
       5.4808703 ])&lt;/pre&gt;
&lt;p&gt;With the analytic ones&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code text"&gt;&lt;a id="rest_code_a1b8568290aa4f6a8cdedab04f4918af-1" name="rest_code_a1b8568290aa4f6a8cdedab04f4918af-1" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_a1b8568290aa4f6a8cdedab04f4918af-1"&gt;&lt;/a&gt;[0.5, 1.5, 2.5, 3.5, 4.5, 5.5])
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;If we plot these two, we obtain the following.&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code ipython3"&gt;&lt;a id="rest_code_364b14e77dd142f9b067275dad900d22-1" name="rest_code_364b14e77dd142f9b067275dad900d22-1" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_364b14e77dd142f9b067275dad900d22-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;figure&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a id="rest_code_364b14e77dd142f9b067275dad900d22-2" name="rest_code_364b14e77dd142f9b067275dad900d22-2" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_364b14e77dd142f9b067275dad900d22-2"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;plot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;anal_vals&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_364b14e77dd142f9b067275dad900d22-3" name="rest_code_364b14e77dd142f9b067275dad900d22-3" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_364b14e77dd142f9b067275dad900d22-3"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;plot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;vals&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;"o"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_364b14e77dd142f9b067275dad900d22-4" name="rest_code_364b14e77dd142f9b067275dad900d22-4" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_364b14e77dd142f9b067275dad900d22-4"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="sa"&gt;r&lt;/span&gt;&lt;span class="s2"&gt;"$n$"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;fontsize&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;16&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_364b14e77dd142f9b067275dad900d22-5" name="rest_code_364b14e77dd142f9b067275dad900d22-5" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_364b14e77dd142f9b067275dad900d22-5"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ylabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="sa"&gt;r&lt;/span&gt;&lt;span class="s2"&gt;"$E_n$"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;fontsize&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;16&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_364b14e77dd142f9b067275dad900d22-6" name="rest_code_364b14e77dd142f9b067275dad900d22-6" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_364b14e77dd142f9b067275dad900d22-6"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;legend&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="s2"&gt;"Analytic"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;"Finite differences"&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_364b14e77dd142f9b067275dad900d22-7" name="rest_code_364b14e77dd142f9b067275dad900d22-7" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_364b14e77dd142f9b067275dad900d22-7"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;tight_layout&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;img alt="Eigenvalues for the regular finite difference" class="align-center" src="https://nicoguaro.github.io/images/infinite_fdm/eigvals_regular.svg" style="width: 600px;"&gt;
&lt;p&gt;Let's see the eigenfunctions.&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code ipython3"&gt;&lt;a id="rest_code_3576b80d5935465ebfcd8542811ac290-1" name="rest_code_3576b80d5935465ebfcd8542811ac290-1" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_3576b80d5935465ebfcd8542811ac290-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;figure&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a id="rest_code_3576b80d5935465ebfcd8542811ac290-2" name="rest_code_3576b80d5935465ebfcd8542811ac290-2" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_3576b80d5935465ebfcd8542811ac290-2"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;plot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;abs&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;vecs&lt;/span&gt;&lt;span class="p"&gt;[:,&lt;/span&gt; &lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_3576b80d5935465ebfcd8542811ac290-3" name="rest_code_3576b80d5935465ebfcd8542811ac290-3" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_3576b80d5935465ebfcd8542811ac290-3"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlim&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;6&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;6&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_3576b80d5935465ebfcd8542811ac290-4" name="rest_code_3576b80d5935465ebfcd8542811ac290-4" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_3576b80d5935465ebfcd8542811ac290-4"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="sa"&gt;r&lt;/span&gt;&lt;span class="s2"&gt;"$x$"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;fontsize&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;16&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_3576b80d5935465ebfcd8542811ac290-5" name="rest_code_3576b80d5935465ebfcd8542811ac290-5" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_3576b80d5935465ebfcd8542811ac290-5"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ylabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="sa"&gt;r&lt;/span&gt;&lt;span class="s2"&gt;"$|\psi_n(x)|^2$"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;fontsize&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;16&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_3576b80d5935465ebfcd8542811ac290-6" name="rest_code_3576b80d5935465ebfcd8542811ac290-6" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_3576b80d5935465ebfcd8542811ac290-6"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;yticks&lt;/span&gt;&lt;span class="p"&gt;([])&lt;/span&gt;
&lt;a id="rest_code_3576b80d5935465ebfcd8542811ac290-7" name="rest_code_3576b80d5935465ebfcd8542811ac290-7" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_3576b80d5935465ebfcd8542811ac290-7"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;tight_layout&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;img alt="Eigenfunctions for the regular finite difference" class="align-center" src="https://nicoguaro.github.io/images/infinite_fdm/eigvecs_regular.svg" style="width: 600px;"&gt;
&lt;p&gt;One inconvenient with this method is the redundant sampling towards the
extreme of the intervals, while under sample the middle part.&lt;/p&gt;
&lt;/section&gt;
&lt;section id="changing-the-domain"&gt;
&lt;h3&gt;Changing the domain&lt;/h3&gt;
&lt;p&gt;Let's now consider the case where we transform the infinite domain to a
finite one with a change of variable&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
\xi = \xi(x)
\end{equation*}
&lt;/div&gt;
&lt;p&gt;with &lt;span class="math"&gt;\(\xi \in (-1, 1)\)&lt;/span&gt;. Two options for this transformation are:&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;&lt;span class="math"&gt;\(\xi = \tanh x\)&lt;/span&gt;; and&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;span class="math"&gt;\(\xi = \frac{2}{\pi} \arctan x\)&lt;/span&gt;.&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Making this change of variable the equation we need to solve the
following equation&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
-\frac{1}{2}\left(\frac{\mathrm{d}\xi}{\mathrm{d}x}\right)^2\frac{\mathrm{d}^2}{\mathrm{d}\xi^2}\psi(\xi) - \frac{1}{2}\frac{\mathrm{d}^2\xi}{\mathrm{d}x^2}\frac{\mathrm{d}}{\mathrm{d}\xi}\psi(\xi) + V(\xi) \psi(\xi) = E\psi(\xi)
\end{equation*}
&lt;/div&gt;
&lt;p&gt;The following snippet solve the eigenproblem for the mapped domain:&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code ipython3"&gt;&lt;a id="rest_code_f29df6fce5d149d2a202fda4d5ca60cd-1" name="rest_code_f29df6fce5d149d2a202fda4d5ca60cd-1" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_f29df6fce5d149d2a202fda4d5ca60cd-1"&gt;&lt;/a&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;mapped_FD&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;pot&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;fun&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;dxdxi&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;dxdxi2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;npts&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;101&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;nvals&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;6&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;xi_tol&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mf"&gt;1e-6&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_f29df6fce5d149d2a202fda4d5ca60cd-2" name="rest_code_f29df6fce5d149d2a202fda4d5ca60cd-2" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_f29df6fce5d149d2a202fda4d5ca60cd-2"&gt;&lt;/a&gt;    &lt;span class="sd"&gt;"""&lt;/span&gt;
&lt;a id="rest_code_f29df6fce5d149d2a202fda4d5ca60cd-3" name="rest_code_f29df6fce5d149d2a202fda4d5ca60cd-3" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_f29df6fce5d149d2a202fda4d5ca60cd-3"&gt;&lt;/a&gt;&lt;span class="sd"&gt;    Find eigenvalues/eigenfunctions for Schrodinger&lt;/span&gt;
&lt;a id="rest_code_f29df6fce5d149d2a202fda4d5ca60cd-4" name="rest_code_f29df6fce5d149d2a202fda4d5ca60cd-4" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_f29df6fce5d149d2a202fda4d5ca60cd-4"&gt;&lt;/a&gt;&lt;span class="sd"&gt;    equation for the given potential `pot` using&lt;/span&gt;
&lt;a id="rest_code_f29df6fce5d149d2a202fda4d5ca60cd-5" name="rest_code_f29df6fce5d149d2a202fda4d5ca60cd-5" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_f29df6fce5d149d2a202fda4d5ca60cd-5"&gt;&lt;/a&gt;&lt;span class="sd"&gt;    finite differences over a mapped domain on (-1, 1)&lt;/span&gt;
&lt;a id="rest_code_f29df6fce5d149d2a202fda4d5ca60cd-6" name="rest_code_f29df6fce5d149d2a202fda4d5ca60cd-6" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_f29df6fce5d149d2a202fda4d5ca60cd-6"&gt;&lt;/a&gt;&lt;span class="sd"&gt;    """&lt;/span&gt;
&lt;a id="rest_code_f29df6fce5d149d2a202fda4d5ca60cd-7" name="rest_code_f29df6fce5d149d2a202fda4d5ca60cd-7" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_f29df6fce5d149d2a202fda4d5ca60cd-7"&gt;&lt;/a&gt;    &lt;span class="n"&gt;xi&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;linspace&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;xi_tol&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;xi_tol&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;npts&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_f29df6fce5d149d2a202fda4d5ca60cd-8" name="rest_code_f29df6fce5d149d2a202fda4d5ca60cd-8" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_f29df6fce5d149d2a202fda4d5ca60cd-8"&gt;&lt;/a&gt;    &lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;fun&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;xi&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_f29df6fce5d149d2a202fda4d5ca60cd-9" name="rest_code_f29df6fce5d149d2a202fda4d5ca60cd-9" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_f29df6fce5d149d2a202fda4d5ca60cd-9"&gt;&lt;/a&gt;    &lt;span class="n"&gt;dxi&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;xi&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;xi&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_f29df6fce5d149d2a202fda4d5ca60cd-10" name="rest_code_f29df6fce5d149d2a202fda4d5ca60cd-10" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_f29df6fce5d149d2a202fda4d5ca60cd-10"&gt;&lt;/a&gt;    &lt;span class="n"&gt;D2&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;diags&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;shape&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;npts&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;npts&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;dxi&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;
&lt;a id="rest_code_f29df6fce5d149d2a202fda4d5ca60cd-11" name="rest_code_f29df6fce5d149d2a202fda4d5ca60cd-11" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_f29df6fce5d149d2a202fda4d5ca60cd-11"&gt;&lt;/a&gt;    &lt;span class="n"&gt;D1&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;0.5&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;diags&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;shape&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;npts&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;npts&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;dxi&lt;/span&gt;
&lt;a id="rest_code_f29df6fce5d149d2a202fda4d5ca60cd-12" name="rest_code_f29df6fce5d149d2a202fda4d5ca60cd-12" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_f29df6fce5d149d2a202fda4d5ca60cd-12"&gt;&lt;/a&gt;    &lt;span class="n"&gt;V&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;diags&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;pot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_f29df6fce5d149d2a202fda4d5ca60cd-13" name="rest_code_f29df6fce5d149d2a202fda4d5ca60cd-13" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_f29df6fce5d149d2a202fda4d5ca60cd-13"&gt;&lt;/a&gt;    &lt;span class="n"&gt;fac1&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;diags&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;dxdxi&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;xi&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_f29df6fce5d149d2a202fda4d5ca60cd-14" name="rest_code_f29df6fce5d149d2a202fda4d5ca60cd-14" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_f29df6fce5d149d2a202fda4d5ca60cd-14"&gt;&lt;/a&gt;    &lt;span class="n"&gt;fac2&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;diags&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;dxdxi2&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;xi&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_f29df6fce5d149d2a202fda4d5ca60cd-15" name="rest_code_f29df6fce5d149d2a202fda4d5ca60cd-15" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_f29df6fce5d149d2a202fda4d5ca60cd-15"&gt;&lt;/a&gt;    &lt;span class="n"&gt;H&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;0.5&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;fac1&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;dot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;D2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="mf"&gt;0.5&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;fac2&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;dot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;D1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;V&lt;/span&gt;
&lt;a id="rest_code_f29df6fce5d149d2a202fda4d5ca60cd-16" name="rest_code_f29df6fce5d149d2a202fda4d5ca60cd-16" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_f29df6fce5d149d2a202fda4d5ca60cd-16"&gt;&lt;/a&gt;    &lt;span class="n"&gt;vals&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;vecs&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;eigs&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;H&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;k&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;nvals&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;which&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;"SM"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_f29df6fce5d149d2a202fda4d5ca60cd-17" name="rest_code_f29df6fce5d149d2a202fda4d5ca60cd-17" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_f29df6fce5d149d2a202fda4d5ca60cd-17"&gt;&lt;/a&gt;    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;real&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;vals&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;vecs&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;section id="first-transformation-xi-tanh-x"&gt;
&lt;h4&gt;First transformation: &lt;span class="math"&gt;\(\xi = \tanh(x)\)&lt;/span&gt;&lt;/h4&gt;
&lt;p&gt;Let's consider first the transformation&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
\xi = \tanh(x)\, .
\end{equation*}
&lt;/div&gt;
&lt;p&gt;In this case&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
\frac{\mathrm{d}\xi}{\mathrm{d}x} = 1 - \tanh^2(x) = 1 - \xi^2\, ,
\end{equation*}
&lt;/div&gt;
&lt;p&gt;and&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
\frac{\mathrm{d}^2\xi}{\mathrm{d}x^2} = -2\tanh(x)[1 - \tanh^2(x)] = -2\xi[1 - \xi^2]\, .
\end{equation*}
&lt;/div&gt;
&lt;p&gt;We need to define the functions&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code ipython3"&gt;&lt;a id="rest_code_a0efaa8e7b7a4f4894fa667f60e6c739-1" name="rest_code_a0efaa8e7b7a4f4894fa667f60e6c739-1" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_a0efaa8e7b7a4f4894fa667f60e6c739-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;pot&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;lambda&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="mf"&gt;0.5&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;
&lt;a id="rest_code_a0efaa8e7b7a4f4894fa667f60e6c739-2" name="rest_code_a0efaa8e7b7a4f4894fa667f60e6c739-2" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_a0efaa8e7b7a4f4894fa667f60e6c739-2"&gt;&lt;/a&gt;&lt;span class="n"&gt;fun&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;lambda&lt;/span&gt; &lt;span class="n"&gt;xi&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;arctanh&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;xi&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_a0efaa8e7b7a4f4894fa667f60e6c739-3" name="rest_code_a0efaa8e7b7a4f4894fa667f60e6c739-3" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_a0efaa8e7b7a4f4894fa667f60e6c739-3"&gt;&lt;/a&gt;&lt;span class="n"&gt;dxdxi&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;lambda&lt;/span&gt; &lt;span class="n"&gt;xi&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;xi&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;
&lt;a id="rest_code_a0efaa8e7b7a4f4894fa667f60e6c739-4" name="rest_code_a0efaa8e7b7a4f4894fa667f60e6c739-4" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_a0efaa8e7b7a4f4894fa667f60e6c739-4"&gt;&lt;/a&gt;&lt;span class="n"&gt;dxdxi2&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;lambda&lt;/span&gt; &lt;span class="n"&gt;xi&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;xi&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;xi&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;and run the function&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code ipython3"&gt;&lt;a id="rest_code_7654b660514e4233b4f3950d3c4724d5-1" name="rest_code_7654b660514e4233b4f3950d3c4724d5-1" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_7654b660514e4233b4f3950d3c4724d5-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;vals&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;vecs&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;mapped_FD&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;pot&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;fun&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;dxdxi&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;dxdxi2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;npts&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;201&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_7654b660514e4233b4f3950d3c4724d5-2" name="rest_code_7654b660514e4233b4f3950d3c4724d5-2" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_7654b660514e4233b4f3950d3c4724d5-2"&gt;&lt;/a&gt;&lt;span class="n"&gt;vals&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;And we obtain the following&lt;/p&gt;
&lt;pre class="literal-block"&gt;array([0.49989989, 1.4984226 , 2.49003572, 3.46934257, 4.46935021,
       5.59552989])&lt;/pre&gt;
&lt;p&gt;If we compare with the analytic values we get the following.&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code ipython3"&gt;&lt;a id="rest_code_60f3402ee2284304ab5e41099508093f-1" name="rest_code_60f3402ee2284304ab5e41099508093f-1" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_60f3402ee2284304ab5e41099508093f-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;figure&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a id="rest_code_60f3402ee2284304ab5e41099508093f-2" name="rest_code_60f3402ee2284304ab5e41099508093f-2" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_60f3402ee2284304ab5e41099508093f-2"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;plot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;anal_vals&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_60f3402ee2284304ab5e41099508093f-3" name="rest_code_60f3402ee2284304ab5e41099508093f-3" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_60f3402ee2284304ab5e41099508093f-3"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;plot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;vals&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;"o"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_60f3402ee2284304ab5e41099508093f-4" name="rest_code_60f3402ee2284304ab5e41099508093f-4" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_60f3402ee2284304ab5e41099508093f-4"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;legend&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="s2"&gt;"Analytic"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;"Finite differences"&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_60f3402ee2284304ab5e41099508093f-5" name="rest_code_60f3402ee2284304ab5e41099508093f-5" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_60f3402ee2284304ab5e41099508093f-5"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="sa"&gt;r&lt;/span&gt;&lt;span class="s2"&gt;"$n$"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;fontsize&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;16&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_60f3402ee2284304ab5e41099508093f-6" name="rest_code_60f3402ee2284304ab5e41099508093f-6" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_60f3402ee2284304ab5e41099508093f-6"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ylabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="sa"&gt;r&lt;/span&gt;&lt;span class="s2"&gt;"$E_n$"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;fontsize&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;16&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_60f3402ee2284304ab5e41099508093f-7" name="rest_code_60f3402ee2284304ab5e41099508093f-7" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_60f3402ee2284304ab5e41099508093f-7"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;tight_layout&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;img alt="Eigenvalues for the first transformation" class="align-center" src="https://nicoguaro.github.io/images/infinite_fdm/eigvals_tanh.svg" style="width: 600px;"&gt;
&lt;p&gt;And the following are the eigenfunctions.&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code ipython3"&gt;&lt;a id="rest_code_1b0a8872f72f4334b4a439685dc8cf87-1" name="rest_code_1b0a8872f72f4334b4a439685dc8cf87-1" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_1b0a8872f72f4334b4a439685dc8cf87-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;figure&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a id="rest_code_1b0a8872f72f4334b4a439685dc8cf87-2" name="rest_code_1b0a8872f72f4334b4a439685dc8cf87-2" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_1b0a8872f72f4334b4a439685dc8cf87-2"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;plot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;abs&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;vecs&lt;/span&gt;&lt;span class="p"&gt;[:,&lt;/span&gt; &lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_1b0a8872f72f4334b4a439685dc8cf87-3" name="rest_code_1b0a8872f72f4334b4a439685dc8cf87-3" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_1b0a8872f72f4334b4a439685dc8cf87-3"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlim&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;6&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;6&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_1b0a8872f72f4334b4a439685dc8cf87-4" name="rest_code_1b0a8872f72f4334b4a439685dc8cf87-4" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_1b0a8872f72f4334b4a439685dc8cf87-4"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="sa"&gt;r&lt;/span&gt;&lt;span class="s2"&gt;"$x$"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;fontsize&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;16&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_1b0a8872f72f4334b4a439685dc8cf87-5" name="rest_code_1b0a8872f72f4334b4a439685dc8cf87-5" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_1b0a8872f72f4334b4a439685dc8cf87-5"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ylabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="sa"&gt;r&lt;/span&gt;&lt;span class="s2"&gt;"$|\psi_n(x)|^2$"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;fontsize&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;16&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_1b0a8872f72f4334b4a439685dc8cf87-6" name="rest_code_1b0a8872f72f4334b4a439685dc8cf87-6" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_1b0a8872f72f4334b4a439685dc8cf87-6"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;yticks&lt;/span&gt;&lt;span class="p"&gt;([])&lt;/span&gt;
&lt;a id="rest_code_1b0a8872f72f4334b4a439685dc8cf87-7" name="rest_code_1b0a8872f72f4334b4a439685dc8cf87-7" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_1b0a8872f72f4334b4a439685dc8cf87-7"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;tight_layout&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;img alt="Eigenfunctions for the first transformation" class="align-center" src="https://nicoguaro.github.io/images/infinite_fdm/eigvecs_tanh.svg" style="width: 600px;"&gt;
&lt;/section&gt;
&lt;section id="second-transformation-xi-frac-2-pi-mathrm-atan-x"&gt;
&lt;h4&gt;Second transformation: &lt;span class="math"&gt;\(\xi = \frac{2}{\pi}\mathrm{atan}(x)\)&lt;/span&gt;&lt;/h4&gt;
&lt;p&gt;Let's consider first the transformation&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
\xi = \frac{2}{\pi}\mathrm{atan}(x)\, .
\end{equation*}
&lt;/div&gt;
&lt;p&gt;In this case&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
\frac{\mathrm{d}\xi}{\mathrm{d}x} = \frac{2}{\pi(1 + x^2)} = \frac{2 \cos^2\xi}{\pi} \, ,
\end{equation*}
&lt;/div&gt;
&lt;p&gt;and&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
\frac{\mathrm{d}^2\xi}{\mathrm{d}x^2} = -\frac{4x}{\pi(1 + x^2)^2} = -\frac{4 \cos^4\xi \tan \xi}{\pi}\, .
\end{equation*}
&lt;/div&gt;
&lt;p&gt;Once, again, we define the functions.&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code ipython3"&gt;&lt;a id="rest_code_4aae7519e8b9492491d6c84b1a048dea-1" name="rest_code_4aae7519e8b9492491d6c84b1a048dea-1" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_4aae7519e8b9492491d6c84b1a048dea-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;pot&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;lambda&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="mf"&gt;0.5&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;
&lt;a id="rest_code_4aae7519e8b9492491d6c84b1a048dea-2" name="rest_code_4aae7519e8b9492491d6c84b1a048dea-2" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_4aae7519e8b9492491d6c84b1a048dea-2"&gt;&lt;/a&gt;&lt;span class="n"&gt;fun&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;lambda&lt;/span&gt; &lt;span class="n"&gt;xi&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;tan&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;0.5&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;pi&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;xi&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_4aae7519e8b9492491d6c84b1a048dea-3" name="rest_code_4aae7519e8b9492491d6c84b1a048dea-3" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_4aae7519e8b9492491d6c84b1a048dea-3"&gt;&lt;/a&gt;&lt;span class="n"&gt;dxdxi&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;lambda&lt;/span&gt; &lt;span class="n"&gt;xi&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;pi&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;cos&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;0.5&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;pi&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;xi&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;
&lt;a id="rest_code_4aae7519e8b9492491d6c84b1a048dea-4" name="rest_code_4aae7519e8b9492491d6c84b1a048dea-4" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_4aae7519e8b9492491d6c84b1a048dea-4"&gt;&lt;/a&gt;&lt;span class="n"&gt;dxdxi2&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;lambda&lt;/span&gt; &lt;span class="n"&gt;xi&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;pi&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;cos&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;0.5&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;pi&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;xi&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;tan&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;0.5&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;pi&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;xi&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;and run the function&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code ipython3"&gt;&lt;a id="rest_code_30a1756c35a54b64ac808de7e168ca90-1" name="rest_code_30a1756c35a54b64ac808de7e168ca90-1" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_30a1756c35a54b64ac808de7e168ca90-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;vals&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;vecs&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;mapped_FD&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;pot&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;fun&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;dxdxi&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;dxdxi2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;npts&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;201&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_30a1756c35a54b64ac808de7e168ca90-2" name="rest_code_30a1756c35a54b64ac808de7e168ca90-2" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_30a1756c35a54b64ac808de7e168ca90-2"&gt;&lt;/a&gt;&lt;span class="n"&gt;vals&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;to obtain the following eigenvalues&lt;/p&gt;
&lt;pre class="literal-block"&gt;array([0.49997815, 1.49979632, 2.49930872, 3.49824697, 4.49627555,
       5.49295665])&lt;/pre&gt;
&lt;p&gt;with this plot&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code ipython3"&gt;&lt;a id="rest_code_96dab83dbae44f64aab31d8af80d1c9c-1" name="rest_code_96dab83dbae44f64aab31d8af80d1c9c-1" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_96dab83dbae44f64aab31d8af80d1c9c-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;figure&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a id="rest_code_96dab83dbae44f64aab31d8af80d1c9c-2" name="rest_code_96dab83dbae44f64aab31d8af80d1c9c-2" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_96dab83dbae44f64aab31d8af80d1c9c-2"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;plot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;anal_vals&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_96dab83dbae44f64aab31d8af80d1c9c-3" name="rest_code_96dab83dbae44f64aab31d8af80d1c9c-3" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_96dab83dbae44f64aab31d8af80d1c9c-3"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;plot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;vals&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;"o"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_96dab83dbae44f64aab31d8af80d1c9c-4" name="rest_code_96dab83dbae44f64aab31d8af80d1c9c-4" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_96dab83dbae44f64aab31d8af80d1c9c-4"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;legend&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="s2"&gt;"Analytic"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;"Finite differences"&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_96dab83dbae44f64aab31d8af80d1c9c-5" name="rest_code_96dab83dbae44f64aab31d8af80d1c9c-5" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_96dab83dbae44f64aab31d8af80d1c9c-5"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="sa"&gt;r&lt;/span&gt;&lt;span class="s2"&gt;"$n$"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;fontsize&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;16&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_96dab83dbae44f64aab31d8af80d1c9c-6" name="rest_code_96dab83dbae44f64aab31d8af80d1c9c-6" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_96dab83dbae44f64aab31d8af80d1c9c-6"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ylabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="sa"&gt;r&lt;/span&gt;&lt;span class="s2"&gt;"$E_n$"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;fontsize&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;16&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_96dab83dbae44f64aab31d8af80d1c9c-7" name="rest_code_96dab83dbae44f64aab31d8af80d1c9c-7" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_96dab83dbae44f64aab31d8af80d1c9c-7"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;tight_layout&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;img alt="Eigenvalues for the second transformation" class="align-center" src="https://nicoguaro.github.io/images/infinite_fdm/eigvals_atan.svg" style="width: 600px;"&gt;
&lt;p&gt;and the following eigenfunctions.&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code ipython3"&gt;&lt;a id="rest_code_b7e557bed9134208a148d940ef7c6daa-1" name="rest_code_b7e557bed9134208a148d940ef7c6daa-1" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_b7e557bed9134208a148d940ef7c6daa-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;figure&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a id="rest_code_b7e557bed9134208a148d940ef7c6daa-2" name="rest_code_b7e557bed9134208a148d940ef7c6daa-2" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_b7e557bed9134208a148d940ef7c6daa-2"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;plot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;abs&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;vecs&lt;/span&gt;&lt;span class="p"&gt;[:,&lt;/span&gt; &lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_b7e557bed9134208a148d940ef7c6daa-3" name="rest_code_b7e557bed9134208a148d940ef7c6daa-3" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_b7e557bed9134208a148d940ef7c6daa-3"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="sa"&gt;r&lt;/span&gt;&lt;span class="s2"&gt;"$x$"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;fontsize&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;16&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_b7e557bed9134208a148d940ef7c6daa-4" name="rest_code_b7e557bed9134208a148d940ef7c6daa-4" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_b7e557bed9134208a148d940ef7c6daa-4"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ylabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="sa"&gt;r&lt;/span&gt;&lt;span class="s2"&gt;"$|\psi|^2$"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;fontsize&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;16&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_b7e557bed9134208a148d940ef7c6daa-5" name="rest_code_b7e557bed9134208a148d940ef7c6daa-5" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_b7e557bed9134208a148d940ef7c6daa-5"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlim&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;6&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;6&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_b7e557bed9134208a148d940ef7c6daa-6" name="rest_code_b7e557bed9134208a148d940ef7c6daa-6" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_b7e557bed9134208a148d940ef7c6daa-6"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="sa"&gt;r&lt;/span&gt;&lt;span class="s2"&gt;"$x$"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;fontsize&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;16&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_b7e557bed9134208a148d940ef7c6daa-7" name="rest_code_b7e557bed9134208a148d940ef7c6daa-7" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_b7e557bed9134208a148d940ef7c6daa-7"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ylabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="sa"&gt;r&lt;/span&gt;&lt;span class="s2"&gt;"$|\psi_n(x)|^2$"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;fontsize&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;16&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_b7e557bed9134208a148d940ef7c6daa-8" name="rest_code_b7e557bed9134208a148d940ef7c6daa-8" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_b7e557bed9134208a148d940ef7c6daa-8"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;yticks&lt;/span&gt;&lt;span class="p"&gt;([])&lt;/span&gt;
&lt;a id="rest_code_b7e557bed9134208a148d940ef7c6daa-9" name="rest_code_b7e557bed9134208a148d940ef7c6daa-9" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_b7e557bed9134208a148d940ef7c6daa-9"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;tight_layout&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;img alt="Eigenfunctions for the second transformation" class="align-center" src="https://nicoguaro.github.io/images/infinite_fdm/eigvecs_atan.svg" style="width: 600px;"&gt;
&lt;/section&gt;
&lt;/section&gt;
&lt;section id="conclusion"&gt;
&lt;h3&gt;Conclusion&lt;/h3&gt;
&lt;p&gt;The method works fine, although the differential equation is more
convoluted due to the change of variable. Although there are more
elegant methods to consider infinite domains, this is simple enough to
be solved in 10 lines of code.&lt;/p&gt;
&lt;p&gt;We can see that the mapping &lt;span class="math"&gt;\(\xi = \mathrm{atan}(x)\)&lt;/span&gt;, covers
better the domain than &lt;span class="math"&gt;\(\xi = \tanh(x)\)&lt;/span&gt;, where most of the points
are placed in the center of the interval.&lt;/p&gt;
&lt;p&gt;Thanks for reading!&lt;/p&gt;
&lt;small&gt;
  &lt;i&gt;
    This post was written in the Jupyter notebook. You can
    &lt;a href="https://nicoguaro.github.io/downloads/notebooks/finite_diff_map.ipynb"&gt;download&lt;/a&gt;
    this notebook, or see a static view on
    &lt;a href="http://nbviewer.jupyter.org/url/nicoguaro.github.io/downloads/notebooks/finite_diff_map.ipynb"&gt;nbviewer&lt;/a&gt;.
  &lt;i&gt;
&lt;/i&gt;&lt;/i&gt;&lt;/small&gt;&lt;/section&gt;
&lt;/section&gt;</description><category>finite difference method</category><category>pde</category><category>python</category><category>quantum mechanics</category><category>scientific computing</category><guid>https://nicoguaro.github.io/posts/infinite_fdm/</guid><pubDate>Thu, 17 May 2018 20:57:00 GMT</pubDate></item></channel></rss>