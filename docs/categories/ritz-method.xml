<?xml version="1.0" encoding="utf-8"?>
<?xml-stylesheet type="text/xsl" href="../assets/xml/rss.xsl" media="all"?><rss version="2.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Nicolás' blog (Posts about ritz method)</title><link>https://nicoguaro.github.io/</link><description></description><atom:link href="https://nicoguaro.github.io/categories/ritz-method.xml" rel="self" type="application/rss+xml"></atom:link><language>en</language><copyright>Contents © 2022 &lt;a href="mailto:nicoguarin@gmail.com"&gt;Nicolás Guarín-Zapata&lt;/a&gt; 
&lt;a rel="license" href="http://creativecommons.org/licenses/by/4.0/"&gt;
&lt;img alt="Creative Commons License"
style="border-width:0"
src="https://i.creativecommons.org/l/by/4.0/88x31.png"&gt;&lt;/a&gt;</copyright><lastBuildDate>Fri, 23 Sep 2022 18:57:39 GMT</lastBuildDate><generator>Nikola (getnikola.com)</generator><docs>http://blogs.law.harvard.edu/tech/rss</docs><item><title>Numerical methods challenge: Day 23</title><link>https://nicoguaro.github.io/posts/numerical_challenge/numerical-23/</link><dc:creator>Nicolás Guarín-Zapata</dc:creator><description>&lt;p&gt;During October (2017) I will write a program per day for some well-known
numerical methods in both Python and Julia. It is intended to be an exercise
then don't expect the code to be good enough for real use. Also,
I should mention that I have almost no experience with Julia, so it
probably won't be idiomatic Julia but more Python-like Julia.&lt;/p&gt;
&lt;section id="ritz-method"&gt;
&lt;h2&gt;Ritz method&lt;/h2&gt;
&lt;p&gt;Today we have the &lt;a class="reference external" href="https://en.wikipedia.org/wiki/Ritz_method"&gt;Ritz method&lt;/a&gt;
to solve the equation:&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
\frac{d^2 u}{dx^2} = f(x)
\end{equation*}
&lt;/div&gt;
&lt;p&gt;with&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
u(0) = u(1)  = 0
\end{equation*}
&lt;/div&gt;
&lt;p&gt;The method consist in forming a functional that is &lt;em&gt;equivalent&lt;/em&gt; to the
differential equation, propose an approximation as a linear combination of
a set of basis functions and find the &lt;em&gt;best&lt;/em&gt; set of coefficients for that
combination. That &lt;em&gt;best&lt;/em&gt; solution is found minimizing the functional.&lt;/p&gt;
&lt;p&gt;The functional for this differential equation is&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
\Pi[u] = -\int_{0}^{1} \left(\frac{d u}{d x}\right)^2 dx
         -\int_{0}^{1}  u f(x) dx
\end{equation*}
&lt;/div&gt;
&lt;p&gt;In this case, we are using the approximation&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
\hat{u}(x) = x (1 - x)\sum_{n=0}^{N} c_n x^n\, ,
\end{equation*}
&lt;/div&gt;
&lt;p&gt;where we picked the factor &lt;span class="math"&gt;\(x (1 - x)\)&lt;/span&gt; to enforce that the basis
functions satisfy the boundary conditions. The approximated functional
reads&lt;/p&gt;
&lt;div class="math"&gt;
\begin{align*}
\Pi[\hat{u}] = -\sum_{n=0}^{N} \sum_{m=0}^{N} c_n c_m
    \left[\frac{2 + 2m + 2n + 2mn}{(n + m + 1)(n + m + 2)(n + m +3)}\right]
    -\\ \sum_{n=0}^{N} c_n\int_{0}^{1} x^{n + 1}(1 - x) f(x) dx
\end{align*}
&lt;/div&gt;
&lt;p&gt;where, in general, we will need to perform numerical integration for the
second term.&lt;/p&gt;
&lt;p&gt;Minimizing the functional&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
\frac{\partial \Pi[\hat{u}]}{\partial c_m} = 0\, ,
\end{equation*}
&lt;/div&gt;
&lt;p&gt;we obtain the system of equations&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
[K]\{\mathbf{c}\} = \{\mathbf{b}\}
\end{equation*}
&lt;/div&gt;
&lt;p&gt;with&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
K_{mn} = \frac{2 + 2m + 2n + 2mn}{(n + m + 1)(n + m + 2)(n + m +3)}
\end{equation*}
&lt;/div&gt;
&lt;p&gt;and&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
b_m = -\int_{0}^{1} x^{m + 1}(1 - x) f(x) dx\, .
\end{equation*}
&lt;/div&gt;
&lt;p&gt;We will test the implementation with the function &lt;span class="math"&gt;\(f(x) = x^3\)&lt;/span&gt;, that
leads to the solution&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
u(x) = \frac{x (x^4 - 1)}{20}
\end{equation*}
&lt;/div&gt;
&lt;p&gt;Following are the codes.&lt;/p&gt;
&lt;section id="python"&gt;
&lt;h3&gt;Python&lt;/h3&gt;
&lt;div class="code"&gt;&lt;pre class="code python"&gt;&lt;a id="rest_code_d847942e98b64bb98dc6a6a9e77db8e8-1" name="rest_code_d847942e98b64bb98dc6a6a9e77db8e8-1" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-23/#rest_code_d847942e98b64bb98dc6a6a9e77db8e8-1"&gt;&lt;/a&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;__future__&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;division&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;print_function&lt;/span&gt;
&lt;a id="rest_code_d847942e98b64bb98dc6a6a9e77db8e8-2" name="rest_code_d847942e98b64bb98dc6a6a9e77db8e8-2" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-23/#rest_code_d847942e98b64bb98dc6a6a9e77db8e8-2"&gt;&lt;/a&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;numpy&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;np&lt;/span&gt;
&lt;a id="rest_code_d847942e98b64bb98dc6a6a9e77db8e8-3" name="rest_code_d847942e98b64bb98dc6a6a9e77db8e8-3" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-23/#rest_code_d847942e98b64bb98dc6a6a9e77db8e8-3"&gt;&lt;/a&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;scipy.integrate&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;quad&lt;/span&gt;
&lt;a id="rest_code_d847942e98b64bb98dc6a6a9e77db8e8-4" name="rest_code_d847942e98b64bb98dc6a6a9e77db8e8-4" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-23/#rest_code_d847942e98b64bb98dc6a6a9e77db8e8-4"&gt;&lt;/a&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;scipy.linalg&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;solve&lt;/span&gt;
&lt;a id="rest_code_d847942e98b64bb98dc6a6a9e77db8e8-5" name="rest_code_d847942e98b64bb98dc6a6a9e77db8e8-5" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-23/#rest_code_d847942e98b64bb98dc6a6a9e77db8e8-5"&gt;&lt;/a&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;matplotlib.pyplot&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;plt&lt;/span&gt;
&lt;a id="rest_code_d847942e98b64bb98dc6a6a9e77db8e8-6" name="rest_code_d847942e98b64bb98dc6a6a9e77db8e8-6" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-23/#rest_code_d847942e98b64bb98dc6a6a9e77db8e8-6"&gt;&lt;/a&gt;
&lt;a id="rest_code_d847942e98b64bb98dc6a6a9e77db8e8-7" name="rest_code_d847942e98b64bb98dc6a6a9e77db8e8-7" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-23/#rest_code_d847942e98b64bb98dc6a6a9e77db8e8-7"&gt;&lt;/a&gt;
&lt;a id="rest_code_d847942e98b64bb98dc6a6a9e77db8e8-8" name="rest_code_d847942e98b64bb98dc6a6a9e77db8e8-8" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-23/#rest_code_d847942e98b64bb98dc6a6a9e77db8e8-8"&gt;&lt;/a&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;ritz&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;source&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_d847942e98b64bb98dc6a6a9e77db8e8-9" name="rest_code_d847942e98b64bb98dc6a6a9e77db8e8-9" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-23/#rest_code_d847942e98b64bb98dc6a6a9e77db8e8-9"&gt;&lt;/a&gt;    &lt;span class="n"&gt;stiff_mat&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_d847942e98b64bb98dc6a6a9e77db8e8-10" name="rest_code_d847942e98b64bb98dc6a6a9e77db8e8-10" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-23/#rest_code_d847942e98b64bb98dc6a6a9e77db8e8-10"&gt;&lt;/a&gt;    &lt;span class="n"&gt;rhs&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_d847942e98b64bb98dc6a6a9e77db8e8-11" name="rest_code_d847942e98b64bb98dc6a6a9e77db8e8-11" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-23/#rest_code_d847942e98b64bb98dc6a6a9e77db8e8-11"&gt;&lt;/a&gt;    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;row&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_d847942e98b64bb98dc6a6a9e77db8e8-12" name="rest_code_d847942e98b64bb98dc6a6a9e77db8e8-12" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-23/#rest_code_d847942e98b64bb98dc6a6a9e77db8e8-12"&gt;&lt;/a&gt;        &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;col&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_d847942e98b64bb98dc6a6a9e77db8e8-13" name="rest_code_d847942e98b64bb98dc6a6a9e77db8e8-13" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-23/#rest_code_d847942e98b64bb98dc6a6a9e77db8e8-13"&gt;&lt;/a&gt;            &lt;span class="n"&gt;numer&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;row&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;col&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;row&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_d847942e98b64bb98dc6a6a9e77db8e8-14" name="rest_code_d847942e98b64bb98dc6a6a9e77db8e8-14" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-23/#rest_code_d847942e98b64bb98dc6a6a9e77db8e8-14"&gt;&lt;/a&gt;            &lt;span class="n"&gt;denom&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;row&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;col&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;row&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;col&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;row&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;col&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_d847942e98b64bb98dc6a6a9e77db8e8-15" name="rest_code_d847942e98b64bb98dc6a6a9e77db8e8-15" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-23/#rest_code_d847942e98b64bb98dc6a6a9e77db8e8-15"&gt;&lt;/a&gt;            &lt;span class="n"&gt;stiff_mat&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;row&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;numer&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;denom&lt;/span&gt;
&lt;a id="rest_code_d847942e98b64bb98dc6a6a9e77db8e8-16" name="rest_code_d847942e98b64bb98dc6a6a9e77db8e8-16" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-23/#rest_code_d847942e98b64bb98dc6a6a9e77db8e8-16"&gt;&lt;/a&gt;        &lt;span class="n"&gt;fun&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;lambda&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;row&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;source&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_d847942e98b64bb98dc6a6a9e77db8e8-17" name="rest_code_d847942e98b64bb98dc6a6a9e77db8e8-17" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-23/#rest_code_d847942e98b64bb98dc6a6a9e77db8e8-17"&gt;&lt;/a&gt;        &lt;span class="n"&gt;rhs&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;row&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;_&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;quad&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;fun&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_d847942e98b64bb98dc6a6a9e77db8e8-18" name="rest_code_d847942e98b64bb98dc6a6a9e77db8e8-18" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-23/#rest_code_d847942e98b64bb98dc6a6a9e77db8e8-18"&gt;&lt;/a&gt;    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;stiff_mat&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;rhs&lt;/span&gt;
&lt;a id="rest_code_d847942e98b64bb98dc6a6a9e77db8e8-19" name="rest_code_d847942e98b64bb98dc6a6a9e77db8e8-19" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-23/#rest_code_d847942e98b64bb98dc6a6a9e77db8e8-19"&gt;&lt;/a&gt;
&lt;a id="rest_code_d847942e98b64bb98dc6a6a9e77db8e8-20" name="rest_code_d847942e98b64bb98dc6a6a9e77db8e8-20" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-23/#rest_code_d847942e98b64bb98dc6a6a9e77db8e8-20"&gt;&lt;/a&gt;
&lt;a id="rest_code_d847942e98b64bb98dc6a6a9e77db8e8-21" name="rest_code_d847942e98b64bb98dc6a6a9e77db8e8-21" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-23/#rest_code_d847942e98b64bb98dc6a6a9e77db8e8-21"&gt;&lt;/a&gt;&lt;span class="n"&gt;N&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;
&lt;a id="rest_code_d847942e98b64bb98dc6a6a9e77db8e8-22" name="rest_code_d847942e98b64bb98dc6a6a9e77db8e8-22" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-23/#rest_code_d847942e98b64bb98dc6a6a9e77db8e8-22"&gt;&lt;/a&gt;&lt;span class="n"&gt;source&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;lambda&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;
&lt;a id="rest_code_d847942e98b64bb98dc6a6a9e77db8e8-23" name="rest_code_d847942e98b64bb98dc6a6a9e77db8e8-23" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-23/#rest_code_d847942e98b64bb98dc6a6a9e77db8e8-23"&gt;&lt;/a&gt;&lt;span class="n"&gt;mat&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;rhs&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;ritz&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;source&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_d847942e98b64bb98dc6a6a9e77db8e8-24" name="rest_code_d847942e98b64bb98dc6a6a9e77db8e8-24" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-23/#rest_code_d847942e98b64bb98dc6a6a9e77db8e8-24"&gt;&lt;/a&gt;&lt;span class="n"&gt;c&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;solve&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;mat&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;rhs&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_d847942e98b64bb98dc6a6a9e77db8e8-25" name="rest_code_d847942e98b64bb98dc6a6a9e77db8e8-25" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-23/#rest_code_d847942e98b64bb98dc6a6a9e77db8e8-25"&gt;&lt;/a&gt;&lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;linspace&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;100&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_d847942e98b64bb98dc6a6a9e77db8e8-26" name="rest_code_d847942e98b64bb98dc6a6a9e77db8e8-26" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-23/#rest_code_d847942e98b64bb98dc6a6a9e77db8e8-26"&gt;&lt;/a&gt;&lt;span class="n"&gt;y&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros_like&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_d847942e98b64bb98dc6a6a9e77db8e8-27" name="rest_code_d847942e98b64bb98dc6a6a9e77db8e8-27" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-23/#rest_code_d847942e98b64bb98dc6a6a9e77db8e8-27"&gt;&lt;/a&gt;&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;cont&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_d847942e98b64bb98dc6a6a9e77db8e8-28" name="rest_code_d847942e98b64bb98dc6a6a9e77db8e8-28" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-23/#rest_code_d847942e98b64bb98dc6a6a9e77db8e8-28"&gt;&lt;/a&gt;    &lt;span class="n"&gt;y&lt;/span&gt; &lt;span class="o"&gt;+=&lt;/span&gt; &lt;span class="n"&gt;c&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;cont&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;cont&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_d847942e98b64bb98dc6a6a9e77db8e8-29" name="rest_code_d847942e98b64bb98dc6a6a9e77db8e8-29" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-23/#rest_code_d847942e98b64bb98dc6a6a9e77db8e8-29"&gt;&lt;/a&gt;
&lt;a id="rest_code_d847942e98b64bb98dc6a6a9e77db8e8-30" name="rest_code_d847942e98b64bb98dc6a6a9e77db8e8-30" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-23/#rest_code_d847942e98b64bb98dc6a6a9e77db8e8-30"&gt;&lt;/a&gt;&lt;span class="c1"&gt;#%% Plotting&lt;/span&gt;
&lt;a id="rest_code_d847942e98b64bb98dc6a6a9e77db8e8-31" name="rest_code_d847942e98b64bb98dc6a6a9e77db8e8-31" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-23/#rest_code_d847942e98b64bb98dc6a6a9e77db8e8-31"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;figure&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;figsize&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_d847942e98b64bb98dc6a6a9e77db8e8-32" name="rest_code_d847942e98b64bb98dc6a6a9e77db8e8-32" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-23/#rest_code_d847942e98b64bb98dc6a6a9e77db8e8-32"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;plot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_d847942e98b64bb98dc6a6a9e77db8e8-33" name="rest_code_d847942e98b64bb98dc6a6a9e77db8e8-33" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-23/#rest_code_d847942e98b64bb98dc6a6a9e77db8e8-33"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;plot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="mi"&gt;20&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;linestyle&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;"dashed"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_d847942e98b64bb98dc6a6a9e77db8e8-34" name="rest_code_d847942e98b64bb98dc6a6a9e77db8e8-34" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-23/#rest_code_d847942e98b64bb98dc6a6a9e77db8e8-34"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="sa"&gt;r&lt;/span&gt;&lt;span class="s2"&gt;"$x$"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_d847942e98b64bb98dc6a6a9e77db8e8-35" name="rest_code_d847942e98b64bb98dc6a6a9e77db8e8-35" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-23/#rest_code_d847942e98b64bb98dc6a6a9e77db8e8-35"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ylabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="sa"&gt;r&lt;/span&gt;&lt;span class="s2"&gt;"$y$"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_d847942e98b64bb98dc6a6a9e77db8e8-36" name="rest_code_d847942e98b64bb98dc6a6a9e77db8e8-36" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-23/#rest_code_d847942e98b64bb98dc6a6a9e77db8e8-36"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;legend&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="s2"&gt;"Ritz solution"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;"Exact solution"&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_d847942e98b64bb98dc6a6a9e77db8e8-37" name="rest_code_d847942e98b64bb98dc6a6a9e77db8e8-37" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-23/#rest_code_d847942e98b64bb98dc6a6a9e77db8e8-37"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;tight_layout&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a id="rest_code_d847942e98b64bb98dc6a6a9e77db8e8-38" name="rest_code_d847942e98b64bb98dc6a6a9e77db8e8-38" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-23/#rest_code_d847942e98b64bb98dc6a6a9e77db8e8-38"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;show&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/section&gt;
&lt;section id="julia"&gt;
&lt;h3&gt;Julia&lt;/h3&gt;
&lt;div class="code"&gt;&lt;pre class="code julia"&gt;&lt;a id="rest_code_f8f85c4e91834e4a8d12e92aa8ee3009-1" name="rest_code_f8f85c4e91834e4a8d12e92aa8ee3009-1" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-23/#rest_code_f8f85c4e91834e4a8d12e92aa8ee3009-1"&gt;&lt;/a&gt;&lt;span class="k"&gt;using&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;PyPlot&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_f8f85c4e91834e4a8d12e92aa8ee3009-2" name="rest_code_f8f85c4e91834e4a8d12e92aa8ee3009-2" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-23/#rest_code_f8f85c4e91834e4a8d12e92aa8ee3009-2"&gt;&lt;/a&gt;
&lt;a id="rest_code_f8f85c4e91834e4a8d12e92aa8ee3009-3" name="rest_code_f8f85c4e91834e4a8d12e92aa8ee3009-3" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-23/#rest_code_f8f85c4e91834e4a8d12e92aa8ee3009-3"&gt;&lt;/a&gt;
&lt;a id="rest_code_f8f85c4e91834e4a8d12e92aa8ee3009-4" name="rest_code_f8f85c4e91834e4a8d12e92aa8ee3009-4" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-23/#rest_code_f8f85c4e91834e4a8d12e92aa8ee3009-4"&gt;&lt;/a&gt;&lt;span class="k"&gt;function&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ritz&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;source&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_f8f85c4e91834e4a8d12e92aa8ee3009-5" name="rest_code_f8f85c4e91834e4a8d12e92aa8ee3009-5" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-23/#rest_code_f8f85c4e91834e4a8d12e92aa8ee3009-5"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;stiff_mat&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_f8f85c4e91834e4a8d12e92aa8ee3009-6" name="rest_code_f8f85c4e91834e4a8d12e92aa8ee3009-6" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-23/#rest_code_f8f85c4e91834e4a8d12e92aa8ee3009-6"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;rhs&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_f8f85c4e91834e4a8d12e92aa8ee3009-7" name="rest_code_f8f85c4e91834e4a8d12e92aa8ee3009-7" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-23/#rest_code_f8f85c4e91834e4a8d12e92aa8ee3009-7"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;for&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;row&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;in&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_f8f85c4e91834e4a8d12e92aa8ee3009-8" name="rest_code_f8f85c4e91834e4a8d12e92aa8ee3009-8" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-23/#rest_code_f8f85c4e91834e4a8d12e92aa8ee3009-8"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="k"&gt;for&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;in&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_f8f85c4e91834e4a8d12e92aa8ee3009-9" name="rest_code_f8f85c4e91834e4a8d12e92aa8ee3009-9" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-23/#rest_code_f8f85c4e91834e4a8d12e92aa8ee3009-9"&gt;&lt;/a&gt;&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="n"&gt;numer&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;row&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;row&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_f8f85c4e91834e4a8d12e92aa8ee3009-10" name="rest_code_f8f85c4e91834e4a8d12e92aa8ee3009-10" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-23/#rest_code_f8f85c4e91834e4a8d12e92aa8ee3009-10"&gt;&lt;/a&gt;&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="n"&gt;denom&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;row&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;row&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;row&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_f8f85c4e91834e4a8d12e92aa8ee3009-11" name="rest_code_f8f85c4e91834e4a8d12e92aa8ee3009-11" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-23/#rest_code_f8f85c4e91834e4a8d12e92aa8ee3009-11"&gt;&lt;/a&gt;&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="n"&gt;stiff_mat&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;row&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;numer&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;denom&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_f8f85c4e91834e4a8d12e92aa8ee3009-12" name="rest_code_f8f85c4e91834e4a8d12e92aa8ee3009-12" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-23/#rest_code_f8f85c4e91834e4a8d12e92aa8ee3009-12"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="k"&gt;end&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_f8f85c4e91834e4a8d12e92aa8ee3009-13" name="rest_code_f8f85c4e91834e4a8d12e92aa8ee3009-13" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-23/#rest_code_f8f85c4e91834e4a8d12e92aa8ee3009-13"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;fun&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;^&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;row&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;source&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_f8f85c4e91834e4a8d12e92aa8ee3009-14" name="rest_code_f8f85c4e91834e4a8d12e92aa8ee3009-14" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-23/#rest_code_f8f85c4e91834e4a8d12e92aa8ee3009-14"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;rhs&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;row&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;_&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;quadgk&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;fun&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_f8f85c4e91834e4a8d12e92aa8ee3009-15" name="rest_code_f8f85c4e91834e4a8d12e92aa8ee3009-15" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-23/#rest_code_f8f85c4e91834e4a8d12e92aa8ee3009-15"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;end&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_f8f85c4e91834e4a8d12e92aa8ee3009-16" name="rest_code_f8f85c4e91834e4a8d12e92aa8ee3009-16" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-23/#rest_code_f8f85c4e91834e4a8d12e92aa8ee3009-16"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;return&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;stiff_mat&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;rhs&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_f8f85c4e91834e4a8d12e92aa8ee3009-17" name="rest_code_f8f85c4e91834e4a8d12e92aa8ee3009-17" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-23/#rest_code_f8f85c4e91834e4a8d12e92aa8ee3009-17"&gt;&lt;/a&gt;&lt;span class="k"&gt;end&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_f8f85c4e91834e4a8d12e92aa8ee3009-18" name="rest_code_f8f85c4e91834e4a8d12e92aa8ee3009-18" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-23/#rest_code_f8f85c4e91834e4a8d12e92aa8ee3009-18"&gt;&lt;/a&gt;
&lt;a id="rest_code_f8f85c4e91834e4a8d12e92aa8ee3009-19" name="rest_code_f8f85c4e91834e4a8d12e92aa8ee3009-19" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-23/#rest_code_f8f85c4e91834e4a8d12e92aa8ee3009-19"&gt;&lt;/a&gt;
&lt;a id="rest_code_f8f85c4e91834e4a8d12e92aa8ee3009-20" name="rest_code_f8f85c4e91834e4a8d12e92aa8ee3009-20" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-23/#rest_code_f8f85c4e91834e4a8d12e92aa8ee3009-20"&gt;&lt;/a&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_f8f85c4e91834e4a8d12e92aa8ee3009-21" name="rest_code_f8f85c4e91834e4a8d12e92aa8ee3009-21" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-23/#rest_code_f8f85c4e91834e4a8d12e92aa8ee3009-21"&gt;&lt;/a&gt;&lt;span class="n"&gt;source&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;^&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_f8f85c4e91834e4a8d12e92aa8ee3009-22" name="rest_code_f8f85c4e91834e4a8d12e92aa8ee3009-22" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-23/#rest_code_f8f85c4e91834e4a8d12e92aa8ee3009-22"&gt;&lt;/a&gt;&lt;span class="n"&gt;mat&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;rhs&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ritz&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;source&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_f8f85c4e91834e4a8d12e92aa8ee3009-23" name="rest_code_f8f85c4e91834e4a8d12e92aa8ee3009-23" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-23/#rest_code_f8f85c4e91834e4a8d12e92aa8ee3009-23"&gt;&lt;/a&gt;&lt;span class="n"&gt;c&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;mat&lt;/span&gt;&lt;span class="o"&gt;\&lt;/span&gt;&lt;span class="n"&gt;rhs&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_f8f85c4e91834e4a8d12e92aa8ee3009-24" name="rest_code_f8f85c4e91834e4a8d12e92aa8ee3009-24" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-23/#rest_code_f8f85c4e91834e4a8d12e92aa8ee3009-24"&gt;&lt;/a&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;linspace&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;100&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_f8f85c4e91834e4a8d12e92aa8ee3009-25" name="rest_code_f8f85c4e91834e4a8d12e92aa8ee3009-25" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-23/#rest_code_f8f85c4e91834e4a8d12e92aa8ee3009-25"&gt;&lt;/a&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_f8f85c4e91834e4a8d12e92aa8ee3009-26" name="rest_code_f8f85c4e91834e4a8d12e92aa8ee3009-26" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-23/#rest_code_f8f85c4e91834e4a8d12e92aa8ee3009-26"&gt;&lt;/a&gt;&lt;span class="k"&gt;for&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;cont&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;in&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_f8f85c4e91834e4a8d12e92aa8ee3009-27" name="rest_code_f8f85c4e91834e4a8d12e92aa8ee3009-27" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-23/#rest_code_f8f85c4e91834e4a8d12e92aa8ee3009-27"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;c&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;cont&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;.^&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;cont&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.*&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_f8f85c4e91834e4a8d12e92aa8ee3009-28" name="rest_code_f8f85c4e91834e4a8d12e92aa8ee3009-28" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-23/#rest_code_f8f85c4e91834e4a8d12e92aa8ee3009-28"&gt;&lt;/a&gt;&lt;span class="k"&gt;end&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_f8f85c4e91834e4a8d12e92aa8ee3009-29" name="rest_code_f8f85c4e91834e4a8d12e92aa8ee3009-29" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-23/#rest_code_f8f85c4e91834e4a8d12e92aa8ee3009-29"&gt;&lt;/a&gt;
&lt;a id="rest_code_f8f85c4e91834e4a8d12e92aa8ee3009-30" name="rest_code_f8f85c4e91834e4a8d12e92aa8ee3009-30" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-23/#rest_code_f8f85c4e91834e4a8d12e92aa8ee3009-30"&gt;&lt;/a&gt;&lt;span class="c"&gt;#%% Plotting&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_f8f85c4e91834e4a8d12e92aa8ee3009-31" name="rest_code_f8f85c4e91834e4a8d12e92aa8ee3009-31" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-23/#rest_code_f8f85c4e91834e4a8d12e92aa8ee3009-31"&gt;&lt;/a&gt;&lt;span class="n"&gt;figure&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;figsize&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_f8f85c4e91834e4a8d12e92aa8ee3009-32" name="rest_code_f8f85c4e91834e4a8d12e92aa8ee3009-32" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-23/#rest_code_f8f85c4e91834e4a8d12e92aa8ee3009-32"&gt;&lt;/a&gt;&lt;span class="n"&gt;plot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_f8f85c4e91834e4a8d12e92aa8ee3009-33" name="rest_code_f8f85c4e91834e4a8d12e92aa8ee3009-33" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-23/#rest_code_f8f85c4e91834e4a8d12e92aa8ee3009-33"&gt;&lt;/a&gt;&lt;span class="n"&gt;plot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;.*&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;.^&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="mi"&gt;20&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;linestyle&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;"dashed"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_f8f85c4e91834e4a8d12e92aa8ee3009-34" name="rest_code_f8f85c4e91834e4a8d12e92aa8ee3009-34" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-23/#rest_code_f8f85c4e91834e4a8d12e92aa8ee3009-34"&gt;&lt;/a&gt;&lt;span class="n"&gt;xlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="sa"&gt;L&lt;/span&gt;&lt;span class="s"&gt;"&lt;/span&gt;&lt;span class="si"&gt;$x&lt;/span&gt;&lt;span class="s"&gt;$"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_f8f85c4e91834e4a8d12e92aa8ee3009-35" name="rest_code_f8f85c4e91834e4a8d12e92aa8ee3009-35" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-23/#rest_code_f8f85c4e91834e4a8d12e92aa8ee3009-35"&gt;&lt;/a&gt;&lt;span class="n"&gt;ylabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="sa"&gt;L&lt;/span&gt;&lt;span class="s"&gt;"&lt;/span&gt;&lt;span class="si"&gt;$y&lt;/span&gt;&lt;span class="s"&gt;$"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_f8f85c4e91834e4a8d12e92aa8ee3009-36" name="rest_code_f8f85c4e91834e4a8d12e92aa8ee3009-36" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-23/#rest_code_f8f85c4e91834e4a8d12e92aa8ee3009-36"&gt;&lt;/a&gt;&lt;span class="n"&gt;legend&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="s"&gt;"Ritz solution"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s"&gt;"Exact solution"&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_f8f85c4e91834e4a8d12e92aa8ee3009-37" name="rest_code_f8f85c4e91834e4a8d12e92aa8ee3009-37" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-23/#rest_code_f8f85c4e91834e4a8d12e92aa8ee3009-37"&gt;&lt;/a&gt;&lt;span class="n"&gt;tight_layout&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_f8f85c4e91834e4a8d12e92aa8ee3009-38" name="rest_code_f8f85c4e91834e4a8d12e92aa8ee3009-38" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-23/#rest_code_f8f85c4e91834e4a8d12e92aa8ee3009-38"&gt;&lt;/a&gt;&lt;span class="n"&gt;show&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Both have (almost) the same result, as follows&lt;/p&gt;
&lt;img alt="Ritz method approximation using 2 terms." class="align-center" src="https://nicoguaro.github.io/images/ritz.svg" style="width: 400px;"&gt;
&lt;p&gt;And if we consider 3 terms in the expansion, we get&lt;/p&gt;
&lt;img alt="Ritz method approximation using 3 terms." class="align-center" src="https://nicoguaro.github.io/images/ritz-N-3.svg" style="width: 400px;"&gt;
&lt;/section&gt;
&lt;section id="comparison-python-julia"&gt;
&lt;h3&gt;Comparison Python/Julia&lt;/h3&gt;
&lt;p&gt;Regarding number of lines we have: 38 in Python and 38 in Julia. The comparison
in execution time is done with &lt;code class="docutils literal"&gt;%timeit&lt;/code&gt; magic command in IPython and
&lt;code class="docutils literal"&gt;@benchmark&lt;/code&gt; in Julia.&lt;/p&gt;
&lt;p&gt;For Python:&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code IPython"&gt;&lt;a id="rest_code_7b3bdc74b5a34887baec384e0e872d67-1" name="rest_code_7b3bdc74b5a34887baec384e0e872d67-1" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-23/#rest_code_7b3bdc74b5a34887baec384e0e872d67-1"&gt;&lt;/a&gt;&lt;span class="o"&gt;%%time&lt;/span&gt;it
&lt;a id="rest_code_7b3bdc74b5a34887baec384e0e872d67-2" name="rest_code_7b3bdc74b5a34887baec384e0e872d67-2" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-23/#rest_code_7b3bdc74b5a34887baec384e0e872d67-2"&gt;&lt;/a&gt;&lt;span class="n"&gt;mat&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;rhs&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;ritz&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;source&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_7b3bdc74b5a34887baec384e0e872d67-3" name="rest_code_7b3bdc74b5a34887baec384e0e872d67-3" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-23/#rest_code_7b3bdc74b5a34887baec384e0e872d67-3"&gt;&lt;/a&gt;&lt;span class="n"&gt;c&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;solve&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;mat&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;rhs&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;with result&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code text"&gt;&lt;a id="rest_code_d03e6c9aac47442a877c4f39af73ffb6-1" name="rest_code_d03e6c9aac47442a877c4f39af73ffb6-1" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-23/#rest_code_d03e6c9aac47442a877c4f39af73ffb6-1"&gt;&lt;/a&gt;1000 loops, best of 3: 228 µs per loop
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;For Julia:&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code julia"&gt;&lt;a id="rest_code_a3a58bc48aab4de38a2a649d775880bb-1" name="rest_code_a3a58bc48aab4de38a2a649d775880bb-1" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-23/#rest_code_a3a58bc48aab4de38a2a649d775880bb-1"&gt;&lt;/a&gt;&lt;span class="k"&gt;function&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;bench&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_a3a58bc48aab4de38a2a649d775880bb-2" name="rest_code_a3a58bc48aab4de38a2a649d775880bb-2" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-23/#rest_code_a3a58bc48aab4de38a2a649d775880bb-2"&gt;&lt;/a&gt;&lt;span class="w"&gt;   &lt;/span&gt;&lt;span class="n"&gt;mat&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;rhs&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ritz&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;source&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_a3a58bc48aab4de38a2a649d775880bb-3" name="rest_code_a3a58bc48aab4de38a2a649d775880bb-3" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-23/#rest_code_a3a58bc48aab4de38a2a649d775880bb-3"&gt;&lt;/a&gt;&lt;span class="w"&gt;   &lt;/span&gt;&lt;span class="n"&gt;c&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;mat&lt;/span&gt;&lt;span class="o"&gt;\&lt;/span&gt;&lt;span class="n"&gt;rhs&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_a3a58bc48aab4de38a2a649d775880bb-4" name="rest_code_a3a58bc48aab4de38a2a649d775880bb-4" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-23/#rest_code_a3a58bc48aab4de38a2a649d775880bb-4"&gt;&lt;/a&gt;&lt;span class="k"&gt;end&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_a3a58bc48aab4de38a2a649d775880bb-5" name="rest_code_a3a58bc48aab4de38a2a649d775880bb-5" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-23/#rest_code_a3a58bc48aab4de38a2a649d775880bb-5"&gt;&lt;/a&gt;&lt;span class="nd"&gt;@benchmark&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;bench&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;with result&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code julia"&gt;&lt;a id="rest_code_698c48018ae942f6954c43b9e6745472-1" name="rest_code_698c48018ae942f6954c43b9e6745472-1" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-23/#rest_code_698c48018ae942f6954c43b9e6745472-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;BenchmarkTools&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Trial&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_698c48018ae942f6954c43b9e6745472-2" name="rest_code_698c48018ae942f6954c43b9e6745472-2" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-23/#rest_code_698c48018ae942f6954c43b9e6745472-2"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;memory&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;estimate&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="mf"&gt;6.56&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;KiB&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_698c48018ae942f6954c43b9e6745472-3" name="rest_code_698c48018ae942f6954c43b9e6745472-3" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-23/#rest_code_698c48018ae942f6954c43b9e6745472-3"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;allocs&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;estimate&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="mi"&gt;340&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_698c48018ae942f6954c43b9e6745472-4" name="rest_code_698c48018ae942f6954c43b9e6745472-4" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-23/#rest_code_698c48018ae942f6954c43b9e6745472-4"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="o"&gt;--------------&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_698c48018ae942f6954c43b9e6745472-5" name="rest_code_698c48018ae942f6954c43b9e6745472-5" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-23/#rest_code_698c48018ae942f6954c43b9e6745472-5"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;minimum&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;     &lt;/span&gt;&lt;span class="mf"&gt;13.527&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;μs&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;0.00&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;GC&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_698c48018ae942f6954c43b9e6745472-6" name="rest_code_698c48018ae942f6954c43b9e6745472-6" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-23/#rest_code_698c48018ae942f6954c43b9e6745472-6"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;median&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="mf"&gt;15.927&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;μs&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;0.00&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;GC&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_698c48018ae942f6954c43b9e6745472-7" name="rest_code_698c48018ae942f6954c43b9e6745472-7" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-23/#rest_code_698c48018ae942f6954c43b9e6745472-7"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;mean&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="mf"&gt;17.133&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;μs&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;4.50&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;GC&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_698c48018ae942f6954c43b9e6745472-8" name="rest_code_698c48018ae942f6954c43b9e6745472-8" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-23/#rest_code_698c48018ae942f6954c43b9e6745472-8"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;maximum&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;     &lt;/span&gt;&lt;span class="mf"&gt;2.807&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ms&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;97.36&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;GC&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_698c48018ae942f6954c43b9e6745472-9" name="rest_code_698c48018ae942f6954c43b9e6745472-9" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-23/#rest_code_698c48018ae942f6954c43b9e6745472-9"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="o"&gt;--------------&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_698c48018ae942f6954c43b9e6745472-10" name="rest_code_698c48018ae942f6954c43b9e6745472-10" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-23/#rest_code_698c48018ae942f6954c43b9e6745472-10"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;samples&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;          &lt;/span&gt;&lt;span class="mi"&gt;10000&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_698c48018ae942f6954c43b9e6745472-11" name="rest_code_698c48018ae942f6954c43b9e6745472-11" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-23/#rest_code_698c48018ae942f6954c43b9e6745472-11"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;evals&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;sample&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;     &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;In this case, we can say that the Python code is roughly 14 times slower than
Julia.&lt;/p&gt;
&lt;/section&gt;
&lt;/section&gt;</description><category>julia</category><category>numerical methods</category><category>python</category><category>ritz method</category><category>scientific computing</category><guid>https://nicoguaro.github.io/posts/numerical_challenge/numerical-23/</guid><pubDate>Tue, 24 Oct 2017 01:30:03 GMT</pubDate></item></channel></rss>