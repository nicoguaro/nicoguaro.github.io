<?xml version="1.0" encoding="utf-8"?>
<?xml-stylesheet type="text/xsl" href="../assets/xml/rss.xsl" media="all"?><rss version="2.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Nicolás' blog (Posts about shooting method)</title><link>https://nicoguaro.github.io/</link><description></description><atom:link href="https://nicoguaro.github.io/categories/shooting-method.xml" rel="self" type="application/rss+xml"></atom:link><language>en</language><copyright>Contents © 2022 &lt;a href="mailto:nicoguarin@gmail.com"&gt;Nicolás Guarín-Zapata&lt;/a&gt; 
&lt;a rel="license" href="http://creativecommons.org/licenses/by/4.0/"&gt;
&lt;img alt="Creative Commons License"
style="border-width:0"
src="https://i.creativecommons.org/l/by/4.0/88x31.png"&gt;&lt;/a&gt;</copyright><lastBuildDate>Fri, 21 Oct 2022 17:34:10 GMT</lastBuildDate><generator>Nikola (getnikola.com)</generator><docs>http://blogs.law.harvard.edu/tech/rss</docs><item><title>Numerical methods challenge: Day 20</title><link>https://nicoguaro.github.io/posts/numerical_challenge/numerical-20/</link><dc:creator>Nicolás Guarín-Zapata</dc:creator><description>&lt;p&gt;During October (2017) I will write a program per day for some well-known
numerical methods in both Python and Julia. It is intended to be an exercise
then don't expect the code to be good enough for real use. Also,
I should mention that I have almost no experience with Julia, so it
probably won't be idiomatic Julia but more Python-like Julia.&lt;/p&gt;
&lt;section id="shooting-method"&gt;
&lt;h2&gt;Shooting method&lt;/h2&gt;
&lt;p&gt;Today we have the &lt;a class="reference external" href="https://en.wikipedia.org/wiki/Shooting_method"&gt;shooting method&lt;/a&gt;.
This is a method for solving boundary value problems by turning them into
a sequence of initial value problems.&lt;/p&gt;
&lt;p&gt;Loosely speaking, for a second order equation we have&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
y''(x) = f(x, y(x), y'(x)),\quad y(x_0) = y_0,\quad y(x_1) = y_1\, ,
\end{equation*}
&lt;/div&gt;
&lt;p&gt;and we solve the sequence of problems&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
y''(x) = f(x, y(x), y'(x)),\quad y(x_0) = y_0,\quad y'(x_0) = a
\end{equation*}
&lt;/div&gt;
&lt;p&gt;until the function &lt;span class="math"&gt;\(F(a) = y(x_1; a) - y_1\)&lt;/span&gt; has a root.&lt;/p&gt;
&lt;p&gt;We will test the method with the boundary value problem&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
y''(x) = \frac{3}{2} y^2,\quad w(0) = 4,\quad w(1) = 1\, .
\end{equation*}
&lt;/div&gt;
&lt;p&gt;Following are the codes.&lt;/p&gt;
&lt;section id="python"&gt;
&lt;h3&gt;Python&lt;/h3&gt;
&lt;div class="code"&gt;&lt;pre class="code python"&gt;&lt;a id="rest_code_baadb339c62e442bbd82714e34524f16-1" name="rest_code_baadb339c62e442bbd82714e34524f16-1" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-20/#rest_code_baadb339c62e442bbd82714e34524f16-1"&gt;&lt;/a&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;__future__&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;division&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;print_function&lt;/span&gt;
&lt;a id="rest_code_baadb339c62e442bbd82714e34524f16-2" name="rest_code_baadb339c62e442bbd82714e34524f16-2" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-20/#rest_code_baadb339c62e442bbd82714e34524f16-2"&gt;&lt;/a&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;numpy&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;np&lt;/span&gt;
&lt;a id="rest_code_baadb339c62e442bbd82714e34524f16-3" name="rest_code_baadb339c62e442bbd82714e34524f16-3" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-20/#rest_code_baadb339c62e442bbd82714e34524f16-3"&gt;&lt;/a&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;matplotlib.pyplot&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;plt&lt;/span&gt;
&lt;a id="rest_code_baadb339c62e442bbd82714e34524f16-4" name="rest_code_baadb339c62e442bbd82714e34524f16-4" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-20/#rest_code_baadb339c62e442bbd82714e34524f16-4"&gt;&lt;/a&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;scipy.optimize&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;newton&lt;/span&gt;
&lt;a id="rest_code_baadb339c62e442bbd82714e34524f16-5" name="rest_code_baadb339c62e442bbd82714e34524f16-5" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-20/#rest_code_baadb339c62e442bbd82714e34524f16-5"&gt;&lt;/a&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;scipy.integrate&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;odeint&lt;/span&gt;
&lt;a id="rest_code_baadb339c62e442bbd82714e34524f16-6" name="rest_code_baadb339c62e442bbd82714e34524f16-6" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-20/#rest_code_baadb339c62e442bbd82714e34524f16-6"&gt;&lt;/a&gt;
&lt;a id="rest_code_baadb339c62e442bbd82714e34524f16-7" name="rest_code_baadb339c62e442bbd82714e34524f16-7" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-20/#rest_code_baadb339c62e442bbd82714e34524f16-7"&gt;&lt;/a&gt;
&lt;a id="rest_code_baadb339c62e442bbd82714e34524f16-8" name="rest_code_baadb339c62e442bbd82714e34524f16-8" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-20/#rest_code_baadb339c62e442bbd82714e34524f16-8"&gt;&lt;/a&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;shooting&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;dydx&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;x0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;xf&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;shoot&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;None&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_baadb339c62e442bbd82714e34524f16-9" name="rest_code_baadb339c62e442bbd82714e34524f16-9" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-20/#rest_code_baadb339c62e442bbd82714e34524f16-9"&gt;&lt;/a&gt;    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;shoot&lt;/span&gt; &lt;span class="ow"&gt;is&lt;/span&gt; &lt;span class="kc"&gt;None&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a id="rest_code_baadb339c62e442bbd82714e34524f16-10" name="rest_code_baadb339c62e442bbd82714e34524f16-10" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-20/#rest_code_baadb339c62e442bbd82714e34524f16-10"&gt;&lt;/a&gt;        &lt;span class="n"&gt;shoot&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;random&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;uniform&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;20&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;20&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_baadb339c62e442bbd82714e34524f16-11" name="rest_code_baadb339c62e442bbd82714e34524f16-11" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-20/#rest_code_baadb339c62e442bbd82714e34524f16-11"&gt;&lt;/a&gt;    &lt;span class="n"&gt;F&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;lambda&lt;/span&gt; &lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;x0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;xf&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;odeint&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;dydx&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;x0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;)[&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;xf&lt;/span&gt;
&lt;a id="rest_code_baadb339c62e442bbd82714e34524f16-12" name="rest_code_baadb339c62e442bbd82714e34524f16-12" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-20/#rest_code_baadb339c62e442bbd82714e34524f16-12"&gt;&lt;/a&gt;    &lt;span class="n"&gt;shoot&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;newton&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;F&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;shoot&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;args&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;xf&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_baadb339c62e442bbd82714e34524f16-13" name="rest_code_baadb339c62e442bbd82714e34524f16-13" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-20/#rest_code_baadb339c62e442bbd82714e34524f16-13"&gt;&lt;/a&gt;    &lt;span class="n"&gt;y&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;odeint&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;dydx&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;x0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;shoot&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_baadb339c62e442bbd82714e34524f16-14" name="rest_code_baadb339c62e442bbd82714e34524f16-14" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-20/#rest_code_baadb339c62e442bbd82714e34524f16-14"&gt;&lt;/a&gt;    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;[:,&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;shoot&lt;/span&gt;
&lt;a id="rest_code_baadb339c62e442bbd82714e34524f16-15" name="rest_code_baadb339c62e442bbd82714e34524f16-15" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-20/#rest_code_baadb339c62e442bbd82714e34524f16-15"&gt;&lt;/a&gt;
&lt;a id="rest_code_baadb339c62e442bbd82714e34524f16-16" name="rest_code_baadb339c62e442bbd82714e34524f16-16" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-20/#rest_code_baadb339c62e442bbd82714e34524f16-16"&gt;&lt;/a&gt;
&lt;a id="rest_code_baadb339c62e442bbd82714e34524f16-17" name="rest_code_baadb339c62e442bbd82714e34524f16-17" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-20/#rest_code_baadb339c62e442bbd82714e34524f16-17"&gt;&lt;/a&gt;&lt;span class="n"&gt;func&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;lambda&lt;/span&gt; &lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="mf"&gt;1.5&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_baadb339c62e442bbd82714e34524f16-18" name="rest_code_baadb339c62e442bbd82714e34524f16-18" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-20/#rest_code_baadb339c62e442bbd82714e34524f16-18"&gt;&lt;/a&gt;&lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;linspace&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1000&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_baadb339c62e442bbd82714e34524f16-19" name="rest_code_baadb339c62e442bbd82714e34524f16-19" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-20/#rest_code_baadb339c62e442bbd82714e34524f16-19"&gt;&lt;/a&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;shoot&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;shooting&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;func&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;shoot&lt;/span&gt;&lt;span class="o"&gt;=-&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_baadb339c62e442bbd82714e34524f16-20" name="rest_code_baadb339c62e442bbd82714e34524f16-20" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-20/#rest_code_baadb339c62e442bbd82714e34524f16-20"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;plot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_baadb339c62e442bbd82714e34524f16-21" name="rest_code_baadb339c62e442bbd82714e34524f16-21" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-20/#rest_code_baadb339c62e442bbd82714e34524f16-21"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="sa"&gt;r&lt;/span&gt;&lt;span class="s2"&gt;"$x$"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_baadb339c62e442bbd82714e34524f16-22" name="rest_code_baadb339c62e442bbd82714e34524f16-22" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-20/#rest_code_baadb339c62e442bbd82714e34524f16-22"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ylabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="sa"&gt;r&lt;/span&gt;&lt;span class="s2"&gt;"$y$"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_baadb339c62e442bbd82714e34524f16-23" name="rest_code_baadb339c62e442bbd82714e34524f16-23" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-20/#rest_code_baadb339c62e442bbd82714e34524f16-23"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;show&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/section&gt;
&lt;section id="julia"&gt;
&lt;h3&gt;Julia&lt;/h3&gt;
&lt;div class="code"&gt;&lt;pre class="code julia"&gt;&lt;a id="rest_code_2085852266814d67a0f9e66cf821fd21-1" name="rest_code_2085852266814d67a0f9e66cf821fd21-1" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-20/#rest_code_2085852266814d67a0f9e66cf821fd21-1"&gt;&lt;/a&gt;&lt;span class="k"&gt;using&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;PyPlot&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;DifferentialEquations&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Roots&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_2085852266814d67a0f9e66cf821fd21-2" name="rest_code_2085852266814d67a0f9e66cf821fd21-2" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-20/#rest_code_2085852266814d67a0f9e66cf821fd21-2"&gt;&lt;/a&gt;
&lt;a id="rest_code_2085852266814d67a0f9e66cf821fd21-3" name="rest_code_2085852266814d67a0f9e66cf821fd21-3" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-20/#rest_code_2085852266814d67a0f9e66cf821fd21-3"&gt;&lt;/a&gt;
&lt;a id="rest_code_2085852266814d67a0f9e66cf821fd21-4" name="rest_code_2085852266814d67a0f9e66cf821fd21-4" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-20/#rest_code_2085852266814d67a0f9e66cf821fd21-4"&gt;&lt;/a&gt;&lt;span class="k"&gt;function&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;shooting&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;dydx&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;y0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;yf&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;shoot&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nb"&gt;nothing&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_2085852266814d67a0f9e66cf821fd21-5" name="rest_code_2085852266814d67a0f9e66cf821fd21-5" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-20/#rest_code_2085852266814d67a0f9e66cf821fd21-5"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;shoot&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;==&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nb"&gt;nothing&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_2085852266814d67a0f9e66cf821fd21-6" name="rest_code_2085852266814d67a0f9e66cf821fd21-6" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-20/#rest_code_2085852266814d67a0f9e66cf821fd21-6"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;shoot&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;rand&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;20&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="mf"&gt;0.1&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;20&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_2085852266814d67a0f9e66cf821fd21-7" name="rest_code_2085852266814d67a0f9e66cf821fd21-7" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-20/#rest_code_2085852266814d67a0f9e66cf821fd21-7"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;end&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_2085852266814d67a0f9e66cf821fd21-8" name="rest_code_2085852266814d67a0f9e66cf821fd21-8" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-20/#rest_code_2085852266814d67a0f9e66cf821fd21-8"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;function&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;F&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_2085852266814d67a0f9e66cf821fd21-9" name="rest_code_2085852266814d67a0f9e66cf821fd21-9" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-20/#rest_code_2085852266814d67a0f9e66cf821fd21-9"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;prob&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ODEProblem&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;dydx&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;y0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="k"&gt;end&lt;/span&gt;&lt;span class="p"&gt;]))&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_2085852266814d67a0f9e66cf821fd21-10" name="rest_code_2085852266814d67a0f9e66cf821fd21-10" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-20/#rest_code_2085852266814d67a0f9e66cf821fd21-10"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;solve&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;prob&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_2085852266814d67a0f9e66cf821fd21-11" name="rest_code_2085852266814d67a0f9e66cf821fd21-11" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-20/#rest_code_2085852266814d67a0f9e66cf821fd21-11"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="k"&gt;return&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="k"&gt;end&lt;/span&gt;&lt;span class="p"&gt;])[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;yf&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_2085852266814d67a0f9e66cf821fd21-12" name="rest_code_2085852266814d67a0f9e66cf821fd21-12" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-20/#rest_code_2085852266814d67a0f9e66cf821fd21-12"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;end&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_2085852266814d67a0f9e66cf821fd21-13" name="rest_code_2085852266814d67a0f9e66cf821fd21-13" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-20/#rest_code_2085852266814d67a0f9e66cf821fd21-13"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;shoot&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;fzero&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;F&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;shoot&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_2085852266814d67a0f9e66cf821fd21-14" name="rest_code_2085852266814d67a0f9e66cf821fd21-14" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-20/#rest_code_2085852266814d67a0f9e66cf821fd21-14"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;prob&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ODEProblem&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;dydx&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;y0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;shoot&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="k"&gt;end&lt;/span&gt;&lt;span class="p"&gt;]))&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_2085852266814d67a0f9e66cf821fd21-15" name="rest_code_2085852266814d67a0f9e66cf821fd21-15" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-20/#rest_code_2085852266814d67a0f9e66cf821fd21-15"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;solve&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;prob&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;solveat&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_2085852266814d67a0f9e66cf821fd21-16" name="rest_code_2085852266814d67a0f9e66cf821fd21-16" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-20/#rest_code_2085852266814d67a0f9e66cf821fd21-16"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;return&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;)[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;shoot&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_2085852266814d67a0f9e66cf821fd21-17" name="rest_code_2085852266814d67a0f9e66cf821fd21-17" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-20/#rest_code_2085852266814d67a0f9e66cf821fd21-17"&gt;&lt;/a&gt;&lt;span class="k"&gt;end&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_2085852266814d67a0f9e66cf821fd21-18" name="rest_code_2085852266814d67a0f9e66cf821fd21-18" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-20/#rest_code_2085852266814d67a0f9e66cf821fd21-18"&gt;&lt;/a&gt;
&lt;a id="rest_code_2085852266814d67a0f9e66cf821fd21-19" name="rest_code_2085852266814d67a0f9e66cf821fd21-19" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-20/#rest_code_2085852266814d67a0f9e66cf821fd21-19"&gt;&lt;/a&gt;
&lt;a id="rest_code_2085852266814d67a0f9e66cf821fd21-20" name="rest_code_2085852266814d67a0f9e66cf821fd21-20" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-20/#rest_code_2085852266814d67a0f9e66cf821fd21-20"&gt;&lt;/a&gt;&lt;span class="n"&gt;func&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;1.5&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;^&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_2085852266814d67a0f9e66cf821fd21-21" name="rest_code_2085852266814d67a0f9e66cf821fd21-21" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-20/#rest_code_2085852266814d67a0f9e66cf821fd21-21"&gt;&lt;/a&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;linspace&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1000&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_2085852266814d67a0f9e66cf821fd21-22" name="rest_code_2085852266814d67a0f9e66cf821fd21-22" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-20/#rest_code_2085852266814d67a0f9e66cf821fd21-22"&gt;&lt;/a&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;shoot&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;shooting&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;func&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;4.0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;1.0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;shoot&lt;/span&gt;&lt;span class="o"&gt;=-&lt;/span&gt;&lt;span class="mf"&gt;5.0&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_2085852266814d67a0f9e66cf821fd21-23" name="rest_code_2085852266814d67a0f9e66cf821fd21-23" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-20/#rest_code_2085852266814d67a0f9e66cf821fd21-23"&gt;&lt;/a&gt;&lt;span class="n"&gt;plot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;In both cases the result is the following plot, and the slope is
-7.9999999657800833.&lt;/p&gt;
&lt;img alt="Solution of the differential equation that satisfy the boundary conditions." class="align-center" src="https://nicoguaro.github.io/images/shooting.svg" style="width: 600px;"&gt;
&lt;p&gt;We should mention that the convergence of the method relies on the selection
of initial guesses. For example, if we choose as initial parameter -50
in the previous problem, we obtain a completely differente solution.&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code text"&gt;&lt;a id="rest_code_cedc3d73ccc4492db61775dcf7c3c5c5-1" name="rest_code_cedc3d73ccc4492db61775dcf7c3c5c5-1" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-20/#rest_code_cedc3d73ccc4492db61775dcf7c3c5c5-1"&gt;&lt;/a&gt;y, shoot = shooting(func, x , 4.0, 1.0, shoot=-50.0)
&lt;/pre&gt;&lt;/div&gt;
&lt;img alt="Solution of the differential equation that satisfy the boundary conditions." class="align-center" src="https://nicoguaro.github.io/images/shooting-s-50.svg" style="width: 600px;"&gt;
&lt;p&gt;And the obtained slope is -35.858547970130971.&lt;/p&gt;
&lt;/section&gt;
&lt;section id="comparison-python-julia"&gt;
&lt;h3&gt;Comparison Python/Julia&lt;/h3&gt;
&lt;p&gt;Regarding number of lines we have: 20 in Python and 23 in Julia. The comparison
in execution time is done with &lt;code class="docutils literal"&gt;%timeit&lt;/code&gt; magic command in IPython and
&lt;code class="docutils literal"&gt;@benchmark&lt;/code&gt; in Julia.&lt;/p&gt;
&lt;p&gt;For Python:&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code IPython"&gt;&lt;a id="rest_code_0281de6c703e4c209c708785d31c6454-1" name="rest_code_0281de6c703e4c209c708785d31c6454-1" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-20/#rest_code_0281de6c703e4c209c708785d31c6454-1"&gt;&lt;/a&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="k"&gt;timeit&lt;/span&gt; shooting(func, x, 4, 1, shoot=-5)
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;with result&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code text"&gt;&lt;a id="rest_code_de8608dd25fc44019e7476def34a7a67-1" name="rest_code_de8608dd25fc44019e7476def34a7a67-1" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-20/#rest_code_de8608dd25fc44019e7476def34a7a67-1"&gt;&lt;/a&gt;100 loops, best of 3: 1.9 ms per loop
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;For Julia:&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code julia"&gt;&lt;a id="rest_code_10f0fee6167d48939c10bb1094c987d6-1" name="rest_code_10f0fee6167d48939c10bb1094c987d6-1" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-20/#rest_code_10f0fee6167d48939c10bb1094c987d6-1"&gt;&lt;/a&gt;&lt;span class="nd"&gt;@benchmark&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;shooting&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;func&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;4.0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;1.0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;shoot&lt;/span&gt;&lt;span class="o"&gt;=-&lt;/span&gt;&lt;span class="mf"&gt;5.0&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;with result&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code julia"&gt;&lt;a id="rest_code_a636037293694effa7632b77950acbc5-1" name="rest_code_a636037293694effa7632b77950acbc5-1" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-20/#rest_code_a636037293694effa7632b77950acbc5-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;BenchmarkTools&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Trial&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_a636037293694effa7632b77950acbc5-2" name="rest_code_a636037293694effa7632b77950acbc5-2" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-20/#rest_code_a636037293694effa7632b77950acbc5-2"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;memory&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;estimate&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="mf"&gt;4.18&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;MiB&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_a636037293694effa7632b77950acbc5-3" name="rest_code_a636037293694effa7632b77950acbc5-3" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-20/#rest_code_a636037293694effa7632b77950acbc5-3"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;allocs&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;estimate&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="mi"&gt;78552&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_a636037293694effa7632b77950acbc5-4" name="rest_code_a636037293694effa7632b77950acbc5-4" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-20/#rest_code_a636037293694effa7632b77950acbc5-4"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="o"&gt;--------------&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_a636037293694effa7632b77950acbc5-5" name="rest_code_a636037293694effa7632b77950acbc5-5" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-20/#rest_code_a636037293694effa7632b77950acbc5-5"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;minimum&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;     &lt;/span&gt;&lt;span class="mf"&gt;10.065&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ms&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;0.00&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;GC&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_a636037293694effa7632b77950acbc5-6" name="rest_code_a636037293694effa7632b77950acbc5-6" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-20/#rest_code_a636037293694effa7632b77950acbc5-6"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;median&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="mf"&gt;10.593&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ms&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;0.00&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;GC&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_a636037293694effa7632b77950acbc5-7" name="rest_code_a636037293694effa7632b77950acbc5-7" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-20/#rest_code_a636037293694effa7632b77950acbc5-7"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;mean&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="mf"&gt;11.769&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ms&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;9.28&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;GC&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_a636037293694effa7632b77950acbc5-8" name="rest_code_a636037293694effa7632b77950acbc5-8" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-20/#rest_code_a636037293694effa7632b77950acbc5-8"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;maximum&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;     &lt;/span&gt;&lt;span class="mf"&gt;22.252&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ms&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;48.58&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;GC&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_a636037293694effa7632b77950acbc5-9" name="rest_code_a636037293694effa7632b77950acbc5-9" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-20/#rest_code_a636037293694effa7632b77950acbc5-9"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="o"&gt;--------------&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_a636037293694effa7632b77950acbc5-10" name="rest_code_a636037293694effa7632b77950acbc5-10" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-20/#rest_code_a636037293694effa7632b77950acbc5-10"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;samples&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;          &lt;/span&gt;&lt;span class="mi"&gt;425&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_a636037293694effa7632b77950acbc5-11" name="rest_code_a636037293694effa7632b77950acbc5-11" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-20/#rest_code_a636037293694effa7632b77950acbc5-11"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;evals&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;sample&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;     &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;In this case, we can say that the Python code is roughly 5 times faster than
Julia. Although, the codes are more different than in the other challenges.
For example, I am not using &lt;code class="docutils literal"&gt;newton&lt;/code&gt; in Julia.&lt;/p&gt;
&lt;/section&gt;
&lt;/section&gt;</description><category>julia</category><category>numerical methods</category><category>ode</category><category>python</category><category>scientific computing</category><category>shooting method</category><guid>https://nicoguaro.github.io/posts/numerical_challenge/numerical-20/</guid><pubDate>Sat, 21 Oct 2017 01:10:43 GMT</pubDate></item></channel></rss>