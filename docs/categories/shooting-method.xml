<?xml version="1.0" encoding="utf-8"?>
<?xml-stylesheet type="text/xsl" href="../assets/xml/rss.xsl" media="all"?><rss version="2.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Nicolás' blog (Posts about shooting method)</title><link>https://nicoguaro.github.io/</link><description></description><atom:link href="https://nicoguaro.github.io/categories/shooting-method.xml" rel="self" type="application/rss+xml"></atom:link><language>en</language><copyright>Contents © 2025 &lt;a href="mailto:nicoguarin@gmail.com"&gt;Nicolás Guarín-Zapata&lt;/a&gt; 
&lt;a rel="license" href="http://creativecommons.org/licenses/by/4.0/"&gt;
&lt;img alt="Creative Commons License"
style="border-width:0"
src="https://i.creativecommons.org/l/by/4.0/88x31.png"&gt;&lt;/a&gt;</copyright><lastBuildDate>Fri, 28 Feb 2025 03:50:54 GMT</lastBuildDate><generator>Nikola (getnikola.com)</generator><docs>http://blogs.law.harvard.edu/tech/rss</docs><item><title>Numerical methods challenge: Day 20</title><link>https://nicoguaro.github.io/posts/numerical_challenge/numerical-20/</link><dc:creator>Nicolás Guarín-Zapata</dc:creator><description>&lt;p&gt;During October (2017) I will write a program per day for some well-known
numerical methods in both Python and Julia. It is intended to be an exercise
then don't expect the code to be good enough for real use. Also,
I should mention that I have almost no experience with Julia, so it
probably won't be idiomatic Julia but more Python-like Julia.&lt;/p&gt;
&lt;section id="shooting-method"&gt;
&lt;h2&gt;Shooting method&lt;/h2&gt;
&lt;p&gt;Today we have the &lt;a class="reference external" href="https://en.wikipedia.org/wiki/Shooting_method"&gt;shooting method&lt;/a&gt;.
This is a method for solving boundary value problems by turning them into
a sequence of initial value problems.&lt;/p&gt;
&lt;p&gt;Loosely speaking, for a second order equation we have&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
y''(x) = f(x, y(x), y'(x)),\quad y(x_0) = y_0,\quad y(x_1) = y_1\, ,
\end{equation*}
&lt;/div&gt;
&lt;p&gt;and we solve the sequence of problems&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
y''(x) = f(x, y(x), y'(x)),\quad y(x_0) = y_0,\quad y'(x_0) = a
\end{equation*}
&lt;/div&gt;
&lt;p&gt;until the function &lt;span class="math"&gt;\(F(a) = y(x_1; a) - y_1\)&lt;/span&gt; has a root.&lt;/p&gt;
&lt;p&gt;We will test the method with the boundary value problem&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
y''(x) = \frac{3}{2} y^2,\quad w(0) = 4,\quad w(1) = 1\, .
\end{equation*}
&lt;/div&gt;
&lt;p&gt;Following are the codes.&lt;/p&gt;
&lt;section id="python"&gt;
&lt;h3&gt;Python&lt;/h3&gt;
&lt;div class="code"&gt;&lt;pre class="code python"&gt;&lt;a id="rest_code_5fb50e33005d417bbdc9b528b3bf4c45-1" name="rest_code_5fb50e33005d417bbdc9b528b3bf4c45-1" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-20/#rest_code_5fb50e33005d417bbdc9b528b3bf4c45-1"&gt;&lt;/a&gt;&lt;span class="kn"&gt;from&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nn"&gt;__future__&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;division&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;print_function&lt;/span&gt;
&lt;a id="rest_code_5fb50e33005d417bbdc9b528b3bf4c45-2" name="rest_code_5fb50e33005d417bbdc9b528b3bf4c45-2" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-20/#rest_code_5fb50e33005d417bbdc9b528b3bf4c45-2"&gt;&lt;/a&gt;&lt;span class="kn"&gt;import&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nn"&gt;numpy&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;as&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nn"&gt;np&lt;/span&gt;
&lt;a id="rest_code_5fb50e33005d417bbdc9b528b3bf4c45-3" name="rest_code_5fb50e33005d417bbdc9b528b3bf4c45-3" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-20/#rest_code_5fb50e33005d417bbdc9b528b3bf4c45-3"&gt;&lt;/a&gt;&lt;span class="kn"&gt;import&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nn"&gt;matplotlib.pyplot&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;as&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nn"&gt;plt&lt;/span&gt;
&lt;a id="rest_code_5fb50e33005d417bbdc9b528b3bf4c45-4" name="rest_code_5fb50e33005d417bbdc9b528b3bf4c45-4" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-20/#rest_code_5fb50e33005d417bbdc9b528b3bf4c45-4"&gt;&lt;/a&gt;&lt;span class="kn"&gt;from&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nn"&gt;scipy.optimize&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;newton&lt;/span&gt;
&lt;a id="rest_code_5fb50e33005d417bbdc9b528b3bf4c45-5" name="rest_code_5fb50e33005d417bbdc9b528b3bf4c45-5" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-20/#rest_code_5fb50e33005d417bbdc9b528b3bf4c45-5"&gt;&lt;/a&gt;&lt;span class="kn"&gt;from&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nn"&gt;scipy.integrate&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;odeint&lt;/span&gt;
&lt;a id="rest_code_5fb50e33005d417bbdc9b528b3bf4c45-6" name="rest_code_5fb50e33005d417bbdc9b528b3bf4c45-6" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-20/#rest_code_5fb50e33005d417bbdc9b528b3bf4c45-6"&gt;&lt;/a&gt;
&lt;a id="rest_code_5fb50e33005d417bbdc9b528b3bf4c45-7" name="rest_code_5fb50e33005d417bbdc9b528b3bf4c45-7" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-20/#rest_code_5fb50e33005d417bbdc9b528b3bf4c45-7"&gt;&lt;/a&gt;
&lt;a id="rest_code_5fb50e33005d417bbdc9b528b3bf4c45-8" name="rest_code_5fb50e33005d417bbdc9b528b3bf4c45-8" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-20/#rest_code_5fb50e33005d417bbdc9b528b3bf4c45-8"&gt;&lt;/a&gt;&lt;span class="k"&gt;def&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nf"&gt;shooting&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;dydx&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;x0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;xf&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;shoot&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;None&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_5fb50e33005d417bbdc9b528b3bf4c45-9" name="rest_code_5fb50e33005d417bbdc9b528b3bf4c45-9" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-20/#rest_code_5fb50e33005d417bbdc9b528b3bf4c45-9"&gt;&lt;/a&gt;    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;shoot&lt;/span&gt; &lt;span class="ow"&gt;is&lt;/span&gt; &lt;span class="kc"&gt;None&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a id="rest_code_5fb50e33005d417bbdc9b528b3bf4c45-10" name="rest_code_5fb50e33005d417bbdc9b528b3bf4c45-10" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-20/#rest_code_5fb50e33005d417bbdc9b528b3bf4c45-10"&gt;&lt;/a&gt;        &lt;span class="n"&gt;shoot&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;random&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;uniform&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;20&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;20&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_5fb50e33005d417bbdc9b528b3bf4c45-11" name="rest_code_5fb50e33005d417bbdc9b528b3bf4c45-11" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-20/#rest_code_5fb50e33005d417bbdc9b528b3bf4c45-11"&gt;&lt;/a&gt;    &lt;span class="n"&gt;F&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;lambda&lt;/span&gt; &lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;x0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;xf&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;odeint&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;dydx&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;x0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;)[&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;xf&lt;/span&gt;
&lt;a id="rest_code_5fb50e33005d417bbdc9b528b3bf4c45-12" name="rest_code_5fb50e33005d417bbdc9b528b3bf4c45-12" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-20/#rest_code_5fb50e33005d417bbdc9b528b3bf4c45-12"&gt;&lt;/a&gt;    &lt;span class="n"&gt;shoot&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;newton&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;F&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;shoot&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;args&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;xf&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_5fb50e33005d417bbdc9b528b3bf4c45-13" name="rest_code_5fb50e33005d417bbdc9b528b3bf4c45-13" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-20/#rest_code_5fb50e33005d417bbdc9b528b3bf4c45-13"&gt;&lt;/a&gt;    &lt;span class="n"&gt;y&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;odeint&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;dydx&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;x0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;shoot&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_5fb50e33005d417bbdc9b528b3bf4c45-14" name="rest_code_5fb50e33005d417bbdc9b528b3bf4c45-14" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-20/#rest_code_5fb50e33005d417bbdc9b528b3bf4c45-14"&gt;&lt;/a&gt;    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;[:,&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;shoot&lt;/span&gt;
&lt;a id="rest_code_5fb50e33005d417bbdc9b528b3bf4c45-15" name="rest_code_5fb50e33005d417bbdc9b528b3bf4c45-15" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-20/#rest_code_5fb50e33005d417bbdc9b528b3bf4c45-15"&gt;&lt;/a&gt;
&lt;a id="rest_code_5fb50e33005d417bbdc9b528b3bf4c45-16" name="rest_code_5fb50e33005d417bbdc9b528b3bf4c45-16" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-20/#rest_code_5fb50e33005d417bbdc9b528b3bf4c45-16"&gt;&lt;/a&gt;
&lt;a id="rest_code_5fb50e33005d417bbdc9b528b3bf4c45-17" name="rest_code_5fb50e33005d417bbdc9b528b3bf4c45-17" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-20/#rest_code_5fb50e33005d417bbdc9b528b3bf4c45-17"&gt;&lt;/a&gt;&lt;span class="n"&gt;func&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;lambda&lt;/span&gt; &lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="mf"&gt;1.5&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_5fb50e33005d417bbdc9b528b3bf4c45-18" name="rest_code_5fb50e33005d417bbdc9b528b3bf4c45-18" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-20/#rest_code_5fb50e33005d417bbdc9b528b3bf4c45-18"&gt;&lt;/a&gt;&lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;linspace&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1000&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_5fb50e33005d417bbdc9b528b3bf4c45-19" name="rest_code_5fb50e33005d417bbdc9b528b3bf4c45-19" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-20/#rest_code_5fb50e33005d417bbdc9b528b3bf4c45-19"&gt;&lt;/a&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;shoot&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;shooting&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;func&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;shoot&lt;/span&gt;&lt;span class="o"&gt;=-&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_5fb50e33005d417bbdc9b528b3bf4c45-20" name="rest_code_5fb50e33005d417bbdc9b528b3bf4c45-20" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-20/#rest_code_5fb50e33005d417bbdc9b528b3bf4c45-20"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;plot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_5fb50e33005d417bbdc9b528b3bf4c45-21" name="rest_code_5fb50e33005d417bbdc9b528b3bf4c45-21" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-20/#rest_code_5fb50e33005d417bbdc9b528b3bf4c45-21"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="sa"&gt;r&lt;/span&gt;&lt;span class="s2"&gt;"$x$"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_5fb50e33005d417bbdc9b528b3bf4c45-22" name="rest_code_5fb50e33005d417bbdc9b528b3bf4c45-22" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-20/#rest_code_5fb50e33005d417bbdc9b528b3bf4c45-22"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ylabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="sa"&gt;r&lt;/span&gt;&lt;span class="s2"&gt;"$y$"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_5fb50e33005d417bbdc9b528b3bf4c45-23" name="rest_code_5fb50e33005d417bbdc9b528b3bf4c45-23" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-20/#rest_code_5fb50e33005d417bbdc9b528b3bf4c45-23"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;show&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/section&gt;
&lt;section id="julia"&gt;
&lt;h3&gt;Julia&lt;/h3&gt;
&lt;div class="code"&gt;&lt;pre class="code julia"&gt;&lt;a id="rest_code_19676d80b36e43df8219a0d0ed896d87-1" name="rest_code_19676d80b36e43df8219a0d0ed896d87-1" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-20/#rest_code_19676d80b36e43df8219a0d0ed896d87-1"&gt;&lt;/a&gt;&lt;span class="k"&gt;using&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;PyPlot&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;DifferentialEquations&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Roots&lt;/span&gt;
&lt;a id="rest_code_19676d80b36e43df8219a0d0ed896d87-2" name="rest_code_19676d80b36e43df8219a0d0ed896d87-2" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-20/#rest_code_19676d80b36e43df8219a0d0ed896d87-2"&gt;&lt;/a&gt;
&lt;a id="rest_code_19676d80b36e43df8219a0d0ed896d87-3" name="rest_code_19676d80b36e43df8219a0d0ed896d87-3" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-20/#rest_code_19676d80b36e43df8219a0d0ed896d87-3"&gt;&lt;/a&gt;
&lt;a id="rest_code_19676d80b36e43df8219a0d0ed896d87-4" name="rest_code_19676d80b36e43df8219a0d0ed896d87-4" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-20/#rest_code_19676d80b36e43df8219a0d0ed896d87-4"&gt;&lt;/a&gt;&lt;span class="k"&gt;function&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;shooting&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;dydx&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;y0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;yf&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;shoot&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nb"&gt;nothing&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_19676d80b36e43df8219a0d0ed896d87-5" name="rest_code_19676d80b36e43df8219a0d0ed896d87-5" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-20/#rest_code_19676d80b36e43df8219a0d0ed896d87-5"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;shoot&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;==&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nb"&gt;nothing&lt;/span&gt;
&lt;a id="rest_code_19676d80b36e43df8219a0d0ed896d87-6" name="rest_code_19676d80b36e43df8219a0d0ed896d87-6" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-20/#rest_code_19676d80b36e43df8219a0d0ed896d87-6"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;shoot&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;rand&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;20&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="mf"&gt;0.1&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;20&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_19676d80b36e43df8219a0d0ed896d87-7" name="rest_code_19676d80b36e43df8219a0d0ed896d87-7" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-20/#rest_code_19676d80b36e43df8219a0d0ed896d87-7"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;end&lt;/span&gt;
&lt;a id="rest_code_19676d80b36e43df8219a0d0ed896d87-8" name="rest_code_19676d80b36e43df8219a0d0ed896d87-8" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-20/#rest_code_19676d80b36e43df8219a0d0ed896d87-8"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;function&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;F&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_19676d80b36e43df8219a0d0ed896d87-9" name="rest_code_19676d80b36e43df8219a0d0ed896d87-9" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-20/#rest_code_19676d80b36e43df8219a0d0ed896d87-9"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;prob&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ODEProblem&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;dydx&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;y0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="k"&gt;end&lt;/span&gt;&lt;span class="p"&gt;]))&lt;/span&gt;
&lt;a id="rest_code_19676d80b36e43df8219a0d0ed896d87-10" name="rest_code_19676d80b36e43df8219a0d0ed896d87-10" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-20/#rest_code_19676d80b36e43df8219a0d0ed896d87-10"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;solve&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;prob&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_19676d80b36e43df8219a0d0ed896d87-11" name="rest_code_19676d80b36e43df8219a0d0ed896d87-11" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-20/#rest_code_19676d80b36e43df8219a0d0ed896d87-11"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="k"&gt;return&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="k"&gt;end&lt;/span&gt;&lt;span class="p"&gt;])[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;yf&lt;/span&gt;
&lt;a id="rest_code_19676d80b36e43df8219a0d0ed896d87-12" name="rest_code_19676d80b36e43df8219a0d0ed896d87-12" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-20/#rest_code_19676d80b36e43df8219a0d0ed896d87-12"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;end&lt;/span&gt;
&lt;a id="rest_code_19676d80b36e43df8219a0d0ed896d87-13" name="rest_code_19676d80b36e43df8219a0d0ed896d87-13" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-20/#rest_code_19676d80b36e43df8219a0d0ed896d87-13"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;shoot&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;fzero&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;F&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;shoot&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_19676d80b36e43df8219a0d0ed896d87-14" name="rest_code_19676d80b36e43df8219a0d0ed896d87-14" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-20/#rest_code_19676d80b36e43df8219a0d0ed896d87-14"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;prob&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ODEProblem&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;dydx&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;y0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;shoot&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="k"&gt;end&lt;/span&gt;&lt;span class="p"&gt;]))&lt;/span&gt;
&lt;a id="rest_code_19676d80b36e43df8219a0d0ed896d87-15" name="rest_code_19676d80b36e43df8219a0d0ed896d87-15" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-20/#rest_code_19676d80b36e43df8219a0d0ed896d87-15"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;solve&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;prob&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;solveat&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_19676d80b36e43df8219a0d0ed896d87-16" name="rest_code_19676d80b36e43df8219a0d0ed896d87-16" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-20/#rest_code_19676d80b36e43df8219a0d0ed896d87-16"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;return&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;)[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;shoot&lt;/span&gt;
&lt;a id="rest_code_19676d80b36e43df8219a0d0ed896d87-17" name="rest_code_19676d80b36e43df8219a0d0ed896d87-17" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-20/#rest_code_19676d80b36e43df8219a0d0ed896d87-17"&gt;&lt;/a&gt;&lt;span class="k"&gt;end&lt;/span&gt;
&lt;a id="rest_code_19676d80b36e43df8219a0d0ed896d87-18" name="rest_code_19676d80b36e43df8219a0d0ed896d87-18" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-20/#rest_code_19676d80b36e43df8219a0d0ed896d87-18"&gt;&lt;/a&gt;
&lt;a id="rest_code_19676d80b36e43df8219a0d0ed896d87-19" name="rest_code_19676d80b36e43df8219a0d0ed896d87-19" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-20/#rest_code_19676d80b36e43df8219a0d0ed896d87-19"&gt;&lt;/a&gt;
&lt;a id="rest_code_19676d80b36e43df8219a0d0ed896d87-20" name="rest_code_19676d80b36e43df8219a0d0ed896d87-20" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-20/#rest_code_19676d80b36e43df8219a0d0ed896d87-20"&gt;&lt;/a&gt;&lt;span class="n"&gt;func&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;1.5&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;^&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_19676d80b36e43df8219a0d0ed896d87-21" name="rest_code_19676d80b36e43df8219a0d0ed896d87-21" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-20/#rest_code_19676d80b36e43df8219a0d0ed896d87-21"&gt;&lt;/a&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;linspace&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1000&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_19676d80b36e43df8219a0d0ed896d87-22" name="rest_code_19676d80b36e43df8219a0d0ed896d87-22" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-20/#rest_code_19676d80b36e43df8219a0d0ed896d87-22"&gt;&lt;/a&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;shoot&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;shooting&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;func&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;4.0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;1.0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;shoot&lt;/span&gt;&lt;span class="o"&gt;=-&lt;/span&gt;&lt;span class="mf"&gt;5.0&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_19676d80b36e43df8219a0d0ed896d87-23" name="rest_code_19676d80b36e43df8219a0d0ed896d87-23" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-20/#rest_code_19676d80b36e43df8219a0d0ed896d87-23"&gt;&lt;/a&gt;&lt;span class="n"&gt;plot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;In both cases the result is the following plot, and the slope is
-7.9999999657800833.&lt;/p&gt;
&lt;img alt="Solution of the differential equation that satisfy the boundary conditions." class="align-center" src="https://nicoguaro.github.io/images/shooting.svg" style="width: 600px;"&gt;
&lt;p&gt;We should mention that the convergence of the method relies on the selection
of initial guesses. For example, if we choose as initial parameter -50
in the previous problem, we obtain a completely differente solution.&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code text"&gt;&lt;a id="rest_code_48ba1fa32ecb41fca2d676a2efca02f1-1" name="rest_code_48ba1fa32ecb41fca2d676a2efca02f1-1" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-20/#rest_code_48ba1fa32ecb41fca2d676a2efca02f1-1"&gt;&lt;/a&gt;y, shoot = shooting(func, x , 4.0, 1.0, shoot=-50.0)
&lt;/pre&gt;&lt;/div&gt;
&lt;img alt="Solution of the differential equation that satisfy the boundary conditions." class="align-center" src="https://nicoguaro.github.io/images/shooting-s-50.svg" style="width: 600px;"&gt;
&lt;p&gt;And the obtained slope is -35.858547970130971.&lt;/p&gt;
&lt;/section&gt;
&lt;section id="comparison-python-julia"&gt;
&lt;h3&gt;Comparison Python/Julia&lt;/h3&gt;
&lt;p&gt;Regarding number of lines we have: 20 in Python and 23 in Julia. The comparison
in execution time is done with &lt;code class="docutils literal"&gt;%timeit&lt;/code&gt; magic command in IPython and
&lt;code class="docutils literal"&gt;@benchmark&lt;/code&gt; in Julia.&lt;/p&gt;
&lt;p&gt;For Python:&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code IPython"&gt;&lt;a id="rest_code_e5d1373ec58c4e9a8ada34f8d0836d80-1" name="rest_code_e5d1373ec58c4e9a8ada34f8d0836d80-1" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-20/#rest_code_e5d1373ec58c4e9a8ada34f8d0836d80-1"&gt;&lt;/a&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="k"&gt;timeit&lt;/span&gt; shooting(func, x, 4, 1, shoot=-5)
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;with result&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code text"&gt;&lt;a id="rest_code_b8208cfbd7744eefa1cf86b0d6c4be79-1" name="rest_code_b8208cfbd7744eefa1cf86b0d6c4be79-1" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-20/#rest_code_b8208cfbd7744eefa1cf86b0d6c4be79-1"&gt;&lt;/a&gt;100 loops, best of 3: 1.9 ms per loop
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;For Julia:&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code julia"&gt;&lt;a id="rest_code_a9c2409f4a614d64819f65f7a341c3ec-1" name="rest_code_a9c2409f4a614d64819f65f7a341c3ec-1" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-20/#rest_code_a9c2409f4a614d64819f65f7a341c3ec-1"&gt;&lt;/a&gt;&lt;span class="nd"&gt;@benchmark&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;shooting&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;func&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;4.0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;1.0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;shoot&lt;/span&gt;&lt;span class="o"&gt;=-&lt;/span&gt;&lt;span class="mf"&gt;5.0&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;with result&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code julia"&gt;&lt;a id="rest_code_e3b2a16d0f4c40b8a0c4ef7ae68eb0e8-1" name="rest_code_e3b2a16d0f4c40b8a0c4ef7ae68eb0e8-1" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-20/#rest_code_e3b2a16d0f4c40b8a0c4ef7ae68eb0e8-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;BenchmarkTools&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Trial&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
&lt;a id="rest_code_e3b2a16d0f4c40b8a0c4ef7ae68eb0e8-2" name="rest_code_e3b2a16d0f4c40b8a0c4ef7ae68eb0e8-2" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-20/#rest_code_e3b2a16d0f4c40b8a0c4ef7ae68eb0e8-2"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;memory&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;estimate&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="mf"&gt;4.18&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;MiB&lt;/span&gt;
&lt;a id="rest_code_e3b2a16d0f4c40b8a0c4ef7ae68eb0e8-3" name="rest_code_e3b2a16d0f4c40b8a0c4ef7ae68eb0e8-3" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-20/#rest_code_e3b2a16d0f4c40b8a0c4ef7ae68eb0e8-3"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;allocs&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;estimate&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="mi"&gt;78552&lt;/span&gt;
&lt;a id="rest_code_e3b2a16d0f4c40b8a0c4ef7ae68eb0e8-4" name="rest_code_e3b2a16d0f4c40b8a0c4ef7ae68eb0e8-4" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-20/#rest_code_e3b2a16d0f4c40b8a0c4ef7ae68eb0e8-4"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="o"&gt;--------------&lt;/span&gt;
&lt;a id="rest_code_e3b2a16d0f4c40b8a0c4ef7ae68eb0e8-5" name="rest_code_e3b2a16d0f4c40b8a0c4ef7ae68eb0e8-5" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-20/#rest_code_e3b2a16d0f4c40b8a0c4ef7ae68eb0e8-5"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;minimum&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;     &lt;/span&gt;&lt;span class="mf"&gt;10.065&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ms&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;0.00&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;GC&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_e3b2a16d0f4c40b8a0c4ef7ae68eb0e8-6" name="rest_code_e3b2a16d0f4c40b8a0c4ef7ae68eb0e8-6" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-20/#rest_code_e3b2a16d0f4c40b8a0c4ef7ae68eb0e8-6"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;median&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="mf"&gt;10.593&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ms&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;0.00&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;GC&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_e3b2a16d0f4c40b8a0c4ef7ae68eb0e8-7" name="rest_code_e3b2a16d0f4c40b8a0c4ef7ae68eb0e8-7" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-20/#rest_code_e3b2a16d0f4c40b8a0c4ef7ae68eb0e8-7"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;mean&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="mf"&gt;11.769&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ms&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;9.28&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;GC&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_e3b2a16d0f4c40b8a0c4ef7ae68eb0e8-8" name="rest_code_e3b2a16d0f4c40b8a0c4ef7ae68eb0e8-8" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-20/#rest_code_e3b2a16d0f4c40b8a0c4ef7ae68eb0e8-8"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;maximum&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;     &lt;/span&gt;&lt;span class="mf"&gt;22.252&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ms&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;48.58&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;GC&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_e3b2a16d0f4c40b8a0c4ef7ae68eb0e8-9" name="rest_code_e3b2a16d0f4c40b8a0c4ef7ae68eb0e8-9" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-20/#rest_code_e3b2a16d0f4c40b8a0c4ef7ae68eb0e8-9"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="o"&gt;--------------&lt;/span&gt;
&lt;a id="rest_code_e3b2a16d0f4c40b8a0c4ef7ae68eb0e8-10" name="rest_code_e3b2a16d0f4c40b8a0c4ef7ae68eb0e8-10" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-20/#rest_code_e3b2a16d0f4c40b8a0c4ef7ae68eb0e8-10"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;samples&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;          &lt;/span&gt;&lt;span class="mi"&gt;425&lt;/span&gt;
&lt;a id="rest_code_e3b2a16d0f4c40b8a0c4ef7ae68eb0e8-11" name="rest_code_e3b2a16d0f4c40b8a0c4ef7ae68eb0e8-11" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-20/#rest_code_e3b2a16d0f4c40b8a0c4ef7ae68eb0e8-11"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;evals&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;sample&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;     &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;In this case, we can say that the Python code is roughly 5 times faster than
Julia. Although, the codes are more different than in the other challenges.
For example, I am not using &lt;code class="docutils literal"&gt;newton&lt;/code&gt; in Julia.&lt;/p&gt;
&lt;/section&gt;
&lt;/section&gt;</description><category>julia</category><category>numerical methods</category><category>ode</category><category>python</category><category>scientific computing</category><category>shooting method</category><guid>https://nicoguaro.github.io/posts/numerical_challenge/numerical-20/</guid><pubDate>Sat, 21 Oct 2017 01:10:43 GMT</pubDate></item></channel></rss>