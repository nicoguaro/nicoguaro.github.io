<?xml version="1.0" encoding="utf-8"?>
<?xml-stylesheet type="text/xsl" href="../assets/xml/rss.xsl" media="all"?><rss version="2.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Nicolás' blog (Posts about quadrature)</title><link>https://nicoguaro.github.io/</link><description></description><atom:link href="https://nicoguaro.github.io/categories/quadrature.xml" rel="self" type="application/rss+xml"></atom:link><language>en</language><copyright>Contents © 2022 &lt;a href="mailto:nicoguarin@gmail.com"&gt;Nicolás Guarín-Zapata&lt;/a&gt; 
&lt;a rel="license" href="http://creativecommons.org/licenses/by/4.0/"&gt;
&lt;img alt="Creative Commons License"
style="border-width:0"
src="https://i.creativecommons.org/l/by/4.0/88x31.png"&gt;&lt;/a&gt;</copyright><lastBuildDate>Wed, 17 Aug 2022 03:33:52 GMT</lastBuildDate><generator>Nikola (getnikola.com)</generator><docs>http://blogs.law.harvard.edu/tech/rss</docs><item><title>Numerical methods challenge: Day 16</title><link>https://nicoguaro.github.io/posts/numerical_challenge/numerical-16/</link><dc:creator>Nicolás Guarín-Zapata</dc:creator><description>&lt;p&gt;During October (2017) I will write a program per day for some well-known
numerical methods in both Python and Julia. It is intended to be an exercise
then don't expect the code to be good enough for real use. Also,
I should mention that I have almost no experience with Julia, so it
probably won't be idiomatic Julia but more Python-like Julia.&lt;/p&gt;
&lt;section id="clenshaw-curtis-quadrature"&gt;
&lt;h2&gt;Clenshaw-Curtis quadrature&lt;/h2&gt;
&lt;p&gt;Today we have the &lt;a class="reference external" href="https://en.wikipedia.org/wiki/Clenshaw%E2%80%93Curtis_quadrature"&gt;Clenshaw-Curtis quadrature&lt;/a&gt;.
This method is based in the expansion of the integrand in
&lt;a class="reference external" href="https://en.wikipedia.org/wiki/Chebyshev_polynomials"&gt;Chebyshev polynomials&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;We will test the quadrature with the integral&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
\int_0^3 e^{-x^2} \mathrm{d}x \approx 0.8862073482595214
\end{equation*}
&lt;/div&gt;
&lt;p&gt;Following are the codes.&lt;/p&gt;
&lt;section id="python"&gt;
&lt;h3&gt;Python&lt;/h3&gt;
&lt;div class="code"&gt;&lt;pre class="code python"&gt;&lt;a id="rest_code_d03552efe26c461b8c72b74a8f128f70-1" name="rest_code_d03552efe26c461b8c72b74a8f128f70-1" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-16/#rest_code_d03552efe26c461b8c72b74a8f128f70-1"&gt;&lt;/a&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;__future__&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;division&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;print_function&lt;/span&gt;
&lt;a id="rest_code_d03552efe26c461b8c72b74a8f128f70-2" name="rest_code_d03552efe26c461b8c72b74a8f128f70-2" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-16/#rest_code_d03552efe26c461b8c72b74a8f128f70-2"&gt;&lt;/a&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;numpy&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;linspace&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;cos&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;pi&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;exp&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nb"&gt;sum&lt;/span&gt;
&lt;a id="rest_code_d03552efe26c461b8c72b74a8f128f70-3" name="rest_code_d03552efe26c461b8c72b74a8f128f70-3" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-16/#rest_code_d03552efe26c461b8c72b74a8f128f70-3"&gt;&lt;/a&gt;
&lt;a id="rest_code_d03552efe26c461b8c72b74a8f128f70-4" name="rest_code_d03552efe26c461b8c72b74a8f128f70-4" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-16/#rest_code_d03552efe26c461b8c72b74a8f128f70-4"&gt;&lt;/a&gt;
&lt;a id="rest_code_d03552efe26c461b8c72b74a8f128f70-5" name="rest_code_d03552efe26c461b8c72b74a8f128f70-5" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-16/#rest_code_d03552efe26c461b8c72b74a8f128f70-5"&gt;&lt;/a&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;clenshaw_curtis&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;fun&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="o"&gt;=-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_d03552efe26c461b8c72b74a8f128f70-6" name="rest_code_d03552efe26c461b8c72b74a8f128f70-6" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-16/#rest_code_d03552efe26c461b8c72b74a8f128f70-6"&gt;&lt;/a&gt;    &lt;span class="n"&gt;nodes&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;linspace&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;N&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;pi&lt;/span&gt;
&lt;a id="rest_code_d03552efe26c461b8c72b74a8f128f70-7" name="rest_code_d03552efe26c461b8c72b74a8f128f70-7" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-16/#rest_code_d03552efe26c461b8c72b74a8f128f70-7"&gt;&lt;/a&gt;    &lt;span class="n"&gt;jac&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;0.5&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;b&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_d03552efe26c461b8c72b74a8f128f70-8" name="rest_code_d03552efe26c461b8c72b74a8f128f70-8" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-16/#rest_code_d03552efe26c461b8c72b74a8f128f70-8"&gt;&lt;/a&gt;    &lt;span class="n"&gt;tfun&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;lambda&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;fun&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;jac&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_d03552efe26c461b8c72b74a8f128f70-9" name="rest_code_d03552efe26c461b8c72b74a8f128f70-9" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-16/#rest_code_d03552efe26c461b8c72b74a8f128f70-9"&gt;&lt;/a&gt;    &lt;span class="n"&gt;inte&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;
&lt;a id="rest_code_d03552efe26c461b8c72b74a8f128f70-10" name="rest_code_d03552efe26c461b8c72b74a8f128f70-10" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-16/#rest_code_d03552efe26c461b8c72b74a8f128f70-10"&gt;&lt;/a&gt;    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;k&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;N&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_d03552efe26c461b8c72b74a8f128f70-11" name="rest_code_d03552efe26c461b8c72b74a8f128f70-11" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-16/#rest_code_d03552efe26c461b8c72b74a8f128f70-11"&gt;&lt;/a&gt;        &lt;span class="n"&gt;coef&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;tfun&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;tfun&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="n"&gt;k&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt;\
&lt;a id="rest_code_d03552efe26c461b8c72b74a8f128f70-12" name="rest_code_d03552efe26c461b8c72b74a8f128f70-12" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-16/#rest_code_d03552efe26c461b8c72b74a8f128f70-12"&gt;&lt;/a&gt;            &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="nb"&gt;sum&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;tfun&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;cos&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;nodes&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]))&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;cos&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;k&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;nodes&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;])))&lt;/span&gt;
&lt;a id="rest_code_d03552efe26c461b8c72b74a8f128f70-13" name="rest_code_d03552efe26c461b8c72b74a8f128f70-13" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-16/#rest_code_d03552efe26c461b8c72b74a8f128f70-13"&gt;&lt;/a&gt;        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;k&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a id="rest_code_d03552efe26c461b8c72b74a8f128f70-14" name="rest_code_d03552efe26c461b8c72b74a8f128f70-14" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-16/#rest_code_d03552efe26c461b8c72b74a8f128f70-14"&gt;&lt;/a&gt;            &lt;span class="n"&gt;inte&lt;/span&gt; &lt;span class="o"&gt;+=&lt;/span&gt; &lt;span class="n"&gt;coef&lt;/span&gt;
&lt;a id="rest_code_d03552efe26c461b8c72b74a8f128f70-15" name="rest_code_d03552efe26c461b8c72b74a8f128f70-15" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-16/#rest_code_d03552efe26c461b8c72b74a8f128f70-15"&gt;&lt;/a&gt;        &lt;span class="k"&gt;elif&lt;/span&gt; &lt;span class="n"&gt;k&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a id="rest_code_d03552efe26c461b8c72b74a8f128f70-16" name="rest_code_d03552efe26c461b8c72b74a8f128f70-16" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-16/#rest_code_d03552efe26c461b8c72b74a8f128f70-16"&gt;&lt;/a&gt;            &lt;span class="n"&gt;inte&lt;/span&gt; &lt;span class="o"&gt;+=&lt;/span&gt; &lt;span class="n"&gt;coef&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_d03552efe26c461b8c72b74a8f128f70-17" name="rest_code_d03552efe26c461b8c72b74a8f128f70-17" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-16/#rest_code_d03552efe26c461b8c72b74a8f128f70-17"&gt;&lt;/a&gt;        &lt;span class="k"&gt;else&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a id="rest_code_d03552efe26c461b8c72b74a8f128f70-18" name="rest_code_d03552efe26c461b8c72b74a8f128f70-18" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-16/#rest_code_d03552efe26c461b8c72b74a8f128f70-18"&gt;&lt;/a&gt;            &lt;span class="n"&gt;inte&lt;/span&gt; &lt;span class="o"&gt;+=&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;coef&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;k&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_d03552efe26c461b8c72b74a8f128f70-19" name="rest_code_d03552efe26c461b8c72b74a8f128f70-19" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-16/#rest_code_d03552efe26c461b8c72b74a8f128f70-19"&gt;&lt;/a&gt;    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;inte&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;jac&lt;/span&gt;
&lt;a id="rest_code_d03552efe26c461b8c72b74a8f128f70-20" name="rest_code_d03552efe26c461b8c72b74a8f128f70-20" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-16/#rest_code_d03552efe26c461b8c72b74a8f128f70-20"&gt;&lt;/a&gt;
&lt;a id="rest_code_d03552efe26c461b8c72b74a8f128f70-21" name="rest_code_d03552efe26c461b8c72b74a8f128f70-21" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-16/#rest_code_d03552efe26c461b8c72b74a8f128f70-21"&gt;&lt;/a&gt;&lt;span class="n"&gt;N&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;100&lt;/span&gt;
&lt;a id="rest_code_d03552efe26c461b8c72b74a8f128f70-22" name="rest_code_d03552efe26c461b8c72b74a8f128f70-22" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-16/#rest_code_d03552efe26c461b8c72b74a8f128f70-22"&gt;&lt;/a&gt;&lt;span class="n"&gt;fun&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;lambda&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;exp&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_d03552efe26c461b8c72b74a8f128f70-23" name="rest_code_d03552efe26c461b8c72b74a8f128f70-23" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-16/#rest_code_d03552efe26c461b8c72b74a8f128f70-23"&gt;&lt;/a&gt;&lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;clenshaw_curtis&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;fun&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;with result&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code python"&gt;&lt;a id="rest_code_03de92764bf74df78d063bf3e4daa031-1" name="rest_code_03de92764bf74df78d063bf3e4daa031-1" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-16/#rest_code_03de92764bf74df78d063bf3e4daa031-1"&gt;&lt;/a&gt;&lt;span class="mf"&gt;0.885906202792&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/section&gt;
&lt;section id="julia"&gt;
&lt;h3&gt;Julia&lt;/h3&gt;
&lt;div class="code"&gt;&lt;pre class="code julia"&gt;&lt;a id="rest_code_d8e4f299bfe748d28ee259c94c7e8a25-1" name="rest_code_d8e4f299bfe748d28ee259c94c7e8a25-1" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-16/#rest_code_d8e4f299bfe748d28ee259c94c7e8a25-1"&gt;&lt;/a&gt;&lt;span class="k"&gt;function&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;clenshaw_curtis&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;fun&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;50&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="o"&gt;=-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_d8e4f299bfe748d28ee259c94c7e8a25-2" name="rest_code_d8e4f299bfe748d28ee259c94c7e8a25-2" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-16/#rest_code_d8e4f299bfe748d28ee259c94c7e8a25-2"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;nodes&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;linspace&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="nb"&gt;pi&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_d8e4f299bfe748d28ee259c94c7e8a25-3" name="rest_code_d8e4f299bfe748d28ee259c94c7e8a25-3" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-16/#rest_code_d8e4f299bfe748d28ee259c94c7e8a25-3"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;jac&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;0.5&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_d8e4f299bfe748d28ee259c94c7e8a25-4" name="rest_code_d8e4f299bfe748d28ee259c94c7e8a25-4" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-16/#rest_code_d8e4f299bfe748d28ee259c94c7e8a25-4"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;tfun&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;fun&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;jac&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_d8e4f299bfe748d28ee259c94c7e8a25-5" name="rest_code_d8e4f299bfe748d28ee259c94c7e8a25-5" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-16/#rest_code_d8e4f299bfe748d28ee259c94c7e8a25-5"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;inte&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_d8e4f299bfe748d28ee259c94c7e8a25-6" name="rest_code_d8e4f299bfe748d28ee259c94c7e8a25-6" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-16/#rest_code_d8e4f299bfe748d28ee259c94c7e8a25-6"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;for&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;k&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_d8e4f299bfe748d28ee259c94c7e8a25-7" name="rest_code_d8e4f299bfe748d28ee259c94c7e8a25-7" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-16/#rest_code_d8e4f299bfe748d28ee259c94c7e8a25-7"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;coef&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;tfun&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;tfun&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;^&lt;/span&gt;&lt;span class="n"&gt;k&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_d8e4f299bfe748d28ee259c94c7e8a25-8" name="rest_code_d8e4f299bfe748d28ee259c94c7e8a25-8" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-16/#rest_code_d8e4f299bfe748d28ee259c94c7e8a25-8"&gt;&lt;/a&gt;&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;sum&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;tfun&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;cos&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;nodes&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="k"&gt;end&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]))&lt;/span&gt;&lt;span class="o"&gt;.*&lt;/span&gt;&lt;span class="n"&gt;cos&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;k&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;nodes&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="k"&gt;end&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;])))&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_d8e4f299bfe748d28ee259c94c7e8a25-9" name="rest_code_d8e4f299bfe748d28ee259c94c7e8a25-9" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-16/#rest_code_d8e4f299bfe748d28ee259c94c7e8a25-9"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;k&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;==&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_d8e4f299bfe748d28ee259c94c7e8a25-10" name="rest_code_d8e4f299bfe748d28ee259c94c7e8a25-10" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-16/#rest_code_d8e4f299bfe748d28ee259c94c7e8a25-10"&gt;&lt;/a&gt;&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="n"&gt;inte&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;coef&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_d8e4f299bfe748d28ee259c94c7e8a25-11" name="rest_code_d8e4f299bfe748d28ee259c94c7e8a25-11" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-16/#rest_code_d8e4f299bfe748d28ee259c94c7e8a25-11"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="k"&gt;elseif&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;k&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;==&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_d8e4f299bfe748d28ee259c94c7e8a25-12" name="rest_code_d8e4f299bfe748d28ee259c94c7e8a25-12" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-16/#rest_code_d8e4f299bfe748d28ee259c94c7e8a25-12"&gt;&lt;/a&gt;&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="n"&gt;inte&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;coef&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="o"&gt;^&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_d8e4f299bfe748d28ee259c94c7e8a25-13" name="rest_code_d8e4f299bfe748d28ee259c94c7e8a25-13" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-16/#rest_code_d8e4f299bfe748d28ee259c94c7e8a25-13"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="k"&gt;else&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_d8e4f299bfe748d28ee259c94c7e8a25-14" name="rest_code_d8e4f299bfe748d28ee259c94c7e8a25-14" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-16/#rest_code_d8e4f299bfe748d28ee259c94c7e8a25-14"&gt;&lt;/a&gt;&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="n"&gt;inte&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;coef&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;k&lt;/span&gt;&lt;span class="o"&gt;^&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_d8e4f299bfe748d28ee259c94c7e8a25-15" name="rest_code_d8e4f299bfe748d28ee259c94c7e8a25-15" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-16/#rest_code_d8e4f299bfe748d28ee259c94c7e8a25-15"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="k"&gt;end&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_d8e4f299bfe748d28ee259c94c7e8a25-16" name="rest_code_d8e4f299bfe748d28ee259c94c7e8a25-16" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-16/#rest_code_d8e4f299bfe748d28ee259c94c7e8a25-16"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;end&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_d8e4f299bfe748d28ee259c94c7e8a25-17" name="rest_code_d8e4f299bfe748d28ee259c94c7e8a25-17" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-16/#rest_code_d8e4f299bfe748d28ee259c94c7e8a25-17"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;return&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;inte&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;jac&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_d8e4f299bfe748d28ee259c94c7e8a25-18" name="rest_code_d8e4f299bfe748d28ee259c94c7e8a25-18" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-16/#rest_code_d8e4f299bfe748d28ee259c94c7e8a25-18"&gt;&lt;/a&gt;&lt;span class="k"&gt;end&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_d8e4f299bfe748d28ee259c94c7e8a25-19" name="rest_code_d8e4f299bfe748d28ee259c94c7e8a25-19" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-16/#rest_code_d8e4f299bfe748d28ee259c94c7e8a25-19"&gt;&lt;/a&gt;
&lt;a id="rest_code_d8e4f299bfe748d28ee259c94c7e8a25-20" name="rest_code_d8e4f299bfe748d28ee259c94c7e8a25-20" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-16/#rest_code_d8e4f299bfe748d28ee259c94c7e8a25-20"&gt;&lt;/a&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;100&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_d8e4f299bfe748d28ee259c94c7e8a25-21" name="rest_code_d8e4f299bfe748d28ee259c94c7e8a25-21" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-16/#rest_code_d8e4f299bfe748d28ee259c94c7e8a25-21"&gt;&lt;/a&gt;&lt;span class="n"&gt;fun&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;exp&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;.^&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_d8e4f299bfe748d28ee259c94c7e8a25-22" name="rest_code_d8e4f299bfe748d28ee259c94c7e8a25-22" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-16/#rest_code_d8e4f299bfe748d28ee259c94c7e8a25-22"&gt;&lt;/a&gt;&lt;span class="n"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;clenshaw_curtis&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;fun&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;with result&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code julia"&gt;&lt;a id="rest_code_6dee51bcdfe74c6baf6fba57f88929e1-1" name="rest_code_6dee51bcdfe74c6baf6fba57f88929e1-1" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-16/#rest_code_6dee51bcdfe74c6baf6fba57f88929e1-1"&gt;&lt;/a&gt;&lt;span class="mf"&gt;0.8859062027920102&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/section&gt;
&lt;section id="comparison-python-julia"&gt;
&lt;h3&gt;Comparison Python/Julia&lt;/h3&gt;
&lt;p&gt;Regarding number of lines we have: 24 in Python and 23 in Julia. The comparison
in execution time is done with &lt;code class="docutils literal"&gt;%timeit&lt;/code&gt; magic command in IPython and
&lt;code class="docutils literal"&gt;@benchmark&lt;/code&gt; in Julia.&lt;/p&gt;
&lt;p&gt;For Python:&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code IPython"&gt;&lt;a id="rest_code_e3f5e4f50c62462fb02108e61e1e4843-1" name="rest_code_e3f5e4f50c62462fb02108e61e1e4843-1" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-16/#rest_code_e3f5e4f50c62462fb02108e61e1e4843-1"&gt;&lt;/a&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="k"&gt;timeit&lt;/span&gt; -n 10000 clenshaw_curtis(fun, N=N, a=0, b=3)
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;with result&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code text"&gt;&lt;a id="rest_code_3a2d00c4b17e4308b4f28058672f01d9-1" name="rest_code_3a2d00c4b17e4308b4f28058672f01d9-1" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-16/#rest_code_3a2d00c4b17e4308b4f28058672f01d9-1"&gt;&lt;/a&gt;10000 loops, best of 3: 2.4 ms per loop
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;For Julia:&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code julia"&gt;&lt;a id="rest_code_c3df7a30eef04a8e993b7b9c172f4113-1" name="rest_code_c3df7a30eef04a8e993b7b9c172f4113-1" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-16/#rest_code_c3df7a30eef04a8e993b7b9c172f4113-1"&gt;&lt;/a&gt;&lt;span class="nd"&gt;@benchmark&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;clenshaw_curtis&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;fun&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;with result&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code julia"&gt;&lt;a id="rest_code_122eacae558f40058eee0c127b90f2ce-1" name="rest_code_122eacae558f40058eee0c127b90f2ce-1" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-16/#rest_code_122eacae558f40058eee0c127b90f2ce-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;BenchmarkTools&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Trial&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_122eacae558f40058eee0c127b90f2ce-2" name="rest_code_122eacae558f40058eee0c127b90f2ce-2" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-16/#rest_code_122eacae558f40058eee0c127b90f2ce-2"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;memory&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;estimate&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="mf"&gt;359.56&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;KiB&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_122eacae558f40058eee0c127b90f2ce-3" name="rest_code_122eacae558f40058eee0c127b90f2ce-3" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-16/#rest_code_122eacae558f40058eee0c127b90f2ce-3"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;allocs&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;estimate&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="mi"&gt;565&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_122eacae558f40058eee0c127b90f2ce-4" name="rest_code_122eacae558f40058eee0c127b90f2ce-4" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-16/#rest_code_122eacae558f40058eee0c127b90f2ce-4"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="o"&gt;--------------&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_122eacae558f40058eee0c127b90f2ce-5" name="rest_code_122eacae558f40058eee0c127b90f2ce-5" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-16/#rest_code_122eacae558f40058eee0c127b90f2ce-5"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;minimum&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;     &lt;/span&gt;&lt;span class="mf"&gt;381.676&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;μs&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;0.00&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;GC&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_122eacae558f40058eee0c127b90f2ce-6" name="rest_code_122eacae558f40058eee0c127b90f2ce-6" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-16/#rest_code_122eacae558f40058eee0c127b90f2ce-6"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;median&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="mf"&gt;388.497&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;μs&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;0.00&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;GC&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_122eacae558f40058eee0c127b90f2ce-7" name="rest_code_122eacae558f40058eee0c127b90f2ce-7" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-16/#rest_code_122eacae558f40058eee0c127b90f2ce-7"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;mean&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="mf"&gt;413.471&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;μs&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;1.77&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;GC&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_122eacae558f40058eee0c127b90f2ce-8" name="rest_code_122eacae558f40058eee0c127b90f2ce-8" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-16/#rest_code_122eacae558f40058eee0c127b90f2ce-8"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;maximum&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;     &lt;/span&gt;&lt;span class="mf"&gt;1.298&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ms&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;49.07&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;GC&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_122eacae558f40058eee0c127b90f2ce-9" name="rest_code_122eacae558f40058eee0c127b90f2ce-9" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-16/#rest_code_122eacae558f40058eee0c127b90f2ce-9"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="o"&gt;--------------&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_122eacae558f40058eee0c127b90f2ce-10" name="rest_code_122eacae558f40058eee0c127b90f2ce-10" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-16/#rest_code_122eacae558f40058eee0c127b90f2ce-10"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;samples&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;          &lt;/span&gt;&lt;span class="mi"&gt;10000&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_122eacae558f40058eee0c127b90f2ce-11" name="rest_code_122eacae558f40058eee0c127b90f2ce-11" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-16/#rest_code_122eacae558f40058eee0c127b90f2ce-11"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;evals&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;sample&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;     &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;In this case, we can say that the Python code is roughly 6 times slower than Julia.&lt;/p&gt;
&lt;/section&gt;
&lt;/section&gt;</description><category>julia</category><category>numerical methods</category><category>python</category><category>quadrature</category><category>scientific computing</category><guid>https://nicoguaro.github.io/posts/numerical_challenge/numerical-16/</guid><pubDate>Tue, 17 Oct 2017 21:29:00 GMT</pubDate></item><item><title>Numerical methods challenge: Day 15</title><link>https://nicoguaro.github.io/posts/numerical_challenge/numerical-15/</link><dc:creator>Nicolás Guarín-Zapata</dc:creator><description>&lt;p&gt;During October (2017) I will write a program per day for some well-known
numerical methods in both Python and Julia. It is intended to be an exercise
then don't expect the code to be good enough for real use. Also,
I should mention that I have almost no experience with Julia, so it
probably won't be idiomatic Julia but more Python-like Julia.&lt;/p&gt;
&lt;section id="simpson-s-rule"&gt;
&lt;h2&gt;Simpson's rule&lt;/h2&gt;
&lt;p&gt;Today we have the &lt;a class="reference external" href="https://en.wikipedia.org/wiki/Simpson%27s_rule"&gt;Simpson's rule&lt;/a&gt;.
This is another &lt;a class="reference external" href="https://en.wikipedia.org/wiki/Newton%E2%80%93Cotes_formulas"&gt;Newton-Cotes formulas&lt;/a&gt;, used for numerical integration. Newton-Cotes is related to
Lagrange interpolation with equidistant points.&lt;/p&gt;
&lt;p&gt;Following are the codes.&lt;/p&gt;
&lt;section id="python"&gt;
&lt;h3&gt;Python&lt;/h3&gt;
&lt;div class="code"&gt;&lt;pre class="code python"&gt;&lt;a id="rest_code_8f33b1959fae4326b4891bbce66b8cce-1" name="rest_code_8f33b1959fae4326b4891bbce66b8cce-1" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-15/#rest_code_8f33b1959fae4326b4891bbce66b8cce-1"&gt;&lt;/a&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;__future__&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;division&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;print_function&lt;/span&gt;
&lt;a id="rest_code_8f33b1959fae4326b4891bbce66b8cce-2" name="rest_code_8f33b1959fae4326b4891bbce66b8cce-2" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-15/#rest_code_8f33b1959fae4326b4891bbce66b8cce-2"&gt;&lt;/a&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;numpy&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;np&lt;/span&gt;
&lt;a id="rest_code_8f33b1959fae4326b4891bbce66b8cce-3" name="rest_code_8f33b1959fae4326b4891bbce66b8cce-3" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-15/#rest_code_8f33b1959fae4326b4891bbce66b8cce-3"&gt;&lt;/a&gt;
&lt;a id="rest_code_8f33b1959fae4326b4891bbce66b8cce-4" name="rest_code_8f33b1959fae4326b4891bbce66b8cce-4" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-15/#rest_code_8f33b1959fae4326b4891bbce66b8cce-4"&gt;&lt;/a&gt;
&lt;a id="rest_code_8f33b1959fae4326b4891bbce66b8cce-5" name="rest_code_8f33b1959fae4326b4891bbce66b8cce-5" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-15/#rest_code_8f33b1959fae4326b4891bbce66b8cce-5"&gt;&lt;/a&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;simps&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;None&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;dx&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mf"&gt;1.0&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_8f33b1959fae4326b4891bbce66b8cce-6" name="rest_code_8f33b1959fae4326b4891bbce66b8cce-6" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-15/#rest_code_8f33b1959fae4326b4891bbce66b8cce-6"&gt;&lt;/a&gt;    &lt;span class="n"&gt;n&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_8f33b1959fae4326b4891bbce66b8cce-7" name="rest_code_8f33b1959fae4326b4891bbce66b8cce-7" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-15/#rest_code_8f33b1959fae4326b4891bbce66b8cce-7"&gt;&lt;/a&gt;    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="ow"&gt;is&lt;/span&gt; &lt;span class="kc"&gt;None&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a id="rest_code_8f33b1959fae4326b4891bbce66b8cce-8" name="rest_code_8f33b1959fae4326b4891bbce66b8cce-8" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-15/#rest_code_8f33b1959fae4326b4891bbce66b8cce-8"&gt;&lt;/a&gt;        &lt;span class="n"&gt;inte&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sum&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;dx&lt;/span&gt;
&lt;a id="rest_code_8f33b1959fae4326b4891bbce66b8cce-9" name="rest_code_8f33b1959fae4326b4891bbce66b8cce-9" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-15/#rest_code_8f33b1959fae4326b4891bbce66b8cce-9"&gt;&lt;/a&gt;    &lt;span class="k"&gt;else&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a id="rest_code_8f33b1959fae4326b4891bbce66b8cce-10" name="rest_code_8f33b1959fae4326b4891bbce66b8cce-10" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-15/#rest_code_8f33b1959fae4326b4891bbce66b8cce-10"&gt;&lt;/a&gt;        &lt;span class="n"&gt;dx&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[:&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_8f33b1959fae4326b4891bbce66b8cce-11" name="rest_code_8f33b1959fae4326b4891bbce66b8cce-11" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-15/#rest_code_8f33b1959fae4326b4891bbce66b8cce-11"&gt;&lt;/a&gt;        &lt;span class="n"&gt;inte&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;dot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;dx&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_8f33b1959fae4326b4891bbce66b8cce-12" name="rest_code_8f33b1959fae4326b4891bbce66b8cce-12" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-15/#rest_code_8f33b1959fae4326b4891bbce66b8cce-12"&gt;&lt;/a&gt;    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;inte&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;
&lt;a id="rest_code_8f33b1959fae4326b4891bbce66b8cce-13" name="rest_code_8f33b1959fae4326b4891bbce66b8cce-13" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-15/#rest_code_8f33b1959fae4326b4891bbce66b8cce-13"&gt;&lt;/a&gt;
&lt;a id="rest_code_8f33b1959fae4326b4891bbce66b8cce-14" name="rest_code_8f33b1959fae4326b4891bbce66b8cce-14" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-15/#rest_code_8f33b1959fae4326b4891bbce66b8cce-14"&gt;&lt;/a&gt;
&lt;a id="rest_code_8f33b1959fae4326b4891bbce66b8cce-15" name="rest_code_8f33b1959fae4326b4891bbce66b8cce-15" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-15/#rest_code_8f33b1959fae4326b4891bbce66b8cce-15"&gt;&lt;/a&gt;&lt;span class="n"&gt;n&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;21&lt;/span&gt;
&lt;a id="rest_code_8f33b1959fae4326b4891bbce66b8cce-16" name="rest_code_8f33b1959fae4326b4891bbce66b8cce-16" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-15/#rest_code_8f33b1959fae4326b4891bbce66b8cce-16"&gt;&lt;/a&gt;&lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;linspace&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_8f33b1959fae4326b4891bbce66b8cce-17" name="rest_code_8f33b1959fae4326b4891bbce66b8cce-17" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-15/#rest_code_8f33b1959fae4326b4891bbce66b8cce-17"&gt;&lt;/a&gt;&lt;span class="n"&gt;y&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sin&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_8f33b1959fae4326b4891bbce66b8cce-18" name="rest_code_8f33b1959fae4326b4891bbce66b8cce-18" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-15/#rest_code_8f33b1959fae4326b4891bbce66b8cce-18"&gt;&lt;/a&gt;&lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;simps&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_8f33b1959fae4326b4891bbce66b8cce-19" name="rest_code_8f33b1959fae4326b4891bbce66b8cce-19" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-15/#rest_code_8f33b1959fae4326b4891bbce66b8cce-19"&gt;&lt;/a&gt;&lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;cos&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;with result&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code python"&gt;&lt;a id="rest_code_e5e8601084c644e6b02df71e79f310f0-1" name="rest_code_e5e8601084c644e6b02df71e79f310f0-1" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-15/#rest_code_e5e8601084c644e6b02df71e79f310f0-1"&gt;&lt;/a&gt;&lt;span class="mf"&gt;1.8397296125&lt;/span&gt;
&lt;a id="rest_code_e5e8601084c644e6b02df71e79f310f0-2" name="rest_code_e5e8601084c644e6b02df71e79f310f0-2" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-15/#rest_code_e5e8601084c644e6b02df71e79f310f0-2"&gt;&lt;/a&gt;&lt;span class="mf"&gt;1.83907152908&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/section&gt;
&lt;section id="julia"&gt;
&lt;h3&gt;Julia&lt;/h3&gt;
&lt;div class="code"&gt;&lt;pre class="code julia"&gt;&lt;a id="rest_code_3bedd76c8537445a85559c72ddaa23e4-1" name="rest_code_3bedd76c8537445a85559c72ddaa23e4-1" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-15/#rest_code_3bedd76c8537445a85559c72ddaa23e4-1"&gt;&lt;/a&gt;&lt;span class="k"&gt;function&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;simps&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nb"&gt;nothing&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;dx&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mf"&gt;1.0&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_3bedd76c8537445a85559c72ddaa23e4-2" name="rest_code_3bedd76c8537445a85559c72ddaa23e4-2" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-15/#rest_code_3bedd76c8537445a85559c72ddaa23e4-2"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;length&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_3bedd76c8537445a85559c72ddaa23e4-3" name="rest_code_3bedd76c8537445a85559c72ddaa23e4-3" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-15/#rest_code_3bedd76c8537445a85559c72ddaa23e4-3"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;==&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nb"&gt;nothing&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_3bedd76c8537445a85559c72ddaa23e4-4" name="rest_code_3bedd76c8537445a85559c72ddaa23e4-4" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-15/#rest_code_3bedd76c8537445a85559c72ddaa23e4-4"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;inte&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;sum&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;dx&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_3bedd76c8537445a85559c72ddaa23e4-5" name="rest_code_3bedd76c8537445a85559c72ddaa23e4-5" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-15/#rest_code_3bedd76c8537445a85559c72ddaa23e4-5"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;else&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_3bedd76c8537445a85559c72ddaa23e4-6" name="rest_code_3bedd76c8537445a85559c72ddaa23e4-6" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-15/#rest_code_3bedd76c8537445a85559c72ddaa23e4-6"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;dx&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="k"&gt;end&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="k"&gt;end&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_3bedd76c8537445a85559c72ddaa23e4-7" name="rest_code_3bedd76c8537445a85559c72ddaa23e4-7" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-15/#rest_code_3bedd76c8537445a85559c72ddaa23e4-7"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;inte&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;&lt;span class="o"&gt;'&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;dx&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_3bedd76c8537445a85559c72ddaa23e4-8" name="rest_code_3bedd76c8537445a85559c72ddaa23e4-8" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-15/#rest_code_3bedd76c8537445a85559c72ddaa23e4-8"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;end&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_3bedd76c8537445a85559c72ddaa23e4-9" name="rest_code_3bedd76c8537445a85559c72ddaa23e4-9" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-15/#rest_code_3bedd76c8537445a85559c72ddaa23e4-9"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;return&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;inte&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_3bedd76c8537445a85559c72ddaa23e4-10" name="rest_code_3bedd76c8537445a85559c72ddaa23e4-10" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-15/#rest_code_3bedd76c8537445a85559c72ddaa23e4-10"&gt;&lt;/a&gt;&lt;span class="k"&gt;end&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_3bedd76c8537445a85559c72ddaa23e4-11" name="rest_code_3bedd76c8537445a85559c72ddaa23e4-11" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-15/#rest_code_3bedd76c8537445a85559c72ddaa23e4-11"&gt;&lt;/a&gt;
&lt;a id="rest_code_3bedd76c8537445a85559c72ddaa23e4-12" name="rest_code_3bedd76c8537445a85559c72ddaa23e4-12" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-15/#rest_code_3bedd76c8537445a85559c72ddaa23e4-12"&gt;&lt;/a&gt;
&lt;a id="rest_code_3bedd76c8537445a85559c72ddaa23e4-13" name="rest_code_3bedd76c8537445a85559c72ddaa23e4-13" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-15/#rest_code_3bedd76c8537445a85559c72ddaa23e4-13"&gt;&lt;/a&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;21&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_3bedd76c8537445a85559c72ddaa23e4-14" name="rest_code_3bedd76c8537445a85559c72ddaa23e4-14" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-15/#rest_code_3bedd76c8537445a85559c72ddaa23e4-14"&gt;&lt;/a&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;linspace&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_3bedd76c8537445a85559c72ddaa23e4-15" name="rest_code_3bedd76c8537445a85559c72ddaa23e4-15" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-15/#rest_code_3bedd76c8537445a85559c72ddaa23e4-15"&gt;&lt;/a&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;sin&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_3bedd76c8537445a85559c72ddaa23e4-16" name="rest_code_3bedd76c8537445a85559c72ddaa23e4-16" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-15/#rest_code_3bedd76c8537445a85559c72ddaa23e4-16"&gt;&lt;/a&gt;&lt;span class="n"&gt;println&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;simps&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_3bedd76c8537445a85559c72ddaa23e4-17" name="rest_code_3bedd76c8537445a85559c72ddaa23e4-17" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-15/#rest_code_3bedd76c8537445a85559c72ddaa23e4-17"&gt;&lt;/a&gt;&lt;span class="n"&gt;println&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;cos&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="code"&gt;&lt;pre class="code julia"&gt;&lt;a id="rest_code_9dfae67d425a44c8a90e5628bdeadfdf-1" name="rest_code_9dfae67d425a44c8a90e5628bdeadfdf-1" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-15/#rest_code_9dfae67d425a44c8a90e5628bdeadfdf-1"&gt;&lt;/a&gt;&lt;span class="mf"&gt;1.8397296124951257&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_9dfae67d425a44c8a90e5628bdeadfdf-2" name="rest_code_9dfae67d425a44c8a90e5628bdeadfdf-2" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-15/#rest_code_9dfae67d425a44c8a90e5628bdeadfdf-2"&gt;&lt;/a&gt;&lt;span class="mf"&gt;1.8390715290764525&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/section&gt;
&lt;section id="comparison-python-julia"&gt;
&lt;h3&gt;Comparison Python/Julia&lt;/h3&gt;
&lt;p&gt;Regarding number of lines we have: 19 in Python and 17 in Julia. The comparison
in execution time is done with &lt;code class="docutils literal"&gt;%timeit&lt;/code&gt; magic command in IPython and
&lt;code class="docutils literal"&gt;@benchmark&lt;/code&gt; in Julia.&lt;/p&gt;
&lt;p&gt;For Python:&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code IPython"&gt;&lt;a id="rest_code_5b1f05a71f054905a54be6956d1f342d-1" name="rest_code_5b1f05a71f054905a54be6956d1f342d-1" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-15/#rest_code_5b1f05a71f054905a54be6956d1f342d-1"&gt;&lt;/a&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="k"&gt;timeit&lt;/span&gt; simps(y, x=x)
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;with result&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code text"&gt;&lt;a id="rest_code_a2c241361e2f4206b94d5cd2d7f1f51b-1" name="rest_code_a2c241361e2f4206b94d5cd2d7f1f51b-1" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-15/#rest_code_a2c241361e2f4206b94d5cd2d7f1f51b-1"&gt;&lt;/a&gt;100000 loops, best of 3: 13.8 µs per loop
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;For Julia:&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code julia"&gt;&lt;a id="rest_code_e4914ecc15824811bda321e54640cfbd-1" name="rest_code_e4914ecc15824811bda321e54640cfbd-1" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-15/#rest_code_e4914ecc15824811bda321e54640cfbd-1"&gt;&lt;/a&gt;&lt;span class="nd"&gt;@benchmark&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;simps&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;with result&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code julia"&gt;&lt;a id="rest_code_82d84599cd3d469fb3c0122697e107c6-1" name="rest_code_82d84599cd3d469fb3c0122697e107c6-1" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-15/#rest_code_82d84599cd3d469fb3c0122697e107c6-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;BenchmarkTools&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Trial&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_82d84599cd3d469fb3c0122697e107c6-2" name="rest_code_82d84599cd3d469fb3c0122697e107c6-2" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-15/#rest_code_82d84599cd3d469fb3c0122697e107c6-2"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;memory&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;estimate&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="mf"&gt;1.23&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;KiB&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_82d84599cd3d469fb3c0122697e107c6-3" name="rest_code_82d84599cd3d469fb3c0122697e107c6-3" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-15/#rest_code_82d84599cd3d469fb3c0122697e107c6-3"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;allocs&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;estimate&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="mi"&gt;14&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_82d84599cd3d469fb3c0122697e107c6-4" name="rest_code_82d84599cd3d469fb3c0122697e107c6-4" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-15/#rest_code_82d84599cd3d469fb3c0122697e107c6-4"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="o"&gt;--------------&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_82d84599cd3d469fb3c0122697e107c6-5" name="rest_code_82d84599cd3d469fb3c0122697e107c6-5" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-15/#rest_code_82d84599cd3d469fb3c0122697e107c6-5"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;minimum&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;     &lt;/span&gt;&lt;span class="mf"&gt;1.117&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;μs&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;0.00&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;GC&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_82d84599cd3d469fb3c0122697e107c6-6" name="rest_code_82d84599cd3d469fb3c0122697e107c6-6" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-15/#rest_code_82d84599cd3d469fb3c0122697e107c6-6"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;median&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="mf"&gt;1.200&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;μs&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;0.00&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;GC&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_82d84599cd3d469fb3c0122697e107c6-7" name="rest_code_82d84599cd3d469fb3c0122697e107c6-7" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-15/#rest_code_82d84599cd3d469fb3c0122697e107c6-7"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;mean&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="mf"&gt;1.404&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;μs&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;7.04&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;GC&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_82d84599cd3d469fb3c0122697e107c6-8" name="rest_code_82d84599cd3d469fb3c0122697e107c6-8" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-15/#rest_code_82d84599cd3d469fb3c0122697e107c6-8"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;maximum&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;     &lt;/span&gt;&lt;span class="mf"&gt;222.286&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;μs&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;96.45&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;GC&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_82d84599cd3d469fb3c0122697e107c6-9" name="rest_code_82d84599cd3d469fb3c0122697e107c6-9" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-15/#rest_code_82d84599cd3d469fb3c0122697e107c6-9"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="o"&gt;--------------&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_82d84599cd3d469fb3c0122697e107c6-10" name="rest_code_82d84599cd3d469fb3c0122697e107c6-10" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-15/#rest_code_82d84599cd3d469fb3c0122697e107c6-10"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;samples&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;          &lt;/span&gt;&lt;span class="mi"&gt;10000&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_82d84599cd3d469fb3c0122697e107c6-11" name="rest_code_82d84599cd3d469fb3c0122697e107c6-11" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-15/#rest_code_82d84599cd3d469fb3c0122697e107c6-11"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;evals&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;sample&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;     &lt;/span&gt;&lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;In this case, we can say that the Python code is 10 times slower than Julia.&lt;/p&gt;
&lt;/section&gt;
&lt;/section&gt;</description><category>julia</category><category>numerical methods</category><category>python</category><category>quadrature</category><category>scientific computing</category><guid>https://nicoguaro.github.io/posts/numerical_challenge/numerical-15/</guid><pubDate>Tue, 17 Oct 2017 21:22:06 GMT</pubDate></item><item><title>Numerical methods challenge: Day 14</title><link>https://nicoguaro.github.io/posts/numerical_challenge/numerical-14/</link><dc:creator>Nicolás Guarín-Zapata</dc:creator><description>&lt;p&gt;During October (2017) I will write a program per day for some well-known
numerical methods in both Python and Julia. It is intended to be an exercise
then don't expect the code to be good enough for real use. Also,
I should mention that I have almost no experience with Julia, so it
probably won't be idiomatic Julia but more Python-like Julia.&lt;/p&gt;
&lt;section id="trapezoidal-rule"&gt;
&lt;h2&gt;Trapezoidal rule&lt;/h2&gt;
&lt;p&gt;Today we have the &lt;a class="reference external" href="https://en.wikipedia.org/wiki/Trapezoidal_rule"&gt;trapezoidal rule&lt;/a&gt;.
This is the simplest of &lt;a class="reference external" href="https://en.wikipedia.org/wiki/Newton%E2%80%93Cotes_formulas"&gt;Newton-Cotes formulas&lt;/a&gt; for numerical integration. Newton-Cotes is related to
Lagrange interpolation with equidistant points.&lt;/p&gt;
&lt;p&gt;Following are the codes.&lt;/p&gt;
&lt;section id="python"&gt;
&lt;h3&gt;Python&lt;/h3&gt;
&lt;div class="code"&gt;&lt;pre class="code python"&gt;&lt;a id="rest_code_73c86c74858648fd993966191b7415e5-1" name="rest_code_73c86c74858648fd993966191b7415e5-1" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-14/#rest_code_73c86c74858648fd993966191b7415e5-1"&gt;&lt;/a&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;__future__&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;division&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;print_function&lt;/span&gt;
&lt;a id="rest_code_73c86c74858648fd993966191b7415e5-2" name="rest_code_73c86c74858648fd993966191b7415e5-2" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-14/#rest_code_73c86c74858648fd993966191b7415e5-2"&gt;&lt;/a&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;numpy&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;np&lt;/span&gt;
&lt;a id="rest_code_73c86c74858648fd993966191b7415e5-3" name="rest_code_73c86c74858648fd993966191b7415e5-3" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-14/#rest_code_73c86c74858648fd993966191b7415e5-3"&gt;&lt;/a&gt;
&lt;a id="rest_code_73c86c74858648fd993966191b7415e5-4" name="rest_code_73c86c74858648fd993966191b7415e5-4" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-14/#rest_code_73c86c74858648fd993966191b7415e5-4"&gt;&lt;/a&gt;
&lt;a id="rest_code_73c86c74858648fd993966191b7415e5-5" name="rest_code_73c86c74858648fd993966191b7415e5-5" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-14/#rest_code_73c86c74858648fd993966191b7415e5-5"&gt;&lt;/a&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;trapz&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;None&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;dx&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mf"&gt;1.0&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_73c86c74858648fd993966191b7415e5-6" name="rest_code_73c86c74858648fd993966191b7415e5-6" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-14/#rest_code_73c86c74858648fd993966191b7415e5-6"&gt;&lt;/a&gt;    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="ow"&gt;is&lt;/span&gt; &lt;span class="kc"&gt;None&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a id="rest_code_73c86c74858648fd993966191b7415e5-7" name="rest_code_73c86c74858648fd993966191b7415e5-7" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-14/#rest_code_73c86c74858648fd993966191b7415e5-7"&gt;&lt;/a&gt;        &lt;span class="n"&gt;inte&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;0.5&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;dx&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sum&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_73c86c74858648fd993966191b7415e5-8" name="rest_code_73c86c74858648fd993966191b7415e5-8" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-14/#rest_code_73c86c74858648fd993966191b7415e5-8"&gt;&lt;/a&gt;    &lt;span class="k"&gt;else&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a id="rest_code_73c86c74858648fd993966191b7415e5-9" name="rest_code_73c86c74858648fd993966191b7415e5-9" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-14/#rest_code_73c86c74858648fd993966191b7415e5-9"&gt;&lt;/a&gt;        &lt;span class="n"&gt;dx&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;:]&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[:&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_73c86c74858648fd993966191b7415e5-10" name="rest_code_73c86c74858648fd993966191b7415e5-10" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-14/#rest_code_73c86c74858648fd993966191b7415e5-10"&gt;&lt;/a&gt;        &lt;span class="n"&gt;inte&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;0.5&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;dot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;[:&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;:],&lt;/span&gt; &lt;span class="n"&gt;dx&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_73c86c74858648fd993966191b7415e5-11" name="rest_code_73c86c74858648fd993966191b7415e5-11" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-14/#rest_code_73c86c74858648fd993966191b7415e5-11"&gt;&lt;/a&gt;    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;inte&lt;/span&gt;
&lt;a id="rest_code_73c86c74858648fd993966191b7415e5-12" name="rest_code_73c86c74858648fd993966191b7415e5-12" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-14/#rest_code_73c86c74858648fd993966191b7415e5-12"&gt;&lt;/a&gt;
&lt;a id="rest_code_73c86c74858648fd993966191b7415e5-13" name="rest_code_73c86c74858648fd993966191b7415e5-13" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-14/#rest_code_73c86c74858648fd993966191b7415e5-13"&gt;&lt;/a&gt;
&lt;a id="rest_code_73c86c74858648fd993966191b7415e5-14" name="rest_code_73c86c74858648fd993966191b7415e5-14" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-14/#rest_code_73c86c74858648fd993966191b7415e5-14"&gt;&lt;/a&gt;&lt;span class="n"&gt;dx&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;0.001&lt;/span&gt;
&lt;a id="rest_code_73c86c74858648fd993966191b7415e5-15" name="rest_code_73c86c74858648fd993966191b7415e5-15" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-14/#rest_code_73c86c74858648fd993966191b7415e5-15"&gt;&lt;/a&gt;&lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;arange&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;dx&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_73c86c74858648fd993966191b7415e5-16" name="rest_code_73c86c74858648fd993966191b7415e5-16" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-14/#rest_code_73c86c74858648fd993966191b7415e5-16"&gt;&lt;/a&gt;&lt;span class="n"&gt;y&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sin&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_73c86c74858648fd993966191b7415e5-17" name="rest_code_73c86c74858648fd993966191b7415e5-17" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-14/#rest_code_73c86c74858648fd993966191b7415e5-17"&gt;&lt;/a&gt;&lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;trapz&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;dx&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;dx&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_73c86c74858648fd993966191b7415e5-18" name="rest_code_73c86c74858648fd993966191b7415e5-18" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-14/#rest_code_73c86c74858648fd993966191b7415e5-18"&gt;&lt;/a&gt;&lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;cos&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;with result&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code python"&gt;&lt;a id="rest_code_04239ea051de41efb52b61ee7b42bcfd-1" name="rest_code_04239ea051de41efb52b61ee7b42bcfd-1" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-14/#rest_code_04239ea051de41efb52b61ee7b42bcfd-1"&gt;&lt;/a&gt;&lt;span class="mf"&gt;1.83961497726&lt;/span&gt;
&lt;a id="rest_code_04239ea051de41efb52b61ee7b42bcfd-2" name="rest_code_04239ea051de41efb52b61ee7b42bcfd-2" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-14/#rest_code_04239ea051de41efb52b61ee7b42bcfd-2"&gt;&lt;/a&gt;&lt;span class="mf"&gt;1.83907152908&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/section&gt;
&lt;section id="julia"&gt;
&lt;h3&gt;Julia&lt;/h3&gt;
&lt;div class="code"&gt;&lt;pre class="code julia"&gt;&lt;a id="rest_code_270cfd360f5349c69dcba3823f75d0e0-1" name="rest_code_270cfd360f5349c69dcba3823f75d0e0-1" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-14/#rest_code_270cfd360f5349c69dcba3823f75d0e0-1"&gt;&lt;/a&gt;&lt;span class="k"&gt;function&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;trapz&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nb"&gt;nothing&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;dx&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mf"&gt;1.0&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_270cfd360f5349c69dcba3823f75d0e0-2" name="rest_code_270cfd360f5349c69dcba3823f75d0e0-2" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-14/#rest_code_270cfd360f5349c69dcba3823f75d0e0-2"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;==&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nb"&gt;nothing&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_270cfd360f5349c69dcba3823f75d0e0-3" name="rest_code_270cfd360f5349c69dcba3823f75d0e0-3" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-14/#rest_code_270cfd360f5349c69dcba3823f75d0e0-3"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;inte&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;0.5&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;dx&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;sum&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="k"&gt;end&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="k"&gt;end&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_270cfd360f5349c69dcba3823f75d0e0-4" name="rest_code_270cfd360f5349c69dcba3823f75d0e0-4" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-14/#rest_code_270cfd360f5349c69dcba3823f75d0e0-4"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;else&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_270cfd360f5349c69dcba3823f75d0e0-5" name="rest_code_270cfd360f5349c69dcba3823f75d0e0-5" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-14/#rest_code_270cfd360f5349c69dcba3823f75d0e0-5"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;dx&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="k"&gt;end&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="k"&gt;end&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_270cfd360f5349c69dcba3823f75d0e0-6" name="rest_code_270cfd360f5349c69dcba3823f75d0e0-6" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-14/#rest_code_270cfd360f5349c69dcba3823f75d0e0-6"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;inte&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;0.5&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="k"&gt;end&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="k"&gt;end&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;&lt;span class="o"&gt;'&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;dx&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_270cfd360f5349c69dcba3823f75d0e0-7" name="rest_code_270cfd360f5349c69dcba3823f75d0e0-7" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-14/#rest_code_270cfd360f5349c69dcba3823f75d0e0-7"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;end&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_270cfd360f5349c69dcba3823f75d0e0-8" name="rest_code_270cfd360f5349c69dcba3823f75d0e0-8" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-14/#rest_code_270cfd360f5349c69dcba3823f75d0e0-8"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;return&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;inte&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_270cfd360f5349c69dcba3823f75d0e0-9" name="rest_code_270cfd360f5349c69dcba3823f75d0e0-9" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-14/#rest_code_270cfd360f5349c69dcba3823f75d0e0-9"&gt;&lt;/a&gt;&lt;span class="k"&gt;end&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_270cfd360f5349c69dcba3823f75d0e0-10" name="rest_code_270cfd360f5349c69dcba3823f75d0e0-10" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-14/#rest_code_270cfd360f5349c69dcba3823f75d0e0-10"&gt;&lt;/a&gt;
&lt;a id="rest_code_270cfd360f5349c69dcba3823f75d0e0-11" name="rest_code_270cfd360f5349c69dcba3823f75d0e0-11" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-14/#rest_code_270cfd360f5349c69dcba3823f75d0e0-11"&gt;&lt;/a&gt;
&lt;a id="rest_code_270cfd360f5349c69dcba3823f75d0e0-12" name="rest_code_270cfd360f5349c69dcba3823f75d0e0-12" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-14/#rest_code_270cfd360f5349c69dcba3823f75d0e0-12"&gt;&lt;/a&gt;&lt;span class="n"&gt;dx&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;0.001&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_270cfd360f5349c69dcba3823f75d0e0-13" name="rest_code_270cfd360f5349c69dcba3823f75d0e0-13" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-14/#rest_code_270cfd360f5349c69dcba3823f75d0e0-13"&gt;&lt;/a&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="n"&gt;dx&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_270cfd360f5349c69dcba3823f75d0e0-14" name="rest_code_270cfd360f5349c69dcba3823f75d0e0-14" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-14/#rest_code_270cfd360f5349c69dcba3823f75d0e0-14"&gt;&lt;/a&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;sin&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_270cfd360f5349c69dcba3823f75d0e0-15" name="rest_code_270cfd360f5349c69dcba3823f75d0e0-15" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-14/#rest_code_270cfd360f5349c69dcba3823f75d0e0-15"&gt;&lt;/a&gt;&lt;span class="n"&gt;println&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;trapz&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;dx&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;dx&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_270cfd360f5349c69dcba3823f75d0e0-16" name="rest_code_270cfd360f5349c69dcba3823f75d0e0-16" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-14/#rest_code_270cfd360f5349c69dcba3823f75d0e0-16"&gt;&lt;/a&gt;&lt;span class="n"&gt;println&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;cos&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;with results&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code julia"&gt;&lt;a id="rest_code_a483e1bd0abf49c1a0b5a8cd7bf3546f-1" name="rest_code_a483e1bd0abf49c1a0b5a8cd7bf3546f-1" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-14/#rest_code_a483e1bd0abf49c1a0b5a8cd7bf3546f-1"&gt;&lt;/a&gt;&lt;span class="mf"&gt;1.8390713758204895&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_a483e1bd0abf49c1a0b5a8cd7bf3546f-2" name="rest_code_a483e1bd0abf49c1a0b5a8cd7bf3546f-2" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-14/#rest_code_a483e1bd0abf49c1a0b5a8cd7bf3546f-2"&gt;&lt;/a&gt;&lt;span class="mf"&gt;1.8390715290764525&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/section&gt;
&lt;section id="comparison-python-julia"&gt;
&lt;h3&gt;Comparison Python/Julia&lt;/h3&gt;
&lt;p&gt;Regarding number of lines we have: 18 in Python and 16 in Julia. The comparison
in execution time is done with &lt;code class="docutils literal"&gt;%timeit&lt;/code&gt; magic command in IPython and
&lt;code class="docutils literal"&gt;@benchmark&lt;/code&gt; in Julia.&lt;/p&gt;
&lt;p&gt;For Python:&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code IPython"&gt;&lt;a id="rest_code_eaa0bc7ae8b34b29861ce023438dbbb3-1" name="rest_code_eaa0bc7ae8b34b29861ce023438dbbb3-1" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-14/#rest_code_eaa0bc7ae8b34b29861ce023438dbbb3-1"&gt;&lt;/a&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="k"&gt;timeit&lt;/span&gt; trapz(y, dx=dx)
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;with result&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code text"&gt;&lt;a id="rest_code_990b641cd7b541568474da5c5c6b870d-1" name="rest_code_990b641cd7b541568474da5c5c6b870d-1" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-14/#rest_code_990b641cd7b541568474da5c5c6b870d-1"&gt;&lt;/a&gt;100000 loops, best of 3: 16.9 µs per loop
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;For Julia:&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code julia"&gt;&lt;a id="rest_code_b043a0a984b74c27834ecf1a65c3b2c7-1" name="rest_code_b043a0a984b74c27834ecf1a65c3b2c7-1" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-14/#rest_code_b043a0a984b74c27834ecf1a65c3b2c7-1"&gt;&lt;/a&gt;&lt;span class="nd"&gt;@benchmark&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;trapz&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;dx&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;dx&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;with result&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code julia"&gt;&lt;a id="rest_code_1b50cae3c09545098bcb0796b5aa5ecf-1" name="rest_code_1b50cae3c09545098bcb0796b5aa5ecf-1" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-14/#rest_code_1b50cae3c09545098bcb0796b5aa5ecf-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;BenchmarkTools&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Trial&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_1b50cae3c09545098bcb0796b5aa5ecf-2" name="rest_code_1b50cae3c09545098bcb0796b5aa5ecf-2" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-14/#rest_code_1b50cae3c09545098bcb0796b5aa5ecf-2"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;memory&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;estimate&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="mf"&gt;78.31&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;KiB&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_1b50cae3c09545098bcb0796b5aa5ecf-3" name="rest_code_1b50cae3c09545098bcb0796b5aa5ecf-3" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-14/#rest_code_1b50cae3c09545098bcb0796b5aa5ecf-3"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;allocs&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;estimate&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_1b50cae3c09545098bcb0796b5aa5ecf-4" name="rest_code_1b50cae3c09545098bcb0796b5aa5ecf-4" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-14/#rest_code_1b50cae3c09545098bcb0796b5aa5ecf-4"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="o"&gt;--------------&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_1b50cae3c09545098bcb0796b5aa5ecf-5" name="rest_code_1b50cae3c09545098bcb0796b5aa5ecf-5" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-14/#rest_code_1b50cae3c09545098bcb0796b5aa5ecf-5"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;minimum&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;     &lt;/span&gt;&lt;span class="mf"&gt;13.080&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;μs&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;0.00&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;GC&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_1b50cae3c09545098bcb0796b5aa5ecf-6" name="rest_code_1b50cae3c09545098bcb0796b5aa5ecf-6" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-14/#rest_code_1b50cae3c09545098bcb0796b5aa5ecf-6"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;median&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="mf"&gt;16.333&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;μs&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;0.00&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;GC&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_1b50cae3c09545098bcb0796b5aa5ecf-7" name="rest_code_1b50cae3c09545098bcb0796b5aa5ecf-7" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-14/#rest_code_1b50cae3c09545098bcb0796b5aa5ecf-7"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;mean&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="mf"&gt;20.099&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;μs&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;12.66&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;GC&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_1b50cae3c09545098bcb0796b5aa5ecf-8" name="rest_code_1b50cae3c09545098bcb0796b5aa5ecf-8" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-14/#rest_code_1b50cae3c09545098bcb0796b5aa5ecf-8"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;maximum&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;     &lt;/span&gt;&lt;span class="mf"&gt;963.732&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;μs&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;90.60&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;GC&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_1b50cae3c09545098bcb0796b5aa5ecf-9" name="rest_code_1b50cae3c09545098bcb0796b5aa5ecf-9" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-14/#rest_code_1b50cae3c09545098bcb0796b5aa5ecf-9"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="o"&gt;--------------&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_1b50cae3c09545098bcb0796b5aa5ecf-10" name="rest_code_1b50cae3c09545098bcb0796b5aa5ecf-10" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-14/#rest_code_1b50cae3c09545098bcb0796b5aa5ecf-10"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;samples&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;          &lt;/span&gt;&lt;span class="mi"&gt;10000&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_1b50cae3c09545098bcb0796b5aa5ecf-11" name="rest_code_1b50cae3c09545098bcb0796b5aa5ecf-11" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-14/#rest_code_1b50cae3c09545098bcb0796b5aa5ecf-11"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;evals&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;sample&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;     &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;In this case, we can say that the Python code is roughly as fast as Julia.&lt;/p&gt;
&lt;/section&gt;
&lt;/section&gt;</description><category>julia</category><category>numerical methods</category><category>python</category><category>quadrature</category><category>scientific computing</category><guid>https://nicoguaro.github.io/posts/numerical_challenge/numerical-14/</guid><pubDate>Sat, 14 Oct 2017 19:00:42 GMT</pubDate></item></channel></rss>