<?xml version="1.0" encoding="utf-8"?>
<?xml-stylesheet type="text/xsl" href="../assets/xml/rss.xsl" media="all"?><rss version="2.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Nicolás' blog (Posts about finite element method)</title><link>https://nicoguaro.github.io/</link><description></description><atom:link href="https://nicoguaro.github.io/categories/finite-element-method.xml" rel="self" type="application/rss+xml"></atom:link><language>en</language><copyright>Contents © 2025 &lt;a href="mailto:nicoguarin@gmail.com"&gt;Nicolás Guarín-Zapata&lt;/a&gt; 
&lt;a rel="license" href="http://creativecommons.org/licenses/by/4.0/"&gt;
&lt;img alt="Creative Commons License"
style="border-width:0"
src="https://i.creativecommons.org/l/by/4.0/88x31.png"&gt;&lt;/a&gt;</copyright><lastBuildDate>Tue, 15 Apr 2025 20:33:26 GMT</lastBuildDate><generator>Nikola (getnikola.com)</generator><docs>http://blogs.law.harvard.edu/tech/rss</docs><item><title>Numerical methods challenge: Day 31</title><link>https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/</link><dc:creator>Nicolás Guarín-Zapata</dc:creator><description>&lt;p&gt;During October (2017) I wrote a program per day for some well-known
numerical methods in both Python and Julia. It was intended to be an exercise,
then don't expect the code to be good enough for real use. Also,
I should mention that I had almost no experience with Julia, so it
probably is not idiomatic Julia but more Python-like Julia.&lt;/p&gt;
&lt;section id="putting-some-things-together"&gt;
&lt;h2&gt;Putting some things together&lt;/h2&gt;
&lt;p&gt;Today, I am putting some things together, namely, I am going to solve the
system of equations that results in the finite element using the conjugate
gradient.&lt;/p&gt;
&lt;p&gt;Following are the codes&lt;/p&gt;
&lt;section id="python"&gt;
&lt;h3&gt;Python&lt;/h3&gt;
&lt;div class="code"&gt;&lt;pre class="code python"&gt;&lt;a id="rest_code_88f628b1e3594a2580a430ba04a2d91c-1" name="rest_code_88f628b1e3594a2580a430ba04a2d91c-1" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_88f628b1e3594a2580a430ba04a2d91c-1"&gt;&lt;/a&gt;&lt;span class="kn"&gt;from&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nn"&gt;__future__&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;division&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;print_function&lt;/span&gt;
&lt;a id="rest_code_88f628b1e3594a2580a430ba04a2d91c-2" name="rest_code_88f628b1e3594a2580a430ba04a2d91c-2" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_88f628b1e3594a2580a430ba04a2d91c-2"&gt;&lt;/a&gt;&lt;span class="kn"&gt;import&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nn"&gt;numpy&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;as&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nn"&gt;np&lt;/span&gt;
&lt;a id="rest_code_88f628b1e3594a2580a430ba04a2d91c-3" name="rest_code_88f628b1e3594a2580a430ba04a2d91c-3" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_88f628b1e3594a2580a430ba04a2d91c-3"&gt;&lt;/a&gt;&lt;span class="kn"&gt;import&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nn"&gt;matplotlib.pyplot&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;as&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nn"&gt;plt&lt;/span&gt;
&lt;a id="rest_code_88f628b1e3594a2580a430ba04a2d91c-4" name="rest_code_88f628b1e3594a2580a430ba04a2d91c-4" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_88f628b1e3594a2580a430ba04a2d91c-4"&gt;&lt;/a&gt;
&lt;a id="rest_code_88f628b1e3594a2580a430ba04a2d91c-5" name="rest_code_88f628b1e3594a2580a430ba04a2d91c-5" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_88f628b1e3594a2580a430ba04a2d91c-5"&gt;&lt;/a&gt;
&lt;a id="rest_code_88f628b1e3594a2580a430ba04a2d91c-6" name="rest_code_88f628b1e3594a2580a430ba04a2d91c-6" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_88f628b1e3594a2580a430ba04a2d91c-6"&gt;&lt;/a&gt;&lt;span class="k"&gt;def&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nf"&gt;FEM1D&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;source&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_88f628b1e3594a2580a430ba04a2d91c-7" name="rest_code_88f628b1e3594a2580a430ba04a2d91c-7" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_88f628b1e3594a2580a430ba04a2d91c-7"&gt;&lt;/a&gt;    &lt;span class="n"&gt;N&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_88f628b1e3594a2580a430ba04a2d91c-8" name="rest_code_88f628b1e3594a2580a430ba04a2d91c-8" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_88f628b1e3594a2580a430ba04a2d91c-8"&gt;&lt;/a&gt;    &lt;span class="n"&gt;stiff_loc&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;([[&lt;/span&gt;&lt;span class="mf"&gt;2.0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;2.0&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;2.0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;2.0&lt;/span&gt;&lt;span class="p"&gt;]])&lt;/span&gt;
&lt;a id="rest_code_88f628b1e3594a2580a430ba04a2d91c-9" name="rest_code_88f628b1e3594a2580a430ba04a2d91c-9" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_88f628b1e3594a2580a430ba04a2d91c-9"&gt;&lt;/a&gt;    &lt;span class="n"&gt;eles&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="n"&gt;cont&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;cont&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;cont&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;N&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)]&lt;/span&gt;
&lt;a id="rest_code_88f628b1e3594a2580a430ba04a2d91c-10" name="rest_code_88f628b1e3594a2580a430ba04a2d91c-10" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_88f628b1e3594a2580a430ba04a2d91c-10"&gt;&lt;/a&gt;    &lt;span class="n"&gt;stiff&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_88f628b1e3594a2580a430ba04a2d91c-11" name="rest_code_88f628b1e3594a2580a430ba04a2d91c-11" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_88f628b1e3594a2580a430ba04a2d91c-11"&gt;&lt;/a&gt;    &lt;span class="n"&gt;rhs&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_88f628b1e3594a2580a430ba04a2d91c-12" name="rest_code_88f628b1e3594a2580a430ba04a2d91c-12" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_88f628b1e3594a2580a430ba04a2d91c-12"&gt;&lt;/a&gt;    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;ele&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;eles&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a id="rest_code_88f628b1e3594a2580a430ba04a2d91c-13" name="rest_code_88f628b1e3594a2580a430ba04a2d91c-13" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_88f628b1e3594a2580a430ba04a2d91c-13"&gt;&lt;/a&gt;        &lt;span class="n"&gt;jaco&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ele&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]]&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ele&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]]&lt;/span&gt;
&lt;a id="rest_code_88f628b1e3594a2580a430ba04a2d91c-14" name="rest_code_88f628b1e3594a2580a430ba04a2d91c-14" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_88f628b1e3594a2580a430ba04a2d91c-14"&gt;&lt;/a&gt;        &lt;span class="n"&gt;rhs&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ele&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;rhs&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ele&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;jaco&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;source&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ele&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_88f628b1e3594a2580a430ba04a2d91c-15" name="rest_code_88f628b1e3594a2580a430ba04a2d91c-15" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_88f628b1e3594a2580a430ba04a2d91c-15"&gt;&lt;/a&gt;        &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;cont1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;row&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;enumerate&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ele&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_88f628b1e3594a2580a430ba04a2d91c-16" name="rest_code_88f628b1e3594a2580a430ba04a2d91c-16" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_88f628b1e3594a2580a430ba04a2d91c-16"&gt;&lt;/a&gt;            &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;cont2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;col&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;enumerate&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ele&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_88f628b1e3594a2580a430ba04a2d91c-17" name="rest_code_88f628b1e3594a2580a430ba04a2d91c-17" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_88f628b1e3594a2580a430ba04a2d91c-17"&gt;&lt;/a&gt;                &lt;span class="n"&gt;stiff&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;row&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;stiff&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;row&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt;  &lt;span class="n"&gt;stiff_loc&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;cont1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;cont2&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;jaco&lt;/span&gt;
&lt;a id="rest_code_88f628b1e3594a2580a430ba04a2d91c-18" name="rest_code_88f628b1e3594a2580a430ba04a2d91c-18" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_88f628b1e3594a2580a430ba04a2d91c-18"&gt;&lt;/a&gt;    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;stiff&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;rhs&lt;/span&gt;
&lt;a id="rest_code_88f628b1e3594a2580a430ba04a2d91c-19" name="rest_code_88f628b1e3594a2580a430ba04a2d91c-19" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_88f628b1e3594a2580a430ba04a2d91c-19"&gt;&lt;/a&gt;
&lt;a id="rest_code_88f628b1e3594a2580a430ba04a2d91c-20" name="rest_code_88f628b1e3594a2580a430ba04a2d91c-20" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_88f628b1e3594a2580a430ba04a2d91c-20"&gt;&lt;/a&gt;
&lt;a id="rest_code_88f628b1e3594a2580a430ba04a2d91c-21" name="rest_code_88f628b1e3594a2580a430ba04a2d91c-21" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_88f628b1e3594a2580a430ba04a2d91c-21"&gt;&lt;/a&gt;&lt;span class="k"&gt;def&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nf"&gt;conj_grad&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;tol&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mf"&gt;1e-8&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_88f628b1e3594a2580a430ba04a2d91c-22" name="rest_code_88f628b1e3594a2580a430ba04a2d91c-22" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_88f628b1e3594a2580a430ba04a2d91c-22"&gt;&lt;/a&gt;    &lt;span class="n"&gt;r&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;b&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;dot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_88f628b1e3594a2580a430ba04a2d91c-23" name="rest_code_88f628b1e3594a2580a430ba04a2d91c-23" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_88f628b1e3594a2580a430ba04a2d91c-23"&gt;&lt;/a&gt;    &lt;span class="n"&gt;p&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;r&lt;/span&gt;
&lt;a id="rest_code_88f628b1e3594a2580a430ba04a2d91c-24" name="rest_code_88f628b1e3594a2580a430ba04a2d91c-24" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_88f628b1e3594a2580a430ba04a2d91c-24"&gt;&lt;/a&gt;    &lt;span class="n"&gt;rsq_old&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;dot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_88f628b1e3594a2580a430ba04a2d91c-25" name="rest_code_88f628b1e3594a2580a430ba04a2d91c-25" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_88f628b1e3594a2580a430ba04a2d91c-25"&gt;&lt;/a&gt;    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;cont&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;)):&lt;/span&gt;
&lt;a id="rest_code_88f628b1e3594a2580a430ba04a2d91c-26" name="rest_code_88f628b1e3594a2580a430ba04a2d91c-26" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_88f628b1e3594a2580a430ba04a2d91c-26"&gt;&lt;/a&gt;        &lt;span class="n"&gt;Ap&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;dot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_88f628b1e3594a2580a430ba04a2d91c-27" name="rest_code_88f628b1e3594a2580a430ba04a2d91c-27" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_88f628b1e3594a2580a430ba04a2d91c-27"&gt;&lt;/a&gt;        &lt;span class="n"&gt;alpha&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;rsq_old&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;dot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Ap&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_88f628b1e3594a2580a430ba04a2d91c-28" name="rest_code_88f628b1e3594a2580a430ba04a2d91c-28" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_88f628b1e3594a2580a430ba04a2d91c-28"&gt;&lt;/a&gt;        &lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;alpha&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;p&lt;/span&gt;
&lt;a id="rest_code_88f628b1e3594a2580a430ba04a2d91c-29" name="rest_code_88f628b1e3594a2580a430ba04a2d91c-29" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_88f628b1e3594a2580a430ba04a2d91c-29"&gt;&lt;/a&gt;        &lt;span class="n"&gt;r&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;r&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;alpha&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;Ap&lt;/span&gt;
&lt;a id="rest_code_88f628b1e3594a2580a430ba04a2d91c-30" name="rest_code_88f628b1e3594a2580a430ba04a2d91c-30" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_88f628b1e3594a2580a430ba04a2d91c-30"&gt;&lt;/a&gt;        &lt;span class="n"&gt;rsq_new&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;dot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_88f628b1e3594a2580a430ba04a2d91c-31" name="rest_code_88f628b1e3594a2580a430ba04a2d91c-31" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_88f628b1e3594a2580a430ba04a2d91c-31"&gt;&lt;/a&gt;        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sqrt&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;rsq_new&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;tol&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a id="rest_code_88f628b1e3594a2580a430ba04a2d91c-32" name="rest_code_88f628b1e3594a2580a430ba04a2d91c-32" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_88f628b1e3594a2580a430ba04a2d91c-32"&gt;&lt;/a&gt;            &lt;span class="k"&gt;break&lt;/span&gt;
&lt;a id="rest_code_88f628b1e3594a2580a430ba04a2d91c-33" name="rest_code_88f628b1e3594a2580a430ba04a2d91c-33" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_88f628b1e3594a2580a430ba04a2d91c-33"&gt;&lt;/a&gt;        &lt;span class="n"&gt;p&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;r&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;rsq_new&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="n"&gt;rsq_old&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;p&lt;/span&gt;
&lt;a id="rest_code_88f628b1e3594a2580a430ba04a2d91c-34" name="rest_code_88f628b1e3594a2580a430ba04a2d91c-34" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_88f628b1e3594a2580a430ba04a2d91c-34"&gt;&lt;/a&gt;        &lt;span class="n"&gt;rsq_old&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;rsq_new&lt;/span&gt;
&lt;a id="rest_code_88f628b1e3594a2580a430ba04a2d91c-35" name="rest_code_88f628b1e3594a2580a430ba04a2d91c-35" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_88f628b1e3594a2580a430ba04a2d91c-35"&gt;&lt;/a&gt;    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;cont&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sqrt&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;rsq_new&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_88f628b1e3594a2580a430ba04a2d91c-36" name="rest_code_88f628b1e3594a2580a430ba04a2d91c-36" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_88f628b1e3594a2580a430ba04a2d91c-36"&gt;&lt;/a&gt;
&lt;a id="rest_code_88f628b1e3594a2580a430ba04a2d91c-37" name="rest_code_88f628b1e3594a2580a430ba04a2d91c-37" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_88f628b1e3594a2580a430ba04a2d91c-37"&gt;&lt;/a&gt;
&lt;a id="rest_code_88f628b1e3594a2580a430ba04a2d91c-38" name="rest_code_88f628b1e3594a2580a430ba04a2d91c-38" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_88f628b1e3594a2580a430ba04a2d91c-38"&gt;&lt;/a&gt;&lt;span class="n"&gt;fun&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;lambda&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;
&lt;a id="rest_code_88f628b1e3594a2580a430ba04a2d91c-39" name="rest_code_88f628b1e3594a2580a430ba04a2d91c-39" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_88f628b1e3594a2580a430ba04a2d91c-39"&gt;&lt;/a&gt;&lt;span class="n"&gt;N_vec&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;logspace&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;0.5&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;50&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;dtype&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nb"&gt;int&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_88f628b1e3594a2580a430ba04a2d91c-40" name="rest_code_88f628b1e3594a2580a430ba04a2d91c-40" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_88f628b1e3594a2580a430ba04a2d91c-40"&gt;&lt;/a&gt;&lt;span class="n"&gt;err_vec&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros_like&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N_vec&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;dtype&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nb"&gt;float&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_88f628b1e3594a2580a430ba04a2d91c-41" name="rest_code_88f628b1e3594a2580a430ba04a2d91c-41" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_88f628b1e3594a2580a430ba04a2d91c-41"&gt;&lt;/a&gt;&lt;span class="n"&gt;niter_vec&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros_like&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N_vec&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_88f628b1e3594a2580a430ba04a2d91c-42" name="rest_code_88f628b1e3594a2580a430ba04a2d91c-42" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_88f628b1e3594a2580a430ba04a2d91c-42"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;figure&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;figsize&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;8&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_88f628b1e3594a2580a430ba04a2d91c-43" name="rest_code_88f628b1e3594a2580a430ba04a2d91c-43" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_88f628b1e3594a2580a430ba04a2d91c-43"&gt;&lt;/a&gt;&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;cont&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;N&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;enumerate&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N_vec&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_88f628b1e3594a2580a430ba04a2d91c-44" name="rest_code_88f628b1e3594a2580a430ba04a2d91c-44" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_88f628b1e3594a2580a430ba04a2d91c-44"&gt;&lt;/a&gt;    &lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;linspace&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_88f628b1e3594a2580a430ba04a2d91c-45" name="rest_code_88f628b1e3594a2580a430ba04a2d91c-45" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_88f628b1e3594a2580a430ba04a2d91c-45"&gt;&lt;/a&gt;    &lt;span class="n"&gt;stiff&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;rhs&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;FEM1D&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;fun&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_88f628b1e3594a2580a430ba04a2d91c-46" name="rest_code_88f628b1e3594a2580a430ba04a2d91c-46" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_88f628b1e3594a2580a430ba04a2d91c-46"&gt;&lt;/a&gt;    &lt;span class="n"&gt;sol&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_88f628b1e3594a2580a430ba04a2d91c-47" name="rest_code_88f628b1e3594a2580a430ba04a2d91c-47" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_88f628b1e3594a2580a430ba04a2d91c-47"&gt;&lt;/a&gt;    &lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;niter&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;_&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;conj_grad&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;stiff&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;rhs&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;rhs&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_88f628b1e3594a2580a430ba04a2d91c-48" name="rest_code_88f628b1e3594a2580a430ba04a2d91c-48" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_88f628b1e3594a2580a430ba04a2d91c-48"&gt;&lt;/a&gt;    &lt;span class="n"&gt;err&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;linalg&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;norm&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;sol&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="mi"&gt;20&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;linalg&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;norm&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="mi"&gt;20&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_88f628b1e3594a2580a430ba04a2d91c-49" name="rest_code_88f628b1e3594a2580a430ba04a2d91c-49" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_88f628b1e3594a2580a430ba04a2d91c-49"&gt;&lt;/a&gt;    &lt;span class="n"&gt;err_vec&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;cont&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;err&lt;/span&gt;
&lt;a id="rest_code_88f628b1e3594a2580a430ba04a2d91c-50" name="rest_code_88f628b1e3594a2580a430ba04a2d91c-50" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_88f628b1e3594a2580a430ba04a2d91c-50"&gt;&lt;/a&gt;    &lt;span class="n"&gt;niter_vec&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;cont&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;niter&lt;/span&gt;
&lt;a id="rest_code_88f628b1e3594a2580a430ba04a2d91c-51" name="rest_code_88f628b1e3594a2580a430ba04a2d91c-51" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_88f628b1e3594a2580a430ba04a2d91c-51"&gt;&lt;/a&gt;
&lt;a id="rest_code_88f628b1e3594a2580a430ba04a2d91c-52" name="rest_code_88f628b1e3594a2580a430ba04a2d91c-52" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_88f628b1e3594a2580a430ba04a2d91c-52"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;subplot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;121&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_88f628b1e3594a2580a430ba04a2d91c-53" name="rest_code_88f628b1e3594a2580a430ba04a2d91c-53" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_88f628b1e3594a2580a430ba04a2d91c-53"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;loglog&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N_vec&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;err_vec&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_88f628b1e3594a2580a430ba04a2d91c-54" name="rest_code_88f628b1e3594a2580a430ba04a2d91c-54" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_88f628b1e3594a2580a430ba04a2d91c-54"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"Number of nodes"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_88f628b1e3594a2580a430ba04a2d91c-55" name="rest_code_88f628b1e3594a2580a430ba04a2d91c-55" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_88f628b1e3594a2580a430ba04a2d91c-55"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ylabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"Relative error"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_88f628b1e3594a2580a430ba04a2d91c-56" name="rest_code_88f628b1e3594a2580a430ba04a2d91c-56" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_88f628b1e3594a2580a430ba04a2d91c-56"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;subplot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;122&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_88f628b1e3594a2580a430ba04a2d91c-57" name="rest_code_88f628b1e3594a2580a430ba04a2d91c-57" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_88f628b1e3594a2580a430ba04a2d91c-57"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;loglog&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N_vec&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;niter_vec&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_88f628b1e3594a2580a430ba04a2d91c-58" name="rest_code_88f628b1e3594a2580a430ba04a2d91c-58" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_88f628b1e3594a2580a430ba04a2d91c-58"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"Number of nodes"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_88f628b1e3594a2580a430ba04a2d91c-59" name="rest_code_88f628b1e3594a2580a430ba04a2d91c-59" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_88f628b1e3594a2580a430ba04a2d91c-59"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ylabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"Number of iterations"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_88f628b1e3594a2580a430ba04a2d91c-60" name="rest_code_88f628b1e3594a2580a430ba04a2d91c-60" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_88f628b1e3594a2580a430ba04a2d91c-60"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;tight_layout&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a id="rest_code_88f628b1e3594a2580a430ba04a2d91c-61" name="rest_code_88f628b1e3594a2580a430ba04a2d91c-61" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_88f628b1e3594a2580a430ba04a2d91c-61"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;show&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/section&gt;
&lt;section id="julia"&gt;
&lt;h3&gt;Julia&lt;/h3&gt;
&lt;div class="code"&gt;&lt;pre class="code julia"&gt;&lt;a id="rest_code_7572a55a99ed4cfcb873801519e62f63-1" name="rest_code_7572a55a99ed4cfcb873801519e62f63-1" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_7572a55a99ed4cfcb873801519e62f63-1"&gt;&lt;/a&gt;&lt;span class="k"&gt;using&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;PyPlot&lt;/span&gt;
&lt;a id="rest_code_7572a55a99ed4cfcb873801519e62f63-2" name="rest_code_7572a55a99ed4cfcb873801519e62f63-2" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_7572a55a99ed4cfcb873801519e62f63-2"&gt;&lt;/a&gt;
&lt;a id="rest_code_7572a55a99ed4cfcb873801519e62f63-3" name="rest_code_7572a55a99ed4cfcb873801519e62f63-3" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_7572a55a99ed4cfcb873801519e62f63-3"&gt;&lt;/a&gt;
&lt;a id="rest_code_7572a55a99ed4cfcb873801519e62f63-4" name="rest_code_7572a55a99ed4cfcb873801519e62f63-4" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_7572a55a99ed4cfcb873801519e62f63-4"&gt;&lt;/a&gt;&lt;span class="k"&gt;function&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;FEM1D&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;source&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_7572a55a99ed4cfcb873801519e62f63-5" name="rest_code_7572a55a99ed4cfcb873801519e62f63-5" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_7572a55a99ed4cfcb873801519e62f63-5"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;length&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_7572a55a99ed4cfcb873801519e62f63-6" name="rest_code_7572a55a99ed4cfcb873801519e62f63-6" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_7572a55a99ed4cfcb873801519e62f63-6"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;stiff_loc&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mf"&gt;2.0&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;2.0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;2.0&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;2.0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_7572a55a99ed4cfcb873801519e62f63-7" name="rest_code_7572a55a99ed4cfcb873801519e62f63-7" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_7572a55a99ed4cfcb873801519e62f63-7"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;eles&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;[[&lt;/span&gt;&lt;span class="n"&gt;cont&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;cont&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;for&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;cont&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;in&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_7572a55a99ed4cfcb873801519e62f63-8" name="rest_code_7572a55a99ed4cfcb873801519e62f63-8" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_7572a55a99ed4cfcb873801519e62f63-8"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;stiff&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_7572a55a99ed4cfcb873801519e62f63-9" name="rest_code_7572a55a99ed4cfcb873801519e62f63-9" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_7572a55a99ed4cfcb873801519e62f63-9"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;rhs&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_7572a55a99ed4cfcb873801519e62f63-10" name="rest_code_7572a55a99ed4cfcb873801519e62f63-10" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_7572a55a99ed4cfcb873801519e62f63-10"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;for&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ele&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;in&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;eles&lt;/span&gt;
&lt;a id="rest_code_7572a55a99ed4cfcb873801519e62f63-11" name="rest_code_7572a55a99ed4cfcb873801519e62f63-11" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_7572a55a99ed4cfcb873801519e62f63-11"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;jaco&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ele&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;]]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ele&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]]&lt;/span&gt;
&lt;a id="rest_code_7572a55a99ed4cfcb873801519e62f63-12" name="rest_code_7572a55a99ed4cfcb873801519e62f63-12" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_7572a55a99ed4cfcb873801519e62f63-12"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;rhs&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ele&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;rhs&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ele&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;jaco&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;source&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ele&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_7572a55a99ed4cfcb873801519e62f63-13" name="rest_code_7572a55a99ed4cfcb873801519e62f63-13" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_7572a55a99ed4cfcb873801519e62f63-13"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;stiff&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ele&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ele&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;stiff&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ele&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ele&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;stiff_loc&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;jaco&lt;/span&gt;
&lt;a id="rest_code_7572a55a99ed4cfcb873801519e62f63-14" name="rest_code_7572a55a99ed4cfcb873801519e62f63-14" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_7572a55a99ed4cfcb873801519e62f63-14"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;end&lt;/span&gt;
&lt;a id="rest_code_7572a55a99ed4cfcb873801519e62f63-15" name="rest_code_7572a55a99ed4cfcb873801519e62f63-15" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_7572a55a99ed4cfcb873801519e62f63-15"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;return&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;stiff&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;rhs&lt;/span&gt;
&lt;a id="rest_code_7572a55a99ed4cfcb873801519e62f63-16" name="rest_code_7572a55a99ed4cfcb873801519e62f63-16" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_7572a55a99ed4cfcb873801519e62f63-16"&gt;&lt;/a&gt;&lt;span class="k"&gt;end&lt;/span&gt;
&lt;a id="rest_code_7572a55a99ed4cfcb873801519e62f63-17" name="rest_code_7572a55a99ed4cfcb873801519e62f63-17" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_7572a55a99ed4cfcb873801519e62f63-17"&gt;&lt;/a&gt;
&lt;a id="rest_code_7572a55a99ed4cfcb873801519e62f63-18" name="rest_code_7572a55a99ed4cfcb873801519e62f63-18" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_7572a55a99ed4cfcb873801519e62f63-18"&gt;&lt;/a&gt;
&lt;a id="rest_code_7572a55a99ed4cfcb873801519e62f63-19" name="rest_code_7572a55a99ed4cfcb873801519e62f63-19" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_7572a55a99ed4cfcb873801519e62f63-19"&gt;&lt;/a&gt;&lt;span class="k"&gt;function&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;conj_grad&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;tol&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mf"&gt;1e-8&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_7572a55a99ed4cfcb873801519e62f63-20" name="rest_code_7572a55a99ed4cfcb873801519e62f63-20" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_7572a55a99ed4cfcb873801519e62f63-20"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;
&lt;a id="rest_code_7572a55a99ed4cfcb873801519e62f63-21" name="rest_code_7572a55a99ed4cfcb873801519e62f63-21" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_7572a55a99ed4cfcb873801519e62f63-21"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;
&lt;a id="rest_code_7572a55a99ed4cfcb873801519e62f63-22" name="rest_code_7572a55a99ed4cfcb873801519e62f63-22" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_7572a55a99ed4cfcb873801519e62f63-22"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;rsq_old&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;dot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_7572a55a99ed4cfcb873801519e62f63-23" name="rest_code_7572a55a99ed4cfcb873801519e62f63-23" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_7572a55a99ed4cfcb873801519e62f63-23"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;niter&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;
&lt;a id="rest_code_7572a55a99ed4cfcb873801519e62f63-24" name="rest_code_7572a55a99ed4cfcb873801519e62f63-24" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_7572a55a99ed4cfcb873801519e62f63-24"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;for&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;cont&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="n"&gt;length&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_7572a55a99ed4cfcb873801519e62f63-25" name="rest_code_7572a55a99ed4cfcb873801519e62f63-25" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_7572a55a99ed4cfcb873801519e62f63-25"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;Ap&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;p&lt;/span&gt;
&lt;a id="rest_code_7572a55a99ed4cfcb873801519e62f63-26" name="rest_code_7572a55a99ed4cfcb873801519e62f63-26" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_7572a55a99ed4cfcb873801519e62f63-26"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;alpha&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;rsq_old&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;dot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Ap&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_7572a55a99ed4cfcb873801519e62f63-27" name="rest_code_7572a55a99ed4cfcb873801519e62f63-27" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_7572a55a99ed4cfcb873801519e62f63-27"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;alpha&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;p&lt;/span&gt;
&lt;a id="rest_code_7572a55a99ed4cfcb873801519e62f63-28" name="rest_code_7572a55a99ed4cfcb873801519e62f63-28" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_7572a55a99ed4cfcb873801519e62f63-28"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;alpha&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;Ap&lt;/span&gt;
&lt;a id="rest_code_7572a55a99ed4cfcb873801519e62f63-29" name="rest_code_7572a55a99ed4cfcb873801519e62f63-29" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_7572a55a99ed4cfcb873801519e62f63-29"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;rsq_new&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;dot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_7572a55a99ed4cfcb873801519e62f63-30" name="rest_code_7572a55a99ed4cfcb873801519e62f63-30" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_7572a55a99ed4cfcb873801519e62f63-30"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;sqrt&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;rsq_new&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;tol&lt;/span&gt;
&lt;a id="rest_code_7572a55a99ed4cfcb873801519e62f63-31" name="rest_code_7572a55a99ed4cfcb873801519e62f63-31" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_7572a55a99ed4cfcb873801519e62f63-31"&gt;&lt;/a&gt;&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="k"&gt;break&lt;/span&gt;
&lt;a id="rest_code_7572a55a99ed4cfcb873801519e62f63-32" name="rest_code_7572a55a99ed4cfcb873801519e62f63-32" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_7572a55a99ed4cfcb873801519e62f63-32"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="k"&gt;end&lt;/span&gt;
&lt;a id="rest_code_7572a55a99ed4cfcb873801519e62f63-33" name="rest_code_7572a55a99ed4cfcb873801519e62f63-33" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_7572a55a99ed4cfcb873801519e62f63-33"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;rsq_new&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;rsq_old&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;p&lt;/span&gt;
&lt;a id="rest_code_7572a55a99ed4cfcb873801519e62f63-34" name="rest_code_7572a55a99ed4cfcb873801519e62f63-34" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_7572a55a99ed4cfcb873801519e62f63-34"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;rsq_old&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;rsq_new&lt;/span&gt;
&lt;a id="rest_code_7572a55a99ed4cfcb873801519e62f63-35" name="rest_code_7572a55a99ed4cfcb873801519e62f63-35" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_7572a55a99ed4cfcb873801519e62f63-35"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;niter&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;
&lt;a id="rest_code_7572a55a99ed4cfcb873801519e62f63-36" name="rest_code_7572a55a99ed4cfcb873801519e62f63-36" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_7572a55a99ed4cfcb873801519e62f63-36"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;end&lt;/span&gt;
&lt;a id="rest_code_7572a55a99ed4cfcb873801519e62f63-37" name="rest_code_7572a55a99ed4cfcb873801519e62f63-37" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_7572a55a99ed4cfcb873801519e62f63-37"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;return&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;niter&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;norm&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_7572a55a99ed4cfcb873801519e62f63-38" name="rest_code_7572a55a99ed4cfcb873801519e62f63-38" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_7572a55a99ed4cfcb873801519e62f63-38"&gt;&lt;/a&gt;&lt;span class="k"&gt;end&lt;/span&gt;
&lt;a id="rest_code_7572a55a99ed4cfcb873801519e62f63-39" name="rest_code_7572a55a99ed4cfcb873801519e62f63-39" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_7572a55a99ed4cfcb873801519e62f63-39"&gt;&lt;/a&gt;
&lt;a id="rest_code_7572a55a99ed4cfcb873801519e62f63-40" name="rest_code_7572a55a99ed4cfcb873801519e62f63-40" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_7572a55a99ed4cfcb873801519e62f63-40"&gt;&lt;/a&gt;
&lt;a id="rest_code_7572a55a99ed4cfcb873801519e62f63-41" name="rest_code_7572a55a99ed4cfcb873801519e62f63-41" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_7572a55a99ed4cfcb873801519e62f63-41"&gt;&lt;/a&gt;
&lt;a id="rest_code_7572a55a99ed4cfcb873801519e62f63-42" name="rest_code_7572a55a99ed4cfcb873801519e62f63-42" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_7572a55a99ed4cfcb873801519e62f63-42"&gt;&lt;/a&gt;&lt;span class="n"&gt;fun&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;.^&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;
&lt;a id="rest_code_7572a55a99ed4cfcb873801519e62f63-43" name="rest_code_7572a55a99ed4cfcb873801519e62f63-43" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_7572a55a99ed4cfcb873801519e62f63-43"&gt;&lt;/a&gt;&lt;span class="n"&gt;N_vec&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;round&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;logspace&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;0.5&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;50&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_7572a55a99ed4cfcb873801519e62f63-44" name="rest_code_7572a55a99ed4cfcb873801519e62f63-44" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_7572a55a99ed4cfcb873801519e62f63-44"&gt;&lt;/a&gt;&lt;span class="n"&gt;err_vec&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N_vec&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_7572a55a99ed4cfcb873801519e62f63-45" name="rest_code_7572a55a99ed4cfcb873801519e62f63-45" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_7572a55a99ed4cfcb873801519e62f63-45"&gt;&lt;/a&gt;&lt;span class="n"&gt;niter_vec&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N_vec&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_7572a55a99ed4cfcb873801519e62f63-46" name="rest_code_7572a55a99ed4cfcb873801519e62f63-46" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_7572a55a99ed4cfcb873801519e62f63-46"&gt;&lt;/a&gt;&lt;span class="n"&gt;figure&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;figsize&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;8&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_7572a55a99ed4cfcb873801519e62f63-47" name="rest_code_7572a55a99ed4cfcb873801519e62f63-47" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_7572a55a99ed4cfcb873801519e62f63-47"&gt;&lt;/a&gt;&lt;span class="k"&gt;for&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;cont&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;in&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;enumerate&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N_vec&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_7572a55a99ed4cfcb873801519e62f63-48" name="rest_code_7572a55a99ed4cfcb873801519e62f63-48" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_7572a55a99ed4cfcb873801519e62f63-48"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;linspace&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;0.0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;1.0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_7572a55a99ed4cfcb873801519e62f63-49" name="rest_code_7572a55a99ed4cfcb873801519e62f63-49" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_7572a55a99ed4cfcb873801519e62f63-49"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;stiff&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;rhs&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;FEM1D&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;fun&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_7572a55a99ed4cfcb873801519e62f63-50" name="rest_code_7572a55a99ed4cfcb873801519e62f63-50" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_7572a55a99ed4cfcb873801519e62f63-50"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_7572a55a99ed4cfcb873801519e62f63-51" name="rest_code_7572a55a99ed4cfcb873801519e62f63-51" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_7572a55a99ed4cfcb873801519e62f63-51"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="k"&gt;end&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;niter&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;_&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;conj_grad&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;stiff&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="k"&gt;end&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="k"&gt;end&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;
&lt;a id="rest_code_7572a55a99ed4cfcb873801519e62f63-52" name="rest_code_7572a55a99ed4cfcb873801519e62f63-52" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_7572a55a99ed4cfcb873801519e62f63-52"&gt;&lt;/a&gt;&lt;span class="w"&gt;                                &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;rhs&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="k"&gt;end&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;rhs&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="k"&gt;end&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_7572a55a99ed4cfcb873801519e62f63-53" name="rest_code_7572a55a99ed4cfcb873801519e62f63-53" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_7572a55a99ed4cfcb873801519e62f63-53"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;err&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;norm&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;.*&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;.^&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="mi"&gt;20&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;norm&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;.*&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;.^&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="mi"&gt;20&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_7572a55a99ed4cfcb873801519e62f63-54" name="rest_code_7572a55a99ed4cfcb873801519e62f63-54" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_7572a55a99ed4cfcb873801519e62f63-54"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;err_vec&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;cont&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;err&lt;/span&gt;
&lt;a id="rest_code_7572a55a99ed4cfcb873801519e62f63-55" name="rest_code_7572a55a99ed4cfcb873801519e62f63-55" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_7572a55a99ed4cfcb873801519e62f63-55"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;niter_vec&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;cont&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;niter&lt;/span&gt;
&lt;a id="rest_code_7572a55a99ed4cfcb873801519e62f63-56" name="rest_code_7572a55a99ed4cfcb873801519e62f63-56" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_7572a55a99ed4cfcb873801519e62f63-56"&gt;&lt;/a&gt;&lt;span class="k"&gt;end&lt;/span&gt;
&lt;a id="rest_code_7572a55a99ed4cfcb873801519e62f63-57" name="rest_code_7572a55a99ed4cfcb873801519e62f63-57" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_7572a55a99ed4cfcb873801519e62f63-57"&gt;&lt;/a&gt;&lt;span class="n"&gt;subplot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;121&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_7572a55a99ed4cfcb873801519e62f63-58" name="rest_code_7572a55a99ed4cfcb873801519e62f63-58" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_7572a55a99ed4cfcb873801519e62f63-58"&gt;&lt;/a&gt;&lt;span class="n"&gt;loglog&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N_vec&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;err_vec&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_7572a55a99ed4cfcb873801519e62f63-59" name="rest_code_7572a55a99ed4cfcb873801519e62f63-59" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_7572a55a99ed4cfcb873801519e62f63-59"&gt;&lt;/a&gt;&lt;span class="n"&gt;xlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;"Number of nodes"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_7572a55a99ed4cfcb873801519e62f63-60" name="rest_code_7572a55a99ed4cfcb873801519e62f63-60" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_7572a55a99ed4cfcb873801519e62f63-60"&gt;&lt;/a&gt;&lt;span class="n"&gt;ylabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;"Relative error"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_7572a55a99ed4cfcb873801519e62f63-61" name="rest_code_7572a55a99ed4cfcb873801519e62f63-61" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_7572a55a99ed4cfcb873801519e62f63-61"&gt;&lt;/a&gt;&lt;span class="n"&gt;subplot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;122&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_7572a55a99ed4cfcb873801519e62f63-62" name="rest_code_7572a55a99ed4cfcb873801519e62f63-62" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_7572a55a99ed4cfcb873801519e62f63-62"&gt;&lt;/a&gt;&lt;span class="n"&gt;loglog&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N_vec&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;niter_vec&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_7572a55a99ed4cfcb873801519e62f63-63" name="rest_code_7572a55a99ed4cfcb873801519e62f63-63" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_7572a55a99ed4cfcb873801519e62f63-63"&gt;&lt;/a&gt;&lt;span class="n"&gt;xlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;"Number of nodes"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_7572a55a99ed4cfcb873801519e62f63-64" name="rest_code_7572a55a99ed4cfcb873801519e62f63-64" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_7572a55a99ed4cfcb873801519e62f63-64"&gt;&lt;/a&gt;&lt;span class="n"&gt;ylabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;"Number of iterations"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_7572a55a99ed4cfcb873801519e62f63-65" name="rest_code_7572a55a99ed4cfcb873801519e62f63-65" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_7572a55a99ed4cfcb873801519e62f63-65"&gt;&lt;/a&gt;&lt;span class="n"&gt;tight_layout&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a id="rest_code_7572a55a99ed4cfcb873801519e62f63-66" name="rest_code_7572a55a99ed4cfcb873801519e62f63-66" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_7572a55a99ed4cfcb873801519e62f63-66"&gt;&lt;/a&gt;&lt;span class="n"&gt;show&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;In this case, we are analyzing the error of the solution as a function
of the number of nodes. This, and the number of iterations required
in the conjugate gradient are shown in the following image&lt;/p&gt;
&lt;img alt="Relative error in the solution." class="align-center" src="https://nicoguaro.github.io/images/FEM1D_convergence.svg" style="width: 800px;"&gt;
&lt;/section&gt;
&lt;/section&gt;</description><category>conjugate gradient</category><category>finite element method</category><category>julia</category><category>numerical methods</category><category>python</category><category>scientific computing</category><guid>https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/</guid><pubDate>Wed, 01 Nov 2017 01:45:09 GMT</pubDate></item><item><title>Numerical methods challenge: Day 25</title><link>https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/</link><dc:creator>Nicolás Guarín-Zapata</dc:creator><description>&lt;p&gt;During October (2017) I will write a program per day for some well-known
numerical methods in both Python and Julia. It is intended to be an exercise
then don't expect the code to be good enough for real use. Also,
I should mention that I have almost no experience with Julia, so it
probably won't be idiomatic Julia but more Python-like Julia.&lt;/p&gt;
&lt;section id="finite-element-method"&gt;
&lt;h2&gt;Finite element method&lt;/h2&gt;
&lt;p&gt;Today we have the &lt;a class="reference external" href="https://en.wikipedia.org/wiki/Finite_element_method"&gt;Finite element method&lt;/a&gt;
to solve the equation:&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
\nabla^2 u = -f(x)
\end{equation*}
&lt;/div&gt;
&lt;p&gt;with&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
u(\sqrt{3}, 1) = 0
\end{equation*}
&lt;/div&gt;
&lt;p&gt;As in the &lt;a class="reference external" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/posts/numerical-23"&gt;Ritz method&lt;/a&gt; we form
a functional that is &lt;em&gt;equivalent&lt;/em&gt; to the
differential equation, propose an approximation as a linear combination of
a set of basis functions and find the &lt;em&gt;best&lt;/em&gt; set of coefficients for that
combination. That &lt;em&gt;best&lt;/em&gt; solution is found minimizing the functional.&lt;/p&gt;
&lt;p&gt;The functional for this differential equation is&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
\Pi[u] = -\int_\Omega \left(\nabla u\right)^2 d\Omega
         -\int_\Omega  u f(x) d\Omega
\end{equation*}
&lt;/div&gt;
&lt;p&gt;Using linear triangles, the local stiffness matrices read&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
K_\text{local} =  \frac{1}{2|J|}
    \begin{bmatrix}
        2 &amp;amp; -1 &amp;amp;1\\
        -1 &amp;amp; 1 &amp;amp;0\\
        -1 &amp;amp; 0 &amp;amp;1\\
    \end{bmatrix}
\end{equation*}
&lt;/div&gt;
&lt;p&gt;and&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
b_\text{local} = -|J| f(x_m) \mathbf{1}_3\, ,
\end{equation*}
&lt;/div&gt;
&lt;p&gt;where &lt;span class="math"&gt;\(|J|\)&lt;/span&gt; is the Jacobian determinant of the transformation and
&lt;span class="math"&gt;\(x_m\)&lt;/span&gt; is the centroid of the triangle. I am
skipping a great deal about assembling, but it would be just too extensive
to describe the complete process.&lt;/p&gt;
&lt;p&gt;We will solve the problem in a mesh with 6 triangles forming
a regular hexagon&lt;/p&gt;
&lt;p&gt;Following are the codes.&lt;/p&gt;
&lt;section id="python"&gt;
&lt;h3&gt;Python&lt;/h3&gt;
&lt;div class="code"&gt;&lt;pre class="code python"&gt;&lt;a id="rest_code_07166bdb8c304e6783f4121ee5cf041b-1" name="rest_code_07166bdb8c304e6783f4121ee5cf041b-1" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_07166bdb8c304e6783f4121ee5cf041b-1"&gt;&lt;/a&gt;&lt;span class="kn"&gt;from&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nn"&gt;__future__&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;division&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;print_function&lt;/span&gt;
&lt;a id="rest_code_07166bdb8c304e6783f4121ee5cf041b-2" name="rest_code_07166bdb8c304e6783f4121ee5cf041b-2" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_07166bdb8c304e6783f4121ee5cf041b-2"&gt;&lt;/a&gt;&lt;span class="kn"&gt;import&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nn"&gt;numpy&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;as&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nn"&gt;np&lt;/span&gt;
&lt;a id="rest_code_07166bdb8c304e6783f4121ee5cf041b-3" name="rest_code_07166bdb8c304e6783f4121ee5cf041b-3" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_07166bdb8c304e6783f4121ee5cf041b-3"&gt;&lt;/a&gt;&lt;span class="kn"&gt;import&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nn"&gt;matplotlib.pyplot&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;as&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nn"&gt;plt&lt;/span&gt;
&lt;a id="rest_code_07166bdb8c304e6783f4121ee5cf041b-4" name="rest_code_07166bdb8c304e6783f4121ee5cf041b-4" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_07166bdb8c304e6783f4121ee5cf041b-4"&gt;&lt;/a&gt;
&lt;a id="rest_code_07166bdb8c304e6783f4121ee5cf041b-5" name="rest_code_07166bdb8c304e6783f4121ee5cf041b-5" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_07166bdb8c304e6783f4121ee5cf041b-5"&gt;&lt;/a&gt;&lt;span class="k"&gt;def&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nf"&gt;assem&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;elems&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;source&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_07166bdb8c304e6783f4121ee5cf041b-6" name="rest_code_07166bdb8c304e6783f4121ee5cf041b-6" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_07166bdb8c304e6783f4121ee5cf041b-6"&gt;&lt;/a&gt;    &lt;span class="n"&gt;ncoords&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;shape&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_07166bdb8c304e6783f4121ee5cf041b-7" name="rest_code_07166bdb8c304e6783f4121ee5cf041b-7" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_07166bdb8c304e6783f4121ee5cf041b-7"&gt;&lt;/a&gt;    &lt;span class="n"&gt;stiff&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="n"&gt;ncoords&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;ncoords&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_07166bdb8c304e6783f4121ee5cf041b-8" name="rest_code_07166bdb8c304e6783f4121ee5cf041b-8" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_07166bdb8c304e6783f4121ee5cf041b-8"&gt;&lt;/a&gt;    &lt;span class="n"&gt;rhs&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="n"&gt;ncoords&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_07166bdb8c304e6783f4121ee5cf041b-9" name="rest_code_07166bdb8c304e6783f4121ee5cf041b-9" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_07166bdb8c304e6783f4121ee5cf041b-9"&gt;&lt;/a&gt;    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;el_cont&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;elem&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;enumerate&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;elems&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_07166bdb8c304e6783f4121ee5cf041b-10" name="rest_code_07166bdb8c304e6783f4121ee5cf041b-10" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_07166bdb8c304e6783f4121ee5cf041b-10"&gt;&lt;/a&gt;        &lt;span class="n"&gt;stiff_loc&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;jaco&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;local_stiff&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;elem&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_07166bdb8c304e6783f4121ee5cf041b-11" name="rest_code_07166bdb8c304e6783f4121ee5cf041b-11" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_07166bdb8c304e6783f4121ee5cf041b-11"&gt;&lt;/a&gt;        &lt;span class="n"&gt;rhs&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;elem&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;+=&lt;/span&gt; &lt;span class="n"&gt;jaco&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;mean&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;source&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;elem&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_07166bdb8c304e6783f4121ee5cf041b-12" name="rest_code_07166bdb8c304e6783f4121ee5cf041b-12" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_07166bdb8c304e6783f4121ee5cf041b-12"&gt;&lt;/a&gt;        &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;row&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_07166bdb8c304e6783f4121ee5cf041b-13" name="rest_code_07166bdb8c304e6783f4121ee5cf041b-13" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_07166bdb8c304e6783f4121ee5cf041b-13"&gt;&lt;/a&gt;            &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;col&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_07166bdb8c304e6783f4121ee5cf041b-14" name="rest_code_07166bdb8c304e6783f4121ee5cf041b-14" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_07166bdb8c304e6783f4121ee5cf041b-14"&gt;&lt;/a&gt;                &lt;span class="n"&gt;row_glob&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;col_glob&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;elem&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;row&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;elem&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_07166bdb8c304e6783f4121ee5cf041b-15" name="rest_code_07166bdb8c304e6783f4121ee5cf041b-15" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_07166bdb8c304e6783f4121ee5cf041b-15"&gt;&lt;/a&gt;                &lt;span class="n"&gt;stiff&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;row_glob&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;col_glob&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;+=&lt;/span&gt; &lt;span class="n"&gt;stiff_loc&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;row&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_07166bdb8c304e6783f4121ee5cf041b-16" name="rest_code_07166bdb8c304e6783f4121ee5cf041b-16" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_07166bdb8c304e6783f4121ee5cf041b-16"&gt;&lt;/a&gt;    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;stiff&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;rhs&lt;/span&gt;
&lt;a id="rest_code_07166bdb8c304e6783f4121ee5cf041b-17" name="rest_code_07166bdb8c304e6783f4121ee5cf041b-17" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_07166bdb8c304e6783f4121ee5cf041b-17"&gt;&lt;/a&gt;
&lt;a id="rest_code_07166bdb8c304e6783f4121ee5cf041b-18" name="rest_code_07166bdb8c304e6783f4121ee5cf041b-18" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_07166bdb8c304e6783f4121ee5cf041b-18"&gt;&lt;/a&gt;
&lt;a id="rest_code_07166bdb8c304e6783f4121ee5cf041b-19" name="rest_code_07166bdb8c304e6783f4121ee5cf041b-19" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_07166bdb8c304e6783f4121ee5cf041b-19"&gt;&lt;/a&gt;&lt;span class="k"&gt;def&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nf"&gt;local_stiff&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_07166bdb8c304e6783f4121ee5cf041b-20" name="rest_code_07166bdb8c304e6783f4121ee5cf041b-20" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_07166bdb8c304e6783f4121ee5cf041b-20"&gt;&lt;/a&gt;    &lt;span class="n"&gt;dHdr&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;([[&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]])&lt;/span&gt;
&lt;a id="rest_code_07166bdb8c304e6783f4121ee5cf041b-21" name="rest_code_07166bdb8c304e6783f4121ee5cf041b-21" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_07166bdb8c304e6783f4121ee5cf041b-21"&gt;&lt;/a&gt;    &lt;span class="n"&gt;jaco&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;dHdr&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;dot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_07166bdb8c304e6783f4121ee5cf041b-22" name="rest_code_07166bdb8c304e6783f4121ee5cf041b-22" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_07166bdb8c304e6783f4121ee5cf041b-22"&gt;&lt;/a&gt;    &lt;span class="n"&gt;stiff&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;0.5&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;([[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]])&lt;/span&gt;
&lt;a id="rest_code_07166bdb8c304e6783f4121ee5cf041b-23" name="rest_code_07166bdb8c304e6783f4121ee5cf041b-23" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_07166bdb8c304e6783f4121ee5cf041b-23"&gt;&lt;/a&gt;    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;stiff&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;linalg&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;det&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;jaco&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;linalg&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;det&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;jaco&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_07166bdb8c304e6783f4121ee5cf041b-24" name="rest_code_07166bdb8c304e6783f4121ee5cf041b-24" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_07166bdb8c304e6783f4121ee5cf041b-24"&gt;&lt;/a&gt;
&lt;a id="rest_code_07166bdb8c304e6783f4121ee5cf041b-25" name="rest_code_07166bdb8c304e6783f4121ee5cf041b-25" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_07166bdb8c304e6783f4121ee5cf041b-25"&gt;&lt;/a&gt;
&lt;a id="rest_code_07166bdb8c304e6783f4121ee5cf041b-26" name="rest_code_07166bdb8c304e6783f4121ee5cf041b-26" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_07166bdb8c304e6783f4121ee5cf041b-26"&gt;&lt;/a&gt;&lt;span class="n"&gt;sq3&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sqrt&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_07166bdb8c304e6783f4121ee5cf041b-27" name="rest_code_07166bdb8c304e6783f4121ee5cf041b-27" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_07166bdb8c304e6783f4121ee5cf041b-27"&gt;&lt;/a&gt;&lt;span class="n"&gt;coords&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;
&lt;a id="rest_code_07166bdb8c304e6783f4121ee5cf041b-28" name="rest_code_07166bdb8c304e6783f4121ee5cf041b-28" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_07166bdb8c304e6783f4121ee5cf041b-28"&gt;&lt;/a&gt;        &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;sq3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;
&lt;a id="rest_code_07166bdb8c304e6783f4121ee5cf041b-29" name="rest_code_07166bdb8c304e6783f4121ee5cf041b-29" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_07166bdb8c304e6783f4121ee5cf041b-29"&gt;&lt;/a&gt;        &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;
&lt;a id="rest_code_07166bdb8c304e6783f4121ee5cf041b-30" name="rest_code_07166bdb8c304e6783f4121ee5cf041b-30" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_07166bdb8c304e6783f4121ee5cf041b-30"&gt;&lt;/a&gt;        &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;sq3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;
&lt;a id="rest_code_07166bdb8c304e6783f4121ee5cf041b-31" name="rest_code_07166bdb8c304e6783f4121ee5cf041b-31" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_07166bdb8c304e6783f4121ee5cf041b-31"&gt;&lt;/a&gt;        &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;
&lt;a id="rest_code_07166bdb8c304e6783f4121ee5cf041b-32" name="rest_code_07166bdb8c304e6783f4121ee5cf041b-32" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_07166bdb8c304e6783f4121ee5cf041b-32"&gt;&lt;/a&gt;        &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;sq3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;
&lt;a id="rest_code_07166bdb8c304e6783f4121ee5cf041b-33" name="rest_code_07166bdb8c304e6783f4121ee5cf041b-33" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_07166bdb8c304e6783f4121ee5cf041b-33"&gt;&lt;/a&gt;        &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;sq3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;
&lt;a id="rest_code_07166bdb8c304e6783f4121ee5cf041b-34" name="rest_code_07166bdb8c304e6783f4121ee5cf041b-34" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_07166bdb8c304e6783f4121ee5cf041b-34"&gt;&lt;/a&gt;        &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;sq3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]])&lt;/span&gt;
&lt;a id="rest_code_07166bdb8c304e6783f4121ee5cf041b-35" name="rest_code_07166bdb8c304e6783f4121ee5cf041b-35" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_07166bdb8c304e6783f4121ee5cf041b-35"&gt;&lt;/a&gt;&lt;span class="n"&gt;elems&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;
&lt;a id="rest_code_07166bdb8c304e6783f4121ee5cf041b-36" name="rest_code_07166bdb8c304e6783f4121ee5cf041b-36" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_07166bdb8c304e6783f4121ee5cf041b-36"&gt;&lt;/a&gt;        &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;6&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;
&lt;a id="rest_code_07166bdb8c304e6783f4121ee5cf041b-37" name="rest_code_07166bdb8c304e6783f4121ee5cf041b-37" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_07166bdb8c304e6783f4121ee5cf041b-37"&gt;&lt;/a&gt;        &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;6&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;
&lt;a id="rest_code_07166bdb8c304e6783f4121ee5cf041b-38" name="rest_code_07166bdb8c304e6783f4121ee5cf041b-38" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_07166bdb8c304e6783f4121ee5cf041b-38"&gt;&lt;/a&gt;        &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;6&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;
&lt;a id="rest_code_07166bdb8c304e6783f4121ee5cf041b-39" name="rest_code_07166bdb8c304e6783f4121ee5cf041b-39" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_07166bdb8c304e6783f4121ee5cf041b-39"&gt;&lt;/a&gt;        &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;6&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;
&lt;a id="rest_code_07166bdb8c304e6783f4121ee5cf041b-40" name="rest_code_07166bdb8c304e6783f4121ee5cf041b-40" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_07166bdb8c304e6783f4121ee5cf041b-40"&gt;&lt;/a&gt;        &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;6&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;
&lt;a id="rest_code_07166bdb8c304e6783f4121ee5cf041b-41" name="rest_code_07166bdb8c304e6783f4121ee5cf041b-41" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_07166bdb8c304e6783f4121ee5cf041b-41"&gt;&lt;/a&gt;        &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;6&lt;/span&gt;&lt;span class="p"&gt;]])&lt;/span&gt;
&lt;a id="rest_code_07166bdb8c304e6783f4121ee5cf041b-42" name="rest_code_07166bdb8c304e6783f4121ee5cf041b-42" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_07166bdb8c304e6783f4121ee5cf041b-42"&gt;&lt;/a&gt;&lt;span class="n"&gt;source&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ones&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;7&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_07166bdb8c304e6783f4121ee5cf041b-43" name="rest_code_07166bdb8c304e6783f4121ee5cf041b-43" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_07166bdb8c304e6783f4121ee5cf041b-43"&gt;&lt;/a&gt;&lt;span class="n"&gt;stiff&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;rhs&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;assem&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;elems&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;source&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_07166bdb8c304e6783f4121ee5cf041b-44" name="rest_code_07166bdb8c304e6783f4121ee5cf041b-44" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_07166bdb8c304e6783f4121ee5cf041b-44"&gt;&lt;/a&gt;&lt;span class="n"&gt;free&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;6&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_07166bdb8c304e6783f4121ee5cf041b-45" name="rest_code_07166bdb8c304e6783f4121ee5cf041b-45" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_07166bdb8c304e6783f4121ee5cf041b-45"&gt;&lt;/a&gt;&lt;span class="n"&gt;sol&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;linalg&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;solve&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;stiff&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ix_&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;free&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;free&lt;/span&gt;&lt;span class="p"&gt;)],&lt;/span&gt; &lt;span class="n"&gt;rhs&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;free&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_07166bdb8c304e6783f4121ee5cf041b-46" name="rest_code_07166bdb8c304e6783f4121ee5cf041b-46" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_07166bdb8c304e6783f4121ee5cf041b-46"&gt;&lt;/a&gt;&lt;span class="n"&gt;sol_c&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;shape&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_07166bdb8c304e6783f4121ee5cf041b-47" name="rest_code_07166bdb8c304e6783f4121ee5cf041b-47" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_07166bdb8c304e6783f4121ee5cf041b-47"&gt;&lt;/a&gt;&lt;span class="n"&gt;sol_c&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;free&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;sol&lt;/span&gt;
&lt;a id="rest_code_07166bdb8c304e6783f4121ee5cf041b-48" name="rest_code_07166bdb8c304e6783f4121ee5cf041b-48" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_07166bdb8c304e6783f4121ee5cf041b-48"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;tricontourf&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;[:,&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;[:,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;sol_c&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;cmap&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;"hot"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_07166bdb8c304e6783f4121ee5cf041b-49" name="rest_code_07166bdb8c304e6783f4121ee5cf041b-49" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_07166bdb8c304e6783f4121ee5cf041b-49"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;colorbar&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a id="rest_code_07166bdb8c304e6783f4121ee5cf041b-50" name="rest_code_07166bdb8c304e6783f4121ee5cf041b-50" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_07166bdb8c304e6783f4121ee5cf041b-50"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;axis&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"image"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_07166bdb8c304e6783f4121ee5cf041b-51" name="rest_code_07166bdb8c304e6783f4121ee5cf041b-51" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_07166bdb8c304e6783f4121ee5cf041b-51"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;show&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/section&gt;
&lt;section id="julia"&gt;
&lt;h3&gt;Julia&lt;/h3&gt;
&lt;div class="code"&gt;&lt;pre class="code julia"&gt;&lt;a id="rest_code_0a852d8e3ccb4f79ab27fd2decb9e2c2-1" name="rest_code_0a852d8e3ccb4f79ab27fd2decb9e2c2-1" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_0a852d8e3ccb4f79ab27fd2decb9e2c2-1"&gt;&lt;/a&gt;&lt;span class="k"&gt;using&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;PyPlot&lt;/span&gt;
&lt;a id="rest_code_0a852d8e3ccb4f79ab27fd2decb9e2c2-2" name="rest_code_0a852d8e3ccb4f79ab27fd2decb9e2c2-2" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_0a852d8e3ccb4f79ab27fd2decb9e2c2-2"&gt;&lt;/a&gt;
&lt;a id="rest_code_0a852d8e3ccb4f79ab27fd2decb9e2c2-3" name="rest_code_0a852d8e3ccb4f79ab27fd2decb9e2c2-3" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_0a852d8e3ccb4f79ab27fd2decb9e2c2-3"&gt;&lt;/a&gt;
&lt;a id="rest_code_0a852d8e3ccb4f79ab27fd2decb9e2c2-4" name="rest_code_0a852d8e3ccb4f79ab27fd2decb9e2c2-4" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_0a852d8e3ccb4f79ab27fd2decb9e2c2-4"&gt;&lt;/a&gt;&lt;span class="k"&gt;function&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;assem&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;elems&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;source&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_0a852d8e3ccb4f79ab27fd2decb9e2c2-5" name="rest_code_0a852d8e3ccb4f79ab27fd2decb9e2c2-5" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_0a852d8e3ccb4f79ab27fd2decb9e2c2-5"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;ncoords&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;size&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;)[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_0a852d8e3ccb4f79ab27fd2decb9e2c2-6" name="rest_code_0a852d8e3ccb4f79ab27fd2decb9e2c2-6" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_0a852d8e3ccb4f79ab27fd2decb9e2c2-6"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;nelems&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;size&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;elems&lt;/span&gt;&lt;span class="p"&gt;)[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_0a852d8e3ccb4f79ab27fd2decb9e2c2-7" name="rest_code_0a852d8e3ccb4f79ab27fd2decb9e2c2-7" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_0a852d8e3ccb4f79ab27fd2decb9e2c2-7"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;stiff&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ncoords&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ncoords&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_0a852d8e3ccb4f79ab27fd2decb9e2c2-8" name="rest_code_0a852d8e3ccb4f79ab27fd2decb9e2c2-8" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_0a852d8e3ccb4f79ab27fd2decb9e2c2-8"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;rhs&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ncoords&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_0a852d8e3ccb4f79ab27fd2decb9e2c2-9" name="rest_code_0a852d8e3ccb4f79ab27fd2decb9e2c2-9" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_0a852d8e3ccb4f79ab27fd2decb9e2c2-9"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;for&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;el_cont&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="n"&gt;nelems&lt;/span&gt;
&lt;a id="rest_code_0a852d8e3ccb4f79ab27fd2decb9e2c2-10" name="rest_code_0a852d8e3ccb4f79ab27fd2decb9e2c2-10" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_0a852d8e3ccb4f79ab27fd2decb9e2c2-10"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;elem&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;elems&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;el_cont&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_0a852d8e3ccb4f79ab27fd2decb9e2c2-11" name="rest_code_0a852d8e3ccb4f79ab27fd2decb9e2c2-11" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_0a852d8e3ccb4f79ab27fd2decb9e2c2-11"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;stiff_loc&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;jaco&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;local_stiff&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;elem&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_0a852d8e3ccb4f79ab27fd2decb9e2c2-12" name="rest_code_0a852d8e3ccb4f79ab27fd2decb9e2c2-12" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_0a852d8e3ccb4f79ab27fd2decb9e2c2-12"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;rhs&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;elem&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;jaco&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;mean&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;source&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;elem&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_0a852d8e3ccb4f79ab27fd2decb9e2c2-13" name="rest_code_0a852d8e3ccb4f79ab27fd2decb9e2c2-13" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_0a852d8e3ccb4f79ab27fd2decb9e2c2-13"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="k"&gt;for&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;row&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;
&lt;a id="rest_code_0a852d8e3ccb4f79ab27fd2decb9e2c2-14" name="rest_code_0a852d8e3ccb4f79ab27fd2decb9e2c2-14" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_0a852d8e3ccb4f79ab27fd2decb9e2c2-14"&gt;&lt;/a&gt;&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="k"&gt;for&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;
&lt;a id="rest_code_0a852d8e3ccb4f79ab27fd2decb9e2c2-15" name="rest_code_0a852d8e3ccb4f79ab27fd2decb9e2c2-15" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_0a852d8e3ccb4f79ab27fd2decb9e2c2-15"&gt;&lt;/a&gt;&lt;span class="w"&gt;                &lt;/span&gt;&lt;span class="n"&gt;row_glob&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;elem&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;row&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_0a852d8e3ccb4f79ab27fd2decb9e2c2-16" name="rest_code_0a852d8e3ccb4f79ab27fd2decb9e2c2-16" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_0a852d8e3ccb4f79ab27fd2decb9e2c2-16"&gt;&lt;/a&gt;&lt;span class="w"&gt;                &lt;/span&gt;&lt;span class="n"&gt;col_glob&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;elem&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_0a852d8e3ccb4f79ab27fd2decb9e2c2-17" name="rest_code_0a852d8e3ccb4f79ab27fd2decb9e2c2-17" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_0a852d8e3ccb4f79ab27fd2decb9e2c2-17"&gt;&lt;/a&gt;&lt;span class="w"&gt;                &lt;/span&gt;&lt;span class="n"&gt;stiff&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;row_glob&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;col_glob&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;stiff_loc&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;row&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_0a852d8e3ccb4f79ab27fd2decb9e2c2-18" name="rest_code_0a852d8e3ccb4f79ab27fd2decb9e2c2-18" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_0a852d8e3ccb4f79ab27fd2decb9e2c2-18"&gt;&lt;/a&gt;&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="k"&gt;end&lt;/span&gt;
&lt;a id="rest_code_0a852d8e3ccb4f79ab27fd2decb9e2c2-19" name="rest_code_0a852d8e3ccb4f79ab27fd2decb9e2c2-19" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_0a852d8e3ccb4f79ab27fd2decb9e2c2-19"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="k"&gt;end&lt;/span&gt;
&lt;a id="rest_code_0a852d8e3ccb4f79ab27fd2decb9e2c2-20" name="rest_code_0a852d8e3ccb4f79ab27fd2decb9e2c2-20" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_0a852d8e3ccb4f79ab27fd2decb9e2c2-20"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;end&lt;/span&gt;
&lt;a id="rest_code_0a852d8e3ccb4f79ab27fd2decb9e2c2-21" name="rest_code_0a852d8e3ccb4f79ab27fd2decb9e2c2-21" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_0a852d8e3ccb4f79ab27fd2decb9e2c2-21"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;return&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;stiff&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;rhs&lt;/span&gt;
&lt;a id="rest_code_0a852d8e3ccb4f79ab27fd2decb9e2c2-22" name="rest_code_0a852d8e3ccb4f79ab27fd2decb9e2c2-22" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_0a852d8e3ccb4f79ab27fd2decb9e2c2-22"&gt;&lt;/a&gt;&lt;span class="k"&gt;end&lt;/span&gt;
&lt;a id="rest_code_0a852d8e3ccb4f79ab27fd2decb9e2c2-23" name="rest_code_0a852d8e3ccb4f79ab27fd2decb9e2c2-23" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_0a852d8e3ccb4f79ab27fd2decb9e2c2-23"&gt;&lt;/a&gt;
&lt;a id="rest_code_0a852d8e3ccb4f79ab27fd2decb9e2c2-24" name="rest_code_0a852d8e3ccb4f79ab27fd2decb9e2c2-24" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_0a852d8e3ccb4f79ab27fd2decb9e2c2-24"&gt;&lt;/a&gt;
&lt;a id="rest_code_0a852d8e3ccb4f79ab27fd2decb9e2c2-25" name="rest_code_0a852d8e3ccb4f79ab27fd2decb9e2c2-25" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_0a852d8e3ccb4f79ab27fd2decb9e2c2-25"&gt;&lt;/a&gt;&lt;span class="k"&gt;function&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;local_stiff&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_0a852d8e3ccb4f79ab27fd2decb9e2c2-26" name="rest_code_0a852d8e3ccb4f79ab27fd2decb9e2c2-26" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_0a852d8e3ccb4f79ab27fd2decb9e2c2-26"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;dHdr&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_0a852d8e3ccb4f79ab27fd2decb9e2c2-27" name="rest_code_0a852d8e3ccb4f79ab27fd2decb9e2c2-27" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_0a852d8e3ccb4f79ab27fd2decb9e2c2-27"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;jaco&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;dHdr&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;
&lt;a id="rest_code_0a852d8e3ccb4f79ab27fd2decb9e2c2-28" name="rest_code_0a852d8e3ccb4f79ab27fd2decb9e2c2-28" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_0a852d8e3ccb4f79ab27fd2decb9e2c2-28"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;stiff&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;0.5&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_0a852d8e3ccb4f79ab27fd2decb9e2c2-29" name="rest_code_0a852d8e3ccb4f79ab27fd2decb9e2c2-29" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_0a852d8e3ccb4f79ab27fd2decb9e2c2-29"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;return&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;stiff&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;det&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;jaco&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;det&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;jaco&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_0a852d8e3ccb4f79ab27fd2decb9e2c2-30" name="rest_code_0a852d8e3ccb4f79ab27fd2decb9e2c2-30" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_0a852d8e3ccb4f79ab27fd2decb9e2c2-30"&gt;&lt;/a&gt;&lt;span class="k"&gt;end&lt;/span&gt;
&lt;a id="rest_code_0a852d8e3ccb4f79ab27fd2decb9e2c2-31" name="rest_code_0a852d8e3ccb4f79ab27fd2decb9e2c2-31" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_0a852d8e3ccb4f79ab27fd2decb9e2c2-31"&gt;&lt;/a&gt;
&lt;a id="rest_code_0a852d8e3ccb4f79ab27fd2decb9e2c2-32" name="rest_code_0a852d8e3ccb4f79ab27fd2decb9e2c2-32" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_0a852d8e3ccb4f79ab27fd2decb9e2c2-32"&gt;&lt;/a&gt;
&lt;a id="rest_code_0a852d8e3ccb4f79ab27fd2decb9e2c2-33" name="rest_code_0a852d8e3ccb4f79ab27fd2decb9e2c2-33" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_0a852d8e3ccb4f79ab27fd2decb9e2c2-33"&gt;&lt;/a&gt;&lt;span class="n"&gt;sq3&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;sqrt&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_0a852d8e3ccb4f79ab27fd2decb9e2c2-34" name="rest_code_0a852d8e3ccb4f79ab27fd2decb9e2c2-34" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_0a852d8e3ccb4f79ab27fd2decb9e2c2-34"&gt;&lt;/a&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;sq3&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;a id="rest_code_0a852d8e3ccb4f79ab27fd2decb9e2c2-35" name="rest_code_0a852d8e3ccb4f79ab27fd2decb9e2c2-35" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_0a852d8e3ccb4f79ab27fd2decb9e2c2-35"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;a id="rest_code_0a852d8e3ccb4f79ab27fd2decb9e2c2-36" name="rest_code_0a852d8e3ccb4f79ab27fd2decb9e2c2-36" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_0a852d8e3ccb4f79ab27fd2decb9e2c2-36"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;sq3&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;a id="rest_code_0a852d8e3ccb4f79ab27fd2decb9e2c2-37" name="rest_code_0a852d8e3ccb4f79ab27fd2decb9e2c2-37" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_0a852d8e3ccb4f79ab27fd2decb9e2c2-37"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;a id="rest_code_0a852d8e3ccb4f79ab27fd2decb9e2c2-38" name="rest_code_0a852d8e3ccb4f79ab27fd2decb9e2c2-38" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_0a852d8e3ccb4f79ab27fd2decb9e2c2-38"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;sq3&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;a id="rest_code_0a852d8e3ccb4f79ab27fd2decb9e2c2-39" name="rest_code_0a852d8e3ccb4f79ab27fd2decb9e2c2-39" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_0a852d8e3ccb4f79ab27fd2decb9e2c2-39"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;sq3&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;a id="rest_code_0a852d8e3ccb4f79ab27fd2decb9e2c2-40" name="rest_code_0a852d8e3ccb4f79ab27fd2decb9e2c2-40" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_0a852d8e3ccb4f79ab27fd2decb9e2c2-40"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;sq3&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_0a852d8e3ccb4f79ab27fd2decb9e2c2-41" name="rest_code_0a852d8e3ccb4f79ab27fd2decb9e2c2-41" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_0a852d8e3ccb4f79ab27fd2decb9e2c2-41"&gt;&lt;/a&gt;&lt;span class="n"&gt;elems&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;7&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;a id="rest_code_0a852d8e3ccb4f79ab27fd2decb9e2c2-42" name="rest_code_0a852d8e3ccb4f79ab27fd2decb9e2c2-42" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_0a852d8e3ccb4f79ab27fd2decb9e2c2-42"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;7&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;a id="rest_code_0a852d8e3ccb4f79ab27fd2decb9e2c2-43" name="rest_code_0a852d8e3ccb4f79ab27fd2decb9e2c2-43" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_0a852d8e3ccb4f79ab27fd2decb9e2c2-43"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;7&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;a id="rest_code_0a852d8e3ccb4f79ab27fd2decb9e2c2-44" name="rest_code_0a852d8e3ccb4f79ab27fd2decb9e2c2-44" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_0a852d8e3ccb4f79ab27fd2decb9e2c2-44"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;6&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;7&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;a id="rest_code_0a852d8e3ccb4f79ab27fd2decb9e2c2-45" name="rest_code_0a852d8e3ccb4f79ab27fd2decb9e2c2-45" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_0a852d8e3ccb4f79ab27fd2decb9e2c2-45"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="mi"&gt;6&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;7&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;a id="rest_code_0a852d8e3ccb4f79ab27fd2decb9e2c2-46" name="rest_code_0a852d8e3ccb4f79ab27fd2decb9e2c2-46" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_0a852d8e3ccb4f79ab27fd2decb9e2c2-46"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;7&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_0a852d8e3ccb4f79ab27fd2decb9e2c2-47" name="rest_code_0a852d8e3ccb4f79ab27fd2decb9e2c2-47" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_0a852d8e3ccb4f79ab27fd2decb9e2c2-47"&gt;&lt;/a&gt;&lt;span class="n"&gt;source&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;ones&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;7&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_0a852d8e3ccb4f79ab27fd2decb9e2c2-48" name="rest_code_0a852d8e3ccb4f79ab27fd2decb9e2c2-48" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_0a852d8e3ccb4f79ab27fd2decb9e2c2-48"&gt;&lt;/a&gt;&lt;span class="n"&gt;stiff&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;rhs&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;assem&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;elems&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;source&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_0a852d8e3ccb4f79ab27fd2decb9e2c2-49" name="rest_code_0a852d8e3ccb4f79ab27fd2decb9e2c2-49" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_0a852d8e3ccb4f79ab27fd2decb9e2c2-49"&gt;&lt;/a&gt;&lt;span class="n"&gt;free&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;6&lt;/span&gt;
&lt;a id="rest_code_0a852d8e3ccb4f79ab27fd2decb9e2c2-50" name="rest_code_0a852d8e3ccb4f79ab27fd2decb9e2c2-50" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_0a852d8e3ccb4f79ab27fd2decb9e2c2-50"&gt;&lt;/a&gt;&lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;stiff&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;free&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;free&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;\&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;rhs&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;free&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_0a852d8e3ccb4f79ab27fd2decb9e2c2-51" name="rest_code_0a852d8e3ccb4f79ab27fd2decb9e2c2-51" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_0a852d8e3ccb4f79ab27fd2decb9e2c2-51"&gt;&lt;/a&gt;&lt;span class="n"&gt;sol_c&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;size&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;)[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_0a852d8e3ccb4f79ab27fd2decb9e2c2-52" name="rest_code_0a852d8e3ccb4f79ab27fd2decb9e2c2-52" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_0a852d8e3ccb4f79ab27fd2decb9e2c2-52"&gt;&lt;/a&gt;&lt;span class="n"&gt;sol_c&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;free&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;sol&lt;/span&gt;
&lt;a id="rest_code_0a852d8e3ccb4f79ab27fd2decb9e2c2-53" name="rest_code_0a852d8e3ccb4f79ab27fd2decb9e2c2-53" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_0a852d8e3ccb4f79ab27fd2decb9e2c2-53"&gt;&lt;/a&gt;&lt;span class="n"&gt;tricontourf&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;sol_c&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;cmap&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;"hot"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_0a852d8e3ccb4f79ab27fd2decb9e2c2-54" name="rest_code_0a852d8e3ccb4f79ab27fd2decb9e2c2-54" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_0a852d8e3ccb4f79ab27fd2decb9e2c2-54"&gt;&lt;/a&gt;&lt;span class="n"&gt;colorbar&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a id="rest_code_0a852d8e3ccb4f79ab27fd2decb9e2c2-55" name="rest_code_0a852d8e3ccb4f79ab27fd2decb9e2c2-55" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_0a852d8e3ccb4f79ab27fd2decb9e2c2-55"&gt;&lt;/a&gt;&lt;span class="n"&gt;axis&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;"image"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_0a852d8e3ccb4f79ab27fd2decb9e2c2-56" name="rest_code_0a852d8e3ccb4f79ab27fd2decb9e2c2-56" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_0a852d8e3ccb4f79ab27fd2decb9e2c2-56"&gt;&lt;/a&gt;&lt;span class="n"&gt;show&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Both have the same result, as follows&lt;/p&gt;
&lt;img alt="Finite element method approximation." class="align-center" src="https://nicoguaro.github.io/images/FEM2D.svg" style="width: 500px;"&gt;
&lt;/section&gt;
&lt;section id="comparison-python-julia"&gt;
&lt;h3&gt;Comparison Python/Julia&lt;/h3&gt;
&lt;p&gt;Regarding number of lines we have: 51 in Python and 56 in Julia. The comparison
in execution time is done with &lt;code class="docutils literal"&gt;%timeit&lt;/code&gt; magic command in IPython and
&lt;code class="docutils literal"&gt;@benchmark&lt;/code&gt; in Julia. For the test we are just comparing the time it takes
to generate the matrices.&lt;/p&gt;
&lt;p&gt;For Python:&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code IPython"&gt;&lt;a id="rest_code_d081b0be39f142b6904ee8a77f074bdc-1" name="rest_code_d081b0be39f142b6904ee8a77f074bdc-1" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_d081b0be39f142b6904ee8a77f074bdc-1"&gt;&lt;/a&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="k"&gt;timeit&lt;/span&gt; assem(coords, elems, source)
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;with result&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code text"&gt;&lt;a id="rest_code_a3cf14ac0ccf4d53a38d34cab103d9de-1" name="rest_code_a3cf14ac0ccf4d53a38d34cab103d9de-1" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_a3cf14ac0ccf4d53a38d34cab103d9de-1"&gt;&lt;/a&gt;1000 loops, best of 3: 671 µs per loop
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;For Julia:&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code julia"&gt;&lt;a id="rest_code_2ca775a936e24e93a38197d3793f425e-1" name="rest_code_2ca775a936e24e93a38197d3793f425e-1" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_2ca775a936e24e93a38197d3793f425e-1"&gt;&lt;/a&gt;&lt;span class="nd"&gt;@benchmark&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;assem&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;elems&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;source&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;with result&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code julia"&gt;&lt;a id="rest_code_587da0081f704d2e9ddd42f2579e001f-1" name="rest_code_587da0081f704d2e9ddd42f2579e001f-1" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_587da0081f704d2e9ddd42f2579e001f-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;BenchmarkTools&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Trial&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
&lt;a id="rest_code_587da0081f704d2e9ddd42f2579e001f-2" name="rest_code_587da0081f704d2e9ddd42f2579e001f-2" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_587da0081f704d2e9ddd42f2579e001f-2"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;memory&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;estimate&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="mf"&gt;13.30&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;KiB&lt;/span&gt;
&lt;a id="rest_code_587da0081f704d2e9ddd42f2579e001f-3" name="rest_code_587da0081f704d2e9ddd42f2579e001f-3" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_587da0081f704d2e9ddd42f2579e001f-3"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;allocs&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;estimate&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="mi"&gt;179&lt;/span&gt;
&lt;a id="rest_code_587da0081f704d2e9ddd42f2579e001f-4" name="rest_code_587da0081f704d2e9ddd42f2579e001f-4" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_587da0081f704d2e9ddd42f2579e001f-4"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="o"&gt;--------------&lt;/span&gt;
&lt;a id="rest_code_587da0081f704d2e9ddd42f2579e001f-5" name="rest_code_587da0081f704d2e9ddd42f2579e001f-5" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_587da0081f704d2e9ddd42f2579e001f-5"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;minimum&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;     &lt;/span&gt;&lt;span class="mf"&gt;7.777&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;μs&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;0.00&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;GC&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_587da0081f704d2e9ddd42f2579e001f-6" name="rest_code_587da0081f704d2e9ddd42f2579e001f-6" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_587da0081f704d2e9ddd42f2579e001f-6"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;median&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="mf"&gt;8.934&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;μs&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;0.00&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;GC&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_587da0081f704d2e9ddd42f2579e001f-7" name="rest_code_587da0081f704d2e9ddd42f2579e001f-7" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_587da0081f704d2e9ddd42f2579e001f-7"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;mean&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="mf"&gt;10.810&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;μs&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;14.54&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;GC&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_587da0081f704d2e9ddd42f2579e001f-8" name="rest_code_587da0081f704d2e9ddd42f2579e001f-8" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_587da0081f704d2e9ddd42f2579e001f-8"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;maximum&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;     &lt;/span&gt;&lt;span class="mf"&gt;797.432&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;μs&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;95.85&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;GC&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_587da0081f704d2e9ddd42f2579e001f-9" name="rest_code_587da0081f704d2e9ddd42f2579e001f-9" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_587da0081f704d2e9ddd42f2579e001f-9"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="o"&gt;--------------&lt;/span&gt;
&lt;a id="rest_code_587da0081f704d2e9ddd42f2579e001f-10" name="rest_code_587da0081f704d2e9ddd42f2579e001f-10" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_587da0081f704d2e9ddd42f2579e001f-10"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;samples&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;          &lt;/span&gt;&lt;span class="mi"&gt;10000&lt;/span&gt;
&lt;a id="rest_code_587da0081f704d2e9ddd42f2579e001f-11" name="rest_code_587da0081f704d2e9ddd42f2579e001f-11" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_587da0081f704d2e9ddd42f2579e001f-11"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;evals&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;sample&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;     &lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;In this case, we can say that the Python code is about 70 times slower than
Julia code.&lt;/p&gt;
&lt;/section&gt;
&lt;/section&gt;</description><category>finite element method</category><category>julia</category><category>numerical methods</category><category>python</category><category>scientific computing</category><guid>https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/</guid><pubDate>Thu, 26 Oct 2017 02:41:53 GMT</pubDate></item><item><title>Numerical methods challenge: Day 24</title><link>https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/</link><dc:creator>Nicolás Guarín-Zapata</dc:creator><description>&lt;p&gt;During October (2017) I will write a program per day for some well-known
numerical methods in both Python and Julia. It is intended to be an exercise
then don't expect the code to be good enough for real use. Also,
I should mention that I have almost no experience with Julia, so it
probably won't be idiomatic Julia but more Python-like Julia.&lt;/p&gt;
&lt;section id="finite-element-method"&gt;
&lt;h2&gt;Finite element method&lt;/h2&gt;
&lt;p&gt;Today we have the &lt;a class="reference external" href="https://en.wikipedia.org/wiki/Finite_element_method"&gt;Finite element method&lt;/a&gt;
to solve the equation:&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
\frac{d^2 u}{dx^2} = f(x)
\end{equation*}
&lt;/div&gt;
&lt;p&gt;with&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
u(0) = u(1)  = 0
\end{equation*}
&lt;/div&gt;
&lt;p&gt;As in the &lt;a class="reference external" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/posts/numerical-23"&gt;Ritz method&lt;/a&gt; we form
a functional that is &lt;em&gt;equivalent&lt;/em&gt; to the
differential equation, propose an approximation as a linear combination of
a set of basis functions and find the &lt;em&gt;best&lt;/em&gt; set of coefficients for that
combination. That &lt;em&gt;best&lt;/em&gt; solution is found minimizing the functional.&lt;/p&gt;
&lt;p&gt;The functional for this differential equation is&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
\Pi[u] = -\int_{0}^{1} \left(\frac{d u}{d x}\right)^2 dx
         -\int_{0}^{1}  u f(x) dx
\end{equation*}
&lt;/div&gt;
&lt;p&gt;The main difference is that we use a piecewise interpolation for the basis
functions,&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
\hat{u}(x) = \sum_{n=0}^{N} u_n N_n(x)\, ,
\end{equation*}
&lt;/div&gt;
&lt;p&gt;this leads to the system of equations&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
[K]\{\mathbf{c}\} = \{\mathbf{b}\}
\end{equation*}
&lt;/div&gt;
&lt;p&gt;where the local stiffness matrices read&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
K_\text{local} =  \frac{1}{|J|}\begin{bmatrix} 2 &amp;amp; -2\\ -2 &amp;amp;2\end{bmatrix}
\end{equation*}
&lt;/div&gt;
&lt;p&gt;and&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
b_\text{local} = -|J|\begin{bmatrix} f(x_m)\\ f(x_{n})\end{bmatrix}\, ,
\end{equation*}
&lt;/div&gt;
&lt;p&gt;where &lt;span class="math"&gt;\(|J|\)&lt;/span&gt; is the Jacobian determinant of the transformation. I am
skipping a great deal about assembling, but it would be just too extensive
to describe the complete process.&lt;/p&gt;
&lt;p&gt;We will test the implementation with the function &lt;span class="math"&gt;\(f(x) = x^3\)&lt;/span&gt;, that
leads to the solution&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
u(x) = \frac{x (x^4 - 1)}{20}
\end{equation*}
&lt;/div&gt;
&lt;p&gt;Following are the codes.&lt;/p&gt;
&lt;section id="python"&gt;
&lt;h3&gt;Python&lt;/h3&gt;
&lt;div class="code"&gt;&lt;pre class="code python"&gt;&lt;a id="rest_code_fc078d8c936d45da948cdfa745530aad-1" name="rest_code_fc078d8c936d45da948cdfa745530aad-1" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_fc078d8c936d45da948cdfa745530aad-1"&gt;&lt;/a&gt;&lt;span class="kn"&gt;from&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nn"&gt;__future__&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;division&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;print_function&lt;/span&gt;
&lt;a id="rest_code_fc078d8c936d45da948cdfa745530aad-2" name="rest_code_fc078d8c936d45da948cdfa745530aad-2" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_fc078d8c936d45da948cdfa745530aad-2"&gt;&lt;/a&gt;&lt;span class="kn"&gt;import&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nn"&gt;numpy&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;as&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nn"&gt;np&lt;/span&gt;
&lt;a id="rest_code_fc078d8c936d45da948cdfa745530aad-3" name="rest_code_fc078d8c936d45da948cdfa745530aad-3" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_fc078d8c936d45da948cdfa745530aad-3"&gt;&lt;/a&gt;&lt;span class="kn"&gt;import&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nn"&gt;matplotlib.pyplot&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;as&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nn"&gt;plt&lt;/span&gt;
&lt;a id="rest_code_fc078d8c936d45da948cdfa745530aad-4" name="rest_code_fc078d8c936d45da948cdfa745530aad-4" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_fc078d8c936d45da948cdfa745530aad-4"&gt;&lt;/a&gt;
&lt;a id="rest_code_fc078d8c936d45da948cdfa745530aad-5" name="rest_code_fc078d8c936d45da948cdfa745530aad-5" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_fc078d8c936d45da948cdfa745530aad-5"&gt;&lt;/a&gt;
&lt;a id="rest_code_fc078d8c936d45da948cdfa745530aad-6" name="rest_code_fc078d8c936d45da948cdfa745530aad-6" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_fc078d8c936d45da948cdfa745530aad-6"&gt;&lt;/a&gt;&lt;span class="k"&gt;def&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nf"&gt;FEM1D&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;source&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_fc078d8c936d45da948cdfa745530aad-7" name="rest_code_fc078d8c936d45da948cdfa745530aad-7" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_fc078d8c936d45da948cdfa745530aad-7"&gt;&lt;/a&gt;    &lt;span class="n"&gt;N&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_fc078d8c936d45da948cdfa745530aad-8" name="rest_code_fc078d8c936d45da948cdfa745530aad-8" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_fc078d8c936d45da948cdfa745530aad-8"&gt;&lt;/a&gt;    &lt;span class="n"&gt;stiff_loc&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;([[&lt;/span&gt;&lt;span class="mf"&gt;2.0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;2.0&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;2.0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;2.0&lt;/span&gt;&lt;span class="p"&gt;]])&lt;/span&gt;
&lt;a id="rest_code_fc078d8c936d45da948cdfa745530aad-9" name="rest_code_fc078d8c936d45da948cdfa745530aad-9" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_fc078d8c936d45da948cdfa745530aad-9"&gt;&lt;/a&gt;    &lt;span class="n"&gt;eles&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="n"&gt;cont&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;cont&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;cont&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;N&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)]&lt;/span&gt;
&lt;a id="rest_code_fc078d8c936d45da948cdfa745530aad-10" name="rest_code_fc078d8c936d45da948cdfa745530aad-10" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_fc078d8c936d45da948cdfa745530aad-10"&gt;&lt;/a&gt;    &lt;span class="n"&gt;stiff&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_fc078d8c936d45da948cdfa745530aad-11" name="rest_code_fc078d8c936d45da948cdfa745530aad-11" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_fc078d8c936d45da948cdfa745530aad-11"&gt;&lt;/a&gt;    &lt;span class="n"&gt;rhs&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_fc078d8c936d45da948cdfa745530aad-12" name="rest_code_fc078d8c936d45da948cdfa745530aad-12" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_fc078d8c936d45da948cdfa745530aad-12"&gt;&lt;/a&gt;    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;ele&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;eles&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a id="rest_code_fc078d8c936d45da948cdfa745530aad-13" name="rest_code_fc078d8c936d45da948cdfa745530aad-13" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_fc078d8c936d45da948cdfa745530aad-13"&gt;&lt;/a&gt;        &lt;span class="n"&gt;jaco&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ele&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]]&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ele&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]]&lt;/span&gt;
&lt;a id="rest_code_fc078d8c936d45da948cdfa745530aad-14" name="rest_code_fc078d8c936d45da948cdfa745530aad-14" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_fc078d8c936d45da948cdfa745530aad-14"&gt;&lt;/a&gt;        &lt;span class="n"&gt;rhs&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ele&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;rhs&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ele&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;jaco&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;source&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ele&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_fc078d8c936d45da948cdfa745530aad-15" name="rest_code_fc078d8c936d45da948cdfa745530aad-15" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_fc078d8c936d45da948cdfa745530aad-15"&gt;&lt;/a&gt;        &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;cont1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;row&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;enumerate&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ele&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_fc078d8c936d45da948cdfa745530aad-16" name="rest_code_fc078d8c936d45da948cdfa745530aad-16" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_fc078d8c936d45da948cdfa745530aad-16"&gt;&lt;/a&gt;            &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;cont2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;col&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;enumerate&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ele&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_fc078d8c936d45da948cdfa745530aad-17" name="rest_code_fc078d8c936d45da948cdfa745530aad-17" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_fc078d8c936d45da948cdfa745530aad-17"&gt;&lt;/a&gt;                &lt;span class="n"&gt;stiff&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;row&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;stiff&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;row&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt;  &lt;span class="n"&gt;stiff_loc&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;cont1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;cont2&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;jaco&lt;/span&gt;
&lt;a id="rest_code_fc078d8c936d45da948cdfa745530aad-18" name="rest_code_fc078d8c936d45da948cdfa745530aad-18" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_fc078d8c936d45da948cdfa745530aad-18"&gt;&lt;/a&gt;    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;stiff&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;rhs&lt;/span&gt;
&lt;a id="rest_code_fc078d8c936d45da948cdfa745530aad-19" name="rest_code_fc078d8c936d45da948cdfa745530aad-19" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_fc078d8c936d45da948cdfa745530aad-19"&gt;&lt;/a&gt;
&lt;a id="rest_code_fc078d8c936d45da948cdfa745530aad-20" name="rest_code_fc078d8c936d45da948cdfa745530aad-20" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_fc078d8c936d45da948cdfa745530aad-20"&gt;&lt;/a&gt;
&lt;a id="rest_code_fc078d8c936d45da948cdfa745530aad-21" name="rest_code_fc078d8c936d45da948cdfa745530aad-21" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_fc078d8c936d45da948cdfa745530aad-21"&gt;&lt;/a&gt;&lt;span class="n"&gt;N&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;100&lt;/span&gt;
&lt;a id="rest_code_fc078d8c936d45da948cdfa745530aad-22" name="rest_code_fc078d8c936d45da948cdfa745530aad-22" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_fc078d8c936d45da948cdfa745530aad-22"&gt;&lt;/a&gt;&lt;span class="n"&gt;fun&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;lambda&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;
&lt;a id="rest_code_fc078d8c936d45da948cdfa745530aad-23" name="rest_code_fc078d8c936d45da948cdfa745530aad-23" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_fc078d8c936d45da948cdfa745530aad-23"&gt;&lt;/a&gt;&lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;linspace&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_fc078d8c936d45da948cdfa745530aad-24" name="rest_code_fc078d8c936d45da948cdfa745530aad-24" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_fc078d8c936d45da948cdfa745530aad-24"&gt;&lt;/a&gt;&lt;span class="n"&gt;stiff&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;rhs&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;FEM1D&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;fun&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_fc078d8c936d45da948cdfa745530aad-25" name="rest_code_fc078d8c936d45da948cdfa745530aad-25" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_fc078d8c936d45da948cdfa745530aad-25"&gt;&lt;/a&gt;&lt;span class="n"&gt;sol&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_fc078d8c936d45da948cdfa745530aad-26" name="rest_code_fc078d8c936d45da948cdfa745530aad-26" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_fc078d8c936d45da948cdfa745530aad-26"&gt;&lt;/a&gt;&lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;linalg&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;solve&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;stiff&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;rhs&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_fc078d8c936d45da948cdfa745530aad-27" name="rest_code_fc078d8c936d45da948cdfa745530aad-27" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_fc078d8c936d45da948cdfa745530aad-27"&gt;&lt;/a&gt;
&lt;a id="rest_code_fc078d8c936d45da948cdfa745530aad-28" name="rest_code_fc078d8c936d45da948cdfa745530aad-28" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_fc078d8c936d45da948cdfa745530aad-28"&gt;&lt;/a&gt;
&lt;a id="rest_code_fc078d8c936d45da948cdfa745530aad-29" name="rest_code_fc078d8c936d45da948cdfa745530aad-29" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_fc078d8c936d45da948cdfa745530aad-29"&gt;&lt;/a&gt;&lt;span class="c1"&gt;#%% Plotting&lt;/span&gt;
&lt;a id="rest_code_fc078d8c936d45da948cdfa745530aad-30" name="rest_code_fc078d8c936d45da948cdfa745530aad-30" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_fc078d8c936d45da948cdfa745530aad-30"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;figure&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;figsize&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_fc078d8c936d45da948cdfa745530aad-31" name="rest_code_fc078d8c936d45da948cdfa745530aad-31" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_fc078d8c936d45da948cdfa745530aad-31"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;plot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_fc078d8c936d45da948cdfa745530aad-32" name="rest_code_fc078d8c936d45da948cdfa745530aad-32" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_fc078d8c936d45da948cdfa745530aad-32"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;plot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="mi"&gt;20&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;linestyle&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;"dashed"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_fc078d8c936d45da948cdfa745530aad-33" name="rest_code_fc078d8c936d45da948cdfa745530aad-33" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_fc078d8c936d45da948cdfa745530aad-33"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="sa"&gt;r&lt;/span&gt;&lt;span class="s2"&gt;"$x$"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_fc078d8c936d45da948cdfa745530aad-34" name="rest_code_fc078d8c936d45da948cdfa745530aad-34" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_fc078d8c936d45da948cdfa745530aad-34"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ylabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="sa"&gt;r&lt;/span&gt;&lt;span class="s2"&gt;"$y$"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_fc078d8c936d45da948cdfa745530aad-35" name="rest_code_fc078d8c936d45da948cdfa745530aad-35" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_fc078d8c936d45da948cdfa745530aad-35"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;legend&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="s2"&gt;"FEM solution"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;"Exact solution"&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_fc078d8c936d45da948cdfa745530aad-36" name="rest_code_fc078d8c936d45da948cdfa745530aad-36" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_fc078d8c936d45da948cdfa745530aad-36"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;tight_layout&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a id="rest_code_fc078d8c936d45da948cdfa745530aad-37" name="rest_code_fc078d8c936d45da948cdfa745530aad-37" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_fc078d8c936d45da948cdfa745530aad-37"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;show&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/section&gt;
&lt;section id="julia"&gt;
&lt;h3&gt;Julia&lt;/h3&gt;
&lt;div class="code"&gt;&lt;pre class="code julia"&gt;&lt;a id="rest_code_60b9cd0c5ee34f5a9654c9d2c232cb3f-1" name="rest_code_60b9cd0c5ee34f5a9654c9d2c232cb3f-1" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_60b9cd0c5ee34f5a9654c9d2c232cb3f-1"&gt;&lt;/a&gt;&lt;span class="k"&gt;using&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;PyPlot&lt;/span&gt;
&lt;a id="rest_code_60b9cd0c5ee34f5a9654c9d2c232cb3f-2" name="rest_code_60b9cd0c5ee34f5a9654c9d2c232cb3f-2" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_60b9cd0c5ee34f5a9654c9d2c232cb3f-2"&gt;&lt;/a&gt;
&lt;a id="rest_code_60b9cd0c5ee34f5a9654c9d2c232cb3f-3" name="rest_code_60b9cd0c5ee34f5a9654c9d2c232cb3f-3" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_60b9cd0c5ee34f5a9654c9d2c232cb3f-3"&gt;&lt;/a&gt;
&lt;a id="rest_code_60b9cd0c5ee34f5a9654c9d2c232cb3f-4" name="rest_code_60b9cd0c5ee34f5a9654c9d2c232cb3f-4" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_60b9cd0c5ee34f5a9654c9d2c232cb3f-4"&gt;&lt;/a&gt;&lt;span class="k"&gt;function&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;FEM1D&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;source&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_60b9cd0c5ee34f5a9654c9d2c232cb3f-5" name="rest_code_60b9cd0c5ee34f5a9654c9d2c232cb3f-5" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_60b9cd0c5ee34f5a9654c9d2c232cb3f-5"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;length&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_60b9cd0c5ee34f5a9654c9d2c232cb3f-6" name="rest_code_60b9cd0c5ee34f5a9654c9d2c232cb3f-6" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_60b9cd0c5ee34f5a9654c9d2c232cb3f-6"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;stiff_loc&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mf"&gt;2.0&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;2.0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;2.0&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;2.0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_60b9cd0c5ee34f5a9654c9d2c232cb3f-7" name="rest_code_60b9cd0c5ee34f5a9654c9d2c232cb3f-7" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_60b9cd0c5ee34f5a9654c9d2c232cb3f-7"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;eles&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;[[&lt;/span&gt;&lt;span class="n"&gt;cont&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;cont&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;for&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;cont&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;in&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_60b9cd0c5ee34f5a9654c9d2c232cb3f-8" name="rest_code_60b9cd0c5ee34f5a9654c9d2c232cb3f-8" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_60b9cd0c5ee34f5a9654c9d2c232cb3f-8"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;stiff&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_60b9cd0c5ee34f5a9654c9d2c232cb3f-9" name="rest_code_60b9cd0c5ee34f5a9654c9d2c232cb3f-9" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_60b9cd0c5ee34f5a9654c9d2c232cb3f-9"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;rhs&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_60b9cd0c5ee34f5a9654c9d2c232cb3f-10" name="rest_code_60b9cd0c5ee34f5a9654c9d2c232cb3f-10" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_60b9cd0c5ee34f5a9654c9d2c232cb3f-10"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;for&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ele&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;in&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;eles&lt;/span&gt;
&lt;a id="rest_code_60b9cd0c5ee34f5a9654c9d2c232cb3f-11" name="rest_code_60b9cd0c5ee34f5a9654c9d2c232cb3f-11" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_60b9cd0c5ee34f5a9654c9d2c232cb3f-11"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;jaco&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ele&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;]]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ele&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]]&lt;/span&gt;
&lt;a id="rest_code_60b9cd0c5ee34f5a9654c9d2c232cb3f-12" name="rest_code_60b9cd0c5ee34f5a9654c9d2c232cb3f-12" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_60b9cd0c5ee34f5a9654c9d2c232cb3f-12"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;rhs&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ele&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;rhs&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ele&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;jaco&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;source&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ele&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_60b9cd0c5ee34f5a9654c9d2c232cb3f-13" name="rest_code_60b9cd0c5ee34f5a9654c9d2c232cb3f-13" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_60b9cd0c5ee34f5a9654c9d2c232cb3f-13"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;stiff&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ele&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ele&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;stiff&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ele&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ele&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;stiff_loc&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;jaco&lt;/span&gt;
&lt;a id="rest_code_60b9cd0c5ee34f5a9654c9d2c232cb3f-14" name="rest_code_60b9cd0c5ee34f5a9654c9d2c232cb3f-14" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_60b9cd0c5ee34f5a9654c9d2c232cb3f-14"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;end&lt;/span&gt;
&lt;a id="rest_code_60b9cd0c5ee34f5a9654c9d2c232cb3f-15" name="rest_code_60b9cd0c5ee34f5a9654c9d2c232cb3f-15" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_60b9cd0c5ee34f5a9654c9d2c232cb3f-15"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;return&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;stiff&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;rhs&lt;/span&gt;
&lt;a id="rest_code_60b9cd0c5ee34f5a9654c9d2c232cb3f-16" name="rest_code_60b9cd0c5ee34f5a9654c9d2c232cb3f-16" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_60b9cd0c5ee34f5a9654c9d2c232cb3f-16"&gt;&lt;/a&gt;&lt;span class="k"&gt;end&lt;/span&gt;
&lt;a id="rest_code_60b9cd0c5ee34f5a9654c9d2c232cb3f-17" name="rest_code_60b9cd0c5ee34f5a9654c9d2c232cb3f-17" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_60b9cd0c5ee34f5a9654c9d2c232cb3f-17"&gt;&lt;/a&gt;
&lt;a id="rest_code_60b9cd0c5ee34f5a9654c9d2c232cb3f-18" name="rest_code_60b9cd0c5ee34f5a9654c9d2c232cb3f-18" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_60b9cd0c5ee34f5a9654c9d2c232cb3f-18"&gt;&lt;/a&gt;
&lt;a id="rest_code_60b9cd0c5ee34f5a9654c9d2c232cb3f-19" name="rest_code_60b9cd0c5ee34f5a9654c9d2c232cb3f-19" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_60b9cd0c5ee34f5a9654c9d2c232cb3f-19"&gt;&lt;/a&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;100&lt;/span&gt;
&lt;a id="rest_code_60b9cd0c5ee34f5a9654c9d2c232cb3f-20" name="rest_code_60b9cd0c5ee34f5a9654c9d2c232cb3f-20" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_60b9cd0c5ee34f5a9654c9d2c232cb3f-20"&gt;&lt;/a&gt;&lt;span class="n"&gt;fun&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;.^&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;
&lt;a id="rest_code_60b9cd0c5ee34f5a9654c9d2c232cb3f-21" name="rest_code_60b9cd0c5ee34f5a9654c9d2c232cb3f-21" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_60b9cd0c5ee34f5a9654c9d2c232cb3f-21"&gt;&lt;/a&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;linspace&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_60b9cd0c5ee34f5a9654c9d2c232cb3f-22" name="rest_code_60b9cd0c5ee34f5a9654c9d2c232cb3f-22" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_60b9cd0c5ee34f5a9654c9d2c232cb3f-22"&gt;&lt;/a&gt;&lt;span class="n"&gt;stiff&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;rhs&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;FEM1D&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;fun&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_60b9cd0c5ee34f5a9654c9d2c232cb3f-23" name="rest_code_60b9cd0c5ee34f5a9654c9d2c232cb3f-23" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_60b9cd0c5ee34f5a9654c9d2c232cb3f-23"&gt;&lt;/a&gt;&lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_60b9cd0c5ee34f5a9654c9d2c232cb3f-24" name="rest_code_60b9cd0c5ee34f5a9654c9d2c232cb3f-24" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_60b9cd0c5ee34f5a9654c9d2c232cb3f-24"&gt;&lt;/a&gt;&lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="k"&gt;end&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;stiff&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="k"&gt;end&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="k"&gt;end&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;\&lt;/span&gt;&lt;span class="n"&gt;rhs&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="k"&gt;end&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_60b9cd0c5ee34f5a9654c9d2c232cb3f-25" name="rest_code_60b9cd0c5ee34f5a9654c9d2c232cb3f-25" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_60b9cd0c5ee34f5a9654c9d2c232cb3f-25"&gt;&lt;/a&gt;
&lt;a id="rest_code_60b9cd0c5ee34f5a9654c9d2c232cb3f-26" name="rest_code_60b9cd0c5ee34f5a9654c9d2c232cb3f-26" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_60b9cd0c5ee34f5a9654c9d2c232cb3f-26"&gt;&lt;/a&gt;
&lt;a id="rest_code_60b9cd0c5ee34f5a9654c9d2c232cb3f-27" name="rest_code_60b9cd0c5ee34f5a9654c9d2c232cb3f-27" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_60b9cd0c5ee34f5a9654c9d2c232cb3f-27"&gt;&lt;/a&gt;&lt;span class="c"&gt;#%% Plotting&lt;/span&gt;
&lt;a id="rest_code_60b9cd0c5ee34f5a9654c9d2c232cb3f-28" name="rest_code_60b9cd0c5ee34f5a9654c9d2c232cb3f-28" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_60b9cd0c5ee34f5a9654c9d2c232cb3f-28"&gt;&lt;/a&gt;&lt;span class="n"&gt;figure&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;figsize&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_60b9cd0c5ee34f5a9654c9d2c232cb3f-29" name="rest_code_60b9cd0c5ee34f5a9654c9d2c232cb3f-29" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_60b9cd0c5ee34f5a9654c9d2c232cb3f-29"&gt;&lt;/a&gt;&lt;span class="n"&gt;plot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_60b9cd0c5ee34f5a9654c9d2c232cb3f-30" name="rest_code_60b9cd0c5ee34f5a9654c9d2c232cb3f-30" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_60b9cd0c5ee34f5a9654c9d2c232cb3f-30"&gt;&lt;/a&gt;&lt;span class="n"&gt;plot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;.*&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;.^&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="mi"&gt;20&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;linestyle&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;"dashed"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_60b9cd0c5ee34f5a9654c9d2c232cb3f-31" name="rest_code_60b9cd0c5ee34f5a9654c9d2c232cb3f-31" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_60b9cd0c5ee34f5a9654c9d2c232cb3f-31"&gt;&lt;/a&gt;&lt;span class="n"&gt;xlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="sa"&gt;L&lt;/span&gt;&lt;span class="s"&gt;"&lt;/span&gt;&lt;span class="si"&gt;$x&lt;/span&gt;&lt;span class="s"&gt;$"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_60b9cd0c5ee34f5a9654c9d2c232cb3f-32" name="rest_code_60b9cd0c5ee34f5a9654c9d2c232cb3f-32" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_60b9cd0c5ee34f5a9654c9d2c232cb3f-32"&gt;&lt;/a&gt;&lt;span class="n"&gt;ylabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="sa"&gt;L&lt;/span&gt;&lt;span class="s"&gt;"&lt;/span&gt;&lt;span class="si"&gt;$y&lt;/span&gt;&lt;span class="s"&gt;$"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_60b9cd0c5ee34f5a9654c9d2c232cb3f-33" name="rest_code_60b9cd0c5ee34f5a9654c9d2c232cb3f-33" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_60b9cd0c5ee34f5a9654c9d2c232cb3f-33"&gt;&lt;/a&gt;&lt;span class="n"&gt;legend&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="s"&gt;"FEM solution"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s"&gt;"Exact solution"&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_60b9cd0c5ee34f5a9654c9d2c232cb3f-34" name="rest_code_60b9cd0c5ee34f5a9654c9d2c232cb3f-34" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_60b9cd0c5ee34f5a9654c9d2c232cb3f-34"&gt;&lt;/a&gt;&lt;span class="n"&gt;tight_layout&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a id="rest_code_60b9cd0c5ee34f5a9654c9d2c232cb3f-35" name="rest_code_60b9cd0c5ee34f5a9654c9d2c232cb3f-35" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_60b9cd0c5ee34f5a9654c9d2c232cb3f-35"&gt;&lt;/a&gt;&lt;span class="n"&gt;show&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Both have the same result, as follows&lt;/p&gt;
&lt;img alt="Finite element method approximation." class="align-center" src="https://nicoguaro.github.io/images/FEM1D.svg" style="width: 400px;"&gt;
&lt;/section&gt;
&lt;section id="comparison-python-julia"&gt;
&lt;h3&gt;Comparison Python/Julia&lt;/h3&gt;
&lt;p&gt;Regarding number of lines we have: 37 in Python and 35 in Julia. The comparison
in execution time is done with &lt;code class="docutils literal"&gt;%timeit&lt;/code&gt; magic command in IPython and
&lt;code class="docutils literal"&gt;@benchmark&lt;/code&gt; in Julia. For the test we are just comparing the time it takes
to generate the matrices.&lt;/p&gt;
&lt;p&gt;For Python:&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code IPython"&gt;&lt;a id="rest_code_62da64177ea94c719cd3a9241c5149dc-1" name="rest_code_62da64177ea94c719cd3a9241c5149dc-1" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_62da64177ea94c719cd3a9241c5149dc-1"&gt;&lt;/a&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="k"&gt;timeit&lt;/span&gt; FEM1D(x, fun)
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;with result&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code text"&gt;&lt;a id="rest_code_afab42cb41404274a38aa0a66993bacd-1" name="rest_code_afab42cb41404274a38aa0a66993bacd-1" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_afab42cb41404274a38aa0a66993bacd-1"&gt;&lt;/a&gt;100 loops, best of 3: 2.15 ms per loop
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;For Julia:&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code julia"&gt;&lt;a id="rest_code_21449ab9103d4892b4d2e9d12702bdb2-1" name="rest_code_21449ab9103d4892b4d2e9d12702bdb2-1" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_21449ab9103d4892b4d2e9d12702bdb2-1"&gt;&lt;/a&gt;&lt;span class="nd"&gt;@benchmark&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;FEM1D&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;fun&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;with result&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code julia"&gt;&lt;a id="rest_code_9fbbd1f2b2414ccb82be216a07feb38d-1" name="rest_code_9fbbd1f2b2414ccb82be216a07feb38d-1" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_9fbbd1f2b2414ccb82be216a07feb38d-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;BenchmarkTools&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Trial&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
&lt;a id="rest_code_9fbbd1f2b2414ccb82be216a07feb38d-2" name="rest_code_9fbbd1f2b2414ccb82be216a07feb38d-2" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_9fbbd1f2b2414ccb82be216a07feb38d-2"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;memory&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;estimate&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="mf"&gt;183.73&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;KiB&lt;/span&gt;
&lt;a id="rest_code_9fbbd1f2b2414ccb82be216a07feb38d-3" name="rest_code_9fbbd1f2b2414ccb82be216a07feb38d-3" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_9fbbd1f2b2414ccb82be216a07feb38d-3"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;allocs&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;estimate&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="mi"&gt;1392&lt;/span&gt;
&lt;a id="rest_code_9fbbd1f2b2414ccb82be216a07feb38d-4" name="rest_code_9fbbd1f2b2414ccb82be216a07feb38d-4" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_9fbbd1f2b2414ccb82be216a07feb38d-4"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="o"&gt;--------------&lt;/span&gt;
&lt;a id="rest_code_9fbbd1f2b2414ccb82be216a07feb38d-5" name="rest_code_9fbbd1f2b2414ccb82be216a07feb38d-5" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_9fbbd1f2b2414ccb82be216a07feb38d-5"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;minimum&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;     &lt;/span&gt;&lt;span class="mf"&gt;60.045&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;μs&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;0.00&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;GC&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_9fbbd1f2b2414ccb82be216a07feb38d-6" name="rest_code_9fbbd1f2b2414ccb82be216a07feb38d-6" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_9fbbd1f2b2414ccb82be216a07feb38d-6"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;median&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="mf"&gt;70.445&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;μs&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;0.00&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;GC&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_9fbbd1f2b2414ccb82be216a07feb38d-7" name="rest_code_9fbbd1f2b2414ccb82be216a07feb38d-7" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_9fbbd1f2b2414ccb82be216a07feb38d-7"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;mean&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="mf"&gt;98.276&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;μs&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;25.64&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;GC&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_9fbbd1f2b2414ccb82be216a07feb38d-8" name="rest_code_9fbbd1f2b2414ccb82be216a07feb38d-8" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_9fbbd1f2b2414ccb82be216a07feb38d-8"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;maximum&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;     &lt;/span&gt;&lt;span class="mf"&gt;4.269&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ms&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;96.70&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;GC&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_9fbbd1f2b2414ccb82be216a07feb38d-9" name="rest_code_9fbbd1f2b2414ccb82be216a07feb38d-9" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_9fbbd1f2b2414ccb82be216a07feb38d-9"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="o"&gt;--------------&lt;/span&gt;
&lt;a id="rest_code_9fbbd1f2b2414ccb82be216a07feb38d-10" name="rest_code_9fbbd1f2b2414ccb82be216a07feb38d-10" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_9fbbd1f2b2414ccb82be216a07feb38d-10"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;samples&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;          &lt;/span&gt;&lt;span class="mi"&gt;10000&lt;/span&gt;
&lt;a id="rest_code_9fbbd1f2b2414ccb82be216a07feb38d-11" name="rest_code_9fbbd1f2b2414ccb82be216a07feb38d-11" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_9fbbd1f2b2414ccb82be216a07feb38d-11"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;evals&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;sample&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;     &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;In this case, we can say that the Python code is roughly 30 times slower than
Julia code.&lt;/p&gt;
&lt;/section&gt;
&lt;/section&gt;</description><category>finite element method</category><category>julia</category><category>numerical methods</category><category>python</category><category>scientific computing</category><guid>https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/</guid><pubDate>Tue, 24 Oct 2017 20:17:58 GMT</pubDate></item><item><title>Solution of the Schrödinger equation using Ritz method</title><link>https://nicoguaro.github.io/posts/hermite_ritz_qm/</link><dc:creator>Nicolás Guarín-Zapata</dc:creator><description>&lt;p&gt;In this post, we describe the solution of the Schrödinger equation
using the Ritz method and
&lt;a class="reference external" href="https://en.wikipedia.org/wiki/Hermite_polynomials#Hermite_functions"&gt;Hermite functions&lt;/a&gt;
basis. This basis seems to be a good choice for the 1D Schrödinger equation
since its an orthogonal basis over &lt;span class="math"&gt;\((-\infty, \infty)\)&lt;/span&gt;.&lt;/p&gt;
&lt;section id="transforming-the-equation-to-an-algebraic-one"&gt;
&lt;h2&gt;Transforming the equation to an algebraic one&lt;/h2&gt;
&lt;p&gt;We want so solve the time-independent
&lt;a class="reference external" href="https://en.wikipedia.org/wiki/Schr%C3%B6dinger_equation"&gt;Schrödinger equation&lt;/a&gt;&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
\left[-\frac{1}{2}\nabla^2 + V(x)\right] \psi = E\psi\, ,
\end{equation*}
&lt;/div&gt;
&lt;p&gt;where we are using
&lt;a class="reference external" href="https://en.wikipedia.org/wiki/Natural_units"&gt;natural units&lt;/a&gt;
since they are a good choice for numeric calculations.&lt;/p&gt;
&lt;p&gt;Solving this equation is equivalent to solve the following
variational equation&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
\delta \Pi[\psi] = 0\, ,
\end{equation*}
&lt;/div&gt;
&lt;p&gt;with&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
\Pi[\psi] = \frac{1}{2} \langle \nabla \psi, \nabla\psi\rangle +
              \langle \psi, V(x) \psi\rangle -
               E\langle \psi, \psi\rangle \, ,
\end{equation*}
&lt;/div&gt;
&lt;p&gt;being &lt;span class="math"&gt;\(\psi\)&lt;/span&gt; the wave function, &lt;span class="math"&gt;\(V(x)\)&lt;/span&gt; the potential and
&lt;span class="math"&gt;\(E\)&lt;/span&gt; the energy. This variational formulation is equivalent to the
time-independent Schrödinger equation, and &lt;span class="math"&gt;\(E\)&lt;/span&gt; works as a Lagrange
multiplier to enforce that the probability over the whole domain is 1.&lt;/p&gt;
&lt;p&gt;We can expand the wave function in an orthonormal basis, namely&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
\psi = \sum_{n=0}^N c_n u_n(x)\, ,
\end{equation*}
&lt;/div&gt;
&lt;p&gt;where &lt;span class="math"&gt;\(u_n(x) \equiv \mu_n H_n(x) e^{-x^2/2}\)&lt;/span&gt; is a normalized
Hermite function, &lt;span class="math"&gt;\(\mu_n\)&lt;/span&gt; is the inverse of magnitude of the
&lt;span class="math"&gt;\(n\)&lt;/span&gt;-th Hermite polynomial&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
\mu_n = \frac{1}{\sqrt{\pi^{1/2} n! 2^n}}\, ,
\end{equation*}
&lt;/div&gt;
&lt;p&gt;and &lt;span class="math"&gt;\(c_n\)&lt;/span&gt; are the coefficients of the expansion. This
representation is exact in the limit &lt;span class="math"&gt;\(N \rightarrow \infty\)&lt;/span&gt;.&lt;/p&gt;
&lt;p&gt;If we replace the expansion in the functional, we obtain&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
\Pi_N = \sum_{m=0}^N\sum_{n=0}^N c_m c_n\left[
          \frac{1}{2} \langle \nabla u_m, \nabla u_n\rangle +
          \langle u_m, V(x) u_n\rangle -
          E^N \delta_{mn}\right]\, .
\end{equation*}
&lt;/div&gt;
&lt;p&gt;The integrand of the integral involving the two derivatives reads&lt;/p&gt;
&lt;div class="math"&gt;
\begin{align*}
u_m' u_n' =&amp;amp; \left[2m \frac{\mu_{m-1}}{\mu_m}u_{m-1} - x u_m\right]
            \left[2n \frac{\mu_{n-1}}{\mu_n}u_{n-1} - x u_n\right]\\
          =&amp;amp; 4mn\frac{\mu_{m-1} \mu_{n-1}}{\mu_m \mu_n} u_{n-1} u_{m-1}
           - 2m\frac{\mu_{m-1}}{\mu_{m}}x u_{m-1} u_n\\
           &amp;amp;- 2n\frac{\mu_{n-1}}{\mu_{n}}x u_{n-1} u_m + x^2 u_m u_n
\end{align*}
&lt;/div&gt;
&lt;p&gt;Thus, the kinetic energy term reads&lt;/p&gt;
&lt;div class="math"&gt;
\begin{align*}
\langle \nabla u_m, \nabla u_n \rangle =&amp;amp;
    4mn\frac{\mu_{m-1} \mu_{n-1}}{\mu_m \mu_n} \langle u_{n-1}, u_{m-1}\rangle
    - 2m\frac{\mu_{m-1}}{\mu_{m}} \langle u_{m-1}, x u_n\rangle\\
    &amp;amp;- 2n\frac{\mu_{n-1}}{\mu_{n}} \langle u_{m}, x u_{n - 1}\rangle
     + \langle u_m, x^2 u_n\rangle\\
    =&amp;amp; 4mn \frac{\mu_{m-1}^2}{\mu_m^2}\delta_{mn} -
      2m \frac{\mu_{m-1}}{\mu_m} \alpha_{m-1, n} -
      2n \frac{\mu_{n-1}}{\mu_n} \alpha_{m, n-1} + \beta_{mn} \, ,
\end{align*}
&lt;/div&gt;
&lt;p&gt;with&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
\alpha_{m,n} \equiv \langle u_{m}, x u_n\rangle = \begin{cases}
\sqrt{\frac{n + 1}{2}} &amp;amp; m=n +1\\
\sqrt{\frac{n}{2}} &amp;amp; m=n - 1\\
0 &amp;amp; \text{otherwise}\end{cases}\, ,
\end{equation*}
&lt;/div&gt;
&lt;p&gt;and&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
\beta_{m,n} \equiv \langle u_{m}, x^2 u_n\rangle = \begin{cases}
\frac{\sqrt{n(n-1)}}{2} &amp;amp; m = n - 2\\
\frac{2n + 1}{2} &amp;amp; m = n \\
\frac{\sqrt{(n+1)(n+1)}}{2} &amp;amp; m = n + 2 \\
0 &amp;amp; \text{otherwise}\end{cases}\, .
\end{equation*}
&lt;/div&gt;
&lt;p&gt;The functional is rewritten as&lt;/p&gt;
&lt;div class="math"&gt;
\begin{align*}
\Pi_N =&amp;amp; \sum_{m=0}^N \sum_{n=0}^N c_m c_n
  \left[2mn \frac{\mu^2_{m-1}}{\mu^2_m}\delta_{mn}
  - m\frac{\mu_{m-1}}{\mu_m}\alpha_{m - 1, n}
  - n\frac{\mu_{n-1}}{\mu_n}\delta_{m, n-1} \right.\nonumber \\
  &amp;amp;\left. - \frac{1}{2}\beta_{mn} + \langle u_m, V(x) u_n\rangle
  - E^N \delta_{mn}\right] \, .
\end{align*}
&lt;/div&gt;
&lt;p&gt;Taking the variation&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
\delta \Pi_N = 0\, ,
\end{equation*}
&lt;/div&gt;
&lt;p&gt;that in this case is equivalent to&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
\frac{\partial \Pi_N}{\partial c_i} = 0\quad \forall i=0, 1, \cdots N\, ,
\end{equation*}
&lt;/div&gt;
&lt;p&gt;yields to&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
[H]\lbrace c\rbrace = E^N\lbrace c\rbrace \, ,
\end{equation*}
&lt;/div&gt;
&lt;p&gt;where the components of the matrix &lt;span class="math"&gt;\([H]\)&lt;/span&gt; are given by&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
H_{mn} = 2mn \frac{\mu^2_{m-1}}{\mu^2_m}\delta_{mn}
  - m\frac{\mu_{m-1}}{\mu_m}\alpha_{m - 1, n}
  - n\frac{\mu_{n-1}}{\mu_n}\delta_{m, n-1}
  - \frac{1}{2}\beta_{mn} + \langle u_m, V(x) u_n\rangle\, .
\end{equation*}
&lt;/div&gt;
&lt;p&gt;The last integral can be computed using
&lt;a class="reference external" href="https://en.wikipedia.org/wiki/Gauss%E2%80%93Hermite_quadrature"&gt;Gauss-Hermite quadrature&lt;/a&gt;.
And we will need more Gauss points if we want to integrate higher-order
polynomials. This method would work fine for functions that can be
approximated by polynomials.&lt;/p&gt;
&lt;/section&gt;
&lt;section id="examples"&gt;
&lt;h2&gt;Examples&lt;/h2&gt;
&lt;p&gt;A Python implementation of this method is presented in
&lt;a class="reference external" href="https://github.com/nicoguaro/FEM_resources/blob/master/quantum_mechanics/hermite_QM.py"&gt;this repo&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;For all the examples we use the following imports&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code ipython"&gt;&lt;a id="rest_code_dec44032821743c9a98afd4f0d7ecb29-1" name="rest_code_dec44032821743c9a98afd4f0d7ecb29-1" href="https://nicoguaro.github.io/posts/hermite_ritz_qm/#rest_code_dec44032821743c9a98afd4f0d7ecb29-1"&gt;&lt;/a&gt;&lt;span class="kn"&gt;from&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nn"&gt;__future__&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;division&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;print_function&lt;/span&gt;
&lt;a id="rest_code_dec44032821743c9a98afd4f0d7ecb29-2" name="rest_code_dec44032821743c9a98afd4f0d7ecb29-2" href="https://nicoguaro.github.io/posts/hermite_ritz_qm/#rest_code_dec44032821743c9a98afd4f0d7ecb29-2"&gt;&lt;/a&gt;&lt;span class="kn"&gt;import&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nn"&gt;numpy&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;as&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nn"&gt;np&lt;/span&gt;
&lt;a id="rest_code_dec44032821743c9a98afd4f0d7ecb29-3" name="rest_code_dec44032821743c9a98afd4f0d7ecb29-3" href="https://nicoguaro.github.io/posts/hermite_ritz_qm/#rest_code_dec44032821743c9a98afd4f0d7ecb29-3"&gt;&lt;/a&gt;&lt;span class="kn"&gt;from&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nn"&gt;hermite_QM&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;section id="quantum-harmonic-oscilator-1"&gt;
&lt;h3&gt;&lt;a class="reference external" href="https://en.wikipedia.org/wiki/Quantum_harmonic_oscillator"&gt;Quantum harmonic oscilator&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;In this case the (normalized) potential is given by&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
V(x) = \frac{1}{2} x^2
\end{equation*}
&lt;/div&gt;
&lt;p&gt;and the exact normalized eigenvalues are given by&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
E_n = n + \frac{1}{2}
\end{equation*}
&lt;/div&gt;
&lt;p&gt;The following snippet computes the first 10 eigenvalues and plot
the corresponding eigenstates&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code ipython"&gt;&lt;a id="rest_code_f3f4ceaee90d406faae501dc5f4f79fe-1" name="rest_code_f3f4ceaee90d406faae501dc5f4f79fe-1" href="https://nicoguaro.github.io/posts/hermite_ritz_qm/#rest_code_f3f4ceaee90d406faae501dc5f4f79fe-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;potential&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;lambda&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="mf"&gt;0.5&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;
&lt;a id="rest_code_f3f4ceaee90d406faae501dc5f4f79fe-2" name="rest_code_f3f4ceaee90d406faae501dc5f4f79fe-2" href="https://nicoguaro.github.io/posts/hermite_ritz_qm/#rest_code_f3f4ceaee90d406faae501dc5f4f79fe-2"&gt;&lt;/a&gt;&lt;span class="n"&gt;vals&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;vecs&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;eigenstates&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;potential&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;nterms&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;11&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;ngpts&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;12&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_f3f4ceaee90d406faae501dc5f4f79fe-3" name="rest_code_f3f4ceaee90d406faae501dc5f4f79fe-3" href="https://nicoguaro.github.io/posts/hermite_ritz_qm/#rest_code_f3f4ceaee90d406faae501dc5f4f79fe-3"&gt;&lt;/a&gt;&lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;round&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;vals&lt;/span&gt;&lt;span class="p"&gt;[:&lt;/span&gt;&lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="mi"&gt;6&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_f3f4ceaee90d406faae501dc5f4f79fe-4" name="rest_code_f3f4ceaee90d406faae501dc5f4f79fe-4" href="https://nicoguaro.github.io/posts/hermite_ritz_qm/#rest_code_f3f4ceaee90d406faae501dc5f4f79fe-4"&gt;&lt;/a&gt;&lt;span class="n"&gt;fig&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;ax&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;subplots&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_f3f4ceaee90d406faae501dc5f4f79fe-5" name="rest_code_f3f4ceaee90d406faae501dc5f4f79fe-5" href="https://nicoguaro.github.io/posts/hermite_ritz_qm/#rest_code_f3f4ceaee90d406faae501dc5f4f79fe-5"&gt;&lt;/a&gt;&lt;span class="n"&gt;plot_eigenstates&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;vals&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;vecs&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;potential&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;with results&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code text"&gt;&lt;a id="rest_code_35d059720e184d78aef1f3ee71cfda90-1" name="rest_code_35d059720e184d78aef1f3ee71cfda90-1" href="https://nicoguaro.github.io/posts/hermite_ritz_qm/#rest_code_35d059720e184d78aef1f3ee71cfda90-1"&gt;&lt;/a&gt;[ 0.5  1.5  2.5  3.5  4.5  5.5  6.5  7.5  8.5  9.5]
&lt;/pre&gt;&lt;/div&gt;
&lt;img alt="/images/hermite_ritz_harmonic.svg" src="https://nicoguaro.github.io/images/hermite_ritz_harmonic.svg"&gt;
&lt;/section&gt;
&lt;section id="absolute-value-potential"&gt;
&lt;h3&gt;Absolute value potential&lt;/h3&gt;
&lt;div class="code"&gt;&lt;pre class="code ipython"&gt;&lt;a id="rest_code_238f1d86d68d4e5ab2816c3f6ef33cac-1" name="rest_code_238f1d86d68d4e5ab2816c3f6ef33cac-1" href="https://nicoguaro.github.io/posts/hermite_ritz_qm/#rest_code_238f1d86d68d4e5ab2816c3f6ef33cac-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;potential&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;lambda&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;abs&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_238f1d86d68d4e5ab2816c3f6ef33cac-2" name="rest_code_238f1d86d68d4e5ab2816c3f6ef33cac-2" href="https://nicoguaro.github.io/posts/hermite_ritz_qm/#rest_code_238f1d86d68d4e5ab2816c3f6ef33cac-2"&gt;&lt;/a&gt;&lt;span class="n"&gt;vals&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;vecs&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;eigenstates&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;potential&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_238f1d86d68d4e5ab2816c3f6ef33cac-3" name="rest_code_238f1d86d68d4e5ab2816c3f6ef33cac-3" href="https://nicoguaro.github.io/posts/hermite_ritz_qm/#rest_code_238f1d86d68d4e5ab2816c3f6ef33cac-3"&gt;&lt;/a&gt;&lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;round&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;vals&lt;/span&gt;&lt;span class="p"&gt;[:&lt;/span&gt;&lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="mi"&gt;6&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_238f1d86d68d4e5ab2816c3f6ef33cac-4" name="rest_code_238f1d86d68d4e5ab2816c3f6ef33cac-4" href="https://nicoguaro.github.io/posts/hermite_ritz_qm/#rest_code_238f1d86d68d4e5ab2816c3f6ef33cac-4"&gt;&lt;/a&gt;&lt;span class="n"&gt;fig&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;ax&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;subplots&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_238f1d86d68d4e5ab2816c3f6ef33cac-5" name="rest_code_238f1d86d68d4e5ab2816c3f6ef33cac-5" href="https://nicoguaro.github.io/posts/hermite_ritz_qm/#rest_code_238f1d86d68d4e5ab2816c3f6ef33cac-5"&gt;&lt;/a&gt;&lt;span class="n"&gt;plot_eigenstates&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;vals&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;vecs&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;potential&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;lims&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;8&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;8&lt;/span&gt;&lt;span class="p"&gt;));&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;with results&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code text"&gt;&lt;a id="rest_code_e0e6dc06919a414abbd26ac585c3d781-1" name="rest_code_e0e6dc06919a414abbd26ac585c3d781-1" href="https://nicoguaro.github.io/posts/hermite_ritz_qm/#rest_code_e0e6dc06919a414abbd26ac585c3d781-1"&gt;&lt;/a&gt;[ 0.811203  1.855725  2.57894   3.244576  3.826353  4.38189   4.895365
&lt;a id="rest_code_e0e6dc06919a414abbd26ac585c3d781-2" name="rest_code_e0e6dc06919a414abbd26ac585c3d781-2" href="https://nicoguaro.github.io/posts/hermite_ritz_qm/#rest_code_e0e6dc06919a414abbd26ac585c3d781-2"&gt;&lt;/a&gt;  5.396614  5.911591  6.421015]
&lt;/pre&gt;&lt;/div&gt;
&lt;img alt="/images/hermite_ritz_abs.svg" src="https://nicoguaro.github.io/images/hermite_ritz_abs.svg"&gt;
&lt;/section&gt;
&lt;section id="cubic-potential"&gt;
&lt;h3&gt;Cubic potential&lt;/h3&gt;
&lt;div class="code"&gt;&lt;pre class="code ipython"&gt;&lt;a id="rest_code_792c1864a02142e98c87729d4bb31f00-1" name="rest_code_792c1864a02142e98c87729d4bb31f00-1" href="https://nicoguaro.github.io/posts/hermite_ritz_qm/#rest_code_792c1864a02142e98c87729d4bb31f00-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;potential&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;lambda&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;abs&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;
&lt;a id="rest_code_792c1864a02142e98c87729d4bb31f00-2" name="rest_code_792c1864a02142e98c87729d4bb31f00-2" href="https://nicoguaro.github.io/posts/hermite_ritz_qm/#rest_code_792c1864a02142e98c87729d4bb31f00-2"&gt;&lt;/a&gt;&lt;span class="n"&gt;vals&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;vecs&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;eigenstates&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;potential&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_792c1864a02142e98c87729d4bb31f00-3" name="rest_code_792c1864a02142e98c87729d4bb31f00-3" href="https://nicoguaro.github.io/posts/hermite_ritz_qm/#rest_code_792c1864a02142e98c87729d4bb31f00-3"&gt;&lt;/a&gt;&lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;round&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;vals&lt;/span&gt;&lt;span class="p"&gt;[:&lt;/span&gt;&lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="mi"&gt;6&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_792c1864a02142e98c87729d4bb31f00-4" name="rest_code_792c1864a02142e98c87729d4bb31f00-4" href="https://nicoguaro.github.io/posts/hermite_ritz_qm/#rest_code_792c1864a02142e98c87729d4bb31f00-4"&gt;&lt;/a&gt;&lt;span class="n"&gt;fig&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;ax&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;subplots&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_792c1864a02142e98c87729d4bb31f00-5" name="rest_code_792c1864a02142e98c87729d4bb31f00-5" href="https://nicoguaro.github.io/posts/hermite_ritz_qm/#rest_code_792c1864a02142e98c87729d4bb31f00-5"&gt;&lt;/a&gt;&lt;span class="n"&gt;plot_eigenstates&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;vals&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;vecs&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;potential&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;lims&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;6&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;6&lt;/span&gt;&lt;span class="p"&gt;));&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;with results&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code text"&gt;&lt;a id="rest_code_3663a916212d4e588ea32feff3ee4dfc-1" name="rest_code_3663a916212d4e588ea32feff3ee4dfc-1" href="https://nicoguaro.github.io/posts/hermite_ritz_qm/#rest_code_3663a916212d4e588ea32feff3ee4dfc-1"&gt;&lt;/a&gt;[ 0.180588  0.609153  1.124594  1.681002  2.272087  2.889805  3.530901
&lt;a id="rest_code_3663a916212d4e588ea32feff3ee4dfc-2" name="rest_code_3663a916212d4e588ea32feff3ee4dfc-2" href="https://nicoguaro.github.io/posts/hermite_ritz_qm/#rest_code_3663a916212d4e588ea32feff3ee4dfc-2"&gt;&lt;/a&gt;  4.191962  4.871133  5.566413]
&lt;/pre&gt;&lt;/div&gt;
&lt;img alt="/images/hermite_ritz_cubic.svg" src="https://nicoguaro.github.io/images/hermite_ritz_cubic.svg"&gt;
&lt;/section&gt;
&lt;section id="harmonic-with-quartic-perturbation"&gt;
&lt;h3&gt;Harmonic with quartic perturbation&lt;/h3&gt;
&lt;div class="code"&gt;&lt;pre class="code ipython"&gt;&lt;a id="rest_code_44552ca9755c4ad0b6e533d9686ebd41-1" name="rest_code_44552ca9755c4ad0b6e533d9686ebd41-1" href="https://nicoguaro.github.io/posts/hermite_ritz_qm/#rest_code_44552ca9755c4ad0b6e533d9686ebd41-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;potential&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;lambda&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="mf"&gt;0.5&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mf"&gt;0.1&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;
&lt;a id="rest_code_44552ca9755c4ad0b6e533d9686ebd41-2" name="rest_code_44552ca9755c4ad0b6e533d9686ebd41-2" href="https://nicoguaro.github.io/posts/hermite_ritz_qm/#rest_code_44552ca9755c4ad0b6e533d9686ebd41-2"&gt;&lt;/a&gt;&lt;span class="n"&gt;vals&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;vecs&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;eigenstates&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;potential&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;nterms&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;20&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;ngpts&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;22&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_44552ca9755c4ad0b6e533d9686ebd41-3" name="rest_code_44552ca9755c4ad0b6e533d9686ebd41-3" href="https://nicoguaro.github.io/posts/hermite_ritz_qm/#rest_code_44552ca9755c4ad0b6e533d9686ebd41-3"&gt;&lt;/a&gt;&lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;round&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;vals&lt;/span&gt;&lt;span class="p"&gt;[:&lt;/span&gt;&lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="mi"&gt;6&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_44552ca9755c4ad0b6e533d9686ebd41-4" name="rest_code_44552ca9755c4ad0b6e533d9686ebd41-4" href="https://nicoguaro.github.io/posts/hermite_ritz_qm/#rest_code_44552ca9755c4ad0b6e533d9686ebd41-4"&gt;&lt;/a&gt;&lt;span class="n"&gt;fig&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;ax&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;subplots&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_44552ca9755c4ad0b6e533d9686ebd41-5" name="rest_code_44552ca9755c4ad0b6e533d9686ebd41-5" href="https://nicoguaro.github.io/posts/hermite_ritz_qm/#rest_code_44552ca9755c4ad0b6e533d9686ebd41-5"&gt;&lt;/a&gt;&lt;span class="n"&gt;plot_eigenstates&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;vals&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;vecs&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;potential&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;lims&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;with results&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code text"&gt;&lt;a id="rest_code_d15be4f7d51742a9aa4f4f5e5d59f085-1" name="rest_code_d15be4f7d51742a9aa4f4f5e5d59f085-1" href="https://nicoguaro.github.io/posts/hermite_ritz_qm/#rest_code_d15be4f7d51742a9aa4f4f5e5d59f085-1"&gt;&lt;/a&gt;[  0.559146   1.769503   3.138624   4.628884   6.220303   7.899789
&lt;a id="rest_code_d15be4f7d51742a9aa4f4f5e5d59f085-2" name="rest_code_d15be4f7d51742a9aa4f4f5e5d59f085-2" href="https://nicoguaro.github.io/posts/hermite_ritz_qm/#rest_code_d15be4f7d51742a9aa4f4f5e5d59f085-2"&gt;&lt;/a&gt;   9.658703  11.489094  13.38638   15.361055]
&lt;/pre&gt;&lt;/div&gt;
&lt;img alt="/images/hermite_ritz_pert_harm.svg" src="https://nicoguaro.github.io/images/hermite_ritz_pert_harm.svg"&gt;
&lt;p&gt;A Jupyter Notebook with the examples can be found
&lt;a class="reference external" href="https://github.com/nicoguaro/FEM_resources/blob/master/quantum_mechanics/Ritz_Hermite_QM.ipynb"&gt;here&lt;/a&gt;.&lt;/p&gt;
&lt;/section&gt;
&lt;/section&gt;</description><category>finite element method</category><category>Hermite polynomials</category><category>quantum mechanics</category><category>variational methods</category><guid>https://nicoguaro.github.io/posts/hermite_ritz_qm/</guid><pubDate>Wed, 12 Jul 2017 00:04:57 GMT</pubDate></item><item><title>Piecewise Hermite interpolation</title><link>https://nicoguaro.github.io/posts/hermite_interp/</link><dc:creator>Nicolás Guarín-Zapata</dc:creator><description>&lt;p&gt;In this post, we find the Hermite interpolation functions for the
domain [-1, 1]. And then, we use it for a pieciwise interpolation. Notice
that this interpolation has &lt;span class="math"&gt;\(C^1\)&lt;/span&gt; continuity compared to the
&lt;span class="math"&gt;\(C^0\)&lt;/span&gt; continuity that is common in Lagrange interpolation.&lt;/p&gt;
&lt;p&gt;To compute the polynomials explicitly we use &lt;cite&gt;sympy&lt;/cite&gt;.&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code ipython2"&gt;&lt;a id="rest_code_e71779986ec242658abf41800bc28e3f-1" name="rest_code_e71779986ec242658abf41800bc28e3f-1" href="https://nicoguaro.github.io/posts/hermite_interp/#rest_code_e71779986ec242658abf41800bc28e3f-1"&gt;&lt;/a&gt;&lt;span class="kn"&gt;from&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nn"&gt;__future__&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;division&lt;/span&gt;
&lt;a id="rest_code_e71779986ec242658abf41800bc28e3f-2" name="rest_code_e71779986ec242658abf41800bc28e3f-2" href="https://nicoguaro.github.io/posts/hermite_interp/#rest_code_e71779986ec242658abf41800bc28e3f-2"&gt;&lt;/a&gt;&lt;span class="kn"&gt;import&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nn"&gt;numpy&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;as&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nn"&gt;np&lt;/span&gt;
&lt;a id="rest_code_e71779986ec242658abf41800bc28e3f-3" name="rest_code_e71779986ec242658abf41800bc28e3f-3" href="https://nicoguaro.github.io/posts/hermite_interp/#rest_code_e71779986ec242658abf41800bc28e3f-3"&gt;&lt;/a&gt;&lt;span class="kn"&gt;import&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nn"&gt;sympy&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;as&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nn"&gt;sym&lt;/span&gt;
&lt;a id="rest_code_e71779986ec242658abf41800bc28e3f-4" name="rest_code_e71779986ec242658abf41800bc28e3f-4" href="https://nicoguaro.github.io/posts/hermite_interp/#rest_code_e71779986ec242658abf41800bc28e3f-4"&gt;&lt;/a&gt;&lt;span class="kn"&gt;import&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nn"&gt;matplotlib.pyplot&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;as&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nn"&gt;plt&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;We want to find a set of basis function that satisfy the following&lt;/p&gt;
&lt;div class="math"&gt;
\begin{align*}
N_1(x_1) &amp;amp;= 1\\
N_1(x_2) &amp;amp;= 0\\
N_2(x_1) &amp;amp;= 1\\
N_2(x_2) &amp;amp;= 0\\
N'_3(x_1) &amp;amp;= 1\\
N'_3(x_2) &amp;amp;= 0\\
N'_4(x_1) &amp;amp;= 1\\
N'_4(x_2) &amp;amp;= 0
\end{align*}
&lt;/div&gt;
&lt;p&gt;These can be written as&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
\begin{bmatrix}
1 &amp;amp;x_1 &amp;amp;x_1^2 &amp;amp;x_1^3\\
1 &amp;amp;x_2 &amp;amp;x_2^2 &amp;amp;x_2^3\\
0 &amp;amp;1 &amp;amp;2x_1 &amp;amp;3x_1^2\\
0 &amp;amp;1 &amp;amp;2x_2 &amp;amp;3x_2^2
\end{bmatrix}
\begin{bmatrix}
a_{11} &amp;amp;a_{12} &amp;amp;a_{13} &amp;amp;a_{14}\\
a_{21} &amp;amp;a_{22} &amp;amp;a_{23} &amp;amp;a_{24}\\
a_{31} &amp;amp;a_{32} &amp;amp;a_{33} &amp;amp;a_{34}\\
a_{41} &amp;amp;a_{42} &amp;amp;a_{43} &amp;amp;a_{44}
\end{bmatrix} =
\begin{bmatrix}
1 &amp;amp;0 &amp;amp;0 &amp;amp;0\\
0 &amp;amp;1 &amp;amp;0 &amp;amp;0\\
0 &amp;amp;0 &amp;amp;1 &amp;amp;0\\
0 &amp;amp;0 &amp;amp;0 &amp;amp;1
\end{bmatrix}
\end{equation*}
&lt;/div&gt;
&lt;p&gt;The formula for interpolation would be&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
f(x) \approx N_1(x) u_1 + N_2(x) u_2 + |J|(N_3(x) u'_3 + N_4(x) u'_4)\quad \forall x\in [a, b]
\end{equation*}
&lt;/div&gt;
&lt;p&gt;with &lt;span class="math"&gt;\(|J| = (b - a)/2\)&lt;/span&gt; the Jacobian determinant of the
transformation.&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code ipython2"&gt;&lt;a id="rest_code_3f09104f8b9543379e74a625c6a09008-1" name="rest_code_3f09104f8b9543379e74a625c6a09008-1" href="https://nicoguaro.github.io/posts/hermite_interp/#rest_code_3f09104f8b9543379e74a625c6a09008-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;x1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;x2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;sym&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;symbols&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"x1 x2 x"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_3f09104f8b9543379e74a625c6a09008-2" name="rest_code_3f09104f8b9543379e74a625c6a09008-2" href="https://nicoguaro.github.io/posts/hermite_interp/#rest_code_3f09104f8b9543379e74a625c6a09008-2"&gt;&lt;/a&gt;&lt;span class="n"&gt;V&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;sym&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Matrix&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;
&lt;a id="rest_code_3f09104f8b9543379e74a625c6a09008-3" name="rest_code_3f09104f8b9543379e74a625c6a09008-3" href="https://nicoguaro.github.io/posts/hermite_interp/#rest_code_3f09104f8b9543379e74a625c6a09008-3"&gt;&lt;/a&gt;    &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;x1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;x1&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;x1&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;
&lt;a id="rest_code_3f09104f8b9543379e74a625c6a09008-4" name="rest_code_3f09104f8b9543379e74a625c6a09008-4" href="https://nicoguaro.github.io/posts/hermite_interp/#rest_code_3f09104f8b9543379e74a625c6a09008-4"&gt;&lt;/a&gt;    &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;x2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;x2&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;x2&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;
&lt;a id="rest_code_3f09104f8b9543379e74a625c6a09008-5" name="rest_code_3f09104f8b9543379e74a625c6a09008-5" href="https://nicoguaro.github.io/posts/hermite_interp/#rest_code_3f09104f8b9543379e74a625c6a09008-5"&gt;&lt;/a&gt;    &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;x1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;x1&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;
&lt;a id="rest_code_3f09104f8b9543379e74a625c6a09008-6" name="rest_code_3f09104f8b9543379e74a625c6a09008-6" href="https://nicoguaro.github.io/posts/hermite_interp/#rest_code_3f09104f8b9543379e74a625c6a09008-6"&gt;&lt;/a&gt;    &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;x2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;x2&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;]])&lt;/span&gt;
&lt;a id="rest_code_3f09104f8b9543379e74a625c6a09008-7" name="rest_code_3f09104f8b9543379e74a625c6a09008-7" href="https://nicoguaro.github.io/posts/hermite_interp/#rest_code_3f09104f8b9543379e74a625c6a09008-7"&gt;&lt;/a&gt;&lt;span class="n"&gt;V&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="math"&gt;
\begin{equation*}
\left[\begin{matrix}1 &amp;amp; x_{1} &amp;amp; x_{1}^{2} &amp;amp; x_{1}^{3}\\
1 &amp;amp; x_{2} &amp;amp; x_{2}^{2} &amp;amp; x_{2}^{3}\\
0 &amp;amp; 1 &amp;amp; 2 x_{1} &amp;amp; 3 x_{1}^{2}\\
0 &amp;amp; 1 &amp;amp; 2 x_{2} &amp;amp; 3 x_{2}^{2}\end{matrix}\right]
\end{equation*}
&lt;/div&gt;
&lt;p&gt;We can see that the previous matrix is a  confluent Vandermonder matrix &lt;a class="brackets" href="https://nicoguaro.github.io/posts/hermite_interp/#footnote-1" id="footnote-reference-1" role="doc-noteref"&gt;&lt;span class="fn-bracket"&gt;[&lt;/span&gt;1&lt;span class="fn-bracket"&gt;]&lt;/span&gt;&lt;/a&gt;.
It is similar to a Vandermonde matrix for the first &lt;span class="math"&gt;\(n\)&lt;/span&gt; nodes
and the derivatives of each row for the following ones.&lt;/p&gt;
&lt;p&gt;The coefficients for our polynomials are given by the inverse of this matrix.&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code ipython2"&gt;&lt;a id="rest_code_df9eddf212e140f2b472b8e95a0c52f4-1" name="rest_code_df9eddf212e140f2b472b8e95a0c52f4-1" href="https://nicoguaro.github.io/posts/hermite_interp/#rest_code_df9eddf212e140f2b472b8e95a0c52f4-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;sym&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;simplify&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;V&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;inv&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="math"&gt;
\begin{equation*}
\left[\begin{matrix}\frac{x_{2}^{2} \left(3 x_{1} - x_{2}\right)}{x_{1}^{3} - 3 x_{1}^{2} x_{2} + 3 x_{1} x_{2}^{2} - x_{2}^{3}} &amp;amp; \frac{x_{1}^{2} \left(x_{1} - 3 x_{2}\right)}{x_{1}^{3} - 3 x_{1}^{2} x_{2} + 3 x_{1} x_{2}^{2} - x_{2}^{3}} &amp;amp; - \frac{x_{1} x_{2}^{2}}{x_{1}^{2} - 2 x_{1} x_{2} + x_{2}^{2}} &amp;amp; - \frac{x_{1}^{2} x_{2}}{x_{1}^{2} - 2 x_{1} x_{2} + x_{2}^{2}}\\- \frac{6 x_{1} x_{2}}{x_{1}^{3} - 3 x_{1}^{2} x_{2} + 3 x_{1} x_{2}^{2} - x_{2}^{3}} &amp;amp; \frac{6 x_{1} x_{2}}{x_{1}^{3} - 3 x_{1}^{2} x_{2} + 3 x_{1} x_{2}^{2} - x_{2}^{3}} &amp;amp; \frac{x_{2} \left(2 x_{1} + x_{2}\right)}{x_{1}^{2} - 2 x_{1} x_{2} + x_{2}^{2}} &amp;amp; \frac{x_{1} \left(x_{1} + 2 x_{2}\right)}{x_{1}^{2} - 2 x_{1} x_{2} + x_{2}^{2}}\\\frac{3 x_{1} + 3 x_{2}}{x_{1}^{3} - 3 x_{1}^{2} x_{2} + 3 x_{1} x_{2}^{2} - x_{2}^{3}} &amp;amp; - \frac{3 x_{1} + 3 x_{2}}{x_{1}^{3} - 3 x_{1}^{2} x_{2} + 3 x_{1} x_{2}^{2} - x_{2}^{3}} &amp;amp; - \frac{x_{1} + 2 x_{2}}{x_{1}^{2} - 2 x_{1} x_{2} + x_{2}^{2}} &amp;amp; - \frac{2 x_{1} + x_{2}}{x_{1}^{2} - 2 x_{1} x_{2} + x_{2}^{2}}\\- \frac{2}{x_{1}^{3} - 3 x_{1}^{2} x_{2} + 3 x_{1} x_{2}^{2} - x_{2}^{3}} &amp;amp; \frac{2}{x_{1}^{3} - 3 x_{1}^{2} x_{2} + 3 x_{1} x_{2}^{2} - x_{2}^{3}} &amp;amp; \frac{1}{x_{1}^{2} - 2 x_{1} x_{2} + x_{2}^{2}} &amp;amp; \frac{1}{x_{1}^{2} - 2 x_{1} x_{2} + x_{2}^{2}}\end{matrix}\right]
\end{equation*}
&lt;/div&gt;
&lt;p&gt;And we replace the values for the extreme nodes, -1 and 1.&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code ipython2"&gt;&lt;a id="rest_code_c6cf93e450b24e4ab4df1b33267d66e2-1" name="rest_code_c6cf93e450b24e4ab4df1b33267d66e2-1" href="https://nicoguaro.github.io/posts/hermite_interp/#rest_code_c6cf93e450b24e4ab4df1b33267d66e2-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;V_inv&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;sym&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;simplify&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;V&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;subs&lt;/span&gt;&lt;span class="p"&gt;({&lt;/span&gt;&lt;span class="n"&gt;x1&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;x2&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;})&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;inv&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt;
&lt;a id="rest_code_c6cf93e450b24e4ab4df1b33267d66e2-2" name="rest_code_c6cf93e450b24e4ab4df1b33267d66e2-2" href="https://nicoguaro.github.io/posts/hermite_interp/#rest_code_c6cf93e450b24e4ab4df1b33267d66e2-2"&gt;&lt;/a&gt;&lt;span class="n"&gt;V_inv&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="math"&gt;
\begin{equation*}
\left[\begin{matrix}\frac{1}{2} &amp;amp; \frac{1}{2} &amp;amp; \frac{1}{4} &amp;amp; - \frac{1}{4}\\
- \frac{3}{4} &amp;amp; \frac{3}{4} &amp;amp; - \frac{1}{4} &amp;amp; - \frac{1}{4}\\
0 &amp;amp; 0 &amp;amp; - \frac{1}{4} &amp;amp; \frac{1}{4}\\
\frac{1}{4} &amp;amp; - \frac{1}{4} &amp;amp; \frac{1}{4} &amp;amp; \frac{1}{4}\end{matrix}\right]
\end{equation*}
&lt;/div&gt;
&lt;p&gt;The polynomials are the product of the coefficients and the monomials&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code ipython2"&gt;&lt;a id="rest_code_2180f72021c948e5addd75b65dfb2af8-1" name="rest_code_2180f72021c948e5addd75b65dfb2af8-1" href="https://nicoguaro.github.io/posts/hermite_interp/#rest_code_2180f72021c948e5addd75b65dfb2af8-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;sym&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;factor&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;V_inv&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;T&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;sym&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Matrix&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;]))&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="math"&gt;
\begin{equation*}
\left[\begin{matrix}\frac{1}{4} \left(x - 1\right)^{2} \left(x + 2\right)\\- \frac{1}{4} \left(x - 2\right) \left(x + 1\right)^{2}\\\frac{1}{4} \left(x - 1\right)^{2} \left(x + 1\right)\\\frac{1}{4} \left(x - 1\right) \left(x + 1\right)^{2}\end{matrix}\right]
\end{equation*}
&lt;/div&gt;
&lt;p&gt;The interpolation basis would be&lt;/p&gt;
&lt;div class="math"&gt;
\begin{align*}
N_1 (x) &amp;amp;= \frac{1}{4} (x - 1)^2 (2 + x)\\
N_2 (x) &amp;amp;= \frac{1}{4} (x + 1)^2 (2 - x)\\
N_3 (x) &amp;amp;= \frac{1}{4} (x - 1)^2 (x + 1)\\
N_4 (x) &amp;amp;= \frac{1}{4} (x + 1)^2 (x - 1)\, ,
\end{align*}
&lt;/div&gt;
&lt;p&gt;and the following function computes the interpolation for a given
function and derivative&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code ipython2"&gt;&lt;a id="rest_code_c994663375f84b938ce8b3facffc7c6e-1" name="rest_code_c994663375f84b938ce8b3facffc7c6e-1" href="https://nicoguaro.github.io/posts/hermite_interp/#rest_code_c994663375f84b938ce8b3facffc7c6e-1"&gt;&lt;/a&gt;&lt;span class="k"&gt;def&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nf"&gt;hermite_interp&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;fun&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;grad&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;x0&lt;/span&gt;&lt;span class="o"&gt;=-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;x1&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;npts&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;101&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_c994663375f84b938ce8b3facffc7c6e-2" name="rest_code_c994663375f84b938ce8b3facffc7c6e-2" href="https://nicoguaro.github.io/posts/hermite_interp/#rest_code_c994663375f84b938ce8b3facffc7c6e-2"&gt;&lt;/a&gt;    &lt;span class="n"&gt;jaco&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x1&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;x0&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;
&lt;a id="rest_code_c994663375f84b938ce8b3facffc7c6e-3" name="rest_code_c994663375f84b938ce8b3facffc7c6e-3" href="https://nicoguaro.github.io/posts/hermite_interp/#rest_code_c994663375f84b938ce8b3facffc7c6e-3"&gt;&lt;/a&gt;    &lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;linspace&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;npts&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_c994663375f84b938ce8b3facffc7c6e-4" name="rest_code_c994663375f84b938ce8b3facffc7c6e-4" href="https://nicoguaro.github.io/posts/hermite_interp/#rest_code_c994663375f84b938ce8b3facffc7c6e-4"&gt;&lt;/a&gt;    &lt;span class="n"&gt;f1&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;fun&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x0&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_c994663375f84b938ce8b3facffc7c6e-5" name="rest_code_c994663375f84b938ce8b3facffc7c6e-5" href="https://nicoguaro.github.io/posts/hermite_interp/#rest_code_c994663375f84b938ce8b3facffc7c6e-5"&gt;&lt;/a&gt;    &lt;span class="n"&gt;f2&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;fun&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_c994663375f84b938ce8b3facffc7c6e-6" name="rest_code_c994663375f84b938ce8b3facffc7c6e-6" href="https://nicoguaro.github.io/posts/hermite_interp/#rest_code_c994663375f84b938ce8b3facffc7c6e-6"&gt;&lt;/a&gt;    &lt;span class="n"&gt;g1&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;grad&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x0&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_c994663375f84b938ce8b3facffc7c6e-7" name="rest_code_c994663375f84b938ce8b3facffc7c6e-7" href="https://nicoguaro.github.io/posts/hermite_interp/#rest_code_c994663375f84b938ce8b3facffc7c6e-7"&gt;&lt;/a&gt;    &lt;span class="n"&gt;g2&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;grad&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_c994663375f84b938ce8b3facffc7c6e-8" name="rest_code_c994663375f84b938ce8b3facffc7c6e-8" href="https://nicoguaro.github.io/posts/hermite_interp/#rest_code_c994663375f84b938ce8b3facffc7c6e-8"&gt;&lt;/a&gt;    &lt;span class="n"&gt;N1&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_c994663375f84b938ce8b3facffc7c6e-9" name="rest_code_c994663375f84b938ce8b3facffc7c6e-9" href="https://nicoguaro.github.io/posts/hermite_interp/#rest_code_c994663375f84b938ce8b3facffc7c6e-9"&gt;&lt;/a&gt;    &lt;span class="n"&gt;N2&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_c994663375f84b938ce8b3facffc7c6e-10" name="rest_code_c994663375f84b938ce8b3facffc7c6e-10" href="https://nicoguaro.github.io/posts/hermite_interp/#rest_code_c994663375f84b938ce8b3facffc7c6e-10"&gt;&lt;/a&gt;    &lt;span class="n"&gt;N3&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_c994663375f84b938ce8b3facffc7c6e-11" name="rest_code_c994663375f84b938ce8b3facffc7c6e-11" href="https://nicoguaro.github.io/posts/hermite_interp/#rest_code_c994663375f84b938ce8b3facffc7c6e-11"&gt;&lt;/a&gt;    &lt;span class="n"&gt;N4&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_c994663375f84b938ce8b3facffc7c6e-12" name="rest_code_c994663375f84b938ce8b3facffc7c6e-12" href="https://nicoguaro.github.io/posts/hermite_interp/#rest_code_c994663375f84b938ce8b3facffc7c6e-12"&gt;&lt;/a&gt;    &lt;span class="n"&gt;interp&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;N1&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;f1&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;N2&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;f2&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;jaco&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N3&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;g1&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;N4&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;g2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_c994663375f84b938ce8b3facffc7c6e-13" name="rest_code_c994663375f84b938ce8b3facffc7c6e-13" href="https://nicoguaro.github.io/posts/hermite_interp/#rest_code_c994663375f84b938ce8b3facffc7c6e-13"&gt;&lt;/a&gt;    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;interp&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;In this case, we interpolate the &lt;code class="docutils literal"&gt;sinc&lt;/code&gt; function&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code ipython2"&gt;&lt;a id="rest_code_afee045e3e3b47e4a6a1c30a01fe1d20-1" name="rest_code_afee045e3e3b47e4a6a1c30a01fe1d20-1" href="https://nicoguaro.github.io/posts/hermite_interp/#rest_code_afee045e3e3b47e4a6a1c30a01fe1d20-1"&gt;&lt;/a&gt;&lt;span class="k"&gt;def&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nf"&gt;fun&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_afee045e3e3b47e4a6a1c30a01fe1d20-2" name="rest_code_afee045e3e3b47e4a6a1c30a01fe1d20-2" href="https://nicoguaro.github.io/posts/hermite_interp/#rest_code_afee045e3e3b47e4a6a1c30a01fe1d20-2"&gt;&lt;/a&gt;    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sin&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;pi&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;pi&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_afee045e3e3b47e4a6a1c30a01fe1d20-3" name="rest_code_afee045e3e3b47e4a6a1c30a01fe1d20-3" href="https://nicoguaro.github.io/posts/hermite_interp/#rest_code_afee045e3e3b47e4a6a1c30a01fe1d20-3"&gt;&lt;/a&gt;
&lt;a id="rest_code_afee045e3e3b47e4a6a1c30a01fe1d20-4" name="rest_code_afee045e3e3b47e4a6a1c30a01fe1d20-4" href="https://nicoguaro.github.io/posts/hermite_interp/#rest_code_afee045e3e3b47e4a6a1c30a01fe1d20-4"&gt;&lt;/a&gt;
&lt;a id="rest_code_afee045e3e3b47e4a6a1c30a01fe1d20-5" name="rest_code_afee045e3e3b47e4a6a1c30a01fe1d20-5" href="https://nicoguaro.github.io/posts/hermite_interp/#rest_code_afee045e3e3b47e4a6a1c30a01fe1d20-5"&gt;&lt;/a&gt;&lt;span class="k"&gt;def&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nf"&gt;grad&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_afee045e3e3b47e4a6a1c30a01fe1d20-6" name="rest_code_afee045e3e3b47e4a6a1c30a01fe1d20-6" href="https://nicoguaro.github.io/posts/hermite_interp/#rest_code_afee045e3e3b47e4a6a1c30a01fe1d20-6"&gt;&lt;/a&gt;    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;cos&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;pi&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sin&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;pi&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;pi&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;The following snippet compute the interpolation and plot it.&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code ipython2"&gt;&lt;a id="rest_code_3bb1f317df76418194791239e5b293f0-1" name="rest_code_3bb1f317df76418194791239e5b293f0-1" href="https://nicoguaro.github.io/posts/hermite_interp/#rest_code_3bb1f317df76418194791239e5b293f0-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;a&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;
&lt;a id="rest_code_3bb1f317df76418194791239e5b293f0-2" name="rest_code_3bb1f317df76418194791239e5b293f0-2" href="https://nicoguaro.github.io/posts/hermite_interp/#rest_code_3bb1f317df76418194791239e5b293f0-2"&gt;&lt;/a&gt;&lt;span class="n"&gt;b&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;5&lt;/span&gt;
&lt;a id="rest_code_3bb1f317df76418194791239e5b293f0-3" name="rest_code_3bb1f317df76418194791239e5b293f0-3" href="https://nicoguaro.github.io/posts/hermite_interp/#rest_code_3bb1f317df76418194791239e5b293f0-3"&gt;&lt;/a&gt;&lt;span class="n"&gt;nels&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;7&lt;/span&gt;
&lt;a id="rest_code_3bb1f317df76418194791239e5b293f0-4" name="rest_code_3bb1f317df76418194791239e5b293f0-4" href="https://nicoguaro.github.io/posts/hermite_interp/#rest_code_3bb1f317df76418194791239e5b293f0-4"&gt;&lt;/a&gt;&lt;span class="n"&gt;npts&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;200&lt;/span&gt;
&lt;a id="rest_code_3bb1f317df76418194791239e5b293f0-5" name="rest_code_3bb1f317df76418194791239e5b293f0-5" href="https://nicoguaro.github.io/posts/hermite_interp/#rest_code_3bb1f317df76418194791239e5b293f0-5"&gt;&lt;/a&gt;&lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;linspace&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;npts&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_3bb1f317df76418194791239e5b293f0-6" name="rest_code_3bb1f317df76418194791239e5b293f0-6" href="https://nicoguaro.github.io/posts/hermite_interp/#rest_code_3bb1f317df76418194791239e5b293f0-6"&gt;&lt;/a&gt;&lt;span class="n"&gt;y&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;fun&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_3bb1f317df76418194791239e5b293f0-7" name="rest_code_3bb1f317df76418194791239e5b293f0-7" href="https://nicoguaro.github.io/posts/hermite_interp/#rest_code_3bb1f317df76418194791239e5b293f0-7"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;plot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;color&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;"black"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_3bb1f317df76418194791239e5b293f0-8" name="rest_code_3bb1f317df76418194791239e5b293f0-8" href="https://nicoguaro.github.io/posts/hermite_interp/#rest_code_3bb1f317df76418194791239e5b293f0-8"&gt;&lt;/a&gt;&lt;span class="n"&gt;xi&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;linspace&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;num&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;nels&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;endpoint&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;False&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_3bb1f317df76418194791239e5b293f0-9" name="rest_code_3bb1f317df76418194791239e5b293f0-9" href="https://nicoguaro.github.io/posts/hermite_interp/#rest_code_3bb1f317df76418194791239e5b293f0-9"&gt;&lt;/a&gt;&lt;span class="n"&gt;dx&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;xi&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;xi&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_3bb1f317df76418194791239e5b293f0-10" name="rest_code_3bb1f317df76418194791239e5b293f0-10" href="https://nicoguaro.github.io/posts/hermite_interp/#rest_code_3bb1f317df76418194791239e5b293f0-10"&gt;&lt;/a&gt;&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;x0&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;xi&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a id="rest_code_3bb1f317df76418194791239e5b293f0-11" name="rest_code_3bb1f317df76418194791239e5b293f0-11" href="https://nicoguaro.github.io/posts/hermite_interp/#rest_code_3bb1f317df76418194791239e5b293f0-11"&gt;&lt;/a&gt;    &lt;span class="n"&gt;x1&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;x0&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;dx&lt;/span&gt;
&lt;a id="rest_code_3bb1f317df76418194791239e5b293f0-12" name="rest_code_3bb1f317df76418194791239e5b293f0-12" href="https://nicoguaro.github.io/posts/hermite_interp/#rest_code_3bb1f317df76418194791239e5b293f0-12"&gt;&lt;/a&gt;    &lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;linspace&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;x1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;npts&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_3bb1f317df76418194791239e5b293f0-13" name="rest_code_3bb1f317df76418194791239e5b293f0-13" href="https://nicoguaro.github.io/posts/hermite_interp/#rest_code_3bb1f317df76418194791239e5b293f0-13"&gt;&lt;/a&gt;    &lt;span class="n"&gt;y&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;hermite_interp&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;fun&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;grad&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;x0&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;x0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;x1&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;x1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;npts&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;npts&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_3bb1f317df76418194791239e5b293f0-14" name="rest_code_3bb1f317df76418194791239e5b293f0-14" href="https://nicoguaro.github.io/posts/hermite_interp/#rest_code_3bb1f317df76418194791239e5b293f0-14"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;plot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;linestyle&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;"dashed"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;color&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;"#4daf4a"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_3bb1f317df76418194791239e5b293f0-15" name="rest_code_3bb1f317df76418194791239e5b293f0-15" href="https://nicoguaro.github.io/posts/hermite_interp/#rest_code_3bb1f317df76418194791239e5b293f0-15"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;plot&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]],&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]],&lt;/span&gt; &lt;span class="n"&gt;marker&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;"o"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;color&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;"#4daf4a"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;a id="rest_code_3bb1f317df76418194791239e5b293f0-16" name="rest_code_3bb1f317df76418194791239e5b293f0-16" href="https://nicoguaro.github.io/posts/hermite_interp/#rest_code_3bb1f317df76418194791239e5b293f0-16"&gt;&lt;/a&gt;         &lt;span class="n"&gt;linewidth&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_3bb1f317df76418194791239e5b293f0-17" name="rest_code_3bb1f317df76418194791239e5b293f0-17" href="https://nicoguaro.github.io/posts/hermite_interp/#rest_code_3bb1f317df76418194791239e5b293f0-17"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"x"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_3bb1f317df76418194791239e5b293f0-18" name="rest_code_3bb1f317df76418194791239e5b293f0-18" href="https://nicoguaro.github.io/posts/hermite_interp/#rest_code_3bb1f317df76418194791239e5b293f0-18"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ylabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"y"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_3bb1f317df76418194791239e5b293f0-19" name="rest_code_3bb1f317df76418194791239e5b293f0-19" href="https://nicoguaro.github.io/posts/hermite_interp/#rest_code_3bb1f317df76418194791239e5b293f0-19"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;legend&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="s2"&gt;"Exact function"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;"Interpolation"&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_3bb1f317df76418194791239e5b293f0-20" name="rest_code_3bb1f317df76418194791239e5b293f0-20" href="https://nicoguaro.github.io/posts/hermite_interp/#rest_code_3bb1f317df76418194791239e5b293f0-20"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;show&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;img alt="/images/sinc_interp.svg" src="https://nicoguaro.github.io/images/sinc_interp.svg"&gt;
&lt;section id="references"&gt;
&lt;h2&gt;References&lt;/h2&gt;
&lt;aside class="footnote-list brackets"&gt;
&lt;aside class="footnote brackets" id="footnote-1" role="doc-footnote"&gt;
&lt;span class="label"&gt;&lt;span class="fn-bracket"&gt;[&lt;/span&gt;&lt;a role="doc-backlink" href="https://nicoguaro.github.io/posts/hermite_interp/#footnote-reference-1"&gt;1&lt;/a&gt;&lt;span class="fn-bracket"&gt;]&lt;/span&gt;&lt;/span&gt;
&lt;p&gt;Walter Gautschi (1962). On inverses of Vandermonde
and confluent Vandermonde matrices. Numerische Mathematik, 4
117-123.&lt;/p&gt;
&lt;/aside&gt;
&lt;/aside&gt;
&lt;/section&gt;</description><category>approximation</category><category>finite element method</category><category>interpolation</category><category>python</category><category>sympy</category><guid>https://nicoguaro.github.io/posts/hermite_interp/</guid><pubDate>Thu, 22 Jun 2017 21:24:44 GMT</pubDate></item></channel></rss>