<?xml version="1.0" encoding="utf-8"?>
<?xml-stylesheet type="text/xsl" href="../assets/xml/rss.xsl" media="all"?><rss version="2.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Nicolás' blog (Posts about finite element method)</title><link>https://nicoguaro.github.io/</link><description></description><atom:link href="https://nicoguaro.github.io/categories/finite-element-method.xml" rel="self" type="application/rss+xml"></atom:link><language>en</language><copyright>Contents © 2023 &lt;a href="mailto:nicoguarin@gmail.com"&gt;Nicolás Guarín-Zapata&lt;/a&gt; 
&lt;a rel="license" href="http://creativecommons.org/licenses/by/4.0/"&gt;
&lt;img alt="Creative Commons License"
style="border-width:0"
src="https://i.creativecommons.org/l/by/4.0/88x31.png"&gt;&lt;/a&gt;</copyright><lastBuildDate>Sun, 29 Jan 2023 16:26:04 GMT</lastBuildDate><generator>Nikola (getnikola.com)</generator><docs>http://blogs.law.harvard.edu/tech/rss</docs><item><title>Numerical methods challenge: Day 31</title><link>https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/</link><dc:creator>Nicolás Guarín-Zapata</dc:creator><description>&lt;p&gt;During October (2017) I wrote a program per day for some well-known
numerical methods in both Python and Julia. It was intended to be an exercise,
then don't expect the code to be good enough for real use. Also,
I should mention that I had almost no experience with Julia, so it
probably is not idiomatic Julia but more Python-like Julia.&lt;/p&gt;
&lt;section id="putting-some-things-together"&gt;
&lt;h2&gt;Putting some things together&lt;/h2&gt;
&lt;p&gt;Today, I am putting some things together, namely, I am going to solve the
system of equations that results in the finite element using the conjugate
gradient.&lt;/p&gt;
&lt;p&gt;Following are the codes&lt;/p&gt;
&lt;section id="python"&gt;
&lt;h3&gt;Python&lt;/h3&gt;
&lt;div class="code"&gt;&lt;pre class="code python"&gt;&lt;a id="rest_code_1bb5b4d6bf5c4001b9fdaf7e2a705237-1" name="rest_code_1bb5b4d6bf5c4001b9fdaf7e2a705237-1" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_1bb5b4d6bf5c4001b9fdaf7e2a705237-1"&gt;&lt;/a&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;__future__&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;division&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;print_function&lt;/span&gt;
&lt;a id="rest_code_1bb5b4d6bf5c4001b9fdaf7e2a705237-2" name="rest_code_1bb5b4d6bf5c4001b9fdaf7e2a705237-2" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_1bb5b4d6bf5c4001b9fdaf7e2a705237-2"&gt;&lt;/a&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;numpy&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;np&lt;/span&gt;
&lt;a id="rest_code_1bb5b4d6bf5c4001b9fdaf7e2a705237-3" name="rest_code_1bb5b4d6bf5c4001b9fdaf7e2a705237-3" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_1bb5b4d6bf5c4001b9fdaf7e2a705237-3"&gt;&lt;/a&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;matplotlib.pyplot&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;plt&lt;/span&gt;
&lt;a id="rest_code_1bb5b4d6bf5c4001b9fdaf7e2a705237-4" name="rest_code_1bb5b4d6bf5c4001b9fdaf7e2a705237-4" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_1bb5b4d6bf5c4001b9fdaf7e2a705237-4"&gt;&lt;/a&gt;
&lt;a id="rest_code_1bb5b4d6bf5c4001b9fdaf7e2a705237-5" name="rest_code_1bb5b4d6bf5c4001b9fdaf7e2a705237-5" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_1bb5b4d6bf5c4001b9fdaf7e2a705237-5"&gt;&lt;/a&gt;
&lt;a id="rest_code_1bb5b4d6bf5c4001b9fdaf7e2a705237-6" name="rest_code_1bb5b4d6bf5c4001b9fdaf7e2a705237-6" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_1bb5b4d6bf5c4001b9fdaf7e2a705237-6"&gt;&lt;/a&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;FEM1D&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;source&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_1bb5b4d6bf5c4001b9fdaf7e2a705237-7" name="rest_code_1bb5b4d6bf5c4001b9fdaf7e2a705237-7" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_1bb5b4d6bf5c4001b9fdaf7e2a705237-7"&gt;&lt;/a&gt;    &lt;span class="n"&gt;N&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_1bb5b4d6bf5c4001b9fdaf7e2a705237-8" name="rest_code_1bb5b4d6bf5c4001b9fdaf7e2a705237-8" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_1bb5b4d6bf5c4001b9fdaf7e2a705237-8"&gt;&lt;/a&gt;    &lt;span class="n"&gt;stiff_loc&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;([[&lt;/span&gt;&lt;span class="mf"&gt;2.0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;2.0&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;2.0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;2.0&lt;/span&gt;&lt;span class="p"&gt;]])&lt;/span&gt;
&lt;a id="rest_code_1bb5b4d6bf5c4001b9fdaf7e2a705237-9" name="rest_code_1bb5b4d6bf5c4001b9fdaf7e2a705237-9" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_1bb5b4d6bf5c4001b9fdaf7e2a705237-9"&gt;&lt;/a&gt;    &lt;span class="n"&gt;eles&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="n"&gt;cont&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;cont&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;cont&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;N&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)]&lt;/span&gt;
&lt;a id="rest_code_1bb5b4d6bf5c4001b9fdaf7e2a705237-10" name="rest_code_1bb5b4d6bf5c4001b9fdaf7e2a705237-10" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_1bb5b4d6bf5c4001b9fdaf7e2a705237-10"&gt;&lt;/a&gt;    &lt;span class="n"&gt;stiff&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_1bb5b4d6bf5c4001b9fdaf7e2a705237-11" name="rest_code_1bb5b4d6bf5c4001b9fdaf7e2a705237-11" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_1bb5b4d6bf5c4001b9fdaf7e2a705237-11"&gt;&lt;/a&gt;    &lt;span class="n"&gt;rhs&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_1bb5b4d6bf5c4001b9fdaf7e2a705237-12" name="rest_code_1bb5b4d6bf5c4001b9fdaf7e2a705237-12" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_1bb5b4d6bf5c4001b9fdaf7e2a705237-12"&gt;&lt;/a&gt;    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;ele&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;eles&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a id="rest_code_1bb5b4d6bf5c4001b9fdaf7e2a705237-13" name="rest_code_1bb5b4d6bf5c4001b9fdaf7e2a705237-13" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_1bb5b4d6bf5c4001b9fdaf7e2a705237-13"&gt;&lt;/a&gt;        &lt;span class="n"&gt;jaco&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ele&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]]&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ele&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]]&lt;/span&gt;
&lt;a id="rest_code_1bb5b4d6bf5c4001b9fdaf7e2a705237-14" name="rest_code_1bb5b4d6bf5c4001b9fdaf7e2a705237-14" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_1bb5b4d6bf5c4001b9fdaf7e2a705237-14"&gt;&lt;/a&gt;        &lt;span class="n"&gt;rhs&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ele&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;rhs&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ele&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;jaco&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;source&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ele&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_1bb5b4d6bf5c4001b9fdaf7e2a705237-15" name="rest_code_1bb5b4d6bf5c4001b9fdaf7e2a705237-15" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_1bb5b4d6bf5c4001b9fdaf7e2a705237-15"&gt;&lt;/a&gt;        &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;cont1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;row&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;enumerate&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ele&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_1bb5b4d6bf5c4001b9fdaf7e2a705237-16" name="rest_code_1bb5b4d6bf5c4001b9fdaf7e2a705237-16" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_1bb5b4d6bf5c4001b9fdaf7e2a705237-16"&gt;&lt;/a&gt;            &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;cont2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;col&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;enumerate&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ele&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_1bb5b4d6bf5c4001b9fdaf7e2a705237-17" name="rest_code_1bb5b4d6bf5c4001b9fdaf7e2a705237-17" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_1bb5b4d6bf5c4001b9fdaf7e2a705237-17"&gt;&lt;/a&gt;                &lt;span class="n"&gt;stiff&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;row&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;stiff&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;row&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt;  &lt;span class="n"&gt;stiff_loc&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;cont1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;cont2&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;jaco&lt;/span&gt;
&lt;a id="rest_code_1bb5b4d6bf5c4001b9fdaf7e2a705237-18" name="rest_code_1bb5b4d6bf5c4001b9fdaf7e2a705237-18" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_1bb5b4d6bf5c4001b9fdaf7e2a705237-18"&gt;&lt;/a&gt;    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;stiff&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;rhs&lt;/span&gt;
&lt;a id="rest_code_1bb5b4d6bf5c4001b9fdaf7e2a705237-19" name="rest_code_1bb5b4d6bf5c4001b9fdaf7e2a705237-19" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_1bb5b4d6bf5c4001b9fdaf7e2a705237-19"&gt;&lt;/a&gt;
&lt;a id="rest_code_1bb5b4d6bf5c4001b9fdaf7e2a705237-20" name="rest_code_1bb5b4d6bf5c4001b9fdaf7e2a705237-20" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_1bb5b4d6bf5c4001b9fdaf7e2a705237-20"&gt;&lt;/a&gt;
&lt;a id="rest_code_1bb5b4d6bf5c4001b9fdaf7e2a705237-21" name="rest_code_1bb5b4d6bf5c4001b9fdaf7e2a705237-21" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_1bb5b4d6bf5c4001b9fdaf7e2a705237-21"&gt;&lt;/a&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;conj_grad&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;tol&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mf"&gt;1e-8&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_1bb5b4d6bf5c4001b9fdaf7e2a705237-22" name="rest_code_1bb5b4d6bf5c4001b9fdaf7e2a705237-22" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_1bb5b4d6bf5c4001b9fdaf7e2a705237-22"&gt;&lt;/a&gt;    &lt;span class="n"&gt;r&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;b&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;dot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_1bb5b4d6bf5c4001b9fdaf7e2a705237-23" name="rest_code_1bb5b4d6bf5c4001b9fdaf7e2a705237-23" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_1bb5b4d6bf5c4001b9fdaf7e2a705237-23"&gt;&lt;/a&gt;    &lt;span class="n"&gt;p&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;r&lt;/span&gt;
&lt;a id="rest_code_1bb5b4d6bf5c4001b9fdaf7e2a705237-24" name="rest_code_1bb5b4d6bf5c4001b9fdaf7e2a705237-24" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_1bb5b4d6bf5c4001b9fdaf7e2a705237-24"&gt;&lt;/a&gt;    &lt;span class="n"&gt;rsq_old&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;dot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_1bb5b4d6bf5c4001b9fdaf7e2a705237-25" name="rest_code_1bb5b4d6bf5c4001b9fdaf7e2a705237-25" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_1bb5b4d6bf5c4001b9fdaf7e2a705237-25"&gt;&lt;/a&gt;    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;cont&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;)):&lt;/span&gt;
&lt;a id="rest_code_1bb5b4d6bf5c4001b9fdaf7e2a705237-26" name="rest_code_1bb5b4d6bf5c4001b9fdaf7e2a705237-26" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_1bb5b4d6bf5c4001b9fdaf7e2a705237-26"&gt;&lt;/a&gt;        &lt;span class="n"&gt;Ap&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;dot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_1bb5b4d6bf5c4001b9fdaf7e2a705237-27" name="rest_code_1bb5b4d6bf5c4001b9fdaf7e2a705237-27" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_1bb5b4d6bf5c4001b9fdaf7e2a705237-27"&gt;&lt;/a&gt;        &lt;span class="n"&gt;alpha&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;rsq_old&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;dot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Ap&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_1bb5b4d6bf5c4001b9fdaf7e2a705237-28" name="rest_code_1bb5b4d6bf5c4001b9fdaf7e2a705237-28" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_1bb5b4d6bf5c4001b9fdaf7e2a705237-28"&gt;&lt;/a&gt;        &lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;alpha&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;p&lt;/span&gt;
&lt;a id="rest_code_1bb5b4d6bf5c4001b9fdaf7e2a705237-29" name="rest_code_1bb5b4d6bf5c4001b9fdaf7e2a705237-29" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_1bb5b4d6bf5c4001b9fdaf7e2a705237-29"&gt;&lt;/a&gt;        &lt;span class="n"&gt;r&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;r&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;alpha&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;Ap&lt;/span&gt;
&lt;a id="rest_code_1bb5b4d6bf5c4001b9fdaf7e2a705237-30" name="rest_code_1bb5b4d6bf5c4001b9fdaf7e2a705237-30" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_1bb5b4d6bf5c4001b9fdaf7e2a705237-30"&gt;&lt;/a&gt;        &lt;span class="n"&gt;rsq_new&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;dot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_1bb5b4d6bf5c4001b9fdaf7e2a705237-31" name="rest_code_1bb5b4d6bf5c4001b9fdaf7e2a705237-31" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_1bb5b4d6bf5c4001b9fdaf7e2a705237-31"&gt;&lt;/a&gt;        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sqrt&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;rsq_new&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;tol&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a id="rest_code_1bb5b4d6bf5c4001b9fdaf7e2a705237-32" name="rest_code_1bb5b4d6bf5c4001b9fdaf7e2a705237-32" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_1bb5b4d6bf5c4001b9fdaf7e2a705237-32"&gt;&lt;/a&gt;            &lt;span class="k"&gt;break&lt;/span&gt;
&lt;a id="rest_code_1bb5b4d6bf5c4001b9fdaf7e2a705237-33" name="rest_code_1bb5b4d6bf5c4001b9fdaf7e2a705237-33" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_1bb5b4d6bf5c4001b9fdaf7e2a705237-33"&gt;&lt;/a&gt;        &lt;span class="n"&gt;p&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;r&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;rsq_new&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="n"&gt;rsq_old&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;p&lt;/span&gt;
&lt;a id="rest_code_1bb5b4d6bf5c4001b9fdaf7e2a705237-34" name="rest_code_1bb5b4d6bf5c4001b9fdaf7e2a705237-34" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_1bb5b4d6bf5c4001b9fdaf7e2a705237-34"&gt;&lt;/a&gt;        &lt;span class="n"&gt;rsq_old&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;rsq_new&lt;/span&gt;
&lt;a id="rest_code_1bb5b4d6bf5c4001b9fdaf7e2a705237-35" name="rest_code_1bb5b4d6bf5c4001b9fdaf7e2a705237-35" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_1bb5b4d6bf5c4001b9fdaf7e2a705237-35"&gt;&lt;/a&gt;    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;cont&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sqrt&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;rsq_new&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_1bb5b4d6bf5c4001b9fdaf7e2a705237-36" name="rest_code_1bb5b4d6bf5c4001b9fdaf7e2a705237-36" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_1bb5b4d6bf5c4001b9fdaf7e2a705237-36"&gt;&lt;/a&gt;
&lt;a id="rest_code_1bb5b4d6bf5c4001b9fdaf7e2a705237-37" name="rest_code_1bb5b4d6bf5c4001b9fdaf7e2a705237-37" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_1bb5b4d6bf5c4001b9fdaf7e2a705237-37"&gt;&lt;/a&gt;
&lt;a id="rest_code_1bb5b4d6bf5c4001b9fdaf7e2a705237-38" name="rest_code_1bb5b4d6bf5c4001b9fdaf7e2a705237-38" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_1bb5b4d6bf5c4001b9fdaf7e2a705237-38"&gt;&lt;/a&gt;&lt;span class="n"&gt;fun&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;lambda&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;
&lt;a id="rest_code_1bb5b4d6bf5c4001b9fdaf7e2a705237-39" name="rest_code_1bb5b4d6bf5c4001b9fdaf7e2a705237-39" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_1bb5b4d6bf5c4001b9fdaf7e2a705237-39"&gt;&lt;/a&gt;&lt;span class="n"&gt;N_vec&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;logspace&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;0.5&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;50&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;dtype&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nb"&gt;int&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_1bb5b4d6bf5c4001b9fdaf7e2a705237-40" name="rest_code_1bb5b4d6bf5c4001b9fdaf7e2a705237-40" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_1bb5b4d6bf5c4001b9fdaf7e2a705237-40"&gt;&lt;/a&gt;&lt;span class="n"&gt;err_vec&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros_like&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N_vec&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;dtype&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nb"&gt;float&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_1bb5b4d6bf5c4001b9fdaf7e2a705237-41" name="rest_code_1bb5b4d6bf5c4001b9fdaf7e2a705237-41" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_1bb5b4d6bf5c4001b9fdaf7e2a705237-41"&gt;&lt;/a&gt;&lt;span class="n"&gt;niter_vec&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros_like&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N_vec&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_1bb5b4d6bf5c4001b9fdaf7e2a705237-42" name="rest_code_1bb5b4d6bf5c4001b9fdaf7e2a705237-42" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_1bb5b4d6bf5c4001b9fdaf7e2a705237-42"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;figure&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;figsize&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;8&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_1bb5b4d6bf5c4001b9fdaf7e2a705237-43" name="rest_code_1bb5b4d6bf5c4001b9fdaf7e2a705237-43" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_1bb5b4d6bf5c4001b9fdaf7e2a705237-43"&gt;&lt;/a&gt;&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;cont&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;N&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;enumerate&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N_vec&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_1bb5b4d6bf5c4001b9fdaf7e2a705237-44" name="rest_code_1bb5b4d6bf5c4001b9fdaf7e2a705237-44" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_1bb5b4d6bf5c4001b9fdaf7e2a705237-44"&gt;&lt;/a&gt;    &lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;linspace&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_1bb5b4d6bf5c4001b9fdaf7e2a705237-45" name="rest_code_1bb5b4d6bf5c4001b9fdaf7e2a705237-45" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_1bb5b4d6bf5c4001b9fdaf7e2a705237-45"&gt;&lt;/a&gt;    &lt;span class="n"&gt;stiff&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;rhs&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;FEM1D&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;fun&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_1bb5b4d6bf5c4001b9fdaf7e2a705237-46" name="rest_code_1bb5b4d6bf5c4001b9fdaf7e2a705237-46" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_1bb5b4d6bf5c4001b9fdaf7e2a705237-46"&gt;&lt;/a&gt;    &lt;span class="n"&gt;sol&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_1bb5b4d6bf5c4001b9fdaf7e2a705237-47" name="rest_code_1bb5b4d6bf5c4001b9fdaf7e2a705237-47" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_1bb5b4d6bf5c4001b9fdaf7e2a705237-47"&gt;&lt;/a&gt;    &lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;niter&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;_&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;conj_grad&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;stiff&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;rhs&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;rhs&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_1bb5b4d6bf5c4001b9fdaf7e2a705237-48" name="rest_code_1bb5b4d6bf5c4001b9fdaf7e2a705237-48" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_1bb5b4d6bf5c4001b9fdaf7e2a705237-48"&gt;&lt;/a&gt;    &lt;span class="n"&gt;err&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;linalg&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;norm&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;sol&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="mi"&gt;20&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;linalg&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;norm&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="mi"&gt;20&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_1bb5b4d6bf5c4001b9fdaf7e2a705237-49" name="rest_code_1bb5b4d6bf5c4001b9fdaf7e2a705237-49" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_1bb5b4d6bf5c4001b9fdaf7e2a705237-49"&gt;&lt;/a&gt;    &lt;span class="n"&gt;err_vec&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;cont&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;err&lt;/span&gt;
&lt;a id="rest_code_1bb5b4d6bf5c4001b9fdaf7e2a705237-50" name="rest_code_1bb5b4d6bf5c4001b9fdaf7e2a705237-50" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_1bb5b4d6bf5c4001b9fdaf7e2a705237-50"&gt;&lt;/a&gt;    &lt;span class="n"&gt;niter_vec&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;cont&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;niter&lt;/span&gt;
&lt;a id="rest_code_1bb5b4d6bf5c4001b9fdaf7e2a705237-51" name="rest_code_1bb5b4d6bf5c4001b9fdaf7e2a705237-51" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_1bb5b4d6bf5c4001b9fdaf7e2a705237-51"&gt;&lt;/a&gt;
&lt;a id="rest_code_1bb5b4d6bf5c4001b9fdaf7e2a705237-52" name="rest_code_1bb5b4d6bf5c4001b9fdaf7e2a705237-52" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_1bb5b4d6bf5c4001b9fdaf7e2a705237-52"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;subplot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;121&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_1bb5b4d6bf5c4001b9fdaf7e2a705237-53" name="rest_code_1bb5b4d6bf5c4001b9fdaf7e2a705237-53" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_1bb5b4d6bf5c4001b9fdaf7e2a705237-53"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;loglog&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N_vec&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;err_vec&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_1bb5b4d6bf5c4001b9fdaf7e2a705237-54" name="rest_code_1bb5b4d6bf5c4001b9fdaf7e2a705237-54" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_1bb5b4d6bf5c4001b9fdaf7e2a705237-54"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"Number of nodes"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_1bb5b4d6bf5c4001b9fdaf7e2a705237-55" name="rest_code_1bb5b4d6bf5c4001b9fdaf7e2a705237-55" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_1bb5b4d6bf5c4001b9fdaf7e2a705237-55"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ylabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"Relative error"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_1bb5b4d6bf5c4001b9fdaf7e2a705237-56" name="rest_code_1bb5b4d6bf5c4001b9fdaf7e2a705237-56" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_1bb5b4d6bf5c4001b9fdaf7e2a705237-56"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;subplot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;122&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_1bb5b4d6bf5c4001b9fdaf7e2a705237-57" name="rest_code_1bb5b4d6bf5c4001b9fdaf7e2a705237-57" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_1bb5b4d6bf5c4001b9fdaf7e2a705237-57"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;loglog&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N_vec&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;niter_vec&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_1bb5b4d6bf5c4001b9fdaf7e2a705237-58" name="rest_code_1bb5b4d6bf5c4001b9fdaf7e2a705237-58" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_1bb5b4d6bf5c4001b9fdaf7e2a705237-58"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"Number of nodes"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_1bb5b4d6bf5c4001b9fdaf7e2a705237-59" name="rest_code_1bb5b4d6bf5c4001b9fdaf7e2a705237-59" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_1bb5b4d6bf5c4001b9fdaf7e2a705237-59"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ylabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"Number of iterations"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_1bb5b4d6bf5c4001b9fdaf7e2a705237-60" name="rest_code_1bb5b4d6bf5c4001b9fdaf7e2a705237-60" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_1bb5b4d6bf5c4001b9fdaf7e2a705237-60"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;tight_layout&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a id="rest_code_1bb5b4d6bf5c4001b9fdaf7e2a705237-61" name="rest_code_1bb5b4d6bf5c4001b9fdaf7e2a705237-61" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_1bb5b4d6bf5c4001b9fdaf7e2a705237-61"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;show&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/section&gt;
&lt;section id="julia"&gt;
&lt;h3&gt;Julia&lt;/h3&gt;
&lt;div class="code"&gt;&lt;pre class="code julia"&gt;&lt;a id="rest_code_a39844c1ef904143a9bbb7560d978156-1" name="rest_code_a39844c1ef904143a9bbb7560d978156-1" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_a39844c1ef904143a9bbb7560d978156-1"&gt;&lt;/a&gt;&lt;span class="k"&gt;using&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;PyPlot&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_a39844c1ef904143a9bbb7560d978156-2" name="rest_code_a39844c1ef904143a9bbb7560d978156-2" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_a39844c1ef904143a9bbb7560d978156-2"&gt;&lt;/a&gt;
&lt;a id="rest_code_a39844c1ef904143a9bbb7560d978156-3" name="rest_code_a39844c1ef904143a9bbb7560d978156-3" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_a39844c1ef904143a9bbb7560d978156-3"&gt;&lt;/a&gt;
&lt;a id="rest_code_a39844c1ef904143a9bbb7560d978156-4" name="rest_code_a39844c1ef904143a9bbb7560d978156-4" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_a39844c1ef904143a9bbb7560d978156-4"&gt;&lt;/a&gt;&lt;span class="k"&gt;function&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;FEM1D&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;source&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_a39844c1ef904143a9bbb7560d978156-5" name="rest_code_a39844c1ef904143a9bbb7560d978156-5" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_a39844c1ef904143a9bbb7560d978156-5"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;length&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_a39844c1ef904143a9bbb7560d978156-6" name="rest_code_a39844c1ef904143a9bbb7560d978156-6" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_a39844c1ef904143a9bbb7560d978156-6"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;stiff_loc&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mf"&gt;2.0&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;2.0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;2.0&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;2.0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_a39844c1ef904143a9bbb7560d978156-7" name="rest_code_a39844c1ef904143a9bbb7560d978156-7" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_a39844c1ef904143a9bbb7560d978156-7"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;eles&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;[[&lt;/span&gt;&lt;span class="n"&gt;cont&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;cont&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;for&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;cont&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;in&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_a39844c1ef904143a9bbb7560d978156-8" name="rest_code_a39844c1ef904143a9bbb7560d978156-8" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_a39844c1ef904143a9bbb7560d978156-8"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;stiff&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_a39844c1ef904143a9bbb7560d978156-9" name="rest_code_a39844c1ef904143a9bbb7560d978156-9" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_a39844c1ef904143a9bbb7560d978156-9"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;rhs&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_a39844c1ef904143a9bbb7560d978156-10" name="rest_code_a39844c1ef904143a9bbb7560d978156-10" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_a39844c1ef904143a9bbb7560d978156-10"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;for&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ele&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;in&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;eles&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_a39844c1ef904143a9bbb7560d978156-11" name="rest_code_a39844c1ef904143a9bbb7560d978156-11" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_a39844c1ef904143a9bbb7560d978156-11"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;jaco&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ele&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;]]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ele&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]]&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_a39844c1ef904143a9bbb7560d978156-12" name="rest_code_a39844c1ef904143a9bbb7560d978156-12" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_a39844c1ef904143a9bbb7560d978156-12"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;rhs&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ele&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;rhs&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ele&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;jaco&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;source&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ele&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_a39844c1ef904143a9bbb7560d978156-13" name="rest_code_a39844c1ef904143a9bbb7560d978156-13" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_a39844c1ef904143a9bbb7560d978156-13"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;stiff&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ele&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ele&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;stiff&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ele&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ele&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;stiff_loc&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;jaco&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_a39844c1ef904143a9bbb7560d978156-14" name="rest_code_a39844c1ef904143a9bbb7560d978156-14" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_a39844c1ef904143a9bbb7560d978156-14"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;end&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_a39844c1ef904143a9bbb7560d978156-15" name="rest_code_a39844c1ef904143a9bbb7560d978156-15" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_a39844c1ef904143a9bbb7560d978156-15"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;return&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;stiff&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;rhs&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_a39844c1ef904143a9bbb7560d978156-16" name="rest_code_a39844c1ef904143a9bbb7560d978156-16" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_a39844c1ef904143a9bbb7560d978156-16"&gt;&lt;/a&gt;&lt;span class="k"&gt;end&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_a39844c1ef904143a9bbb7560d978156-17" name="rest_code_a39844c1ef904143a9bbb7560d978156-17" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_a39844c1ef904143a9bbb7560d978156-17"&gt;&lt;/a&gt;
&lt;a id="rest_code_a39844c1ef904143a9bbb7560d978156-18" name="rest_code_a39844c1ef904143a9bbb7560d978156-18" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_a39844c1ef904143a9bbb7560d978156-18"&gt;&lt;/a&gt;
&lt;a id="rest_code_a39844c1ef904143a9bbb7560d978156-19" name="rest_code_a39844c1ef904143a9bbb7560d978156-19" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_a39844c1ef904143a9bbb7560d978156-19"&gt;&lt;/a&gt;&lt;span class="k"&gt;function&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;conj_grad&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;tol&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mf"&gt;1e-8&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_a39844c1ef904143a9bbb7560d978156-20" name="rest_code_a39844c1ef904143a9bbb7560d978156-20" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_a39844c1ef904143a9bbb7560d978156-20"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_a39844c1ef904143a9bbb7560d978156-21" name="rest_code_a39844c1ef904143a9bbb7560d978156-21" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_a39844c1ef904143a9bbb7560d978156-21"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_a39844c1ef904143a9bbb7560d978156-22" name="rest_code_a39844c1ef904143a9bbb7560d978156-22" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_a39844c1ef904143a9bbb7560d978156-22"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;rsq_old&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;dot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_a39844c1ef904143a9bbb7560d978156-23" name="rest_code_a39844c1ef904143a9bbb7560d978156-23" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_a39844c1ef904143a9bbb7560d978156-23"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;niter&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_a39844c1ef904143a9bbb7560d978156-24" name="rest_code_a39844c1ef904143a9bbb7560d978156-24" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_a39844c1ef904143a9bbb7560d978156-24"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;for&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;cont&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="n"&gt;length&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_a39844c1ef904143a9bbb7560d978156-25" name="rest_code_a39844c1ef904143a9bbb7560d978156-25" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_a39844c1ef904143a9bbb7560d978156-25"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;Ap&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_a39844c1ef904143a9bbb7560d978156-26" name="rest_code_a39844c1ef904143a9bbb7560d978156-26" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_a39844c1ef904143a9bbb7560d978156-26"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;alpha&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;rsq_old&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;dot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Ap&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_a39844c1ef904143a9bbb7560d978156-27" name="rest_code_a39844c1ef904143a9bbb7560d978156-27" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_a39844c1ef904143a9bbb7560d978156-27"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;alpha&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_a39844c1ef904143a9bbb7560d978156-28" name="rest_code_a39844c1ef904143a9bbb7560d978156-28" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_a39844c1ef904143a9bbb7560d978156-28"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;alpha&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;Ap&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_a39844c1ef904143a9bbb7560d978156-29" name="rest_code_a39844c1ef904143a9bbb7560d978156-29" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_a39844c1ef904143a9bbb7560d978156-29"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;rsq_new&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;dot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_a39844c1ef904143a9bbb7560d978156-30" name="rest_code_a39844c1ef904143a9bbb7560d978156-30" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_a39844c1ef904143a9bbb7560d978156-30"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;sqrt&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;rsq_new&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;tol&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_a39844c1ef904143a9bbb7560d978156-31" name="rest_code_a39844c1ef904143a9bbb7560d978156-31" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_a39844c1ef904143a9bbb7560d978156-31"&gt;&lt;/a&gt;&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="k"&gt;break&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_a39844c1ef904143a9bbb7560d978156-32" name="rest_code_a39844c1ef904143a9bbb7560d978156-32" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_a39844c1ef904143a9bbb7560d978156-32"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="k"&gt;end&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_a39844c1ef904143a9bbb7560d978156-33" name="rest_code_a39844c1ef904143a9bbb7560d978156-33" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_a39844c1ef904143a9bbb7560d978156-33"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;rsq_new&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;rsq_old&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_a39844c1ef904143a9bbb7560d978156-34" name="rest_code_a39844c1ef904143a9bbb7560d978156-34" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_a39844c1ef904143a9bbb7560d978156-34"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;rsq_old&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;rsq_new&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_a39844c1ef904143a9bbb7560d978156-35" name="rest_code_a39844c1ef904143a9bbb7560d978156-35" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_a39844c1ef904143a9bbb7560d978156-35"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;niter&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_a39844c1ef904143a9bbb7560d978156-36" name="rest_code_a39844c1ef904143a9bbb7560d978156-36" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_a39844c1ef904143a9bbb7560d978156-36"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;end&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_a39844c1ef904143a9bbb7560d978156-37" name="rest_code_a39844c1ef904143a9bbb7560d978156-37" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_a39844c1ef904143a9bbb7560d978156-37"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;return&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;niter&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;norm&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_a39844c1ef904143a9bbb7560d978156-38" name="rest_code_a39844c1ef904143a9bbb7560d978156-38" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_a39844c1ef904143a9bbb7560d978156-38"&gt;&lt;/a&gt;&lt;span class="k"&gt;end&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_a39844c1ef904143a9bbb7560d978156-39" name="rest_code_a39844c1ef904143a9bbb7560d978156-39" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_a39844c1ef904143a9bbb7560d978156-39"&gt;&lt;/a&gt;
&lt;a id="rest_code_a39844c1ef904143a9bbb7560d978156-40" name="rest_code_a39844c1ef904143a9bbb7560d978156-40" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_a39844c1ef904143a9bbb7560d978156-40"&gt;&lt;/a&gt;
&lt;a id="rest_code_a39844c1ef904143a9bbb7560d978156-41" name="rest_code_a39844c1ef904143a9bbb7560d978156-41" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_a39844c1ef904143a9bbb7560d978156-41"&gt;&lt;/a&gt;
&lt;a id="rest_code_a39844c1ef904143a9bbb7560d978156-42" name="rest_code_a39844c1ef904143a9bbb7560d978156-42" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_a39844c1ef904143a9bbb7560d978156-42"&gt;&lt;/a&gt;&lt;span class="n"&gt;fun&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;.^&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_a39844c1ef904143a9bbb7560d978156-43" name="rest_code_a39844c1ef904143a9bbb7560d978156-43" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_a39844c1ef904143a9bbb7560d978156-43"&gt;&lt;/a&gt;&lt;span class="n"&gt;N_vec&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;round&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;logspace&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;0.5&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;50&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_a39844c1ef904143a9bbb7560d978156-44" name="rest_code_a39844c1ef904143a9bbb7560d978156-44" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_a39844c1ef904143a9bbb7560d978156-44"&gt;&lt;/a&gt;&lt;span class="n"&gt;err_vec&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N_vec&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_a39844c1ef904143a9bbb7560d978156-45" name="rest_code_a39844c1ef904143a9bbb7560d978156-45" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_a39844c1ef904143a9bbb7560d978156-45"&gt;&lt;/a&gt;&lt;span class="n"&gt;niter_vec&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N_vec&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_a39844c1ef904143a9bbb7560d978156-46" name="rest_code_a39844c1ef904143a9bbb7560d978156-46" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_a39844c1ef904143a9bbb7560d978156-46"&gt;&lt;/a&gt;&lt;span class="n"&gt;figure&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;figsize&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;8&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_a39844c1ef904143a9bbb7560d978156-47" name="rest_code_a39844c1ef904143a9bbb7560d978156-47" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_a39844c1ef904143a9bbb7560d978156-47"&gt;&lt;/a&gt;&lt;span class="k"&gt;for&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;cont&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;in&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;enumerate&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N_vec&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_a39844c1ef904143a9bbb7560d978156-48" name="rest_code_a39844c1ef904143a9bbb7560d978156-48" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_a39844c1ef904143a9bbb7560d978156-48"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;linspace&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;0.0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;1.0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_a39844c1ef904143a9bbb7560d978156-49" name="rest_code_a39844c1ef904143a9bbb7560d978156-49" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_a39844c1ef904143a9bbb7560d978156-49"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;stiff&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;rhs&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;FEM1D&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;fun&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_a39844c1ef904143a9bbb7560d978156-50" name="rest_code_a39844c1ef904143a9bbb7560d978156-50" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_a39844c1ef904143a9bbb7560d978156-50"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_a39844c1ef904143a9bbb7560d978156-51" name="rest_code_a39844c1ef904143a9bbb7560d978156-51" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_a39844c1ef904143a9bbb7560d978156-51"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="k"&gt;end&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;niter&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;_&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;conj_grad&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;stiff&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="k"&gt;end&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="k"&gt;end&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_a39844c1ef904143a9bbb7560d978156-52" name="rest_code_a39844c1ef904143a9bbb7560d978156-52" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_a39844c1ef904143a9bbb7560d978156-52"&gt;&lt;/a&gt;&lt;span class="w"&gt;                                &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;rhs&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="k"&gt;end&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;rhs&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="k"&gt;end&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_a39844c1ef904143a9bbb7560d978156-53" name="rest_code_a39844c1ef904143a9bbb7560d978156-53" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_a39844c1ef904143a9bbb7560d978156-53"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;err&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;norm&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;.*&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;.^&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="mi"&gt;20&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;norm&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;.*&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;.^&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="mi"&gt;20&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_a39844c1ef904143a9bbb7560d978156-54" name="rest_code_a39844c1ef904143a9bbb7560d978156-54" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_a39844c1ef904143a9bbb7560d978156-54"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;err_vec&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;cont&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;err&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_a39844c1ef904143a9bbb7560d978156-55" name="rest_code_a39844c1ef904143a9bbb7560d978156-55" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_a39844c1ef904143a9bbb7560d978156-55"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;niter_vec&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;cont&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;niter&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_a39844c1ef904143a9bbb7560d978156-56" name="rest_code_a39844c1ef904143a9bbb7560d978156-56" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_a39844c1ef904143a9bbb7560d978156-56"&gt;&lt;/a&gt;&lt;span class="k"&gt;end&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_a39844c1ef904143a9bbb7560d978156-57" name="rest_code_a39844c1ef904143a9bbb7560d978156-57" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_a39844c1ef904143a9bbb7560d978156-57"&gt;&lt;/a&gt;&lt;span class="n"&gt;subplot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;121&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_a39844c1ef904143a9bbb7560d978156-58" name="rest_code_a39844c1ef904143a9bbb7560d978156-58" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_a39844c1ef904143a9bbb7560d978156-58"&gt;&lt;/a&gt;&lt;span class="n"&gt;loglog&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N_vec&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;err_vec&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_a39844c1ef904143a9bbb7560d978156-59" name="rest_code_a39844c1ef904143a9bbb7560d978156-59" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_a39844c1ef904143a9bbb7560d978156-59"&gt;&lt;/a&gt;&lt;span class="n"&gt;xlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;"Number of nodes"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_a39844c1ef904143a9bbb7560d978156-60" name="rest_code_a39844c1ef904143a9bbb7560d978156-60" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_a39844c1ef904143a9bbb7560d978156-60"&gt;&lt;/a&gt;&lt;span class="n"&gt;ylabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;"Relative error"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_a39844c1ef904143a9bbb7560d978156-61" name="rest_code_a39844c1ef904143a9bbb7560d978156-61" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_a39844c1ef904143a9bbb7560d978156-61"&gt;&lt;/a&gt;&lt;span class="n"&gt;subplot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;122&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_a39844c1ef904143a9bbb7560d978156-62" name="rest_code_a39844c1ef904143a9bbb7560d978156-62" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_a39844c1ef904143a9bbb7560d978156-62"&gt;&lt;/a&gt;&lt;span class="n"&gt;loglog&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N_vec&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;niter_vec&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_a39844c1ef904143a9bbb7560d978156-63" name="rest_code_a39844c1ef904143a9bbb7560d978156-63" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_a39844c1ef904143a9bbb7560d978156-63"&gt;&lt;/a&gt;&lt;span class="n"&gt;xlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;"Number of nodes"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_a39844c1ef904143a9bbb7560d978156-64" name="rest_code_a39844c1ef904143a9bbb7560d978156-64" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_a39844c1ef904143a9bbb7560d978156-64"&gt;&lt;/a&gt;&lt;span class="n"&gt;ylabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;"Number of iterations"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_a39844c1ef904143a9bbb7560d978156-65" name="rest_code_a39844c1ef904143a9bbb7560d978156-65" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_a39844c1ef904143a9bbb7560d978156-65"&gt;&lt;/a&gt;&lt;span class="n"&gt;tight_layout&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_a39844c1ef904143a9bbb7560d978156-66" name="rest_code_a39844c1ef904143a9bbb7560d978156-66" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_a39844c1ef904143a9bbb7560d978156-66"&gt;&lt;/a&gt;&lt;span class="n"&gt;show&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;In this case, we are analyzing the error of the solution as a function
of the number of nodes. This, and the number of iterations required
in the conjugate gradient are shown in the following image&lt;/p&gt;
&lt;img alt="Relative error in the solution." class="align-center" src="https://nicoguaro.github.io/images/FEM1D_convergence.svg" style="width: 800px;"&gt;
&lt;/section&gt;
&lt;/section&gt;</description><category>conjugate gradient</category><category>finite element method</category><category>julia</category><category>numerical methods</category><category>python</category><category>scientific computing</category><guid>https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/</guid><pubDate>Wed, 01 Nov 2017 01:45:09 GMT</pubDate></item><item><title>Numerical methods challenge: Day 25</title><link>https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/</link><dc:creator>Nicolás Guarín-Zapata</dc:creator><description>&lt;p&gt;During October (2017) I will write a program per day for some well-known
numerical methods in both Python and Julia. It is intended to be an exercise
then don't expect the code to be good enough for real use. Also,
I should mention that I have almost no experience with Julia, so it
probably won't be idiomatic Julia but more Python-like Julia.&lt;/p&gt;
&lt;section id="finite-element-method"&gt;
&lt;h2&gt;Finite element method&lt;/h2&gt;
&lt;p&gt;Today we have the &lt;a class="reference external" href="https://en.wikipedia.org/wiki/Finite_element_method"&gt;Finite element method&lt;/a&gt;
to solve the equation:&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
\nabla^2 u = -f(x)
\end{equation*}
&lt;/div&gt;
&lt;p&gt;with&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
u(\sqrt{3}, 1) = 0
\end{equation*}
&lt;/div&gt;
&lt;p&gt;As in the &lt;a class="reference external" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/posts/numerical-23"&gt;Ritz method&lt;/a&gt; we form
a functional that is &lt;em&gt;equivalent&lt;/em&gt; to the
differential equation, propose an approximation as a linear combination of
a set of basis functions and find the &lt;em&gt;best&lt;/em&gt; set of coefficients for that
combination. That &lt;em&gt;best&lt;/em&gt; solution is found minimizing the functional.&lt;/p&gt;
&lt;p&gt;The functional for this differential equation is&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
\Pi[u] = -\int_\Omega \left(\nabla u\right)^2 d\Omega
         -\int_\Omega  u f(x) d\Omega
\end{equation*}
&lt;/div&gt;
&lt;p&gt;Using linear triangles, the local stiffness matrices read&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
K_\text{local} =  \frac{1}{2|J|}
    \begin{bmatrix}
        2 &amp;amp; -1 &amp;amp;1\\
        -1 &amp;amp; 1 &amp;amp;0\\
        -1 &amp;amp; 0 &amp;amp;1\\
    \end{bmatrix}
\end{equation*}
&lt;/div&gt;
&lt;p&gt;and&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
b_\text{local} = -|J| f(x_m) \mathbf{1}_3\, ,
\end{equation*}
&lt;/div&gt;
&lt;p&gt;where &lt;span class="math"&gt;\(|J|\)&lt;/span&gt; is the Jacobian determinant of the transformation and
&lt;span class="math"&gt;\(x_m\)&lt;/span&gt; is the centroid of the triangle. I am
skipping a great deal about assembling, but it would be just too extensive
to describe the complete process.&lt;/p&gt;
&lt;p&gt;We will solve the problem in a mesh with 6 triangles forming
a regular hexagon&lt;/p&gt;
&lt;p&gt;Following are the codes.&lt;/p&gt;
&lt;section id="python"&gt;
&lt;h3&gt;Python&lt;/h3&gt;
&lt;div class="code"&gt;&lt;pre class="code python"&gt;&lt;a id="rest_code_163aa7639549400cae5e7a7ef83ecc47-1" name="rest_code_163aa7639549400cae5e7a7ef83ecc47-1" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_163aa7639549400cae5e7a7ef83ecc47-1"&gt;&lt;/a&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;__future__&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;division&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;print_function&lt;/span&gt;
&lt;a id="rest_code_163aa7639549400cae5e7a7ef83ecc47-2" name="rest_code_163aa7639549400cae5e7a7ef83ecc47-2" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_163aa7639549400cae5e7a7ef83ecc47-2"&gt;&lt;/a&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;numpy&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;np&lt;/span&gt;
&lt;a id="rest_code_163aa7639549400cae5e7a7ef83ecc47-3" name="rest_code_163aa7639549400cae5e7a7ef83ecc47-3" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_163aa7639549400cae5e7a7ef83ecc47-3"&gt;&lt;/a&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;matplotlib.pyplot&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;plt&lt;/span&gt;
&lt;a id="rest_code_163aa7639549400cae5e7a7ef83ecc47-4" name="rest_code_163aa7639549400cae5e7a7ef83ecc47-4" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_163aa7639549400cae5e7a7ef83ecc47-4"&gt;&lt;/a&gt;
&lt;a id="rest_code_163aa7639549400cae5e7a7ef83ecc47-5" name="rest_code_163aa7639549400cae5e7a7ef83ecc47-5" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_163aa7639549400cae5e7a7ef83ecc47-5"&gt;&lt;/a&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;assem&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;elems&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;source&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_163aa7639549400cae5e7a7ef83ecc47-6" name="rest_code_163aa7639549400cae5e7a7ef83ecc47-6" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_163aa7639549400cae5e7a7ef83ecc47-6"&gt;&lt;/a&gt;    &lt;span class="n"&gt;ncoords&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;shape&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_163aa7639549400cae5e7a7ef83ecc47-7" name="rest_code_163aa7639549400cae5e7a7ef83ecc47-7" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_163aa7639549400cae5e7a7ef83ecc47-7"&gt;&lt;/a&gt;    &lt;span class="n"&gt;stiff&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="n"&gt;ncoords&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;ncoords&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_163aa7639549400cae5e7a7ef83ecc47-8" name="rest_code_163aa7639549400cae5e7a7ef83ecc47-8" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_163aa7639549400cae5e7a7ef83ecc47-8"&gt;&lt;/a&gt;    &lt;span class="n"&gt;rhs&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="n"&gt;ncoords&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_163aa7639549400cae5e7a7ef83ecc47-9" name="rest_code_163aa7639549400cae5e7a7ef83ecc47-9" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_163aa7639549400cae5e7a7ef83ecc47-9"&gt;&lt;/a&gt;    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;el_cont&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;elem&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;enumerate&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;elems&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_163aa7639549400cae5e7a7ef83ecc47-10" name="rest_code_163aa7639549400cae5e7a7ef83ecc47-10" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_163aa7639549400cae5e7a7ef83ecc47-10"&gt;&lt;/a&gt;        &lt;span class="n"&gt;stiff_loc&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;jaco&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;local_stiff&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;elem&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_163aa7639549400cae5e7a7ef83ecc47-11" name="rest_code_163aa7639549400cae5e7a7ef83ecc47-11" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_163aa7639549400cae5e7a7ef83ecc47-11"&gt;&lt;/a&gt;        &lt;span class="n"&gt;rhs&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;elem&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;+=&lt;/span&gt; &lt;span class="n"&gt;jaco&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;mean&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;source&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;elem&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_163aa7639549400cae5e7a7ef83ecc47-12" name="rest_code_163aa7639549400cae5e7a7ef83ecc47-12" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_163aa7639549400cae5e7a7ef83ecc47-12"&gt;&lt;/a&gt;        &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;row&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_163aa7639549400cae5e7a7ef83ecc47-13" name="rest_code_163aa7639549400cae5e7a7ef83ecc47-13" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_163aa7639549400cae5e7a7ef83ecc47-13"&gt;&lt;/a&gt;            &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;col&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_163aa7639549400cae5e7a7ef83ecc47-14" name="rest_code_163aa7639549400cae5e7a7ef83ecc47-14" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_163aa7639549400cae5e7a7ef83ecc47-14"&gt;&lt;/a&gt;                &lt;span class="n"&gt;row_glob&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;col_glob&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;elem&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;row&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;elem&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_163aa7639549400cae5e7a7ef83ecc47-15" name="rest_code_163aa7639549400cae5e7a7ef83ecc47-15" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_163aa7639549400cae5e7a7ef83ecc47-15"&gt;&lt;/a&gt;                &lt;span class="n"&gt;stiff&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;row_glob&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;col_glob&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;+=&lt;/span&gt; &lt;span class="n"&gt;stiff_loc&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;row&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_163aa7639549400cae5e7a7ef83ecc47-16" name="rest_code_163aa7639549400cae5e7a7ef83ecc47-16" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_163aa7639549400cae5e7a7ef83ecc47-16"&gt;&lt;/a&gt;    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;stiff&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;rhs&lt;/span&gt;
&lt;a id="rest_code_163aa7639549400cae5e7a7ef83ecc47-17" name="rest_code_163aa7639549400cae5e7a7ef83ecc47-17" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_163aa7639549400cae5e7a7ef83ecc47-17"&gt;&lt;/a&gt;
&lt;a id="rest_code_163aa7639549400cae5e7a7ef83ecc47-18" name="rest_code_163aa7639549400cae5e7a7ef83ecc47-18" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_163aa7639549400cae5e7a7ef83ecc47-18"&gt;&lt;/a&gt;
&lt;a id="rest_code_163aa7639549400cae5e7a7ef83ecc47-19" name="rest_code_163aa7639549400cae5e7a7ef83ecc47-19" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_163aa7639549400cae5e7a7ef83ecc47-19"&gt;&lt;/a&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;local_stiff&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_163aa7639549400cae5e7a7ef83ecc47-20" name="rest_code_163aa7639549400cae5e7a7ef83ecc47-20" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_163aa7639549400cae5e7a7ef83ecc47-20"&gt;&lt;/a&gt;    &lt;span class="n"&gt;dHdr&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;([[&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]])&lt;/span&gt;
&lt;a id="rest_code_163aa7639549400cae5e7a7ef83ecc47-21" name="rest_code_163aa7639549400cae5e7a7ef83ecc47-21" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_163aa7639549400cae5e7a7ef83ecc47-21"&gt;&lt;/a&gt;    &lt;span class="n"&gt;jaco&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;dHdr&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;dot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_163aa7639549400cae5e7a7ef83ecc47-22" name="rest_code_163aa7639549400cae5e7a7ef83ecc47-22" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_163aa7639549400cae5e7a7ef83ecc47-22"&gt;&lt;/a&gt;    &lt;span class="n"&gt;stiff&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;0.5&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;([[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]])&lt;/span&gt;
&lt;a id="rest_code_163aa7639549400cae5e7a7ef83ecc47-23" name="rest_code_163aa7639549400cae5e7a7ef83ecc47-23" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_163aa7639549400cae5e7a7ef83ecc47-23"&gt;&lt;/a&gt;    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;stiff&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;linalg&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;det&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;jaco&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;linalg&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;det&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;jaco&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_163aa7639549400cae5e7a7ef83ecc47-24" name="rest_code_163aa7639549400cae5e7a7ef83ecc47-24" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_163aa7639549400cae5e7a7ef83ecc47-24"&gt;&lt;/a&gt;
&lt;a id="rest_code_163aa7639549400cae5e7a7ef83ecc47-25" name="rest_code_163aa7639549400cae5e7a7ef83ecc47-25" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_163aa7639549400cae5e7a7ef83ecc47-25"&gt;&lt;/a&gt;
&lt;a id="rest_code_163aa7639549400cae5e7a7ef83ecc47-26" name="rest_code_163aa7639549400cae5e7a7ef83ecc47-26" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_163aa7639549400cae5e7a7ef83ecc47-26"&gt;&lt;/a&gt;&lt;span class="n"&gt;sq3&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sqrt&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_163aa7639549400cae5e7a7ef83ecc47-27" name="rest_code_163aa7639549400cae5e7a7ef83ecc47-27" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_163aa7639549400cae5e7a7ef83ecc47-27"&gt;&lt;/a&gt;&lt;span class="n"&gt;coords&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;
&lt;a id="rest_code_163aa7639549400cae5e7a7ef83ecc47-28" name="rest_code_163aa7639549400cae5e7a7ef83ecc47-28" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_163aa7639549400cae5e7a7ef83ecc47-28"&gt;&lt;/a&gt;        &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;sq3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;
&lt;a id="rest_code_163aa7639549400cae5e7a7ef83ecc47-29" name="rest_code_163aa7639549400cae5e7a7ef83ecc47-29" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_163aa7639549400cae5e7a7ef83ecc47-29"&gt;&lt;/a&gt;        &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;
&lt;a id="rest_code_163aa7639549400cae5e7a7ef83ecc47-30" name="rest_code_163aa7639549400cae5e7a7ef83ecc47-30" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_163aa7639549400cae5e7a7ef83ecc47-30"&gt;&lt;/a&gt;        &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;sq3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;
&lt;a id="rest_code_163aa7639549400cae5e7a7ef83ecc47-31" name="rest_code_163aa7639549400cae5e7a7ef83ecc47-31" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_163aa7639549400cae5e7a7ef83ecc47-31"&gt;&lt;/a&gt;        &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;
&lt;a id="rest_code_163aa7639549400cae5e7a7ef83ecc47-32" name="rest_code_163aa7639549400cae5e7a7ef83ecc47-32" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_163aa7639549400cae5e7a7ef83ecc47-32"&gt;&lt;/a&gt;        &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;sq3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;
&lt;a id="rest_code_163aa7639549400cae5e7a7ef83ecc47-33" name="rest_code_163aa7639549400cae5e7a7ef83ecc47-33" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_163aa7639549400cae5e7a7ef83ecc47-33"&gt;&lt;/a&gt;        &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;sq3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;
&lt;a id="rest_code_163aa7639549400cae5e7a7ef83ecc47-34" name="rest_code_163aa7639549400cae5e7a7ef83ecc47-34" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_163aa7639549400cae5e7a7ef83ecc47-34"&gt;&lt;/a&gt;        &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;sq3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]])&lt;/span&gt;
&lt;a id="rest_code_163aa7639549400cae5e7a7ef83ecc47-35" name="rest_code_163aa7639549400cae5e7a7ef83ecc47-35" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_163aa7639549400cae5e7a7ef83ecc47-35"&gt;&lt;/a&gt;&lt;span class="n"&gt;elems&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;
&lt;a id="rest_code_163aa7639549400cae5e7a7ef83ecc47-36" name="rest_code_163aa7639549400cae5e7a7ef83ecc47-36" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_163aa7639549400cae5e7a7ef83ecc47-36"&gt;&lt;/a&gt;        &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;6&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;
&lt;a id="rest_code_163aa7639549400cae5e7a7ef83ecc47-37" name="rest_code_163aa7639549400cae5e7a7ef83ecc47-37" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_163aa7639549400cae5e7a7ef83ecc47-37"&gt;&lt;/a&gt;        &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;6&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;
&lt;a id="rest_code_163aa7639549400cae5e7a7ef83ecc47-38" name="rest_code_163aa7639549400cae5e7a7ef83ecc47-38" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_163aa7639549400cae5e7a7ef83ecc47-38"&gt;&lt;/a&gt;        &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;6&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;
&lt;a id="rest_code_163aa7639549400cae5e7a7ef83ecc47-39" name="rest_code_163aa7639549400cae5e7a7ef83ecc47-39" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_163aa7639549400cae5e7a7ef83ecc47-39"&gt;&lt;/a&gt;        &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;6&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;
&lt;a id="rest_code_163aa7639549400cae5e7a7ef83ecc47-40" name="rest_code_163aa7639549400cae5e7a7ef83ecc47-40" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_163aa7639549400cae5e7a7ef83ecc47-40"&gt;&lt;/a&gt;        &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;6&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;
&lt;a id="rest_code_163aa7639549400cae5e7a7ef83ecc47-41" name="rest_code_163aa7639549400cae5e7a7ef83ecc47-41" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_163aa7639549400cae5e7a7ef83ecc47-41"&gt;&lt;/a&gt;        &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;6&lt;/span&gt;&lt;span class="p"&gt;]])&lt;/span&gt;
&lt;a id="rest_code_163aa7639549400cae5e7a7ef83ecc47-42" name="rest_code_163aa7639549400cae5e7a7ef83ecc47-42" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_163aa7639549400cae5e7a7ef83ecc47-42"&gt;&lt;/a&gt;&lt;span class="n"&gt;source&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ones&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;7&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_163aa7639549400cae5e7a7ef83ecc47-43" name="rest_code_163aa7639549400cae5e7a7ef83ecc47-43" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_163aa7639549400cae5e7a7ef83ecc47-43"&gt;&lt;/a&gt;&lt;span class="n"&gt;stiff&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;rhs&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;assem&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;elems&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;source&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_163aa7639549400cae5e7a7ef83ecc47-44" name="rest_code_163aa7639549400cae5e7a7ef83ecc47-44" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_163aa7639549400cae5e7a7ef83ecc47-44"&gt;&lt;/a&gt;&lt;span class="n"&gt;free&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;6&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_163aa7639549400cae5e7a7ef83ecc47-45" name="rest_code_163aa7639549400cae5e7a7ef83ecc47-45" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_163aa7639549400cae5e7a7ef83ecc47-45"&gt;&lt;/a&gt;&lt;span class="n"&gt;sol&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;linalg&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;solve&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;stiff&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ix_&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;free&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;free&lt;/span&gt;&lt;span class="p"&gt;)],&lt;/span&gt; &lt;span class="n"&gt;rhs&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;free&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_163aa7639549400cae5e7a7ef83ecc47-46" name="rest_code_163aa7639549400cae5e7a7ef83ecc47-46" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_163aa7639549400cae5e7a7ef83ecc47-46"&gt;&lt;/a&gt;&lt;span class="n"&gt;sol_c&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;shape&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_163aa7639549400cae5e7a7ef83ecc47-47" name="rest_code_163aa7639549400cae5e7a7ef83ecc47-47" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_163aa7639549400cae5e7a7ef83ecc47-47"&gt;&lt;/a&gt;&lt;span class="n"&gt;sol_c&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;free&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;sol&lt;/span&gt;
&lt;a id="rest_code_163aa7639549400cae5e7a7ef83ecc47-48" name="rest_code_163aa7639549400cae5e7a7ef83ecc47-48" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_163aa7639549400cae5e7a7ef83ecc47-48"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;tricontourf&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;[:,&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;[:,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;sol_c&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;cmap&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;"hot"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_163aa7639549400cae5e7a7ef83ecc47-49" name="rest_code_163aa7639549400cae5e7a7ef83ecc47-49" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_163aa7639549400cae5e7a7ef83ecc47-49"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;colorbar&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a id="rest_code_163aa7639549400cae5e7a7ef83ecc47-50" name="rest_code_163aa7639549400cae5e7a7ef83ecc47-50" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_163aa7639549400cae5e7a7ef83ecc47-50"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;axis&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"image"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_163aa7639549400cae5e7a7ef83ecc47-51" name="rest_code_163aa7639549400cae5e7a7ef83ecc47-51" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_163aa7639549400cae5e7a7ef83ecc47-51"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;show&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/section&gt;
&lt;section id="julia"&gt;
&lt;h3&gt;Julia&lt;/h3&gt;
&lt;div class="code"&gt;&lt;pre class="code julia"&gt;&lt;a id="rest_code_03da15fc08ef4c78ab921012d3255e6f-1" name="rest_code_03da15fc08ef4c78ab921012d3255e6f-1" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_03da15fc08ef4c78ab921012d3255e6f-1"&gt;&lt;/a&gt;&lt;span class="k"&gt;using&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;PyPlot&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_03da15fc08ef4c78ab921012d3255e6f-2" name="rest_code_03da15fc08ef4c78ab921012d3255e6f-2" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_03da15fc08ef4c78ab921012d3255e6f-2"&gt;&lt;/a&gt;
&lt;a id="rest_code_03da15fc08ef4c78ab921012d3255e6f-3" name="rest_code_03da15fc08ef4c78ab921012d3255e6f-3" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_03da15fc08ef4c78ab921012d3255e6f-3"&gt;&lt;/a&gt;
&lt;a id="rest_code_03da15fc08ef4c78ab921012d3255e6f-4" name="rest_code_03da15fc08ef4c78ab921012d3255e6f-4" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_03da15fc08ef4c78ab921012d3255e6f-4"&gt;&lt;/a&gt;&lt;span class="k"&gt;function&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;assem&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;elems&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;source&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_03da15fc08ef4c78ab921012d3255e6f-5" name="rest_code_03da15fc08ef4c78ab921012d3255e6f-5" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_03da15fc08ef4c78ab921012d3255e6f-5"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;ncoords&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;size&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;)[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_03da15fc08ef4c78ab921012d3255e6f-6" name="rest_code_03da15fc08ef4c78ab921012d3255e6f-6" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_03da15fc08ef4c78ab921012d3255e6f-6"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;nelems&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;size&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;elems&lt;/span&gt;&lt;span class="p"&gt;)[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_03da15fc08ef4c78ab921012d3255e6f-7" name="rest_code_03da15fc08ef4c78ab921012d3255e6f-7" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_03da15fc08ef4c78ab921012d3255e6f-7"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;stiff&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ncoords&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ncoords&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_03da15fc08ef4c78ab921012d3255e6f-8" name="rest_code_03da15fc08ef4c78ab921012d3255e6f-8" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_03da15fc08ef4c78ab921012d3255e6f-8"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;rhs&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ncoords&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_03da15fc08ef4c78ab921012d3255e6f-9" name="rest_code_03da15fc08ef4c78ab921012d3255e6f-9" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_03da15fc08ef4c78ab921012d3255e6f-9"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;for&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;el_cont&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="n"&gt;nelems&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_03da15fc08ef4c78ab921012d3255e6f-10" name="rest_code_03da15fc08ef4c78ab921012d3255e6f-10" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_03da15fc08ef4c78ab921012d3255e6f-10"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;elem&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;elems&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;el_cont&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_03da15fc08ef4c78ab921012d3255e6f-11" name="rest_code_03da15fc08ef4c78ab921012d3255e6f-11" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_03da15fc08ef4c78ab921012d3255e6f-11"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;stiff_loc&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;jaco&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;local_stiff&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;elem&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_03da15fc08ef4c78ab921012d3255e6f-12" name="rest_code_03da15fc08ef4c78ab921012d3255e6f-12" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_03da15fc08ef4c78ab921012d3255e6f-12"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;rhs&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;elem&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;jaco&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;mean&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;source&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;elem&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_03da15fc08ef4c78ab921012d3255e6f-13" name="rest_code_03da15fc08ef4c78ab921012d3255e6f-13" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_03da15fc08ef4c78ab921012d3255e6f-13"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="k"&gt;for&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;row&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_03da15fc08ef4c78ab921012d3255e6f-14" name="rest_code_03da15fc08ef4c78ab921012d3255e6f-14" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_03da15fc08ef4c78ab921012d3255e6f-14"&gt;&lt;/a&gt;&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="k"&gt;for&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_03da15fc08ef4c78ab921012d3255e6f-15" name="rest_code_03da15fc08ef4c78ab921012d3255e6f-15" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_03da15fc08ef4c78ab921012d3255e6f-15"&gt;&lt;/a&gt;&lt;span class="w"&gt;                &lt;/span&gt;&lt;span class="n"&gt;row_glob&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;elem&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;row&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_03da15fc08ef4c78ab921012d3255e6f-16" name="rest_code_03da15fc08ef4c78ab921012d3255e6f-16" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_03da15fc08ef4c78ab921012d3255e6f-16"&gt;&lt;/a&gt;&lt;span class="w"&gt;                &lt;/span&gt;&lt;span class="n"&gt;col_glob&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;elem&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_03da15fc08ef4c78ab921012d3255e6f-17" name="rest_code_03da15fc08ef4c78ab921012d3255e6f-17" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_03da15fc08ef4c78ab921012d3255e6f-17"&gt;&lt;/a&gt;&lt;span class="w"&gt;                &lt;/span&gt;&lt;span class="n"&gt;stiff&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;row_glob&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;col_glob&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;stiff_loc&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;row&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_03da15fc08ef4c78ab921012d3255e6f-18" name="rest_code_03da15fc08ef4c78ab921012d3255e6f-18" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_03da15fc08ef4c78ab921012d3255e6f-18"&gt;&lt;/a&gt;&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="k"&gt;end&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_03da15fc08ef4c78ab921012d3255e6f-19" name="rest_code_03da15fc08ef4c78ab921012d3255e6f-19" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_03da15fc08ef4c78ab921012d3255e6f-19"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="k"&gt;end&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_03da15fc08ef4c78ab921012d3255e6f-20" name="rest_code_03da15fc08ef4c78ab921012d3255e6f-20" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_03da15fc08ef4c78ab921012d3255e6f-20"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;end&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_03da15fc08ef4c78ab921012d3255e6f-21" name="rest_code_03da15fc08ef4c78ab921012d3255e6f-21" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_03da15fc08ef4c78ab921012d3255e6f-21"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;return&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;stiff&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;rhs&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_03da15fc08ef4c78ab921012d3255e6f-22" name="rest_code_03da15fc08ef4c78ab921012d3255e6f-22" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_03da15fc08ef4c78ab921012d3255e6f-22"&gt;&lt;/a&gt;&lt;span class="k"&gt;end&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_03da15fc08ef4c78ab921012d3255e6f-23" name="rest_code_03da15fc08ef4c78ab921012d3255e6f-23" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_03da15fc08ef4c78ab921012d3255e6f-23"&gt;&lt;/a&gt;
&lt;a id="rest_code_03da15fc08ef4c78ab921012d3255e6f-24" name="rest_code_03da15fc08ef4c78ab921012d3255e6f-24" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_03da15fc08ef4c78ab921012d3255e6f-24"&gt;&lt;/a&gt;
&lt;a id="rest_code_03da15fc08ef4c78ab921012d3255e6f-25" name="rest_code_03da15fc08ef4c78ab921012d3255e6f-25" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_03da15fc08ef4c78ab921012d3255e6f-25"&gt;&lt;/a&gt;&lt;span class="k"&gt;function&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;local_stiff&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_03da15fc08ef4c78ab921012d3255e6f-26" name="rest_code_03da15fc08ef4c78ab921012d3255e6f-26" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_03da15fc08ef4c78ab921012d3255e6f-26"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;dHdr&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_03da15fc08ef4c78ab921012d3255e6f-27" name="rest_code_03da15fc08ef4c78ab921012d3255e6f-27" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_03da15fc08ef4c78ab921012d3255e6f-27"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;jaco&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;dHdr&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_03da15fc08ef4c78ab921012d3255e6f-28" name="rest_code_03da15fc08ef4c78ab921012d3255e6f-28" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_03da15fc08ef4c78ab921012d3255e6f-28"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;stiff&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;0.5&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_03da15fc08ef4c78ab921012d3255e6f-29" name="rest_code_03da15fc08ef4c78ab921012d3255e6f-29" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_03da15fc08ef4c78ab921012d3255e6f-29"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;return&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;stiff&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;det&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;jaco&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;det&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;jaco&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_03da15fc08ef4c78ab921012d3255e6f-30" name="rest_code_03da15fc08ef4c78ab921012d3255e6f-30" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_03da15fc08ef4c78ab921012d3255e6f-30"&gt;&lt;/a&gt;&lt;span class="k"&gt;end&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_03da15fc08ef4c78ab921012d3255e6f-31" name="rest_code_03da15fc08ef4c78ab921012d3255e6f-31" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_03da15fc08ef4c78ab921012d3255e6f-31"&gt;&lt;/a&gt;
&lt;a id="rest_code_03da15fc08ef4c78ab921012d3255e6f-32" name="rest_code_03da15fc08ef4c78ab921012d3255e6f-32" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_03da15fc08ef4c78ab921012d3255e6f-32"&gt;&lt;/a&gt;
&lt;a id="rest_code_03da15fc08ef4c78ab921012d3255e6f-33" name="rest_code_03da15fc08ef4c78ab921012d3255e6f-33" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_03da15fc08ef4c78ab921012d3255e6f-33"&gt;&lt;/a&gt;&lt;span class="n"&gt;sq3&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;sqrt&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_03da15fc08ef4c78ab921012d3255e6f-34" name="rest_code_03da15fc08ef4c78ab921012d3255e6f-34" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_03da15fc08ef4c78ab921012d3255e6f-34"&gt;&lt;/a&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;sq3&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_03da15fc08ef4c78ab921012d3255e6f-35" name="rest_code_03da15fc08ef4c78ab921012d3255e6f-35" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_03da15fc08ef4c78ab921012d3255e6f-35"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_03da15fc08ef4c78ab921012d3255e6f-36" name="rest_code_03da15fc08ef4c78ab921012d3255e6f-36" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_03da15fc08ef4c78ab921012d3255e6f-36"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;sq3&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_03da15fc08ef4c78ab921012d3255e6f-37" name="rest_code_03da15fc08ef4c78ab921012d3255e6f-37" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_03da15fc08ef4c78ab921012d3255e6f-37"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_03da15fc08ef4c78ab921012d3255e6f-38" name="rest_code_03da15fc08ef4c78ab921012d3255e6f-38" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_03da15fc08ef4c78ab921012d3255e6f-38"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;sq3&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_03da15fc08ef4c78ab921012d3255e6f-39" name="rest_code_03da15fc08ef4c78ab921012d3255e6f-39" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_03da15fc08ef4c78ab921012d3255e6f-39"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;sq3&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_03da15fc08ef4c78ab921012d3255e6f-40" name="rest_code_03da15fc08ef4c78ab921012d3255e6f-40" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_03da15fc08ef4c78ab921012d3255e6f-40"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;sq3&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_03da15fc08ef4c78ab921012d3255e6f-41" name="rest_code_03da15fc08ef4c78ab921012d3255e6f-41" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_03da15fc08ef4c78ab921012d3255e6f-41"&gt;&lt;/a&gt;&lt;span class="n"&gt;elems&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;7&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_03da15fc08ef4c78ab921012d3255e6f-42" name="rest_code_03da15fc08ef4c78ab921012d3255e6f-42" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_03da15fc08ef4c78ab921012d3255e6f-42"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;7&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_03da15fc08ef4c78ab921012d3255e6f-43" name="rest_code_03da15fc08ef4c78ab921012d3255e6f-43" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_03da15fc08ef4c78ab921012d3255e6f-43"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;7&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_03da15fc08ef4c78ab921012d3255e6f-44" name="rest_code_03da15fc08ef4c78ab921012d3255e6f-44" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_03da15fc08ef4c78ab921012d3255e6f-44"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;6&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;7&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_03da15fc08ef4c78ab921012d3255e6f-45" name="rest_code_03da15fc08ef4c78ab921012d3255e6f-45" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_03da15fc08ef4c78ab921012d3255e6f-45"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="mi"&gt;6&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;7&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_03da15fc08ef4c78ab921012d3255e6f-46" name="rest_code_03da15fc08ef4c78ab921012d3255e6f-46" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_03da15fc08ef4c78ab921012d3255e6f-46"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;7&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_03da15fc08ef4c78ab921012d3255e6f-47" name="rest_code_03da15fc08ef4c78ab921012d3255e6f-47" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_03da15fc08ef4c78ab921012d3255e6f-47"&gt;&lt;/a&gt;&lt;span class="n"&gt;source&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;ones&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;7&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_03da15fc08ef4c78ab921012d3255e6f-48" name="rest_code_03da15fc08ef4c78ab921012d3255e6f-48" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_03da15fc08ef4c78ab921012d3255e6f-48"&gt;&lt;/a&gt;&lt;span class="n"&gt;stiff&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;rhs&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;assem&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;elems&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;source&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_03da15fc08ef4c78ab921012d3255e6f-49" name="rest_code_03da15fc08ef4c78ab921012d3255e6f-49" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_03da15fc08ef4c78ab921012d3255e6f-49"&gt;&lt;/a&gt;&lt;span class="n"&gt;free&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;6&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_03da15fc08ef4c78ab921012d3255e6f-50" name="rest_code_03da15fc08ef4c78ab921012d3255e6f-50" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_03da15fc08ef4c78ab921012d3255e6f-50"&gt;&lt;/a&gt;&lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;stiff&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;free&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;free&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;\&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;rhs&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;free&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_03da15fc08ef4c78ab921012d3255e6f-51" name="rest_code_03da15fc08ef4c78ab921012d3255e6f-51" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_03da15fc08ef4c78ab921012d3255e6f-51"&gt;&lt;/a&gt;&lt;span class="n"&gt;sol_c&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;size&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;)[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_03da15fc08ef4c78ab921012d3255e6f-52" name="rest_code_03da15fc08ef4c78ab921012d3255e6f-52" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_03da15fc08ef4c78ab921012d3255e6f-52"&gt;&lt;/a&gt;&lt;span class="n"&gt;sol_c&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;free&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_03da15fc08ef4c78ab921012d3255e6f-53" name="rest_code_03da15fc08ef4c78ab921012d3255e6f-53" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_03da15fc08ef4c78ab921012d3255e6f-53"&gt;&lt;/a&gt;&lt;span class="n"&gt;tricontourf&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;sol_c&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;cmap&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;"hot"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_03da15fc08ef4c78ab921012d3255e6f-54" name="rest_code_03da15fc08ef4c78ab921012d3255e6f-54" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_03da15fc08ef4c78ab921012d3255e6f-54"&gt;&lt;/a&gt;&lt;span class="n"&gt;colorbar&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_03da15fc08ef4c78ab921012d3255e6f-55" name="rest_code_03da15fc08ef4c78ab921012d3255e6f-55" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_03da15fc08ef4c78ab921012d3255e6f-55"&gt;&lt;/a&gt;&lt;span class="n"&gt;axis&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;"image"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_03da15fc08ef4c78ab921012d3255e6f-56" name="rest_code_03da15fc08ef4c78ab921012d3255e6f-56" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_03da15fc08ef4c78ab921012d3255e6f-56"&gt;&lt;/a&gt;&lt;span class="n"&gt;show&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Both have the same result, as follows&lt;/p&gt;
&lt;img alt="Finite element method approximation." class="align-center" src="https://nicoguaro.github.io/images/FEM2D.svg" style="width: 500px;"&gt;
&lt;/section&gt;
&lt;section id="comparison-python-julia"&gt;
&lt;h3&gt;Comparison Python/Julia&lt;/h3&gt;
&lt;p&gt;Regarding number of lines we have: 51 in Python and 56 in Julia. The comparison
in execution time is done with &lt;code class="docutils literal"&gt;%timeit&lt;/code&gt; magic command in IPython and
&lt;code class="docutils literal"&gt;@benchmark&lt;/code&gt; in Julia. For the test we are just comparing the time it takes
to generate the matrices.&lt;/p&gt;
&lt;p&gt;For Python:&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code IPython"&gt;&lt;a id="rest_code_8f4004ad33eb4660b99c7ee99b3af9cd-1" name="rest_code_8f4004ad33eb4660b99c7ee99b3af9cd-1" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_8f4004ad33eb4660b99c7ee99b3af9cd-1"&gt;&lt;/a&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="k"&gt;timeit&lt;/span&gt; assem(coords, elems, source)
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;with result&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code text"&gt;&lt;a id="rest_code_3ef6b6dde4574140babcde3b4bbb9f51-1" name="rest_code_3ef6b6dde4574140babcde3b4bbb9f51-1" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_3ef6b6dde4574140babcde3b4bbb9f51-1"&gt;&lt;/a&gt;1000 loops, best of 3: 671 µs per loop
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;For Julia:&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code julia"&gt;&lt;a id="rest_code_794b9491dbf34965b5a01af2ef974692-1" name="rest_code_794b9491dbf34965b5a01af2ef974692-1" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_794b9491dbf34965b5a01af2ef974692-1"&gt;&lt;/a&gt;&lt;span class="nd"&gt;@benchmark&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;assem&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;elems&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;source&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;with result&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code julia"&gt;&lt;a id="rest_code_032c2460678a4536aff56ce06139be28-1" name="rest_code_032c2460678a4536aff56ce06139be28-1" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_032c2460678a4536aff56ce06139be28-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;BenchmarkTools&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Trial&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_032c2460678a4536aff56ce06139be28-2" name="rest_code_032c2460678a4536aff56ce06139be28-2" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_032c2460678a4536aff56ce06139be28-2"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;memory&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;estimate&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="mf"&gt;13.30&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;KiB&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_032c2460678a4536aff56ce06139be28-3" name="rest_code_032c2460678a4536aff56ce06139be28-3" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_032c2460678a4536aff56ce06139be28-3"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;allocs&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;estimate&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="mi"&gt;179&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_032c2460678a4536aff56ce06139be28-4" name="rest_code_032c2460678a4536aff56ce06139be28-4" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_032c2460678a4536aff56ce06139be28-4"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="o"&gt;--------------&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_032c2460678a4536aff56ce06139be28-5" name="rest_code_032c2460678a4536aff56ce06139be28-5" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_032c2460678a4536aff56ce06139be28-5"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;minimum&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;     &lt;/span&gt;&lt;span class="mf"&gt;7.777&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;μs&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;0.00&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;GC&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_032c2460678a4536aff56ce06139be28-6" name="rest_code_032c2460678a4536aff56ce06139be28-6" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_032c2460678a4536aff56ce06139be28-6"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;median&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="mf"&gt;8.934&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;μs&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;0.00&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;GC&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_032c2460678a4536aff56ce06139be28-7" name="rest_code_032c2460678a4536aff56ce06139be28-7" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_032c2460678a4536aff56ce06139be28-7"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;mean&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="mf"&gt;10.810&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;μs&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;14.54&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;GC&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_032c2460678a4536aff56ce06139be28-8" name="rest_code_032c2460678a4536aff56ce06139be28-8" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_032c2460678a4536aff56ce06139be28-8"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;maximum&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;     &lt;/span&gt;&lt;span class="mf"&gt;797.432&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;μs&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;95.85&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;GC&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_032c2460678a4536aff56ce06139be28-9" name="rest_code_032c2460678a4536aff56ce06139be28-9" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_032c2460678a4536aff56ce06139be28-9"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="o"&gt;--------------&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_032c2460678a4536aff56ce06139be28-10" name="rest_code_032c2460678a4536aff56ce06139be28-10" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_032c2460678a4536aff56ce06139be28-10"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;samples&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;          &lt;/span&gt;&lt;span class="mi"&gt;10000&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_032c2460678a4536aff56ce06139be28-11" name="rest_code_032c2460678a4536aff56ce06139be28-11" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_032c2460678a4536aff56ce06139be28-11"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;evals&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;sample&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;     &lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;In this case, we can say that the Python code is about 70 times slower than
Julia code.&lt;/p&gt;
&lt;/section&gt;
&lt;/section&gt;</description><category>finite element method</category><category>julia</category><category>numerical methods</category><category>python</category><category>scientific computing</category><guid>https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/</guid><pubDate>Thu, 26 Oct 2017 02:41:53 GMT</pubDate></item><item><title>Numerical methods challenge: Day 24</title><link>https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/</link><dc:creator>Nicolás Guarín-Zapata</dc:creator><description>&lt;p&gt;During October (2017) I will write a program per day for some well-known
numerical methods in both Python and Julia. It is intended to be an exercise
then don't expect the code to be good enough for real use. Also,
I should mention that I have almost no experience with Julia, so it
probably won't be idiomatic Julia but more Python-like Julia.&lt;/p&gt;
&lt;section id="finite-element-method"&gt;
&lt;h2&gt;Finite element method&lt;/h2&gt;
&lt;p&gt;Today we have the &lt;a class="reference external" href="https://en.wikipedia.org/wiki/Finite_element_method"&gt;Finite element method&lt;/a&gt;
to solve the equation:&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
\frac{d^2 u}{dx^2} = f(x)
\end{equation*}
&lt;/div&gt;
&lt;p&gt;with&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
u(0) = u(1)  = 0
\end{equation*}
&lt;/div&gt;
&lt;p&gt;As in the &lt;a class="reference external" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/posts/numerical-23"&gt;Ritz method&lt;/a&gt; we form
a functional that is &lt;em&gt;equivalent&lt;/em&gt; to the
differential equation, propose an approximation as a linear combination of
a set of basis functions and find the &lt;em&gt;best&lt;/em&gt; set of coefficients for that
combination. That &lt;em&gt;best&lt;/em&gt; solution is found minimizing the functional.&lt;/p&gt;
&lt;p&gt;The functional for this differential equation is&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
\Pi[u] = -\int_{0}^{1} \left(\frac{d u}{d x}\right)^2 dx
         -\int_{0}^{1}  u f(x) dx
\end{equation*}
&lt;/div&gt;
&lt;p&gt;The main difference is that we use a piecewise interpolation for the basis
functions,&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
\hat{u}(x) = \sum_{n=0}^{N} u_n N_n(x)\, ,
\end{equation*}
&lt;/div&gt;
&lt;p&gt;this leads to the system of equations&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
[K]\{\mathbf{c}\} = \{\mathbf{b}\}
\end{equation*}
&lt;/div&gt;
&lt;p&gt;where the local stiffness matrices read&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
K_\text{local} =  \frac{1}{|J|}\begin{bmatrix} 2 &amp;amp; -2\\ -2 &amp;amp;2\end{bmatrix}
\end{equation*}
&lt;/div&gt;
&lt;p&gt;and&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
b_\text{local} = -|J|\begin{bmatrix} f(x_m)\\ f(x_{n})\end{bmatrix}\, ,
\end{equation*}
&lt;/div&gt;
&lt;p&gt;where &lt;span class="math"&gt;\(|J|\)&lt;/span&gt; is the Jacobian determinant of the transformation. I am
skipping a great deal about assembling, but it would be just too extensive
to describe the complete process.&lt;/p&gt;
&lt;p&gt;We will test the implementation with the function &lt;span class="math"&gt;\(f(x) = x^3\)&lt;/span&gt;, that
leads to the solution&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
u(x) = \frac{x (x^4 - 1)}{20}
\end{equation*}
&lt;/div&gt;
&lt;p&gt;Following are the codes.&lt;/p&gt;
&lt;section id="python"&gt;
&lt;h3&gt;Python&lt;/h3&gt;
&lt;div class="code"&gt;&lt;pre class="code python"&gt;&lt;a id="rest_code_3da53e68053b4437a142b690f80db43e-1" name="rest_code_3da53e68053b4437a142b690f80db43e-1" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_3da53e68053b4437a142b690f80db43e-1"&gt;&lt;/a&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;__future__&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;division&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;print_function&lt;/span&gt;
&lt;a id="rest_code_3da53e68053b4437a142b690f80db43e-2" name="rest_code_3da53e68053b4437a142b690f80db43e-2" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_3da53e68053b4437a142b690f80db43e-2"&gt;&lt;/a&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;numpy&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;np&lt;/span&gt;
&lt;a id="rest_code_3da53e68053b4437a142b690f80db43e-3" name="rest_code_3da53e68053b4437a142b690f80db43e-3" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_3da53e68053b4437a142b690f80db43e-3"&gt;&lt;/a&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;matplotlib.pyplot&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;plt&lt;/span&gt;
&lt;a id="rest_code_3da53e68053b4437a142b690f80db43e-4" name="rest_code_3da53e68053b4437a142b690f80db43e-4" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_3da53e68053b4437a142b690f80db43e-4"&gt;&lt;/a&gt;
&lt;a id="rest_code_3da53e68053b4437a142b690f80db43e-5" name="rest_code_3da53e68053b4437a142b690f80db43e-5" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_3da53e68053b4437a142b690f80db43e-5"&gt;&lt;/a&gt;
&lt;a id="rest_code_3da53e68053b4437a142b690f80db43e-6" name="rest_code_3da53e68053b4437a142b690f80db43e-6" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_3da53e68053b4437a142b690f80db43e-6"&gt;&lt;/a&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;FEM1D&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;source&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_3da53e68053b4437a142b690f80db43e-7" name="rest_code_3da53e68053b4437a142b690f80db43e-7" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_3da53e68053b4437a142b690f80db43e-7"&gt;&lt;/a&gt;    &lt;span class="n"&gt;N&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_3da53e68053b4437a142b690f80db43e-8" name="rest_code_3da53e68053b4437a142b690f80db43e-8" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_3da53e68053b4437a142b690f80db43e-8"&gt;&lt;/a&gt;    &lt;span class="n"&gt;stiff_loc&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;([[&lt;/span&gt;&lt;span class="mf"&gt;2.0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;2.0&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;2.0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;2.0&lt;/span&gt;&lt;span class="p"&gt;]])&lt;/span&gt;
&lt;a id="rest_code_3da53e68053b4437a142b690f80db43e-9" name="rest_code_3da53e68053b4437a142b690f80db43e-9" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_3da53e68053b4437a142b690f80db43e-9"&gt;&lt;/a&gt;    &lt;span class="n"&gt;eles&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="n"&gt;cont&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;cont&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;cont&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;N&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)]&lt;/span&gt;
&lt;a id="rest_code_3da53e68053b4437a142b690f80db43e-10" name="rest_code_3da53e68053b4437a142b690f80db43e-10" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_3da53e68053b4437a142b690f80db43e-10"&gt;&lt;/a&gt;    &lt;span class="n"&gt;stiff&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_3da53e68053b4437a142b690f80db43e-11" name="rest_code_3da53e68053b4437a142b690f80db43e-11" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_3da53e68053b4437a142b690f80db43e-11"&gt;&lt;/a&gt;    &lt;span class="n"&gt;rhs&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_3da53e68053b4437a142b690f80db43e-12" name="rest_code_3da53e68053b4437a142b690f80db43e-12" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_3da53e68053b4437a142b690f80db43e-12"&gt;&lt;/a&gt;    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;ele&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;eles&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a id="rest_code_3da53e68053b4437a142b690f80db43e-13" name="rest_code_3da53e68053b4437a142b690f80db43e-13" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_3da53e68053b4437a142b690f80db43e-13"&gt;&lt;/a&gt;        &lt;span class="n"&gt;jaco&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ele&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]]&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ele&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]]&lt;/span&gt;
&lt;a id="rest_code_3da53e68053b4437a142b690f80db43e-14" name="rest_code_3da53e68053b4437a142b690f80db43e-14" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_3da53e68053b4437a142b690f80db43e-14"&gt;&lt;/a&gt;        &lt;span class="n"&gt;rhs&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ele&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;rhs&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ele&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;jaco&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;source&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ele&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_3da53e68053b4437a142b690f80db43e-15" name="rest_code_3da53e68053b4437a142b690f80db43e-15" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_3da53e68053b4437a142b690f80db43e-15"&gt;&lt;/a&gt;        &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;cont1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;row&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;enumerate&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ele&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_3da53e68053b4437a142b690f80db43e-16" name="rest_code_3da53e68053b4437a142b690f80db43e-16" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_3da53e68053b4437a142b690f80db43e-16"&gt;&lt;/a&gt;            &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;cont2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;col&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;enumerate&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ele&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_3da53e68053b4437a142b690f80db43e-17" name="rest_code_3da53e68053b4437a142b690f80db43e-17" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_3da53e68053b4437a142b690f80db43e-17"&gt;&lt;/a&gt;                &lt;span class="n"&gt;stiff&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;row&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;stiff&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;row&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt;  &lt;span class="n"&gt;stiff_loc&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;cont1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;cont2&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;jaco&lt;/span&gt;
&lt;a id="rest_code_3da53e68053b4437a142b690f80db43e-18" name="rest_code_3da53e68053b4437a142b690f80db43e-18" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_3da53e68053b4437a142b690f80db43e-18"&gt;&lt;/a&gt;    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;stiff&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;rhs&lt;/span&gt;
&lt;a id="rest_code_3da53e68053b4437a142b690f80db43e-19" name="rest_code_3da53e68053b4437a142b690f80db43e-19" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_3da53e68053b4437a142b690f80db43e-19"&gt;&lt;/a&gt;
&lt;a id="rest_code_3da53e68053b4437a142b690f80db43e-20" name="rest_code_3da53e68053b4437a142b690f80db43e-20" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_3da53e68053b4437a142b690f80db43e-20"&gt;&lt;/a&gt;
&lt;a id="rest_code_3da53e68053b4437a142b690f80db43e-21" name="rest_code_3da53e68053b4437a142b690f80db43e-21" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_3da53e68053b4437a142b690f80db43e-21"&gt;&lt;/a&gt;&lt;span class="n"&gt;N&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;100&lt;/span&gt;
&lt;a id="rest_code_3da53e68053b4437a142b690f80db43e-22" name="rest_code_3da53e68053b4437a142b690f80db43e-22" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_3da53e68053b4437a142b690f80db43e-22"&gt;&lt;/a&gt;&lt;span class="n"&gt;fun&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;lambda&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;
&lt;a id="rest_code_3da53e68053b4437a142b690f80db43e-23" name="rest_code_3da53e68053b4437a142b690f80db43e-23" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_3da53e68053b4437a142b690f80db43e-23"&gt;&lt;/a&gt;&lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;linspace&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_3da53e68053b4437a142b690f80db43e-24" name="rest_code_3da53e68053b4437a142b690f80db43e-24" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_3da53e68053b4437a142b690f80db43e-24"&gt;&lt;/a&gt;&lt;span class="n"&gt;stiff&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;rhs&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;FEM1D&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;fun&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_3da53e68053b4437a142b690f80db43e-25" name="rest_code_3da53e68053b4437a142b690f80db43e-25" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_3da53e68053b4437a142b690f80db43e-25"&gt;&lt;/a&gt;&lt;span class="n"&gt;sol&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_3da53e68053b4437a142b690f80db43e-26" name="rest_code_3da53e68053b4437a142b690f80db43e-26" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_3da53e68053b4437a142b690f80db43e-26"&gt;&lt;/a&gt;&lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;linalg&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;solve&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;stiff&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;rhs&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_3da53e68053b4437a142b690f80db43e-27" name="rest_code_3da53e68053b4437a142b690f80db43e-27" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_3da53e68053b4437a142b690f80db43e-27"&gt;&lt;/a&gt;
&lt;a id="rest_code_3da53e68053b4437a142b690f80db43e-28" name="rest_code_3da53e68053b4437a142b690f80db43e-28" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_3da53e68053b4437a142b690f80db43e-28"&gt;&lt;/a&gt;
&lt;a id="rest_code_3da53e68053b4437a142b690f80db43e-29" name="rest_code_3da53e68053b4437a142b690f80db43e-29" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_3da53e68053b4437a142b690f80db43e-29"&gt;&lt;/a&gt;&lt;span class="c1"&gt;#%% Plotting&lt;/span&gt;
&lt;a id="rest_code_3da53e68053b4437a142b690f80db43e-30" name="rest_code_3da53e68053b4437a142b690f80db43e-30" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_3da53e68053b4437a142b690f80db43e-30"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;figure&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;figsize&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_3da53e68053b4437a142b690f80db43e-31" name="rest_code_3da53e68053b4437a142b690f80db43e-31" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_3da53e68053b4437a142b690f80db43e-31"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;plot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_3da53e68053b4437a142b690f80db43e-32" name="rest_code_3da53e68053b4437a142b690f80db43e-32" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_3da53e68053b4437a142b690f80db43e-32"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;plot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="mi"&gt;20&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;linestyle&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;"dashed"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_3da53e68053b4437a142b690f80db43e-33" name="rest_code_3da53e68053b4437a142b690f80db43e-33" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_3da53e68053b4437a142b690f80db43e-33"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="sa"&gt;r&lt;/span&gt;&lt;span class="s2"&gt;"$x$"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_3da53e68053b4437a142b690f80db43e-34" name="rest_code_3da53e68053b4437a142b690f80db43e-34" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_3da53e68053b4437a142b690f80db43e-34"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ylabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="sa"&gt;r&lt;/span&gt;&lt;span class="s2"&gt;"$y$"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_3da53e68053b4437a142b690f80db43e-35" name="rest_code_3da53e68053b4437a142b690f80db43e-35" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_3da53e68053b4437a142b690f80db43e-35"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;legend&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="s2"&gt;"FEM solution"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;"Exact solution"&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_3da53e68053b4437a142b690f80db43e-36" name="rest_code_3da53e68053b4437a142b690f80db43e-36" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_3da53e68053b4437a142b690f80db43e-36"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;tight_layout&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a id="rest_code_3da53e68053b4437a142b690f80db43e-37" name="rest_code_3da53e68053b4437a142b690f80db43e-37" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_3da53e68053b4437a142b690f80db43e-37"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;show&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/section&gt;
&lt;section id="julia"&gt;
&lt;h3&gt;Julia&lt;/h3&gt;
&lt;div class="code"&gt;&lt;pre class="code julia"&gt;&lt;a id="rest_code_0185a16cc3bd442b9643668b56d6a8ea-1" name="rest_code_0185a16cc3bd442b9643668b56d6a8ea-1" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_0185a16cc3bd442b9643668b56d6a8ea-1"&gt;&lt;/a&gt;&lt;span class="k"&gt;using&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;PyPlot&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_0185a16cc3bd442b9643668b56d6a8ea-2" name="rest_code_0185a16cc3bd442b9643668b56d6a8ea-2" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_0185a16cc3bd442b9643668b56d6a8ea-2"&gt;&lt;/a&gt;
&lt;a id="rest_code_0185a16cc3bd442b9643668b56d6a8ea-3" name="rest_code_0185a16cc3bd442b9643668b56d6a8ea-3" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_0185a16cc3bd442b9643668b56d6a8ea-3"&gt;&lt;/a&gt;
&lt;a id="rest_code_0185a16cc3bd442b9643668b56d6a8ea-4" name="rest_code_0185a16cc3bd442b9643668b56d6a8ea-4" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_0185a16cc3bd442b9643668b56d6a8ea-4"&gt;&lt;/a&gt;&lt;span class="k"&gt;function&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;FEM1D&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;source&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_0185a16cc3bd442b9643668b56d6a8ea-5" name="rest_code_0185a16cc3bd442b9643668b56d6a8ea-5" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_0185a16cc3bd442b9643668b56d6a8ea-5"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;length&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_0185a16cc3bd442b9643668b56d6a8ea-6" name="rest_code_0185a16cc3bd442b9643668b56d6a8ea-6" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_0185a16cc3bd442b9643668b56d6a8ea-6"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;stiff_loc&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mf"&gt;2.0&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;2.0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;2.0&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;2.0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_0185a16cc3bd442b9643668b56d6a8ea-7" name="rest_code_0185a16cc3bd442b9643668b56d6a8ea-7" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_0185a16cc3bd442b9643668b56d6a8ea-7"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;eles&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;[[&lt;/span&gt;&lt;span class="n"&gt;cont&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;cont&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;for&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;cont&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;in&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_0185a16cc3bd442b9643668b56d6a8ea-8" name="rest_code_0185a16cc3bd442b9643668b56d6a8ea-8" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_0185a16cc3bd442b9643668b56d6a8ea-8"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;stiff&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_0185a16cc3bd442b9643668b56d6a8ea-9" name="rest_code_0185a16cc3bd442b9643668b56d6a8ea-9" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_0185a16cc3bd442b9643668b56d6a8ea-9"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;rhs&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_0185a16cc3bd442b9643668b56d6a8ea-10" name="rest_code_0185a16cc3bd442b9643668b56d6a8ea-10" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_0185a16cc3bd442b9643668b56d6a8ea-10"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;for&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ele&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;in&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;eles&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_0185a16cc3bd442b9643668b56d6a8ea-11" name="rest_code_0185a16cc3bd442b9643668b56d6a8ea-11" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_0185a16cc3bd442b9643668b56d6a8ea-11"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;jaco&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ele&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;]]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ele&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]]&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_0185a16cc3bd442b9643668b56d6a8ea-12" name="rest_code_0185a16cc3bd442b9643668b56d6a8ea-12" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_0185a16cc3bd442b9643668b56d6a8ea-12"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;rhs&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ele&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;rhs&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ele&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;jaco&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;source&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ele&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_0185a16cc3bd442b9643668b56d6a8ea-13" name="rest_code_0185a16cc3bd442b9643668b56d6a8ea-13" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_0185a16cc3bd442b9643668b56d6a8ea-13"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;stiff&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ele&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ele&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;stiff&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ele&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ele&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;stiff_loc&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;jaco&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_0185a16cc3bd442b9643668b56d6a8ea-14" name="rest_code_0185a16cc3bd442b9643668b56d6a8ea-14" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_0185a16cc3bd442b9643668b56d6a8ea-14"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;end&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_0185a16cc3bd442b9643668b56d6a8ea-15" name="rest_code_0185a16cc3bd442b9643668b56d6a8ea-15" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_0185a16cc3bd442b9643668b56d6a8ea-15"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;return&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;stiff&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;rhs&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_0185a16cc3bd442b9643668b56d6a8ea-16" name="rest_code_0185a16cc3bd442b9643668b56d6a8ea-16" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_0185a16cc3bd442b9643668b56d6a8ea-16"&gt;&lt;/a&gt;&lt;span class="k"&gt;end&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_0185a16cc3bd442b9643668b56d6a8ea-17" name="rest_code_0185a16cc3bd442b9643668b56d6a8ea-17" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_0185a16cc3bd442b9643668b56d6a8ea-17"&gt;&lt;/a&gt;
&lt;a id="rest_code_0185a16cc3bd442b9643668b56d6a8ea-18" name="rest_code_0185a16cc3bd442b9643668b56d6a8ea-18" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_0185a16cc3bd442b9643668b56d6a8ea-18"&gt;&lt;/a&gt;
&lt;a id="rest_code_0185a16cc3bd442b9643668b56d6a8ea-19" name="rest_code_0185a16cc3bd442b9643668b56d6a8ea-19" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_0185a16cc3bd442b9643668b56d6a8ea-19"&gt;&lt;/a&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;100&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_0185a16cc3bd442b9643668b56d6a8ea-20" name="rest_code_0185a16cc3bd442b9643668b56d6a8ea-20" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_0185a16cc3bd442b9643668b56d6a8ea-20"&gt;&lt;/a&gt;&lt;span class="n"&gt;fun&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;.^&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_0185a16cc3bd442b9643668b56d6a8ea-21" name="rest_code_0185a16cc3bd442b9643668b56d6a8ea-21" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_0185a16cc3bd442b9643668b56d6a8ea-21"&gt;&lt;/a&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;linspace&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_0185a16cc3bd442b9643668b56d6a8ea-22" name="rest_code_0185a16cc3bd442b9643668b56d6a8ea-22" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_0185a16cc3bd442b9643668b56d6a8ea-22"&gt;&lt;/a&gt;&lt;span class="n"&gt;stiff&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;rhs&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;FEM1D&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;fun&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_0185a16cc3bd442b9643668b56d6a8ea-23" name="rest_code_0185a16cc3bd442b9643668b56d6a8ea-23" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_0185a16cc3bd442b9643668b56d6a8ea-23"&gt;&lt;/a&gt;&lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_0185a16cc3bd442b9643668b56d6a8ea-24" name="rest_code_0185a16cc3bd442b9643668b56d6a8ea-24" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_0185a16cc3bd442b9643668b56d6a8ea-24"&gt;&lt;/a&gt;&lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="k"&gt;end&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;stiff&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="k"&gt;end&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="k"&gt;end&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;\&lt;/span&gt;&lt;span class="n"&gt;rhs&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="k"&gt;end&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_0185a16cc3bd442b9643668b56d6a8ea-25" name="rest_code_0185a16cc3bd442b9643668b56d6a8ea-25" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_0185a16cc3bd442b9643668b56d6a8ea-25"&gt;&lt;/a&gt;
&lt;a id="rest_code_0185a16cc3bd442b9643668b56d6a8ea-26" name="rest_code_0185a16cc3bd442b9643668b56d6a8ea-26" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_0185a16cc3bd442b9643668b56d6a8ea-26"&gt;&lt;/a&gt;
&lt;a id="rest_code_0185a16cc3bd442b9643668b56d6a8ea-27" name="rest_code_0185a16cc3bd442b9643668b56d6a8ea-27" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_0185a16cc3bd442b9643668b56d6a8ea-27"&gt;&lt;/a&gt;&lt;span class="c"&gt;#%% Plotting&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_0185a16cc3bd442b9643668b56d6a8ea-28" name="rest_code_0185a16cc3bd442b9643668b56d6a8ea-28" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_0185a16cc3bd442b9643668b56d6a8ea-28"&gt;&lt;/a&gt;&lt;span class="n"&gt;figure&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;figsize&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_0185a16cc3bd442b9643668b56d6a8ea-29" name="rest_code_0185a16cc3bd442b9643668b56d6a8ea-29" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_0185a16cc3bd442b9643668b56d6a8ea-29"&gt;&lt;/a&gt;&lt;span class="n"&gt;plot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_0185a16cc3bd442b9643668b56d6a8ea-30" name="rest_code_0185a16cc3bd442b9643668b56d6a8ea-30" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_0185a16cc3bd442b9643668b56d6a8ea-30"&gt;&lt;/a&gt;&lt;span class="n"&gt;plot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;.*&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;.^&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="mi"&gt;20&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;linestyle&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;"dashed"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_0185a16cc3bd442b9643668b56d6a8ea-31" name="rest_code_0185a16cc3bd442b9643668b56d6a8ea-31" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_0185a16cc3bd442b9643668b56d6a8ea-31"&gt;&lt;/a&gt;&lt;span class="n"&gt;xlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="sa"&gt;L&lt;/span&gt;&lt;span class="s"&gt;"&lt;/span&gt;&lt;span class="si"&gt;$x&lt;/span&gt;&lt;span class="s"&gt;$"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_0185a16cc3bd442b9643668b56d6a8ea-32" name="rest_code_0185a16cc3bd442b9643668b56d6a8ea-32" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_0185a16cc3bd442b9643668b56d6a8ea-32"&gt;&lt;/a&gt;&lt;span class="n"&gt;ylabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="sa"&gt;L&lt;/span&gt;&lt;span class="s"&gt;"&lt;/span&gt;&lt;span class="si"&gt;$y&lt;/span&gt;&lt;span class="s"&gt;$"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_0185a16cc3bd442b9643668b56d6a8ea-33" name="rest_code_0185a16cc3bd442b9643668b56d6a8ea-33" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_0185a16cc3bd442b9643668b56d6a8ea-33"&gt;&lt;/a&gt;&lt;span class="n"&gt;legend&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="s"&gt;"FEM solution"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s"&gt;"Exact solution"&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_0185a16cc3bd442b9643668b56d6a8ea-34" name="rest_code_0185a16cc3bd442b9643668b56d6a8ea-34" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_0185a16cc3bd442b9643668b56d6a8ea-34"&gt;&lt;/a&gt;&lt;span class="n"&gt;tight_layout&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_0185a16cc3bd442b9643668b56d6a8ea-35" name="rest_code_0185a16cc3bd442b9643668b56d6a8ea-35" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_0185a16cc3bd442b9643668b56d6a8ea-35"&gt;&lt;/a&gt;&lt;span class="n"&gt;show&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Both have the same result, as follows&lt;/p&gt;
&lt;img alt="Finite element method approximation." class="align-center" src="https://nicoguaro.github.io/images/FEM1D.svg" style="width: 400px;"&gt;
&lt;/section&gt;
&lt;section id="comparison-python-julia"&gt;
&lt;h3&gt;Comparison Python/Julia&lt;/h3&gt;
&lt;p&gt;Regarding number of lines we have: 37 in Python and 35 in Julia. The comparison
in execution time is done with &lt;code class="docutils literal"&gt;%timeit&lt;/code&gt; magic command in IPython and
&lt;code class="docutils literal"&gt;@benchmark&lt;/code&gt; in Julia. For the test we are just comparing the time it takes
to generate the matrices.&lt;/p&gt;
&lt;p&gt;For Python:&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code IPython"&gt;&lt;a id="rest_code_35fd16795f3e4d8b8feb07a664e3205c-1" name="rest_code_35fd16795f3e4d8b8feb07a664e3205c-1" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_35fd16795f3e4d8b8feb07a664e3205c-1"&gt;&lt;/a&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="k"&gt;timeit&lt;/span&gt; FEM1D(x, fun)
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;with result&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code text"&gt;&lt;a id="rest_code_d3703ac14d7b44f8aa86ebb9f0485cad-1" name="rest_code_d3703ac14d7b44f8aa86ebb9f0485cad-1" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_d3703ac14d7b44f8aa86ebb9f0485cad-1"&gt;&lt;/a&gt;100 loops, best of 3: 2.15 ms per loop
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;For Julia:&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code julia"&gt;&lt;a id="rest_code_0a5e1a6d0d4140b2a1989fabd7129a27-1" name="rest_code_0a5e1a6d0d4140b2a1989fabd7129a27-1" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_0a5e1a6d0d4140b2a1989fabd7129a27-1"&gt;&lt;/a&gt;&lt;span class="nd"&gt;@benchmark&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;FEM1D&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;fun&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;with result&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code julia"&gt;&lt;a id="rest_code_e6e8eb6aa4924c0ebf2a0841a8057e66-1" name="rest_code_e6e8eb6aa4924c0ebf2a0841a8057e66-1" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_e6e8eb6aa4924c0ebf2a0841a8057e66-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;BenchmarkTools&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Trial&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_e6e8eb6aa4924c0ebf2a0841a8057e66-2" name="rest_code_e6e8eb6aa4924c0ebf2a0841a8057e66-2" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_e6e8eb6aa4924c0ebf2a0841a8057e66-2"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;memory&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;estimate&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="mf"&gt;183.73&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;KiB&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_e6e8eb6aa4924c0ebf2a0841a8057e66-3" name="rest_code_e6e8eb6aa4924c0ebf2a0841a8057e66-3" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_e6e8eb6aa4924c0ebf2a0841a8057e66-3"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;allocs&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;estimate&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="mi"&gt;1392&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_e6e8eb6aa4924c0ebf2a0841a8057e66-4" name="rest_code_e6e8eb6aa4924c0ebf2a0841a8057e66-4" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_e6e8eb6aa4924c0ebf2a0841a8057e66-4"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="o"&gt;--------------&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_e6e8eb6aa4924c0ebf2a0841a8057e66-5" name="rest_code_e6e8eb6aa4924c0ebf2a0841a8057e66-5" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_e6e8eb6aa4924c0ebf2a0841a8057e66-5"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;minimum&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;     &lt;/span&gt;&lt;span class="mf"&gt;60.045&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;μs&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;0.00&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;GC&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_e6e8eb6aa4924c0ebf2a0841a8057e66-6" name="rest_code_e6e8eb6aa4924c0ebf2a0841a8057e66-6" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_e6e8eb6aa4924c0ebf2a0841a8057e66-6"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;median&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="mf"&gt;70.445&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;μs&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;0.00&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;GC&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_e6e8eb6aa4924c0ebf2a0841a8057e66-7" name="rest_code_e6e8eb6aa4924c0ebf2a0841a8057e66-7" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_e6e8eb6aa4924c0ebf2a0841a8057e66-7"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;mean&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="mf"&gt;98.276&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;μs&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;25.64&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;GC&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_e6e8eb6aa4924c0ebf2a0841a8057e66-8" name="rest_code_e6e8eb6aa4924c0ebf2a0841a8057e66-8" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_e6e8eb6aa4924c0ebf2a0841a8057e66-8"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;maximum&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;     &lt;/span&gt;&lt;span class="mf"&gt;4.269&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ms&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;96.70&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;GC&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_e6e8eb6aa4924c0ebf2a0841a8057e66-9" name="rest_code_e6e8eb6aa4924c0ebf2a0841a8057e66-9" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_e6e8eb6aa4924c0ebf2a0841a8057e66-9"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="o"&gt;--------------&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_e6e8eb6aa4924c0ebf2a0841a8057e66-10" name="rest_code_e6e8eb6aa4924c0ebf2a0841a8057e66-10" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_e6e8eb6aa4924c0ebf2a0841a8057e66-10"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;samples&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;          &lt;/span&gt;&lt;span class="mi"&gt;10000&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_e6e8eb6aa4924c0ebf2a0841a8057e66-11" name="rest_code_e6e8eb6aa4924c0ebf2a0841a8057e66-11" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_e6e8eb6aa4924c0ebf2a0841a8057e66-11"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;evals&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;sample&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;     &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;In this case, we can say that the Python code is roughly 30 times slower than
Julia code.&lt;/p&gt;
&lt;/section&gt;
&lt;/section&gt;</description><category>finite element method</category><category>julia</category><category>numerical methods</category><category>python</category><category>scientific computing</category><guid>https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/</guid><pubDate>Tue, 24 Oct 2017 20:17:58 GMT</pubDate></item><item><title>Solution of the Schrödinger equation using Ritz method</title><link>https://nicoguaro.github.io/posts/hermite_ritz_qm/</link><dc:creator>Nicolás Guarín-Zapata</dc:creator><description>&lt;p&gt;In this post, we describe the solution of the Schrödinger equation
using the Ritz method and
&lt;a class="reference external" href="https://en.wikipedia.org/wiki/Hermite_polynomials#Hermite_functions"&gt;Hermite functions&lt;/a&gt;
basis. This basis seems to be a good choice for the 1D Schrödinger equation
since its an orthogonal basis over &lt;span class="math"&gt;\((-\infty, \infty)\)&lt;/span&gt;.&lt;/p&gt;
&lt;section id="transforming-the-equation-to-an-algebraic-one"&gt;
&lt;h2&gt;Transforming the equation to an algebraic one&lt;/h2&gt;
&lt;p&gt;We want so solve the time-independent
&lt;a class="reference external" href="https://en.wikipedia.org/wiki/Schr%C3%B6dinger_equation"&gt;Schrödinger equation&lt;/a&gt;&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
\left[-\frac{1}{2}\nabla^2 + V(x)\right] \psi = E\psi\, ,
\end{equation*}
&lt;/div&gt;
&lt;p&gt;where we are using
&lt;a class="reference external" href="https://en.wikipedia.org/wiki/Natural_units"&gt;natural units&lt;/a&gt;
since they are a good choice for numeric calculations.&lt;/p&gt;
&lt;p&gt;Solving this equation is equivalent to solve the following
variational equation&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
\delta \Pi[\psi] = 0\, ,
\end{equation*}
&lt;/div&gt;
&lt;p&gt;with&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
\Pi[\psi] = \frac{1}{2} \langle \nabla \psi, \nabla\psi\rangle +
              \langle \psi, V(x) \psi\rangle -
               E\langle \psi, \psi\rangle \, ,
\end{equation*}
&lt;/div&gt;
&lt;p&gt;being &lt;span class="math"&gt;\(\psi\)&lt;/span&gt; the wave function, &lt;span class="math"&gt;\(V(x)\)&lt;/span&gt; the potential and
&lt;span class="math"&gt;\(E\)&lt;/span&gt; the energy. This variational formulation is equivalent to the
time-independent Schrödinger equation, and &lt;span class="math"&gt;\(E\)&lt;/span&gt; works as a Lagrange
multiplier to enforce that the probability over the whole domain is 1.&lt;/p&gt;
&lt;p&gt;We can expand the wave function in an orthonormal basis, namely&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
\psi = \sum_{n=0}^N c_n u_n(x)\, ,
\end{equation*}
&lt;/div&gt;
&lt;p&gt;where &lt;span class="math"&gt;\(u_n(x) \equiv \mu_n H_n(x) e^{-x^2/2}\)&lt;/span&gt; is a normalized
Hermite function, &lt;span class="math"&gt;\(\mu_n\)&lt;/span&gt; is the inverse of magnitude of the
&lt;span class="math"&gt;\(n\)&lt;/span&gt;-th Hermite polynomial&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
\mu_n = \frac{1}{\sqrt{\pi^{1/2} n! 2^n}}\, ,
\end{equation*}
&lt;/div&gt;
&lt;p&gt;and &lt;span class="math"&gt;\(c_n\)&lt;/span&gt; are the coefficients of the expansion. This
representation is exact in the limit &lt;span class="math"&gt;\(N \rightarrow \infty\)&lt;/span&gt;.&lt;/p&gt;
&lt;p&gt;If we replace the expansion in the functional, we obtain&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
\Pi_N = \sum_{m=0}^N\sum_{n=0}^N c_m c_n\left[
          \frac{1}{2} \langle \nabla u_m, \nabla u_n\rangle +
          \langle u_m, V(x) u_n\rangle -
          E^N \delta_{mn}\right]\, .
\end{equation*}
&lt;/div&gt;
&lt;p&gt;The integrand of the integral involving the two derivatives reads&lt;/p&gt;
&lt;div class="math"&gt;
\begin{align*}
u_m' u_n' =&amp;amp; \left[2m \frac{\mu_{m-1}}{\mu_m}u_{m-1} - x u_m\right]
            \left[2n \frac{\mu_{n-1}}{\mu_n}u_{n-1} - x u_n\right]\\
          =&amp;amp; 4mn\frac{\mu_{m-1} \mu_{n-1}}{\mu_m \mu_n} u_{n-1} u_{m-1}
           - 2m\frac{\mu_{m-1}}{\mu_{m}}x u_{m-1} u_n\\
           &amp;amp;- 2n\frac{\mu_{n-1}}{\mu_{n}}x u_{n-1} u_m + x^2 u_m u_n
\end{align*}
&lt;/div&gt;
&lt;p&gt;Thus, the kinetic energy term reads&lt;/p&gt;
&lt;div class="math"&gt;
\begin{align*}
\langle \nabla u_m, \nabla u_n \rangle =&amp;amp;
    4mn\frac{\mu_{m-1} \mu_{n-1}}{\mu_m \mu_n} \langle u_{n-1}, u_{m-1}\rangle
    - 2m\frac{\mu_{m-1}}{\mu_{m}} \langle u_{m-1}, x u_n\rangle\\
    &amp;amp;- 2n\frac{\mu_{n-1}}{\mu_{n}} \langle u_{m}, x u_{n - 1}\rangle
     + \langle u_m, x^2 u_n\rangle\\
    =&amp;amp; 4mn \frac{\mu_{m-1}^2}{\mu_m^2}\delta_{mn} -
      2m \frac{\mu_{m-1}}{\mu_m} \alpha_{m-1, n} -
      2n \frac{\mu_{n-1}}{\mu_n} \alpha_{m, n-1} + \beta_{mn} \, ,
\end{align*}
&lt;/div&gt;
&lt;p&gt;with&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
\alpha_{m,n} \equiv \langle u_{m}, x u_n\rangle = \begin{cases}
\sqrt{\frac{n + 1}{2}} &amp;amp; m=n +1\\
\sqrt{\frac{n}{2}} &amp;amp; m=n - 1\\
0 &amp;amp; \text{otherwise}\end{cases}\, ,
\end{equation*}
&lt;/div&gt;
&lt;p&gt;and&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
\beta_{m,n} \equiv \langle u_{m}, x^2 u_n\rangle = \begin{cases}
\frac{\sqrt{n(n-1)}}{2} &amp;amp; m = n - 2\\
\frac{2n + 1}{2} &amp;amp; m = n \\
\frac{\sqrt{(n+1)(n+1)}}{2} &amp;amp; m = n + 2 \\
0 &amp;amp; \text{otherwise}\end{cases}\, .
\end{equation*}
&lt;/div&gt;
&lt;p&gt;The functional is rewritten as&lt;/p&gt;
&lt;div class="math"&gt;
\begin{align*}
\Pi_N =&amp;amp; \sum_{m=0}^N \sum_{n=0}^N c_m c_n
  \left[2mn \frac{\mu^2_{m-1}}{\mu^2_m}\delta_{mn}
  - m\frac{\mu_{m-1}}{\mu_m}\alpha_{m - 1, n}
  - n\frac{\mu_{n-1}}{\mu_n}\delta_{m, n-1} \right.\nonumber \\
  &amp;amp;\left. - \frac{1}{2}\beta_{mn} + \langle u_m, V(x) u_n\rangle
  - E^N \delta_{mn}\right] \, .
\end{align*}
&lt;/div&gt;
&lt;p&gt;Taking the variation&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
\delta \Pi_N = 0\, ,
\end{equation*}
&lt;/div&gt;
&lt;p&gt;that in this case is equivalent to&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
\frac{\partial \Pi_N}{\partial c_i} = 0\quad \forall i=0, 1, \cdots N\, ,
\end{equation*}
&lt;/div&gt;
&lt;p&gt;yields to&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
[H]\lbrace c\rbrace = E^N\lbrace c\rbrace \, ,
\end{equation*}
&lt;/div&gt;
&lt;p&gt;where the components of the matrix &lt;span class="math"&gt;\([H]\)&lt;/span&gt; are given by&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
H_{mn} = 2mn \frac{\mu^2_{m-1}}{\mu^2_m}\delta_{mn}
  - m\frac{\mu_{m-1}}{\mu_m}\alpha_{m - 1, n}
  - n\frac{\mu_{n-1}}{\mu_n}\delta_{m, n-1}
  - \frac{1}{2}\beta_{mn} + \langle u_m, V(x) u_n\rangle\, .
\end{equation*}
&lt;/div&gt;
&lt;p&gt;The last integral can be computed using
&lt;a class="reference external" href="https://en.wikipedia.org/wiki/Gauss%E2%80%93Hermite_quadrature"&gt;Gauss-Hermite quadrature&lt;/a&gt;.
And we will need more Gauss points if we want to integrate higher-order
polynomials. This method would work fine for functions that can be
approximated by polynomials.&lt;/p&gt;
&lt;/section&gt;
&lt;section id="examples"&gt;
&lt;h2&gt;Examples&lt;/h2&gt;
&lt;p&gt;A Python implementation of this method is presented in
&lt;a class="reference external" href="https://github.com/nicoguaro/FEM_resources/blob/master/quantum_mechanics/hermite_QM.py"&gt;this repo&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;For all the examples we use the following imports&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code ipython"&gt;&lt;a id="rest_code_70ddc330b2e6465baa53ff6719f5dca4-1" name="rest_code_70ddc330b2e6465baa53ff6719f5dca4-1" href="https://nicoguaro.github.io/posts/hermite_ritz_qm/#rest_code_70ddc330b2e6465baa53ff6719f5dca4-1"&gt;&lt;/a&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;__future__&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;division&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;print_function&lt;/span&gt;
&lt;a id="rest_code_70ddc330b2e6465baa53ff6719f5dca4-2" name="rest_code_70ddc330b2e6465baa53ff6719f5dca4-2" href="https://nicoguaro.github.io/posts/hermite_ritz_qm/#rest_code_70ddc330b2e6465baa53ff6719f5dca4-2"&gt;&lt;/a&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;numpy&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;np&lt;/span&gt;
&lt;a id="rest_code_70ddc330b2e6465baa53ff6719f5dca4-3" name="rest_code_70ddc330b2e6465baa53ff6719f5dca4-3" href="https://nicoguaro.github.io/posts/hermite_ritz_qm/#rest_code_70ddc330b2e6465baa53ff6719f5dca4-3"&gt;&lt;/a&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;hermite_QM&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;section id="quantum-harmonic-oscilator-1"&gt;
&lt;h3&gt;&lt;a class="reference external" href="https://en.wikipedia.org/wiki/Quantum_harmonic_oscillator"&gt;Quantum harmonic oscilator&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;In this case the (normalized) potential is given by&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
V(x) = \frac{1}{2} x^2
\end{equation*}
&lt;/div&gt;
&lt;p&gt;and the exact normalized eigenvalues are given by&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
E_n = n + \frac{1}{2}
\end{equation*}
&lt;/div&gt;
&lt;p&gt;The following snippet computes the first 10 eigenvalues and plot
the corresponding eigenstates&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code ipython"&gt;&lt;a id="rest_code_7e57830cc4c7485badabf4b7d1a217aa-1" name="rest_code_7e57830cc4c7485badabf4b7d1a217aa-1" href="https://nicoguaro.github.io/posts/hermite_ritz_qm/#rest_code_7e57830cc4c7485badabf4b7d1a217aa-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;potential&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;lambda&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="mf"&gt;0.5&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;
&lt;a id="rest_code_7e57830cc4c7485badabf4b7d1a217aa-2" name="rest_code_7e57830cc4c7485badabf4b7d1a217aa-2" href="https://nicoguaro.github.io/posts/hermite_ritz_qm/#rest_code_7e57830cc4c7485badabf4b7d1a217aa-2"&gt;&lt;/a&gt;&lt;span class="n"&gt;vals&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;vecs&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;eigenstates&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;potential&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;nterms&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;11&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;ngpts&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;12&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_7e57830cc4c7485badabf4b7d1a217aa-3" name="rest_code_7e57830cc4c7485badabf4b7d1a217aa-3" href="https://nicoguaro.github.io/posts/hermite_ritz_qm/#rest_code_7e57830cc4c7485badabf4b7d1a217aa-3"&gt;&lt;/a&gt;&lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;round&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;vals&lt;/span&gt;&lt;span class="p"&gt;[:&lt;/span&gt;&lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="mi"&gt;6&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_7e57830cc4c7485badabf4b7d1a217aa-4" name="rest_code_7e57830cc4c7485badabf4b7d1a217aa-4" href="https://nicoguaro.github.io/posts/hermite_ritz_qm/#rest_code_7e57830cc4c7485badabf4b7d1a217aa-4"&gt;&lt;/a&gt;&lt;span class="n"&gt;fig&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;ax&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;subplots&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_7e57830cc4c7485badabf4b7d1a217aa-5" name="rest_code_7e57830cc4c7485badabf4b7d1a217aa-5" href="https://nicoguaro.github.io/posts/hermite_ritz_qm/#rest_code_7e57830cc4c7485badabf4b7d1a217aa-5"&gt;&lt;/a&gt;&lt;span class="n"&gt;plot_eigenstates&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;vals&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;vecs&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;potential&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;with results&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code text"&gt;&lt;a id="rest_code_742be29ab958432585fa778337d45987-1" name="rest_code_742be29ab958432585fa778337d45987-1" href="https://nicoguaro.github.io/posts/hermite_ritz_qm/#rest_code_742be29ab958432585fa778337d45987-1"&gt;&lt;/a&gt;[ 0.5  1.5  2.5  3.5  4.5  5.5  6.5  7.5  8.5  9.5]
&lt;/pre&gt;&lt;/div&gt;
&lt;img alt="/images/hermite_ritz_harmonic.svg" src="https://nicoguaro.github.io/images/hermite_ritz_harmonic.svg"&gt;
&lt;/section&gt;
&lt;section id="absolute-value-potential"&gt;
&lt;h3&gt;Absolute value potential&lt;/h3&gt;
&lt;div class="code"&gt;&lt;pre class="code ipython"&gt;&lt;a id="rest_code_8c3219fb09214b67a3e18eb0ec4c4991-1" name="rest_code_8c3219fb09214b67a3e18eb0ec4c4991-1" href="https://nicoguaro.github.io/posts/hermite_ritz_qm/#rest_code_8c3219fb09214b67a3e18eb0ec4c4991-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;potential&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;lambda&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;abs&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_8c3219fb09214b67a3e18eb0ec4c4991-2" name="rest_code_8c3219fb09214b67a3e18eb0ec4c4991-2" href="https://nicoguaro.github.io/posts/hermite_ritz_qm/#rest_code_8c3219fb09214b67a3e18eb0ec4c4991-2"&gt;&lt;/a&gt;&lt;span class="n"&gt;vals&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;vecs&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;eigenstates&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;potential&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_8c3219fb09214b67a3e18eb0ec4c4991-3" name="rest_code_8c3219fb09214b67a3e18eb0ec4c4991-3" href="https://nicoguaro.github.io/posts/hermite_ritz_qm/#rest_code_8c3219fb09214b67a3e18eb0ec4c4991-3"&gt;&lt;/a&gt;&lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;round&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;vals&lt;/span&gt;&lt;span class="p"&gt;[:&lt;/span&gt;&lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="mi"&gt;6&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_8c3219fb09214b67a3e18eb0ec4c4991-4" name="rest_code_8c3219fb09214b67a3e18eb0ec4c4991-4" href="https://nicoguaro.github.io/posts/hermite_ritz_qm/#rest_code_8c3219fb09214b67a3e18eb0ec4c4991-4"&gt;&lt;/a&gt;&lt;span class="n"&gt;fig&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;ax&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;subplots&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_8c3219fb09214b67a3e18eb0ec4c4991-5" name="rest_code_8c3219fb09214b67a3e18eb0ec4c4991-5" href="https://nicoguaro.github.io/posts/hermite_ritz_qm/#rest_code_8c3219fb09214b67a3e18eb0ec4c4991-5"&gt;&lt;/a&gt;&lt;span class="n"&gt;plot_eigenstates&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;vals&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;vecs&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;potential&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;lims&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;8&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;8&lt;/span&gt;&lt;span class="p"&gt;));&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;with results&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code text"&gt;&lt;a id="rest_code_f8521a0b6c924e7794e4c998bcb92d3d-1" name="rest_code_f8521a0b6c924e7794e4c998bcb92d3d-1" href="https://nicoguaro.github.io/posts/hermite_ritz_qm/#rest_code_f8521a0b6c924e7794e4c998bcb92d3d-1"&gt;&lt;/a&gt;[ 0.811203  1.855725  2.57894   3.244576  3.826353  4.38189   4.895365
&lt;a id="rest_code_f8521a0b6c924e7794e4c998bcb92d3d-2" name="rest_code_f8521a0b6c924e7794e4c998bcb92d3d-2" href="https://nicoguaro.github.io/posts/hermite_ritz_qm/#rest_code_f8521a0b6c924e7794e4c998bcb92d3d-2"&gt;&lt;/a&gt;  5.396614  5.911591  6.421015]
&lt;/pre&gt;&lt;/div&gt;
&lt;img alt="/images/hermite_ritz_abs.svg" src="https://nicoguaro.github.io/images/hermite_ritz_abs.svg"&gt;
&lt;/section&gt;
&lt;section id="cubic-potential"&gt;
&lt;h3&gt;Cubic potential&lt;/h3&gt;
&lt;div class="code"&gt;&lt;pre class="code ipython"&gt;&lt;a id="rest_code_c946154383b8456aab49ecea39df5e98-1" name="rest_code_c946154383b8456aab49ecea39df5e98-1" href="https://nicoguaro.github.io/posts/hermite_ritz_qm/#rest_code_c946154383b8456aab49ecea39df5e98-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;potential&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;lambda&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;abs&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;
&lt;a id="rest_code_c946154383b8456aab49ecea39df5e98-2" name="rest_code_c946154383b8456aab49ecea39df5e98-2" href="https://nicoguaro.github.io/posts/hermite_ritz_qm/#rest_code_c946154383b8456aab49ecea39df5e98-2"&gt;&lt;/a&gt;&lt;span class="n"&gt;vals&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;vecs&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;eigenstates&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;potential&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_c946154383b8456aab49ecea39df5e98-3" name="rest_code_c946154383b8456aab49ecea39df5e98-3" href="https://nicoguaro.github.io/posts/hermite_ritz_qm/#rest_code_c946154383b8456aab49ecea39df5e98-3"&gt;&lt;/a&gt;&lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;round&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;vals&lt;/span&gt;&lt;span class="p"&gt;[:&lt;/span&gt;&lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="mi"&gt;6&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_c946154383b8456aab49ecea39df5e98-4" name="rest_code_c946154383b8456aab49ecea39df5e98-4" href="https://nicoguaro.github.io/posts/hermite_ritz_qm/#rest_code_c946154383b8456aab49ecea39df5e98-4"&gt;&lt;/a&gt;&lt;span class="n"&gt;fig&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;ax&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;subplots&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_c946154383b8456aab49ecea39df5e98-5" name="rest_code_c946154383b8456aab49ecea39df5e98-5" href="https://nicoguaro.github.io/posts/hermite_ritz_qm/#rest_code_c946154383b8456aab49ecea39df5e98-5"&gt;&lt;/a&gt;&lt;span class="n"&gt;plot_eigenstates&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;vals&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;vecs&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;potential&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;lims&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;6&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;6&lt;/span&gt;&lt;span class="p"&gt;));&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;with results&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code text"&gt;&lt;a id="rest_code_edaab8c0bb764205918e06c3c6ac6420-1" name="rest_code_edaab8c0bb764205918e06c3c6ac6420-1" href="https://nicoguaro.github.io/posts/hermite_ritz_qm/#rest_code_edaab8c0bb764205918e06c3c6ac6420-1"&gt;&lt;/a&gt;[ 0.180588  0.609153  1.124594  1.681002  2.272087  2.889805  3.530901
&lt;a id="rest_code_edaab8c0bb764205918e06c3c6ac6420-2" name="rest_code_edaab8c0bb764205918e06c3c6ac6420-2" href="https://nicoguaro.github.io/posts/hermite_ritz_qm/#rest_code_edaab8c0bb764205918e06c3c6ac6420-2"&gt;&lt;/a&gt;  4.191962  4.871133  5.566413]
&lt;/pre&gt;&lt;/div&gt;
&lt;img alt="/images/hermite_ritz_cubic.svg" src="https://nicoguaro.github.io/images/hermite_ritz_cubic.svg"&gt;
&lt;/section&gt;
&lt;section id="harmonic-with-quartic-perturbation"&gt;
&lt;h3&gt;Harmonic with quartic perturbation&lt;/h3&gt;
&lt;div class="code"&gt;&lt;pre class="code ipython"&gt;&lt;a id="rest_code_1210cb20d9b8416387194249225204e1-1" name="rest_code_1210cb20d9b8416387194249225204e1-1" href="https://nicoguaro.github.io/posts/hermite_ritz_qm/#rest_code_1210cb20d9b8416387194249225204e1-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;potential&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;lambda&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="mf"&gt;0.5&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mf"&gt;0.1&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;
&lt;a id="rest_code_1210cb20d9b8416387194249225204e1-2" name="rest_code_1210cb20d9b8416387194249225204e1-2" href="https://nicoguaro.github.io/posts/hermite_ritz_qm/#rest_code_1210cb20d9b8416387194249225204e1-2"&gt;&lt;/a&gt;&lt;span class="n"&gt;vals&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;vecs&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;eigenstates&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;potential&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;nterms&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;20&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;ngpts&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;22&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_1210cb20d9b8416387194249225204e1-3" name="rest_code_1210cb20d9b8416387194249225204e1-3" href="https://nicoguaro.github.io/posts/hermite_ritz_qm/#rest_code_1210cb20d9b8416387194249225204e1-3"&gt;&lt;/a&gt;&lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;round&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;vals&lt;/span&gt;&lt;span class="p"&gt;[:&lt;/span&gt;&lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="mi"&gt;6&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_1210cb20d9b8416387194249225204e1-4" name="rest_code_1210cb20d9b8416387194249225204e1-4" href="https://nicoguaro.github.io/posts/hermite_ritz_qm/#rest_code_1210cb20d9b8416387194249225204e1-4"&gt;&lt;/a&gt;&lt;span class="n"&gt;fig&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;ax&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;subplots&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_1210cb20d9b8416387194249225204e1-5" name="rest_code_1210cb20d9b8416387194249225204e1-5" href="https://nicoguaro.github.io/posts/hermite_ritz_qm/#rest_code_1210cb20d9b8416387194249225204e1-5"&gt;&lt;/a&gt;&lt;span class="n"&gt;plot_eigenstates&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;vals&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;vecs&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;potential&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;lims&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;with results&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code text"&gt;&lt;a id="rest_code_a5e3197e6c484cb58c0e65cfa649ab1d-1" name="rest_code_a5e3197e6c484cb58c0e65cfa649ab1d-1" href="https://nicoguaro.github.io/posts/hermite_ritz_qm/#rest_code_a5e3197e6c484cb58c0e65cfa649ab1d-1"&gt;&lt;/a&gt;[  0.559146   1.769503   3.138624   4.628884   6.220303   7.899789
&lt;a id="rest_code_a5e3197e6c484cb58c0e65cfa649ab1d-2" name="rest_code_a5e3197e6c484cb58c0e65cfa649ab1d-2" href="https://nicoguaro.github.io/posts/hermite_ritz_qm/#rest_code_a5e3197e6c484cb58c0e65cfa649ab1d-2"&gt;&lt;/a&gt;   9.658703  11.489094  13.38638   15.361055]
&lt;/pre&gt;&lt;/div&gt;
&lt;img alt="/images/hermite_ritz_pert_harm.svg" src="https://nicoguaro.github.io/images/hermite_ritz_pert_harm.svg"&gt;
&lt;p&gt;A Jupyter Notebook with the examples can be found
&lt;a class="reference external" href="https://github.com/nicoguaro/FEM_resources/blob/master/quantum_mechanics/Ritz_Hermite_QM.ipynb"&gt;here&lt;/a&gt;.&lt;/p&gt;
&lt;/section&gt;
&lt;/section&gt;</description><category>finite element method</category><category>Hermite polynomials</category><category>quantum mechanics</category><category>variational methods</category><guid>https://nicoguaro.github.io/posts/hermite_ritz_qm/</guid><pubDate>Wed, 12 Jul 2017 00:04:57 GMT</pubDate></item><item><title>Piecewise Hermite interpolation</title><link>https://nicoguaro.github.io/posts/hermite_interp/</link><dc:creator>Nicolás Guarín-Zapata</dc:creator><description>&lt;p&gt;In this post, we find the Hermite interpolation functions for the
domain [-1, 1]. And then, we use it for a pieciwise interpolation. Notice
that this interpolation has &lt;span class="math"&gt;\(C^1\)&lt;/span&gt; continuity compared to the
&lt;span class="math"&gt;\(C^0\)&lt;/span&gt; continuity that is common in Lagrange interpolation.&lt;/p&gt;
&lt;p&gt;To compute the polynomials explicitly we use &lt;cite&gt;sympy&lt;/cite&gt;.&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code ipython2"&gt;&lt;a id="rest_code_66850dac7b014283b9a5a01c563257b4-1" name="rest_code_66850dac7b014283b9a5a01c563257b4-1" href="https://nicoguaro.github.io/posts/hermite_interp/#rest_code_66850dac7b014283b9a5a01c563257b4-1"&gt;&lt;/a&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;__future__&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;division&lt;/span&gt;
&lt;a id="rest_code_66850dac7b014283b9a5a01c563257b4-2" name="rest_code_66850dac7b014283b9a5a01c563257b4-2" href="https://nicoguaro.github.io/posts/hermite_interp/#rest_code_66850dac7b014283b9a5a01c563257b4-2"&gt;&lt;/a&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;numpy&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;np&lt;/span&gt;
&lt;a id="rest_code_66850dac7b014283b9a5a01c563257b4-3" name="rest_code_66850dac7b014283b9a5a01c563257b4-3" href="https://nicoguaro.github.io/posts/hermite_interp/#rest_code_66850dac7b014283b9a5a01c563257b4-3"&gt;&lt;/a&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;sympy&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;sym&lt;/span&gt;
&lt;a id="rest_code_66850dac7b014283b9a5a01c563257b4-4" name="rest_code_66850dac7b014283b9a5a01c563257b4-4" href="https://nicoguaro.github.io/posts/hermite_interp/#rest_code_66850dac7b014283b9a5a01c563257b4-4"&gt;&lt;/a&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;matplotlib.pyplot&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;plt&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;We want to find a set of basis function that satisfy the following&lt;/p&gt;
&lt;div class="math"&gt;
\begin{align*}
N_1(x_1) &amp;amp;= 1\\
N_1(x_2) &amp;amp;= 0\\
N_2(x_1) &amp;amp;= 1\\
N_2(x_2) &amp;amp;= 0\\
N'_3(x_1) &amp;amp;= 1\\
N'_3(x_2) &amp;amp;= 0\\
N'_4(x_1) &amp;amp;= 1\\
N'_4(x_2) &amp;amp;= 0
\end{align*}
&lt;/div&gt;
&lt;p&gt;These can be written as&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
\begin{bmatrix}
1 &amp;amp;x_1 &amp;amp;x_1^2 &amp;amp;x_1^3\\
1 &amp;amp;x_2 &amp;amp;x_2^2 &amp;amp;x_2^3\\
0 &amp;amp;1 &amp;amp;2x_1 &amp;amp;3x_1^2\\
0 &amp;amp;1 &amp;amp;2x_2 &amp;amp;3x_2^2
\end{bmatrix}
\begin{bmatrix}
a_{11} &amp;amp;a_{12} &amp;amp;a_{13} &amp;amp;a_{14}\\
a_{21} &amp;amp;a_{22} &amp;amp;a_{23} &amp;amp;a_{24}\\
a_{31} &amp;amp;a_{32} &amp;amp;a_{33} &amp;amp;a_{34}\\
a_{41} &amp;amp;a_{42} &amp;amp;a_{43} &amp;amp;a_{44}
\end{bmatrix} =
\begin{bmatrix}
1 &amp;amp;0 &amp;amp;0 &amp;amp;0\\
0 &amp;amp;1 &amp;amp;0 &amp;amp;0\\
0 &amp;amp;0 &amp;amp;1 &amp;amp;0\\
0 &amp;amp;0 &amp;amp;0 &amp;amp;1
\end{bmatrix}
\end{equation*}
&lt;/div&gt;
&lt;p&gt;The formula for interpolation would be&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
f(x) \approx N_1(x) u_1 + N_2(x) u_2 + |J|(N_3(x) u'_3 + N_4(x) u'_4)\quad \forall x\in [a, b]
\end{equation*}
&lt;/div&gt;
&lt;p&gt;with &lt;span class="math"&gt;\(|J| = (b - a)/2\)&lt;/span&gt; the Jacobian determinant of the
transformation.&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code ipython2"&gt;&lt;a id="rest_code_11a7dc8d7a0940149e5fe4165c38a36f-1" name="rest_code_11a7dc8d7a0940149e5fe4165c38a36f-1" href="https://nicoguaro.github.io/posts/hermite_interp/#rest_code_11a7dc8d7a0940149e5fe4165c38a36f-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;x1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;x2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;sym&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;symbols&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"x1 x2 x"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_11a7dc8d7a0940149e5fe4165c38a36f-2" name="rest_code_11a7dc8d7a0940149e5fe4165c38a36f-2" href="https://nicoguaro.github.io/posts/hermite_interp/#rest_code_11a7dc8d7a0940149e5fe4165c38a36f-2"&gt;&lt;/a&gt;&lt;span class="n"&gt;V&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;sym&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Matrix&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;
&lt;a id="rest_code_11a7dc8d7a0940149e5fe4165c38a36f-3" name="rest_code_11a7dc8d7a0940149e5fe4165c38a36f-3" href="https://nicoguaro.github.io/posts/hermite_interp/#rest_code_11a7dc8d7a0940149e5fe4165c38a36f-3"&gt;&lt;/a&gt;    &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;x1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;x1&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;x1&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;
&lt;a id="rest_code_11a7dc8d7a0940149e5fe4165c38a36f-4" name="rest_code_11a7dc8d7a0940149e5fe4165c38a36f-4" href="https://nicoguaro.github.io/posts/hermite_interp/#rest_code_11a7dc8d7a0940149e5fe4165c38a36f-4"&gt;&lt;/a&gt;    &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;x2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;x2&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;x2&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;
&lt;a id="rest_code_11a7dc8d7a0940149e5fe4165c38a36f-5" name="rest_code_11a7dc8d7a0940149e5fe4165c38a36f-5" href="https://nicoguaro.github.io/posts/hermite_interp/#rest_code_11a7dc8d7a0940149e5fe4165c38a36f-5"&gt;&lt;/a&gt;    &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;x1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;x1&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;
&lt;a id="rest_code_11a7dc8d7a0940149e5fe4165c38a36f-6" name="rest_code_11a7dc8d7a0940149e5fe4165c38a36f-6" href="https://nicoguaro.github.io/posts/hermite_interp/#rest_code_11a7dc8d7a0940149e5fe4165c38a36f-6"&gt;&lt;/a&gt;    &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;x2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;x2&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;]])&lt;/span&gt;
&lt;a id="rest_code_11a7dc8d7a0940149e5fe4165c38a36f-7" name="rest_code_11a7dc8d7a0940149e5fe4165c38a36f-7" href="https://nicoguaro.github.io/posts/hermite_interp/#rest_code_11a7dc8d7a0940149e5fe4165c38a36f-7"&gt;&lt;/a&gt;&lt;span class="n"&gt;V&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="math"&gt;
\begin{equation*}
\left[\begin{matrix}1 &amp;amp; x_{1} &amp;amp; x_{1}^{2} &amp;amp; x_{1}^{3}\\
1 &amp;amp; x_{2} &amp;amp; x_{2}^{2} &amp;amp; x_{2}^{3}\\
0 &amp;amp; 1 &amp;amp; 2 x_{1} &amp;amp; 3 x_{1}^{2}\\
0 &amp;amp; 1 &amp;amp; 2 x_{2} &amp;amp; 3 x_{2}^{2}\end{matrix}\right]
\end{equation*}
&lt;/div&gt;
&lt;p&gt;We can see that the previous matrix is a  confluent Vandermonder matrix &lt;a class="footnote-reference brackets" href="https://nicoguaro.github.io/posts/hermite_interp/#footnote-1" id="footnote-reference-1" role="doc-noteref"&gt;&lt;span class="fn-bracket"&gt;[&lt;/span&gt;1&lt;span class="fn-bracket"&gt;]&lt;/span&gt;&lt;/a&gt;.
It is similar to a Vandermonde matrix for the first &lt;span class="math"&gt;\(n\)&lt;/span&gt; nodes
and the derivatives of each row for the following ones.&lt;/p&gt;
&lt;p&gt;The coefficients for our polynomials are given by the inverse of this matrix.&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code ipython2"&gt;&lt;a id="rest_code_9079f197c2274c81a5ea029a37113847-1" name="rest_code_9079f197c2274c81a5ea029a37113847-1" href="https://nicoguaro.github.io/posts/hermite_interp/#rest_code_9079f197c2274c81a5ea029a37113847-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;sym&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;simplify&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;V&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;inv&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="math"&gt;
\begin{equation*}
\left[\begin{matrix}\frac{x_{2}^{2} \left(3 x_{1} - x_{2}\right)}{x_{1}^{3} - 3 x_{1}^{2} x_{2} + 3 x_{1} x_{2}^{2} - x_{2}^{3}} &amp;amp; \frac{x_{1}^{2} \left(x_{1} - 3 x_{2}\right)}{x_{1}^{3} - 3 x_{1}^{2} x_{2} + 3 x_{1} x_{2}^{2} - x_{2}^{3}} &amp;amp; - \frac{x_{1} x_{2}^{2}}{x_{1}^{2} - 2 x_{1} x_{2} + x_{2}^{2}} &amp;amp; - \frac{x_{1}^{2} x_{2}}{x_{1}^{2} - 2 x_{1} x_{2} + x_{2}^{2}}\\- \frac{6 x_{1} x_{2}}{x_{1}^{3} - 3 x_{1}^{2} x_{2} + 3 x_{1} x_{2}^{2} - x_{2}^{3}} &amp;amp; \frac{6 x_{1} x_{2}}{x_{1}^{3} - 3 x_{1}^{2} x_{2} + 3 x_{1} x_{2}^{2} - x_{2}^{3}} &amp;amp; \frac{x_{2} \left(2 x_{1} + x_{2}\right)}{x_{1}^{2} - 2 x_{1} x_{2} + x_{2}^{2}} &amp;amp; \frac{x_{1} \left(x_{1} + 2 x_{2}\right)}{x_{1}^{2} - 2 x_{1} x_{2} + x_{2}^{2}}\\\frac{3 x_{1} + 3 x_{2}}{x_{1}^{3} - 3 x_{1}^{2} x_{2} + 3 x_{1} x_{2}^{2} - x_{2}^{3}} &amp;amp; - \frac{3 x_{1} + 3 x_{2}}{x_{1}^{3} - 3 x_{1}^{2} x_{2} + 3 x_{1} x_{2}^{2} - x_{2}^{3}} &amp;amp; - \frac{x_{1} + 2 x_{2}}{x_{1}^{2} - 2 x_{1} x_{2} + x_{2}^{2}} &amp;amp; - \frac{2 x_{1} + x_{2}}{x_{1}^{2} - 2 x_{1} x_{2} + x_{2}^{2}}\\- \frac{2}{x_{1}^{3} - 3 x_{1}^{2} x_{2} + 3 x_{1} x_{2}^{2} - x_{2}^{3}} &amp;amp; \frac{2}{x_{1}^{3} - 3 x_{1}^{2} x_{2} + 3 x_{1} x_{2}^{2} - x_{2}^{3}} &amp;amp; \frac{1}{x_{1}^{2} - 2 x_{1} x_{2} + x_{2}^{2}} &amp;amp; \frac{1}{x_{1}^{2} - 2 x_{1} x_{2} + x_{2}^{2}}\end{matrix}\right]
\end{equation*}
&lt;/div&gt;
&lt;p&gt;And we replace the values for the extreme nodes, -1 and 1.&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code ipython2"&gt;&lt;a id="rest_code_072f17d9d1c54813b31960a91ba86278-1" name="rest_code_072f17d9d1c54813b31960a91ba86278-1" href="https://nicoguaro.github.io/posts/hermite_interp/#rest_code_072f17d9d1c54813b31960a91ba86278-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;V_inv&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;sym&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;simplify&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;V&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;subs&lt;/span&gt;&lt;span class="p"&gt;({&lt;/span&gt;&lt;span class="n"&gt;x1&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;x2&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;})&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;inv&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt;
&lt;a id="rest_code_072f17d9d1c54813b31960a91ba86278-2" name="rest_code_072f17d9d1c54813b31960a91ba86278-2" href="https://nicoguaro.github.io/posts/hermite_interp/#rest_code_072f17d9d1c54813b31960a91ba86278-2"&gt;&lt;/a&gt;&lt;span class="n"&gt;V_inv&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="math"&gt;
\begin{equation*}
\left[\begin{matrix}\frac{1}{2} &amp;amp; \frac{1}{2} &amp;amp; \frac{1}{4} &amp;amp; - \frac{1}{4}\\
- \frac{3}{4} &amp;amp; \frac{3}{4} &amp;amp; - \frac{1}{4} &amp;amp; - \frac{1}{4}\\
0 &amp;amp; 0 &amp;amp; - \frac{1}{4} &amp;amp; \frac{1}{4}\\
\frac{1}{4} &amp;amp; - \frac{1}{4} &amp;amp; \frac{1}{4} &amp;amp; \frac{1}{4}\end{matrix}\right]
\end{equation*}
&lt;/div&gt;
&lt;p&gt;The polynomials are the product of the coefficients and the monomials&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code ipython2"&gt;&lt;a id="rest_code_b7a1d2f632cf43308934b29fb0853588-1" name="rest_code_b7a1d2f632cf43308934b29fb0853588-1" href="https://nicoguaro.github.io/posts/hermite_interp/#rest_code_b7a1d2f632cf43308934b29fb0853588-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;sym&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;factor&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;V_inv&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;T&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;sym&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Matrix&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;]))&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="math"&gt;
\begin{equation*}
\left[\begin{matrix}\frac{1}{4} \left(x - 1\right)^{2} \left(x + 2\right)\\- \frac{1}{4} \left(x - 2\right) \left(x + 1\right)^{2}\\\frac{1}{4} \left(x - 1\right)^{2} \left(x + 1\right)\\\frac{1}{4} \left(x - 1\right) \left(x + 1\right)^{2}\end{matrix}\right]
\end{equation*}
&lt;/div&gt;
&lt;p&gt;The interpolation basis would be&lt;/p&gt;
&lt;div class="math"&gt;
\begin{align*}
N_1 (x) &amp;amp;= \frac{1}{4} (x - 1)^2 (2 + x)\\
N_2 (x) &amp;amp;= \frac{1}{4} (x + 1)^2 (2 - x)\\
N_3 (x) &amp;amp;= \frac{1}{4} (x - 1)^2 (x + 1)\\
N_4 (x) &amp;amp;= \frac{1}{4} (x + 1)^2 (x - 1)\, ,
\end{align*}
&lt;/div&gt;
&lt;p&gt;and the following function computes the interpolation for a given
function and derivative&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code ipython2"&gt;&lt;a id="rest_code_5498cbe444b549c28228cc65a6d987aa-1" name="rest_code_5498cbe444b549c28228cc65a6d987aa-1" href="https://nicoguaro.github.io/posts/hermite_interp/#rest_code_5498cbe444b549c28228cc65a6d987aa-1"&gt;&lt;/a&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;hermite_interp&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;fun&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;grad&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;x0&lt;/span&gt;&lt;span class="o"&gt;=-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;x1&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;npts&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;101&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_5498cbe444b549c28228cc65a6d987aa-2" name="rest_code_5498cbe444b549c28228cc65a6d987aa-2" href="https://nicoguaro.github.io/posts/hermite_interp/#rest_code_5498cbe444b549c28228cc65a6d987aa-2"&gt;&lt;/a&gt;    &lt;span class="n"&gt;jaco&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x1&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;x0&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;
&lt;a id="rest_code_5498cbe444b549c28228cc65a6d987aa-3" name="rest_code_5498cbe444b549c28228cc65a6d987aa-3" href="https://nicoguaro.github.io/posts/hermite_interp/#rest_code_5498cbe444b549c28228cc65a6d987aa-3"&gt;&lt;/a&gt;    &lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;linspace&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;npts&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_5498cbe444b549c28228cc65a6d987aa-4" name="rest_code_5498cbe444b549c28228cc65a6d987aa-4" href="https://nicoguaro.github.io/posts/hermite_interp/#rest_code_5498cbe444b549c28228cc65a6d987aa-4"&gt;&lt;/a&gt;    &lt;span class="n"&gt;f1&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;fun&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x0&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_5498cbe444b549c28228cc65a6d987aa-5" name="rest_code_5498cbe444b549c28228cc65a6d987aa-5" href="https://nicoguaro.github.io/posts/hermite_interp/#rest_code_5498cbe444b549c28228cc65a6d987aa-5"&gt;&lt;/a&gt;    &lt;span class="n"&gt;f2&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;fun&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_5498cbe444b549c28228cc65a6d987aa-6" name="rest_code_5498cbe444b549c28228cc65a6d987aa-6" href="https://nicoguaro.github.io/posts/hermite_interp/#rest_code_5498cbe444b549c28228cc65a6d987aa-6"&gt;&lt;/a&gt;    &lt;span class="n"&gt;g1&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;grad&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x0&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_5498cbe444b549c28228cc65a6d987aa-7" name="rest_code_5498cbe444b549c28228cc65a6d987aa-7" href="https://nicoguaro.github.io/posts/hermite_interp/#rest_code_5498cbe444b549c28228cc65a6d987aa-7"&gt;&lt;/a&gt;    &lt;span class="n"&gt;g2&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;grad&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_5498cbe444b549c28228cc65a6d987aa-8" name="rest_code_5498cbe444b549c28228cc65a6d987aa-8" href="https://nicoguaro.github.io/posts/hermite_interp/#rest_code_5498cbe444b549c28228cc65a6d987aa-8"&gt;&lt;/a&gt;    &lt;span class="n"&gt;N1&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_5498cbe444b549c28228cc65a6d987aa-9" name="rest_code_5498cbe444b549c28228cc65a6d987aa-9" href="https://nicoguaro.github.io/posts/hermite_interp/#rest_code_5498cbe444b549c28228cc65a6d987aa-9"&gt;&lt;/a&gt;    &lt;span class="n"&gt;N2&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_5498cbe444b549c28228cc65a6d987aa-10" name="rest_code_5498cbe444b549c28228cc65a6d987aa-10" href="https://nicoguaro.github.io/posts/hermite_interp/#rest_code_5498cbe444b549c28228cc65a6d987aa-10"&gt;&lt;/a&gt;    &lt;span class="n"&gt;N3&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_5498cbe444b549c28228cc65a6d987aa-11" name="rest_code_5498cbe444b549c28228cc65a6d987aa-11" href="https://nicoguaro.github.io/posts/hermite_interp/#rest_code_5498cbe444b549c28228cc65a6d987aa-11"&gt;&lt;/a&gt;    &lt;span class="n"&gt;N4&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_5498cbe444b549c28228cc65a6d987aa-12" name="rest_code_5498cbe444b549c28228cc65a6d987aa-12" href="https://nicoguaro.github.io/posts/hermite_interp/#rest_code_5498cbe444b549c28228cc65a6d987aa-12"&gt;&lt;/a&gt;    &lt;span class="n"&gt;interp&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;N1&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;f1&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;N2&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;f2&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;jaco&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N3&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;g1&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;N4&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;g2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_5498cbe444b549c28228cc65a6d987aa-13" name="rest_code_5498cbe444b549c28228cc65a6d987aa-13" href="https://nicoguaro.github.io/posts/hermite_interp/#rest_code_5498cbe444b549c28228cc65a6d987aa-13"&gt;&lt;/a&gt;    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;interp&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;In this case, we interpolate the &lt;code class="docutils literal"&gt;sinc&lt;/code&gt; function&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code ipython2"&gt;&lt;a id="rest_code_d3d3c43599eb40caab1fc4939d5cca8b-1" name="rest_code_d3d3c43599eb40caab1fc4939d5cca8b-1" href="https://nicoguaro.github.io/posts/hermite_interp/#rest_code_d3d3c43599eb40caab1fc4939d5cca8b-1"&gt;&lt;/a&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;fun&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_d3d3c43599eb40caab1fc4939d5cca8b-2" name="rest_code_d3d3c43599eb40caab1fc4939d5cca8b-2" href="https://nicoguaro.github.io/posts/hermite_interp/#rest_code_d3d3c43599eb40caab1fc4939d5cca8b-2"&gt;&lt;/a&gt;    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sin&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;pi&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;pi&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_d3d3c43599eb40caab1fc4939d5cca8b-3" name="rest_code_d3d3c43599eb40caab1fc4939d5cca8b-3" href="https://nicoguaro.github.io/posts/hermite_interp/#rest_code_d3d3c43599eb40caab1fc4939d5cca8b-3"&gt;&lt;/a&gt;
&lt;a id="rest_code_d3d3c43599eb40caab1fc4939d5cca8b-4" name="rest_code_d3d3c43599eb40caab1fc4939d5cca8b-4" href="https://nicoguaro.github.io/posts/hermite_interp/#rest_code_d3d3c43599eb40caab1fc4939d5cca8b-4"&gt;&lt;/a&gt;
&lt;a id="rest_code_d3d3c43599eb40caab1fc4939d5cca8b-5" name="rest_code_d3d3c43599eb40caab1fc4939d5cca8b-5" href="https://nicoguaro.github.io/posts/hermite_interp/#rest_code_d3d3c43599eb40caab1fc4939d5cca8b-5"&gt;&lt;/a&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;grad&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_d3d3c43599eb40caab1fc4939d5cca8b-6" name="rest_code_d3d3c43599eb40caab1fc4939d5cca8b-6" href="https://nicoguaro.github.io/posts/hermite_interp/#rest_code_d3d3c43599eb40caab1fc4939d5cca8b-6"&gt;&lt;/a&gt;    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;cos&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;pi&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sin&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;pi&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;pi&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;The following snippet compute the interpolation and plot it.&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code ipython2"&gt;&lt;a id="rest_code_ab739ec023264fe6829a5c2eee2db556-1" name="rest_code_ab739ec023264fe6829a5c2eee2db556-1" href="https://nicoguaro.github.io/posts/hermite_interp/#rest_code_ab739ec023264fe6829a5c2eee2db556-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;a&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;
&lt;a id="rest_code_ab739ec023264fe6829a5c2eee2db556-2" name="rest_code_ab739ec023264fe6829a5c2eee2db556-2" href="https://nicoguaro.github.io/posts/hermite_interp/#rest_code_ab739ec023264fe6829a5c2eee2db556-2"&gt;&lt;/a&gt;&lt;span class="n"&gt;b&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;5&lt;/span&gt;
&lt;a id="rest_code_ab739ec023264fe6829a5c2eee2db556-3" name="rest_code_ab739ec023264fe6829a5c2eee2db556-3" href="https://nicoguaro.github.io/posts/hermite_interp/#rest_code_ab739ec023264fe6829a5c2eee2db556-3"&gt;&lt;/a&gt;&lt;span class="n"&gt;nels&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;7&lt;/span&gt;
&lt;a id="rest_code_ab739ec023264fe6829a5c2eee2db556-4" name="rest_code_ab739ec023264fe6829a5c2eee2db556-4" href="https://nicoguaro.github.io/posts/hermite_interp/#rest_code_ab739ec023264fe6829a5c2eee2db556-4"&gt;&lt;/a&gt;&lt;span class="n"&gt;npts&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;200&lt;/span&gt;
&lt;a id="rest_code_ab739ec023264fe6829a5c2eee2db556-5" name="rest_code_ab739ec023264fe6829a5c2eee2db556-5" href="https://nicoguaro.github.io/posts/hermite_interp/#rest_code_ab739ec023264fe6829a5c2eee2db556-5"&gt;&lt;/a&gt;&lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;linspace&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;npts&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_ab739ec023264fe6829a5c2eee2db556-6" name="rest_code_ab739ec023264fe6829a5c2eee2db556-6" href="https://nicoguaro.github.io/posts/hermite_interp/#rest_code_ab739ec023264fe6829a5c2eee2db556-6"&gt;&lt;/a&gt;&lt;span class="n"&gt;y&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;fun&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_ab739ec023264fe6829a5c2eee2db556-7" name="rest_code_ab739ec023264fe6829a5c2eee2db556-7" href="https://nicoguaro.github.io/posts/hermite_interp/#rest_code_ab739ec023264fe6829a5c2eee2db556-7"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;plot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;color&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;"black"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_ab739ec023264fe6829a5c2eee2db556-8" name="rest_code_ab739ec023264fe6829a5c2eee2db556-8" href="https://nicoguaro.github.io/posts/hermite_interp/#rest_code_ab739ec023264fe6829a5c2eee2db556-8"&gt;&lt;/a&gt;&lt;span class="n"&gt;xi&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;linspace&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;num&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;nels&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;endpoint&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;False&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_ab739ec023264fe6829a5c2eee2db556-9" name="rest_code_ab739ec023264fe6829a5c2eee2db556-9" href="https://nicoguaro.github.io/posts/hermite_interp/#rest_code_ab739ec023264fe6829a5c2eee2db556-9"&gt;&lt;/a&gt;&lt;span class="n"&gt;dx&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;xi&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;xi&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_ab739ec023264fe6829a5c2eee2db556-10" name="rest_code_ab739ec023264fe6829a5c2eee2db556-10" href="https://nicoguaro.github.io/posts/hermite_interp/#rest_code_ab739ec023264fe6829a5c2eee2db556-10"&gt;&lt;/a&gt;&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;x0&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;xi&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a id="rest_code_ab739ec023264fe6829a5c2eee2db556-11" name="rest_code_ab739ec023264fe6829a5c2eee2db556-11" href="https://nicoguaro.github.io/posts/hermite_interp/#rest_code_ab739ec023264fe6829a5c2eee2db556-11"&gt;&lt;/a&gt;    &lt;span class="n"&gt;x1&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;x0&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;dx&lt;/span&gt;
&lt;a id="rest_code_ab739ec023264fe6829a5c2eee2db556-12" name="rest_code_ab739ec023264fe6829a5c2eee2db556-12" href="https://nicoguaro.github.io/posts/hermite_interp/#rest_code_ab739ec023264fe6829a5c2eee2db556-12"&gt;&lt;/a&gt;    &lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;linspace&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;x1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;npts&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_ab739ec023264fe6829a5c2eee2db556-13" name="rest_code_ab739ec023264fe6829a5c2eee2db556-13" href="https://nicoguaro.github.io/posts/hermite_interp/#rest_code_ab739ec023264fe6829a5c2eee2db556-13"&gt;&lt;/a&gt;    &lt;span class="n"&gt;y&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;hermite_interp&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;fun&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;grad&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;x0&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;x0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;x1&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;x1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;npts&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;npts&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_ab739ec023264fe6829a5c2eee2db556-14" name="rest_code_ab739ec023264fe6829a5c2eee2db556-14" href="https://nicoguaro.github.io/posts/hermite_interp/#rest_code_ab739ec023264fe6829a5c2eee2db556-14"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;plot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;linestyle&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;"dashed"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;color&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;"#4daf4a"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_ab739ec023264fe6829a5c2eee2db556-15" name="rest_code_ab739ec023264fe6829a5c2eee2db556-15" href="https://nicoguaro.github.io/posts/hermite_interp/#rest_code_ab739ec023264fe6829a5c2eee2db556-15"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;plot&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]],&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]],&lt;/span&gt; &lt;span class="n"&gt;marker&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;"o"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;color&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;"#4daf4a"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;a id="rest_code_ab739ec023264fe6829a5c2eee2db556-16" name="rest_code_ab739ec023264fe6829a5c2eee2db556-16" href="https://nicoguaro.github.io/posts/hermite_interp/#rest_code_ab739ec023264fe6829a5c2eee2db556-16"&gt;&lt;/a&gt;         &lt;span class="n"&gt;linewidth&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_ab739ec023264fe6829a5c2eee2db556-17" name="rest_code_ab739ec023264fe6829a5c2eee2db556-17" href="https://nicoguaro.github.io/posts/hermite_interp/#rest_code_ab739ec023264fe6829a5c2eee2db556-17"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"x"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_ab739ec023264fe6829a5c2eee2db556-18" name="rest_code_ab739ec023264fe6829a5c2eee2db556-18" href="https://nicoguaro.github.io/posts/hermite_interp/#rest_code_ab739ec023264fe6829a5c2eee2db556-18"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ylabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"y"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_ab739ec023264fe6829a5c2eee2db556-19" name="rest_code_ab739ec023264fe6829a5c2eee2db556-19" href="https://nicoguaro.github.io/posts/hermite_interp/#rest_code_ab739ec023264fe6829a5c2eee2db556-19"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;legend&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="s2"&gt;"Exact function"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;"Interpolation"&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_ab739ec023264fe6829a5c2eee2db556-20" name="rest_code_ab739ec023264fe6829a5c2eee2db556-20" href="https://nicoguaro.github.io/posts/hermite_interp/#rest_code_ab739ec023264fe6829a5c2eee2db556-20"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;show&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;img alt="/images/sinc_interp.svg" src="https://nicoguaro.github.io/images/sinc_interp.svg"&gt;
&lt;section id="references"&gt;
&lt;h2&gt;References&lt;/h2&gt;
&lt;aside class="footnote-list brackets"&gt;
&lt;aside class="footnote brackets" id="footnote-1" role="note"&gt;
&lt;span class="label"&gt;&lt;span class="fn-bracket"&gt;[&lt;/span&gt;&lt;a role="doc-backlink" href="https://nicoguaro.github.io/posts/hermite_interp/#footnote-reference-1"&gt;1&lt;/a&gt;&lt;span class="fn-bracket"&gt;]&lt;/span&gt;&lt;/span&gt;
&lt;p&gt;Walter Gautschi (1962). On inverses of Vandermonde
and confluent Vandermonde matrices. Numerische Mathematik, 4
117-123.&lt;/p&gt;
&lt;/aside&gt;
&lt;/aside&gt;
&lt;/section&gt;</description><category>approximation</category><category>finite element method</category><category>interpolation</category><category>python</category><category>sympy</category><guid>https://nicoguaro.github.io/posts/hermite_interp/</guid><pubDate>Thu, 22 Jun 2017 21:24:44 GMT</pubDate></item></channel></rss>