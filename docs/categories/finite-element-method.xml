<?xml version="1.0" encoding="utf-8"?>
<?xml-stylesheet type="text/xsl" href="../assets/xml/rss.xsl" media="all"?><rss version="2.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Nicolás' blog (Posts about finite element method)</title><link>https://nicoguaro.github.io/</link><description></description><atom:link href="https://nicoguaro.github.io/categories/finite-element-method.xml" rel="self" type="application/rss+xml"></atom:link><language>en</language><copyright>Contents © 2022 &lt;a href="mailto:nicoguarin@gmail.com"&gt;Nicolás Guarín-Zapata&lt;/a&gt; 
&lt;a rel="license" href="http://creativecommons.org/licenses/by/4.0/"&gt;
&lt;img alt="Creative Commons License"
style="border-width:0"
src="https://i.creativecommons.org/l/by/4.0/88x31.png"&gt;&lt;/a&gt;</copyright><lastBuildDate>Fri, 21 Oct 2022 17:34:08 GMT</lastBuildDate><generator>Nikola (getnikola.com)</generator><docs>http://blogs.law.harvard.edu/tech/rss</docs><item><title>Numerical methods challenge: Day 31</title><link>https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/</link><dc:creator>Nicolás Guarín-Zapata</dc:creator><description>&lt;p&gt;During October (2017) I wrote a program per day for some well-known
numerical methods in both Python and Julia. It was intended to be an exercise,
then don't expect the code to be good enough for real use. Also,
I should mention that I had almost no experience with Julia, so it
probably is not idiomatic Julia but more Python-like Julia.&lt;/p&gt;
&lt;section id="putting-some-things-together"&gt;
&lt;h2&gt;Putting some things together&lt;/h2&gt;
&lt;p&gt;Today, I am putting some things together, namely, I am going to solve the
system of equations that results in the finite element using the conjugate
gradient.&lt;/p&gt;
&lt;p&gt;Following are the codes&lt;/p&gt;
&lt;section id="python"&gt;
&lt;h3&gt;Python&lt;/h3&gt;
&lt;div class="code"&gt;&lt;pre class="code python"&gt;&lt;a id="rest_code_3154a174caf147928a6d07c572330899-1" name="rest_code_3154a174caf147928a6d07c572330899-1" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_3154a174caf147928a6d07c572330899-1"&gt;&lt;/a&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;__future__&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;division&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;print_function&lt;/span&gt;
&lt;a id="rest_code_3154a174caf147928a6d07c572330899-2" name="rest_code_3154a174caf147928a6d07c572330899-2" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_3154a174caf147928a6d07c572330899-2"&gt;&lt;/a&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;numpy&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;np&lt;/span&gt;
&lt;a id="rest_code_3154a174caf147928a6d07c572330899-3" name="rest_code_3154a174caf147928a6d07c572330899-3" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_3154a174caf147928a6d07c572330899-3"&gt;&lt;/a&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;matplotlib.pyplot&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;plt&lt;/span&gt;
&lt;a id="rest_code_3154a174caf147928a6d07c572330899-4" name="rest_code_3154a174caf147928a6d07c572330899-4" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_3154a174caf147928a6d07c572330899-4"&gt;&lt;/a&gt;
&lt;a id="rest_code_3154a174caf147928a6d07c572330899-5" name="rest_code_3154a174caf147928a6d07c572330899-5" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_3154a174caf147928a6d07c572330899-5"&gt;&lt;/a&gt;
&lt;a id="rest_code_3154a174caf147928a6d07c572330899-6" name="rest_code_3154a174caf147928a6d07c572330899-6" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_3154a174caf147928a6d07c572330899-6"&gt;&lt;/a&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;FEM1D&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;source&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_3154a174caf147928a6d07c572330899-7" name="rest_code_3154a174caf147928a6d07c572330899-7" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_3154a174caf147928a6d07c572330899-7"&gt;&lt;/a&gt;    &lt;span class="n"&gt;N&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_3154a174caf147928a6d07c572330899-8" name="rest_code_3154a174caf147928a6d07c572330899-8" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_3154a174caf147928a6d07c572330899-8"&gt;&lt;/a&gt;    &lt;span class="n"&gt;stiff_loc&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;([[&lt;/span&gt;&lt;span class="mf"&gt;2.0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;2.0&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;2.0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;2.0&lt;/span&gt;&lt;span class="p"&gt;]])&lt;/span&gt;
&lt;a id="rest_code_3154a174caf147928a6d07c572330899-9" name="rest_code_3154a174caf147928a6d07c572330899-9" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_3154a174caf147928a6d07c572330899-9"&gt;&lt;/a&gt;    &lt;span class="n"&gt;eles&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="n"&gt;cont&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;cont&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;cont&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;N&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)]&lt;/span&gt;
&lt;a id="rest_code_3154a174caf147928a6d07c572330899-10" name="rest_code_3154a174caf147928a6d07c572330899-10" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_3154a174caf147928a6d07c572330899-10"&gt;&lt;/a&gt;    &lt;span class="n"&gt;stiff&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_3154a174caf147928a6d07c572330899-11" name="rest_code_3154a174caf147928a6d07c572330899-11" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_3154a174caf147928a6d07c572330899-11"&gt;&lt;/a&gt;    &lt;span class="n"&gt;rhs&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_3154a174caf147928a6d07c572330899-12" name="rest_code_3154a174caf147928a6d07c572330899-12" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_3154a174caf147928a6d07c572330899-12"&gt;&lt;/a&gt;    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;ele&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;eles&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a id="rest_code_3154a174caf147928a6d07c572330899-13" name="rest_code_3154a174caf147928a6d07c572330899-13" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_3154a174caf147928a6d07c572330899-13"&gt;&lt;/a&gt;        &lt;span class="n"&gt;jaco&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ele&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]]&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ele&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]]&lt;/span&gt;
&lt;a id="rest_code_3154a174caf147928a6d07c572330899-14" name="rest_code_3154a174caf147928a6d07c572330899-14" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_3154a174caf147928a6d07c572330899-14"&gt;&lt;/a&gt;        &lt;span class="n"&gt;rhs&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ele&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;rhs&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ele&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;jaco&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;source&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ele&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_3154a174caf147928a6d07c572330899-15" name="rest_code_3154a174caf147928a6d07c572330899-15" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_3154a174caf147928a6d07c572330899-15"&gt;&lt;/a&gt;        &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;cont1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;row&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;enumerate&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ele&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_3154a174caf147928a6d07c572330899-16" name="rest_code_3154a174caf147928a6d07c572330899-16" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_3154a174caf147928a6d07c572330899-16"&gt;&lt;/a&gt;            &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;cont2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;col&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;enumerate&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ele&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_3154a174caf147928a6d07c572330899-17" name="rest_code_3154a174caf147928a6d07c572330899-17" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_3154a174caf147928a6d07c572330899-17"&gt;&lt;/a&gt;                &lt;span class="n"&gt;stiff&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;row&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;stiff&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;row&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt;  &lt;span class="n"&gt;stiff_loc&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;cont1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;cont2&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;jaco&lt;/span&gt;
&lt;a id="rest_code_3154a174caf147928a6d07c572330899-18" name="rest_code_3154a174caf147928a6d07c572330899-18" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_3154a174caf147928a6d07c572330899-18"&gt;&lt;/a&gt;    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;stiff&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;rhs&lt;/span&gt;
&lt;a id="rest_code_3154a174caf147928a6d07c572330899-19" name="rest_code_3154a174caf147928a6d07c572330899-19" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_3154a174caf147928a6d07c572330899-19"&gt;&lt;/a&gt;
&lt;a id="rest_code_3154a174caf147928a6d07c572330899-20" name="rest_code_3154a174caf147928a6d07c572330899-20" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_3154a174caf147928a6d07c572330899-20"&gt;&lt;/a&gt;
&lt;a id="rest_code_3154a174caf147928a6d07c572330899-21" name="rest_code_3154a174caf147928a6d07c572330899-21" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_3154a174caf147928a6d07c572330899-21"&gt;&lt;/a&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;conj_grad&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;tol&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mf"&gt;1e-8&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_3154a174caf147928a6d07c572330899-22" name="rest_code_3154a174caf147928a6d07c572330899-22" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_3154a174caf147928a6d07c572330899-22"&gt;&lt;/a&gt;    &lt;span class="n"&gt;r&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;b&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;dot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_3154a174caf147928a6d07c572330899-23" name="rest_code_3154a174caf147928a6d07c572330899-23" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_3154a174caf147928a6d07c572330899-23"&gt;&lt;/a&gt;    &lt;span class="n"&gt;p&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;r&lt;/span&gt;
&lt;a id="rest_code_3154a174caf147928a6d07c572330899-24" name="rest_code_3154a174caf147928a6d07c572330899-24" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_3154a174caf147928a6d07c572330899-24"&gt;&lt;/a&gt;    &lt;span class="n"&gt;rsq_old&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;dot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_3154a174caf147928a6d07c572330899-25" name="rest_code_3154a174caf147928a6d07c572330899-25" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_3154a174caf147928a6d07c572330899-25"&gt;&lt;/a&gt;    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;cont&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;)):&lt;/span&gt;
&lt;a id="rest_code_3154a174caf147928a6d07c572330899-26" name="rest_code_3154a174caf147928a6d07c572330899-26" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_3154a174caf147928a6d07c572330899-26"&gt;&lt;/a&gt;        &lt;span class="n"&gt;Ap&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;dot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_3154a174caf147928a6d07c572330899-27" name="rest_code_3154a174caf147928a6d07c572330899-27" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_3154a174caf147928a6d07c572330899-27"&gt;&lt;/a&gt;        &lt;span class="n"&gt;alpha&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;rsq_old&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;dot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Ap&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_3154a174caf147928a6d07c572330899-28" name="rest_code_3154a174caf147928a6d07c572330899-28" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_3154a174caf147928a6d07c572330899-28"&gt;&lt;/a&gt;        &lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;alpha&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;p&lt;/span&gt;
&lt;a id="rest_code_3154a174caf147928a6d07c572330899-29" name="rest_code_3154a174caf147928a6d07c572330899-29" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_3154a174caf147928a6d07c572330899-29"&gt;&lt;/a&gt;        &lt;span class="n"&gt;r&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;r&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;alpha&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;Ap&lt;/span&gt;
&lt;a id="rest_code_3154a174caf147928a6d07c572330899-30" name="rest_code_3154a174caf147928a6d07c572330899-30" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_3154a174caf147928a6d07c572330899-30"&gt;&lt;/a&gt;        &lt;span class="n"&gt;rsq_new&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;dot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_3154a174caf147928a6d07c572330899-31" name="rest_code_3154a174caf147928a6d07c572330899-31" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_3154a174caf147928a6d07c572330899-31"&gt;&lt;/a&gt;        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sqrt&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;rsq_new&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;tol&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a id="rest_code_3154a174caf147928a6d07c572330899-32" name="rest_code_3154a174caf147928a6d07c572330899-32" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_3154a174caf147928a6d07c572330899-32"&gt;&lt;/a&gt;            &lt;span class="k"&gt;break&lt;/span&gt;
&lt;a id="rest_code_3154a174caf147928a6d07c572330899-33" name="rest_code_3154a174caf147928a6d07c572330899-33" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_3154a174caf147928a6d07c572330899-33"&gt;&lt;/a&gt;        &lt;span class="n"&gt;p&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;r&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;rsq_new&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="n"&gt;rsq_old&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;p&lt;/span&gt;
&lt;a id="rest_code_3154a174caf147928a6d07c572330899-34" name="rest_code_3154a174caf147928a6d07c572330899-34" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_3154a174caf147928a6d07c572330899-34"&gt;&lt;/a&gt;        &lt;span class="n"&gt;rsq_old&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;rsq_new&lt;/span&gt;
&lt;a id="rest_code_3154a174caf147928a6d07c572330899-35" name="rest_code_3154a174caf147928a6d07c572330899-35" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_3154a174caf147928a6d07c572330899-35"&gt;&lt;/a&gt;    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;cont&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sqrt&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;rsq_new&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_3154a174caf147928a6d07c572330899-36" name="rest_code_3154a174caf147928a6d07c572330899-36" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_3154a174caf147928a6d07c572330899-36"&gt;&lt;/a&gt;
&lt;a id="rest_code_3154a174caf147928a6d07c572330899-37" name="rest_code_3154a174caf147928a6d07c572330899-37" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_3154a174caf147928a6d07c572330899-37"&gt;&lt;/a&gt;
&lt;a id="rest_code_3154a174caf147928a6d07c572330899-38" name="rest_code_3154a174caf147928a6d07c572330899-38" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_3154a174caf147928a6d07c572330899-38"&gt;&lt;/a&gt;&lt;span class="n"&gt;fun&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;lambda&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;
&lt;a id="rest_code_3154a174caf147928a6d07c572330899-39" name="rest_code_3154a174caf147928a6d07c572330899-39" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_3154a174caf147928a6d07c572330899-39"&gt;&lt;/a&gt;&lt;span class="n"&gt;N_vec&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;logspace&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;0.5&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;50&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;dtype&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nb"&gt;int&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_3154a174caf147928a6d07c572330899-40" name="rest_code_3154a174caf147928a6d07c572330899-40" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_3154a174caf147928a6d07c572330899-40"&gt;&lt;/a&gt;&lt;span class="n"&gt;err_vec&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros_like&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N_vec&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;dtype&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nb"&gt;float&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_3154a174caf147928a6d07c572330899-41" name="rest_code_3154a174caf147928a6d07c572330899-41" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_3154a174caf147928a6d07c572330899-41"&gt;&lt;/a&gt;&lt;span class="n"&gt;niter_vec&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros_like&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N_vec&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_3154a174caf147928a6d07c572330899-42" name="rest_code_3154a174caf147928a6d07c572330899-42" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_3154a174caf147928a6d07c572330899-42"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;figure&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;figsize&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;8&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_3154a174caf147928a6d07c572330899-43" name="rest_code_3154a174caf147928a6d07c572330899-43" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_3154a174caf147928a6d07c572330899-43"&gt;&lt;/a&gt;&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;cont&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;N&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;enumerate&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N_vec&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_3154a174caf147928a6d07c572330899-44" name="rest_code_3154a174caf147928a6d07c572330899-44" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_3154a174caf147928a6d07c572330899-44"&gt;&lt;/a&gt;    &lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;linspace&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_3154a174caf147928a6d07c572330899-45" name="rest_code_3154a174caf147928a6d07c572330899-45" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_3154a174caf147928a6d07c572330899-45"&gt;&lt;/a&gt;    &lt;span class="n"&gt;stiff&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;rhs&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;FEM1D&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;fun&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_3154a174caf147928a6d07c572330899-46" name="rest_code_3154a174caf147928a6d07c572330899-46" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_3154a174caf147928a6d07c572330899-46"&gt;&lt;/a&gt;    &lt;span class="n"&gt;sol&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_3154a174caf147928a6d07c572330899-47" name="rest_code_3154a174caf147928a6d07c572330899-47" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_3154a174caf147928a6d07c572330899-47"&gt;&lt;/a&gt;    &lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;niter&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;_&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;conj_grad&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;stiff&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;rhs&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;rhs&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_3154a174caf147928a6d07c572330899-48" name="rest_code_3154a174caf147928a6d07c572330899-48" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_3154a174caf147928a6d07c572330899-48"&gt;&lt;/a&gt;    &lt;span class="n"&gt;err&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;linalg&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;norm&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;sol&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="mi"&gt;20&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;linalg&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;norm&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="mi"&gt;20&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_3154a174caf147928a6d07c572330899-49" name="rest_code_3154a174caf147928a6d07c572330899-49" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_3154a174caf147928a6d07c572330899-49"&gt;&lt;/a&gt;    &lt;span class="n"&gt;err_vec&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;cont&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;err&lt;/span&gt;
&lt;a id="rest_code_3154a174caf147928a6d07c572330899-50" name="rest_code_3154a174caf147928a6d07c572330899-50" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_3154a174caf147928a6d07c572330899-50"&gt;&lt;/a&gt;    &lt;span class="n"&gt;niter_vec&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;cont&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;niter&lt;/span&gt;
&lt;a id="rest_code_3154a174caf147928a6d07c572330899-51" name="rest_code_3154a174caf147928a6d07c572330899-51" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_3154a174caf147928a6d07c572330899-51"&gt;&lt;/a&gt;
&lt;a id="rest_code_3154a174caf147928a6d07c572330899-52" name="rest_code_3154a174caf147928a6d07c572330899-52" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_3154a174caf147928a6d07c572330899-52"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;subplot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;121&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_3154a174caf147928a6d07c572330899-53" name="rest_code_3154a174caf147928a6d07c572330899-53" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_3154a174caf147928a6d07c572330899-53"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;loglog&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N_vec&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;err_vec&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_3154a174caf147928a6d07c572330899-54" name="rest_code_3154a174caf147928a6d07c572330899-54" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_3154a174caf147928a6d07c572330899-54"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"Number of nodes"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_3154a174caf147928a6d07c572330899-55" name="rest_code_3154a174caf147928a6d07c572330899-55" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_3154a174caf147928a6d07c572330899-55"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ylabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"Relative error"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_3154a174caf147928a6d07c572330899-56" name="rest_code_3154a174caf147928a6d07c572330899-56" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_3154a174caf147928a6d07c572330899-56"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;subplot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;122&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_3154a174caf147928a6d07c572330899-57" name="rest_code_3154a174caf147928a6d07c572330899-57" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_3154a174caf147928a6d07c572330899-57"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;loglog&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N_vec&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;niter_vec&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_3154a174caf147928a6d07c572330899-58" name="rest_code_3154a174caf147928a6d07c572330899-58" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_3154a174caf147928a6d07c572330899-58"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"Number of nodes"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_3154a174caf147928a6d07c572330899-59" name="rest_code_3154a174caf147928a6d07c572330899-59" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_3154a174caf147928a6d07c572330899-59"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ylabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"Number of iterations"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_3154a174caf147928a6d07c572330899-60" name="rest_code_3154a174caf147928a6d07c572330899-60" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_3154a174caf147928a6d07c572330899-60"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;tight_layout&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a id="rest_code_3154a174caf147928a6d07c572330899-61" name="rest_code_3154a174caf147928a6d07c572330899-61" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_3154a174caf147928a6d07c572330899-61"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;show&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/section&gt;
&lt;section id="julia"&gt;
&lt;h3&gt;Julia&lt;/h3&gt;
&lt;div class="code"&gt;&lt;pre class="code julia"&gt;&lt;a id="rest_code_5ed1587c67024447878df9c32cca0b6e-1" name="rest_code_5ed1587c67024447878df9c32cca0b6e-1" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_5ed1587c67024447878df9c32cca0b6e-1"&gt;&lt;/a&gt;&lt;span class="k"&gt;using&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;PyPlot&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_5ed1587c67024447878df9c32cca0b6e-2" name="rest_code_5ed1587c67024447878df9c32cca0b6e-2" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_5ed1587c67024447878df9c32cca0b6e-2"&gt;&lt;/a&gt;
&lt;a id="rest_code_5ed1587c67024447878df9c32cca0b6e-3" name="rest_code_5ed1587c67024447878df9c32cca0b6e-3" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_5ed1587c67024447878df9c32cca0b6e-3"&gt;&lt;/a&gt;
&lt;a id="rest_code_5ed1587c67024447878df9c32cca0b6e-4" name="rest_code_5ed1587c67024447878df9c32cca0b6e-4" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_5ed1587c67024447878df9c32cca0b6e-4"&gt;&lt;/a&gt;&lt;span class="k"&gt;function&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;FEM1D&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;source&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_5ed1587c67024447878df9c32cca0b6e-5" name="rest_code_5ed1587c67024447878df9c32cca0b6e-5" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_5ed1587c67024447878df9c32cca0b6e-5"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;length&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_5ed1587c67024447878df9c32cca0b6e-6" name="rest_code_5ed1587c67024447878df9c32cca0b6e-6" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_5ed1587c67024447878df9c32cca0b6e-6"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;stiff_loc&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mf"&gt;2.0&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;2.0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;2.0&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;2.0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_5ed1587c67024447878df9c32cca0b6e-7" name="rest_code_5ed1587c67024447878df9c32cca0b6e-7" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_5ed1587c67024447878df9c32cca0b6e-7"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;eles&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;[[&lt;/span&gt;&lt;span class="n"&gt;cont&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;cont&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;for&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;cont&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;in&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_5ed1587c67024447878df9c32cca0b6e-8" name="rest_code_5ed1587c67024447878df9c32cca0b6e-8" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_5ed1587c67024447878df9c32cca0b6e-8"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;stiff&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_5ed1587c67024447878df9c32cca0b6e-9" name="rest_code_5ed1587c67024447878df9c32cca0b6e-9" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_5ed1587c67024447878df9c32cca0b6e-9"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;rhs&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_5ed1587c67024447878df9c32cca0b6e-10" name="rest_code_5ed1587c67024447878df9c32cca0b6e-10" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_5ed1587c67024447878df9c32cca0b6e-10"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;for&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ele&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;in&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;eles&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_5ed1587c67024447878df9c32cca0b6e-11" name="rest_code_5ed1587c67024447878df9c32cca0b6e-11" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_5ed1587c67024447878df9c32cca0b6e-11"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;jaco&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ele&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;]]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ele&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]]&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_5ed1587c67024447878df9c32cca0b6e-12" name="rest_code_5ed1587c67024447878df9c32cca0b6e-12" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_5ed1587c67024447878df9c32cca0b6e-12"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;rhs&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ele&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;rhs&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ele&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;jaco&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;source&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ele&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_5ed1587c67024447878df9c32cca0b6e-13" name="rest_code_5ed1587c67024447878df9c32cca0b6e-13" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_5ed1587c67024447878df9c32cca0b6e-13"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;stiff&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ele&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ele&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;stiff&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ele&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ele&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;stiff_loc&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;jaco&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_5ed1587c67024447878df9c32cca0b6e-14" name="rest_code_5ed1587c67024447878df9c32cca0b6e-14" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_5ed1587c67024447878df9c32cca0b6e-14"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;end&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_5ed1587c67024447878df9c32cca0b6e-15" name="rest_code_5ed1587c67024447878df9c32cca0b6e-15" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_5ed1587c67024447878df9c32cca0b6e-15"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;return&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;stiff&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;rhs&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_5ed1587c67024447878df9c32cca0b6e-16" name="rest_code_5ed1587c67024447878df9c32cca0b6e-16" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_5ed1587c67024447878df9c32cca0b6e-16"&gt;&lt;/a&gt;&lt;span class="k"&gt;end&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_5ed1587c67024447878df9c32cca0b6e-17" name="rest_code_5ed1587c67024447878df9c32cca0b6e-17" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_5ed1587c67024447878df9c32cca0b6e-17"&gt;&lt;/a&gt;
&lt;a id="rest_code_5ed1587c67024447878df9c32cca0b6e-18" name="rest_code_5ed1587c67024447878df9c32cca0b6e-18" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_5ed1587c67024447878df9c32cca0b6e-18"&gt;&lt;/a&gt;
&lt;a id="rest_code_5ed1587c67024447878df9c32cca0b6e-19" name="rest_code_5ed1587c67024447878df9c32cca0b6e-19" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_5ed1587c67024447878df9c32cca0b6e-19"&gt;&lt;/a&gt;&lt;span class="k"&gt;function&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;conj_grad&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;tol&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mf"&gt;1e-8&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_5ed1587c67024447878df9c32cca0b6e-20" name="rest_code_5ed1587c67024447878df9c32cca0b6e-20" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_5ed1587c67024447878df9c32cca0b6e-20"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_5ed1587c67024447878df9c32cca0b6e-21" name="rest_code_5ed1587c67024447878df9c32cca0b6e-21" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_5ed1587c67024447878df9c32cca0b6e-21"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_5ed1587c67024447878df9c32cca0b6e-22" name="rest_code_5ed1587c67024447878df9c32cca0b6e-22" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_5ed1587c67024447878df9c32cca0b6e-22"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;rsq_old&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;dot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_5ed1587c67024447878df9c32cca0b6e-23" name="rest_code_5ed1587c67024447878df9c32cca0b6e-23" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_5ed1587c67024447878df9c32cca0b6e-23"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;niter&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_5ed1587c67024447878df9c32cca0b6e-24" name="rest_code_5ed1587c67024447878df9c32cca0b6e-24" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_5ed1587c67024447878df9c32cca0b6e-24"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;for&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;cont&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="n"&gt;length&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_5ed1587c67024447878df9c32cca0b6e-25" name="rest_code_5ed1587c67024447878df9c32cca0b6e-25" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_5ed1587c67024447878df9c32cca0b6e-25"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;Ap&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_5ed1587c67024447878df9c32cca0b6e-26" name="rest_code_5ed1587c67024447878df9c32cca0b6e-26" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_5ed1587c67024447878df9c32cca0b6e-26"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;alpha&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;rsq_old&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;dot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Ap&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_5ed1587c67024447878df9c32cca0b6e-27" name="rest_code_5ed1587c67024447878df9c32cca0b6e-27" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_5ed1587c67024447878df9c32cca0b6e-27"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;alpha&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_5ed1587c67024447878df9c32cca0b6e-28" name="rest_code_5ed1587c67024447878df9c32cca0b6e-28" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_5ed1587c67024447878df9c32cca0b6e-28"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;alpha&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;Ap&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_5ed1587c67024447878df9c32cca0b6e-29" name="rest_code_5ed1587c67024447878df9c32cca0b6e-29" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_5ed1587c67024447878df9c32cca0b6e-29"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;rsq_new&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;dot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_5ed1587c67024447878df9c32cca0b6e-30" name="rest_code_5ed1587c67024447878df9c32cca0b6e-30" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_5ed1587c67024447878df9c32cca0b6e-30"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;sqrt&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;rsq_new&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;tol&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_5ed1587c67024447878df9c32cca0b6e-31" name="rest_code_5ed1587c67024447878df9c32cca0b6e-31" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_5ed1587c67024447878df9c32cca0b6e-31"&gt;&lt;/a&gt;&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="k"&gt;break&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_5ed1587c67024447878df9c32cca0b6e-32" name="rest_code_5ed1587c67024447878df9c32cca0b6e-32" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_5ed1587c67024447878df9c32cca0b6e-32"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="k"&gt;end&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_5ed1587c67024447878df9c32cca0b6e-33" name="rest_code_5ed1587c67024447878df9c32cca0b6e-33" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_5ed1587c67024447878df9c32cca0b6e-33"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;rsq_new&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;rsq_old&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_5ed1587c67024447878df9c32cca0b6e-34" name="rest_code_5ed1587c67024447878df9c32cca0b6e-34" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_5ed1587c67024447878df9c32cca0b6e-34"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;rsq_old&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;rsq_new&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_5ed1587c67024447878df9c32cca0b6e-35" name="rest_code_5ed1587c67024447878df9c32cca0b6e-35" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_5ed1587c67024447878df9c32cca0b6e-35"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;niter&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_5ed1587c67024447878df9c32cca0b6e-36" name="rest_code_5ed1587c67024447878df9c32cca0b6e-36" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_5ed1587c67024447878df9c32cca0b6e-36"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;end&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_5ed1587c67024447878df9c32cca0b6e-37" name="rest_code_5ed1587c67024447878df9c32cca0b6e-37" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_5ed1587c67024447878df9c32cca0b6e-37"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;return&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;niter&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;norm&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_5ed1587c67024447878df9c32cca0b6e-38" name="rest_code_5ed1587c67024447878df9c32cca0b6e-38" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_5ed1587c67024447878df9c32cca0b6e-38"&gt;&lt;/a&gt;&lt;span class="k"&gt;end&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_5ed1587c67024447878df9c32cca0b6e-39" name="rest_code_5ed1587c67024447878df9c32cca0b6e-39" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_5ed1587c67024447878df9c32cca0b6e-39"&gt;&lt;/a&gt;
&lt;a id="rest_code_5ed1587c67024447878df9c32cca0b6e-40" name="rest_code_5ed1587c67024447878df9c32cca0b6e-40" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_5ed1587c67024447878df9c32cca0b6e-40"&gt;&lt;/a&gt;
&lt;a id="rest_code_5ed1587c67024447878df9c32cca0b6e-41" name="rest_code_5ed1587c67024447878df9c32cca0b6e-41" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_5ed1587c67024447878df9c32cca0b6e-41"&gt;&lt;/a&gt;
&lt;a id="rest_code_5ed1587c67024447878df9c32cca0b6e-42" name="rest_code_5ed1587c67024447878df9c32cca0b6e-42" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_5ed1587c67024447878df9c32cca0b6e-42"&gt;&lt;/a&gt;&lt;span class="n"&gt;fun&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;.^&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_5ed1587c67024447878df9c32cca0b6e-43" name="rest_code_5ed1587c67024447878df9c32cca0b6e-43" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_5ed1587c67024447878df9c32cca0b6e-43"&gt;&lt;/a&gt;&lt;span class="n"&gt;N_vec&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;round&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;logspace&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;0.5&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;50&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_5ed1587c67024447878df9c32cca0b6e-44" name="rest_code_5ed1587c67024447878df9c32cca0b6e-44" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_5ed1587c67024447878df9c32cca0b6e-44"&gt;&lt;/a&gt;&lt;span class="n"&gt;err_vec&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N_vec&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_5ed1587c67024447878df9c32cca0b6e-45" name="rest_code_5ed1587c67024447878df9c32cca0b6e-45" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_5ed1587c67024447878df9c32cca0b6e-45"&gt;&lt;/a&gt;&lt;span class="n"&gt;niter_vec&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N_vec&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_5ed1587c67024447878df9c32cca0b6e-46" name="rest_code_5ed1587c67024447878df9c32cca0b6e-46" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_5ed1587c67024447878df9c32cca0b6e-46"&gt;&lt;/a&gt;&lt;span class="n"&gt;figure&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;figsize&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;8&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_5ed1587c67024447878df9c32cca0b6e-47" name="rest_code_5ed1587c67024447878df9c32cca0b6e-47" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_5ed1587c67024447878df9c32cca0b6e-47"&gt;&lt;/a&gt;&lt;span class="k"&gt;for&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;cont&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;in&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;enumerate&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N_vec&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_5ed1587c67024447878df9c32cca0b6e-48" name="rest_code_5ed1587c67024447878df9c32cca0b6e-48" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_5ed1587c67024447878df9c32cca0b6e-48"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;linspace&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;0.0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;1.0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_5ed1587c67024447878df9c32cca0b6e-49" name="rest_code_5ed1587c67024447878df9c32cca0b6e-49" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_5ed1587c67024447878df9c32cca0b6e-49"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;stiff&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;rhs&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;FEM1D&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;fun&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_5ed1587c67024447878df9c32cca0b6e-50" name="rest_code_5ed1587c67024447878df9c32cca0b6e-50" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_5ed1587c67024447878df9c32cca0b6e-50"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_5ed1587c67024447878df9c32cca0b6e-51" name="rest_code_5ed1587c67024447878df9c32cca0b6e-51" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_5ed1587c67024447878df9c32cca0b6e-51"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="k"&gt;end&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;niter&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;_&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;conj_grad&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;stiff&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="k"&gt;end&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="k"&gt;end&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_5ed1587c67024447878df9c32cca0b6e-52" name="rest_code_5ed1587c67024447878df9c32cca0b6e-52" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_5ed1587c67024447878df9c32cca0b6e-52"&gt;&lt;/a&gt;&lt;span class="w"&gt;                                &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;rhs&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="k"&gt;end&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;rhs&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="k"&gt;end&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_5ed1587c67024447878df9c32cca0b6e-53" name="rest_code_5ed1587c67024447878df9c32cca0b6e-53" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_5ed1587c67024447878df9c32cca0b6e-53"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;err&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;norm&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;.*&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;.^&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="mi"&gt;20&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;norm&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;.*&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;.^&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="mi"&gt;20&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_5ed1587c67024447878df9c32cca0b6e-54" name="rest_code_5ed1587c67024447878df9c32cca0b6e-54" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_5ed1587c67024447878df9c32cca0b6e-54"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;err_vec&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;cont&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;err&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_5ed1587c67024447878df9c32cca0b6e-55" name="rest_code_5ed1587c67024447878df9c32cca0b6e-55" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_5ed1587c67024447878df9c32cca0b6e-55"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;niter_vec&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;cont&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;niter&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_5ed1587c67024447878df9c32cca0b6e-56" name="rest_code_5ed1587c67024447878df9c32cca0b6e-56" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_5ed1587c67024447878df9c32cca0b6e-56"&gt;&lt;/a&gt;&lt;span class="k"&gt;end&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_5ed1587c67024447878df9c32cca0b6e-57" name="rest_code_5ed1587c67024447878df9c32cca0b6e-57" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_5ed1587c67024447878df9c32cca0b6e-57"&gt;&lt;/a&gt;&lt;span class="n"&gt;subplot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;121&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_5ed1587c67024447878df9c32cca0b6e-58" name="rest_code_5ed1587c67024447878df9c32cca0b6e-58" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_5ed1587c67024447878df9c32cca0b6e-58"&gt;&lt;/a&gt;&lt;span class="n"&gt;loglog&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N_vec&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;err_vec&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_5ed1587c67024447878df9c32cca0b6e-59" name="rest_code_5ed1587c67024447878df9c32cca0b6e-59" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_5ed1587c67024447878df9c32cca0b6e-59"&gt;&lt;/a&gt;&lt;span class="n"&gt;xlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;"Number of nodes"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_5ed1587c67024447878df9c32cca0b6e-60" name="rest_code_5ed1587c67024447878df9c32cca0b6e-60" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_5ed1587c67024447878df9c32cca0b6e-60"&gt;&lt;/a&gt;&lt;span class="n"&gt;ylabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;"Relative error"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_5ed1587c67024447878df9c32cca0b6e-61" name="rest_code_5ed1587c67024447878df9c32cca0b6e-61" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_5ed1587c67024447878df9c32cca0b6e-61"&gt;&lt;/a&gt;&lt;span class="n"&gt;subplot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;122&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_5ed1587c67024447878df9c32cca0b6e-62" name="rest_code_5ed1587c67024447878df9c32cca0b6e-62" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_5ed1587c67024447878df9c32cca0b6e-62"&gt;&lt;/a&gt;&lt;span class="n"&gt;loglog&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N_vec&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;niter_vec&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_5ed1587c67024447878df9c32cca0b6e-63" name="rest_code_5ed1587c67024447878df9c32cca0b6e-63" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_5ed1587c67024447878df9c32cca0b6e-63"&gt;&lt;/a&gt;&lt;span class="n"&gt;xlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;"Number of nodes"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_5ed1587c67024447878df9c32cca0b6e-64" name="rest_code_5ed1587c67024447878df9c32cca0b6e-64" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_5ed1587c67024447878df9c32cca0b6e-64"&gt;&lt;/a&gt;&lt;span class="n"&gt;ylabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;"Number of iterations"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_5ed1587c67024447878df9c32cca0b6e-65" name="rest_code_5ed1587c67024447878df9c32cca0b6e-65" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_5ed1587c67024447878df9c32cca0b6e-65"&gt;&lt;/a&gt;&lt;span class="n"&gt;tight_layout&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_5ed1587c67024447878df9c32cca0b6e-66" name="rest_code_5ed1587c67024447878df9c32cca0b6e-66" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_5ed1587c67024447878df9c32cca0b6e-66"&gt;&lt;/a&gt;&lt;span class="n"&gt;show&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;In this case, we are analyzing the error of the solution as a function
of the number of nodes. This, and the number of iterations required
in the conjugate gradient are shown in the following image&lt;/p&gt;
&lt;img alt="Relative error in the solution." class="align-center" src="https://nicoguaro.github.io/images/FEM1D_convergence.svg" style="width: 800px;"&gt;
&lt;/section&gt;
&lt;/section&gt;</description><category>conjugate gradient</category><category>finite element method</category><category>julia</category><category>numerical methods</category><category>python</category><category>scientific computing</category><guid>https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/</guid><pubDate>Wed, 01 Nov 2017 01:45:09 GMT</pubDate></item><item><title>Numerical methods challenge: Day 25</title><link>https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/</link><dc:creator>Nicolás Guarín-Zapata</dc:creator><description>&lt;p&gt;During October (2017) I will write a program per day for some well-known
numerical methods in both Python and Julia. It is intended to be an exercise
then don't expect the code to be good enough for real use. Also,
I should mention that I have almost no experience with Julia, so it
probably won't be idiomatic Julia but more Python-like Julia.&lt;/p&gt;
&lt;section id="finite-element-method"&gt;
&lt;h2&gt;Finite element method&lt;/h2&gt;
&lt;p&gt;Today we have the &lt;a class="reference external" href="https://en.wikipedia.org/wiki/Finite_element_method"&gt;Finite element method&lt;/a&gt;
to solve the equation:&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
\nabla^2 u = -f(x)
\end{equation*}
&lt;/div&gt;
&lt;p&gt;with&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
u(\sqrt{3}, 1) = 0
\end{equation*}
&lt;/div&gt;
&lt;p&gt;As in the &lt;a class="reference external" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/posts/numerical-23"&gt;Ritz method&lt;/a&gt; we form
a functional that is &lt;em&gt;equivalent&lt;/em&gt; to the
differential equation, propose an approximation as a linear combination of
a set of basis functions and find the &lt;em&gt;best&lt;/em&gt; set of coefficients for that
combination. That &lt;em&gt;best&lt;/em&gt; solution is found minimizing the functional.&lt;/p&gt;
&lt;p&gt;The functional for this differential equation is&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
\Pi[u] = -\int_\Omega \left(\nabla u\right)^2 d\Omega
         -\int_\Omega  u f(x) d\Omega
\end{equation*}
&lt;/div&gt;
&lt;p&gt;Using linear triangles, the local stiffness matrices read&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
K_\text{local} =  \frac{1}{2|J|}
    \begin{bmatrix}
        2 &amp;amp; -1 &amp;amp;1\\
        -1 &amp;amp; 1 &amp;amp;0\\
        -1 &amp;amp; 0 &amp;amp;1\\
    \end{bmatrix}
\end{equation*}
&lt;/div&gt;
&lt;p&gt;and&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
b_\text{local} = -|J| f(x_m) \mathbf{1}_3\, ,
\end{equation*}
&lt;/div&gt;
&lt;p&gt;where &lt;span class="math"&gt;\(|J|\)&lt;/span&gt; is the Jacobian determinant of the transformation and
&lt;span class="math"&gt;\(x_m\)&lt;/span&gt; is the centroid of the triangle. I am
skipping a great deal about assembling, but it would be just too extensive
to describe the complete process.&lt;/p&gt;
&lt;p&gt;We will solve the problem in a mesh with 6 triangles forming
a regular hexagon&lt;/p&gt;
&lt;p&gt;Following are the codes.&lt;/p&gt;
&lt;section id="python"&gt;
&lt;h3&gt;Python&lt;/h3&gt;
&lt;div class="code"&gt;&lt;pre class="code python"&gt;&lt;a id="rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-1" name="rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-1" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-1"&gt;&lt;/a&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;__future__&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;division&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;print_function&lt;/span&gt;
&lt;a id="rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-2" name="rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-2" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-2"&gt;&lt;/a&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;numpy&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;np&lt;/span&gt;
&lt;a id="rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-3" name="rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-3" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-3"&gt;&lt;/a&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;matplotlib.pyplot&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;plt&lt;/span&gt;
&lt;a id="rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-4" name="rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-4" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-4"&gt;&lt;/a&gt;
&lt;a id="rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-5" name="rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-5" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-5"&gt;&lt;/a&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;assem&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;elems&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;source&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-6" name="rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-6" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-6"&gt;&lt;/a&gt;    &lt;span class="n"&gt;ncoords&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;shape&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-7" name="rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-7" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-7"&gt;&lt;/a&gt;    &lt;span class="n"&gt;stiff&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="n"&gt;ncoords&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;ncoords&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-8" name="rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-8" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-8"&gt;&lt;/a&gt;    &lt;span class="n"&gt;rhs&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="n"&gt;ncoords&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-9" name="rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-9" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-9"&gt;&lt;/a&gt;    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;el_cont&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;elem&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;enumerate&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;elems&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-10" name="rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-10" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-10"&gt;&lt;/a&gt;        &lt;span class="n"&gt;stiff_loc&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;jaco&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;local_stiff&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;elem&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-11" name="rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-11" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-11"&gt;&lt;/a&gt;        &lt;span class="n"&gt;rhs&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;elem&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;+=&lt;/span&gt; &lt;span class="n"&gt;jaco&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;mean&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;source&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;elem&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-12" name="rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-12" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-12"&gt;&lt;/a&gt;        &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;row&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-13" name="rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-13" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-13"&gt;&lt;/a&gt;            &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;col&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-14" name="rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-14" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-14"&gt;&lt;/a&gt;                &lt;span class="n"&gt;row_glob&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;col_glob&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;elem&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;row&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;elem&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-15" name="rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-15" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-15"&gt;&lt;/a&gt;                &lt;span class="n"&gt;stiff&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;row_glob&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;col_glob&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;+=&lt;/span&gt; &lt;span class="n"&gt;stiff_loc&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;row&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-16" name="rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-16" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-16"&gt;&lt;/a&gt;    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;stiff&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;rhs&lt;/span&gt;
&lt;a id="rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-17" name="rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-17" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-17"&gt;&lt;/a&gt;
&lt;a id="rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-18" name="rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-18" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-18"&gt;&lt;/a&gt;
&lt;a id="rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-19" name="rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-19" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-19"&gt;&lt;/a&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;local_stiff&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-20" name="rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-20" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-20"&gt;&lt;/a&gt;    &lt;span class="n"&gt;dHdr&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;([[&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]])&lt;/span&gt;
&lt;a id="rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-21" name="rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-21" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-21"&gt;&lt;/a&gt;    &lt;span class="n"&gt;jaco&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;dHdr&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;dot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-22" name="rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-22" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-22"&gt;&lt;/a&gt;    &lt;span class="n"&gt;stiff&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;0.5&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;([[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]])&lt;/span&gt;
&lt;a id="rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-23" name="rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-23" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-23"&gt;&lt;/a&gt;    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;stiff&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;linalg&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;det&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;jaco&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;linalg&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;det&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;jaco&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-24" name="rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-24" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-24"&gt;&lt;/a&gt;
&lt;a id="rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-25" name="rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-25" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-25"&gt;&lt;/a&gt;
&lt;a id="rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-26" name="rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-26" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-26"&gt;&lt;/a&gt;&lt;span class="n"&gt;sq3&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sqrt&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-27" name="rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-27" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-27"&gt;&lt;/a&gt;&lt;span class="n"&gt;coords&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;
&lt;a id="rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-28" name="rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-28" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-28"&gt;&lt;/a&gt;        &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;sq3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;
&lt;a id="rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-29" name="rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-29" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-29"&gt;&lt;/a&gt;        &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;
&lt;a id="rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-30" name="rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-30" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-30"&gt;&lt;/a&gt;        &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;sq3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;
&lt;a id="rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-31" name="rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-31" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-31"&gt;&lt;/a&gt;        &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;
&lt;a id="rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-32" name="rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-32" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-32"&gt;&lt;/a&gt;        &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;sq3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;
&lt;a id="rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-33" name="rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-33" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-33"&gt;&lt;/a&gt;        &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;sq3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;
&lt;a id="rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-34" name="rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-34" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-34"&gt;&lt;/a&gt;        &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;sq3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]])&lt;/span&gt;
&lt;a id="rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-35" name="rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-35" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-35"&gt;&lt;/a&gt;&lt;span class="n"&gt;elems&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;
&lt;a id="rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-36" name="rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-36" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-36"&gt;&lt;/a&gt;        &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;6&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;
&lt;a id="rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-37" name="rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-37" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-37"&gt;&lt;/a&gt;        &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;6&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;
&lt;a id="rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-38" name="rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-38" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-38"&gt;&lt;/a&gt;        &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;6&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;
&lt;a id="rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-39" name="rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-39" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-39"&gt;&lt;/a&gt;        &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;6&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;
&lt;a id="rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-40" name="rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-40" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-40"&gt;&lt;/a&gt;        &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;6&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;
&lt;a id="rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-41" name="rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-41" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-41"&gt;&lt;/a&gt;        &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;6&lt;/span&gt;&lt;span class="p"&gt;]])&lt;/span&gt;
&lt;a id="rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-42" name="rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-42" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-42"&gt;&lt;/a&gt;&lt;span class="n"&gt;source&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ones&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;7&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-43" name="rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-43" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-43"&gt;&lt;/a&gt;&lt;span class="n"&gt;stiff&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;rhs&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;assem&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;elems&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;source&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-44" name="rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-44" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-44"&gt;&lt;/a&gt;&lt;span class="n"&gt;free&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;6&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-45" name="rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-45" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-45"&gt;&lt;/a&gt;&lt;span class="n"&gt;sol&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;linalg&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;solve&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;stiff&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ix_&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;free&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;free&lt;/span&gt;&lt;span class="p"&gt;)],&lt;/span&gt; &lt;span class="n"&gt;rhs&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;free&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-46" name="rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-46" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-46"&gt;&lt;/a&gt;&lt;span class="n"&gt;sol_c&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;shape&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-47" name="rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-47" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-47"&gt;&lt;/a&gt;&lt;span class="n"&gt;sol_c&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;free&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;sol&lt;/span&gt;
&lt;a id="rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-48" name="rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-48" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-48"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;tricontourf&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;[:,&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;[:,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;sol_c&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;cmap&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;"hot"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-49" name="rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-49" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-49"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;colorbar&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a id="rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-50" name="rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-50" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-50"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;axis&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"image"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-51" name="rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-51" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_8f4dfbe80f0d4d79b6d55b68c2e99f48-51"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;show&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/section&gt;
&lt;section id="julia"&gt;
&lt;h3&gt;Julia&lt;/h3&gt;
&lt;div class="code"&gt;&lt;pre class="code julia"&gt;&lt;a id="rest_code_560781e04afc45b1b9b1c1f2fcded3a4-1" name="rest_code_560781e04afc45b1b9b1c1f2fcded3a4-1" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_560781e04afc45b1b9b1c1f2fcded3a4-1"&gt;&lt;/a&gt;&lt;span class="k"&gt;using&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;PyPlot&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_560781e04afc45b1b9b1c1f2fcded3a4-2" name="rest_code_560781e04afc45b1b9b1c1f2fcded3a4-2" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_560781e04afc45b1b9b1c1f2fcded3a4-2"&gt;&lt;/a&gt;
&lt;a id="rest_code_560781e04afc45b1b9b1c1f2fcded3a4-3" name="rest_code_560781e04afc45b1b9b1c1f2fcded3a4-3" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_560781e04afc45b1b9b1c1f2fcded3a4-3"&gt;&lt;/a&gt;
&lt;a id="rest_code_560781e04afc45b1b9b1c1f2fcded3a4-4" name="rest_code_560781e04afc45b1b9b1c1f2fcded3a4-4" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_560781e04afc45b1b9b1c1f2fcded3a4-4"&gt;&lt;/a&gt;&lt;span class="k"&gt;function&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;assem&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;elems&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;source&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_560781e04afc45b1b9b1c1f2fcded3a4-5" name="rest_code_560781e04afc45b1b9b1c1f2fcded3a4-5" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_560781e04afc45b1b9b1c1f2fcded3a4-5"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;ncoords&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;size&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;)[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_560781e04afc45b1b9b1c1f2fcded3a4-6" name="rest_code_560781e04afc45b1b9b1c1f2fcded3a4-6" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_560781e04afc45b1b9b1c1f2fcded3a4-6"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;nelems&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;size&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;elems&lt;/span&gt;&lt;span class="p"&gt;)[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_560781e04afc45b1b9b1c1f2fcded3a4-7" name="rest_code_560781e04afc45b1b9b1c1f2fcded3a4-7" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_560781e04afc45b1b9b1c1f2fcded3a4-7"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;stiff&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ncoords&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ncoords&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_560781e04afc45b1b9b1c1f2fcded3a4-8" name="rest_code_560781e04afc45b1b9b1c1f2fcded3a4-8" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_560781e04afc45b1b9b1c1f2fcded3a4-8"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;rhs&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ncoords&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_560781e04afc45b1b9b1c1f2fcded3a4-9" name="rest_code_560781e04afc45b1b9b1c1f2fcded3a4-9" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_560781e04afc45b1b9b1c1f2fcded3a4-9"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;for&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;el_cont&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="n"&gt;nelems&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_560781e04afc45b1b9b1c1f2fcded3a4-10" name="rest_code_560781e04afc45b1b9b1c1f2fcded3a4-10" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_560781e04afc45b1b9b1c1f2fcded3a4-10"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;elem&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;elems&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;el_cont&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_560781e04afc45b1b9b1c1f2fcded3a4-11" name="rest_code_560781e04afc45b1b9b1c1f2fcded3a4-11" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_560781e04afc45b1b9b1c1f2fcded3a4-11"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;stiff_loc&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;jaco&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;local_stiff&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;elem&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_560781e04afc45b1b9b1c1f2fcded3a4-12" name="rest_code_560781e04afc45b1b9b1c1f2fcded3a4-12" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_560781e04afc45b1b9b1c1f2fcded3a4-12"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;rhs&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;elem&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;jaco&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;mean&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;source&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;elem&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_560781e04afc45b1b9b1c1f2fcded3a4-13" name="rest_code_560781e04afc45b1b9b1c1f2fcded3a4-13" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_560781e04afc45b1b9b1c1f2fcded3a4-13"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="k"&gt;for&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;row&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_560781e04afc45b1b9b1c1f2fcded3a4-14" name="rest_code_560781e04afc45b1b9b1c1f2fcded3a4-14" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_560781e04afc45b1b9b1c1f2fcded3a4-14"&gt;&lt;/a&gt;&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="k"&gt;for&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_560781e04afc45b1b9b1c1f2fcded3a4-15" name="rest_code_560781e04afc45b1b9b1c1f2fcded3a4-15" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_560781e04afc45b1b9b1c1f2fcded3a4-15"&gt;&lt;/a&gt;&lt;span class="w"&gt;                &lt;/span&gt;&lt;span class="n"&gt;row_glob&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;elem&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;row&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_560781e04afc45b1b9b1c1f2fcded3a4-16" name="rest_code_560781e04afc45b1b9b1c1f2fcded3a4-16" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_560781e04afc45b1b9b1c1f2fcded3a4-16"&gt;&lt;/a&gt;&lt;span class="w"&gt;                &lt;/span&gt;&lt;span class="n"&gt;col_glob&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;elem&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_560781e04afc45b1b9b1c1f2fcded3a4-17" name="rest_code_560781e04afc45b1b9b1c1f2fcded3a4-17" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_560781e04afc45b1b9b1c1f2fcded3a4-17"&gt;&lt;/a&gt;&lt;span class="w"&gt;                &lt;/span&gt;&lt;span class="n"&gt;stiff&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;row_glob&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;col_glob&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;stiff_loc&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;row&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_560781e04afc45b1b9b1c1f2fcded3a4-18" name="rest_code_560781e04afc45b1b9b1c1f2fcded3a4-18" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_560781e04afc45b1b9b1c1f2fcded3a4-18"&gt;&lt;/a&gt;&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="k"&gt;end&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_560781e04afc45b1b9b1c1f2fcded3a4-19" name="rest_code_560781e04afc45b1b9b1c1f2fcded3a4-19" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_560781e04afc45b1b9b1c1f2fcded3a4-19"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="k"&gt;end&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_560781e04afc45b1b9b1c1f2fcded3a4-20" name="rest_code_560781e04afc45b1b9b1c1f2fcded3a4-20" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_560781e04afc45b1b9b1c1f2fcded3a4-20"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;end&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_560781e04afc45b1b9b1c1f2fcded3a4-21" name="rest_code_560781e04afc45b1b9b1c1f2fcded3a4-21" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_560781e04afc45b1b9b1c1f2fcded3a4-21"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;return&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;stiff&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;rhs&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_560781e04afc45b1b9b1c1f2fcded3a4-22" name="rest_code_560781e04afc45b1b9b1c1f2fcded3a4-22" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_560781e04afc45b1b9b1c1f2fcded3a4-22"&gt;&lt;/a&gt;&lt;span class="k"&gt;end&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_560781e04afc45b1b9b1c1f2fcded3a4-23" name="rest_code_560781e04afc45b1b9b1c1f2fcded3a4-23" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_560781e04afc45b1b9b1c1f2fcded3a4-23"&gt;&lt;/a&gt;
&lt;a id="rest_code_560781e04afc45b1b9b1c1f2fcded3a4-24" name="rest_code_560781e04afc45b1b9b1c1f2fcded3a4-24" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_560781e04afc45b1b9b1c1f2fcded3a4-24"&gt;&lt;/a&gt;
&lt;a id="rest_code_560781e04afc45b1b9b1c1f2fcded3a4-25" name="rest_code_560781e04afc45b1b9b1c1f2fcded3a4-25" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_560781e04afc45b1b9b1c1f2fcded3a4-25"&gt;&lt;/a&gt;&lt;span class="k"&gt;function&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;local_stiff&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_560781e04afc45b1b9b1c1f2fcded3a4-26" name="rest_code_560781e04afc45b1b9b1c1f2fcded3a4-26" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_560781e04afc45b1b9b1c1f2fcded3a4-26"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;dHdr&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_560781e04afc45b1b9b1c1f2fcded3a4-27" name="rest_code_560781e04afc45b1b9b1c1f2fcded3a4-27" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_560781e04afc45b1b9b1c1f2fcded3a4-27"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;jaco&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;dHdr&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_560781e04afc45b1b9b1c1f2fcded3a4-28" name="rest_code_560781e04afc45b1b9b1c1f2fcded3a4-28" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_560781e04afc45b1b9b1c1f2fcded3a4-28"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;stiff&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;0.5&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_560781e04afc45b1b9b1c1f2fcded3a4-29" name="rest_code_560781e04afc45b1b9b1c1f2fcded3a4-29" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_560781e04afc45b1b9b1c1f2fcded3a4-29"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;return&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;stiff&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;det&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;jaco&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;det&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;jaco&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_560781e04afc45b1b9b1c1f2fcded3a4-30" name="rest_code_560781e04afc45b1b9b1c1f2fcded3a4-30" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_560781e04afc45b1b9b1c1f2fcded3a4-30"&gt;&lt;/a&gt;&lt;span class="k"&gt;end&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_560781e04afc45b1b9b1c1f2fcded3a4-31" name="rest_code_560781e04afc45b1b9b1c1f2fcded3a4-31" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_560781e04afc45b1b9b1c1f2fcded3a4-31"&gt;&lt;/a&gt;
&lt;a id="rest_code_560781e04afc45b1b9b1c1f2fcded3a4-32" name="rest_code_560781e04afc45b1b9b1c1f2fcded3a4-32" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_560781e04afc45b1b9b1c1f2fcded3a4-32"&gt;&lt;/a&gt;
&lt;a id="rest_code_560781e04afc45b1b9b1c1f2fcded3a4-33" name="rest_code_560781e04afc45b1b9b1c1f2fcded3a4-33" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_560781e04afc45b1b9b1c1f2fcded3a4-33"&gt;&lt;/a&gt;&lt;span class="n"&gt;sq3&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;sqrt&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_560781e04afc45b1b9b1c1f2fcded3a4-34" name="rest_code_560781e04afc45b1b9b1c1f2fcded3a4-34" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_560781e04afc45b1b9b1c1f2fcded3a4-34"&gt;&lt;/a&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;sq3&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_560781e04afc45b1b9b1c1f2fcded3a4-35" name="rest_code_560781e04afc45b1b9b1c1f2fcded3a4-35" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_560781e04afc45b1b9b1c1f2fcded3a4-35"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_560781e04afc45b1b9b1c1f2fcded3a4-36" name="rest_code_560781e04afc45b1b9b1c1f2fcded3a4-36" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_560781e04afc45b1b9b1c1f2fcded3a4-36"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;sq3&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_560781e04afc45b1b9b1c1f2fcded3a4-37" name="rest_code_560781e04afc45b1b9b1c1f2fcded3a4-37" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_560781e04afc45b1b9b1c1f2fcded3a4-37"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_560781e04afc45b1b9b1c1f2fcded3a4-38" name="rest_code_560781e04afc45b1b9b1c1f2fcded3a4-38" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_560781e04afc45b1b9b1c1f2fcded3a4-38"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;sq3&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_560781e04afc45b1b9b1c1f2fcded3a4-39" name="rest_code_560781e04afc45b1b9b1c1f2fcded3a4-39" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_560781e04afc45b1b9b1c1f2fcded3a4-39"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;sq3&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_560781e04afc45b1b9b1c1f2fcded3a4-40" name="rest_code_560781e04afc45b1b9b1c1f2fcded3a4-40" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_560781e04afc45b1b9b1c1f2fcded3a4-40"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;sq3&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_560781e04afc45b1b9b1c1f2fcded3a4-41" name="rest_code_560781e04afc45b1b9b1c1f2fcded3a4-41" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_560781e04afc45b1b9b1c1f2fcded3a4-41"&gt;&lt;/a&gt;&lt;span class="n"&gt;elems&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;7&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_560781e04afc45b1b9b1c1f2fcded3a4-42" name="rest_code_560781e04afc45b1b9b1c1f2fcded3a4-42" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_560781e04afc45b1b9b1c1f2fcded3a4-42"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;7&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_560781e04afc45b1b9b1c1f2fcded3a4-43" name="rest_code_560781e04afc45b1b9b1c1f2fcded3a4-43" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_560781e04afc45b1b9b1c1f2fcded3a4-43"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;7&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_560781e04afc45b1b9b1c1f2fcded3a4-44" name="rest_code_560781e04afc45b1b9b1c1f2fcded3a4-44" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_560781e04afc45b1b9b1c1f2fcded3a4-44"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;6&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;7&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_560781e04afc45b1b9b1c1f2fcded3a4-45" name="rest_code_560781e04afc45b1b9b1c1f2fcded3a4-45" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_560781e04afc45b1b9b1c1f2fcded3a4-45"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="mi"&gt;6&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;7&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_560781e04afc45b1b9b1c1f2fcded3a4-46" name="rest_code_560781e04afc45b1b9b1c1f2fcded3a4-46" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_560781e04afc45b1b9b1c1f2fcded3a4-46"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;7&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_560781e04afc45b1b9b1c1f2fcded3a4-47" name="rest_code_560781e04afc45b1b9b1c1f2fcded3a4-47" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_560781e04afc45b1b9b1c1f2fcded3a4-47"&gt;&lt;/a&gt;&lt;span class="n"&gt;source&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;ones&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;7&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_560781e04afc45b1b9b1c1f2fcded3a4-48" name="rest_code_560781e04afc45b1b9b1c1f2fcded3a4-48" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_560781e04afc45b1b9b1c1f2fcded3a4-48"&gt;&lt;/a&gt;&lt;span class="n"&gt;stiff&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;rhs&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;assem&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;elems&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;source&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_560781e04afc45b1b9b1c1f2fcded3a4-49" name="rest_code_560781e04afc45b1b9b1c1f2fcded3a4-49" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_560781e04afc45b1b9b1c1f2fcded3a4-49"&gt;&lt;/a&gt;&lt;span class="n"&gt;free&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;6&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_560781e04afc45b1b9b1c1f2fcded3a4-50" name="rest_code_560781e04afc45b1b9b1c1f2fcded3a4-50" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_560781e04afc45b1b9b1c1f2fcded3a4-50"&gt;&lt;/a&gt;&lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;stiff&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;free&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;free&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;\&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;rhs&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;free&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_560781e04afc45b1b9b1c1f2fcded3a4-51" name="rest_code_560781e04afc45b1b9b1c1f2fcded3a4-51" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_560781e04afc45b1b9b1c1f2fcded3a4-51"&gt;&lt;/a&gt;&lt;span class="n"&gt;sol_c&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;size&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;)[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_560781e04afc45b1b9b1c1f2fcded3a4-52" name="rest_code_560781e04afc45b1b9b1c1f2fcded3a4-52" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_560781e04afc45b1b9b1c1f2fcded3a4-52"&gt;&lt;/a&gt;&lt;span class="n"&gt;sol_c&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;free&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_560781e04afc45b1b9b1c1f2fcded3a4-53" name="rest_code_560781e04afc45b1b9b1c1f2fcded3a4-53" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_560781e04afc45b1b9b1c1f2fcded3a4-53"&gt;&lt;/a&gt;&lt;span class="n"&gt;tricontourf&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;sol_c&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;cmap&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;"hot"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_560781e04afc45b1b9b1c1f2fcded3a4-54" name="rest_code_560781e04afc45b1b9b1c1f2fcded3a4-54" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_560781e04afc45b1b9b1c1f2fcded3a4-54"&gt;&lt;/a&gt;&lt;span class="n"&gt;colorbar&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_560781e04afc45b1b9b1c1f2fcded3a4-55" name="rest_code_560781e04afc45b1b9b1c1f2fcded3a4-55" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_560781e04afc45b1b9b1c1f2fcded3a4-55"&gt;&lt;/a&gt;&lt;span class="n"&gt;axis&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;"image"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_560781e04afc45b1b9b1c1f2fcded3a4-56" name="rest_code_560781e04afc45b1b9b1c1f2fcded3a4-56" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_560781e04afc45b1b9b1c1f2fcded3a4-56"&gt;&lt;/a&gt;&lt;span class="n"&gt;show&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Both have the same result, as follows&lt;/p&gt;
&lt;img alt="Finite element method approximation." class="align-center" src="https://nicoguaro.github.io/images/FEM2D.svg" style="width: 500px;"&gt;
&lt;/section&gt;
&lt;section id="comparison-python-julia"&gt;
&lt;h3&gt;Comparison Python/Julia&lt;/h3&gt;
&lt;p&gt;Regarding number of lines we have: 51 in Python and 56 in Julia. The comparison
in execution time is done with &lt;code class="docutils literal"&gt;%timeit&lt;/code&gt; magic command in IPython and
&lt;code class="docutils literal"&gt;@benchmark&lt;/code&gt; in Julia. For the test we are just comparing the time it takes
to generate the matrices.&lt;/p&gt;
&lt;p&gt;For Python:&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code IPython"&gt;&lt;a id="rest_code_4b2801255ec5489f8c703780afe665ba-1" name="rest_code_4b2801255ec5489f8c703780afe665ba-1" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_4b2801255ec5489f8c703780afe665ba-1"&gt;&lt;/a&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="k"&gt;timeit&lt;/span&gt; assem(coords, elems, source)
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;with result&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code text"&gt;&lt;a id="rest_code_b58a521c6cc84738af1ca55ae6e84700-1" name="rest_code_b58a521c6cc84738af1ca55ae6e84700-1" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_b58a521c6cc84738af1ca55ae6e84700-1"&gt;&lt;/a&gt;1000 loops, best of 3: 671 µs per loop
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;For Julia:&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code julia"&gt;&lt;a id="rest_code_ca13b27e7cf34316a71cc686d2758691-1" name="rest_code_ca13b27e7cf34316a71cc686d2758691-1" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_ca13b27e7cf34316a71cc686d2758691-1"&gt;&lt;/a&gt;&lt;span class="nd"&gt;@benchmark&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;assem&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;elems&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;source&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;with result&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code julia"&gt;&lt;a id="rest_code_b0ea716e129b4cc38d2f7f29d3c6ace9-1" name="rest_code_b0ea716e129b4cc38d2f7f29d3c6ace9-1" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_b0ea716e129b4cc38d2f7f29d3c6ace9-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;BenchmarkTools&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Trial&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_b0ea716e129b4cc38d2f7f29d3c6ace9-2" name="rest_code_b0ea716e129b4cc38d2f7f29d3c6ace9-2" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_b0ea716e129b4cc38d2f7f29d3c6ace9-2"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;memory&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;estimate&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="mf"&gt;13.30&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;KiB&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_b0ea716e129b4cc38d2f7f29d3c6ace9-3" name="rest_code_b0ea716e129b4cc38d2f7f29d3c6ace9-3" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_b0ea716e129b4cc38d2f7f29d3c6ace9-3"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;allocs&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;estimate&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="mi"&gt;179&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_b0ea716e129b4cc38d2f7f29d3c6ace9-4" name="rest_code_b0ea716e129b4cc38d2f7f29d3c6ace9-4" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_b0ea716e129b4cc38d2f7f29d3c6ace9-4"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="o"&gt;--------------&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_b0ea716e129b4cc38d2f7f29d3c6ace9-5" name="rest_code_b0ea716e129b4cc38d2f7f29d3c6ace9-5" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_b0ea716e129b4cc38d2f7f29d3c6ace9-5"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;minimum&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;     &lt;/span&gt;&lt;span class="mf"&gt;7.777&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;μs&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;0.00&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;GC&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_b0ea716e129b4cc38d2f7f29d3c6ace9-6" name="rest_code_b0ea716e129b4cc38d2f7f29d3c6ace9-6" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_b0ea716e129b4cc38d2f7f29d3c6ace9-6"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;median&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="mf"&gt;8.934&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;μs&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;0.00&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;GC&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_b0ea716e129b4cc38d2f7f29d3c6ace9-7" name="rest_code_b0ea716e129b4cc38d2f7f29d3c6ace9-7" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_b0ea716e129b4cc38d2f7f29d3c6ace9-7"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;mean&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="mf"&gt;10.810&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;μs&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;14.54&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;GC&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_b0ea716e129b4cc38d2f7f29d3c6ace9-8" name="rest_code_b0ea716e129b4cc38d2f7f29d3c6ace9-8" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_b0ea716e129b4cc38d2f7f29d3c6ace9-8"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;maximum&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;     &lt;/span&gt;&lt;span class="mf"&gt;797.432&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;μs&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;95.85&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;GC&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_b0ea716e129b4cc38d2f7f29d3c6ace9-9" name="rest_code_b0ea716e129b4cc38d2f7f29d3c6ace9-9" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_b0ea716e129b4cc38d2f7f29d3c6ace9-9"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="o"&gt;--------------&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_b0ea716e129b4cc38d2f7f29d3c6ace9-10" name="rest_code_b0ea716e129b4cc38d2f7f29d3c6ace9-10" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_b0ea716e129b4cc38d2f7f29d3c6ace9-10"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;samples&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;          &lt;/span&gt;&lt;span class="mi"&gt;10000&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_b0ea716e129b4cc38d2f7f29d3c6ace9-11" name="rest_code_b0ea716e129b4cc38d2f7f29d3c6ace9-11" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_b0ea716e129b4cc38d2f7f29d3c6ace9-11"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;evals&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;sample&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;     &lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;In this case, we can say that the Python code is about 70 times slower than
Julia code.&lt;/p&gt;
&lt;/section&gt;
&lt;/section&gt;</description><category>finite element method</category><category>julia</category><category>numerical methods</category><category>python</category><category>scientific computing</category><guid>https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/</guid><pubDate>Thu, 26 Oct 2017 02:41:53 GMT</pubDate></item><item><title>Numerical methods challenge: Day 24</title><link>https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/</link><dc:creator>Nicolás Guarín-Zapata</dc:creator><description>&lt;p&gt;During October (2017) I will write a program per day for some well-known
numerical methods in both Python and Julia. It is intended to be an exercise
then don't expect the code to be good enough for real use. Also,
I should mention that I have almost no experience with Julia, so it
probably won't be idiomatic Julia but more Python-like Julia.&lt;/p&gt;
&lt;section id="finite-element-method"&gt;
&lt;h2&gt;Finite element method&lt;/h2&gt;
&lt;p&gt;Today we have the &lt;a class="reference external" href="https://en.wikipedia.org/wiki/Finite_element_method"&gt;Finite element method&lt;/a&gt;
to solve the equation:&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
\frac{d^2 u}{dx^2} = f(x)
\end{equation*}
&lt;/div&gt;
&lt;p&gt;with&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
u(0) = u(1)  = 0
\end{equation*}
&lt;/div&gt;
&lt;p&gt;As in the &lt;a class="reference external" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/posts/numerical-23"&gt;Ritz method&lt;/a&gt; we form
a functional that is &lt;em&gt;equivalent&lt;/em&gt; to the
differential equation, propose an approximation as a linear combination of
a set of basis functions and find the &lt;em&gt;best&lt;/em&gt; set of coefficients for that
combination. That &lt;em&gt;best&lt;/em&gt; solution is found minimizing the functional.&lt;/p&gt;
&lt;p&gt;The functional for this differential equation is&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
\Pi[u] = -\int_{0}^{1} \left(\frac{d u}{d x}\right)^2 dx
         -\int_{0}^{1}  u f(x) dx
\end{equation*}
&lt;/div&gt;
&lt;p&gt;The main difference is that we use a piecewise interpolation for the basis
functions,&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
\hat{u}(x) = \sum_{n=0}^{N} u_n N_n(x)\, ,
\end{equation*}
&lt;/div&gt;
&lt;p&gt;this leads to the system of equations&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
[K]\{\mathbf{c}\} = \{\mathbf{b}\}
\end{equation*}
&lt;/div&gt;
&lt;p&gt;where the local stiffness matrices read&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
K_\text{local} =  \frac{1}{|J|}\begin{bmatrix} 2 &amp;amp; -2\\ -2 &amp;amp;2\end{bmatrix}
\end{equation*}
&lt;/div&gt;
&lt;p&gt;and&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
b_\text{local} = -|J|\begin{bmatrix} f(x_m)\\ f(x_{n})\end{bmatrix}\, ,
\end{equation*}
&lt;/div&gt;
&lt;p&gt;where &lt;span class="math"&gt;\(|J|\)&lt;/span&gt; is the Jacobian determinant of the transformation. I am
skipping a great deal about assembling, but it would be just too extensive
to describe the complete process.&lt;/p&gt;
&lt;p&gt;We will test the implementation with the function &lt;span class="math"&gt;\(f(x) = x^3\)&lt;/span&gt;, that
leads to the solution&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
u(x) = \frac{x (x^4 - 1)}{20}
\end{equation*}
&lt;/div&gt;
&lt;p&gt;Following are the codes.&lt;/p&gt;
&lt;section id="python"&gt;
&lt;h3&gt;Python&lt;/h3&gt;
&lt;div class="code"&gt;&lt;pre class="code python"&gt;&lt;a id="rest_code_4d595eedf8704d82beb3f29365f103c0-1" name="rest_code_4d595eedf8704d82beb3f29365f103c0-1" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_4d595eedf8704d82beb3f29365f103c0-1"&gt;&lt;/a&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;__future__&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;division&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;print_function&lt;/span&gt;
&lt;a id="rest_code_4d595eedf8704d82beb3f29365f103c0-2" name="rest_code_4d595eedf8704d82beb3f29365f103c0-2" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_4d595eedf8704d82beb3f29365f103c0-2"&gt;&lt;/a&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;numpy&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;np&lt;/span&gt;
&lt;a id="rest_code_4d595eedf8704d82beb3f29365f103c0-3" name="rest_code_4d595eedf8704d82beb3f29365f103c0-3" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_4d595eedf8704d82beb3f29365f103c0-3"&gt;&lt;/a&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;matplotlib.pyplot&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;plt&lt;/span&gt;
&lt;a id="rest_code_4d595eedf8704d82beb3f29365f103c0-4" name="rest_code_4d595eedf8704d82beb3f29365f103c0-4" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_4d595eedf8704d82beb3f29365f103c0-4"&gt;&lt;/a&gt;
&lt;a id="rest_code_4d595eedf8704d82beb3f29365f103c0-5" name="rest_code_4d595eedf8704d82beb3f29365f103c0-5" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_4d595eedf8704d82beb3f29365f103c0-5"&gt;&lt;/a&gt;
&lt;a id="rest_code_4d595eedf8704d82beb3f29365f103c0-6" name="rest_code_4d595eedf8704d82beb3f29365f103c0-6" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_4d595eedf8704d82beb3f29365f103c0-6"&gt;&lt;/a&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;FEM1D&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;source&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_4d595eedf8704d82beb3f29365f103c0-7" name="rest_code_4d595eedf8704d82beb3f29365f103c0-7" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_4d595eedf8704d82beb3f29365f103c0-7"&gt;&lt;/a&gt;    &lt;span class="n"&gt;N&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_4d595eedf8704d82beb3f29365f103c0-8" name="rest_code_4d595eedf8704d82beb3f29365f103c0-8" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_4d595eedf8704d82beb3f29365f103c0-8"&gt;&lt;/a&gt;    &lt;span class="n"&gt;stiff_loc&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;([[&lt;/span&gt;&lt;span class="mf"&gt;2.0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;2.0&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;2.0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;2.0&lt;/span&gt;&lt;span class="p"&gt;]])&lt;/span&gt;
&lt;a id="rest_code_4d595eedf8704d82beb3f29365f103c0-9" name="rest_code_4d595eedf8704d82beb3f29365f103c0-9" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_4d595eedf8704d82beb3f29365f103c0-9"&gt;&lt;/a&gt;    &lt;span class="n"&gt;eles&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="n"&gt;cont&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;cont&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;cont&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;N&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)]&lt;/span&gt;
&lt;a id="rest_code_4d595eedf8704d82beb3f29365f103c0-10" name="rest_code_4d595eedf8704d82beb3f29365f103c0-10" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_4d595eedf8704d82beb3f29365f103c0-10"&gt;&lt;/a&gt;    &lt;span class="n"&gt;stiff&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_4d595eedf8704d82beb3f29365f103c0-11" name="rest_code_4d595eedf8704d82beb3f29365f103c0-11" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_4d595eedf8704d82beb3f29365f103c0-11"&gt;&lt;/a&gt;    &lt;span class="n"&gt;rhs&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_4d595eedf8704d82beb3f29365f103c0-12" name="rest_code_4d595eedf8704d82beb3f29365f103c0-12" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_4d595eedf8704d82beb3f29365f103c0-12"&gt;&lt;/a&gt;    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;ele&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;eles&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a id="rest_code_4d595eedf8704d82beb3f29365f103c0-13" name="rest_code_4d595eedf8704d82beb3f29365f103c0-13" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_4d595eedf8704d82beb3f29365f103c0-13"&gt;&lt;/a&gt;        &lt;span class="n"&gt;jaco&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ele&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]]&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ele&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]]&lt;/span&gt;
&lt;a id="rest_code_4d595eedf8704d82beb3f29365f103c0-14" name="rest_code_4d595eedf8704d82beb3f29365f103c0-14" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_4d595eedf8704d82beb3f29365f103c0-14"&gt;&lt;/a&gt;        &lt;span class="n"&gt;rhs&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ele&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;rhs&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ele&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;jaco&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;source&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ele&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_4d595eedf8704d82beb3f29365f103c0-15" name="rest_code_4d595eedf8704d82beb3f29365f103c0-15" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_4d595eedf8704d82beb3f29365f103c0-15"&gt;&lt;/a&gt;        &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;cont1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;row&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;enumerate&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ele&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_4d595eedf8704d82beb3f29365f103c0-16" name="rest_code_4d595eedf8704d82beb3f29365f103c0-16" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_4d595eedf8704d82beb3f29365f103c0-16"&gt;&lt;/a&gt;            &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;cont2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;col&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;enumerate&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ele&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_4d595eedf8704d82beb3f29365f103c0-17" name="rest_code_4d595eedf8704d82beb3f29365f103c0-17" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_4d595eedf8704d82beb3f29365f103c0-17"&gt;&lt;/a&gt;                &lt;span class="n"&gt;stiff&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;row&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;stiff&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;row&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt;  &lt;span class="n"&gt;stiff_loc&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;cont1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;cont2&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;jaco&lt;/span&gt;
&lt;a id="rest_code_4d595eedf8704d82beb3f29365f103c0-18" name="rest_code_4d595eedf8704d82beb3f29365f103c0-18" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_4d595eedf8704d82beb3f29365f103c0-18"&gt;&lt;/a&gt;    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;stiff&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;rhs&lt;/span&gt;
&lt;a id="rest_code_4d595eedf8704d82beb3f29365f103c0-19" name="rest_code_4d595eedf8704d82beb3f29365f103c0-19" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_4d595eedf8704d82beb3f29365f103c0-19"&gt;&lt;/a&gt;
&lt;a id="rest_code_4d595eedf8704d82beb3f29365f103c0-20" name="rest_code_4d595eedf8704d82beb3f29365f103c0-20" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_4d595eedf8704d82beb3f29365f103c0-20"&gt;&lt;/a&gt;
&lt;a id="rest_code_4d595eedf8704d82beb3f29365f103c0-21" name="rest_code_4d595eedf8704d82beb3f29365f103c0-21" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_4d595eedf8704d82beb3f29365f103c0-21"&gt;&lt;/a&gt;&lt;span class="n"&gt;N&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;100&lt;/span&gt;
&lt;a id="rest_code_4d595eedf8704d82beb3f29365f103c0-22" name="rest_code_4d595eedf8704d82beb3f29365f103c0-22" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_4d595eedf8704d82beb3f29365f103c0-22"&gt;&lt;/a&gt;&lt;span class="n"&gt;fun&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;lambda&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;
&lt;a id="rest_code_4d595eedf8704d82beb3f29365f103c0-23" name="rest_code_4d595eedf8704d82beb3f29365f103c0-23" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_4d595eedf8704d82beb3f29365f103c0-23"&gt;&lt;/a&gt;&lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;linspace&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_4d595eedf8704d82beb3f29365f103c0-24" name="rest_code_4d595eedf8704d82beb3f29365f103c0-24" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_4d595eedf8704d82beb3f29365f103c0-24"&gt;&lt;/a&gt;&lt;span class="n"&gt;stiff&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;rhs&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;FEM1D&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;fun&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_4d595eedf8704d82beb3f29365f103c0-25" name="rest_code_4d595eedf8704d82beb3f29365f103c0-25" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_4d595eedf8704d82beb3f29365f103c0-25"&gt;&lt;/a&gt;&lt;span class="n"&gt;sol&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_4d595eedf8704d82beb3f29365f103c0-26" name="rest_code_4d595eedf8704d82beb3f29365f103c0-26" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_4d595eedf8704d82beb3f29365f103c0-26"&gt;&lt;/a&gt;&lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;linalg&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;solve&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;stiff&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;rhs&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_4d595eedf8704d82beb3f29365f103c0-27" name="rest_code_4d595eedf8704d82beb3f29365f103c0-27" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_4d595eedf8704d82beb3f29365f103c0-27"&gt;&lt;/a&gt;
&lt;a id="rest_code_4d595eedf8704d82beb3f29365f103c0-28" name="rest_code_4d595eedf8704d82beb3f29365f103c0-28" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_4d595eedf8704d82beb3f29365f103c0-28"&gt;&lt;/a&gt;
&lt;a id="rest_code_4d595eedf8704d82beb3f29365f103c0-29" name="rest_code_4d595eedf8704d82beb3f29365f103c0-29" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_4d595eedf8704d82beb3f29365f103c0-29"&gt;&lt;/a&gt;&lt;span class="c1"&gt;#%% Plotting&lt;/span&gt;
&lt;a id="rest_code_4d595eedf8704d82beb3f29365f103c0-30" name="rest_code_4d595eedf8704d82beb3f29365f103c0-30" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_4d595eedf8704d82beb3f29365f103c0-30"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;figure&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;figsize&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_4d595eedf8704d82beb3f29365f103c0-31" name="rest_code_4d595eedf8704d82beb3f29365f103c0-31" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_4d595eedf8704d82beb3f29365f103c0-31"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;plot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_4d595eedf8704d82beb3f29365f103c0-32" name="rest_code_4d595eedf8704d82beb3f29365f103c0-32" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_4d595eedf8704d82beb3f29365f103c0-32"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;plot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="mi"&gt;20&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;linestyle&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;"dashed"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_4d595eedf8704d82beb3f29365f103c0-33" name="rest_code_4d595eedf8704d82beb3f29365f103c0-33" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_4d595eedf8704d82beb3f29365f103c0-33"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="sa"&gt;r&lt;/span&gt;&lt;span class="s2"&gt;"$x$"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_4d595eedf8704d82beb3f29365f103c0-34" name="rest_code_4d595eedf8704d82beb3f29365f103c0-34" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_4d595eedf8704d82beb3f29365f103c0-34"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ylabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="sa"&gt;r&lt;/span&gt;&lt;span class="s2"&gt;"$y$"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_4d595eedf8704d82beb3f29365f103c0-35" name="rest_code_4d595eedf8704d82beb3f29365f103c0-35" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_4d595eedf8704d82beb3f29365f103c0-35"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;legend&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="s2"&gt;"FEM solution"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;"Exact solution"&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_4d595eedf8704d82beb3f29365f103c0-36" name="rest_code_4d595eedf8704d82beb3f29365f103c0-36" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_4d595eedf8704d82beb3f29365f103c0-36"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;tight_layout&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a id="rest_code_4d595eedf8704d82beb3f29365f103c0-37" name="rest_code_4d595eedf8704d82beb3f29365f103c0-37" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_4d595eedf8704d82beb3f29365f103c0-37"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;show&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/section&gt;
&lt;section id="julia"&gt;
&lt;h3&gt;Julia&lt;/h3&gt;
&lt;div class="code"&gt;&lt;pre class="code julia"&gt;&lt;a id="rest_code_5552a0eeae7343259a0277485d2b58f0-1" name="rest_code_5552a0eeae7343259a0277485d2b58f0-1" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_5552a0eeae7343259a0277485d2b58f0-1"&gt;&lt;/a&gt;&lt;span class="k"&gt;using&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;PyPlot&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_5552a0eeae7343259a0277485d2b58f0-2" name="rest_code_5552a0eeae7343259a0277485d2b58f0-2" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_5552a0eeae7343259a0277485d2b58f0-2"&gt;&lt;/a&gt;
&lt;a id="rest_code_5552a0eeae7343259a0277485d2b58f0-3" name="rest_code_5552a0eeae7343259a0277485d2b58f0-3" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_5552a0eeae7343259a0277485d2b58f0-3"&gt;&lt;/a&gt;
&lt;a id="rest_code_5552a0eeae7343259a0277485d2b58f0-4" name="rest_code_5552a0eeae7343259a0277485d2b58f0-4" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_5552a0eeae7343259a0277485d2b58f0-4"&gt;&lt;/a&gt;&lt;span class="k"&gt;function&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;FEM1D&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;source&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_5552a0eeae7343259a0277485d2b58f0-5" name="rest_code_5552a0eeae7343259a0277485d2b58f0-5" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_5552a0eeae7343259a0277485d2b58f0-5"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;length&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_5552a0eeae7343259a0277485d2b58f0-6" name="rest_code_5552a0eeae7343259a0277485d2b58f0-6" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_5552a0eeae7343259a0277485d2b58f0-6"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;stiff_loc&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mf"&gt;2.0&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;2.0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;2.0&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;2.0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_5552a0eeae7343259a0277485d2b58f0-7" name="rest_code_5552a0eeae7343259a0277485d2b58f0-7" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_5552a0eeae7343259a0277485d2b58f0-7"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;eles&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;[[&lt;/span&gt;&lt;span class="n"&gt;cont&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;cont&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;for&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;cont&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;in&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_5552a0eeae7343259a0277485d2b58f0-8" name="rest_code_5552a0eeae7343259a0277485d2b58f0-8" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_5552a0eeae7343259a0277485d2b58f0-8"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;stiff&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_5552a0eeae7343259a0277485d2b58f0-9" name="rest_code_5552a0eeae7343259a0277485d2b58f0-9" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_5552a0eeae7343259a0277485d2b58f0-9"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;rhs&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_5552a0eeae7343259a0277485d2b58f0-10" name="rest_code_5552a0eeae7343259a0277485d2b58f0-10" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_5552a0eeae7343259a0277485d2b58f0-10"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;for&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ele&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;in&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;eles&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_5552a0eeae7343259a0277485d2b58f0-11" name="rest_code_5552a0eeae7343259a0277485d2b58f0-11" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_5552a0eeae7343259a0277485d2b58f0-11"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;jaco&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ele&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;]]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ele&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]]&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_5552a0eeae7343259a0277485d2b58f0-12" name="rest_code_5552a0eeae7343259a0277485d2b58f0-12" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_5552a0eeae7343259a0277485d2b58f0-12"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;rhs&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ele&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;rhs&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ele&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;jaco&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;source&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ele&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_5552a0eeae7343259a0277485d2b58f0-13" name="rest_code_5552a0eeae7343259a0277485d2b58f0-13" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_5552a0eeae7343259a0277485d2b58f0-13"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;stiff&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ele&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ele&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;stiff&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ele&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ele&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;stiff_loc&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;jaco&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_5552a0eeae7343259a0277485d2b58f0-14" name="rest_code_5552a0eeae7343259a0277485d2b58f0-14" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_5552a0eeae7343259a0277485d2b58f0-14"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;end&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_5552a0eeae7343259a0277485d2b58f0-15" name="rest_code_5552a0eeae7343259a0277485d2b58f0-15" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_5552a0eeae7343259a0277485d2b58f0-15"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;return&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;stiff&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;rhs&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_5552a0eeae7343259a0277485d2b58f0-16" name="rest_code_5552a0eeae7343259a0277485d2b58f0-16" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_5552a0eeae7343259a0277485d2b58f0-16"&gt;&lt;/a&gt;&lt;span class="k"&gt;end&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_5552a0eeae7343259a0277485d2b58f0-17" name="rest_code_5552a0eeae7343259a0277485d2b58f0-17" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_5552a0eeae7343259a0277485d2b58f0-17"&gt;&lt;/a&gt;
&lt;a id="rest_code_5552a0eeae7343259a0277485d2b58f0-18" name="rest_code_5552a0eeae7343259a0277485d2b58f0-18" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_5552a0eeae7343259a0277485d2b58f0-18"&gt;&lt;/a&gt;
&lt;a id="rest_code_5552a0eeae7343259a0277485d2b58f0-19" name="rest_code_5552a0eeae7343259a0277485d2b58f0-19" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_5552a0eeae7343259a0277485d2b58f0-19"&gt;&lt;/a&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;100&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_5552a0eeae7343259a0277485d2b58f0-20" name="rest_code_5552a0eeae7343259a0277485d2b58f0-20" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_5552a0eeae7343259a0277485d2b58f0-20"&gt;&lt;/a&gt;&lt;span class="n"&gt;fun&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;.^&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_5552a0eeae7343259a0277485d2b58f0-21" name="rest_code_5552a0eeae7343259a0277485d2b58f0-21" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_5552a0eeae7343259a0277485d2b58f0-21"&gt;&lt;/a&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;linspace&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_5552a0eeae7343259a0277485d2b58f0-22" name="rest_code_5552a0eeae7343259a0277485d2b58f0-22" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_5552a0eeae7343259a0277485d2b58f0-22"&gt;&lt;/a&gt;&lt;span class="n"&gt;stiff&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;rhs&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;FEM1D&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;fun&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_5552a0eeae7343259a0277485d2b58f0-23" name="rest_code_5552a0eeae7343259a0277485d2b58f0-23" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_5552a0eeae7343259a0277485d2b58f0-23"&gt;&lt;/a&gt;&lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_5552a0eeae7343259a0277485d2b58f0-24" name="rest_code_5552a0eeae7343259a0277485d2b58f0-24" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_5552a0eeae7343259a0277485d2b58f0-24"&gt;&lt;/a&gt;&lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="k"&gt;end&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;stiff&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="k"&gt;end&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="k"&gt;end&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;\&lt;/span&gt;&lt;span class="n"&gt;rhs&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="k"&gt;end&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_5552a0eeae7343259a0277485d2b58f0-25" name="rest_code_5552a0eeae7343259a0277485d2b58f0-25" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_5552a0eeae7343259a0277485d2b58f0-25"&gt;&lt;/a&gt;
&lt;a id="rest_code_5552a0eeae7343259a0277485d2b58f0-26" name="rest_code_5552a0eeae7343259a0277485d2b58f0-26" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_5552a0eeae7343259a0277485d2b58f0-26"&gt;&lt;/a&gt;
&lt;a id="rest_code_5552a0eeae7343259a0277485d2b58f0-27" name="rest_code_5552a0eeae7343259a0277485d2b58f0-27" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_5552a0eeae7343259a0277485d2b58f0-27"&gt;&lt;/a&gt;&lt;span class="c"&gt;#%% Plotting&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_5552a0eeae7343259a0277485d2b58f0-28" name="rest_code_5552a0eeae7343259a0277485d2b58f0-28" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_5552a0eeae7343259a0277485d2b58f0-28"&gt;&lt;/a&gt;&lt;span class="n"&gt;figure&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;figsize&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_5552a0eeae7343259a0277485d2b58f0-29" name="rest_code_5552a0eeae7343259a0277485d2b58f0-29" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_5552a0eeae7343259a0277485d2b58f0-29"&gt;&lt;/a&gt;&lt;span class="n"&gt;plot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_5552a0eeae7343259a0277485d2b58f0-30" name="rest_code_5552a0eeae7343259a0277485d2b58f0-30" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_5552a0eeae7343259a0277485d2b58f0-30"&gt;&lt;/a&gt;&lt;span class="n"&gt;plot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;.*&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;.^&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="mi"&gt;20&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;linestyle&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;"dashed"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_5552a0eeae7343259a0277485d2b58f0-31" name="rest_code_5552a0eeae7343259a0277485d2b58f0-31" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_5552a0eeae7343259a0277485d2b58f0-31"&gt;&lt;/a&gt;&lt;span class="n"&gt;xlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="sa"&gt;L&lt;/span&gt;&lt;span class="s"&gt;"&lt;/span&gt;&lt;span class="si"&gt;$x&lt;/span&gt;&lt;span class="s"&gt;$"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_5552a0eeae7343259a0277485d2b58f0-32" name="rest_code_5552a0eeae7343259a0277485d2b58f0-32" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_5552a0eeae7343259a0277485d2b58f0-32"&gt;&lt;/a&gt;&lt;span class="n"&gt;ylabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="sa"&gt;L&lt;/span&gt;&lt;span class="s"&gt;"&lt;/span&gt;&lt;span class="si"&gt;$y&lt;/span&gt;&lt;span class="s"&gt;$"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_5552a0eeae7343259a0277485d2b58f0-33" name="rest_code_5552a0eeae7343259a0277485d2b58f0-33" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_5552a0eeae7343259a0277485d2b58f0-33"&gt;&lt;/a&gt;&lt;span class="n"&gt;legend&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="s"&gt;"FEM solution"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s"&gt;"Exact solution"&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_5552a0eeae7343259a0277485d2b58f0-34" name="rest_code_5552a0eeae7343259a0277485d2b58f0-34" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_5552a0eeae7343259a0277485d2b58f0-34"&gt;&lt;/a&gt;&lt;span class="n"&gt;tight_layout&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_5552a0eeae7343259a0277485d2b58f0-35" name="rest_code_5552a0eeae7343259a0277485d2b58f0-35" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_5552a0eeae7343259a0277485d2b58f0-35"&gt;&lt;/a&gt;&lt;span class="n"&gt;show&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Both have the same result, as follows&lt;/p&gt;
&lt;img alt="Finite element method approximation." class="align-center" src="https://nicoguaro.github.io/images/FEM1D.svg" style="width: 400px;"&gt;
&lt;/section&gt;
&lt;section id="comparison-python-julia"&gt;
&lt;h3&gt;Comparison Python/Julia&lt;/h3&gt;
&lt;p&gt;Regarding number of lines we have: 37 in Python and 35 in Julia. The comparison
in execution time is done with &lt;code class="docutils literal"&gt;%timeit&lt;/code&gt; magic command in IPython and
&lt;code class="docutils literal"&gt;@benchmark&lt;/code&gt; in Julia. For the test we are just comparing the time it takes
to generate the matrices.&lt;/p&gt;
&lt;p&gt;For Python:&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code IPython"&gt;&lt;a id="rest_code_74b5e8a4f2f14f1cb154d5297b2d7ce7-1" name="rest_code_74b5e8a4f2f14f1cb154d5297b2d7ce7-1" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_74b5e8a4f2f14f1cb154d5297b2d7ce7-1"&gt;&lt;/a&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="k"&gt;timeit&lt;/span&gt; FEM1D(x, fun)
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;with result&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code text"&gt;&lt;a id="rest_code_624fb90b57684f9b9c104a275360abd9-1" name="rest_code_624fb90b57684f9b9c104a275360abd9-1" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_624fb90b57684f9b9c104a275360abd9-1"&gt;&lt;/a&gt;100 loops, best of 3: 2.15 ms per loop
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;For Julia:&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code julia"&gt;&lt;a id="rest_code_8b59473bd7dd4cda909c8392172c973f-1" name="rest_code_8b59473bd7dd4cda909c8392172c973f-1" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_8b59473bd7dd4cda909c8392172c973f-1"&gt;&lt;/a&gt;&lt;span class="nd"&gt;@benchmark&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;FEM1D&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;fun&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;with result&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code julia"&gt;&lt;a id="rest_code_d8e00aecf901466a965621a491e6a1ae-1" name="rest_code_d8e00aecf901466a965621a491e6a1ae-1" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_d8e00aecf901466a965621a491e6a1ae-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;BenchmarkTools&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Trial&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_d8e00aecf901466a965621a491e6a1ae-2" name="rest_code_d8e00aecf901466a965621a491e6a1ae-2" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_d8e00aecf901466a965621a491e6a1ae-2"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;memory&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;estimate&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="mf"&gt;183.73&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;KiB&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_d8e00aecf901466a965621a491e6a1ae-3" name="rest_code_d8e00aecf901466a965621a491e6a1ae-3" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_d8e00aecf901466a965621a491e6a1ae-3"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;allocs&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;estimate&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="mi"&gt;1392&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_d8e00aecf901466a965621a491e6a1ae-4" name="rest_code_d8e00aecf901466a965621a491e6a1ae-4" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_d8e00aecf901466a965621a491e6a1ae-4"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="o"&gt;--------------&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_d8e00aecf901466a965621a491e6a1ae-5" name="rest_code_d8e00aecf901466a965621a491e6a1ae-5" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_d8e00aecf901466a965621a491e6a1ae-5"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;minimum&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;     &lt;/span&gt;&lt;span class="mf"&gt;60.045&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;μs&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;0.00&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;GC&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_d8e00aecf901466a965621a491e6a1ae-6" name="rest_code_d8e00aecf901466a965621a491e6a1ae-6" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_d8e00aecf901466a965621a491e6a1ae-6"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;median&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="mf"&gt;70.445&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;μs&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;0.00&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;GC&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_d8e00aecf901466a965621a491e6a1ae-7" name="rest_code_d8e00aecf901466a965621a491e6a1ae-7" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_d8e00aecf901466a965621a491e6a1ae-7"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;mean&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="mf"&gt;98.276&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;μs&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;25.64&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;GC&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_d8e00aecf901466a965621a491e6a1ae-8" name="rest_code_d8e00aecf901466a965621a491e6a1ae-8" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_d8e00aecf901466a965621a491e6a1ae-8"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;maximum&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;     &lt;/span&gt;&lt;span class="mf"&gt;4.269&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ms&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;96.70&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;GC&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_d8e00aecf901466a965621a491e6a1ae-9" name="rest_code_d8e00aecf901466a965621a491e6a1ae-9" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_d8e00aecf901466a965621a491e6a1ae-9"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="o"&gt;--------------&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_d8e00aecf901466a965621a491e6a1ae-10" name="rest_code_d8e00aecf901466a965621a491e6a1ae-10" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_d8e00aecf901466a965621a491e6a1ae-10"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;samples&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;          &lt;/span&gt;&lt;span class="mi"&gt;10000&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_d8e00aecf901466a965621a491e6a1ae-11" name="rest_code_d8e00aecf901466a965621a491e6a1ae-11" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_d8e00aecf901466a965621a491e6a1ae-11"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;evals&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;sample&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;     &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;In this case, we can say that the Python code is roughly 30 times slower than
Julia code.&lt;/p&gt;
&lt;/section&gt;
&lt;/section&gt;</description><category>finite element method</category><category>julia</category><category>numerical methods</category><category>python</category><category>scientific computing</category><guid>https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/</guid><pubDate>Tue, 24 Oct 2017 20:17:58 GMT</pubDate></item><item><title>Solution of the Schrödinger equation using Ritz method</title><link>https://nicoguaro.github.io/posts/hermite_ritz_qm/</link><dc:creator>Nicolás Guarín-Zapata</dc:creator><description>&lt;p&gt;In this post, we describe the solution of the Schrödinger equation
using the Ritz method and
&lt;a class="reference external" href="https://en.wikipedia.org/wiki/Hermite_polynomials#Hermite_functions"&gt;Hermite functions&lt;/a&gt;
basis. This basis seems to be a good choice for the 1D Schrödinger equation
since its an orthogonal basis over &lt;span class="math"&gt;\((-\infty, \infty)\)&lt;/span&gt;.&lt;/p&gt;
&lt;section id="transforming-the-equation-to-an-algebraic-one"&gt;
&lt;h2&gt;Transforming the equation to an algebraic one&lt;/h2&gt;
&lt;p&gt;We want so solve the time-independent
&lt;a class="reference external" href="https://en.wikipedia.org/wiki/Schr%C3%B6dinger_equation"&gt;Schrödinger equation&lt;/a&gt;&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
\left[-\frac{1}{2}\nabla^2 + V(x)\right] \psi = E\psi\, ,
\end{equation*}
&lt;/div&gt;
&lt;p&gt;where we are using
&lt;a class="reference external" href="https://en.wikipedia.org/wiki/Natural_units"&gt;natural units&lt;/a&gt;
since they are a good choice for numeric calculations.&lt;/p&gt;
&lt;p&gt;Solving this equation is equivalent to solve the following
variational equation&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
\delta \Pi[\psi] = 0\, ,
\end{equation*}
&lt;/div&gt;
&lt;p&gt;with&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
\Pi[\psi] = \frac{1}{2} \langle \nabla \psi, \nabla\psi\rangle +
              \langle \psi, V(x) \psi\rangle -
               E\langle \psi, \psi\rangle \, ,
\end{equation*}
&lt;/div&gt;
&lt;p&gt;being &lt;span class="math"&gt;\(\psi\)&lt;/span&gt; the wave function, &lt;span class="math"&gt;\(V(x)\)&lt;/span&gt; the potential and
&lt;span class="math"&gt;\(E\)&lt;/span&gt; the energy. This variational formulation is equivalent to the
time-independent Schrödinger equation, and &lt;span class="math"&gt;\(E\)&lt;/span&gt; works as a Lagrange
multiplier to enforce that the probability over the whole domain is 1.&lt;/p&gt;
&lt;p&gt;We can expand the wave function in an orthonormal basis, namely&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
\psi = \sum_{n=0}^N c_n u_n(x)\, ,
\end{equation*}
&lt;/div&gt;
&lt;p&gt;where &lt;span class="math"&gt;\(u_n(x) \equiv \mu_n H_n(x) e^{-x^2/2}\)&lt;/span&gt; is a normalized
Hermite function, &lt;span class="math"&gt;\(\mu_n\)&lt;/span&gt; is the inverse of magnitude of the
&lt;span class="math"&gt;\(n\)&lt;/span&gt;-th Hermite polynomial&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
\mu_n = \frac{1}{\sqrt{\pi^{1/2} n! 2^n}}\, ,
\end{equation*}
&lt;/div&gt;
&lt;p&gt;and &lt;span class="math"&gt;\(c_n\)&lt;/span&gt; are the coefficients of the expansion. This
representation is exact in the limit &lt;span class="math"&gt;\(N \rightarrow \infty\)&lt;/span&gt;.&lt;/p&gt;
&lt;p&gt;If we replace the expansion in the functional, we obtain&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
\Pi_N = \sum_{m=0}^N\sum_{n=0}^N c_m c_n\left[
          \frac{1}{2} \langle \nabla u_m, \nabla u_n\rangle +
          \langle u_m, V(x) u_n\rangle -
          E^N \delta_{mn}\right]\, .
\end{equation*}
&lt;/div&gt;
&lt;p&gt;The integrand of the integral involving the two derivatives reads&lt;/p&gt;
&lt;div class="math"&gt;
\begin{align*}
u_m' u_n' =&amp;amp; \left[2m \frac{\mu_{m-1}}{\mu_m}u_{m-1} - x u_m\right]
            \left[2n \frac{\mu_{n-1}}{\mu_n}u_{n-1} - x u_n\right]\\
          =&amp;amp; 4mn\frac{\mu_{m-1} \mu_{n-1}}{\mu_m \mu_n} u_{n-1} u_{m-1}
           - 2m\frac{\mu_{m-1}}{\mu_{m}}x u_{m-1} u_n\\
           &amp;amp;- 2n\frac{\mu_{n-1}}{\mu_{n}}x u_{n-1} u_m + x^2 u_m u_n
\end{align*}
&lt;/div&gt;
&lt;p&gt;Thus, the kinetic energy term reads&lt;/p&gt;
&lt;div class="math"&gt;
\begin{align*}
\langle \nabla u_m, \nabla u_n \rangle =&amp;amp;
    4mn\frac{\mu_{m-1} \mu_{n-1}}{\mu_m \mu_n} \langle u_{n-1}, u_{m-1}\rangle
    - 2m\frac{\mu_{m-1}}{\mu_{m}} \langle u_{m-1}, x u_n\rangle\\
    &amp;amp;- 2n\frac{\mu_{n-1}}{\mu_{n}} \langle u_{m}, x u_{n - 1}\rangle
     + \langle u_m, x^2 u_n\rangle\\
    =&amp;amp; 4mn \frac{\mu_{m-1}^2}{\mu_m^2}\delta_{mn} -
      2m \frac{\mu_{m-1}}{\mu_m} \alpha_{m-1, n} -
      2n \frac{\mu_{n-1}}{\mu_n} \alpha_{m, n-1} + \beta_{mn} \, ,
\end{align*}
&lt;/div&gt;
&lt;p&gt;with&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
\alpha_{m,n} \equiv \langle u_{m}, x u_n\rangle = \begin{cases}
\sqrt{\frac{n + 1}{2}} &amp;amp; m=n +1\\
\sqrt{\frac{n}{2}} &amp;amp; m=n - 1\\
0 &amp;amp; \text{otherwise}\end{cases}\, ,
\end{equation*}
&lt;/div&gt;
&lt;p&gt;and&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
\beta_{m,n} \equiv \langle u_{m}, x^2 u_n\rangle = \begin{cases}
\frac{\sqrt{n(n-1)}}{2} &amp;amp; m = n - 2\\
\frac{2n + 1}{2} &amp;amp; m = n \\
\frac{\sqrt{(n+1)(n+1)}}{2} &amp;amp; m = n + 2 \\
0 &amp;amp; \text{otherwise}\end{cases}\, .
\end{equation*}
&lt;/div&gt;
&lt;p&gt;The functional is rewritten as&lt;/p&gt;
&lt;div class="math"&gt;
\begin{align*}
\Pi_N =&amp;amp; \sum_{m=0}^N \sum_{n=0}^N c_m c_n
  \left[2mn \frac{\mu^2_{m-1}}{\mu^2_m}\delta_{mn}
  - m\frac{\mu_{m-1}}{\mu_m}\alpha_{m - 1, n}
  - n\frac{\mu_{n-1}}{\mu_n}\delta_{m, n-1} \right.\nonumber \\
  &amp;amp;\left. - \frac{1}{2}\beta_{mn} + \langle u_m, V(x) u_n\rangle
  - E^N \delta_{mn}\right] \, .
\end{align*}
&lt;/div&gt;
&lt;p&gt;Taking the variation&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
\delta \Pi_N = 0\, ,
\end{equation*}
&lt;/div&gt;
&lt;p&gt;that in this case is equivalent to&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
\frac{\partial \Pi_N}{\partial c_i} = 0\quad \forall i=0, 1, \cdots N\, ,
\end{equation*}
&lt;/div&gt;
&lt;p&gt;yields to&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
[H]\lbrace c\rbrace = E^N\lbrace c\rbrace \, ,
\end{equation*}
&lt;/div&gt;
&lt;p&gt;where the components of the matrix &lt;span class="math"&gt;\([H]\)&lt;/span&gt; are given by&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
H_{mn} = 2mn \frac{\mu^2_{m-1}}{\mu^2_m}\delta_{mn}
  - m\frac{\mu_{m-1}}{\mu_m}\alpha_{m - 1, n}
  - n\frac{\mu_{n-1}}{\mu_n}\delta_{m, n-1}
  - \frac{1}{2}\beta_{mn} + \langle u_m, V(x) u_n\rangle\, .
\end{equation*}
&lt;/div&gt;
&lt;p&gt;The last integral can be computed using
&lt;a class="reference external" href="https://en.wikipedia.org/wiki/Gauss%E2%80%93Hermite_quadrature"&gt;Gauss-Hermite quadrature&lt;/a&gt;.
And we will need more Gauss points if we want to integrate higher-order
polynomials. This method would work fine for functions that can be
approximated by polynomials.&lt;/p&gt;
&lt;/section&gt;
&lt;section id="examples"&gt;
&lt;h2&gt;Examples&lt;/h2&gt;
&lt;p&gt;A Python implementation of this method is presented in
&lt;a class="reference external" href="https://github.com/nicoguaro/FEM_resources/blob/master/quantum_mechanics/hermite_QM.py"&gt;this repo&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;For all the examples we use the following imports&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code ipython"&gt;&lt;a id="rest_code_4aaa1b04991441dc849f88c6126da8b7-1" name="rest_code_4aaa1b04991441dc849f88c6126da8b7-1" href="https://nicoguaro.github.io/posts/hermite_ritz_qm/#rest_code_4aaa1b04991441dc849f88c6126da8b7-1"&gt;&lt;/a&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;__future__&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;division&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;print_function&lt;/span&gt;
&lt;a id="rest_code_4aaa1b04991441dc849f88c6126da8b7-2" name="rest_code_4aaa1b04991441dc849f88c6126da8b7-2" href="https://nicoguaro.github.io/posts/hermite_ritz_qm/#rest_code_4aaa1b04991441dc849f88c6126da8b7-2"&gt;&lt;/a&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;numpy&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;np&lt;/span&gt;
&lt;a id="rest_code_4aaa1b04991441dc849f88c6126da8b7-3" name="rest_code_4aaa1b04991441dc849f88c6126da8b7-3" href="https://nicoguaro.github.io/posts/hermite_ritz_qm/#rest_code_4aaa1b04991441dc849f88c6126da8b7-3"&gt;&lt;/a&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;hermite_QM&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;section id="quantum-harmonic-oscilator-1"&gt;
&lt;h3&gt;&lt;a class="reference external" href="https://en.wikipedia.org/wiki/Quantum_harmonic_oscillator"&gt;Quantum harmonic oscilator&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;In this case the (normalized) potential is given by&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
V(x) = \frac{1}{2} x^2
\end{equation*}
&lt;/div&gt;
&lt;p&gt;and the exact normalized eigenvalues are given by&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
E_n = n + \frac{1}{2}
\end{equation*}
&lt;/div&gt;
&lt;p&gt;The following snippet computes the first 10 eigenvalues and plot
the corresponding eigenstates&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code ipython"&gt;&lt;a id="rest_code_7194ef946b8c4d779b95bffe7a08cd01-1" name="rest_code_7194ef946b8c4d779b95bffe7a08cd01-1" href="https://nicoguaro.github.io/posts/hermite_ritz_qm/#rest_code_7194ef946b8c4d779b95bffe7a08cd01-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;potential&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;lambda&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="mf"&gt;0.5&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;
&lt;a id="rest_code_7194ef946b8c4d779b95bffe7a08cd01-2" name="rest_code_7194ef946b8c4d779b95bffe7a08cd01-2" href="https://nicoguaro.github.io/posts/hermite_ritz_qm/#rest_code_7194ef946b8c4d779b95bffe7a08cd01-2"&gt;&lt;/a&gt;&lt;span class="n"&gt;vals&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;vecs&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;eigenstates&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;potential&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;nterms&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;11&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;ngpts&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;12&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_7194ef946b8c4d779b95bffe7a08cd01-3" name="rest_code_7194ef946b8c4d779b95bffe7a08cd01-3" href="https://nicoguaro.github.io/posts/hermite_ritz_qm/#rest_code_7194ef946b8c4d779b95bffe7a08cd01-3"&gt;&lt;/a&gt;&lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;round&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;vals&lt;/span&gt;&lt;span class="p"&gt;[:&lt;/span&gt;&lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="mi"&gt;6&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_7194ef946b8c4d779b95bffe7a08cd01-4" name="rest_code_7194ef946b8c4d779b95bffe7a08cd01-4" href="https://nicoguaro.github.io/posts/hermite_ritz_qm/#rest_code_7194ef946b8c4d779b95bffe7a08cd01-4"&gt;&lt;/a&gt;&lt;span class="n"&gt;fig&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;ax&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;subplots&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_7194ef946b8c4d779b95bffe7a08cd01-5" name="rest_code_7194ef946b8c4d779b95bffe7a08cd01-5" href="https://nicoguaro.github.io/posts/hermite_ritz_qm/#rest_code_7194ef946b8c4d779b95bffe7a08cd01-5"&gt;&lt;/a&gt;&lt;span class="n"&gt;plot_eigenstates&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;vals&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;vecs&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;potential&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;with results&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code text"&gt;&lt;a id="rest_code_81f97ae6e8d04224bfc3246375c4d3ac-1" name="rest_code_81f97ae6e8d04224bfc3246375c4d3ac-1" href="https://nicoguaro.github.io/posts/hermite_ritz_qm/#rest_code_81f97ae6e8d04224bfc3246375c4d3ac-1"&gt;&lt;/a&gt;[ 0.5  1.5  2.5  3.5  4.5  5.5  6.5  7.5  8.5  9.5]
&lt;/pre&gt;&lt;/div&gt;
&lt;img alt="/images/hermite_ritz_harmonic.svg" src="https://nicoguaro.github.io/images/hermite_ritz_harmonic.svg"&gt;
&lt;/section&gt;
&lt;section id="absolute-value-potential"&gt;
&lt;h3&gt;Absolute value potential&lt;/h3&gt;
&lt;div class="code"&gt;&lt;pre class="code ipython"&gt;&lt;a id="rest_code_9a4345e48e9144a6b3165de4cbf46ae9-1" name="rest_code_9a4345e48e9144a6b3165de4cbf46ae9-1" href="https://nicoguaro.github.io/posts/hermite_ritz_qm/#rest_code_9a4345e48e9144a6b3165de4cbf46ae9-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;potential&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;lambda&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;abs&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_9a4345e48e9144a6b3165de4cbf46ae9-2" name="rest_code_9a4345e48e9144a6b3165de4cbf46ae9-2" href="https://nicoguaro.github.io/posts/hermite_ritz_qm/#rest_code_9a4345e48e9144a6b3165de4cbf46ae9-2"&gt;&lt;/a&gt;&lt;span class="n"&gt;vals&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;vecs&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;eigenstates&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;potential&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_9a4345e48e9144a6b3165de4cbf46ae9-3" name="rest_code_9a4345e48e9144a6b3165de4cbf46ae9-3" href="https://nicoguaro.github.io/posts/hermite_ritz_qm/#rest_code_9a4345e48e9144a6b3165de4cbf46ae9-3"&gt;&lt;/a&gt;&lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;round&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;vals&lt;/span&gt;&lt;span class="p"&gt;[:&lt;/span&gt;&lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="mi"&gt;6&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_9a4345e48e9144a6b3165de4cbf46ae9-4" name="rest_code_9a4345e48e9144a6b3165de4cbf46ae9-4" href="https://nicoguaro.github.io/posts/hermite_ritz_qm/#rest_code_9a4345e48e9144a6b3165de4cbf46ae9-4"&gt;&lt;/a&gt;&lt;span class="n"&gt;fig&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;ax&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;subplots&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_9a4345e48e9144a6b3165de4cbf46ae9-5" name="rest_code_9a4345e48e9144a6b3165de4cbf46ae9-5" href="https://nicoguaro.github.io/posts/hermite_ritz_qm/#rest_code_9a4345e48e9144a6b3165de4cbf46ae9-5"&gt;&lt;/a&gt;&lt;span class="n"&gt;plot_eigenstates&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;vals&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;vecs&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;potential&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;lims&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;8&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;8&lt;/span&gt;&lt;span class="p"&gt;));&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;with results&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code text"&gt;&lt;a id="rest_code_23025df21f7b49e6bff5202ce4ef2276-1" name="rest_code_23025df21f7b49e6bff5202ce4ef2276-1" href="https://nicoguaro.github.io/posts/hermite_ritz_qm/#rest_code_23025df21f7b49e6bff5202ce4ef2276-1"&gt;&lt;/a&gt;[ 0.811203  1.855725  2.57894   3.244576  3.826353  4.38189   4.895365
&lt;a id="rest_code_23025df21f7b49e6bff5202ce4ef2276-2" name="rest_code_23025df21f7b49e6bff5202ce4ef2276-2" href="https://nicoguaro.github.io/posts/hermite_ritz_qm/#rest_code_23025df21f7b49e6bff5202ce4ef2276-2"&gt;&lt;/a&gt;  5.396614  5.911591  6.421015]
&lt;/pre&gt;&lt;/div&gt;
&lt;img alt="/images/hermite_ritz_abs.svg" src="https://nicoguaro.github.io/images/hermite_ritz_abs.svg"&gt;
&lt;/section&gt;
&lt;section id="cubic-potential"&gt;
&lt;h3&gt;Cubic potential&lt;/h3&gt;
&lt;div class="code"&gt;&lt;pre class="code ipython"&gt;&lt;a id="rest_code_ef242f7831f04759ace67be22baa3403-1" name="rest_code_ef242f7831f04759ace67be22baa3403-1" href="https://nicoguaro.github.io/posts/hermite_ritz_qm/#rest_code_ef242f7831f04759ace67be22baa3403-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;potential&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;lambda&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;abs&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;
&lt;a id="rest_code_ef242f7831f04759ace67be22baa3403-2" name="rest_code_ef242f7831f04759ace67be22baa3403-2" href="https://nicoguaro.github.io/posts/hermite_ritz_qm/#rest_code_ef242f7831f04759ace67be22baa3403-2"&gt;&lt;/a&gt;&lt;span class="n"&gt;vals&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;vecs&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;eigenstates&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;potential&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_ef242f7831f04759ace67be22baa3403-3" name="rest_code_ef242f7831f04759ace67be22baa3403-3" href="https://nicoguaro.github.io/posts/hermite_ritz_qm/#rest_code_ef242f7831f04759ace67be22baa3403-3"&gt;&lt;/a&gt;&lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;round&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;vals&lt;/span&gt;&lt;span class="p"&gt;[:&lt;/span&gt;&lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="mi"&gt;6&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_ef242f7831f04759ace67be22baa3403-4" name="rest_code_ef242f7831f04759ace67be22baa3403-4" href="https://nicoguaro.github.io/posts/hermite_ritz_qm/#rest_code_ef242f7831f04759ace67be22baa3403-4"&gt;&lt;/a&gt;&lt;span class="n"&gt;fig&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;ax&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;subplots&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_ef242f7831f04759ace67be22baa3403-5" name="rest_code_ef242f7831f04759ace67be22baa3403-5" href="https://nicoguaro.github.io/posts/hermite_ritz_qm/#rest_code_ef242f7831f04759ace67be22baa3403-5"&gt;&lt;/a&gt;&lt;span class="n"&gt;plot_eigenstates&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;vals&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;vecs&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;potential&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;lims&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;6&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;6&lt;/span&gt;&lt;span class="p"&gt;));&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;with results&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code text"&gt;&lt;a id="rest_code_4df2a2e60a9f42d09bf24d687bddb529-1" name="rest_code_4df2a2e60a9f42d09bf24d687bddb529-1" href="https://nicoguaro.github.io/posts/hermite_ritz_qm/#rest_code_4df2a2e60a9f42d09bf24d687bddb529-1"&gt;&lt;/a&gt;[ 0.180588  0.609153  1.124594  1.681002  2.272087  2.889805  3.530901
&lt;a id="rest_code_4df2a2e60a9f42d09bf24d687bddb529-2" name="rest_code_4df2a2e60a9f42d09bf24d687bddb529-2" href="https://nicoguaro.github.io/posts/hermite_ritz_qm/#rest_code_4df2a2e60a9f42d09bf24d687bddb529-2"&gt;&lt;/a&gt;  4.191962  4.871133  5.566413]
&lt;/pre&gt;&lt;/div&gt;
&lt;img alt="/images/hermite_ritz_cubic.svg" src="https://nicoguaro.github.io/images/hermite_ritz_cubic.svg"&gt;
&lt;/section&gt;
&lt;section id="harmonic-with-quartic-perturbation"&gt;
&lt;h3&gt;Harmonic with quartic perturbation&lt;/h3&gt;
&lt;div class="code"&gt;&lt;pre class="code ipython"&gt;&lt;a id="rest_code_76df0e28fc70454f9f7e84634f4af7b3-1" name="rest_code_76df0e28fc70454f9f7e84634f4af7b3-1" href="https://nicoguaro.github.io/posts/hermite_ritz_qm/#rest_code_76df0e28fc70454f9f7e84634f4af7b3-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;potential&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;lambda&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="mf"&gt;0.5&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mf"&gt;0.1&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;
&lt;a id="rest_code_76df0e28fc70454f9f7e84634f4af7b3-2" name="rest_code_76df0e28fc70454f9f7e84634f4af7b3-2" href="https://nicoguaro.github.io/posts/hermite_ritz_qm/#rest_code_76df0e28fc70454f9f7e84634f4af7b3-2"&gt;&lt;/a&gt;&lt;span class="n"&gt;vals&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;vecs&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;eigenstates&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;potential&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;nterms&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;20&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;ngpts&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;22&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_76df0e28fc70454f9f7e84634f4af7b3-3" name="rest_code_76df0e28fc70454f9f7e84634f4af7b3-3" href="https://nicoguaro.github.io/posts/hermite_ritz_qm/#rest_code_76df0e28fc70454f9f7e84634f4af7b3-3"&gt;&lt;/a&gt;&lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;round&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;vals&lt;/span&gt;&lt;span class="p"&gt;[:&lt;/span&gt;&lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="mi"&gt;6&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_76df0e28fc70454f9f7e84634f4af7b3-4" name="rest_code_76df0e28fc70454f9f7e84634f4af7b3-4" href="https://nicoguaro.github.io/posts/hermite_ritz_qm/#rest_code_76df0e28fc70454f9f7e84634f4af7b3-4"&gt;&lt;/a&gt;&lt;span class="n"&gt;fig&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;ax&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;subplots&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_76df0e28fc70454f9f7e84634f4af7b3-5" name="rest_code_76df0e28fc70454f9f7e84634f4af7b3-5" href="https://nicoguaro.github.io/posts/hermite_ritz_qm/#rest_code_76df0e28fc70454f9f7e84634f4af7b3-5"&gt;&lt;/a&gt;&lt;span class="n"&gt;plot_eigenstates&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;vals&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;vecs&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;potential&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;lims&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;with results&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code text"&gt;&lt;a id="rest_code_4d7d11114cc64b859d14f0ce6f2d4244-1" name="rest_code_4d7d11114cc64b859d14f0ce6f2d4244-1" href="https://nicoguaro.github.io/posts/hermite_ritz_qm/#rest_code_4d7d11114cc64b859d14f0ce6f2d4244-1"&gt;&lt;/a&gt;[  0.559146   1.769503   3.138624   4.628884   6.220303   7.899789
&lt;a id="rest_code_4d7d11114cc64b859d14f0ce6f2d4244-2" name="rest_code_4d7d11114cc64b859d14f0ce6f2d4244-2" href="https://nicoguaro.github.io/posts/hermite_ritz_qm/#rest_code_4d7d11114cc64b859d14f0ce6f2d4244-2"&gt;&lt;/a&gt;   9.658703  11.489094  13.38638   15.361055]
&lt;/pre&gt;&lt;/div&gt;
&lt;img alt="/images/hermite_ritz_pert_harm.svg" src="https://nicoguaro.github.io/images/hermite_ritz_pert_harm.svg"&gt;
&lt;p&gt;A Jupyter Notebook with the examples can be found
&lt;a class="reference external" href="https://github.com/nicoguaro/FEM_resources/blob/master/quantum_mechanics/Ritz_Hermite_QM.ipynb"&gt;here&lt;/a&gt;.&lt;/p&gt;
&lt;/section&gt;
&lt;/section&gt;</description><category>finite element method</category><category>Hermite polynomials</category><category>variational methods</category><guid>https://nicoguaro.github.io/posts/hermite_ritz_qm/</guid><pubDate>Wed, 12 Jul 2017 00:04:57 GMT</pubDate></item><item><title>Piecewise Hermite interpolation</title><link>https://nicoguaro.github.io/posts/hermite_interp/</link><dc:creator>Nicolás Guarín-Zapata</dc:creator><description>&lt;p&gt;In this post, we find the Hermite interpolation functions for the
domain [-1, 1]. And then, we use it for a pieciwise interpolation. Notice
that this interpolation has &lt;span class="math"&gt;\(C^1\)&lt;/span&gt; continuity compared to the
&lt;span class="math"&gt;\(C^0\)&lt;/span&gt; continuity that is common in Lagrange interpolation.&lt;/p&gt;
&lt;p&gt;To compute the polynomials explicitly we use &lt;cite&gt;sympy&lt;/cite&gt;.&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code ipython2"&gt;&lt;a id="rest_code_061ad65669d0473d9605fcfc2baace5a-1" name="rest_code_061ad65669d0473d9605fcfc2baace5a-1" href="https://nicoguaro.github.io/posts/hermite_interp/#rest_code_061ad65669d0473d9605fcfc2baace5a-1"&gt;&lt;/a&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;__future__&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;division&lt;/span&gt;
&lt;a id="rest_code_061ad65669d0473d9605fcfc2baace5a-2" name="rest_code_061ad65669d0473d9605fcfc2baace5a-2" href="https://nicoguaro.github.io/posts/hermite_interp/#rest_code_061ad65669d0473d9605fcfc2baace5a-2"&gt;&lt;/a&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;numpy&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;np&lt;/span&gt;
&lt;a id="rest_code_061ad65669d0473d9605fcfc2baace5a-3" name="rest_code_061ad65669d0473d9605fcfc2baace5a-3" href="https://nicoguaro.github.io/posts/hermite_interp/#rest_code_061ad65669d0473d9605fcfc2baace5a-3"&gt;&lt;/a&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;sympy&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;sym&lt;/span&gt;
&lt;a id="rest_code_061ad65669d0473d9605fcfc2baace5a-4" name="rest_code_061ad65669d0473d9605fcfc2baace5a-4" href="https://nicoguaro.github.io/posts/hermite_interp/#rest_code_061ad65669d0473d9605fcfc2baace5a-4"&gt;&lt;/a&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;matplotlib.pyplot&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;plt&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;We want to find a set of basis function that satisfy the following&lt;/p&gt;
&lt;div class="math"&gt;
\begin{align*}
N_1(x_1) &amp;amp;= 1\\
N_1(x_2) &amp;amp;= 0\\
N_2(x_1) &amp;amp;= 1\\
N_2(x_2) &amp;amp;= 0\\
N'_3(x_1) &amp;amp;= 1\\
N'_3(x_2) &amp;amp;= 0\\
N'_4(x_1) &amp;amp;= 1\\
N'_4(x_2) &amp;amp;= 0
\end{align*}
&lt;/div&gt;
&lt;p&gt;These can be written as&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
\begin{bmatrix}
1 &amp;amp;x_1 &amp;amp;x_1^2 &amp;amp;x_1^3\\
1 &amp;amp;x_2 &amp;amp;x_2^2 &amp;amp;x_2^3\\
0 &amp;amp;1 &amp;amp;2x_1 &amp;amp;3x_1^2\\
0 &amp;amp;1 &amp;amp;2x_2 &amp;amp;3x_2^2
\end{bmatrix}
\begin{bmatrix}
a_{11} &amp;amp;a_{12} &amp;amp;a_{13} &amp;amp;a_{14}\\
a_{21} &amp;amp;a_{22} &amp;amp;a_{23} &amp;amp;a_{24}\\
a_{31} &amp;amp;a_{32} &amp;amp;a_{33} &amp;amp;a_{34}\\
a_{41} &amp;amp;a_{42} &amp;amp;a_{43} &amp;amp;a_{44}
\end{bmatrix} =
\begin{bmatrix}
1 &amp;amp;0 &amp;amp;0 &amp;amp;0\\
0 &amp;amp;1 &amp;amp;0 &amp;amp;0\\
0 &amp;amp;0 &amp;amp;1 &amp;amp;0\\
0 &amp;amp;0 &amp;amp;0 &amp;amp;1
\end{bmatrix}
\end{equation*}
&lt;/div&gt;
&lt;p&gt;The formula for interpolation would be&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
f(x) \approx N_1(x) u_1 + N_2(x) u_2 + |J|(N_3(x) u'_3 + N_4(x) u'_4)\quad \forall x\in [a, b]
\end{equation*}
&lt;/div&gt;
&lt;p&gt;with &lt;span class="math"&gt;\(|J| = (b - a)/2\)&lt;/span&gt; the Jacobian determinant of the
transformation.&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code ipython2"&gt;&lt;a id="rest_code_477288290dc94d669aa212f32facfb7a-1" name="rest_code_477288290dc94d669aa212f32facfb7a-1" href="https://nicoguaro.github.io/posts/hermite_interp/#rest_code_477288290dc94d669aa212f32facfb7a-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;x1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;x2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;sym&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;symbols&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"x1 x2 x"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_477288290dc94d669aa212f32facfb7a-2" name="rest_code_477288290dc94d669aa212f32facfb7a-2" href="https://nicoguaro.github.io/posts/hermite_interp/#rest_code_477288290dc94d669aa212f32facfb7a-2"&gt;&lt;/a&gt;&lt;span class="n"&gt;V&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;sym&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Matrix&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;
&lt;a id="rest_code_477288290dc94d669aa212f32facfb7a-3" name="rest_code_477288290dc94d669aa212f32facfb7a-3" href="https://nicoguaro.github.io/posts/hermite_interp/#rest_code_477288290dc94d669aa212f32facfb7a-3"&gt;&lt;/a&gt;    &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;x1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;x1&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;x1&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;
&lt;a id="rest_code_477288290dc94d669aa212f32facfb7a-4" name="rest_code_477288290dc94d669aa212f32facfb7a-4" href="https://nicoguaro.github.io/posts/hermite_interp/#rest_code_477288290dc94d669aa212f32facfb7a-4"&gt;&lt;/a&gt;    &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;x2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;x2&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;x2&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;
&lt;a id="rest_code_477288290dc94d669aa212f32facfb7a-5" name="rest_code_477288290dc94d669aa212f32facfb7a-5" href="https://nicoguaro.github.io/posts/hermite_interp/#rest_code_477288290dc94d669aa212f32facfb7a-5"&gt;&lt;/a&gt;    &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;x1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;x1&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;
&lt;a id="rest_code_477288290dc94d669aa212f32facfb7a-6" name="rest_code_477288290dc94d669aa212f32facfb7a-6" href="https://nicoguaro.github.io/posts/hermite_interp/#rest_code_477288290dc94d669aa212f32facfb7a-6"&gt;&lt;/a&gt;    &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;x2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;x2&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;]])&lt;/span&gt;
&lt;a id="rest_code_477288290dc94d669aa212f32facfb7a-7" name="rest_code_477288290dc94d669aa212f32facfb7a-7" href="https://nicoguaro.github.io/posts/hermite_interp/#rest_code_477288290dc94d669aa212f32facfb7a-7"&gt;&lt;/a&gt;&lt;span class="n"&gt;V&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="math"&gt;
\begin{equation*}
\left[\begin{matrix}1 &amp;amp; x_{1} &amp;amp; x_{1}^{2} &amp;amp; x_{1}^{3}\\
1 &amp;amp; x_{2} &amp;amp; x_{2}^{2} &amp;amp; x_{2}^{3}\\
0 &amp;amp; 1 &amp;amp; 2 x_{1} &amp;amp; 3 x_{1}^{2}\\
0 &amp;amp; 1 &amp;amp; 2 x_{2} &amp;amp; 3 x_{2}^{2}\end{matrix}\right]
\end{equation*}
&lt;/div&gt;
&lt;p&gt;We can see that the previous matrix is a  confluent Vandermonder matrix &lt;a class="footnote-reference brackets" href="https://nicoguaro.github.io/posts/hermite_interp/#footnote-1" id="footnote-reference-1" role="doc-noteref"&gt;&lt;span class="fn-bracket"&gt;[&lt;/span&gt;1&lt;span class="fn-bracket"&gt;]&lt;/span&gt;&lt;/a&gt;.
It is similar to a Vandermonde matrix for the first &lt;span class="math"&gt;\(n\)&lt;/span&gt; nodes
and the derivatives of each row for the following ones.&lt;/p&gt;
&lt;p&gt;The coefficients for our polynomials are given by the inverse of this matrix.&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code ipython2"&gt;&lt;a id="rest_code_ea44c0967c05406eaa690c1d677bc0d1-1" name="rest_code_ea44c0967c05406eaa690c1d677bc0d1-1" href="https://nicoguaro.github.io/posts/hermite_interp/#rest_code_ea44c0967c05406eaa690c1d677bc0d1-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;sym&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;simplify&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;V&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;inv&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="math"&gt;
\begin{equation*}
\left[\begin{matrix}\frac{x_{2}^{2} \left(3 x_{1} - x_{2}\right)}{x_{1}^{3} - 3 x_{1}^{2} x_{2} + 3 x_{1} x_{2}^{2} - x_{2}^{3}} &amp;amp; \frac{x_{1}^{2} \left(x_{1} - 3 x_{2}\right)}{x_{1}^{3} - 3 x_{1}^{2} x_{2} + 3 x_{1} x_{2}^{2} - x_{2}^{3}} &amp;amp; - \frac{x_{1} x_{2}^{2}}{x_{1}^{2} - 2 x_{1} x_{2} + x_{2}^{2}} &amp;amp; - \frac{x_{1}^{2} x_{2}}{x_{1}^{2} - 2 x_{1} x_{2} + x_{2}^{2}}\\- \frac{6 x_{1} x_{2}}{x_{1}^{3} - 3 x_{1}^{2} x_{2} + 3 x_{1} x_{2}^{2} - x_{2}^{3}} &amp;amp; \frac{6 x_{1} x_{2}}{x_{1}^{3} - 3 x_{1}^{2} x_{2} + 3 x_{1} x_{2}^{2} - x_{2}^{3}} &amp;amp; \frac{x_{2} \left(2 x_{1} + x_{2}\right)}{x_{1}^{2} - 2 x_{1} x_{2} + x_{2}^{2}} &amp;amp; \frac{x_{1} \left(x_{1} + 2 x_{2}\right)}{x_{1}^{2} - 2 x_{1} x_{2} + x_{2}^{2}}\\\frac{3 x_{1} + 3 x_{2}}{x_{1}^{3} - 3 x_{1}^{2} x_{2} + 3 x_{1} x_{2}^{2} - x_{2}^{3}} &amp;amp; - \frac{3 x_{1} + 3 x_{2}}{x_{1}^{3} - 3 x_{1}^{2} x_{2} + 3 x_{1} x_{2}^{2} - x_{2}^{3}} &amp;amp; - \frac{x_{1} + 2 x_{2}}{x_{1}^{2} - 2 x_{1} x_{2} + x_{2}^{2}} &amp;amp; - \frac{2 x_{1} + x_{2}}{x_{1}^{2} - 2 x_{1} x_{2} + x_{2}^{2}}\\- \frac{2}{x_{1}^{3} - 3 x_{1}^{2} x_{2} + 3 x_{1} x_{2}^{2} - x_{2}^{3}} &amp;amp; \frac{2}{x_{1}^{3} - 3 x_{1}^{2} x_{2} + 3 x_{1} x_{2}^{2} - x_{2}^{3}} &amp;amp; \frac{1}{x_{1}^{2} - 2 x_{1} x_{2} + x_{2}^{2}} &amp;amp; \frac{1}{x_{1}^{2} - 2 x_{1} x_{2} + x_{2}^{2}}\end{matrix}\right]
\end{equation*}
&lt;/div&gt;
&lt;p&gt;And we replace the values for the extreme nodes, -1 and 1.&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code ipython2"&gt;&lt;a id="rest_code_2e2939fdedcb47ae955084cf93e3b8e6-1" name="rest_code_2e2939fdedcb47ae955084cf93e3b8e6-1" href="https://nicoguaro.github.io/posts/hermite_interp/#rest_code_2e2939fdedcb47ae955084cf93e3b8e6-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;V_inv&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;sym&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;simplify&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;V&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;subs&lt;/span&gt;&lt;span class="p"&gt;({&lt;/span&gt;&lt;span class="n"&gt;x1&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;x2&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;})&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;inv&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt;
&lt;a id="rest_code_2e2939fdedcb47ae955084cf93e3b8e6-2" name="rest_code_2e2939fdedcb47ae955084cf93e3b8e6-2" href="https://nicoguaro.github.io/posts/hermite_interp/#rest_code_2e2939fdedcb47ae955084cf93e3b8e6-2"&gt;&lt;/a&gt;&lt;span class="n"&gt;V_inv&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="math"&gt;
\begin{equation*}
\left[\begin{matrix}\frac{1}{2} &amp;amp; \frac{1}{2} &amp;amp; \frac{1}{4} &amp;amp; - \frac{1}{4}\\
- \frac{3}{4} &amp;amp; \frac{3}{4} &amp;amp; - \frac{1}{4} &amp;amp; - \frac{1}{4}\\
0 &amp;amp; 0 &amp;amp; - \frac{1}{4} &amp;amp; \frac{1}{4}\\
\frac{1}{4} &amp;amp; - \frac{1}{4} &amp;amp; \frac{1}{4} &amp;amp; \frac{1}{4}\end{matrix}\right]
\end{equation*}
&lt;/div&gt;
&lt;p&gt;The polynomials are the product of the coefficients and the monomials&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code ipython2"&gt;&lt;a id="rest_code_91a60c61375340b895a8e32288dfc863-1" name="rest_code_91a60c61375340b895a8e32288dfc863-1" href="https://nicoguaro.github.io/posts/hermite_interp/#rest_code_91a60c61375340b895a8e32288dfc863-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;sym&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;factor&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;V_inv&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;T&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;sym&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Matrix&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;]))&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="math"&gt;
\begin{equation*}
\left[\begin{matrix}\frac{1}{4} \left(x - 1\right)^{2} \left(x + 2\right)\\- \frac{1}{4} \left(x - 2\right) \left(x + 1\right)^{2}\\\frac{1}{4} \left(x - 1\right)^{2} \left(x + 1\right)\\\frac{1}{4} \left(x - 1\right) \left(x + 1\right)^{2}\end{matrix}\right]
\end{equation*}
&lt;/div&gt;
&lt;p&gt;The interpolation basis would be&lt;/p&gt;
&lt;div class="math"&gt;
\begin{align*}
N_1 (x) &amp;amp;= \frac{1}{4} (x - 1)^2 (2 + x)\\
N_2 (x) &amp;amp;= \frac{1}{4} (x + 1)^2 (2 - x)\\
N_3 (x) &amp;amp;= \frac{1}{4} (x - 1)^2 (x + 1)\\
N_4 (x) &amp;amp;= \frac{1}{4} (x + 1)^2 (x - 1)\, ,
\end{align*}
&lt;/div&gt;
&lt;p&gt;and the following function computes the interpolation for a given
function and derivative&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code ipython2"&gt;&lt;a id="rest_code_423d75263db047c197189a2f6347f0c6-1" name="rest_code_423d75263db047c197189a2f6347f0c6-1" href="https://nicoguaro.github.io/posts/hermite_interp/#rest_code_423d75263db047c197189a2f6347f0c6-1"&gt;&lt;/a&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;hermite_interp&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;fun&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;grad&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;x0&lt;/span&gt;&lt;span class="o"&gt;=-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;x1&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;npts&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;101&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_423d75263db047c197189a2f6347f0c6-2" name="rest_code_423d75263db047c197189a2f6347f0c6-2" href="https://nicoguaro.github.io/posts/hermite_interp/#rest_code_423d75263db047c197189a2f6347f0c6-2"&gt;&lt;/a&gt;    &lt;span class="n"&gt;jaco&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x1&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;x0&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;
&lt;a id="rest_code_423d75263db047c197189a2f6347f0c6-3" name="rest_code_423d75263db047c197189a2f6347f0c6-3" href="https://nicoguaro.github.io/posts/hermite_interp/#rest_code_423d75263db047c197189a2f6347f0c6-3"&gt;&lt;/a&gt;    &lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;linspace&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;npts&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_423d75263db047c197189a2f6347f0c6-4" name="rest_code_423d75263db047c197189a2f6347f0c6-4" href="https://nicoguaro.github.io/posts/hermite_interp/#rest_code_423d75263db047c197189a2f6347f0c6-4"&gt;&lt;/a&gt;    &lt;span class="n"&gt;f1&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;fun&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x0&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_423d75263db047c197189a2f6347f0c6-5" name="rest_code_423d75263db047c197189a2f6347f0c6-5" href="https://nicoguaro.github.io/posts/hermite_interp/#rest_code_423d75263db047c197189a2f6347f0c6-5"&gt;&lt;/a&gt;    &lt;span class="n"&gt;f2&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;fun&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_423d75263db047c197189a2f6347f0c6-6" name="rest_code_423d75263db047c197189a2f6347f0c6-6" href="https://nicoguaro.github.io/posts/hermite_interp/#rest_code_423d75263db047c197189a2f6347f0c6-6"&gt;&lt;/a&gt;    &lt;span class="n"&gt;g1&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;grad&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x0&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_423d75263db047c197189a2f6347f0c6-7" name="rest_code_423d75263db047c197189a2f6347f0c6-7" href="https://nicoguaro.github.io/posts/hermite_interp/#rest_code_423d75263db047c197189a2f6347f0c6-7"&gt;&lt;/a&gt;    &lt;span class="n"&gt;g2&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;grad&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_423d75263db047c197189a2f6347f0c6-8" name="rest_code_423d75263db047c197189a2f6347f0c6-8" href="https://nicoguaro.github.io/posts/hermite_interp/#rest_code_423d75263db047c197189a2f6347f0c6-8"&gt;&lt;/a&gt;    &lt;span class="n"&gt;N1&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_423d75263db047c197189a2f6347f0c6-9" name="rest_code_423d75263db047c197189a2f6347f0c6-9" href="https://nicoguaro.github.io/posts/hermite_interp/#rest_code_423d75263db047c197189a2f6347f0c6-9"&gt;&lt;/a&gt;    &lt;span class="n"&gt;N2&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_423d75263db047c197189a2f6347f0c6-10" name="rest_code_423d75263db047c197189a2f6347f0c6-10" href="https://nicoguaro.github.io/posts/hermite_interp/#rest_code_423d75263db047c197189a2f6347f0c6-10"&gt;&lt;/a&gt;    &lt;span class="n"&gt;N3&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_423d75263db047c197189a2f6347f0c6-11" name="rest_code_423d75263db047c197189a2f6347f0c6-11" href="https://nicoguaro.github.io/posts/hermite_interp/#rest_code_423d75263db047c197189a2f6347f0c6-11"&gt;&lt;/a&gt;    &lt;span class="n"&gt;N4&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_423d75263db047c197189a2f6347f0c6-12" name="rest_code_423d75263db047c197189a2f6347f0c6-12" href="https://nicoguaro.github.io/posts/hermite_interp/#rest_code_423d75263db047c197189a2f6347f0c6-12"&gt;&lt;/a&gt;    &lt;span class="n"&gt;interp&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;N1&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;f1&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;N2&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;f2&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;jaco&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N3&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;g1&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;N4&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;g2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_423d75263db047c197189a2f6347f0c6-13" name="rest_code_423d75263db047c197189a2f6347f0c6-13" href="https://nicoguaro.github.io/posts/hermite_interp/#rest_code_423d75263db047c197189a2f6347f0c6-13"&gt;&lt;/a&gt;    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;interp&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;In this case, we interpolate the &lt;code class="docutils literal"&gt;sinc&lt;/code&gt; function&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code ipython2"&gt;&lt;a id="rest_code_9214923c186744a098091af3847f9e42-1" name="rest_code_9214923c186744a098091af3847f9e42-1" href="https://nicoguaro.github.io/posts/hermite_interp/#rest_code_9214923c186744a098091af3847f9e42-1"&gt;&lt;/a&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;fun&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_9214923c186744a098091af3847f9e42-2" name="rest_code_9214923c186744a098091af3847f9e42-2" href="https://nicoguaro.github.io/posts/hermite_interp/#rest_code_9214923c186744a098091af3847f9e42-2"&gt;&lt;/a&gt;    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sin&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;pi&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;pi&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_9214923c186744a098091af3847f9e42-3" name="rest_code_9214923c186744a098091af3847f9e42-3" href="https://nicoguaro.github.io/posts/hermite_interp/#rest_code_9214923c186744a098091af3847f9e42-3"&gt;&lt;/a&gt;
&lt;a id="rest_code_9214923c186744a098091af3847f9e42-4" name="rest_code_9214923c186744a098091af3847f9e42-4" href="https://nicoguaro.github.io/posts/hermite_interp/#rest_code_9214923c186744a098091af3847f9e42-4"&gt;&lt;/a&gt;
&lt;a id="rest_code_9214923c186744a098091af3847f9e42-5" name="rest_code_9214923c186744a098091af3847f9e42-5" href="https://nicoguaro.github.io/posts/hermite_interp/#rest_code_9214923c186744a098091af3847f9e42-5"&gt;&lt;/a&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;grad&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_9214923c186744a098091af3847f9e42-6" name="rest_code_9214923c186744a098091af3847f9e42-6" href="https://nicoguaro.github.io/posts/hermite_interp/#rest_code_9214923c186744a098091af3847f9e42-6"&gt;&lt;/a&gt;    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;cos&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;pi&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sin&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;pi&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;pi&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;The following snippet compute the interpolation and plot it.&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code ipython2"&gt;&lt;a id="rest_code_c13a0a777da7405d84415135adc7da28-1" name="rest_code_c13a0a777da7405d84415135adc7da28-1" href="https://nicoguaro.github.io/posts/hermite_interp/#rest_code_c13a0a777da7405d84415135adc7da28-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;a&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;
&lt;a id="rest_code_c13a0a777da7405d84415135adc7da28-2" name="rest_code_c13a0a777da7405d84415135adc7da28-2" href="https://nicoguaro.github.io/posts/hermite_interp/#rest_code_c13a0a777da7405d84415135adc7da28-2"&gt;&lt;/a&gt;&lt;span class="n"&gt;b&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;5&lt;/span&gt;
&lt;a id="rest_code_c13a0a777da7405d84415135adc7da28-3" name="rest_code_c13a0a777da7405d84415135adc7da28-3" href="https://nicoguaro.github.io/posts/hermite_interp/#rest_code_c13a0a777da7405d84415135adc7da28-3"&gt;&lt;/a&gt;&lt;span class="n"&gt;nels&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;7&lt;/span&gt;
&lt;a id="rest_code_c13a0a777da7405d84415135adc7da28-4" name="rest_code_c13a0a777da7405d84415135adc7da28-4" href="https://nicoguaro.github.io/posts/hermite_interp/#rest_code_c13a0a777da7405d84415135adc7da28-4"&gt;&lt;/a&gt;&lt;span class="n"&gt;npts&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;200&lt;/span&gt;
&lt;a id="rest_code_c13a0a777da7405d84415135adc7da28-5" name="rest_code_c13a0a777da7405d84415135adc7da28-5" href="https://nicoguaro.github.io/posts/hermite_interp/#rest_code_c13a0a777da7405d84415135adc7da28-5"&gt;&lt;/a&gt;&lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;linspace&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;npts&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_c13a0a777da7405d84415135adc7da28-6" name="rest_code_c13a0a777da7405d84415135adc7da28-6" href="https://nicoguaro.github.io/posts/hermite_interp/#rest_code_c13a0a777da7405d84415135adc7da28-6"&gt;&lt;/a&gt;&lt;span class="n"&gt;y&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;fun&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_c13a0a777da7405d84415135adc7da28-7" name="rest_code_c13a0a777da7405d84415135adc7da28-7" href="https://nicoguaro.github.io/posts/hermite_interp/#rest_code_c13a0a777da7405d84415135adc7da28-7"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;plot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;color&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;"black"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_c13a0a777da7405d84415135adc7da28-8" name="rest_code_c13a0a777da7405d84415135adc7da28-8" href="https://nicoguaro.github.io/posts/hermite_interp/#rest_code_c13a0a777da7405d84415135adc7da28-8"&gt;&lt;/a&gt;&lt;span class="n"&gt;xi&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;linspace&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;num&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;nels&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;endpoint&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;False&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_c13a0a777da7405d84415135adc7da28-9" name="rest_code_c13a0a777da7405d84415135adc7da28-9" href="https://nicoguaro.github.io/posts/hermite_interp/#rest_code_c13a0a777da7405d84415135adc7da28-9"&gt;&lt;/a&gt;&lt;span class="n"&gt;dx&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;xi&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;xi&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_c13a0a777da7405d84415135adc7da28-10" name="rest_code_c13a0a777da7405d84415135adc7da28-10" href="https://nicoguaro.github.io/posts/hermite_interp/#rest_code_c13a0a777da7405d84415135adc7da28-10"&gt;&lt;/a&gt;&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;x0&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;xi&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a id="rest_code_c13a0a777da7405d84415135adc7da28-11" name="rest_code_c13a0a777da7405d84415135adc7da28-11" href="https://nicoguaro.github.io/posts/hermite_interp/#rest_code_c13a0a777da7405d84415135adc7da28-11"&gt;&lt;/a&gt;    &lt;span class="n"&gt;x1&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;x0&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;dx&lt;/span&gt;
&lt;a id="rest_code_c13a0a777da7405d84415135adc7da28-12" name="rest_code_c13a0a777da7405d84415135adc7da28-12" href="https://nicoguaro.github.io/posts/hermite_interp/#rest_code_c13a0a777da7405d84415135adc7da28-12"&gt;&lt;/a&gt;    &lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;linspace&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;x1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;npts&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_c13a0a777da7405d84415135adc7da28-13" name="rest_code_c13a0a777da7405d84415135adc7da28-13" href="https://nicoguaro.github.io/posts/hermite_interp/#rest_code_c13a0a777da7405d84415135adc7da28-13"&gt;&lt;/a&gt;    &lt;span class="n"&gt;y&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;hermite_interp&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;fun&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;grad&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;x0&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;x0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;x1&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;x1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;npts&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;npts&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_c13a0a777da7405d84415135adc7da28-14" name="rest_code_c13a0a777da7405d84415135adc7da28-14" href="https://nicoguaro.github.io/posts/hermite_interp/#rest_code_c13a0a777da7405d84415135adc7da28-14"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;plot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;linestyle&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;"dashed"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;color&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;"#4daf4a"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_c13a0a777da7405d84415135adc7da28-15" name="rest_code_c13a0a777da7405d84415135adc7da28-15" href="https://nicoguaro.github.io/posts/hermite_interp/#rest_code_c13a0a777da7405d84415135adc7da28-15"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;plot&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]],&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]],&lt;/span&gt; &lt;span class="n"&gt;marker&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;"o"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;color&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;"#4daf4a"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;a id="rest_code_c13a0a777da7405d84415135adc7da28-16" name="rest_code_c13a0a777da7405d84415135adc7da28-16" href="https://nicoguaro.github.io/posts/hermite_interp/#rest_code_c13a0a777da7405d84415135adc7da28-16"&gt;&lt;/a&gt;         &lt;span class="n"&gt;linewidth&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_c13a0a777da7405d84415135adc7da28-17" name="rest_code_c13a0a777da7405d84415135adc7da28-17" href="https://nicoguaro.github.io/posts/hermite_interp/#rest_code_c13a0a777da7405d84415135adc7da28-17"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"x"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_c13a0a777da7405d84415135adc7da28-18" name="rest_code_c13a0a777da7405d84415135adc7da28-18" href="https://nicoguaro.github.io/posts/hermite_interp/#rest_code_c13a0a777da7405d84415135adc7da28-18"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ylabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"y"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_c13a0a777da7405d84415135adc7da28-19" name="rest_code_c13a0a777da7405d84415135adc7da28-19" href="https://nicoguaro.github.io/posts/hermite_interp/#rest_code_c13a0a777da7405d84415135adc7da28-19"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;legend&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="s2"&gt;"Exact function"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;"Interpolation"&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_c13a0a777da7405d84415135adc7da28-20" name="rest_code_c13a0a777da7405d84415135adc7da28-20" href="https://nicoguaro.github.io/posts/hermite_interp/#rest_code_c13a0a777da7405d84415135adc7da28-20"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;show&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;img alt="/images/sinc_interp.svg" src="https://nicoguaro.github.io/images/sinc_interp.svg"&gt;
&lt;section id="references"&gt;
&lt;h2&gt;References&lt;/h2&gt;
&lt;aside class="footnote-list brackets"&gt;
&lt;aside class="footnote brackets" id="footnote-1" role="note"&gt;
&lt;span class="label"&gt;&lt;span class="fn-bracket"&gt;[&lt;/span&gt;&lt;a role="doc-backlink" href="https://nicoguaro.github.io/posts/hermite_interp/#footnote-reference-1"&gt;1&lt;/a&gt;&lt;span class="fn-bracket"&gt;]&lt;/span&gt;&lt;/span&gt;
&lt;p&gt;Walter Gautschi (1962). On inverses of Vandermonde
and confluent Vandermonde matrices. Numerische Mathematik, 4
117-123.&lt;/p&gt;
&lt;/aside&gt;
&lt;/aside&gt;
&lt;/section&gt;</description><category>approximation</category><category>finite element method</category><category>interpolation</category><category>python</category><category>sympy</category><guid>https://nicoguaro.github.io/posts/hermite_interp/</guid><pubDate>Thu, 22 Jun 2017 21:24:44 GMT</pubDate></item></channel></rss>