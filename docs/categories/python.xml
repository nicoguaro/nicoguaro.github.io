<?xml version="1.0" encoding="utf-8"?>
<?xml-stylesheet type="text/xsl" href="../assets/xml/rss.xsl" media="all"?><rss version="2.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Nicolás' blog (Posts about python)</title><link>https://nicoguaro.github.io/</link><description></description><atom:link href="https://nicoguaro.github.io/categories/python.xml" rel="self" type="application/rss+xml"></atom:link><language>en</language><copyright>Contents © 2022 &lt;a href="mailto:nicoguarin@gmail.com"&gt;Nicolás Guarín-Zapata&lt;/a&gt; 
&lt;a rel="license" href="http://creativecommons.org/licenses/by/4.0/"&gt;
&lt;img alt="Creative Commons License"
style="border-width:0"
src="https://i.creativecommons.org/l/by/4.0/88x31.png"&gt;&lt;/a&gt;</copyright><lastBuildDate>Wed, 02 Nov 2022 17:08:34 GMT</lastBuildDate><generator>Nikola (getnikola.com)</generator><docs>http://blogs.law.harvard.edu/tech/rss</docs><item><title>Coming back to the Boundary element method</title><link>https://nicoguaro.github.io/posts/bem_corrected/</link><dc:creator>Nicolás Guarín-Zapata</dc:creator><description>&lt;p&gt;During October (2017) I wrote a program per day for some well-known numerical
methods in both Python and Julia. It was intended to be an exercise to learn
some Julia. You can see a &lt;a class="reference external" href="https://nicoguaro.github.io/posts/numerical_summary"&gt;summary here&lt;/a&gt;. I succeeded
in 30 of the challenges, except for the BEM
(&lt;a class="reference external" href="https://en.wikipedia.org/wiki/Boundary_element_method"&gt;Boundary Element Method&lt;/a&gt;),
where I could not figure out what was wrong that day. The original
post is &lt;a class="reference external" href="https://nicoguaro.github.io/posts/numerical-26"&gt;here&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Thomas Klimpel found the mistake and wrote an email where he described my
mistakes. So, I am creating a new post with a correct implementation
of the BEM.&lt;/p&gt;
&lt;section id="the-boundary-element-method"&gt;
&lt;h2&gt;The Boundary Element Method&lt;/h2&gt;
&lt;p&gt;We want so solve the equation&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
\nabla^2 u = -f(x, y)\quad \forall (x, y) \in \Omega\, ,
\end{equation*}
&lt;/div&gt;
&lt;p&gt;with&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
u(x) = g(x, y), \quad \forall (x, y)\in \partial \Omega \, .
\end{equation*}
&lt;/div&gt;
&lt;p&gt;For this method, we need to use an integral representation of the equation,
that, in this case, is&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
u(\boldsymbol{\xi})  = \int_{S} [u(\mathbf{x}) F(\mathbf{x}, \boldsymbol{\xi})
    - q(\mathbf{x})G(\mathbf{x}, \boldsymbol{\xi})]\mathrm{d}S(\mathbf{x})
    + \int_{V} f(\mathbf{x}) G(\mathbf{x}, \boldsymbol{\xi}) \mathrm{d}V(\mathbf{x})
\end{equation*}
&lt;/div&gt;
&lt;p&gt;with&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
G(\mathbf{x}, \boldsymbol{\xi})= -\frac{1}{2\pi}\ln|\mathbf{x} - \xi|
\end{equation*}
&lt;/div&gt;
&lt;p&gt;and&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
F(\mathbf{x}, \boldsymbol{\xi}) =
  -\frac{1}{2\pi |\mathbf{x} - \boldsymbol{\xi}|^2}
  (\mathbf{x} - \boldsymbol{\xi})\cdot\hat{\mathbf{n}}
\end{equation*}
&lt;/div&gt;
&lt;p&gt;Then, we can form a system of equations&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
[G]\{q\} = [F]\{u\}\, ,
\end{equation*}
&lt;/div&gt;
&lt;p&gt;that we obtain by discretization of the boundary. If we take constant
variables over the discretization, the integral can be computed analytically
by&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
G_{nm} = -\frac{1}{2\pi}\left[r \sin\theta\left(\ln|r| - 1\right)
         + \theta r\cos\theta\right]^{\theta_B, r_B}_{\theta_A, r_A}
\end{equation*}
&lt;/div&gt;
&lt;p&gt;and&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
F_{nm} = \left[\frac{\theta}{2\pi}\right]^{\theta_B}_{\theta_A}
\end{equation*}
&lt;/div&gt;
&lt;p&gt;for points &lt;span class="math"&gt;\(n\)&lt;/span&gt; and &lt;span class="math"&gt;\(m\)&lt;/span&gt; in different elements, and the subindices
&lt;span class="math"&gt;\(A,B\)&lt;/span&gt; refer to the endpoints of the evaluation element. We should be
careful evaluating this expression since both &lt;span class="math"&gt;\(r_A\)&lt;/span&gt; and &lt;span class="math"&gt;\(r_B\)&lt;/span&gt; can
be (close to) zero and make it &lt;em&gt;explode&lt;/em&gt;. Also, here it was the main problem
since I forgot to compute the angles with respect to elements that are,
in general, not aligned with horizontal or vertical axes.&lt;/p&gt;
&lt;p&gt;For diagonal terms the integrals evaluate to&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
G_{nn} = -\frac{L}{2\pi}\left(\ln\left\vert\frac{L}{2}\right\vert - 1\right)
\end{equation*}
&lt;/div&gt;
&lt;p&gt;and&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
F_{nn} = - \frac{1}{2}
\end{equation*}
&lt;/div&gt;
&lt;p&gt;with &lt;span class="math"&gt;\(L\)&lt;/span&gt; the size of the element.&lt;/p&gt;
&lt;p&gt;Following is the code. Keep in mind that this code works for purely Dirichlet
problems. For mixed Dirichlet-Neumann the influence matrices would need
rearranging to separate known and unknowns in opposite sides of the equation.&lt;/p&gt;
&lt;p&gt;You can download the files for this &lt;a class="reference external" href="https://nicoguaro.github.io/downloads/bem.zip"&gt;project here&lt;/a&gt;.
It includes a YML file to create a conda environment with the dependencies
listed. For example, it uses version 3.0 of
&lt;a class="reference external" href="https://github.com/nschloe/meshio"&gt;Meshio&lt;/a&gt;.&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code python"&gt;&lt;a id="rest_code_a577aa810ae846448f91c3de11d571fd-1" name="rest_code_a577aa810ae846448f91c3de11d571fd-1" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_a577aa810ae846448f91c3de11d571fd-1"&gt;&lt;/a&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;numpy&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;np&lt;/span&gt;
&lt;a id="rest_code_a577aa810ae846448f91c3de11d571fd-2" name="rest_code_a577aa810ae846448f91c3de11d571fd-2" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_a577aa810ae846448f91c3de11d571fd-2"&gt;&lt;/a&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;numpy&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;log&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;arctan2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;pi&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;mean&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;arctan&lt;/span&gt;
&lt;a id="rest_code_a577aa810ae846448f91c3de11d571fd-3" name="rest_code_a577aa810ae846448f91c3de11d571fd-3" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_a577aa810ae846448f91c3de11d571fd-3"&gt;&lt;/a&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;numpy.linalg&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;norm&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;solve&lt;/span&gt;
&lt;a id="rest_code_a577aa810ae846448f91c3de11d571fd-4" name="rest_code_a577aa810ae846448f91c3de11d571fd-4" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_a577aa810ae846448f91c3de11d571fd-4"&gt;&lt;/a&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;matplotlib.pyplot&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;plt&lt;/span&gt;
&lt;a id="rest_code_a577aa810ae846448f91c3de11d571fd-5" name="rest_code_a577aa810ae846448f91c3de11d571fd-5" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_a577aa810ae846448f91c3de11d571fd-5"&gt;&lt;/a&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;mpl_toolkits.mplot3d&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;Axes3D&lt;/span&gt;
&lt;a id="rest_code_a577aa810ae846448f91c3de11d571fd-6" name="rest_code_a577aa810ae846448f91c3de11d571fd-6" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_a577aa810ae846448f91c3de11d571fd-6"&gt;&lt;/a&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;meshio&lt;/span&gt;
&lt;a id="rest_code_a577aa810ae846448f91c3de11d571fd-7" name="rest_code_a577aa810ae846448f91c3de11d571fd-7" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_a577aa810ae846448f91c3de11d571fd-7"&gt;&lt;/a&gt;
&lt;a id="rest_code_a577aa810ae846448f91c3de11d571fd-8" name="rest_code_a577aa810ae846448f91c3de11d571fd-8" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_a577aa810ae846448f91c3de11d571fd-8"&gt;&lt;/a&gt;
&lt;a id="rest_code_a577aa810ae846448f91c3de11d571fd-9" name="rest_code_a577aa810ae846448f91c3de11d571fd-9" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_a577aa810ae846448f91c3de11d571fd-9"&gt;&lt;/a&gt;  &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;assem&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;elems&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_a577aa810ae846448f91c3de11d571fd-10" name="rest_code_a577aa810ae846448f91c3de11d571fd-10" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_a577aa810ae846448f91c3de11d571fd-10"&gt;&lt;/a&gt;      &lt;span class="sd"&gt;"""Assembly matrices for the BEM problem&lt;/span&gt;
&lt;a id="rest_code_a577aa810ae846448f91c3de11d571fd-11" name="rest_code_a577aa810ae846448f91c3de11d571fd-11" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_a577aa810ae846448f91c3de11d571fd-11"&gt;&lt;/a&gt;
&lt;a id="rest_code_a577aa810ae846448f91c3de11d571fd-12" name="rest_code_a577aa810ae846448f91c3de11d571fd-12" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_a577aa810ae846448f91c3de11d571fd-12"&gt;&lt;/a&gt;&lt;span class="sd"&gt;      Parameters&lt;/span&gt;
&lt;a id="rest_code_a577aa810ae846448f91c3de11d571fd-13" name="rest_code_a577aa810ae846448f91c3de11d571fd-13" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_a577aa810ae846448f91c3de11d571fd-13"&gt;&lt;/a&gt;&lt;span class="sd"&gt;      ----------&lt;/span&gt;
&lt;a id="rest_code_a577aa810ae846448f91c3de11d571fd-14" name="rest_code_a577aa810ae846448f91c3de11d571fd-14" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_a577aa810ae846448f91c3de11d571fd-14"&gt;&lt;/a&gt;&lt;span class="sd"&gt;      coords : ndarray, float&lt;/span&gt;
&lt;a id="rest_code_a577aa810ae846448f91c3de11d571fd-15" name="rest_code_a577aa810ae846448f91c3de11d571fd-15" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_a577aa810ae846448f91c3de11d571fd-15"&gt;&lt;/a&gt;&lt;span class="sd"&gt;          Coordinates for the nodes.&lt;/span&gt;
&lt;a id="rest_code_a577aa810ae846448f91c3de11d571fd-16" name="rest_code_a577aa810ae846448f91c3de11d571fd-16" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_a577aa810ae846448f91c3de11d571fd-16"&gt;&lt;/a&gt;&lt;span class="sd"&gt;      elems : ndarray, int&lt;/span&gt;
&lt;a id="rest_code_a577aa810ae846448f91c3de11d571fd-17" name="rest_code_a577aa810ae846448f91c3de11d571fd-17" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_a577aa810ae846448f91c3de11d571fd-17"&gt;&lt;/a&gt;&lt;span class="sd"&gt;          Connectivity for the elements.&lt;/span&gt;
&lt;a id="rest_code_a577aa810ae846448f91c3de11d571fd-18" name="rest_code_a577aa810ae846448f91c3de11d571fd-18" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_a577aa810ae846448f91c3de11d571fd-18"&gt;&lt;/a&gt;
&lt;a id="rest_code_a577aa810ae846448f91c3de11d571fd-19" name="rest_code_a577aa810ae846448f91c3de11d571fd-19" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_a577aa810ae846448f91c3de11d571fd-19"&gt;&lt;/a&gt;&lt;span class="sd"&gt;      Returns&lt;/span&gt;
&lt;a id="rest_code_a577aa810ae846448f91c3de11d571fd-20" name="rest_code_a577aa810ae846448f91c3de11d571fd-20" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_a577aa810ae846448f91c3de11d571fd-20"&gt;&lt;/a&gt;&lt;span class="sd"&gt;      -------&lt;/span&gt;
&lt;a id="rest_code_a577aa810ae846448f91c3de11d571fd-21" name="rest_code_a577aa810ae846448f91c3de11d571fd-21" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_a577aa810ae846448f91c3de11d571fd-21"&gt;&lt;/a&gt;&lt;span class="sd"&gt;      Gmat : ndarray, float&lt;/span&gt;
&lt;a id="rest_code_a577aa810ae846448f91c3de11d571fd-22" name="rest_code_a577aa810ae846448f91c3de11d571fd-22" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_a577aa810ae846448f91c3de11d571fd-22"&gt;&lt;/a&gt;&lt;span class="sd"&gt;          Influence matrix for the flow.&lt;/span&gt;
&lt;a id="rest_code_a577aa810ae846448f91c3de11d571fd-23" name="rest_code_a577aa810ae846448f91c3de11d571fd-23" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_a577aa810ae846448f91c3de11d571fd-23"&gt;&lt;/a&gt;&lt;span class="sd"&gt;      Fmat : ndarray, float&lt;/span&gt;
&lt;a id="rest_code_a577aa810ae846448f91c3de11d571fd-24" name="rest_code_a577aa810ae846448f91c3de11d571fd-24" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_a577aa810ae846448f91c3de11d571fd-24"&gt;&lt;/a&gt;&lt;span class="sd"&gt;          Influence matrix for primary variable.&lt;/span&gt;
&lt;a id="rest_code_a577aa810ae846448f91c3de11d571fd-25" name="rest_code_a577aa810ae846448f91c3de11d571fd-25" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_a577aa810ae846448f91c3de11d571fd-25"&gt;&lt;/a&gt;&lt;span class="sd"&gt;      """&lt;/span&gt;
&lt;a id="rest_code_a577aa810ae846448f91c3de11d571fd-26" name="rest_code_a577aa810ae846448f91c3de11d571fd-26" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_a577aa810ae846448f91c3de11d571fd-26"&gt;&lt;/a&gt;      &lt;span class="n"&gt;nelems&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;elems&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;shape&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_a577aa810ae846448f91c3de11d571fd-27" name="rest_code_a577aa810ae846448f91c3de11d571fd-27" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_a577aa810ae846448f91c3de11d571fd-27"&gt;&lt;/a&gt;      &lt;span class="n"&gt;Gmat&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="n"&gt;nelems&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;nelems&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_a577aa810ae846448f91c3de11d571fd-28" name="rest_code_a577aa810ae846448f91c3de11d571fd-28" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_a577aa810ae846448f91c3de11d571fd-28"&gt;&lt;/a&gt;      &lt;span class="n"&gt;Fmat&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="n"&gt;nelems&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;nelems&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_a577aa810ae846448f91c3de11d571fd-29" name="rest_code_a577aa810ae846448f91c3de11d571fd-29" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_a577aa810ae846448f91c3de11d571fd-29"&gt;&lt;/a&gt;      &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;ev_cont&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;elem1&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;enumerate&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;elems&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_a577aa810ae846448f91c3de11d571fd-30" name="rest_code_a577aa810ae846448f91c3de11d571fd-30" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_a577aa810ae846448f91c3de11d571fd-30"&gt;&lt;/a&gt;          &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;col_cont&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;elem2&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;enumerate&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;elems&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_a577aa810ae846448f91c3de11d571fd-31" name="rest_code_a577aa810ae846448f91c3de11d571fd-31" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_a577aa810ae846448f91c3de11d571fd-31"&gt;&lt;/a&gt;              &lt;span class="n"&gt;pt_col&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;mean&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;elem2&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;axis&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_a577aa810ae846448f91c3de11d571fd-32" name="rest_code_a577aa810ae846448f91c3de11d571fd-32" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_a577aa810ae846448f91c3de11d571fd-32"&gt;&lt;/a&gt;              &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;ev_cont&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="n"&gt;col_cont&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a id="rest_code_a577aa810ae846448f91c3de11d571fd-33" name="rest_code_a577aa810ae846448f91c3de11d571fd-33" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_a577aa810ae846448f91c3de11d571fd-33"&gt;&lt;/a&gt;                  &lt;span class="n"&gt;L&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;norm&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;elem1&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]]&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;elem1&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]])&lt;/span&gt;
&lt;a id="rest_code_a577aa810ae846448f91c3de11d571fd-34" name="rest_code_a577aa810ae846448f91c3de11d571fd-34" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_a577aa810ae846448f91c3de11d571fd-34"&gt;&lt;/a&gt;                  &lt;span class="n"&gt;Gmat&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ev_cont&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;ev_cont&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;L&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;pi&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;log&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;L&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_a577aa810ae846448f91c3de11d571fd-35" name="rest_code_a577aa810ae846448f91c3de11d571fd-35" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_a577aa810ae846448f91c3de11d571fd-35"&gt;&lt;/a&gt;                  &lt;span class="n"&gt;Fmat&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ev_cont&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;ev_cont&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="mf"&gt;0.5&lt;/span&gt;
&lt;a id="rest_code_a577aa810ae846448f91c3de11d571fd-36" name="rest_code_a577aa810ae846448f91c3de11d571fd-36" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_a577aa810ae846448f91c3de11d571fd-36"&gt;&lt;/a&gt;              &lt;span class="k"&gt;else&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a id="rest_code_a577aa810ae846448f91c3de11d571fd-37" name="rest_code_a577aa810ae846448f91c3de11d571fd-37" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_a577aa810ae846448f91c3de11d571fd-37"&gt;&lt;/a&gt;                  &lt;span class="n"&gt;Gij&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;Fij&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;influence_coeff&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;elem1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;pt_col&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_a577aa810ae846448f91c3de11d571fd-38" name="rest_code_a577aa810ae846448f91c3de11d571fd-38" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_a577aa810ae846448f91c3de11d571fd-38"&gt;&lt;/a&gt;                  &lt;span class="n"&gt;Gmat&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ev_cont&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;col_cont&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Gij&lt;/span&gt;
&lt;a id="rest_code_a577aa810ae846448f91c3de11d571fd-39" name="rest_code_a577aa810ae846448f91c3de11d571fd-39" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_a577aa810ae846448f91c3de11d571fd-39"&gt;&lt;/a&gt;                  &lt;span class="n"&gt;Fmat&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ev_cont&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;col_cont&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Fij&lt;/span&gt;
&lt;a id="rest_code_a577aa810ae846448f91c3de11d571fd-40" name="rest_code_a577aa810ae846448f91c3de11d571fd-40" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_a577aa810ae846448f91c3de11d571fd-40"&gt;&lt;/a&gt;      &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;Gmat&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;Fmat&lt;/span&gt;
&lt;a id="rest_code_a577aa810ae846448f91c3de11d571fd-41" name="rest_code_a577aa810ae846448f91c3de11d571fd-41" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_a577aa810ae846448f91c3de11d571fd-41"&gt;&lt;/a&gt;
&lt;a id="rest_code_a577aa810ae846448f91c3de11d571fd-42" name="rest_code_a577aa810ae846448f91c3de11d571fd-42" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_a577aa810ae846448f91c3de11d571fd-42"&gt;&lt;/a&gt;
&lt;a id="rest_code_a577aa810ae846448f91c3de11d571fd-43" name="rest_code_a577aa810ae846448f91c3de11d571fd-43" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_a577aa810ae846448f91c3de11d571fd-43"&gt;&lt;/a&gt;  &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;influence_coeff&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;elem&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;pt_col&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_a577aa810ae846448f91c3de11d571fd-44" name="rest_code_a577aa810ae846448f91c3de11d571fd-44" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_a577aa810ae846448f91c3de11d571fd-44"&gt;&lt;/a&gt;      &lt;span class="sd"&gt;"""Compute influence coefficients&lt;/span&gt;
&lt;a id="rest_code_a577aa810ae846448f91c3de11d571fd-45" name="rest_code_a577aa810ae846448f91c3de11d571fd-45" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_a577aa810ae846448f91c3de11d571fd-45"&gt;&lt;/a&gt;
&lt;a id="rest_code_a577aa810ae846448f91c3de11d571fd-46" name="rest_code_a577aa810ae846448f91c3de11d571fd-46" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_a577aa810ae846448f91c3de11d571fd-46"&gt;&lt;/a&gt;&lt;span class="sd"&gt;      Parameters&lt;/span&gt;
&lt;a id="rest_code_a577aa810ae846448f91c3de11d571fd-47" name="rest_code_a577aa810ae846448f91c3de11d571fd-47" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_a577aa810ae846448f91c3de11d571fd-47"&gt;&lt;/a&gt;&lt;span class="sd"&gt;      ----------&lt;/span&gt;
&lt;a id="rest_code_a577aa810ae846448f91c3de11d571fd-48" name="rest_code_a577aa810ae846448f91c3de11d571fd-48" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_a577aa810ae846448f91c3de11d571fd-48"&gt;&lt;/a&gt;&lt;span class="sd"&gt;      elems : ndarray, int&lt;/span&gt;
&lt;a id="rest_code_a577aa810ae846448f91c3de11d571fd-49" name="rest_code_a577aa810ae846448f91c3de11d571fd-49" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_a577aa810ae846448f91c3de11d571fd-49"&gt;&lt;/a&gt;&lt;span class="sd"&gt;          Connectivity for the elements.&lt;/span&gt;
&lt;a id="rest_code_a577aa810ae846448f91c3de11d571fd-50" name="rest_code_a577aa810ae846448f91c3de11d571fd-50" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_a577aa810ae846448f91c3de11d571fd-50"&gt;&lt;/a&gt;&lt;span class="sd"&gt;      coords : ndarray, float&lt;/span&gt;
&lt;a id="rest_code_a577aa810ae846448f91c3de11d571fd-51" name="rest_code_a577aa810ae846448f91c3de11d571fd-51" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_a577aa810ae846448f91c3de11d571fd-51"&gt;&lt;/a&gt;&lt;span class="sd"&gt;          Coordinates for the nodes.&lt;/span&gt;
&lt;a id="rest_code_a577aa810ae846448f91c3de11d571fd-52" name="rest_code_a577aa810ae846448f91c3de11d571fd-52" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_a577aa810ae846448f91c3de11d571fd-52"&gt;&lt;/a&gt;&lt;span class="sd"&gt;      pt_col : ndarray&lt;/span&gt;
&lt;a id="rest_code_a577aa810ae846448f91c3de11d571fd-53" name="rest_code_a577aa810ae846448f91c3de11d571fd-53" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_a577aa810ae846448f91c3de11d571fd-53"&gt;&lt;/a&gt;&lt;span class="sd"&gt;          Coordinates of the colocation point.&lt;/span&gt;
&lt;a id="rest_code_a577aa810ae846448f91c3de11d571fd-54" name="rest_code_a577aa810ae846448f91c3de11d571fd-54" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_a577aa810ae846448f91c3de11d571fd-54"&gt;&lt;/a&gt;
&lt;a id="rest_code_a577aa810ae846448f91c3de11d571fd-55" name="rest_code_a577aa810ae846448f91c3de11d571fd-55" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_a577aa810ae846448f91c3de11d571fd-55"&gt;&lt;/a&gt;&lt;span class="sd"&gt;      Returns&lt;/span&gt;
&lt;a id="rest_code_a577aa810ae846448f91c3de11d571fd-56" name="rest_code_a577aa810ae846448f91c3de11d571fd-56" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_a577aa810ae846448f91c3de11d571fd-56"&gt;&lt;/a&gt;&lt;span class="sd"&gt;      -------&lt;/span&gt;
&lt;a id="rest_code_a577aa810ae846448f91c3de11d571fd-57" name="rest_code_a577aa810ae846448f91c3de11d571fd-57" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_a577aa810ae846448f91c3de11d571fd-57"&gt;&lt;/a&gt;&lt;span class="sd"&gt;      G_coeff : float&lt;/span&gt;
&lt;a id="rest_code_a577aa810ae846448f91c3de11d571fd-58" name="rest_code_a577aa810ae846448f91c3de11d571fd-58" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_a577aa810ae846448f91c3de11d571fd-58"&gt;&lt;/a&gt;&lt;span class="sd"&gt;          Influence coefficient for flows.&lt;/span&gt;
&lt;a id="rest_code_a577aa810ae846448f91c3de11d571fd-59" name="rest_code_a577aa810ae846448f91c3de11d571fd-59" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_a577aa810ae846448f91c3de11d571fd-59"&gt;&lt;/a&gt;&lt;span class="sd"&gt;      F_coeff : float&lt;/span&gt;
&lt;a id="rest_code_a577aa810ae846448f91c3de11d571fd-60" name="rest_code_a577aa810ae846448f91c3de11d571fd-60" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_a577aa810ae846448f91c3de11d571fd-60"&gt;&lt;/a&gt;&lt;span class="sd"&gt;          Influence coefficient for primary variable.&lt;/span&gt;
&lt;a id="rest_code_a577aa810ae846448f91c3de11d571fd-61" name="rest_code_a577aa810ae846448f91c3de11d571fd-61" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_a577aa810ae846448f91c3de11d571fd-61"&gt;&lt;/a&gt;&lt;span class="sd"&gt;      """&lt;/span&gt;
&lt;a id="rest_code_a577aa810ae846448f91c3de11d571fd-62" name="rest_code_a577aa810ae846448f91c3de11d571fd-62" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_a577aa810ae846448f91c3de11d571fd-62"&gt;&lt;/a&gt;      &lt;span class="n"&gt;dcos&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;elem&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]]&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;elem&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]]&lt;/span&gt;
&lt;a id="rest_code_a577aa810ae846448f91c3de11d571fd-63" name="rest_code_a577aa810ae846448f91c3de11d571fd-63" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_a577aa810ae846448f91c3de11d571fd-63"&gt;&lt;/a&gt;      &lt;span class="n"&gt;dcos&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;dcos&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="n"&gt;norm&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;dcos&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_a577aa810ae846448f91c3de11d571fd-64" name="rest_code_a577aa810ae846448f91c3de11d571fd-64" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_a577aa810ae846448f91c3de11d571fd-64"&gt;&lt;/a&gt;      &lt;span class="n"&gt;rotmat&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;([[&lt;/span&gt;&lt;span class="n"&gt;dcos&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;dcos&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]],&lt;/span&gt;
&lt;a id="rest_code_a577aa810ae846448f91c3de11d571fd-65" name="rest_code_a577aa810ae846448f91c3de11d571fd-65" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_a577aa810ae846448f91c3de11d571fd-65"&gt;&lt;/a&gt;                      &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;dcos&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;dcos&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]]])&lt;/span&gt;
&lt;a id="rest_code_a577aa810ae846448f91c3de11d571fd-66" name="rest_code_a577aa810ae846448f91c3de11d571fd-66" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_a577aa810ae846448f91c3de11d571fd-66"&gt;&lt;/a&gt;      &lt;span class="n"&gt;r_A&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;rotmat&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;dot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;elem&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]]&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;pt_col&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_a577aa810ae846448f91c3de11d571fd-67" name="rest_code_a577aa810ae846448f91c3de11d571fd-67" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_a577aa810ae846448f91c3de11d571fd-67"&gt;&lt;/a&gt;      &lt;span class="n"&gt;r_B&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;rotmat&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;dot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;elem&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]]&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;pt_col&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_a577aa810ae846448f91c3de11d571fd-68" name="rest_code_a577aa810ae846448f91c3de11d571fd-68" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_a577aa810ae846448f91c3de11d571fd-68"&gt;&lt;/a&gt;      &lt;span class="n"&gt;theta_A&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;arctan2&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;r_A&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;r_A&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_a577aa810ae846448f91c3de11d571fd-69" name="rest_code_a577aa810ae846448f91c3de11d571fd-69" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_a577aa810ae846448f91c3de11d571fd-69"&gt;&lt;/a&gt;      &lt;span class="n"&gt;theta_B&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;arctan2&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;r_B&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;r_B&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_a577aa810ae846448f91c3de11d571fd-70" name="rest_code_a577aa810ae846448f91c3de11d571fd-70" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_a577aa810ae846448f91c3de11d571fd-70"&gt;&lt;/a&gt;      &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;norm&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;r_A&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="mf"&gt;1e-6&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a id="rest_code_a577aa810ae846448f91c3de11d571fd-71" name="rest_code_a577aa810ae846448f91c3de11d571fd-71" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_a577aa810ae846448f91c3de11d571fd-71"&gt;&lt;/a&gt;          &lt;span class="n"&gt;G_coeff&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;r_B&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;log&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;norm&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;r_B&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;theta_B&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;r_B&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_a577aa810ae846448f91c3de11d571fd-72" name="rest_code_a577aa810ae846448f91c3de11d571fd-72" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_a577aa810ae846448f91c3de11d571fd-72"&gt;&lt;/a&gt;      &lt;span class="k"&gt;elif&lt;/span&gt; &lt;span class="n"&gt;norm&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;r_B&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="mf"&gt;1e-6&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a id="rest_code_a577aa810ae846448f91c3de11d571fd-73" name="rest_code_a577aa810ae846448f91c3de11d571fd-73" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_a577aa810ae846448f91c3de11d571fd-73"&gt;&lt;/a&gt;          &lt;span class="n"&gt;G_coeff&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;r_A&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;log&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;norm&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;r_A&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;theta_A&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;r_A&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_a577aa810ae846448f91c3de11d571fd-74" name="rest_code_a577aa810ae846448f91c3de11d571fd-74" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_a577aa810ae846448f91c3de11d571fd-74"&gt;&lt;/a&gt;      &lt;span class="k"&gt;else&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a id="rest_code_a577aa810ae846448f91c3de11d571fd-75" name="rest_code_a577aa810ae846448f91c3de11d571fd-75" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_a577aa810ae846448f91c3de11d571fd-75"&gt;&lt;/a&gt;          &lt;span class="n"&gt;G_coeff&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;r_B&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;log&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;norm&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;r_B&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;theta_B&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;r_B&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;\
&lt;a id="rest_code_a577aa810ae846448f91c3de11d571fd-76" name="rest_code_a577aa810ae846448f91c3de11d571fd-76" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_a577aa810ae846448f91c3de11d571fd-76"&gt;&lt;/a&gt;                  &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;r_A&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;log&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;norm&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;r_A&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;theta_A&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;r_A&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_a577aa810ae846448f91c3de11d571fd-77" name="rest_code_a577aa810ae846448f91c3de11d571fd-77" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_a577aa810ae846448f91c3de11d571fd-77"&gt;&lt;/a&gt;      &lt;span class="n"&gt;F_coeff&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;theta_B&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;theta_A&lt;/span&gt;
&lt;a id="rest_code_a577aa810ae846448f91c3de11d571fd-78" name="rest_code_a577aa810ae846448f91c3de11d571fd-78" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_a577aa810ae846448f91c3de11d571fd-78"&gt;&lt;/a&gt;      &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;G_coeff&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;pi&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;F_coeff&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;pi&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_a577aa810ae846448f91c3de11d571fd-79" name="rest_code_a577aa810ae846448f91c3de11d571fd-79" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_a577aa810ae846448f91c3de11d571fd-79"&gt;&lt;/a&gt;
&lt;a id="rest_code_a577aa810ae846448f91c3de11d571fd-80" name="rest_code_a577aa810ae846448f91c3de11d571fd-80" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_a577aa810ae846448f91c3de11d571fd-80"&gt;&lt;/a&gt;
&lt;a id="rest_code_a577aa810ae846448f91c3de11d571fd-81" name="rest_code_a577aa810ae846448f91c3de11d571fd-81" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_a577aa810ae846448f91c3de11d571fd-81"&gt;&lt;/a&gt;  &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;eval_sol&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ev_coords&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;elems&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;u_boundary&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;q_boundary&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_a577aa810ae846448f91c3de11d571fd-82" name="rest_code_a577aa810ae846448f91c3de11d571fd-82" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_a577aa810ae846448f91c3de11d571fd-82"&gt;&lt;/a&gt;      &lt;span class="sd"&gt;"""Evaluate the solution in a set of points&lt;/span&gt;
&lt;a id="rest_code_a577aa810ae846448f91c3de11d571fd-83" name="rest_code_a577aa810ae846448f91c3de11d571fd-83" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_a577aa810ae846448f91c3de11d571fd-83"&gt;&lt;/a&gt;
&lt;a id="rest_code_a577aa810ae846448f91c3de11d571fd-84" name="rest_code_a577aa810ae846448f91c3de11d571fd-84" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_a577aa810ae846448f91c3de11d571fd-84"&gt;&lt;/a&gt;&lt;span class="sd"&gt;      Parameters&lt;/span&gt;
&lt;a id="rest_code_a577aa810ae846448f91c3de11d571fd-85" name="rest_code_a577aa810ae846448f91c3de11d571fd-85" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_a577aa810ae846448f91c3de11d571fd-85"&gt;&lt;/a&gt;&lt;span class="sd"&gt;      ----------&lt;/span&gt;
&lt;a id="rest_code_a577aa810ae846448f91c3de11d571fd-86" name="rest_code_a577aa810ae846448f91c3de11d571fd-86" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_a577aa810ae846448f91c3de11d571fd-86"&gt;&lt;/a&gt;&lt;span class="sd"&gt;      ev_coords : ndarray, float&lt;/span&gt;
&lt;a id="rest_code_a577aa810ae846448f91c3de11d571fd-87" name="rest_code_a577aa810ae846448f91c3de11d571fd-87" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_a577aa810ae846448f91c3de11d571fd-87"&gt;&lt;/a&gt;&lt;span class="sd"&gt;          Coordinates of the evaluation points.&lt;/span&gt;
&lt;a id="rest_code_a577aa810ae846448f91c3de11d571fd-88" name="rest_code_a577aa810ae846448f91c3de11d571fd-88" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_a577aa810ae846448f91c3de11d571fd-88"&gt;&lt;/a&gt;&lt;span class="sd"&gt;      coords : ndarray, float&lt;/span&gt;
&lt;a id="rest_code_a577aa810ae846448f91c3de11d571fd-89" name="rest_code_a577aa810ae846448f91c3de11d571fd-89" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_a577aa810ae846448f91c3de11d571fd-89"&gt;&lt;/a&gt;&lt;span class="sd"&gt;          Coordinates for the nodes.&lt;/span&gt;
&lt;a id="rest_code_a577aa810ae846448f91c3de11d571fd-90" name="rest_code_a577aa810ae846448f91c3de11d571fd-90" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_a577aa810ae846448f91c3de11d571fd-90"&gt;&lt;/a&gt;&lt;span class="sd"&gt;      elems : ndarray, int&lt;/span&gt;
&lt;a id="rest_code_a577aa810ae846448f91c3de11d571fd-91" name="rest_code_a577aa810ae846448f91c3de11d571fd-91" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_a577aa810ae846448f91c3de11d571fd-91"&gt;&lt;/a&gt;&lt;span class="sd"&gt;          Connectivity for the elements.&lt;/span&gt;
&lt;a id="rest_code_a577aa810ae846448f91c3de11d571fd-92" name="rest_code_a577aa810ae846448f91c3de11d571fd-92" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_a577aa810ae846448f91c3de11d571fd-92"&gt;&lt;/a&gt;&lt;span class="sd"&gt;      u_boundary : ndarray, float&lt;/span&gt;
&lt;a id="rest_code_a577aa810ae846448f91c3de11d571fd-93" name="rest_code_a577aa810ae846448f91c3de11d571fd-93" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_a577aa810ae846448f91c3de11d571fd-93"&gt;&lt;/a&gt;&lt;span class="sd"&gt;          Primary variable in the nodes.&lt;/span&gt;
&lt;a id="rest_code_a577aa810ae846448f91c3de11d571fd-94" name="rest_code_a577aa810ae846448f91c3de11d571fd-94" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_a577aa810ae846448f91c3de11d571fd-94"&gt;&lt;/a&gt;&lt;span class="sd"&gt;      q_boundary : [type]&lt;/span&gt;
&lt;a id="rest_code_a577aa810ae846448f91c3de11d571fd-95" name="rest_code_a577aa810ae846448f91c3de11d571fd-95" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_a577aa810ae846448f91c3de11d571fd-95"&gt;&lt;/a&gt;&lt;span class="sd"&gt;          Flows in the nodes.&lt;/span&gt;
&lt;a id="rest_code_a577aa810ae846448f91c3de11d571fd-96" name="rest_code_a577aa810ae846448f91c3de11d571fd-96" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_a577aa810ae846448f91c3de11d571fd-96"&gt;&lt;/a&gt;
&lt;a id="rest_code_a577aa810ae846448f91c3de11d571fd-97" name="rest_code_a577aa810ae846448f91c3de11d571fd-97" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_a577aa810ae846448f91c3de11d571fd-97"&gt;&lt;/a&gt;&lt;span class="sd"&gt;      Returns&lt;/span&gt;
&lt;a id="rest_code_a577aa810ae846448f91c3de11d571fd-98" name="rest_code_a577aa810ae846448f91c3de11d571fd-98" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_a577aa810ae846448f91c3de11d571fd-98"&gt;&lt;/a&gt;&lt;span class="sd"&gt;      -------&lt;/span&gt;
&lt;a id="rest_code_a577aa810ae846448f91c3de11d571fd-99" name="rest_code_a577aa810ae846448f91c3de11d571fd-99" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_a577aa810ae846448f91c3de11d571fd-99"&gt;&lt;/a&gt;&lt;span class="sd"&gt;      solution : ndarray, float&lt;/span&gt;
&lt;a id="rest_code_a577aa810ae846448f91c3de11d571fd-100" name="rest_code_a577aa810ae846448f91c3de11d571fd-100" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_a577aa810ae846448f91c3de11d571fd-100"&gt;&lt;/a&gt;&lt;span class="sd"&gt;          Solution evaluated in the given points.&lt;/span&gt;
&lt;a id="rest_code_a577aa810ae846448f91c3de11d571fd-101" name="rest_code_a577aa810ae846448f91c3de11d571fd-101" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_a577aa810ae846448f91c3de11d571fd-101"&gt;&lt;/a&gt;&lt;span class="sd"&gt;      """&lt;/span&gt;
&lt;a id="rest_code_a577aa810ae846448f91c3de11d571fd-102" name="rest_code_a577aa810ae846448f91c3de11d571fd-102" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_a577aa810ae846448f91c3de11d571fd-102"&gt;&lt;/a&gt;      &lt;span class="n"&gt;npts&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;ev_coords&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;shape&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_a577aa810ae846448f91c3de11d571fd-103" name="rest_code_a577aa810ae846448f91c3de11d571fd-103" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_a577aa810ae846448f91c3de11d571fd-103"&gt;&lt;/a&gt;      &lt;span class="n"&gt;solution&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;npts&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_a577aa810ae846448f91c3de11d571fd-104" name="rest_code_a577aa810ae846448f91c3de11d571fd-104" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_a577aa810ae846448f91c3de11d571fd-104"&gt;&lt;/a&gt;      &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;k&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;npts&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_a577aa810ae846448f91c3de11d571fd-105" name="rest_code_a577aa810ae846448f91c3de11d571fd-105" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_a577aa810ae846448f91c3de11d571fd-105"&gt;&lt;/a&gt;          &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;ev_cont&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;elem&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;enumerate&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;elems&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_a577aa810ae846448f91c3de11d571fd-106" name="rest_code_a577aa810ae846448f91c3de11d571fd-106" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_a577aa810ae846448f91c3de11d571fd-106"&gt;&lt;/a&gt;              &lt;span class="n"&gt;pt_col&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;ev_coords&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;k&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_a577aa810ae846448f91c3de11d571fd-107" name="rest_code_a577aa810ae846448f91c3de11d571fd-107" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_a577aa810ae846448f91c3de11d571fd-107"&gt;&lt;/a&gt;              &lt;span class="n"&gt;G&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;F&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;influence_coeff&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;elem&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;pt_col&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_a577aa810ae846448f91c3de11d571fd-108" name="rest_code_a577aa810ae846448f91c3de11d571fd-108" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_a577aa810ae846448f91c3de11d571fd-108"&gt;&lt;/a&gt;              &lt;span class="n"&gt;solution&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;k&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;+=&lt;/span&gt; &lt;span class="n"&gt;u_boundary&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ev_cont&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;F&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;q_boundary&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ev_cont&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;G&lt;/span&gt;
&lt;a id="rest_code_a577aa810ae846448f91c3de11d571fd-109" name="rest_code_a577aa810ae846448f91c3de11d571fd-109" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_a577aa810ae846448f91c3de11d571fd-109"&gt;&lt;/a&gt;      &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;solution&lt;/span&gt;
&lt;a id="rest_code_a577aa810ae846448f91c3de11d571fd-110" name="rest_code_a577aa810ae846448f91c3de11d571fd-110" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_a577aa810ae846448f91c3de11d571fd-110"&gt;&lt;/a&gt;
&lt;a id="rest_code_a577aa810ae846448f91c3de11d571fd-111" name="rest_code_a577aa810ae846448f91c3de11d571fd-111" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_a577aa810ae846448f91c3de11d571fd-111"&gt;&lt;/a&gt;
&lt;a id="rest_code_a577aa810ae846448f91c3de11d571fd-112" name="rest_code_a577aa810ae846448f91c3de11d571fd-112" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_a577aa810ae846448f91c3de11d571fd-112"&gt;&lt;/a&gt;&lt;span class="c1"&gt;#%% Simulation&lt;/span&gt;
&lt;a id="rest_code_a577aa810ae846448f91c3de11d571fd-113" name="rest_code_a577aa810ae846448f91c3de11d571fd-113" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_a577aa810ae846448f91c3de11d571fd-113"&gt;&lt;/a&gt;&lt;span class="n"&gt;mesh&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;meshio&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;read&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"disk.msh"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_a577aa810ae846448f91c3de11d571fd-114" name="rest_code_a577aa810ae846448f91c3de11d571fd-114" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_a577aa810ae846448f91c3de11d571fd-114"&gt;&lt;/a&gt;&lt;span class="n"&gt;elems&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;mesh&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;cells&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;"line"&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_a577aa810ae846448f91c3de11d571fd-115" name="rest_code_a577aa810ae846448f91c3de11d571fd-115" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_a577aa810ae846448f91c3de11d571fd-115"&gt;&lt;/a&gt;&lt;span class="n"&gt;bound_nodes&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;list&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;set&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;elems&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;flatten&lt;/span&gt;&lt;span class="p"&gt;()))&lt;/span&gt;
&lt;a id="rest_code_a577aa810ae846448f91c3de11d571fd-116" name="rest_code_a577aa810ae846448f91c3de11d571fd-116" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_a577aa810ae846448f91c3de11d571fd-116"&gt;&lt;/a&gt;&lt;span class="n"&gt;coords&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;mesh&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;points&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;bound_nodes&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_a577aa810ae846448f91c3de11d571fd-117" name="rest_code_a577aa810ae846448f91c3de11d571fd-117" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_a577aa810ae846448f91c3de11d571fd-117"&gt;&lt;/a&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;y&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;T&lt;/span&gt;
&lt;a id="rest_code_a577aa810ae846448f91c3de11d571fd-118" name="rest_code_a577aa810ae846448f91c3de11d571fd-118" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_a577aa810ae846448f91c3de11d571fd-118"&gt;&lt;/a&gt;&lt;span class="n"&gt;x_m&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;y_m&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;0.5&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;elems&lt;/span&gt;&lt;span class="p"&gt;[:,&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]]&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;elems&lt;/span&gt;&lt;span class="p"&gt;[:,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]])&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;T&lt;/span&gt;
&lt;a id="rest_code_a577aa810ae846448f91c3de11d571fd-119" name="rest_code_a577aa810ae846448f91c3de11d571fd-119" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_a577aa810ae846448f91c3de11d571fd-119"&gt;&lt;/a&gt;&lt;span class="n"&gt;theta&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;arctan2&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;y_m&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;x_m&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_a577aa810ae846448f91c3de11d571fd-120" name="rest_code_a577aa810ae846448f91c3de11d571fd-120" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_a577aa810ae846448f91c3de11d571fd-120"&gt;&lt;/a&gt;&lt;span class="n"&gt;u_boundary&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;cos&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;6&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;theta&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_a577aa810ae846448f91c3de11d571fd-121" name="rest_code_a577aa810ae846448f91c3de11d571fd-121" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_a577aa810ae846448f91c3de11d571fd-121"&gt;&lt;/a&gt;
&lt;a id="rest_code_a577aa810ae846448f91c3de11d571fd-122" name="rest_code_a577aa810ae846448f91c3de11d571fd-122" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_a577aa810ae846448f91c3de11d571fd-122"&gt;&lt;/a&gt;
&lt;a id="rest_code_a577aa810ae846448f91c3de11d571fd-123" name="rest_code_a577aa810ae846448f91c3de11d571fd-123" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_a577aa810ae846448f91c3de11d571fd-123"&gt;&lt;/a&gt;&lt;span class="c1"&gt;#%% Assembly&lt;/span&gt;
&lt;a id="rest_code_a577aa810ae846448f91c3de11d571fd-124" name="rest_code_a577aa810ae846448f91c3de11d571fd-124" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_a577aa810ae846448f91c3de11d571fd-124"&gt;&lt;/a&gt;&lt;span class="n"&gt;Gmat&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;Fmat&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;assem&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;elems&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_a577aa810ae846448f91c3de11d571fd-125" name="rest_code_a577aa810ae846448f91c3de11d571fd-125" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_a577aa810ae846448f91c3de11d571fd-125"&gt;&lt;/a&gt;
&lt;a id="rest_code_a577aa810ae846448f91c3de11d571fd-126" name="rest_code_a577aa810ae846448f91c3de11d571fd-126" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_a577aa810ae846448f91c3de11d571fd-126"&gt;&lt;/a&gt;&lt;span class="c1"&gt;#%% Solution&lt;/span&gt;
&lt;a id="rest_code_a577aa810ae846448f91c3de11d571fd-127" name="rest_code_a577aa810ae846448f91c3de11d571fd-127" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_a577aa810ae846448f91c3de11d571fd-127"&gt;&lt;/a&gt;&lt;span class="n"&gt;q_boundary&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;solve&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Gmat&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;Fmat&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;dot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;u_boundary&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_a577aa810ae846448f91c3de11d571fd-128" name="rest_code_a577aa810ae846448f91c3de11d571fd-128" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_a577aa810ae846448f91c3de11d571fd-128"&gt;&lt;/a&gt;
&lt;a id="rest_code_a577aa810ae846448f91c3de11d571fd-129" name="rest_code_a577aa810ae846448f91c3de11d571fd-129" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_a577aa810ae846448f91c3de11d571fd-129"&gt;&lt;/a&gt;&lt;span class="c1"&gt;#%% Evaluation&lt;/span&gt;
&lt;a id="rest_code_a577aa810ae846448f91c3de11d571fd-130" name="rest_code_a577aa810ae846448f91c3de11d571fd-130" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_a577aa810ae846448f91c3de11d571fd-130"&gt;&lt;/a&gt;&lt;span class="n"&gt;ev_coords&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt;  &lt;span class="n"&gt;mesh&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;points&lt;/span&gt;&lt;span class="p"&gt;[:,&lt;/span&gt; &lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_a577aa810ae846448f91c3de11d571fd-131" name="rest_code_a577aa810ae846448f91c3de11d571fd-131" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_a577aa810ae846448f91c3de11d571fd-131"&gt;&lt;/a&gt;&lt;span class="n"&gt;ev_x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;ev_y&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;ev_coords&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;T&lt;/span&gt;
&lt;a id="rest_code_a577aa810ae846448f91c3de11d571fd-132" name="rest_code_a577aa810ae846448f91c3de11d571fd-132" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_a577aa810ae846448f91c3de11d571fd-132"&gt;&lt;/a&gt;&lt;span class="n"&gt;solution&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;eval_sol&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ev_coords&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;elems&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;u_boundary&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;q_boundary&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_a577aa810ae846448f91c3de11d571fd-133" name="rest_code_a577aa810ae846448f91c3de11d571fd-133" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_a577aa810ae846448f91c3de11d571fd-133"&gt;&lt;/a&gt;
&lt;a id="rest_code_a577aa810ae846448f91c3de11d571fd-134" name="rest_code_a577aa810ae846448f91c3de11d571fd-134" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_a577aa810ae846448f91c3de11d571fd-134"&gt;&lt;/a&gt;&lt;span class="c1"&gt;#%% Visualization&lt;/span&gt;
&lt;a id="rest_code_a577aa810ae846448f91c3de11d571fd-135" name="rest_code_a577aa810ae846448f91c3de11d571fd-135" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_a577aa810ae846448f91c3de11d571fd-135"&gt;&lt;/a&gt;&lt;span class="n"&gt;tris&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;mesh&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;cells&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;"triangle"&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_a577aa810ae846448f91c3de11d571fd-136" name="rest_code_a577aa810ae846448f91c3de11d571fd-136" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_a577aa810ae846448f91c3de11d571fd-136"&gt;&lt;/a&gt;&lt;span class="n"&gt;fig&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;figure&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a id="rest_code_a577aa810ae846448f91c3de11d571fd-137" name="rest_code_a577aa810ae846448f91c3de11d571fd-137" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_a577aa810ae846448f91c3de11d571fd-137"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;fig&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;add_subplot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;111&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;projection&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'3d'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_a577aa810ae846448f91c3de11d571fd-138" name="rest_code_a577aa810ae846448f91c3de11d571fd-138" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_a577aa810ae846448f91c3de11d571fd-138"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;plot_trisurf&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ev_x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;ev_y&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;solution&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;cmap&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;"RdYlBu"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;lw&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mf"&gt;0.3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;a id="rest_code_a577aa810ae846448f91c3de11d571fd-139" name="rest_code_a577aa810ae846448f91c3de11d571fd-139" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_a577aa810ae846448f91c3de11d571fd-139"&gt;&lt;/a&gt;                &lt;span class="n"&gt;edgecolor&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;"#3c3c3c"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_a577aa810ae846448f91c3de11d571fd-140" name="rest_code_a577aa810ae846448f91c3de11d571fd-140" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_a577aa810ae846448f91c3de11d571fd-140"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xticks&lt;/span&gt;&lt;span class="p"&gt;([])&lt;/span&gt;
&lt;a id="rest_code_a577aa810ae846448f91c3de11d571fd-141" name="rest_code_a577aa810ae846448f91c3de11d571fd-141" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_a577aa810ae846448f91c3de11d571fd-141"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;yticks&lt;/span&gt;&lt;span class="p"&gt;([])&lt;/span&gt;
&lt;a id="rest_code_a577aa810ae846448f91c3de11d571fd-142" name="rest_code_a577aa810ae846448f91c3de11d571fd-142" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_a577aa810ae846448f91c3de11d571fd-142"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_zticks&lt;/span&gt;&lt;span class="p"&gt;([])&lt;/span&gt;
&lt;a id="rest_code_a577aa810ae846448f91c3de11d571fd-143" name="rest_code_a577aa810ae846448f91c3de11d571fd-143" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_a577aa810ae846448f91c3de11d571fd-143"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;savefig&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"bem_solution.png"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;bbox_inches&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;"tight"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;transparent&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;True&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;a id="rest_code_a577aa810ae846448f91c3de11d571fd-144" name="rest_code_a577aa810ae846448f91c3de11d571fd-144" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_a577aa810ae846448f91c3de11d571fd-144"&gt;&lt;/a&gt;            &lt;span class="n"&gt;dpi&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;300&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;The result in this case is the following.&lt;/p&gt;
&lt;img alt="Solution of the differential equation using the BEM." class="align-center" src="https://nicoguaro.github.io/images/bem_solution.png" style="width: 600px;"&gt;
&lt;/section&gt;</description><category>boundary element method</category><category>numerical methods</category><category>python</category><category>scientific computing</category><guid>https://nicoguaro.github.io/posts/bem_corrected/</guid><pubDate>Mon, 22 Feb 2021 15:00:00 GMT</pubDate></item><item><title>Spell Check in Jupyter Notebook</title><link>https://nicoguaro.github.io/posts/ortografia_jupyter/</link><dc:creator>Nicolás Guarín-Zapata</dc:creator><description>&lt;p&gt;The purpose of this post is to show how to have automatic spell check in
Jupyter Notebook, as shown below.&lt;/p&gt;
&lt;img alt="Example of spell checking in Jupyter Notebook." class="align-center" src="https://nicoguaro.github.io/images/ortografia_jupyter/ejemplo_ortografia.png" style="width: 600px;"&gt;
&lt;p&gt;There are &lt;a class="reference external" href="https://stackoverflow.com/q/39324039/3358223"&gt;several ways&lt;/a&gt;
to do this. However, the easiest way is through the (&lt;em&gt;nbextension&lt;/em&gt;)
&lt;a class="reference external" href="https://nicoguaro.github.io/posts/ortografia_jupyter/&amp;lt;https:/jupyter-contrib-nbextensions.readthedocs.io/en/latest/nbextensions/spellchecker/README.html"&gt;Spellchecker&lt;/a&gt;. plugin.&lt;/p&gt;
&lt;section id="step-by-step"&gt;
&lt;h2&gt;Step by step&lt;/h2&gt;
&lt;p&gt;The steps to follow are those:&lt;/p&gt;
&lt;ol class="arabic simple"&gt;
&lt;li&gt;&lt;p&gt;Install Jupyter notebook extensions (&lt;a class="reference external" href="https://github.com/ipython-contrib/jupyter_contrib_nbextensions"&gt;nbextensions&lt;/a&gt;). This includes
&lt;a class="reference external" href="https://nicoguaro.github.io/posts/ortografia_jupyter/&amp;lt;https:/jupyter-contrib-nbextensions.readthedocs.io/en/latest/nbextensions/spellchecker/README.html"&gt;Spellchecker&lt;/a&gt;.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Locate the dictionaries in the folder where the plugin is. Dictionaries
must use UTF-8 encoding.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Configure the path of the dictionaries. This can be a URL or a path
relative to the folder where the plugin is located.&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;We will describe each step in detail below.&lt;/p&gt;
&lt;section id="step-1-install-nbextensions"&gt;
&lt;h3&gt;Step 1: Install nbextensions&lt;/h3&gt;
&lt;p&gt;There is a list of plugins that add some commonly used functionality to
the Jupyter notebook.&lt;/p&gt;
&lt;p&gt;Type the following in a terminal, to install it using PIP.&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code bash"&gt;&lt;a id="rest_code_a0e61042be9e4ca8bd412b4acfac3e2b-1" name="rest_code_a0e61042be9e4ca8bd412b4acfac3e2b-1" href="https://nicoguaro.github.io/posts/ortografia_jupyter/#rest_code_a0e61042be9e4ca8bd412b4acfac3e2b-1"&gt;&lt;/a&gt;pip install jupyter_contrib_nbextensions
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;However, if Anaconda is being used the &lt;strong&gt;recommended method&lt;/strong&gt; is to use
&lt;code class="docutils literal"&gt;conda&lt;/code&gt;, as shown below.&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code bash"&gt;&lt;a id="rest_code_513952bc9414428381d4086dcef4318b-1" name="rest_code_513952bc9414428381d4086dcef4318b-1" href="https://nicoguaro.github.io/posts/ortografia_jupyter/#rest_code_513952bc9414428381d4086dcef4318b-1"&gt;&lt;/a&gt;conda install -c conda-forge jupyter_contrib_nbextensions
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;This should install the plugins and also the
&lt;a class="reference external" href="https://github.com/Jupyter-contrib/jupyter_nbextensions_configurator"&gt;configuration interface&lt;/a&gt;.
In the main menu of Jupyter notebook a new tab named &lt;em&gt;Nbextension&lt;/em&gt; will
appear. Here you can choose the add-ons to use. The appearance is
as follows.&lt;/p&gt;
&lt;img alt="Graphical interface for Jupyter plugins." class="align-center" src="https://nicoguaro.github.io/images/ortografia_jupyter/interfaz_nbextensions.png" style="width: 600px;"&gt;
&lt;p&gt;Some recommended plugins are:&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;&lt;strong&gt;Collapsible Headings:&lt;/strong&gt; that allows to hide sections of the documents.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;strong&gt;RISE:&lt;/strong&gt; that turns notebooks into presentations.&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/section&gt;
&lt;section id="step-2-dictionaries-for-spanish"&gt;
&lt;h3&gt;Step 2: Dictionaries for Spanish&lt;/h3&gt;
&lt;p&gt;The documentation of &lt;a class="reference external" href="https://nicoguaro.github.io/posts/ortografia_jupyter/&amp;lt;https:/jupyter-contrib-nbextensions.readthedocs.io/en/latest/nbextensions/spellchecker/README.html"&gt;Spellchecker&lt;/a&gt; suggests using a Python script to
download dictionaries from project &lt;a class="reference external" href="https://chromium.googlesource.com/chromium/deps/hunspell_dictionaries/+/master"&gt;Chromium&lt;/a&gt;.
However, these are encoded in  ISO-8859-1 (western) and it fails
for characters with accents or tildes. So, to avoid problems the
dictionary must be &lt;a class="reference external" href="https://en.wikipedia.org/wiki/UTF-8"&gt;UTF-8&lt;/a&gt;.
They can be downloaded at &lt;a class="reference external" href="https://nicoguaro.github.io/downloads/dict_es_ES.zip"&gt;this link&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Once you have the dictionaries, they must be located in the path of the
plugin. On my computer this would be&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code text"&gt;&lt;a id="rest_code_ac786803cea44a6caaa7a69bc54f859e-1" name="rest_code_ac786803cea44a6caaa7a69bc54f859e-1" href="https://nicoguaro.github.io/posts/ortografia_jupyter/#rest_code_ac786803cea44a6caaa7a69bc54f859e-1"&gt;&lt;/a&gt;~/.local/share/jupyter/nbextensions/spellchecker/
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;and within this we will place them in&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code text"&gt;&lt;a id="rest_code_9f2cef986fbe410ca5ce0018f2ab760e-1" name="rest_code_9f2cef986fbe410ca5ce0018f2ab760e-1" href="https://nicoguaro.github.io/posts/ortografia_jupyter/#rest_code_9f2cef986fbe410ca5ce0018f2ab760e-1"&gt;&lt;/a&gt;~/.local/share/jupyter/nbextensions/spellchecker/typo/dictionaries
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;This location is arbitrary, the important thing is that we need to know
the relative path to the plugin.&lt;/p&gt;
&lt;/section&gt;
&lt;section id="step-3-plugin-configuration"&gt;
&lt;h3&gt;Step 3: Plugin Configuration&lt;/h3&gt;
&lt;p&gt;Now, in the &lt;em&gt;Nbextensions&lt;/em&gt; tab we select the plugin and fill the fields
with the information from our dictionary:&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;language code to use with typo.js: &lt;code class="docutils literal"&gt;es_ES&lt;/code&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;url for the dictionary .dic file to use: &lt;code class="docutils literal"&gt;./typo/dictionaries/es_ES.dic&lt;/code&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;url for the dictionary .aff file to use: &lt;code class="docutils literal"&gt;./typo/dictionaries/es_ES.aff&lt;/code&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;This is shown below.&lt;/p&gt;
&lt;img alt="Configuration with local files." class="align-center" src="https://nicoguaro.github.io/images/ortografia_jupyter/config_local.png" style="width: 600px;"&gt;
&lt;p&gt;Another option is to use the URL for the files. The dictionaries of the
project &lt;a class="reference external" href="https://hunspell.github.io/"&gt;hunspell&lt;/a&gt; in UTF-8 are available
at &lt;a class="reference external" href="https://github.com/wooorm/dictionaries"&gt;https://github.com/wooorm/dictionaries&lt;/a&gt;. In this case, the configuration
would be:&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;language code to use with typo.js: &lt;code class="docutils literal"&gt;es_ES&lt;/code&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;url for the dictionary .dic file to use: &lt;code class="docutils literal"&gt;&lt;span class="pre"&gt;https://raw.githubusercontent.com/wooorm/dictionaries/master/dictionaries/es/index.dic&lt;/span&gt;&lt;/code&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;url for the dictionary .aff file to use: &lt;code class="docutils literal"&gt;&lt;span class="pre"&gt;https://raw.githubusercontent.com/wooorm/dictionaries/master/dictionaries/es/index.aff&lt;/span&gt;&lt;/code&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;And it is shown below.&lt;/p&gt;
&lt;img alt="Configuration with remote files." class="align-center" src="https://nicoguaro.github.io/images/ortografia_jupyter/config_url.png" style="width: 600px;"&gt;
&lt;/section&gt;
&lt;/section&gt;</description><category>data science</category><category>python</category><category>scientific computing</category><category>tutorial</category><guid>https://nicoguaro.github.io/posts/ortografia_jupyter/</guid><pubDate>Tue, 20 Aug 2019 19:45:41 GMT</pubDate></item><item><title>#SWDchallenge: Graph makeover</title><link>https://nicoguaro.github.io/posts/graph_makeover/</link><dc:creator>Nicolás Guarín-Zapata</dc:creator><description>&lt;p&gt;At &lt;a class="reference external" href="http://www.storytellingwithdata.com/"&gt;storytelling with data&lt;/a&gt;, they run
a monthly challenge on data visualization named
&lt;a class="reference external" href="http://www.storytellingwithdata.com/swdchallenge/"&gt;#SWDchallenge&lt;/a&gt;. The main
idea of the challenges is to test data visualization and
storytelling skills.&lt;/p&gt;
&lt;p&gt;Each month the challenge has a different topic. This
&lt;a class="reference external" href="http://www.storytellingwithdata.com/blog/2018/7/1/swdchallenge-your-choice-makeover"&gt;month&lt;/a&gt;
the challenge was to improve an existing graph. I decided to take a previous
graph of mine that was published on a
&lt;a class="reference external" href="https://www.sciencedirect.com/science/article/pii/S1742706115002172"&gt;paper&lt;/a&gt;
that was published on 2015.&lt;/p&gt;
&lt;section id="the-original"&gt;
&lt;h2&gt;The "original"&lt;/h2&gt;
&lt;p&gt;The following is the graph that we are going to start with.&lt;/p&gt;
&lt;img alt="Original plot" class="align-center" src="https://nicoguaro.github.io/images/graph_makeover/energy_vs_D_orig.svg" style="width: 600px;"&gt;
&lt;p&gt;This is not the exact same graph that was presented in the article on 2015, but
it serves the purpose of the challenge. The data can be downloaded from
&lt;a class="reference external" href="https://nicoguaro.github.io/downloads/Energy_vs_D.csv"&gt;here&lt;/a&gt;. This graph present the fraction of energy (&lt;span class="math"&gt;\(\eta\)&lt;/span&gt;) transmitted for helical composites
with different geometrical parameters. The parameters varied were:&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;Pitch angle &lt;span class="math"&gt;\(\alpha\)&lt;/span&gt;: the angle between consecutive layers;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Composite thickness &lt;span class="math"&gt;\(D\)&lt;/span&gt;, that is normalized to the wavelength &lt;span class="math"&gt;\(\lambda\)&lt;/span&gt;; and&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Number of layers &lt;span class="math"&gt;\(N\)&lt;/span&gt; in each cell of the composite.&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;The following schematic illustrate these parameters.&lt;/p&gt;
&lt;img alt="Composites" class="align-center" src="https://nicoguaro.github.io/images/graph_makeover/coordinates_and_cells.png" style="width: 600px;"&gt;
&lt;p&gt;I would not say that the graph is awful, and, in comparison to what you would
find in most scientific literature it is even good. But … in the land of the
blind, the one-eyed is king. So, let's enumerate what are the &lt;em&gt;sins&lt;/em&gt; of the
plot and see if we can correct them:&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;It has two x axes.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;The legend is enclosed in a box that seems unnecessary.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Right and top spines are not contributing to the plot.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Annotations are stealing protagonism from the data.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;It looks clutterd with lines and markers.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;It is a &lt;a class="reference external" href="http://www.storytellingwithdata.com/blog/2013/03/avoiding-spaghetti-graph"&gt;spaghetti graph&lt;/a&gt;.&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;The following snippet generates this graph.&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code python"&gt;&lt;a id="rest_code_0e93c58e6001400383f6fa162d39cf13-1" name="rest_code_0e93c58e6001400383f6fa162d39cf13-1" href="https://nicoguaro.github.io/posts/graph_makeover/#rest_code_0e93c58e6001400383f6fa162d39cf13-1"&gt;&lt;/a&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;numpy&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;np&lt;/span&gt;
&lt;a id="rest_code_0e93c58e6001400383f6fa162d39cf13-2" name="rest_code_0e93c58e6001400383f6fa162d39cf13-2" href="https://nicoguaro.github.io/posts/graph_makeover/#rest_code_0e93c58e6001400383f6fa162d39cf13-2"&gt;&lt;/a&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;matplotlib&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;pyplot&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="n"&gt;plt&lt;/span&gt;
&lt;a id="rest_code_0e93c58e6001400383f6fa162d39cf13-3" name="rest_code_0e93c58e6001400383f6fa162d39cf13-3" href="https://nicoguaro.github.io/posts/graph_makeover/#rest_code_0e93c58e6001400383f6fa162d39cf13-3"&gt;&lt;/a&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;matplotlib&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;rcParams&lt;/span&gt;
&lt;a id="rest_code_0e93c58e6001400383f6fa162d39cf13-4" name="rest_code_0e93c58e6001400383f6fa162d39cf13-4" href="https://nicoguaro.github.io/posts/graph_makeover/#rest_code_0e93c58e6001400383f6fa162d39cf13-4"&gt;&lt;/a&gt;
&lt;a id="rest_code_0e93c58e6001400383f6fa162d39cf13-5" name="rest_code_0e93c58e6001400383f6fa162d39cf13-5" href="https://nicoguaro.github.io/posts/graph_makeover/#rest_code_0e93c58e6001400383f6fa162d39cf13-5"&gt;&lt;/a&gt;&lt;span class="n"&gt;rcParams&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;'font.family'&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;'serif'&lt;/span&gt;
&lt;a id="rest_code_0e93c58e6001400383f6fa162d39cf13-6" name="rest_code_0e93c58e6001400383f6fa162d39cf13-6" href="https://nicoguaro.github.io/posts/graph_makeover/#rest_code_0e93c58e6001400383f6fa162d39cf13-6"&gt;&lt;/a&gt;&lt;span class="n"&gt;rcParams&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;'font.size'&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;16&lt;/span&gt;
&lt;a id="rest_code_0e93c58e6001400383f6fa162d39cf13-7" name="rest_code_0e93c58e6001400383f6fa162d39cf13-7" href="https://nicoguaro.github.io/posts/graph_makeover/#rest_code_0e93c58e6001400383f6fa162d39cf13-7"&gt;&lt;/a&gt;&lt;span class="n"&gt;rcParams&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;'legend.fontsize'&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;15&lt;/span&gt;
&lt;a id="rest_code_0e93c58e6001400383f6fa162d39cf13-8" name="rest_code_0e93c58e6001400383f6fa162d39cf13-8" href="https://nicoguaro.github.io/posts/graph_makeover/#rest_code_0e93c58e6001400383f6fa162d39cf13-8"&gt;&lt;/a&gt;&lt;span class="n"&gt;rcParams&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;'mathtext.fontset'&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;'cm'&lt;/span&gt;
&lt;a id="rest_code_0e93c58e6001400383f6fa162d39cf13-9" name="rest_code_0e93c58e6001400383f6fa162d39cf13-9" href="https://nicoguaro.github.io/posts/graph_makeover/#rest_code_0e93c58e6001400383f6fa162d39cf13-9"&gt;&lt;/a&gt;
&lt;a id="rest_code_0e93c58e6001400383f6fa162d39cf13-10" name="rest_code_0e93c58e6001400383f6fa162d39cf13-10" href="https://nicoguaro.github.io/posts/graph_makeover/#rest_code_0e93c58e6001400383f6fa162d39cf13-10"&gt;&lt;/a&gt;&lt;span class="n"&gt;markers&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;'o'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;'^'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;'v'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;'s'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;'&amp;lt;'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;'&amp;gt;'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;'d'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;'*'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;'x'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;'D'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;'+'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;'H'&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_0e93c58e6001400383f6fa162d39cf13-11" name="rest_code_0e93c58e6001400383f6fa162d39cf13-11" href="https://nicoguaro.github.io/posts/graph_makeover/#rest_code_0e93c58e6001400383f6fa162d39cf13-11"&gt;&lt;/a&gt;&lt;span class="n"&gt;data&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;loadtxt&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"Energy_vs_D.csv"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;skiprows&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;delimiter&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;","&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_0e93c58e6001400383f6fa162d39cf13-12" name="rest_code_0e93c58e6001400383f6fa162d39cf13-12" href="https://nicoguaro.github.io/posts/graph_makeover/#rest_code_0e93c58e6001400383f6fa162d39cf13-12"&gt;&lt;/a&gt;&lt;span class="n"&gt;labels&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;loadtxt&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"Energy_vs_D.csv"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;skiprows&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;delimiter&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;","&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;a id="rest_code_0e93c58e6001400383f6fa162d39cf13-13" name="rest_code_0e93c58e6001400383f6fa162d39cf13-13" href="https://nicoguaro.github.io/posts/graph_makeover/#rest_code_0e93c58e6001400383f6fa162d39cf13-13"&gt;&lt;/a&gt;                    &lt;span class="n"&gt;usecols&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;9&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_0e93c58e6001400383f6fa162d39cf13-14" name="rest_code_0e93c58e6001400383f6fa162d39cf13-14" href="https://nicoguaro.github.io/posts/graph_makeover/#rest_code_0e93c58e6001400383f6fa162d39cf13-14"&gt;&lt;/a&gt;&lt;span class="n"&gt;labels&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;labels&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;:]&lt;/span&gt;
&lt;a id="rest_code_0e93c58e6001400383f6fa162d39cf13-15" name="rest_code_0e93c58e6001400383f6fa162d39cf13-15" href="https://nicoguaro.github.io/posts/graph_makeover/#rest_code_0e93c58e6001400383f6fa162d39cf13-15"&gt;&lt;/a&gt;
&lt;a id="rest_code_0e93c58e6001400383f6fa162d39cf13-16" name="rest_code_0e93c58e6001400383f6fa162d39cf13-16" href="https://nicoguaro.github.io/posts/graph_makeover/#rest_code_0e93c58e6001400383f6fa162d39cf13-16"&gt;&lt;/a&gt;&lt;span class="n"&gt;fig&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;figure&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a id="rest_code_0e93c58e6001400383f6fa162d39cf13-17" name="rest_code_0e93c58e6001400383f6fa162d39cf13-17" href="https://nicoguaro.github.io/posts/graph_makeover/#rest_code_0e93c58e6001400383f6fa162d39cf13-17"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;subplot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;111&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_0e93c58e6001400383f6fa162d39cf13-18" name="rest_code_0e93c58e6001400383f6fa162d39cf13-18" href="https://nicoguaro.github.io/posts/graph_makeover/#rest_code_0e93c58e6001400383f6fa162d39cf13-18"&gt;&lt;/a&gt;&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;cont&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;8&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_0e93c58e6001400383f6fa162d39cf13-19" name="rest_code_0e93c58e6001400383f6fa162d39cf13-19" href="https://nicoguaro.github.io/posts/graph_makeover/#rest_code_0e93c58e6001400383f6fa162d39cf13-19"&gt;&lt;/a&gt;    &lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;plot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="p"&gt;[:,&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="p"&gt;[:,&lt;/span&gt; &lt;span class="n"&gt;cont&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;marker&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;markers&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;cont&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;
&lt;a id="rest_code_0e93c58e6001400383f6fa162d39cf13-20" name="rest_code_0e93c58e6001400383f6fa162d39cf13-20" href="https://nicoguaro.github.io/posts/graph_makeover/#rest_code_0e93c58e6001400383f6fa162d39cf13-20"&gt;&lt;/a&gt;             &lt;span class="n"&gt;label&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="sa"&gt;r&lt;/span&gt;&lt;span class="s2"&gt;"$D/\lambda=&lt;/span&gt;&lt;span class="si"&gt;{:.3g}&lt;/span&gt;&lt;span class="s2"&gt;$"&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;format&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;labels&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;cont&lt;/span&gt;&lt;span class="p"&gt;]))&lt;/span&gt;
&lt;a id="rest_code_0e93c58e6001400383f6fa162d39cf13-21" name="rest_code_0e93c58e6001400383f6fa162d39cf13-21" href="https://nicoguaro.github.io/posts/graph_makeover/#rest_code_0e93c58e6001400383f6fa162d39cf13-21"&gt;&lt;/a&gt;
&lt;a id="rest_code_0e93c58e6001400383f6fa162d39cf13-22" name="rest_code_0e93c58e6001400383f6fa162d39cf13-22" href="https://nicoguaro.github.io/posts/graph_makeover/#rest_code_0e93c58e6001400383f6fa162d39cf13-22"&gt;&lt;/a&gt;&lt;span class="c1"&gt;# First x-axis&lt;/span&gt;
&lt;a id="rest_code_0e93c58e6001400383f6fa162d39cf13-23" name="rest_code_0e93c58e6001400383f6fa162d39cf13-23" href="https://nicoguaro.github.io/posts/graph_makeover/#rest_code_0e93c58e6001400383f6fa162d39cf13-23"&gt;&lt;/a&gt;&lt;span class="n"&gt;xticks&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;xlabels&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xticks&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a id="rest_code_0e93c58e6001400383f6fa162d39cf13-24" name="rest_code_0e93c58e6001400383f6fa162d39cf13-24" href="https://nicoguaro.github.io/posts/graph_makeover/#rest_code_0e93c58e6001400383f6fa162d39cf13-24"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="sa"&gt;r&lt;/span&gt;&lt;span class="s2"&gt;"Number of layers - $N$"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;size&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;15&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_0e93c58e6001400383f6fa162d39cf13-25" name="rest_code_0e93c58e6001400383f6fa162d39cf13-25" href="https://nicoguaro.github.io/posts/graph_makeover/#rest_code_0e93c58e6001400383f6fa162d39cf13-25"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ylabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="sa"&gt;r&lt;/span&gt;&lt;span class="s2"&gt;"Fraction of Energy - $\eta$"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;size&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;15&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_0e93c58e6001400383f6fa162d39cf13-26" name="rest_code_0e93c58e6001400383f6fa162d39cf13-26" href="https://nicoguaro.github.io/posts/graph_makeover/#rest_code_0e93c58e6001400383f6fa162d39cf13-26"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;legend&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;loc&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'center left'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;bbox_to_anchor&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.5&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_0e93c58e6001400383f6fa162d39cf13-27" name="rest_code_0e93c58e6001400383f6fa162d39cf13-27" href="https://nicoguaro.github.io/posts/graph_makeover/#rest_code_0e93c58e6001400383f6fa162d39cf13-27"&gt;&lt;/a&gt;
&lt;a id="rest_code_0e93c58e6001400383f6fa162d39cf13-28" name="rest_code_0e93c58e6001400383f6fa162d39cf13-28" href="https://nicoguaro.github.io/posts/graph_makeover/#rest_code_0e93c58e6001400383f6fa162d39cf13-28"&gt;&lt;/a&gt;&lt;span class="c1"&gt;# Second x-axis&lt;/span&gt;
&lt;a id="rest_code_0e93c58e6001400383f6fa162d39cf13-29" name="rest_code_0e93c58e6001400383f6fa162d39cf13-29" href="https://nicoguaro.github.io/posts/graph_makeover/#rest_code_0e93c58e6001400383f6fa162d39cf13-29"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax2&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;twiny&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a id="rest_code_0e93c58e6001400383f6fa162d39cf13-30" name="rest_code_0e93c58e6001400383f6fa162d39cf13-30" href="https://nicoguaro.github.io/posts/graph_makeover/#rest_code_0e93c58e6001400383f6fa162d39cf13-30"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax2&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_xticks&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;xticks&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;:])&lt;/span&gt;
&lt;a id="rest_code_0e93c58e6001400383f6fa162d39cf13-31" name="rest_code_0e93c58e6001400383f6fa162d39cf13-31" href="https://nicoguaro.github.io/posts/graph_makeover/#rest_code_0e93c58e6001400383f6fa162d39cf13-31"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax2&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_xticklabels&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;180.&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;xticks&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;:])&lt;/span&gt;
&lt;a id="rest_code_0e93c58e6001400383f6fa162d39cf13-32" name="rest_code_0e93c58e6001400383f6fa162d39cf13-32" href="https://nicoguaro.github.io/posts/graph_makeover/#rest_code_0e93c58e6001400383f6fa162d39cf13-32"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="sa"&gt;r&lt;/span&gt;&lt;span class="s2"&gt;"Angle - $\alpha\ (^\circ)$"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;size&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;15&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_0e93c58e6001400383f6fa162d39cf13-33" name="rest_code_0e93c58e6001400383f6fa162d39cf13-33" href="https://nicoguaro.github.io/posts/graph_makeover/#rest_code_0e93c58e6001400383f6fa162d39cf13-33"&gt;&lt;/a&gt;
&lt;a id="rest_code_0e93c58e6001400383f6fa162d39cf13-34" name="rest_code_0e93c58e6001400383f6fa162d39cf13-34" href="https://nicoguaro.github.io/posts/graph_makeover/#rest_code_0e93c58e6001400383f6fa162d39cf13-34"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;tight_layout&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a id="rest_code_0e93c58e6001400383f6fa162d39cf13-35" name="rest_code_0e93c58e6001400383f6fa162d39cf13-35" href="https://nicoguaro.github.io/posts/graph_makeover/#rest_code_0e93c58e6001400383f6fa162d39cf13-35"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;savefig&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"energy_vs_D_orig.svg"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_0e93c58e6001400383f6fa162d39cf13-36" name="rest_code_0e93c58e6001400383f6fa162d39cf13-36" href="https://nicoguaro.github.io/posts/graph_makeover/#rest_code_0e93c58e6001400383f6fa162d39cf13-36"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;savefig&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"energy_vs_D_orig.png"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;dpi&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;300&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/section&gt;
&lt;section id="corrections"&gt;
&lt;h2&gt;Corrections&lt;/h2&gt;
&lt;p&gt;I will vindicate the graph one &lt;em&gt;sin&lt;/em&gt; at a time, let's see how it turns out.&lt;/p&gt;
&lt;section id="it-has-two-x-axes"&gt;
&lt;h3&gt;It has two x axes&lt;/h3&gt;
&lt;p&gt;I, originally, added two axes to show both the number of layers
and the angle between them at the same time. The general recommendation is
to avoid this, so let's get rid of the top one.&lt;/p&gt;
&lt;img alt="First iteration" class="align-center" src="https://nicoguaro.github.io/images/graph_makeover/energy_vs_D_1.svg" style="width: 600px;"&gt;
&lt;/section&gt;
&lt;section id="legend-in-a-box"&gt;
&lt;h3&gt;Legend in a box&lt;/h3&gt;
&lt;p&gt;Pretty straightforward …&lt;/p&gt;
&lt;img alt="Second iteration" class="align-center" src="https://nicoguaro.github.io/images/graph_makeover/energy_vs_D_2.svg" style="width: 600px;"&gt;
&lt;/section&gt;
&lt;section id="right-and-top-spines"&gt;
&lt;h3&gt;Right and top spines&lt;/h3&gt;
&lt;p&gt;Let's remove them&lt;/p&gt;
&lt;img alt="Third iteration" class="align-center" src="https://nicoguaro.github.io/images/graph_makeover/energy_vs_D_3.svg" style="width: 600px;"&gt;
&lt;/section&gt;
&lt;section id="annotations-are-stealing-protagonism"&gt;
&lt;h3&gt;Annotations are stealing protagonism&lt;/h3&gt;
&lt;p&gt;Let's move all the annotations to the background by changing the color
to a lighter gray.&lt;/p&gt;
&lt;img alt="Fourth iteration" class="align-center" src="https://nicoguaro.github.io/images/graph_makeover/energy_vs_D_4.svg" style="width: 600px;"&gt;
&lt;/section&gt;
&lt;section id="clutterd-with-lines-and-markers"&gt;
&lt;h3&gt;Clutterd with lines and markers&lt;/h3&gt;
&lt;p&gt;Let's just keep the lines.&lt;/p&gt;
&lt;img alt="Fifth iteration" class="align-center" src="https://nicoguaro.github.io/images/graph_makeover/energy_vs_D_5.svg" style="width: 600px;"&gt;
&lt;p&gt;And increase the linewidth.&lt;/p&gt;
&lt;img alt="Sixth iteration" class="align-center" src="https://nicoguaro.github.io/images/graph_makeover/energy_vs_D_6.svg" style="width: 600px;"&gt;
&lt;/section&gt;
&lt;section id="it-is-a-spaghetti-graph"&gt;
&lt;h3&gt;It is a spaghetti graph&lt;/h3&gt;
&lt;p&gt;I think that a good option for this graph would be to highlight
one line at a time. Doing this, we end up with.&lt;/p&gt;
&lt;img alt="Seventh iteration" class="align-center" src="https://nicoguaro.github.io/images/graph_makeover/energy_vs_D_7.svg" style="width: 600px;"&gt;
&lt;p&gt;The following snippet generates this version.&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code python"&gt;&lt;a id="rest_code_cf382f1827c44c8ebdff74227e03b8f3-1" name="rest_code_cf382f1827c44c8ebdff74227e03b8f3-1" href="https://nicoguaro.github.io/posts/graph_makeover/#rest_code_cf382f1827c44c8ebdff74227e03b8f3-1"&gt;&lt;/a&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;numpy&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;np&lt;/span&gt;
&lt;a id="rest_code_cf382f1827c44c8ebdff74227e03b8f3-2" name="rest_code_cf382f1827c44c8ebdff74227e03b8f3-2" href="https://nicoguaro.github.io/posts/graph_makeover/#rest_code_cf382f1827c44c8ebdff74227e03b8f3-2"&gt;&lt;/a&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;matplotlib&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;pyplot&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="n"&gt;plt&lt;/span&gt;
&lt;a id="rest_code_cf382f1827c44c8ebdff74227e03b8f3-3" name="rest_code_cf382f1827c44c8ebdff74227e03b8f3-3" href="https://nicoguaro.github.io/posts/graph_makeover/#rest_code_cf382f1827c44c8ebdff74227e03b8f3-3"&gt;&lt;/a&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;matplotlib&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;rcParams&lt;/span&gt;
&lt;a id="rest_code_cf382f1827c44c8ebdff74227e03b8f3-4" name="rest_code_cf382f1827c44c8ebdff74227e03b8f3-4" href="https://nicoguaro.github.io/posts/graph_makeover/#rest_code_cf382f1827c44c8ebdff74227e03b8f3-4"&gt;&lt;/a&gt;
&lt;a id="rest_code_cf382f1827c44c8ebdff74227e03b8f3-5" name="rest_code_cf382f1827c44c8ebdff74227e03b8f3-5" href="https://nicoguaro.github.io/posts/graph_makeover/#rest_code_cf382f1827c44c8ebdff74227e03b8f3-5"&gt;&lt;/a&gt;&lt;span class="c1"&gt;# Plots setup&lt;/span&gt;
&lt;a id="rest_code_cf382f1827c44c8ebdff74227e03b8f3-6" name="rest_code_cf382f1827c44c8ebdff74227e03b8f3-6" href="https://nicoguaro.github.io/posts/graph_makeover/#rest_code_cf382f1827c44c8ebdff74227e03b8f3-6"&gt;&lt;/a&gt;&lt;span class="n"&gt;gray&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;'#757575'&lt;/span&gt;
&lt;a id="rest_code_cf382f1827c44c8ebdff74227e03b8f3-7" name="rest_code_cf382f1827c44c8ebdff74227e03b8f3-7" href="https://nicoguaro.github.io/posts/graph_makeover/#rest_code_cf382f1827c44c8ebdff74227e03b8f3-7"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;rcParams&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;"mathtext.fontset"&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s2"&gt;"cm"&lt;/span&gt;
&lt;a id="rest_code_cf382f1827c44c8ebdff74227e03b8f3-8" name="rest_code_cf382f1827c44c8ebdff74227e03b8f3-8" href="https://nicoguaro.github.io/posts/graph_makeover/#rest_code_cf382f1827c44c8ebdff74227e03b8f3-8"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;rcParams&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;"text.color"&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;gray&lt;/span&gt;
&lt;a id="rest_code_cf382f1827c44c8ebdff74227e03b8f3-9" name="rest_code_cf382f1827c44c8ebdff74227e03b8f3-9" href="https://nicoguaro.github.io/posts/graph_makeover/#rest_code_cf382f1827c44c8ebdff74227e03b8f3-9"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;rcParams&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;"xtick.color"&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;gray&lt;/span&gt;
&lt;a id="rest_code_cf382f1827c44c8ebdff74227e03b8f3-10" name="rest_code_cf382f1827c44c8ebdff74227e03b8f3-10" href="https://nicoguaro.github.io/posts/graph_makeover/#rest_code_cf382f1827c44c8ebdff74227e03b8f3-10"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;rcParams&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;"ytick.color"&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;gray&lt;/span&gt;
&lt;a id="rest_code_cf382f1827c44c8ebdff74227e03b8f3-11" name="rest_code_cf382f1827c44c8ebdff74227e03b8f3-11" href="https://nicoguaro.github.io/posts/graph_makeover/#rest_code_cf382f1827c44c8ebdff74227e03b8f3-11"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;rcParams&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;"axes.labelcolor"&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;gray&lt;/span&gt;
&lt;a id="rest_code_cf382f1827c44c8ebdff74227e03b8f3-12" name="rest_code_cf382f1827c44c8ebdff74227e03b8f3-12" href="https://nicoguaro.github.io/posts/graph_makeover/#rest_code_cf382f1827c44c8ebdff74227e03b8f3-12"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;rcParams&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;"axes.edgecolor"&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;gray&lt;/span&gt;
&lt;a id="rest_code_cf382f1827c44c8ebdff74227e03b8f3-13" name="rest_code_cf382f1827c44c8ebdff74227e03b8f3-13" href="https://nicoguaro.github.io/posts/graph_makeover/#rest_code_cf382f1827c44c8ebdff74227e03b8f3-13"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;rcParams&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;"axes.spines.right"&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="kc"&gt;False&lt;/span&gt;
&lt;a id="rest_code_cf382f1827c44c8ebdff74227e03b8f3-14" name="rest_code_cf382f1827c44c8ebdff74227e03b8f3-14" href="https://nicoguaro.github.io/posts/graph_makeover/#rest_code_cf382f1827c44c8ebdff74227e03b8f3-14"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;rcParams&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;"axes.spines.top"&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="kc"&gt;False&lt;/span&gt;
&lt;a id="rest_code_cf382f1827c44c8ebdff74227e03b8f3-15" name="rest_code_cf382f1827c44c8ebdff74227e03b8f3-15" href="https://nicoguaro.github.io/posts/graph_makeover/#rest_code_cf382f1827c44c8ebdff74227e03b8f3-15"&gt;&lt;/a&gt;&lt;span class="n"&gt;rcParams&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;'font.family'&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;'serif'&lt;/span&gt;
&lt;a id="rest_code_cf382f1827c44c8ebdff74227e03b8f3-16" name="rest_code_cf382f1827c44c8ebdff74227e03b8f3-16" href="https://nicoguaro.github.io/posts/graph_makeover/#rest_code_cf382f1827c44c8ebdff74227e03b8f3-16"&gt;&lt;/a&gt;&lt;span class="n"&gt;rcParams&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;'mathtext.fontset'&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;'cm'&lt;/span&gt;
&lt;a id="rest_code_cf382f1827c44c8ebdff74227e03b8f3-17" name="rest_code_cf382f1827c44c8ebdff74227e03b8f3-17" href="https://nicoguaro.github.io/posts/graph_makeover/#rest_code_cf382f1827c44c8ebdff74227e03b8f3-17"&gt;&lt;/a&gt;
&lt;a id="rest_code_cf382f1827c44c8ebdff74227e03b8f3-18" name="rest_code_cf382f1827c44c8ebdff74227e03b8f3-18" href="https://nicoguaro.github.io/posts/graph_makeover/#rest_code_cf382f1827c44c8ebdff74227e03b8f3-18"&gt;&lt;/a&gt;
&lt;a id="rest_code_cf382f1827c44c8ebdff74227e03b8f3-19" name="rest_code_cf382f1827c44c8ebdff74227e03b8f3-19" href="https://nicoguaro.github.io/posts/graph_makeover/#rest_code_cf382f1827c44c8ebdff74227e03b8f3-19"&gt;&lt;/a&gt;
&lt;a id="rest_code_cf382f1827c44c8ebdff74227e03b8f3-20" name="rest_code_cf382f1827c44c8ebdff74227e03b8f3-20" href="https://nicoguaro.github.io/posts/graph_makeover/#rest_code_cf382f1827c44c8ebdff74227e03b8f3-20"&gt;&lt;/a&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;line_plots&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;highlight_line&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;title&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_cf382f1827c44c8ebdff74227e03b8f3-21" name="rest_code_cf382f1827c44c8ebdff74227e03b8f3-21" href="https://nicoguaro.github.io/posts/graph_makeover/#rest_code_cf382f1827c44c8ebdff74227e03b8f3-21"&gt;&lt;/a&gt;    &lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;title&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;title&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_cf382f1827c44c8ebdff74227e03b8f3-22" name="rest_code_cf382f1827c44c8ebdff74227e03b8f3-22" href="https://nicoguaro.github.io/posts/graph_makeover/#rest_code_cf382f1827c44c8ebdff74227e03b8f3-22"&gt;&lt;/a&gt;    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;cont&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;datum&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;enumerate&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="p"&gt;[:,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;:]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;T&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_cf382f1827c44c8ebdff74227e03b8f3-23" name="rest_code_cf382f1827c44c8ebdff74227e03b8f3-23" href="https://nicoguaro.github.io/posts/graph_makeover/#rest_code_cf382f1827c44c8ebdff74227e03b8f3-23"&gt;&lt;/a&gt;        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;cont&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="n"&gt;highlight_line&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a id="rest_code_cf382f1827c44c8ebdff74227e03b8f3-24" name="rest_code_cf382f1827c44c8ebdff74227e03b8f3-24" href="https://nicoguaro.github.io/posts/graph_makeover/#rest_code_cf382f1827c44c8ebdff74227e03b8f3-24"&gt;&lt;/a&gt;            &lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;plot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="p"&gt;[:,&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;datum&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;zorder&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;color&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;"#984ea3"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;a id="rest_code_cf382f1827c44c8ebdff74227e03b8f3-25" name="rest_code_cf382f1827c44c8ebdff74227e03b8f3-25" href="https://nicoguaro.github.io/posts/graph_makeover/#rest_code_cf382f1827c44c8ebdff74227e03b8f3-25"&gt;&lt;/a&gt;                     &lt;span class="n"&gt;linewidth&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_cf382f1827c44c8ebdff74227e03b8f3-26" name="rest_code_cf382f1827c44c8ebdff74227e03b8f3-26" href="https://nicoguaro.github.io/posts/graph_makeover/#rest_code_cf382f1827c44c8ebdff74227e03b8f3-26"&gt;&lt;/a&gt;        &lt;span class="k"&gt;else&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a id="rest_code_cf382f1827c44c8ebdff74227e03b8f3-27" name="rest_code_cf382f1827c44c8ebdff74227e03b8f3-27" href="https://nicoguaro.github.io/posts/graph_makeover/#rest_code_cf382f1827c44c8ebdff74227e03b8f3-27"&gt;&lt;/a&gt;            &lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;plot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="p"&gt;[:,&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;datum&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;zorder&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;color&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;gray&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;a id="rest_code_cf382f1827c44c8ebdff74227e03b8f3-28" name="rest_code_cf382f1827c44c8ebdff74227e03b8f3-28" href="https://nicoguaro.github.io/posts/graph_makeover/#rest_code_cf382f1827c44c8ebdff74227e03b8f3-28"&gt;&lt;/a&gt;                     &lt;span class="n"&gt;linewidth&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;alpha&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mf"&gt;0.5&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_cf382f1827c44c8ebdff74227e03b8f3-29" name="rest_code_cf382f1827c44c8ebdff74227e03b8f3-29" href="https://nicoguaro.github.io/posts/graph_makeover/#rest_code_cf382f1827c44c8ebdff74227e03b8f3-29"&gt;&lt;/a&gt;
&lt;a id="rest_code_cf382f1827c44c8ebdff74227e03b8f3-30" name="rest_code_cf382f1827c44c8ebdff74227e03b8f3-30" href="https://nicoguaro.github.io/posts/graph_makeover/#rest_code_cf382f1827c44c8ebdff74227e03b8f3-30"&gt;&lt;/a&gt;
&lt;a id="rest_code_cf382f1827c44c8ebdff74227e03b8f3-31" name="rest_code_cf382f1827c44c8ebdff74227e03b8f3-31" href="https://nicoguaro.github.io/posts/graph_makeover/#rest_code_cf382f1827c44c8ebdff74227e03b8f3-31"&gt;&lt;/a&gt;&lt;span class="n"&gt;data&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;loadtxt&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"Energy_vs_D.csv"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;skiprows&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;delimiter&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;","&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_cf382f1827c44c8ebdff74227e03b8f3-32" name="rest_code_cf382f1827c44c8ebdff74227e03b8f3-32" href="https://nicoguaro.github.io/posts/graph_makeover/#rest_code_cf382f1827c44c8ebdff74227e03b8f3-32"&gt;&lt;/a&gt;&lt;span class="n"&gt;labels&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;loadtxt&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"Energy_vs_D.csv"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;skiprows&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;delimiter&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;","&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;a id="rest_code_cf382f1827c44c8ebdff74227e03b8f3-33" name="rest_code_cf382f1827c44c8ebdff74227e03b8f3-33" href="https://nicoguaro.github.io/posts/graph_makeover/#rest_code_cf382f1827c44c8ebdff74227e03b8f3-33"&gt;&lt;/a&gt;                    &lt;span class="n"&gt;usecols&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;9&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_cf382f1827c44c8ebdff74227e03b8f3-34" name="rest_code_cf382f1827c44c8ebdff74227e03b8f3-34" href="https://nicoguaro.github.io/posts/graph_makeover/#rest_code_cf382f1827c44c8ebdff74227e03b8f3-34"&gt;&lt;/a&gt;&lt;span class="n"&gt;labels&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;labels&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;:]&lt;/span&gt;
&lt;a id="rest_code_cf382f1827c44c8ebdff74227e03b8f3-35" name="rest_code_cf382f1827c44c8ebdff74227e03b8f3-35" href="https://nicoguaro.github.io/posts/graph_makeover/#rest_code_cf382f1827c44c8ebdff74227e03b8f3-35"&gt;&lt;/a&gt;
&lt;a id="rest_code_cf382f1827c44c8ebdff74227e03b8f3-36" name="rest_code_cf382f1827c44c8ebdff74227e03b8f3-36" href="https://nicoguaro.github.io/posts/graph_makeover/#rest_code_cf382f1827c44c8ebdff74227e03b8f3-36"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;close&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"all"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_cf382f1827c44c8ebdff74227e03b8f3-37" name="rest_code_cf382f1827c44c8ebdff74227e03b8f3-37" href="https://nicoguaro.github.io/posts/graph_makeover/#rest_code_cf382f1827c44c8ebdff74227e03b8f3-37"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;figure&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;figsize&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;8&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_cf382f1827c44c8ebdff74227e03b8f3-38" name="rest_code_cf382f1827c44c8ebdff74227e03b8f3-38" href="https://nicoguaro.github.io/posts/graph_makeover/#rest_code_cf382f1827c44c8ebdff74227e03b8f3-38"&gt;&lt;/a&gt;&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;cont&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;8&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_cf382f1827c44c8ebdff74227e03b8f3-39" name="rest_code_cf382f1827c44c8ebdff74227e03b8f3-39" href="https://nicoguaro.github.io/posts/graph_makeover/#rest_code_cf382f1827c44c8ebdff74227e03b8f3-39"&gt;&lt;/a&gt;    &lt;span class="n"&gt;ax&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;subplot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;cont&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_cf382f1827c44c8ebdff74227e03b8f3-40" name="rest_code_cf382f1827c44c8ebdff74227e03b8f3-40" href="https://nicoguaro.github.io/posts/graph_makeover/#rest_code_cf382f1827c44c8ebdff74227e03b8f3-40"&gt;&lt;/a&gt;    &lt;span class="n"&gt;title&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="sa"&gt;r&lt;/span&gt;&lt;span class="s2"&gt;"$D/\lambda=&lt;/span&gt;&lt;span class="si"&gt;{:.3g}&lt;/span&gt;&lt;span class="s2"&gt;$"&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;format&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;labels&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;cont&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_cf382f1827c44c8ebdff74227e03b8f3-41" name="rest_code_cf382f1827c44c8ebdff74227e03b8f3-41" href="https://nicoguaro.github.io/posts/graph_makeover/#rest_code_cf382f1827c44c8ebdff74227e03b8f3-41"&gt;&lt;/a&gt;    &lt;span class="n"&gt;line_plots&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;cont&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;title&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_cf382f1827c44c8ebdff74227e03b8f3-42" name="rest_code_cf382f1827c44c8ebdff74227e03b8f3-42" href="https://nicoguaro.github.io/posts/graph_makeover/#rest_code_cf382f1827c44c8ebdff74227e03b8f3-42"&gt;&lt;/a&gt;    &lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ylim&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;0.4&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;1.0&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_cf382f1827c44c8ebdff74227e03b8f3-43" name="rest_code_cf382f1827c44c8ebdff74227e03b8f3-43" href="https://nicoguaro.github.io/posts/graph_makeover/#rest_code_cf382f1827c44c8ebdff74227e03b8f3-43"&gt;&lt;/a&gt;    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;cont&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a id="rest_code_cf382f1827c44c8ebdff74227e03b8f3-44" name="rest_code_cf382f1827c44c8ebdff74227e03b8f3-44" href="https://nicoguaro.github.io/posts/graph_makeover/#rest_code_cf382f1827c44c8ebdff74227e03b8f3-44"&gt;&lt;/a&gt;        &lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;""&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_cf382f1827c44c8ebdff74227e03b8f3-45" name="rest_code_cf382f1827c44c8ebdff74227e03b8f3-45" href="https://nicoguaro.github.io/posts/graph_makeover/#rest_code_cf382f1827c44c8ebdff74227e03b8f3-45"&gt;&lt;/a&gt;        &lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xaxis&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_ticks&lt;/span&gt;&lt;span class="p"&gt;([])&lt;/span&gt;
&lt;a id="rest_code_cf382f1827c44c8ebdff74227e03b8f3-46" name="rest_code_cf382f1827c44c8ebdff74227e03b8f3-46" href="https://nicoguaro.github.io/posts/graph_makeover/#rest_code_cf382f1827c44c8ebdff74227e03b8f3-46"&gt;&lt;/a&gt;        &lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;spines&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;"bottom"&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_color&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"none"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_cf382f1827c44c8ebdff74227e03b8f3-47" name="rest_code_cf382f1827c44c8ebdff74227e03b8f3-47" href="https://nicoguaro.github.io/posts/graph_makeover/#rest_code_cf382f1827c44c8ebdff74227e03b8f3-47"&gt;&lt;/a&gt;    &lt;span class="k"&gt;else&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a id="rest_code_cf382f1827c44c8ebdff74227e03b8f3-48" name="rest_code_cf382f1827c44c8ebdff74227e03b8f3-48" href="https://nicoguaro.github.io/posts/graph_makeover/#rest_code_cf382f1827c44c8ebdff74227e03b8f3-48"&gt;&lt;/a&gt;        &lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="sa"&gt;r&lt;/span&gt;&lt;span class="s2"&gt;"Number of layers - $N$"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_cf382f1827c44c8ebdff74227e03b8f3-49" name="rest_code_cf382f1827c44c8ebdff74227e03b8f3-49" href="https://nicoguaro.github.io/posts/graph_makeover/#rest_code_cf382f1827c44c8ebdff74227e03b8f3-49"&gt;&lt;/a&gt;    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;cont&lt;/span&gt; &lt;span class="o"&gt;%&lt;/span&gt; &lt;span class="mi"&gt;4&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a id="rest_code_cf382f1827c44c8ebdff74227e03b8f3-50" name="rest_code_cf382f1827c44c8ebdff74227e03b8f3-50" href="https://nicoguaro.github.io/posts/graph_makeover/#rest_code_cf382f1827c44c8ebdff74227e03b8f3-50"&gt;&lt;/a&gt;        &lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;yaxis&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_ticks&lt;/span&gt;&lt;span class="p"&gt;([])&lt;/span&gt;
&lt;a id="rest_code_cf382f1827c44c8ebdff74227e03b8f3-51" name="rest_code_cf382f1827c44c8ebdff74227e03b8f3-51" href="https://nicoguaro.github.io/posts/graph_makeover/#rest_code_cf382f1827c44c8ebdff74227e03b8f3-51"&gt;&lt;/a&gt;        &lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;spines&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;"left"&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_color&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"none"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_cf382f1827c44c8ebdff74227e03b8f3-52" name="rest_code_cf382f1827c44c8ebdff74227e03b8f3-52" href="https://nicoguaro.github.io/posts/graph_makeover/#rest_code_cf382f1827c44c8ebdff74227e03b8f3-52"&gt;&lt;/a&gt;    &lt;span class="k"&gt;else&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a id="rest_code_cf382f1827c44c8ebdff74227e03b8f3-53" name="rest_code_cf382f1827c44c8ebdff74227e03b8f3-53" href="https://nicoguaro.github.io/posts/graph_makeover/#rest_code_cf382f1827c44c8ebdff74227e03b8f3-53"&gt;&lt;/a&gt;        &lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ylabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="sa"&gt;r&lt;/span&gt;&lt;span class="s2"&gt;"Fraction of Energy - $\eta$"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_cf382f1827c44c8ebdff74227e03b8f3-54" name="rest_code_cf382f1827c44c8ebdff74227e03b8f3-54" href="https://nicoguaro.github.io/posts/graph_makeover/#rest_code_cf382f1827c44c8ebdff74227e03b8f3-54"&gt;&lt;/a&gt;
&lt;a id="rest_code_cf382f1827c44c8ebdff74227e03b8f3-55" name="rest_code_cf382f1827c44c8ebdff74227e03b8f3-55" href="https://nicoguaro.github.io/posts/graph_makeover/#rest_code_cf382f1827c44c8ebdff74227e03b8f3-55"&gt;&lt;/a&gt;
&lt;a id="rest_code_cf382f1827c44c8ebdff74227e03b8f3-56" name="rest_code_cf382f1827c44c8ebdff74227e03b8f3-56" href="https://nicoguaro.github.io/posts/graph_makeover/#rest_code_cf382f1827c44c8ebdff74227e03b8f3-56"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;tight_layout&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a id="rest_code_cf382f1827c44c8ebdff74227e03b8f3-57" name="rest_code_cf382f1827c44c8ebdff74227e03b8f3-57" href="https://nicoguaro.github.io/posts/graph_makeover/#rest_code_cf382f1827c44c8ebdff74227e03b8f3-57"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;savefig&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"energy_vs_D_7.svg"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_cf382f1827c44c8ebdff74227e03b8f3-58" name="rest_code_cf382f1827c44c8ebdff74227e03b8f3-58" href="https://nicoguaro.github.io/posts/graph_makeover/#rest_code_cf382f1827c44c8ebdff74227e03b8f3-58"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;savefig&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"energy_vs_D_7.png"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;dpi&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;300&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/section&gt;
&lt;/section&gt;
&lt;section id="final-tweaks"&gt;
&lt;h2&gt;Final tweaks&lt;/h2&gt;
&lt;p&gt;Using Inkscape I added some final details to get the following version.&lt;/p&gt;
&lt;img alt="Final" class="align-center" src="https://nicoguaro.github.io/images/graph_makeover/energy_vs_D_final.svg" style="width: 600px;"&gt;
&lt;/section&gt;
&lt;section id="further-reading"&gt;
&lt;h2&gt;Further reading&lt;/h2&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;Knaflic, Cole Nussbaumer. &lt;a class="reference external" href="http://www.storytellingwithdata.com/book/"&gt;Storytelling with data: A data visualization guide for business professionals&lt;/a&gt;.
John Wiley &amp;amp; Sons, 2015.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Nicolás Guarín-Zapata et al. &lt;a class="reference external" href="https://www.sciencedirect.com/science/article/pii/S1742706115002172"&gt;"Shear wave filtering in naturally-occurring Bouligand structures."&lt;/a&gt;
Acta biomaterialia 23 (2015): 11-20. Preprint: &lt;a class="reference external" href="https://arxiv.org/pdf/1505.04203.pdf"&gt;https://arxiv.org/pdf/1505.04203.pdf&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/section&gt;</description><category>papers</category><category>python</category><category>visualization</category><guid>https://nicoguaro.github.io/posts/graph_makeover/</guid><pubDate>Thu, 12 Jul 2018 23:32:40 GMT</pubDate></item><item><title>Finite differences in infinite domains</title><link>https://nicoguaro.github.io/posts/infinite_fdm/</link><dc:creator>Nicolás Guarín-Zapata</dc:creator><description>&lt;section id="finite-differences-in-infinite-domains"&gt;
&lt;h2&gt;Finite differences in infinite domains&lt;/h2&gt;
&lt;p&gt;Because of my friend, &lt;a class="reference external" href="http://cosmoscalibur.com/"&gt;Edward Villegas&lt;/a&gt;, I
ended up thinking about using a change of variables when solving an
eigenvalue problem with finite difference.&lt;/p&gt;
&lt;section id="the-problem"&gt;
&lt;h3&gt;The problem&lt;/h3&gt;
&lt;p&gt;Let's say that we want to solve a differential equation over an infinite
domain. A common case is to solve the &lt;a class="reference external" href="https://en.wikipedia.org/wiki/Schr%C3%B6dinger_equation#Time-independent_equation"&gt;Time independent Schrödinger
equation&lt;/a&gt;
subject to a potential &lt;span class="math"&gt;\(V(x)\)&lt;/span&gt;. For example&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
-\frac{1}{2}\frac{\mathrm{d}^2}{\mathrm{d}x^2}\psi(x) + V(x) \psi(x) = E\psi(x),\quad \forall x\in (-\infty, \infty),
\end{equation*}
&lt;/div&gt;
&lt;p&gt;where we want to find the pairs of eigenvalues/eigenfunctions
&lt;span class="math"&gt;\((E_n, \psi_n(x))\)&lt;/span&gt;.&lt;/p&gt;
&lt;p&gt;What I normally do when using &lt;a class="reference external" href="https://en.wikipedia.org/wiki/Finite_difference_method"&gt;finite
differences&lt;/a&gt;
is to regularly divide the domain. Where I take a &lt;em&gt;large enough&lt;/em&gt; domain,
so the solution have decayed close to zero. What I do in this post is to
make a change of variable to render the interval finite first and then
regularly divide the transformed domain in finite intervals.&lt;/p&gt;
&lt;/section&gt;
&lt;section id="my-usual-approach"&gt;
&lt;h3&gt;My usual approach&lt;/h3&gt;
&lt;p&gt;My usual approach is to approach the second derivative with a &lt;a class="reference external" href="https://en.wikipedia.org/wiki/Finite_difference_coefficient"&gt;centered
difference&lt;/a&gt;
for the point &lt;span class="math"&gt;\(x_i\)&lt;/span&gt; like this&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
\frac{\mathrm{d}^2 f(x)}{\mathrm{d}x^2} \approx \frac{f(x + \Delta x) - 2 f(x_i) + f(x - \Delta x)}{\Delta x^2}\, ,
\end{equation*}
&lt;/div&gt;
&lt;p&gt;with &lt;span class="math"&gt;\(\Delta x\)&lt;/span&gt; the separation between points.&lt;/p&gt;
&lt;p&gt;We can solve this in Python with the following snippet:&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code ipython3"&gt;&lt;a id="rest_code_ac906128a5104e8c8f49bf02003e12ae-1" name="rest_code_ac906128a5104e8c8f49bf02003e12ae-1" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_ac906128a5104e8c8f49bf02003e12ae-1"&gt;&lt;/a&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;numpy&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;np&lt;/span&gt;
&lt;a id="rest_code_ac906128a5104e8c8f49bf02003e12ae-2" name="rest_code_ac906128a5104e8c8f49bf02003e12ae-2" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_ac906128a5104e8c8f49bf02003e12ae-2"&gt;&lt;/a&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;scipy.sparse&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;diags&lt;/span&gt;
&lt;a id="rest_code_ac906128a5104e8c8f49bf02003e12ae-3" name="rest_code_ac906128a5104e8c8f49bf02003e12ae-3" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_ac906128a5104e8c8f49bf02003e12ae-3"&gt;&lt;/a&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;scipy.sparse.linalg&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;eigs&lt;/span&gt;
&lt;a id="rest_code_ac906128a5104e8c8f49bf02003e12ae-4" name="rest_code_ac906128a5104e8c8f49bf02003e12ae-4" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_ac906128a5104e8c8f49bf02003e12ae-4"&gt;&lt;/a&gt;
&lt;a id="rest_code_ac906128a5104e8c8f49bf02003e12ae-5" name="rest_code_ac906128a5104e8c8f49bf02003e12ae-5" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_ac906128a5104e8c8f49bf02003e12ae-5"&gt;&lt;/a&gt;
&lt;a id="rest_code_ac906128a5104e8c8f49bf02003e12ae-6" name="rest_code_ac906128a5104e8c8f49bf02003e12ae-6" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_ac906128a5104e8c8f49bf02003e12ae-6"&gt;&lt;/a&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;regular_FD&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;pot&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;npts&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;101&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;x_max&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;nvals&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;6&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_ac906128a5104e8c8f49bf02003e12ae-7" name="rest_code_ac906128a5104e8c8f49bf02003e12ae-7" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_ac906128a5104e8c8f49bf02003e12ae-7"&gt;&lt;/a&gt;    &lt;span class="sd"&gt;"""&lt;/span&gt;
&lt;a id="rest_code_ac906128a5104e8c8f49bf02003e12ae-8" name="rest_code_ac906128a5104e8c8f49bf02003e12ae-8" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_ac906128a5104e8c8f49bf02003e12ae-8"&gt;&lt;/a&gt;&lt;span class="sd"&gt;    Find eigenvalues/eigenfunctions for Schrodinger&lt;/span&gt;
&lt;a id="rest_code_ac906128a5104e8c8f49bf02003e12ae-9" name="rest_code_ac906128a5104e8c8f49bf02003e12ae-9" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_ac906128a5104e8c8f49bf02003e12ae-9"&gt;&lt;/a&gt;&lt;span class="sd"&gt;    equation for the given potential `pot` using&lt;/span&gt;
&lt;a id="rest_code_ac906128a5104e8c8f49bf02003e12ae-10" name="rest_code_ac906128a5104e8c8f49bf02003e12ae-10" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_ac906128a5104e8c8f49bf02003e12ae-10"&gt;&lt;/a&gt;&lt;span class="sd"&gt;    finite differences&lt;/span&gt;
&lt;a id="rest_code_ac906128a5104e8c8f49bf02003e12ae-11" name="rest_code_ac906128a5104e8c8f49bf02003e12ae-11" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_ac906128a5104e8c8f49bf02003e12ae-11"&gt;&lt;/a&gt;&lt;span class="sd"&gt;    """&lt;/span&gt;
&lt;a id="rest_code_ac906128a5104e8c8f49bf02003e12ae-12" name="rest_code_ac906128a5104e8c8f49bf02003e12ae-12" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_ac906128a5104e8c8f49bf02003e12ae-12"&gt;&lt;/a&gt;    &lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;linspace&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;x_max&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;x_max&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;npts&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_ac906128a5104e8c8f49bf02003e12ae-13" name="rest_code_ac906128a5104e8c8f49bf02003e12ae-13" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_ac906128a5104e8c8f49bf02003e12ae-13"&gt;&lt;/a&gt;    &lt;span class="n"&gt;dx&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_ac906128a5104e8c8f49bf02003e12ae-14" name="rest_code_ac906128a5104e8c8f49bf02003e12ae-14" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_ac906128a5104e8c8f49bf02003e12ae-14"&gt;&lt;/a&gt;    &lt;span class="n"&gt;D2&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;diags&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;shape&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;npts&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;npts&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;dx&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;
&lt;a id="rest_code_ac906128a5104e8c8f49bf02003e12ae-15" name="rest_code_ac906128a5104e8c8f49bf02003e12ae-15" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_ac906128a5104e8c8f49bf02003e12ae-15"&gt;&lt;/a&gt;    &lt;span class="n"&gt;V&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;diags&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;pot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_ac906128a5104e8c8f49bf02003e12ae-16" name="rest_code_ac906128a5104e8c8f49bf02003e12ae-16" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_ac906128a5104e8c8f49bf02003e12ae-16"&gt;&lt;/a&gt;    &lt;span class="n"&gt;H&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;0.5&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;D2&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;V&lt;/span&gt;
&lt;a id="rest_code_ac906128a5104e8c8f49bf02003e12ae-17" name="rest_code_ac906128a5104e8c8f49bf02003e12ae-17" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_ac906128a5104e8c8f49bf02003e12ae-17"&gt;&lt;/a&gt;    &lt;span class="n"&gt;vals&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;vecs&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;eigs&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;H&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;k&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;nvals&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;which&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;"SM"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_ac906128a5104e8c8f49bf02003e12ae-18" name="rest_code_ac906128a5104e8c8f49bf02003e12ae-18" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_ac906128a5104e8c8f49bf02003e12ae-18"&gt;&lt;/a&gt;    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;real&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;vals&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;vecs&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Let's setup the plotting details.&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code ipython3"&gt;&lt;a id="rest_code_1fe20e9ed5bd457991e8e398d8ffa75c-1" name="rest_code_1fe20e9ed5bd457991e8e398d8ffa75c-1" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_1fe20e9ed5bd457991e8e398d8ffa75c-1"&gt;&lt;/a&gt;&lt;span class="c1"&gt;# Jupyter notebook plotting setup &amp;amp; imports&lt;/span&gt;
&lt;a id="rest_code_1fe20e9ed5bd457991e8e398d8ffa75c-2" name="rest_code_1fe20e9ed5bd457991e8e398d8ffa75c-2" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_1fe20e9ed5bd457991e8e398d8ffa75c-2"&gt;&lt;/a&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="k"&gt;matplotlib&lt;/span&gt; notebook
&lt;a id="rest_code_1fe20e9ed5bd457991e8e398d8ffa75c-3" name="rest_code_1fe20e9ed5bd457991e8e398d8ffa75c-3" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_1fe20e9ed5bd457991e8e398d8ffa75c-3"&gt;&lt;/a&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;matplotlib.pyplot&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;plt&lt;/span&gt;
&lt;a id="rest_code_1fe20e9ed5bd457991e8e398d8ffa75c-4" name="rest_code_1fe20e9ed5bd457991e8e398d8ffa75c-4" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_1fe20e9ed5bd457991e8e398d8ffa75c-4"&gt;&lt;/a&gt;
&lt;a id="rest_code_1fe20e9ed5bd457991e8e398d8ffa75c-5" name="rest_code_1fe20e9ed5bd457991e8e398d8ffa75c-5" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_1fe20e9ed5bd457991e8e398d8ffa75c-5"&gt;&lt;/a&gt;&lt;span class="n"&gt;gray&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;'#757575'&lt;/span&gt;
&lt;a id="rest_code_1fe20e9ed5bd457991e8e398d8ffa75c-6" name="rest_code_1fe20e9ed5bd457991e8e398d8ffa75c-6" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_1fe20e9ed5bd457991e8e398d8ffa75c-6"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;rcParams&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;"figure.figsize"&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;6&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;4&lt;/span&gt;
&lt;a id="rest_code_1fe20e9ed5bd457991e8e398d8ffa75c-7" name="rest_code_1fe20e9ed5bd457991e8e398d8ffa75c-7" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_1fe20e9ed5bd457991e8e398d8ffa75c-7"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;rcParams&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;"mathtext.fontset"&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s2"&gt;"cm"&lt;/span&gt;
&lt;a id="rest_code_1fe20e9ed5bd457991e8e398d8ffa75c-8" name="rest_code_1fe20e9ed5bd457991e8e398d8ffa75c-8" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_1fe20e9ed5bd457991e8e398d8ffa75c-8"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;rcParams&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;"text.color"&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;gray&lt;/span&gt;
&lt;a id="rest_code_1fe20e9ed5bd457991e8e398d8ffa75c-9" name="rest_code_1fe20e9ed5bd457991e8e398d8ffa75c-9" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_1fe20e9ed5bd457991e8e398d8ffa75c-9"&gt;&lt;/a&gt;&lt;span class="n"&gt;fontsize&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;rcParams&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;"font.size"&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;12&lt;/span&gt;
&lt;a id="rest_code_1fe20e9ed5bd457991e8e398d8ffa75c-10" name="rest_code_1fe20e9ed5bd457991e8e398d8ffa75c-10" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_1fe20e9ed5bd457991e8e398d8ffa75c-10"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;rcParams&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;"xtick.color"&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;gray&lt;/span&gt;
&lt;a id="rest_code_1fe20e9ed5bd457991e8e398d8ffa75c-11" name="rest_code_1fe20e9ed5bd457991e8e398d8ffa75c-11" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_1fe20e9ed5bd457991e8e398d8ffa75c-11"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;rcParams&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;"ytick.color"&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;gray&lt;/span&gt;
&lt;a id="rest_code_1fe20e9ed5bd457991e8e398d8ffa75c-12" name="rest_code_1fe20e9ed5bd457991e8e398d8ffa75c-12" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_1fe20e9ed5bd457991e8e398d8ffa75c-12"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;rcParams&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;"axes.labelcolor"&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;gray&lt;/span&gt;
&lt;a id="rest_code_1fe20e9ed5bd457991e8e398d8ffa75c-13" name="rest_code_1fe20e9ed5bd457991e8e398d8ffa75c-13" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_1fe20e9ed5bd457991e8e398d8ffa75c-13"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;rcParams&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;"axes.edgecolor"&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;gray&lt;/span&gt;
&lt;a id="rest_code_1fe20e9ed5bd457991e8e398d8ffa75c-14" name="rest_code_1fe20e9ed5bd457991e8e398d8ffa75c-14" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_1fe20e9ed5bd457991e8e398d8ffa75c-14"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;rcParams&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;"axes.spines.right"&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="kc"&gt;False&lt;/span&gt;
&lt;a id="rest_code_1fe20e9ed5bd457991e8e398d8ffa75c-15" name="rest_code_1fe20e9ed5bd457991e8e398d8ffa75c-15" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_1fe20e9ed5bd457991e8e398d8ffa75c-15"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;rcParams&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;"axes.spines.top"&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="kc"&gt;False&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Let's consider the &lt;a class="reference external" href="https://en.wikipedia.org/wiki/Quantum_harmonic_oscillator"&gt;Quantum harmonic
oscillator&lt;/a&gt;,
that has as eigenvalues&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
E_n = n + \frac{1}{2},\quad \forall n = 0, 1, 2 \cdots
\end{equation*}
&lt;/div&gt;
&lt;p&gt;Using the finite difference method we have values that are really close
to the analytic ones.&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code ipython3"&gt;&lt;a id="rest_code_f5c5a97828c146589bc4095eed8b66c5-1" name="rest_code_f5c5a97828c146589bc4095eed8b66c5-1" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_f5c5a97828c146589bc4095eed8b66c5-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;vals&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;vecs&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;regular_FD&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;lambda&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="mf"&gt;0.5&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;npts&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;201&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_f5c5a97828c146589bc4095eed8b66c5-2" name="rest_code_f5c5a97828c146589bc4095eed8b66c5-2" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_f5c5a97828c146589bc4095eed8b66c5-2"&gt;&lt;/a&gt;&lt;span class="n"&gt;vals&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;with output&lt;/p&gt;
&lt;pre class="literal-block"&gt;array([0.4996873 , 1.49843574, 2.49593063, 3.49216962, 4.48715031,
       5.4808703 ])&lt;/pre&gt;
&lt;p&gt;With the analytic ones&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code text"&gt;&lt;a id="rest_code_4ed9828ac8de429faccb697346ebc05c-1" name="rest_code_4ed9828ac8de429faccb697346ebc05c-1" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_4ed9828ac8de429faccb697346ebc05c-1"&gt;&lt;/a&gt;[0.5, 1.5, 2.5, 3.5, 4.5, 5.5])
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;If we plot these two, we obtain the following.&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code ipython3"&gt;&lt;a id="rest_code_1967df24099841c8a093c3670a9848e3-1" name="rest_code_1967df24099841c8a093c3670a9848e3-1" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_1967df24099841c8a093c3670a9848e3-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;figure&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a id="rest_code_1967df24099841c8a093c3670a9848e3-2" name="rest_code_1967df24099841c8a093c3670a9848e3-2" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_1967df24099841c8a093c3670a9848e3-2"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;plot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;anal_vals&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_1967df24099841c8a093c3670a9848e3-3" name="rest_code_1967df24099841c8a093c3670a9848e3-3" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_1967df24099841c8a093c3670a9848e3-3"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;plot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;vals&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;"o"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_1967df24099841c8a093c3670a9848e3-4" name="rest_code_1967df24099841c8a093c3670a9848e3-4" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_1967df24099841c8a093c3670a9848e3-4"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="sa"&gt;r&lt;/span&gt;&lt;span class="s2"&gt;"$n$"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;fontsize&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;16&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_1967df24099841c8a093c3670a9848e3-5" name="rest_code_1967df24099841c8a093c3670a9848e3-5" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_1967df24099841c8a093c3670a9848e3-5"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ylabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="sa"&gt;r&lt;/span&gt;&lt;span class="s2"&gt;"$E_n$"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;fontsize&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;16&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_1967df24099841c8a093c3670a9848e3-6" name="rest_code_1967df24099841c8a093c3670a9848e3-6" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_1967df24099841c8a093c3670a9848e3-6"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;legend&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="s2"&gt;"Analytic"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;"Finite differences"&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_1967df24099841c8a093c3670a9848e3-7" name="rest_code_1967df24099841c8a093c3670a9848e3-7" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_1967df24099841c8a093c3670a9848e3-7"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;tight_layout&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;img alt="Eigenvalues for the regular finite difference" class="align-center" src="https://nicoguaro.github.io/images/infinite_fdm/eigvals_regular.svg" style="width: 600px;"&gt;
&lt;p&gt;Let's see the eigenfunctions.&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code ipython3"&gt;&lt;a id="rest_code_05d777a9a67d49cbb7c971cbd233f461-1" name="rest_code_05d777a9a67d49cbb7c971cbd233f461-1" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_05d777a9a67d49cbb7c971cbd233f461-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;figure&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a id="rest_code_05d777a9a67d49cbb7c971cbd233f461-2" name="rest_code_05d777a9a67d49cbb7c971cbd233f461-2" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_05d777a9a67d49cbb7c971cbd233f461-2"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;plot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;abs&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;vecs&lt;/span&gt;&lt;span class="p"&gt;[:,&lt;/span&gt; &lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_05d777a9a67d49cbb7c971cbd233f461-3" name="rest_code_05d777a9a67d49cbb7c971cbd233f461-3" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_05d777a9a67d49cbb7c971cbd233f461-3"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlim&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;6&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;6&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_05d777a9a67d49cbb7c971cbd233f461-4" name="rest_code_05d777a9a67d49cbb7c971cbd233f461-4" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_05d777a9a67d49cbb7c971cbd233f461-4"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="sa"&gt;r&lt;/span&gt;&lt;span class="s2"&gt;"$x$"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;fontsize&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;16&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_05d777a9a67d49cbb7c971cbd233f461-5" name="rest_code_05d777a9a67d49cbb7c971cbd233f461-5" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_05d777a9a67d49cbb7c971cbd233f461-5"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ylabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="sa"&gt;r&lt;/span&gt;&lt;span class="s2"&gt;"$|\psi_n(x)|^2$"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;fontsize&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;16&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_05d777a9a67d49cbb7c971cbd233f461-6" name="rest_code_05d777a9a67d49cbb7c971cbd233f461-6" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_05d777a9a67d49cbb7c971cbd233f461-6"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;yticks&lt;/span&gt;&lt;span class="p"&gt;([])&lt;/span&gt;
&lt;a id="rest_code_05d777a9a67d49cbb7c971cbd233f461-7" name="rest_code_05d777a9a67d49cbb7c971cbd233f461-7" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_05d777a9a67d49cbb7c971cbd233f461-7"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;tight_layout&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;img alt="Eigenfunctions for the regular finite difference" class="align-center" src="https://nicoguaro.github.io/images/infinite_fdm/eigvecs_regular.svg" style="width: 600px;"&gt;
&lt;p&gt;One inconvenient with this method is the redundant sampling towards the
extreme of the intervals, while under sample the middle part.&lt;/p&gt;
&lt;/section&gt;
&lt;section id="changing-the-domain"&gt;
&lt;h3&gt;Changing the domain&lt;/h3&gt;
&lt;p&gt;Let's now consider the case where we transform the infinite domain to a
finite one with a change of variable&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
\xi = \xi(x)
\end{equation*}
&lt;/div&gt;
&lt;p&gt;with &lt;span class="math"&gt;\(\xi \in (-1, 1)\)&lt;/span&gt;. Two options for this transformation are:&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;&lt;span class="math"&gt;\(\xi = \tanh x\)&lt;/span&gt;; and&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;span class="math"&gt;\(\xi = \frac{2}{\pi} \arctan x\)&lt;/span&gt;.&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Making this change of variable the equation we need to solve the
following equation&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
-\frac{1}{2}\left(\frac{\mathrm{d}\xi}{\mathrm{d}x}\right)^2\frac{\mathrm{d}^2}{\mathrm{d}\xi^2}\psi(\xi) - \frac{1}{2}\frac{\mathrm{d}^2\xi}{\mathrm{d}x^2}\frac{\mathrm{d}}{\mathrm{d}\xi}\psi(\xi) + V(\xi) \psi(\xi) = E\psi(\xi)
\end{equation*}
&lt;/div&gt;
&lt;p&gt;The following snippet solve the eigenproblem for the mapped domain:&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code ipython3"&gt;&lt;a id="rest_code_742e195bc4fc4d5a8d097e4f3e6bc214-1" name="rest_code_742e195bc4fc4d5a8d097e4f3e6bc214-1" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_742e195bc4fc4d5a8d097e4f3e6bc214-1"&gt;&lt;/a&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;mapped_FD&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;pot&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;fun&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;dxdxi&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;dxdxi2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;npts&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;101&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;nvals&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;6&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;xi_tol&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mf"&gt;1e-6&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_742e195bc4fc4d5a8d097e4f3e6bc214-2" name="rest_code_742e195bc4fc4d5a8d097e4f3e6bc214-2" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_742e195bc4fc4d5a8d097e4f3e6bc214-2"&gt;&lt;/a&gt;    &lt;span class="sd"&gt;"""&lt;/span&gt;
&lt;a id="rest_code_742e195bc4fc4d5a8d097e4f3e6bc214-3" name="rest_code_742e195bc4fc4d5a8d097e4f3e6bc214-3" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_742e195bc4fc4d5a8d097e4f3e6bc214-3"&gt;&lt;/a&gt;&lt;span class="sd"&gt;    Find eigenvalues/eigenfunctions for Schrodinger&lt;/span&gt;
&lt;a id="rest_code_742e195bc4fc4d5a8d097e4f3e6bc214-4" name="rest_code_742e195bc4fc4d5a8d097e4f3e6bc214-4" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_742e195bc4fc4d5a8d097e4f3e6bc214-4"&gt;&lt;/a&gt;&lt;span class="sd"&gt;    equation for the given potential `pot` using&lt;/span&gt;
&lt;a id="rest_code_742e195bc4fc4d5a8d097e4f3e6bc214-5" name="rest_code_742e195bc4fc4d5a8d097e4f3e6bc214-5" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_742e195bc4fc4d5a8d097e4f3e6bc214-5"&gt;&lt;/a&gt;&lt;span class="sd"&gt;    finite differences over a mapped domain on (-1, 1)&lt;/span&gt;
&lt;a id="rest_code_742e195bc4fc4d5a8d097e4f3e6bc214-6" name="rest_code_742e195bc4fc4d5a8d097e4f3e6bc214-6" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_742e195bc4fc4d5a8d097e4f3e6bc214-6"&gt;&lt;/a&gt;&lt;span class="sd"&gt;    """&lt;/span&gt;
&lt;a id="rest_code_742e195bc4fc4d5a8d097e4f3e6bc214-7" name="rest_code_742e195bc4fc4d5a8d097e4f3e6bc214-7" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_742e195bc4fc4d5a8d097e4f3e6bc214-7"&gt;&lt;/a&gt;    &lt;span class="n"&gt;xi&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;linspace&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;xi_tol&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;xi_tol&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;npts&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_742e195bc4fc4d5a8d097e4f3e6bc214-8" name="rest_code_742e195bc4fc4d5a8d097e4f3e6bc214-8" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_742e195bc4fc4d5a8d097e4f3e6bc214-8"&gt;&lt;/a&gt;    &lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;fun&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;xi&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_742e195bc4fc4d5a8d097e4f3e6bc214-9" name="rest_code_742e195bc4fc4d5a8d097e4f3e6bc214-9" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_742e195bc4fc4d5a8d097e4f3e6bc214-9"&gt;&lt;/a&gt;    &lt;span class="n"&gt;dxi&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;xi&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;xi&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_742e195bc4fc4d5a8d097e4f3e6bc214-10" name="rest_code_742e195bc4fc4d5a8d097e4f3e6bc214-10" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_742e195bc4fc4d5a8d097e4f3e6bc214-10"&gt;&lt;/a&gt;    &lt;span class="n"&gt;D2&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;diags&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;shape&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;npts&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;npts&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;dxi&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;
&lt;a id="rest_code_742e195bc4fc4d5a8d097e4f3e6bc214-11" name="rest_code_742e195bc4fc4d5a8d097e4f3e6bc214-11" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_742e195bc4fc4d5a8d097e4f3e6bc214-11"&gt;&lt;/a&gt;    &lt;span class="n"&gt;D1&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;0.5&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;diags&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;shape&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;npts&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;npts&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;dxi&lt;/span&gt;
&lt;a id="rest_code_742e195bc4fc4d5a8d097e4f3e6bc214-12" name="rest_code_742e195bc4fc4d5a8d097e4f3e6bc214-12" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_742e195bc4fc4d5a8d097e4f3e6bc214-12"&gt;&lt;/a&gt;    &lt;span class="n"&gt;V&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;diags&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;pot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_742e195bc4fc4d5a8d097e4f3e6bc214-13" name="rest_code_742e195bc4fc4d5a8d097e4f3e6bc214-13" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_742e195bc4fc4d5a8d097e4f3e6bc214-13"&gt;&lt;/a&gt;    &lt;span class="n"&gt;fac1&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;diags&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;dxdxi&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;xi&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_742e195bc4fc4d5a8d097e4f3e6bc214-14" name="rest_code_742e195bc4fc4d5a8d097e4f3e6bc214-14" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_742e195bc4fc4d5a8d097e4f3e6bc214-14"&gt;&lt;/a&gt;    &lt;span class="n"&gt;fac2&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;diags&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;dxdxi2&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;xi&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_742e195bc4fc4d5a8d097e4f3e6bc214-15" name="rest_code_742e195bc4fc4d5a8d097e4f3e6bc214-15" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_742e195bc4fc4d5a8d097e4f3e6bc214-15"&gt;&lt;/a&gt;    &lt;span class="n"&gt;H&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;0.5&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;fac1&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;dot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;D2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="mf"&gt;0.5&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;fac2&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;dot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;D1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;V&lt;/span&gt;
&lt;a id="rest_code_742e195bc4fc4d5a8d097e4f3e6bc214-16" name="rest_code_742e195bc4fc4d5a8d097e4f3e6bc214-16" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_742e195bc4fc4d5a8d097e4f3e6bc214-16"&gt;&lt;/a&gt;    &lt;span class="n"&gt;vals&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;vecs&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;eigs&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;H&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;k&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;nvals&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;which&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;"SM"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_742e195bc4fc4d5a8d097e4f3e6bc214-17" name="rest_code_742e195bc4fc4d5a8d097e4f3e6bc214-17" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_742e195bc4fc4d5a8d097e4f3e6bc214-17"&gt;&lt;/a&gt;    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;real&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;vals&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;vecs&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;section id="first-transformation-xi-tanh-x"&gt;
&lt;h4&gt;First transformation: &lt;span class="math"&gt;\(\xi = \tanh(x)\)&lt;/span&gt;&lt;/h4&gt;
&lt;p&gt;Let's consider first the transformation&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
\xi = \tanh(x)\, .
\end{equation*}
&lt;/div&gt;
&lt;p&gt;In this case&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
\frac{\mathrm{d}\xi}{\mathrm{d}x} = 1 - \tanh^2(x) = 1 - \xi^2\, ,
\end{equation*}
&lt;/div&gt;
&lt;p&gt;and&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
\frac{\mathrm{d}^2\xi}{\mathrm{d}x^2} = -2\tanh(x)[1 - \tanh^2(x)] = -2\xi[1 - \xi^2]\, .
\end{equation*}
&lt;/div&gt;
&lt;p&gt;We need to define the functions&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code ipython3"&gt;&lt;a id="rest_code_1f2e8995816f4fe5932a8039b2a2fcbb-1" name="rest_code_1f2e8995816f4fe5932a8039b2a2fcbb-1" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_1f2e8995816f4fe5932a8039b2a2fcbb-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;pot&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;lambda&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="mf"&gt;0.5&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;
&lt;a id="rest_code_1f2e8995816f4fe5932a8039b2a2fcbb-2" name="rest_code_1f2e8995816f4fe5932a8039b2a2fcbb-2" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_1f2e8995816f4fe5932a8039b2a2fcbb-2"&gt;&lt;/a&gt;&lt;span class="n"&gt;fun&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;lambda&lt;/span&gt; &lt;span class="n"&gt;xi&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;arctanh&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;xi&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_1f2e8995816f4fe5932a8039b2a2fcbb-3" name="rest_code_1f2e8995816f4fe5932a8039b2a2fcbb-3" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_1f2e8995816f4fe5932a8039b2a2fcbb-3"&gt;&lt;/a&gt;&lt;span class="n"&gt;dxdxi&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;lambda&lt;/span&gt; &lt;span class="n"&gt;xi&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;xi&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;
&lt;a id="rest_code_1f2e8995816f4fe5932a8039b2a2fcbb-4" name="rest_code_1f2e8995816f4fe5932a8039b2a2fcbb-4" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_1f2e8995816f4fe5932a8039b2a2fcbb-4"&gt;&lt;/a&gt;&lt;span class="n"&gt;dxdxi2&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;lambda&lt;/span&gt; &lt;span class="n"&gt;xi&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;xi&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;xi&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;and run the function&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code ipython3"&gt;&lt;a id="rest_code_9424dbee7e514f97a6315a12bbb95270-1" name="rest_code_9424dbee7e514f97a6315a12bbb95270-1" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_9424dbee7e514f97a6315a12bbb95270-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;vals&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;vecs&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;mapped_FD&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;pot&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;fun&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;dxdxi&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;dxdxi2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;npts&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;201&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_9424dbee7e514f97a6315a12bbb95270-2" name="rest_code_9424dbee7e514f97a6315a12bbb95270-2" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_9424dbee7e514f97a6315a12bbb95270-2"&gt;&lt;/a&gt;&lt;span class="n"&gt;vals&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;And we obtain the following&lt;/p&gt;
&lt;pre class="literal-block"&gt;array([0.49989989, 1.4984226 , 2.49003572, 3.46934257, 4.46935021,
       5.59552989])&lt;/pre&gt;
&lt;p&gt;If we compare with the analytic values we get the following.&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code ipython3"&gt;&lt;a id="rest_code_11b0ed5880a347348883b13a585a67be-1" name="rest_code_11b0ed5880a347348883b13a585a67be-1" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_11b0ed5880a347348883b13a585a67be-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;figure&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a id="rest_code_11b0ed5880a347348883b13a585a67be-2" name="rest_code_11b0ed5880a347348883b13a585a67be-2" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_11b0ed5880a347348883b13a585a67be-2"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;plot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;anal_vals&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_11b0ed5880a347348883b13a585a67be-3" name="rest_code_11b0ed5880a347348883b13a585a67be-3" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_11b0ed5880a347348883b13a585a67be-3"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;plot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;vals&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;"o"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_11b0ed5880a347348883b13a585a67be-4" name="rest_code_11b0ed5880a347348883b13a585a67be-4" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_11b0ed5880a347348883b13a585a67be-4"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;legend&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="s2"&gt;"Analytic"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;"Finite differences"&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_11b0ed5880a347348883b13a585a67be-5" name="rest_code_11b0ed5880a347348883b13a585a67be-5" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_11b0ed5880a347348883b13a585a67be-5"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="sa"&gt;r&lt;/span&gt;&lt;span class="s2"&gt;"$n$"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;fontsize&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;16&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_11b0ed5880a347348883b13a585a67be-6" name="rest_code_11b0ed5880a347348883b13a585a67be-6" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_11b0ed5880a347348883b13a585a67be-6"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ylabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="sa"&gt;r&lt;/span&gt;&lt;span class="s2"&gt;"$E_n$"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;fontsize&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;16&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_11b0ed5880a347348883b13a585a67be-7" name="rest_code_11b0ed5880a347348883b13a585a67be-7" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_11b0ed5880a347348883b13a585a67be-7"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;tight_layout&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;img alt="Eigenvalues for the first transformation" class="align-center" src="https://nicoguaro.github.io/images/infinite_fdm/eigvals_tanh.svg" style="width: 600px;"&gt;
&lt;p&gt;And the following are the eigenfunctions.&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code ipython3"&gt;&lt;a id="rest_code_68a4ce5e77aa4daf8d5d8bdec984e453-1" name="rest_code_68a4ce5e77aa4daf8d5d8bdec984e453-1" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_68a4ce5e77aa4daf8d5d8bdec984e453-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;figure&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a id="rest_code_68a4ce5e77aa4daf8d5d8bdec984e453-2" name="rest_code_68a4ce5e77aa4daf8d5d8bdec984e453-2" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_68a4ce5e77aa4daf8d5d8bdec984e453-2"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;plot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;abs&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;vecs&lt;/span&gt;&lt;span class="p"&gt;[:,&lt;/span&gt; &lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_68a4ce5e77aa4daf8d5d8bdec984e453-3" name="rest_code_68a4ce5e77aa4daf8d5d8bdec984e453-3" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_68a4ce5e77aa4daf8d5d8bdec984e453-3"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlim&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;6&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;6&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_68a4ce5e77aa4daf8d5d8bdec984e453-4" name="rest_code_68a4ce5e77aa4daf8d5d8bdec984e453-4" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_68a4ce5e77aa4daf8d5d8bdec984e453-4"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="sa"&gt;r&lt;/span&gt;&lt;span class="s2"&gt;"$x$"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;fontsize&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;16&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_68a4ce5e77aa4daf8d5d8bdec984e453-5" name="rest_code_68a4ce5e77aa4daf8d5d8bdec984e453-5" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_68a4ce5e77aa4daf8d5d8bdec984e453-5"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ylabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="sa"&gt;r&lt;/span&gt;&lt;span class="s2"&gt;"$|\psi_n(x)|^2$"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;fontsize&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;16&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_68a4ce5e77aa4daf8d5d8bdec984e453-6" name="rest_code_68a4ce5e77aa4daf8d5d8bdec984e453-6" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_68a4ce5e77aa4daf8d5d8bdec984e453-6"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;yticks&lt;/span&gt;&lt;span class="p"&gt;([])&lt;/span&gt;
&lt;a id="rest_code_68a4ce5e77aa4daf8d5d8bdec984e453-7" name="rest_code_68a4ce5e77aa4daf8d5d8bdec984e453-7" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_68a4ce5e77aa4daf8d5d8bdec984e453-7"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;tight_layout&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;img alt="Eigenfunctions for the first transformation" class="align-center" src="https://nicoguaro.github.io/images/infinite_fdm/eigvecs_tanh.svg" style="width: 600px;"&gt;
&lt;/section&gt;
&lt;section id="second-transformation-xi-frac-2-pi-mathrm-atan-x"&gt;
&lt;h4&gt;Second transformation: &lt;span class="math"&gt;\(\xi = \frac{2}{\pi}\mathrm{atan}(x)\)&lt;/span&gt;&lt;/h4&gt;
&lt;p&gt;Let's consider first the transformation&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
\xi = \frac{2}{\pi}\mathrm{atan}(x)\, .
\end{equation*}
&lt;/div&gt;
&lt;p&gt;In this case&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
\frac{\mathrm{d}\xi}{\mathrm{d}x} = \frac{2}{\pi(1 + x^2)} = \frac{2 \cos^2\xi}{\pi} \, ,
\end{equation*}
&lt;/div&gt;
&lt;p&gt;and&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
\frac{\mathrm{d}^2\xi}{\mathrm{d}x^2} = -\frac{4x}{\pi(1 + x^2)^2} = -\frac{4 \cos^4\xi \tan \xi}{\pi}\, .
\end{equation*}
&lt;/div&gt;
&lt;p&gt;Once, again, we define the functions.&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code ipython3"&gt;&lt;a id="rest_code_86d316d0047243c08d3055675ab0d470-1" name="rest_code_86d316d0047243c08d3055675ab0d470-1" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_86d316d0047243c08d3055675ab0d470-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;pot&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;lambda&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="mf"&gt;0.5&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;
&lt;a id="rest_code_86d316d0047243c08d3055675ab0d470-2" name="rest_code_86d316d0047243c08d3055675ab0d470-2" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_86d316d0047243c08d3055675ab0d470-2"&gt;&lt;/a&gt;&lt;span class="n"&gt;fun&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;lambda&lt;/span&gt; &lt;span class="n"&gt;xi&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;tan&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;0.5&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;pi&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;xi&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_86d316d0047243c08d3055675ab0d470-3" name="rest_code_86d316d0047243c08d3055675ab0d470-3" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_86d316d0047243c08d3055675ab0d470-3"&gt;&lt;/a&gt;&lt;span class="n"&gt;dxdxi&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;lambda&lt;/span&gt; &lt;span class="n"&gt;xi&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;pi&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;cos&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;0.5&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;pi&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;xi&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;
&lt;a id="rest_code_86d316d0047243c08d3055675ab0d470-4" name="rest_code_86d316d0047243c08d3055675ab0d470-4" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_86d316d0047243c08d3055675ab0d470-4"&gt;&lt;/a&gt;&lt;span class="n"&gt;dxdxi2&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;lambda&lt;/span&gt; &lt;span class="n"&gt;xi&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;pi&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;cos&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;0.5&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;pi&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;xi&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;tan&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;0.5&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;pi&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;xi&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;and run the function&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code ipython3"&gt;&lt;a id="rest_code_8e35d3bad2f64fdba97231302bf21e4e-1" name="rest_code_8e35d3bad2f64fdba97231302bf21e4e-1" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_8e35d3bad2f64fdba97231302bf21e4e-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;vals&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;vecs&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;mapped_FD&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;pot&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;fun&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;dxdxi&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;dxdxi2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;npts&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;201&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_8e35d3bad2f64fdba97231302bf21e4e-2" name="rest_code_8e35d3bad2f64fdba97231302bf21e4e-2" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_8e35d3bad2f64fdba97231302bf21e4e-2"&gt;&lt;/a&gt;&lt;span class="n"&gt;vals&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;to obtain the following eigenvalues&lt;/p&gt;
&lt;pre class="literal-block"&gt;array([0.49997815, 1.49979632, 2.49930872, 3.49824697, 4.49627555,
       5.49295665])&lt;/pre&gt;
&lt;p&gt;with this plot&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code ipython3"&gt;&lt;a id="rest_code_fef3ffff9cdb48a280f175c7f5a6a89c-1" name="rest_code_fef3ffff9cdb48a280f175c7f5a6a89c-1" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_fef3ffff9cdb48a280f175c7f5a6a89c-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;figure&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a id="rest_code_fef3ffff9cdb48a280f175c7f5a6a89c-2" name="rest_code_fef3ffff9cdb48a280f175c7f5a6a89c-2" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_fef3ffff9cdb48a280f175c7f5a6a89c-2"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;plot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;anal_vals&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_fef3ffff9cdb48a280f175c7f5a6a89c-3" name="rest_code_fef3ffff9cdb48a280f175c7f5a6a89c-3" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_fef3ffff9cdb48a280f175c7f5a6a89c-3"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;plot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;vals&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;"o"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_fef3ffff9cdb48a280f175c7f5a6a89c-4" name="rest_code_fef3ffff9cdb48a280f175c7f5a6a89c-4" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_fef3ffff9cdb48a280f175c7f5a6a89c-4"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;legend&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="s2"&gt;"Analytic"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;"Finite differences"&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_fef3ffff9cdb48a280f175c7f5a6a89c-5" name="rest_code_fef3ffff9cdb48a280f175c7f5a6a89c-5" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_fef3ffff9cdb48a280f175c7f5a6a89c-5"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="sa"&gt;r&lt;/span&gt;&lt;span class="s2"&gt;"$n$"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;fontsize&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;16&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_fef3ffff9cdb48a280f175c7f5a6a89c-6" name="rest_code_fef3ffff9cdb48a280f175c7f5a6a89c-6" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_fef3ffff9cdb48a280f175c7f5a6a89c-6"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ylabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="sa"&gt;r&lt;/span&gt;&lt;span class="s2"&gt;"$E_n$"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;fontsize&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;16&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_fef3ffff9cdb48a280f175c7f5a6a89c-7" name="rest_code_fef3ffff9cdb48a280f175c7f5a6a89c-7" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_fef3ffff9cdb48a280f175c7f5a6a89c-7"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;tight_layout&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;img alt="Eigenvalues for the second transformation" class="align-center" src="https://nicoguaro.github.io/images/infinite_fdm/eigvals_atan.svg" style="width: 600px;"&gt;
&lt;p&gt;and the following eigenfunctions.&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code ipython3"&gt;&lt;a id="rest_code_4fc6f6b9e9ff4ffea694b8788c544af9-1" name="rest_code_4fc6f6b9e9ff4ffea694b8788c544af9-1" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_4fc6f6b9e9ff4ffea694b8788c544af9-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;figure&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a id="rest_code_4fc6f6b9e9ff4ffea694b8788c544af9-2" name="rest_code_4fc6f6b9e9ff4ffea694b8788c544af9-2" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_4fc6f6b9e9ff4ffea694b8788c544af9-2"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;plot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;abs&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;vecs&lt;/span&gt;&lt;span class="p"&gt;[:,&lt;/span&gt; &lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_4fc6f6b9e9ff4ffea694b8788c544af9-3" name="rest_code_4fc6f6b9e9ff4ffea694b8788c544af9-3" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_4fc6f6b9e9ff4ffea694b8788c544af9-3"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="sa"&gt;r&lt;/span&gt;&lt;span class="s2"&gt;"$x$"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;fontsize&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;16&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_4fc6f6b9e9ff4ffea694b8788c544af9-4" name="rest_code_4fc6f6b9e9ff4ffea694b8788c544af9-4" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_4fc6f6b9e9ff4ffea694b8788c544af9-4"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ylabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="sa"&gt;r&lt;/span&gt;&lt;span class="s2"&gt;"$|\psi|^2$"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;fontsize&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;16&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_4fc6f6b9e9ff4ffea694b8788c544af9-5" name="rest_code_4fc6f6b9e9ff4ffea694b8788c544af9-5" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_4fc6f6b9e9ff4ffea694b8788c544af9-5"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlim&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;6&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;6&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_4fc6f6b9e9ff4ffea694b8788c544af9-6" name="rest_code_4fc6f6b9e9ff4ffea694b8788c544af9-6" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_4fc6f6b9e9ff4ffea694b8788c544af9-6"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="sa"&gt;r&lt;/span&gt;&lt;span class="s2"&gt;"$x$"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;fontsize&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;16&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_4fc6f6b9e9ff4ffea694b8788c544af9-7" name="rest_code_4fc6f6b9e9ff4ffea694b8788c544af9-7" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_4fc6f6b9e9ff4ffea694b8788c544af9-7"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ylabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="sa"&gt;r&lt;/span&gt;&lt;span class="s2"&gt;"$|\psi_n(x)|^2$"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;fontsize&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;16&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_4fc6f6b9e9ff4ffea694b8788c544af9-8" name="rest_code_4fc6f6b9e9ff4ffea694b8788c544af9-8" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_4fc6f6b9e9ff4ffea694b8788c544af9-8"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;yticks&lt;/span&gt;&lt;span class="p"&gt;([])&lt;/span&gt;
&lt;a id="rest_code_4fc6f6b9e9ff4ffea694b8788c544af9-9" name="rest_code_4fc6f6b9e9ff4ffea694b8788c544af9-9" href="https://nicoguaro.github.io/posts/infinite_fdm/#rest_code_4fc6f6b9e9ff4ffea694b8788c544af9-9"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;tight_layout&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;img alt="Eigenfunctions for the second transformation" class="align-center" src="https://nicoguaro.github.io/images/infinite_fdm/eigvecs_atan.svg" style="width: 600px;"&gt;
&lt;/section&gt;
&lt;/section&gt;
&lt;section id="conclusion"&gt;
&lt;h3&gt;Conclusion&lt;/h3&gt;
&lt;p&gt;The method works fine, although the differential equation is more
convoluted due to the change of variable. Although there are more
elegant methods to consider infinite domains, this is simple enough to
be solved in 10 lines of code.&lt;/p&gt;
&lt;p&gt;We can see that the mapping &lt;span class="math"&gt;\(\xi = \mathrm{atan}(x)\)&lt;/span&gt;, covers
better the domain than &lt;span class="math"&gt;\(\xi = \tanh(x)\)&lt;/span&gt;, where most of the points
are placed in the center of the interval.&lt;/p&gt;
&lt;p&gt;Thanks for reading!&lt;/p&gt;
&lt;small&gt;
  &lt;i&gt;
    This post was written in the Jupyter notebook. You can
    &lt;a href="https://nicoguaro.github.io/downloads/notebooks/finite_diff_map.ipynb"&gt;download&lt;/a&gt;
    this notebook, or see a static view on
    &lt;a href="http://nbviewer.jupyter.org/url/nicoguaro.github.io/downloads/notebooks/finite_diff_map.ipynb"&gt;nbviewer&lt;/a&gt;.
  &lt;i&gt;
&lt;/i&gt;&lt;/i&gt;&lt;/small&gt;&lt;/section&gt;
&lt;/section&gt;</description><category>finite difference method</category><category>pde</category><category>python</category><category>quantum mechanics</category><category>scientific computing</category><guid>https://nicoguaro.github.io/posts/infinite_fdm/</guid><pubDate>Thu, 17 May 2018 20:57:00 GMT</pubDate></item><item><title>Cyclic colormaps comparison</title><link>https://nicoguaro.github.io/posts/cyclic_colormaps/</link><dc:creator>Nicolás Guarín-Zapata</dc:creator><description>&lt;p&gt;I started this post looking for a
&lt;a class="reference external" href="https://en.wikipedia.org/wiki/Diffusion_map"&gt;diffusion map&lt;/a&gt; on Python,
that I didn't find. Then I continued following an
&lt;a class="reference external" href="http://scikit-learn.org/stable/auto_examples/manifold/plot_compare_methods.html#sphx-glr-auto-examples-manifold-plot-compare-methods-py"&gt;example&lt;/a&gt;
on &lt;a class="reference external" href="https://en.wikipedia.org/wiki/Nonlinear_dimensionality_reduction"&gt;manifold learning&lt;/a&gt;
by &lt;a class="reference external" href="https://jakevdp.github.io/"&gt;Jake Vanderplas&lt;/a&gt; on a &lt;a class="reference external" href="https://commons.wikimedia.org/wiki/File:Diffusion_map_of_a_torodial_helix.jpg"&gt;different dataset&lt;/a&gt;.
It worked nicely,&lt;/p&gt;
&lt;img alt="/images/manifold_learning_toroidal_helix.svg" src="https://nicoguaro.github.io/images/manifold_learning_toroidal_helix.svg"&gt;
&lt;p&gt;but the colormap used is &lt;a class="reference external" href="https://matplotlib.org/examples/color/colormaps_reference.html"&gt;Spectral&lt;/a&gt;,
that is divergent. This made me think about
using a cyclic colormap, and ended up in
&lt;a class="reference external" href="https://stackoverflow.com/q/23712207/3358223"&gt;this StackOverflow&lt;/a&gt; question.
And I decided to compare some cyclic colormaps.&lt;/p&gt;
&lt;p&gt;I picked up colormaps from different sources&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference external" href="https://matplotlib.org/cmocean/"&gt;cmocean&lt;/a&gt;:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;phase&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference external" href="http://paraview.org/"&gt;Paraview&lt;/a&gt;:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;hue_L60&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;erdc_iceFire&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;nic_Edge&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference external" href="https://github.com/bokeh/colorcet"&gt;Colorcet&lt;/a&gt;:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;colorwheel&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;cyclic_mrybm_35_75_c68&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;cyclic_mygbm_30_95_c78&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;and, of course, &lt;code class="docutils literal"&gt;hsv&lt;/code&gt;. You can download the colormaps in text
format from &lt;a class="reference external" href="https://nicoguaro.github.io/downloads/cyclic_colormaps.zip"&gt;here&lt;/a&gt;.&lt;/p&gt;
&lt;section id="comparison"&gt;
&lt;h2&gt;Comparison&lt;/h2&gt;
&lt;p&gt;For all the examples below the following imports are done:&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code python"&gt;&lt;a id="rest_code_ed9115b50edf459ba8a7734bee3655fa-1" name="rest_code_ed9115b50edf459ba8a7734bee3655fa-1" href="https://nicoguaro.github.io/posts/cyclic_colormaps/#rest_code_ed9115b50edf459ba8a7734bee3655fa-1"&gt;&lt;/a&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;__future__&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;division&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;print_function&lt;/span&gt;
&lt;a id="rest_code_ed9115b50edf459ba8a7734bee3655fa-2" name="rest_code_ed9115b50edf459ba8a7734bee3655fa-2" href="https://nicoguaro.github.io/posts/cyclic_colormaps/#rest_code_ed9115b50edf459ba8a7734bee3655fa-2"&gt;&lt;/a&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;numpy&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;np&lt;/span&gt;
&lt;a id="rest_code_ed9115b50edf459ba8a7734bee3655fa-3" name="rest_code_ed9115b50edf459ba8a7734bee3655fa-3" href="https://nicoguaro.github.io/posts/cyclic_colormaps/#rest_code_ed9115b50edf459ba8a7734bee3655fa-3"&gt;&lt;/a&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;matplotlib.pyplot&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;plt&lt;/span&gt;
&lt;a id="rest_code_ed9115b50edf459ba8a7734bee3655fa-4" name="rest_code_ed9115b50edf459ba8a7734bee3655fa-4" href="https://nicoguaro.github.io/posts/cyclic_colormaps/#rest_code_ed9115b50edf459ba8a7734bee3655fa-4"&gt;&lt;/a&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;matplotlib.colors&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;LinearSegmentedColormap&lt;/span&gt;
&lt;a id="rest_code_ed9115b50edf459ba8a7734bee3655fa-5" name="rest_code_ed9115b50edf459ba8a7734bee3655fa-5" href="https://nicoguaro.github.io/posts/cyclic_colormaps/#rest_code_ed9115b50edf459ba8a7734bee3655fa-5"&gt;&lt;/a&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;colorspacious&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;cspace_convert&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;section id="color-map-test-image"&gt;
&lt;h3&gt;Color map test image&lt;/h3&gt;
&lt;p&gt;Peter Kovesi proposed a way to compare cyclic colormaps on a
&lt;a class="reference external" href="http://peterkovesi.com/projects/colourmaps/colourmaptestimage.html"&gt;paper&lt;/a&gt;
on 2015. It consists of a spiral ramp with an undulation. In polar coordinates
it reads&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
c = (A \rho^p \sin(n \theta) + \theta)\, \mathrm{mod}\, 2\pi
\end{equation*}
&lt;/div&gt;
&lt;p&gt;with &lt;span class="math"&gt;\(A\)&lt;/span&gt; the amplitude of the oscilation, &lt;span class="math"&gt;\(\rho\)&lt;/span&gt; the normalized
radius in [0, 1], &lt;span class="math"&gt;\(p\)&lt;/span&gt; a positive number, and &lt;span class="math"&gt;\(n\)&lt;/span&gt; the number
of cycles.&lt;/p&gt;
&lt;p&gt;And the following function creates the grid in Python&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code python"&gt;&lt;a id="rest_code_4bff2b45b3764b1f92ba0e273ec1d389-1" name="rest_code_4bff2b45b3764b1f92ba0e273ec1d389-1" href="https://nicoguaro.github.io/posts/cyclic_colormaps/#rest_code_4bff2b45b3764b1f92ba0e273ec1d389-1"&gt;&lt;/a&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;circle_sine_ramp&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;r_max&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;r_min&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mf"&gt;0.3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;amp&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;pi&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;cycles&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;50&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;a id="rest_code_4bff2b45b3764b1f92ba0e273ec1d389-2" name="rest_code_4bff2b45b3764b1f92ba0e273ec1d389-2" href="https://nicoguaro.github.io/posts/cyclic_colormaps/#rest_code_4bff2b45b3764b1f92ba0e273ec1d389-2"&gt;&lt;/a&gt;                     &lt;span class="n"&gt;power&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;nr&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;50&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;ntheta&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;1025&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_4bff2b45b3764b1f92ba0e273ec1d389-3" name="rest_code_4bff2b45b3764b1f92ba0e273ec1d389-3" href="https://nicoguaro.github.io/posts/cyclic_colormaps/#rest_code_4bff2b45b3764b1f92ba0e273ec1d389-3"&gt;&lt;/a&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;t&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;mgrid&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;r_min&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="n"&gt;r_max&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="n"&gt;nr&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;pi&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="n"&gt;ntheta&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_4bff2b45b3764b1f92ba0e273ec1d389-4" name="rest_code_4bff2b45b3764b1f92ba0e273ec1d389-4" href="https://nicoguaro.github.io/posts/cyclic_colormaps/#rest_code_4bff2b45b3764b1f92ba0e273ec1d389-4"&gt;&lt;/a&gt;&lt;span class="n"&gt;r_norm&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;r_min&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;r_max&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;r_min&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_4bff2b45b3764b1f92ba0e273ec1d389-5" name="rest_code_4bff2b45b3764b1f92ba0e273ec1d389-5" href="https://nicoguaro.github.io/posts/cyclic_colormaps/#rest_code_4bff2b45b3764b1f92ba0e273ec1d389-5"&gt;&lt;/a&gt;&lt;span class="n"&gt;vals&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;amp&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;r_norm&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="n"&gt;power&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sin&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;cycles&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;t&lt;/span&gt;
&lt;a id="rest_code_4bff2b45b3764b1f92ba0e273ec1d389-6" name="rest_code_4bff2b45b3764b1f92ba0e273ec1d389-6" href="https://nicoguaro.github.io/posts/cyclic_colormaps/#rest_code_4bff2b45b3764b1f92ba0e273ec1d389-6"&gt;&lt;/a&gt;&lt;span class="n"&gt;vals&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;mod&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;vals&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;pi&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_4bff2b45b3764b1f92ba0e273ec1d389-7" name="rest_code_4bff2b45b3764b1f92ba0e273ec1d389-7" href="https://nicoguaro.github.io/posts/cyclic_colormaps/#rest_code_4bff2b45b3764b1f92ba0e273ec1d389-7"&gt;&lt;/a&gt;&lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;vals&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;The following is the result&lt;/p&gt;
&lt;img alt="/images/sine_helix_cyclic_cmap.png" src="https://nicoguaro.github.io/images/sine_helix_cyclic_cmap.png"&gt;
&lt;/section&gt;
&lt;section id="colorblindness-test"&gt;
&lt;h3&gt;Colorblindness test&lt;/h3&gt;
&lt;div class="code"&gt;&lt;pre class="code python"&gt;&lt;a id="rest_code_c5d65577d6cd441c9085de4bdce6e14e-1" name="rest_code_c5d65577d6cd441c9085de4bdce6e14e-1" href="https://nicoguaro.github.io/posts/cyclic_colormaps/#rest_code_c5d65577d6cd441c9085de4bdce6e14e-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;vals&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;circle_sine_ramp&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;cycles&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_c5d65577d6cd441c9085de4bdce6e14e-2" name="rest_code_c5d65577d6cd441c9085de4bdce6e14e-2" href="https://nicoguaro.github.io/posts/cyclic_colormaps/#rest_code_c5d65577d6cd441c9085de4bdce6e14e-2"&gt;&lt;/a&gt;&lt;span class="n"&gt;cmaps&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;"hsv"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;a id="rest_code_c5d65577d6cd441c9085de4bdce6e14e-3" name="rest_code_c5d65577d6cd441c9085de4bdce6e14e-3" href="https://nicoguaro.github.io/posts/cyclic_colormaps/#rest_code_c5d65577d6cd441c9085de4bdce6e14e-3"&gt;&lt;/a&gt;         &lt;span class="s2"&gt;"cmocean_phase"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;a id="rest_code_c5d65577d6cd441c9085de4bdce6e14e-4" name="rest_code_c5d65577d6cd441c9085de4bdce6e14e-4" href="https://nicoguaro.github.io/posts/cyclic_colormaps/#rest_code_c5d65577d6cd441c9085de4bdce6e14e-4"&gt;&lt;/a&gt;         &lt;span class="s2"&gt;"hue_L60"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;a id="rest_code_c5d65577d6cd441c9085de4bdce6e14e-5" name="rest_code_c5d65577d6cd441c9085de4bdce6e14e-5" href="https://nicoguaro.github.io/posts/cyclic_colormaps/#rest_code_c5d65577d6cd441c9085de4bdce6e14e-5"&gt;&lt;/a&gt;         &lt;span class="s2"&gt;"erdc_iceFire"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;a id="rest_code_c5d65577d6cd441c9085de4bdce6e14e-6" name="rest_code_c5d65577d6cd441c9085de4bdce6e14e-6" href="https://nicoguaro.github.io/posts/cyclic_colormaps/#rest_code_c5d65577d6cd441c9085de4bdce6e14e-6"&gt;&lt;/a&gt;         &lt;span class="s2"&gt;"nic_Edge"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;a id="rest_code_c5d65577d6cd441c9085de4bdce6e14e-7" name="rest_code_c5d65577d6cd441c9085de4bdce6e14e-7" href="https://nicoguaro.github.io/posts/cyclic_colormaps/#rest_code_c5d65577d6cd441c9085de4bdce6e14e-7"&gt;&lt;/a&gt;         &lt;span class="s2"&gt;"colorwheel"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;a id="rest_code_c5d65577d6cd441c9085de4bdce6e14e-8" name="rest_code_c5d65577d6cd441c9085de4bdce6e14e-8" href="https://nicoguaro.github.io/posts/cyclic_colormaps/#rest_code_c5d65577d6cd441c9085de4bdce6e14e-8"&gt;&lt;/a&gt;         &lt;span class="s2"&gt;"cyclic_mrybm"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;a id="rest_code_c5d65577d6cd441c9085de4bdce6e14e-9" name="rest_code_c5d65577d6cd441c9085de4bdce6e14e-9" href="https://nicoguaro.github.io/posts/cyclic_colormaps/#rest_code_c5d65577d6cd441c9085de4bdce6e14e-9"&gt;&lt;/a&gt;         &lt;span class="s2"&gt;"cyclic_mygbm"&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_c5d65577d6cd441c9085de4bdce6e14e-10" name="rest_code_c5d65577d6cd441c9085de4bdce6e14e-10" href="https://nicoguaro.github.io/posts/cyclic_colormaps/#rest_code_c5d65577d6cd441c9085de4bdce6e14e-10"&gt;&lt;/a&gt;&lt;span class="n"&gt;severity&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;50&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;50&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;50&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_c5d65577d6cd441c9085de4bdce6e14e-11" name="rest_code_c5d65577d6cd441c9085de4bdce6e14e-11" href="https://nicoguaro.github.io/posts/cyclic_colormaps/#rest_code_c5d65577d6cd441c9085de4bdce6e14e-11"&gt;&lt;/a&gt;&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;colormap&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;cmaps&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a id="rest_code_c5d65577d6cd441c9085de4bdce6e14e-12" name="rest_code_c5d65577d6cd441c9085de4bdce6e14e-12" href="https://nicoguaro.github.io/posts/cyclic_colormaps/#rest_code_c5d65577d6cd441c9085de4bdce6e14e-12"&gt;&lt;/a&gt;    &lt;span class="n"&gt;data&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;loadtxt&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;colormap&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="s2"&gt;".txt"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_c5d65577d6cd441c9085de4bdce6e14e-13" name="rest_code_c5d65577d6cd441c9085de4bdce6e14e-13" href="https://nicoguaro.github.io/posts/cyclic_colormaps/#rest_code_c5d65577d6cd441c9085de4bdce6e14e-13"&gt;&lt;/a&gt;    &lt;span class="n"&gt;fig&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;figure&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a id="rest_code_c5d65577d6cd441c9085de4bdce6e14e-14" name="rest_code_c5d65577d6cd441c9085de4bdce6e14e-14" href="https://nicoguaro.github.io/posts/cyclic_colormaps/#rest_code_c5d65577d6cd441c9085de4bdce6e14e-14"&gt;&lt;/a&gt;    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;cont&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_c5d65577d6cd441c9085de4bdce6e14e-15" name="rest_code_c5d65577d6cd441c9085de4bdce6e14e-15" href="https://nicoguaro.github.io/posts/cyclic_colormaps/#rest_code_c5d65577d6cd441c9085de4bdce6e14e-15"&gt;&lt;/a&gt;        &lt;span class="n"&gt;cvd_space&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="s2"&gt;"name"&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s2"&gt;"sRGB1+CVD"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;a id="rest_code_c5d65577d6cd441c9085de4bdce6e14e-16" name="rest_code_c5d65577d6cd441c9085de4bdce6e14e-16" href="https://nicoguaro.github.io/posts/cyclic_colormaps/#rest_code_c5d65577d6cd441c9085de4bdce6e14e-16"&gt;&lt;/a&gt;             &lt;span class="s2"&gt;"cvd_type"&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;cvd_type&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;cont&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;
&lt;a id="rest_code_c5d65577d6cd441c9085de4bdce6e14e-17" name="rest_code_c5d65577d6cd441c9085de4bdce6e14e-17" href="https://nicoguaro.github.io/posts/cyclic_colormaps/#rest_code_c5d65577d6cd441c9085de4bdce6e14e-17"&gt;&lt;/a&gt;             &lt;span class="s2"&gt;"severity"&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;severity&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;cont&lt;/span&gt;&lt;span class="p"&gt;]}&lt;/span&gt;
&lt;a id="rest_code_c5d65577d6cd441c9085de4bdce6e14e-18" name="rest_code_c5d65577d6cd441c9085de4bdce6e14e-18" href="https://nicoguaro.github.io/posts/cyclic_colormaps/#rest_code_c5d65577d6cd441c9085de4bdce6e14e-18"&gt;&lt;/a&gt;        &lt;span class="n"&gt;data2&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;cspace_convert&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;cvd_space&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;"sRGB1"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_c5d65577d6cd441c9085de4bdce6e14e-19" name="rest_code_c5d65577d6cd441c9085de4bdce6e14e-19" href="https://nicoguaro.github.io/posts/cyclic_colormaps/#rest_code_c5d65577d6cd441c9085de4bdce6e14e-19"&gt;&lt;/a&gt;        &lt;span class="n"&gt;data2&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;clip&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;data2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_c5d65577d6cd441c9085de4bdce6e14e-20" name="rest_code_c5d65577d6cd441c9085de4bdce6e14e-20" href="https://nicoguaro.github.io/posts/cyclic_colormaps/#rest_code_c5d65577d6cd441c9085de4bdce6e14e-20"&gt;&lt;/a&gt;        &lt;span class="n"&gt;cmap&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;LinearSegmentedColormap&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;from_list&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'my_colormap'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;data2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_c5d65577d6cd441c9085de4bdce6e14e-21" name="rest_code_c5d65577d6cd441c9085de4bdce6e14e-21" href="https://nicoguaro.github.io/posts/cyclic_colormaps/#rest_code_c5d65577d6cd441c9085de4bdce6e14e-21"&gt;&lt;/a&gt;        &lt;span class="n"&gt;ax&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;subplot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;cont&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;projection&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;"polar"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_c5d65577d6cd441c9085de4bdce6e14e-22" name="rest_code_c5d65577d6cd441c9085de4bdce6e14e-22" href="https://nicoguaro.github.io/posts/cyclic_colormaps/#rest_code_c5d65577d6cd441c9085de4bdce6e14e-22"&gt;&lt;/a&gt;        &lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;pcolormesh&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;vals&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;cmap&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;cmap&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_c5d65577d6cd441c9085de4bdce6e14e-23" name="rest_code_c5d65577d6cd441c9085de4bdce6e14e-23" href="https://nicoguaro.github.io/posts/cyclic_colormaps/#rest_code_c5d65577d6cd441c9085de4bdce6e14e-23"&gt;&lt;/a&gt;        &lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_xticks&lt;/span&gt;&lt;span class="p"&gt;([])&lt;/span&gt;
&lt;a id="rest_code_c5d65577d6cd441c9085de4bdce6e14e-24" name="rest_code_c5d65577d6cd441c9085de4bdce6e14e-24" href="https://nicoguaro.github.io/posts/cyclic_colormaps/#rest_code_c5d65577d6cd441c9085de4bdce6e14e-24"&gt;&lt;/a&gt;        &lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_yticks&lt;/span&gt;&lt;span class="p"&gt;([])&lt;/span&gt;
&lt;a id="rest_code_c5d65577d6cd441c9085de4bdce6e14e-25" name="rest_code_c5d65577d6cd441c9085de4bdce6e14e-25" href="https://nicoguaro.github.io/posts/cyclic_colormaps/#rest_code_c5d65577d6cd441c9085de4bdce6e14e-25"&gt;&lt;/a&gt;    &lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;suptitle&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;colormap&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_c5d65577d6cd441c9085de4bdce6e14e-26" name="rest_code_c5d65577d6cd441c9085de4bdce6e14e-26" href="https://nicoguaro.github.io/posts/cyclic_colormaps/#rest_code_c5d65577d6cd441c9085de4bdce6e14e-26"&gt;&lt;/a&gt;    &lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;tight_layout&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a id="rest_code_c5d65577d6cd441c9085de4bdce6e14e-27" name="rest_code_c5d65577d6cd441c9085de4bdce6e14e-27" href="https://nicoguaro.github.io/posts/cyclic_colormaps/#rest_code_c5d65577d6cd441c9085de4bdce6e14e-27"&gt;&lt;/a&gt;    &lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;savefig&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;colormap&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="s2"&gt;".png"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;dpi&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;300&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;figure class="align-center"&gt;
&lt;img alt="/images/hsv_eval.png" src="https://nicoguaro.github.io/images/hsv_eval.png"&gt;
&lt;figcaption&gt;
&lt;p&gt;&lt;code class="docutils literal"&gt;hsv&lt;/code&gt; colormap comparison for different color vision deficiencies.&lt;/p&gt;
&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;figure class="align-center"&gt;
&lt;img alt="/images/cmocean_phase_eval.png" src="https://nicoguaro.github.io/images/cmocean_phase_eval.png"&gt;
&lt;figcaption&gt;
&lt;p&gt;&lt;code class="docutils literal"&gt;Phase&lt;/code&gt; colormap comparison for different color vision deficiencies.&lt;/p&gt;
&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;figure class="align-center"&gt;
&lt;img alt="/images/hue_L60_eval.png" src="https://nicoguaro.github.io/images/hue_L60_eval.png"&gt;
&lt;figcaption&gt;
&lt;p&gt;&lt;code class="docutils literal"&gt;hue_L60&lt;/code&gt; colormap comparison for different color vision deficiencies.&lt;/p&gt;
&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;figure class="align-center"&gt;
&lt;img alt="/images/erdc_iceFire_eval.png" src="https://nicoguaro.github.io/images/erdc_iceFire_eval.png"&gt;
&lt;figcaption&gt;
&lt;p&gt;&lt;code class="docutils literal"&gt;erdc_iceFire&lt;/code&gt; colormap comparison for different color vision deficiencies.&lt;/p&gt;
&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;figure class="align-center"&gt;
&lt;img alt="/images/nic_Edge_eval.png" src="https://nicoguaro.github.io/images/nic_Edge_eval.png"&gt;
&lt;figcaption&gt;
&lt;p&gt;&lt;code class="docutils literal"&gt;nic_Edge&lt;/code&gt; colormap comparison for different color vision deficiencies.&lt;/p&gt;
&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;figure class="align-center"&gt;
&lt;img alt="/images/colorwheel_eval.png" src="https://nicoguaro.github.io/images/colorwheel_eval.png"&gt;
&lt;figcaption&gt;
&lt;p&gt;&lt;code class="docutils literal"&gt;Colorwheel&lt;/code&gt; colormap comparison for different color vision deficiencies.&lt;/p&gt;
&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;figure class="align-center"&gt;
&lt;img alt="/images/cyclic_mrybm_eval.png" src="https://nicoguaro.github.io/images/cyclic_mrybm_eval.png"&gt;
&lt;figcaption&gt;
&lt;p&gt;&lt;code class="docutils literal"&gt;Cyclic_mrybm&lt;/code&gt; colormap comparison for different color vision deficiencies.&lt;/p&gt;
&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;figure class="align-center"&gt;
&lt;img alt="/images/cyclic_mygbm_eval.png" src="https://nicoguaro.github.io/images/cyclic_mygbm_eval.png"&gt;
&lt;figcaption&gt;
&lt;p&gt;&lt;code class="docutils literal"&gt;Cyclic_mygbm&lt;/code&gt; colormap comparison for different color vision deficiencies.&lt;/p&gt;
&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;/section&gt;
&lt;/section&gt;
&lt;section id="randomly-generated-cyclic-colormaps"&gt;
&lt;h2&gt;Randomly generated cyclic colormaps&lt;/h2&gt;
&lt;p&gt;What if we generate some random colormaps that are cyclic? How would they
look like?&lt;/p&gt;
&lt;p&gt;Following are the snippet and resulting colormaps.&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code python"&gt;&lt;a id="rest_code_feb0411a0a514e33b694b2b5338ae905-1" name="rest_code_feb0411a0a514e33b694b2b5338ae905-1" href="https://nicoguaro.github.io/posts/cyclic_colormaps/#rest_code_feb0411a0a514e33b694b2b5338ae905-1"&gt;&lt;/a&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;__future__&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;division&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;print_function&lt;/span&gt;
&lt;a id="rest_code_feb0411a0a514e33b694b2b5338ae905-2" name="rest_code_feb0411a0a514e33b694b2b5338ae905-2" href="https://nicoguaro.github.io/posts/cyclic_colormaps/#rest_code_feb0411a0a514e33b694b2b5338ae905-2"&gt;&lt;/a&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;numpy&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;np&lt;/span&gt;
&lt;a id="rest_code_feb0411a0a514e33b694b2b5338ae905-3" name="rest_code_feb0411a0a514e33b694b2b5338ae905-3" href="https://nicoguaro.github.io/posts/cyclic_colormaps/#rest_code_feb0411a0a514e33b694b2b5338ae905-3"&gt;&lt;/a&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;mpl_toolkits.mplot3d&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;Axes3D&lt;/span&gt;
&lt;a id="rest_code_feb0411a0a514e33b694b2b5338ae905-4" name="rest_code_feb0411a0a514e33b694b2b5338ae905-4" href="https://nicoguaro.github.io/posts/cyclic_colormaps/#rest_code_feb0411a0a514e33b694b2b5338ae905-4"&gt;&lt;/a&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;matplotlib.pyplot&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;plt&lt;/span&gt;
&lt;a id="rest_code_feb0411a0a514e33b694b2b5338ae905-5" name="rest_code_feb0411a0a514e33b694b2b5338ae905-5" href="https://nicoguaro.github.io/posts/cyclic_colormaps/#rest_code_feb0411a0a514e33b694b2b5338ae905-5"&gt;&lt;/a&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;matplotlib.colors&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;LinearSegmentedColormap&lt;/span&gt;
&lt;a id="rest_code_feb0411a0a514e33b694b2b5338ae905-6" name="rest_code_feb0411a0a514e33b694b2b5338ae905-6" href="https://nicoguaro.github.io/posts/cyclic_colormaps/#rest_code_feb0411a0a514e33b694b2b5338ae905-6"&gt;&lt;/a&gt;
&lt;a id="rest_code_feb0411a0a514e33b694b2b5338ae905-7" name="rest_code_feb0411a0a514e33b694b2b5338ae905-7" href="https://nicoguaro.github.io/posts/cyclic_colormaps/#rest_code_feb0411a0a514e33b694b2b5338ae905-7"&gt;&lt;/a&gt;
&lt;a id="rest_code_feb0411a0a514e33b694b2b5338ae905-8" name="rest_code_feb0411a0a514e33b694b2b5338ae905-8" href="https://nicoguaro.github.io/posts/cyclic_colormaps/#rest_code_feb0411a0a514e33b694b2b5338ae905-8"&gt;&lt;/a&gt;&lt;span class="c1"&gt;# Next line to silence pyflakes. This import is needed.&lt;/span&gt;
&lt;a id="rest_code_feb0411a0a514e33b694b2b5338ae905-9" name="rest_code_feb0411a0a514e33b694b2b5338ae905-9" href="https://nicoguaro.github.io/posts/cyclic_colormaps/#rest_code_feb0411a0a514e33b694b2b5338ae905-9"&gt;&lt;/a&gt;&lt;span class="n"&gt;Axes3D&lt;/span&gt;
&lt;a id="rest_code_feb0411a0a514e33b694b2b5338ae905-10" name="rest_code_feb0411a0a514e33b694b2b5338ae905-10" href="https://nicoguaro.github.io/posts/cyclic_colormaps/#rest_code_feb0411a0a514e33b694b2b5338ae905-10"&gt;&lt;/a&gt;
&lt;a id="rest_code_feb0411a0a514e33b694b2b5338ae905-11" name="rest_code_feb0411a0a514e33b694b2b5338ae905-11" href="https://nicoguaro.github.io/posts/cyclic_colormaps/#rest_code_feb0411a0a514e33b694b2b5338ae905-11"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;close&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"all"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_feb0411a0a514e33b694b2b5338ae905-12" name="rest_code_feb0411a0a514e33b694b2b5338ae905-12" href="https://nicoguaro.github.io/posts/cyclic_colormaps/#rest_code_feb0411a0a514e33b694b2b5338ae905-12"&gt;&lt;/a&gt;&lt;span class="n"&gt;fig&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;figure&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a id="rest_code_feb0411a0a514e33b694b2b5338ae905-13" name="rest_code_feb0411a0a514e33b694b2b5338ae905-13" href="https://nicoguaro.github.io/posts/cyclic_colormaps/#rest_code_feb0411a0a514e33b694b2b5338ae905-13"&gt;&lt;/a&gt;&lt;span class="n"&gt;fig2&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;figure&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a id="rest_code_feb0411a0a514e33b694b2b5338ae905-14" name="rest_code_feb0411a0a514e33b694b2b5338ae905-14" href="https://nicoguaro.github.io/posts/cyclic_colormaps/#rest_code_feb0411a0a514e33b694b2b5338ae905-14"&gt;&lt;/a&gt;&lt;span class="n"&gt;nx&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;4&lt;/span&gt;
&lt;a id="rest_code_feb0411a0a514e33b694b2b5338ae905-15" name="rest_code_feb0411a0a514e33b694b2b5338ae905-15" href="https://nicoguaro.github.io/posts/cyclic_colormaps/#rest_code_feb0411a0a514e33b694b2b5338ae905-15"&gt;&lt;/a&gt;&lt;span class="n"&gt;ny&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;4&lt;/span&gt;
&lt;a id="rest_code_feb0411a0a514e33b694b2b5338ae905-16" name="rest_code_feb0411a0a514e33b694b2b5338ae905-16" href="https://nicoguaro.github.io/posts/cyclic_colormaps/#rest_code_feb0411a0a514e33b694b2b5338ae905-16"&gt;&lt;/a&gt;&lt;span class="n"&gt;azimuths&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;arange&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;361&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_feb0411a0a514e33b694b2b5338ae905-17" name="rest_code_feb0411a0a514e33b694b2b5338ae905-17" href="https://nicoguaro.github.io/posts/cyclic_colormaps/#rest_code_feb0411a0a514e33b694b2b5338ae905-17"&gt;&lt;/a&gt;&lt;span class="n"&gt;zeniths&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;arange&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;30&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;70&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_feb0411a0a514e33b694b2b5338ae905-18" name="rest_code_feb0411a0a514e33b694b2b5338ae905-18" href="https://nicoguaro.github.io/posts/cyclic_colormaps/#rest_code_feb0411a0a514e33b694b2b5338ae905-18"&gt;&lt;/a&gt;&lt;span class="n"&gt;values&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;azimuths&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ones&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="mi"&gt;30&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;361&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_feb0411a0a514e33b694b2b5338ae905-19" name="rest_code_feb0411a0a514e33b694b2b5338ae905-19" href="https://nicoguaro.github.io/posts/cyclic_colormaps/#rest_code_feb0411a0a514e33b694b2b5338ae905-19"&gt;&lt;/a&gt;&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;cont&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;nx&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;ny&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_feb0411a0a514e33b694b2b5338ae905-20" name="rest_code_feb0411a0a514e33b694b2b5338ae905-20" href="https://nicoguaro.github.io/posts/cyclic_colormaps/#rest_code_feb0411a0a514e33b694b2b5338ae905-20"&gt;&lt;/a&gt;    &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;random&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;seed&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;seed&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;cont&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_feb0411a0a514e33b694b2b5338ae905-21" name="rest_code_feb0411a0a514e33b694b2b5338ae905-21" href="https://nicoguaro.github.io/posts/cyclic_colormaps/#rest_code_feb0411a0a514e33b694b2b5338ae905-21"&gt;&lt;/a&gt;    &lt;span class="n"&gt;rad&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;random&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;uniform&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;0.1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.5&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_feb0411a0a514e33b694b2b5338ae905-22" name="rest_code_feb0411a0a514e33b694b2b5338ae905-22" href="https://nicoguaro.github.io/posts/cyclic_colormaps/#rest_code_feb0411a0a514e33b694b2b5338ae905-22"&gt;&lt;/a&gt;    &lt;span class="n"&gt;center&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;random&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;uniform&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;rad&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;rad&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;size&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_feb0411a0a514e33b694b2b5338ae905-23" name="rest_code_feb0411a0a514e33b694b2b5338ae905-23" href="https://nicoguaro.github.io/posts/cyclic_colormaps/#rest_code_feb0411a0a514e33b694b2b5338ae905-23"&gt;&lt;/a&gt;    &lt;span class="n"&gt;mat&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;random&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;rand&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_feb0411a0a514e33b694b2b5338ae905-24" name="rest_code_feb0411a0a514e33b694b2b5338ae905-24" href="https://nicoguaro.github.io/posts/cyclic_colormaps/#rest_code_feb0411a0a514e33b694b2b5338ae905-24"&gt;&lt;/a&gt;    &lt;span class="n"&gt;rot_mat&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;_&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;linalg&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;qr&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;mat&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_feb0411a0a514e33b694b2b5338ae905-25" name="rest_code_feb0411a0a514e33b694b2b5338ae905-25" href="https://nicoguaro.github.io/posts/cyclic_colormaps/#rest_code_feb0411a0a514e33b694b2b5338ae905-25"&gt;&lt;/a&gt;    &lt;span class="n"&gt;t&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;linspace&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;pi&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;256&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_feb0411a0a514e33b694b2b5338ae905-26" name="rest_code_feb0411a0a514e33b694b2b5338ae905-26" href="https://nicoguaro.github.io/posts/cyclic_colormaps/#rest_code_feb0411a0a514e33b694b2b5338ae905-26"&gt;&lt;/a&gt;    &lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;rad&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;cos&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_feb0411a0a514e33b694b2b5338ae905-27" name="rest_code_feb0411a0a514e33b694b2b5338ae905-27" href="https://nicoguaro.github.io/posts/cyclic_colormaps/#rest_code_feb0411a0a514e33b694b2b5338ae905-27"&gt;&lt;/a&gt;    &lt;span class="n"&gt;y&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;rad&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sin&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_feb0411a0a514e33b694b2b5338ae905-28" name="rest_code_feb0411a0a514e33b694b2b5338ae905-28" href="https://nicoguaro.github.io/posts/cyclic_colormaps/#rest_code_feb0411a0a514e33b694b2b5338ae905-28"&gt;&lt;/a&gt;    &lt;span class="n"&gt;z&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;0.0&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;cos&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_feb0411a0a514e33b694b2b5338ae905-29" name="rest_code_feb0411a0a514e33b694b2b5338ae905-29" href="https://nicoguaro.github.io/posts/cyclic_colormaps/#rest_code_feb0411a0a514e33b694b2b5338ae905-29"&gt;&lt;/a&gt;    &lt;span class="n"&gt;X&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;vstack&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;z&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_feb0411a0a514e33b694b2b5338ae905-30" name="rest_code_feb0411a0a514e33b694b2b5338ae905-30" href="https://nicoguaro.github.io/posts/cyclic_colormaps/#rest_code_feb0411a0a514e33b694b2b5338ae905-30"&gt;&lt;/a&gt;    &lt;span class="n"&gt;X&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;rot_mat&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;dot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;X&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;center&lt;/span&gt;
&lt;a id="rest_code_feb0411a0a514e33b694b2b5338ae905-31" name="rest_code_feb0411a0a514e33b694b2b5338ae905-31" href="https://nicoguaro.github.io/posts/cyclic_colormaps/#rest_code_feb0411a0a514e33b694b2b5338ae905-31"&gt;&lt;/a&gt;
&lt;a id="rest_code_feb0411a0a514e33b694b2b5338ae905-32" name="rest_code_feb0411a0a514e33b694b2b5338ae905-32" href="https://nicoguaro.github.io/posts/cyclic_colormaps/#rest_code_feb0411a0a514e33b694b2b5338ae905-32"&gt;&lt;/a&gt;    &lt;span class="n"&gt;ax&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;fig&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;add_subplot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ny&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;nx&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;cont&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;projection&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'polar'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_feb0411a0a514e33b694b2b5338ae905-33" name="rest_code_feb0411a0a514e33b694b2b5338ae905-33" href="https://nicoguaro.github.io/posts/cyclic_colormaps/#rest_code_feb0411a0a514e33b694b2b5338ae905-33"&gt;&lt;/a&gt;    &lt;span class="n"&gt;cmap&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;LinearSegmentedColormap&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;from_list&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'my_colormap'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;X&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;T&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_feb0411a0a514e33b694b2b5338ae905-34" name="rest_code_feb0411a0a514e33b694b2b5338ae905-34" href="https://nicoguaro.github.io/posts/cyclic_colormaps/#rest_code_feb0411a0a514e33b694b2b5338ae905-34"&gt;&lt;/a&gt;    &lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;pcolormesh&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;azimuths&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;pi&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="mf"&gt;180.0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;zeniths&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;values&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;cmap&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;cmap&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_feb0411a0a514e33b694b2b5338ae905-35" name="rest_code_feb0411a0a514e33b694b2b5338ae905-35" href="https://nicoguaro.github.io/posts/cyclic_colormaps/#rest_code_feb0411a0a514e33b694b2b5338ae905-35"&gt;&lt;/a&gt;    &lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_xticks&lt;/span&gt;&lt;span class="p"&gt;([])&lt;/span&gt;
&lt;a id="rest_code_feb0411a0a514e33b694b2b5338ae905-36" name="rest_code_feb0411a0a514e33b694b2b5338ae905-36" href="https://nicoguaro.github.io/posts/cyclic_colormaps/#rest_code_feb0411a0a514e33b694b2b5338ae905-36"&gt;&lt;/a&gt;    &lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_yticks&lt;/span&gt;&lt;span class="p"&gt;([])&lt;/span&gt;
&lt;a id="rest_code_feb0411a0a514e33b694b2b5338ae905-37" name="rest_code_feb0411a0a514e33b694b2b5338ae905-37" href="https://nicoguaro.github.io/posts/cyclic_colormaps/#rest_code_feb0411a0a514e33b694b2b5338ae905-37"&gt;&lt;/a&gt;
&lt;a id="rest_code_feb0411a0a514e33b694b2b5338ae905-38" name="rest_code_feb0411a0a514e33b694b2b5338ae905-38" href="https://nicoguaro.github.io/posts/cyclic_colormaps/#rest_code_feb0411a0a514e33b694b2b5338ae905-38"&gt;&lt;/a&gt;    &lt;span class="n"&gt;ax2&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;fig2&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;add_subplot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ny&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;nx&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;cont&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;projection&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'3d'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_feb0411a0a514e33b694b2b5338ae905-39" name="rest_code_feb0411a0a514e33b694b2b5338ae905-39" href="https://nicoguaro.github.io/posts/cyclic_colormaps/#rest_code_feb0411a0a514e33b694b2b5338ae905-39"&gt;&lt;/a&gt;    &lt;span class="n"&gt;ax2&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;plot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;X&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;:],&lt;/span&gt; &lt;span class="n"&gt;X&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;:],&lt;/span&gt; &lt;span class="n"&gt;X&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;:])&lt;/span&gt;
&lt;a id="rest_code_feb0411a0a514e33b694b2b5338ae905-40" name="rest_code_feb0411a0a514e33b694b2b5338ae905-40" href="https://nicoguaro.github.io/posts/cyclic_colormaps/#rest_code_feb0411a0a514e33b694b2b5338ae905-40"&gt;&lt;/a&gt;    &lt;span class="n"&gt;ax2&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_xlim&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_feb0411a0a514e33b694b2b5338ae905-41" name="rest_code_feb0411a0a514e33b694b2b5338ae905-41" href="https://nicoguaro.github.io/posts/cyclic_colormaps/#rest_code_feb0411a0a514e33b694b2b5338ae905-41"&gt;&lt;/a&gt;    &lt;span class="n"&gt;ax2&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_ylim&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_feb0411a0a514e33b694b2b5338ae905-42" name="rest_code_feb0411a0a514e33b694b2b5338ae905-42" href="https://nicoguaro.github.io/posts/cyclic_colormaps/#rest_code_feb0411a0a514e33b694b2b5338ae905-42"&gt;&lt;/a&gt;    &lt;span class="n"&gt;ax2&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_zlim&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_feb0411a0a514e33b694b2b5338ae905-43" name="rest_code_feb0411a0a514e33b694b2b5338ae905-43" href="https://nicoguaro.github.io/posts/cyclic_colormaps/#rest_code_feb0411a0a514e33b694b2b5338ae905-43"&gt;&lt;/a&gt;    &lt;span class="n"&gt;ax2&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;view_init&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;30&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;60&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_feb0411a0a514e33b694b2b5338ae905-44" name="rest_code_feb0411a0a514e33b694b2b5338ae905-44" href="https://nicoguaro.github.io/posts/cyclic_colormaps/#rest_code_feb0411a0a514e33b694b2b5338ae905-44"&gt;&lt;/a&gt;    &lt;span class="n"&gt;ax2&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_xticks&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.5&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;1.0&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_feb0411a0a514e33b694b2b5338ae905-45" name="rest_code_feb0411a0a514e33b694b2b5338ae905-45" href="https://nicoguaro.github.io/posts/cyclic_colormaps/#rest_code_feb0411a0a514e33b694b2b5338ae905-45"&gt;&lt;/a&gt;    &lt;span class="n"&gt;ax2&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_yticks&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.5&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;1.0&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_feb0411a0a514e33b694b2b5338ae905-46" name="rest_code_feb0411a0a514e33b694b2b5338ae905-46" href="https://nicoguaro.github.io/posts/cyclic_colormaps/#rest_code_feb0411a0a514e33b694b2b5338ae905-46"&gt;&lt;/a&gt;    &lt;span class="n"&gt;ax2&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_zticks&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.5&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;1.0&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_feb0411a0a514e33b694b2b5338ae905-47" name="rest_code_feb0411a0a514e33b694b2b5338ae905-47" href="https://nicoguaro.github.io/posts/cyclic_colormaps/#rest_code_feb0411a0a514e33b694b2b5338ae905-47"&gt;&lt;/a&gt;    &lt;span class="n"&gt;ax2&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_xticklabels&lt;/span&gt;&lt;span class="p"&gt;([])&lt;/span&gt;
&lt;a id="rest_code_feb0411a0a514e33b694b2b5338ae905-48" name="rest_code_feb0411a0a514e33b694b2b5338ae905-48" href="https://nicoguaro.github.io/posts/cyclic_colormaps/#rest_code_feb0411a0a514e33b694b2b5338ae905-48"&gt;&lt;/a&gt;    &lt;span class="n"&gt;ax2&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_yticklabels&lt;/span&gt;&lt;span class="p"&gt;([])&lt;/span&gt;
&lt;a id="rest_code_feb0411a0a514e33b694b2b5338ae905-49" name="rest_code_feb0411a0a514e33b694b2b5338ae905-49" href="https://nicoguaro.github.io/posts/cyclic_colormaps/#rest_code_feb0411a0a514e33b694b2b5338ae905-49"&gt;&lt;/a&gt;    &lt;span class="n"&gt;ax2&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_zticklabels&lt;/span&gt;&lt;span class="p"&gt;([])&lt;/span&gt;
&lt;a id="rest_code_feb0411a0a514e33b694b2b5338ae905-50" name="rest_code_feb0411a0a514e33b694b2b5338ae905-50" href="https://nicoguaro.github.io/posts/cyclic_colormaps/#rest_code_feb0411a0a514e33b694b2b5338ae905-50"&gt;&lt;/a&gt;
&lt;a id="rest_code_feb0411a0a514e33b694b2b5338ae905-51" name="rest_code_feb0411a0a514e33b694b2b5338ae905-51" href="https://nicoguaro.github.io/posts/cyclic_colormaps/#rest_code_feb0411a0a514e33b694b2b5338ae905-51"&gt;&lt;/a&gt;
&lt;a id="rest_code_feb0411a0a514e33b694b2b5338ae905-52" name="rest_code_feb0411a0a514e33b694b2b5338ae905-52" href="https://nicoguaro.github.io/posts/cyclic_colormaps/#rest_code_feb0411a0a514e33b694b2b5338ae905-52"&gt;&lt;/a&gt;&lt;span class="n"&gt;fig&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;savefig&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"random_cmaps.png"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;dpi&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;300&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;transparent&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;True&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_feb0411a0a514e33b694b2b5338ae905-53" name="rest_code_feb0411a0a514e33b694b2b5338ae905-53" href="https://nicoguaro.github.io/posts/cyclic_colormaps/#rest_code_feb0411a0a514e33b694b2b5338ae905-53"&gt;&lt;/a&gt;&lt;span class="n"&gt;fig2&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;savefig&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"random_cmaps_traj.svg"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;transparent&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;True&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;figure class="align-center"&gt;
&lt;img alt="/images/random_cmaps.png" src="https://nicoguaro.github.io/images/random_cmaps.png"&gt;
&lt;figcaption&gt;
&lt;p&gt;16 randomly generated colormaps.&lt;/p&gt;
&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;figure class="align-center"&gt;
&lt;img alt="/images/random_cmaps_traj.svg" src="https://nicoguaro.github.io/images/random_cmaps_traj.svg"&gt;
&lt;figcaption&gt;
&lt;p&gt;Trajectories in RGB space for the randomly generated colormaps.&lt;/p&gt;
&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;A good idea would be to take these colormaps and optimize some perceptual
parameters such as lightness to get some usable ones.&lt;/p&gt;
&lt;/section&gt;
&lt;section id="conclusions"&gt;
&lt;h2&gt;Conclusions&lt;/h2&gt;
&lt;p&gt;I probably would use &lt;code class="docutils literal"&gt;phase&lt;/code&gt;, &lt;code class="docutils literal"&gt;colorwheel&lt;/code&gt;, or &lt;code class="docutils literal"&gt;mrybm&lt;/code&gt; in the
future.&lt;/p&gt;
&lt;figure class="align-center"&gt;
&lt;img alt="/images/toroidal_helix_phase.svg" src="https://nicoguaro.github.io/images/toroidal_helix_phase.svg"&gt;
&lt;figcaption&gt;
&lt;p&gt;Initial image using &lt;code class="docutils literal"&gt;phase&lt;/code&gt;.&lt;/p&gt;
&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;figure class="align-center"&gt;
&lt;img alt="/images/toroidal_helix_colorwheel.svg" src="https://nicoguaro.github.io/images/toroidal_helix_colorwheel.svg"&gt;
&lt;figcaption&gt;
&lt;p&gt;Initial image using &lt;code class="docutils literal"&gt;colorwheel&lt;/code&gt;.&lt;/p&gt;
&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;figure class="align-center"&gt;
&lt;img alt="/images/toroidal_helix_mrybm.svg" src="https://nicoguaro.github.io/images/toroidal_helix_mrybm.svg"&gt;
&lt;figcaption&gt;
&lt;p&gt;Initial image using &lt;code class="docutils literal"&gt;mrybm&lt;/code&gt;.&lt;/p&gt;
&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;/section&gt;
&lt;section id="references"&gt;
&lt;h2&gt;References&lt;/h2&gt;
&lt;ol class="arabic simple"&gt;
&lt;li&gt;&lt;p&gt;Peter Kovesi. Good Colour Maps: How to Design Them.
arXiv:1509.03700 [cs.GR] 2015&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;/section&gt;</description><category>matplotlib</category><category>python</category><category>scientific computing</category><category>visualization</category><guid>https://nicoguaro.github.io/posts/cyclic_colormaps/</guid><pubDate>Tue, 02 Jan 2018 23:55:41 GMT</pubDate></item><item><title>Probability that a random tetrahedron over a sphere contains its center</title><link>https://nicoguaro.github.io/posts/putnam_prob/</link><dc:creator>Nicolás Guarín-Zapata</dc:creator><description>&lt;p&gt;I got interested in this problem watching the YouTube channel
&lt;a class="reference external" href="https://www.youtube.com/channel/UCYO_jab_esuFRV4b17AJtAw"&gt;3Blue1Brown&lt;/a&gt;,
by Grant Sanderson, where he explains a way to tackle the problem that
is just … elegant!&lt;/p&gt;
&lt;p&gt;I can't emphasize enough how much I like this channel. For example,
his approach to linear algebra in
&lt;a class="reference external" href="https://www.youtube.com/watch?v=kjBOesZCoqc&amp;amp;list=PLZHQObOWTQDPD3MizzM2xVFitgF8hE_ab"&gt;Essence of linear algebra&lt;/a&gt; is really
good. I mention it, just in case you don't know it.&lt;/p&gt;
&lt;section id="the-problem"&gt;
&lt;h2&gt;The problem&lt;/h2&gt;
&lt;p&gt;Let's talk business now. The problem was originally part of the 53rd
&lt;a class="reference external" href="http://kskedlaya.org/putnam-archive/1992.pdf"&gt;Putnam competition on 1992&lt;/a&gt;
and was stated as&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Four points are chosen at random on the surface of a
sphere.   What is the probability that the center of the
sphere lies inside the tetrahedron whose vertices are at
the four points?  (It is understood that each point is in-
dependently chosen relative to a uniform distribution on
the sphere.)&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;As shown in the mentioned video, the probability is &lt;span class="math"&gt;\(1/8\)&lt;/span&gt;. Let's
come with an algorithm to obtain this result —approximately, at least.&lt;/p&gt;
&lt;/section&gt;
&lt;section id="the-proposed-approach"&gt;
&lt;h2&gt;The proposed approach&lt;/h2&gt;
&lt;p&gt;The approach that we are going to use is pretty straightforward. We are
going to obtain a sample of (independent) random sets, with four points
each, and check how many of them satisfy the condition of being inside
the tetrahedron with the points as vertices.&lt;/p&gt;
&lt;p&gt;For this approach to work, we need two things:&lt;/p&gt;
&lt;ol class="arabic simple"&gt;
&lt;li&gt;&lt;p&gt;A way to generate random numbers uniformly distributed. This is already
in &lt;code class="docutils literal"&gt;numpy.random.uniform&lt;/code&gt;, so we don't need to do much about it.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;A way to check if a point is inside a tetrahedron.&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;section id="checking-that-a-point-is-inside-a-tetrahedron"&gt;
&lt;h3&gt;Checking that a point is inside a tetrahedron&lt;/h3&gt;
&lt;p&gt;To find if a point is inside a tetrahedron, we could compute the
&lt;a class="reference external" href="https://en.wikipedia.org/wiki/Barycentric_coordinate_system"&gt;barycentric coordinates&lt;/a&gt;
for that point and check that all of them are have the same sign. Equivalently,
as proposed &lt;a class="reference external" href="http://steve.hollasch.net/cgindex/geometry/ptintet.html"&gt;here&lt;/a&gt;,
we can check that the determinants of the matrices&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
M_0 =
\begin{bmatrix}
x_0 &amp;amp;y_0 &amp;amp;z_0 &amp;amp;1\\
x_1 &amp;amp;y_1 &amp;amp;z_1 &amp;amp;1\\
x_2 &amp;amp;y_2 &amp;amp;z_2 &amp;amp;1\\
x_3 &amp;amp;y_3 &amp;amp;z_3 &amp;amp;1
\end{bmatrix}\, ,
\end{equation*}
&lt;/div&gt;
&lt;div class="math"&gt;
\begin{equation*}
M_1 =
\begin{bmatrix}
x &amp;amp;y &amp;amp;z &amp;amp;1\\
x_1 &amp;amp;y_1 &amp;amp;z_1 &amp;amp;1\\
x_2 &amp;amp;y_2 &amp;amp;z_2 &amp;amp;1\\
x_3 &amp;amp;y_3 &amp;amp;z_3 &amp;amp;1
\end{bmatrix}\, ,
\end{equation*}
&lt;/div&gt;
&lt;div class="math"&gt;
\begin{equation*}
M_2 =
\begin{bmatrix}
x_0 &amp;amp;y_0 &amp;amp;z_0 &amp;amp;1\\
x &amp;amp;y &amp;amp;z &amp;amp;1\\
x_2 &amp;amp;y_2 &amp;amp;z_2 &amp;amp;1\\
x_3 &amp;amp;y_3 &amp;amp;z_3 &amp;amp;1
\end{bmatrix}\, ,
\end{equation*}
&lt;/div&gt;
&lt;div class="math"&gt;
\begin{equation*}
M_3 =
\begin{bmatrix}
x_0 &amp;amp;y_0 &amp;amp;z_0 &amp;amp;1\\
x_1 &amp;amp;y_1 &amp;amp;z_1 &amp;amp;1\\
x &amp;amp;y &amp;amp;z &amp;amp;1\\
x_3 &amp;amp;y_3 &amp;amp;z_3 &amp;amp;1
\end{bmatrix}\, ,
\end{equation*}
&lt;/div&gt;
&lt;div class="math"&gt;
\begin{equation*}
M_4 =
\begin{bmatrix}
x_0 &amp;amp;y_0 &amp;amp;z_0 &amp;amp;1\\
x_1 &amp;amp;y_1 &amp;amp;z_1 &amp;amp;1\\
x_2 &amp;amp;y_2 &amp;amp;z_2 &amp;amp;1\\
x &amp;amp;y &amp;amp;z &amp;amp;1
\end{bmatrix}\, ,
\end{equation*}
&lt;/div&gt;
&lt;p&gt;have the same sign. In this case, &lt;span class="math"&gt;\((x, y, z)\)&lt;/span&gt; is the point of interest
and &lt;span class="math"&gt;\((x_i, y_i, z_i)\)&lt;/span&gt; are the coordinates of each vertex.&lt;/p&gt;
&lt;/section&gt;
&lt;/section&gt;
&lt;section id="the-algorithm"&gt;
&lt;h2&gt;The algorithm&lt;/h2&gt;
&lt;p&gt;Below is a Python implementation of the approach discussed before&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code python"&gt;&lt;a id="rest_code_672e65cbf4564cb797e6adbc3485c95a-1" name="rest_code_672e65cbf4564cb797e6adbc3485c95a-1" href="https://nicoguaro.github.io/posts/putnam_prob/#rest_code_672e65cbf4564cb797e6adbc3485c95a-1"&gt;&lt;/a&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;__future__&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;division&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;print_function&lt;/span&gt;
&lt;a id="rest_code_672e65cbf4564cb797e6adbc3485c95a-2" name="rest_code_672e65cbf4564cb797e6adbc3485c95a-2" href="https://nicoguaro.github.io/posts/putnam_prob/#rest_code_672e65cbf4564cb797e6adbc3485c95a-2"&gt;&lt;/a&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;numpy&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;random&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;pi&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;cos&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;sin&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;sign&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;hstack&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;a id="rest_code_672e65cbf4564cb797e6adbc3485c95a-3" name="rest_code_672e65cbf4564cb797e6adbc3485c95a-3" href="https://nicoguaro.github.io/posts/putnam_prob/#rest_code_672e65cbf4564cb797e6adbc3485c95a-3"&gt;&lt;/a&gt;                   &lt;span class="n"&gt;column_stack&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;logspace&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_672e65cbf4564cb797e6adbc3485c95a-4" name="rest_code_672e65cbf4564cb797e6adbc3485c95a-4" href="https://nicoguaro.github.io/posts/putnam_prob/#rest_code_672e65cbf4564cb797e6adbc3485c95a-4"&gt;&lt;/a&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;numpy.linalg&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;det&lt;/span&gt;
&lt;a id="rest_code_672e65cbf4564cb797e6adbc3485c95a-5" name="rest_code_672e65cbf4564cb797e6adbc3485c95a-5" href="https://nicoguaro.github.io/posts/putnam_prob/#rest_code_672e65cbf4564cb797e6adbc3485c95a-5"&gt;&lt;/a&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;matplotlib.pyplot&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;plt&lt;/span&gt;
&lt;a id="rest_code_672e65cbf4564cb797e6adbc3485c95a-6" name="rest_code_672e65cbf4564cb797e6adbc3485c95a-6" href="https://nicoguaro.github.io/posts/putnam_prob/#rest_code_672e65cbf4564cb797e6adbc3485c95a-6"&gt;&lt;/a&gt;
&lt;a id="rest_code_672e65cbf4564cb797e6adbc3485c95a-7" name="rest_code_672e65cbf4564cb797e6adbc3485c95a-7" href="https://nicoguaro.github.io/posts/putnam_prob/#rest_code_672e65cbf4564cb797e6adbc3485c95a-7"&gt;&lt;/a&gt;
&lt;a id="rest_code_672e65cbf4564cb797e6adbc3485c95a-8" name="rest_code_672e65cbf4564cb797e6adbc3485c95a-8" href="https://nicoguaro.github.io/posts/putnam_prob/#rest_code_672e65cbf4564cb797e6adbc3485c95a-8"&gt;&lt;/a&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;in_tet&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;z&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;pt&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_672e65cbf4564cb797e6adbc3485c95a-9" name="rest_code_672e65cbf4564cb797e6adbc3485c95a-9" href="https://nicoguaro.github.io/posts/putnam_prob/#rest_code_672e65cbf4564cb797e6adbc3485c95a-9"&gt;&lt;/a&gt;    &lt;span class="sd"&gt;"""&lt;/span&gt;
&lt;a id="rest_code_672e65cbf4564cb797e6adbc3485c95a-10" name="rest_code_672e65cbf4564cb797e6adbc3485c95a-10" href="https://nicoguaro.github.io/posts/putnam_prob/#rest_code_672e65cbf4564cb797e6adbc3485c95a-10"&gt;&lt;/a&gt;&lt;span class="sd"&gt;    Determine if the point pt is inside the&lt;/span&gt;
&lt;a id="rest_code_672e65cbf4564cb797e6adbc3485c95a-11" name="rest_code_672e65cbf4564cb797e6adbc3485c95a-11" href="https://nicoguaro.github.io/posts/putnam_prob/#rest_code_672e65cbf4564cb797e6adbc3485c95a-11"&gt;&lt;/a&gt;&lt;span class="sd"&gt;    tetrahedron with vertices coordinates x, y, z&lt;/span&gt;
&lt;a id="rest_code_672e65cbf4564cb797e6adbc3485c95a-12" name="rest_code_672e65cbf4564cb797e6adbc3485c95a-12" href="https://nicoguaro.github.io/posts/putnam_prob/#rest_code_672e65cbf4564cb797e6adbc3485c95a-12"&gt;&lt;/a&gt;&lt;span class="sd"&gt;    """&lt;/span&gt;
&lt;a id="rest_code_672e65cbf4564cb797e6adbc3485c95a-13" name="rest_code_672e65cbf4564cb797e6adbc3485c95a-13" href="https://nicoguaro.github.io/posts/putnam_prob/#rest_code_672e65cbf4564cb797e6adbc3485c95a-13"&gt;&lt;/a&gt;    &lt;span class="n"&gt;mat0&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;column_stack&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;z&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]))&lt;/span&gt;
&lt;a id="rest_code_672e65cbf4564cb797e6adbc3485c95a-14" name="rest_code_672e65cbf4564cb797e6adbc3485c95a-14" href="https://nicoguaro.github.io/posts/putnam_prob/#rest_code_672e65cbf4564cb797e6adbc3485c95a-14"&gt;&lt;/a&gt;    &lt;span class="n"&gt;det0&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;det&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;mat0&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_672e65cbf4564cb797e6adbc3485c95a-15" name="rest_code_672e65cbf4564cb797e6adbc3485c95a-15" href="https://nicoguaro.github.io/posts/putnam_prob/#rest_code_672e65cbf4564cb797e6adbc3485c95a-15"&gt;&lt;/a&gt;    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;cont&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_672e65cbf4564cb797e6adbc3485c95a-16" name="rest_code_672e65cbf4564cb797e6adbc3485c95a-16" href="https://nicoguaro.github.io/posts/putnam_prob/#rest_code_672e65cbf4564cb797e6adbc3485c95a-16"&gt;&lt;/a&gt;        &lt;span class="n"&gt;mat&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;mat0&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;copy&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a id="rest_code_672e65cbf4564cb797e6adbc3485c95a-17" name="rest_code_672e65cbf4564cb797e6adbc3485c95a-17" href="https://nicoguaro.github.io/posts/putnam_prob/#rest_code_672e65cbf4564cb797e6adbc3485c95a-17"&gt;&lt;/a&gt;        &lt;span class="n"&gt;mat&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;cont&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;hstack&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="n"&gt;pt&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_672e65cbf4564cb797e6adbc3485c95a-18" name="rest_code_672e65cbf4564cb797e6adbc3485c95a-18" href="https://nicoguaro.github.io/posts/putnam_prob/#rest_code_672e65cbf4564cb797e6adbc3485c95a-18"&gt;&lt;/a&gt;        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;sign&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;det&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;mat&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;det0&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a id="rest_code_672e65cbf4564cb797e6adbc3485c95a-19" name="rest_code_672e65cbf4564cb797e6adbc3485c95a-19" href="https://nicoguaro.github.io/posts/putnam_prob/#rest_code_672e65cbf4564cb797e6adbc3485c95a-19"&gt;&lt;/a&gt;            &lt;span class="n"&gt;inside&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="kc"&gt;False&lt;/span&gt;
&lt;a id="rest_code_672e65cbf4564cb797e6adbc3485c95a-20" name="rest_code_672e65cbf4564cb797e6adbc3485c95a-20" href="https://nicoguaro.github.io/posts/putnam_prob/#rest_code_672e65cbf4564cb797e6adbc3485c95a-20"&gt;&lt;/a&gt;            &lt;span class="k"&gt;break&lt;/span&gt;
&lt;a id="rest_code_672e65cbf4564cb797e6adbc3485c95a-21" name="rest_code_672e65cbf4564cb797e6adbc3485c95a-21" href="https://nicoguaro.github.io/posts/putnam_prob/#rest_code_672e65cbf4564cb797e6adbc3485c95a-21"&gt;&lt;/a&gt;        &lt;span class="k"&gt;else&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a id="rest_code_672e65cbf4564cb797e6adbc3485c95a-22" name="rest_code_672e65cbf4564cb797e6adbc3485c95a-22" href="https://nicoguaro.github.io/posts/putnam_prob/#rest_code_672e65cbf4564cb797e6adbc3485c95a-22"&gt;&lt;/a&gt;            &lt;span class="n"&gt;inside&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="kc"&gt;True&lt;/span&gt;
&lt;a id="rest_code_672e65cbf4564cb797e6adbc3485c95a-23" name="rest_code_672e65cbf4564cb797e6adbc3485c95a-23" href="https://nicoguaro.github.io/posts/putnam_prob/#rest_code_672e65cbf4564cb797e6adbc3485c95a-23"&gt;&lt;/a&gt;    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;inside&lt;/span&gt;
&lt;a id="rest_code_672e65cbf4564cb797e6adbc3485c95a-24" name="rest_code_672e65cbf4564cb797e6adbc3485c95a-24" href="https://nicoguaro.github.io/posts/putnam_prob/#rest_code_672e65cbf4564cb797e6adbc3485c95a-24"&gt;&lt;/a&gt;
&lt;a id="rest_code_672e65cbf4564cb797e6adbc3485c95a-25" name="rest_code_672e65cbf4564cb797e6adbc3485c95a-25" href="https://nicoguaro.github.io/posts/putnam_prob/#rest_code_672e65cbf4564cb797e6adbc3485c95a-25"&gt;&lt;/a&gt;
&lt;a id="rest_code_672e65cbf4564cb797e6adbc3485c95a-26" name="rest_code_672e65cbf4564cb797e6adbc3485c95a-26" href="https://nicoguaro.github.io/posts/putnam_prob/#rest_code_672e65cbf4564cb797e6adbc3485c95a-26"&gt;&lt;/a&gt;&lt;span class="c1"&gt;#%% Computation&lt;/span&gt;
&lt;a id="rest_code_672e65cbf4564cb797e6adbc3485c95a-27" name="rest_code_672e65cbf4564cb797e6adbc3485c95a-27" href="https://nicoguaro.github.io/posts/putnam_prob/#rest_code_672e65cbf4564cb797e6adbc3485c95a-27"&gt;&lt;/a&gt;&lt;span class="n"&gt;prob&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[]&lt;/span&gt;
&lt;a id="rest_code_672e65cbf4564cb797e6adbc3485c95a-28" name="rest_code_672e65cbf4564cb797e6adbc3485c95a-28" href="https://nicoguaro.github.io/posts/putnam_prob/#rest_code_672e65cbf4564cb797e6adbc3485c95a-28"&gt;&lt;/a&gt;&lt;span class="n"&gt;random&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;seed&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;seed&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_672e65cbf4564cb797e6adbc3485c95a-29" name="rest_code_672e65cbf4564cb797e6adbc3485c95a-29" href="https://nicoguaro.github.io/posts/putnam_prob/#rest_code_672e65cbf4564cb797e6adbc3485c95a-29"&gt;&lt;/a&gt;&lt;span class="n"&gt;N_min&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;
&lt;a id="rest_code_672e65cbf4564cb797e6adbc3485c95a-30" name="rest_code_672e65cbf4564cb797e6adbc3485c95a-30" href="https://nicoguaro.github.io/posts/putnam_prob/#rest_code_672e65cbf4564cb797e6adbc3485c95a-30"&gt;&lt;/a&gt;&lt;span class="n"&gt;N_max&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;5&lt;/span&gt;
&lt;a id="rest_code_672e65cbf4564cb797e6adbc3485c95a-31" name="rest_code_672e65cbf4564cb797e6adbc3485c95a-31" href="https://nicoguaro.github.io/posts/putnam_prob/#rest_code_672e65cbf4564cb797e6adbc3485c95a-31"&gt;&lt;/a&gt;&lt;span class="n"&gt;N_vals&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;logspace&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N_min&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;N_max&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;100&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;dtype&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nb"&gt;int&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_672e65cbf4564cb797e6adbc3485c95a-32" name="rest_code_672e65cbf4564cb797e6adbc3485c95a-32" href="https://nicoguaro.github.io/posts/putnam_prob/#rest_code_672e65cbf4564cb797e6adbc3485c95a-32"&gt;&lt;/a&gt;&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;N&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;N_vals&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a id="rest_code_672e65cbf4564cb797e6adbc3485c95a-33" name="rest_code_672e65cbf4564cb797e6adbc3485c95a-33" href="https://nicoguaro.github.io/posts/putnam_prob/#rest_code_672e65cbf4564cb797e6adbc3485c95a-33"&gt;&lt;/a&gt;    &lt;span class="n"&gt;inside_cont&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;
&lt;a id="rest_code_672e65cbf4564cb797e6adbc3485c95a-34" name="rest_code_672e65cbf4564cb797e6adbc3485c95a-34" href="https://nicoguaro.github.io/posts/putnam_prob/#rest_code_672e65cbf4564cb797e6adbc3485c95a-34"&gt;&lt;/a&gt;    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;cont_pts&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_672e65cbf4564cb797e6adbc3485c95a-35" name="rest_code_672e65cbf4564cb797e6adbc3485c95a-35" href="https://nicoguaro.github.io/posts/putnam_prob/#rest_code_672e65cbf4564cb797e6adbc3485c95a-35"&gt;&lt;/a&gt;        &lt;span class="n"&gt;phi&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;random&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;uniform&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;low&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mf"&gt;0.0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;high&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;pi&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;size&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_672e65cbf4564cb797e6adbc3485c95a-36" name="rest_code_672e65cbf4564cb797e6adbc3485c95a-36" href="https://nicoguaro.github.io/posts/putnam_prob/#rest_code_672e65cbf4564cb797e6adbc3485c95a-36"&gt;&lt;/a&gt;        &lt;span class="n"&gt;theta&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;random&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;uniform&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;low&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mf"&gt;0.0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;high&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;pi&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;size&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_672e65cbf4564cb797e6adbc3485c95a-37" name="rest_code_672e65cbf4564cb797e6adbc3485c95a-37" href="https://nicoguaro.github.io/posts/putnam_prob/#rest_code_672e65cbf4564cb797e6adbc3485c95a-37"&gt;&lt;/a&gt;        &lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;sin&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;theta&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;cos&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;phi&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_672e65cbf4564cb797e6adbc3485c95a-38" name="rest_code_672e65cbf4564cb797e6adbc3485c95a-38" href="https://nicoguaro.github.io/posts/putnam_prob/#rest_code_672e65cbf4564cb797e6adbc3485c95a-38"&gt;&lt;/a&gt;        &lt;span class="n"&gt;y&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;sin&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;theta&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;sin&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;phi&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_672e65cbf4564cb797e6adbc3485c95a-39" name="rest_code_672e65cbf4564cb797e6adbc3485c95a-39" href="https://nicoguaro.github.io/posts/putnam_prob/#rest_code_672e65cbf4564cb797e6adbc3485c95a-39"&gt;&lt;/a&gt;        &lt;span class="n"&gt;z&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;cos&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;theta&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_672e65cbf4564cb797e6adbc3485c95a-40" name="rest_code_672e65cbf4564cb797e6adbc3485c95a-40" href="https://nicoguaro.github.io/posts/putnam_prob/#rest_code_672e65cbf4564cb797e6adbc3485c95a-40"&gt;&lt;/a&gt;        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;in_tet&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;z&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]):&lt;/span&gt;
&lt;a id="rest_code_672e65cbf4564cb797e6adbc3485c95a-41" name="rest_code_672e65cbf4564cb797e6adbc3485c95a-41" href="https://nicoguaro.github.io/posts/putnam_prob/#rest_code_672e65cbf4564cb797e6adbc3485c95a-41"&gt;&lt;/a&gt;            &lt;span class="n"&gt;inside_cont&lt;/span&gt; &lt;span class="o"&gt;+=&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;
&lt;a id="rest_code_672e65cbf4564cb797e6adbc3485c95a-42" name="rest_code_672e65cbf4564cb797e6adbc3485c95a-42" href="https://nicoguaro.github.io/posts/putnam_prob/#rest_code_672e65cbf4564cb797e6adbc3485c95a-42"&gt;&lt;/a&gt;
&lt;a id="rest_code_672e65cbf4564cb797e6adbc3485c95a-43" name="rest_code_672e65cbf4564cb797e6adbc3485c95a-43" href="https://nicoguaro.github.io/posts/putnam_prob/#rest_code_672e65cbf4564cb797e6adbc3485c95a-43"&gt;&lt;/a&gt;    &lt;span class="n"&gt;prob&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;append&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;inside_cont&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_672e65cbf4564cb797e6adbc3485c95a-44" name="rest_code_672e65cbf4564cb797e6adbc3485c95a-44" href="https://nicoguaro.github.io/posts/putnam_prob/#rest_code_672e65cbf4564cb797e6adbc3485c95a-44"&gt;&lt;/a&gt;
&lt;a id="rest_code_672e65cbf4564cb797e6adbc3485c95a-45" name="rest_code_672e65cbf4564cb797e6adbc3485c95a-45" href="https://nicoguaro.github.io/posts/putnam_prob/#rest_code_672e65cbf4564cb797e6adbc3485c95a-45"&gt;&lt;/a&gt;
&lt;a id="rest_code_672e65cbf4564cb797e6adbc3485c95a-46" name="rest_code_672e65cbf4564cb797e6adbc3485c95a-46" href="https://nicoguaro.github.io/posts/putnam_prob/#rest_code_672e65cbf4564cb797e6adbc3485c95a-46"&gt;&lt;/a&gt;&lt;span class="c1"&gt;#%% Plotting&lt;/span&gt;
&lt;a id="rest_code_672e65cbf4564cb797e6adbc3485c95a-47" name="rest_code_672e65cbf4564cb797e6adbc3485c95a-47" href="https://nicoguaro.github.io/posts/putnam_prob/#rest_code_672e65cbf4564cb797e6adbc3485c95a-47"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;figure&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;figsize&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_672e65cbf4564cb797e6adbc3485c95a-48" name="rest_code_672e65cbf4564cb797e6adbc3485c95a-48" href="https://nicoguaro.github.io/posts/putnam_prob/#rest_code_672e65cbf4564cb797e6adbc3485c95a-48"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;hlines&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;0.125&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="n"&gt;N_min&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="n"&gt;N_max&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;color&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;"#3f3f3f"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_672e65cbf4564cb797e6adbc3485c95a-49" name="rest_code_672e65cbf4564cb797e6adbc3485c95a-49" href="https://nicoguaro.github.io/posts/putnam_prob/#rest_code_672e65cbf4564cb797e6adbc3485c95a-49"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;semilogx&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N_vals&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;prob&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;"o"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;alpha&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mf"&gt;0.5&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_672e65cbf4564cb797e6adbc3485c95a-50" name="rest_code_672e65cbf4564cb797e6adbc3485c95a-50" href="https://nicoguaro.github.io/posts/putnam_prob/#rest_code_672e65cbf4564cb797e6adbc3485c95a-50"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"Number of trials"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_672e65cbf4564cb797e6adbc3485c95a-51" name="rest_code_672e65cbf4564cb797e6adbc3485c95a-51" href="https://nicoguaro.github.io/posts/putnam_prob/#rest_code_672e65cbf4564cb797e6adbc3485c95a-51"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ylabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"Computed probability"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_672e65cbf4564cb797e6adbc3485c95a-52" name="rest_code_672e65cbf4564cb797e6adbc3485c95a-52" href="https://nicoguaro.github.io/posts/putnam_prob/#rest_code_672e65cbf4564cb797e6adbc3485c95a-52"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;tight_layout&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a id="rest_code_672e65cbf4564cb797e6adbc3485c95a-53" name="rest_code_672e65cbf4564cb797e6adbc3485c95a-53" href="https://nicoguaro.github.io/posts/putnam_prob/#rest_code_672e65cbf4564cb797e6adbc3485c95a-53"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;show&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;As expected, when the number of samples is sufficiently large, the
estimated probability is close to the theoretical value: 0.125. This
can be seen in the following figure.&lt;/p&gt;
&lt;img alt="Computed probability for different sample sizes" class="align-center" src="https://nicoguaro.github.io/images/random_tets.svg" style="width: 600px;"&gt;
&lt;/section&gt;</description><category>barycentric coordinates</category><category>computational geometry</category><category>monte carlo</category><category>probability</category><category>python</category><guid>https://nicoguaro.github.io/posts/putnam_prob/</guid><pubDate>Wed, 13 Dec 2017 20:24:52 GMT</pubDate></item><item><title>Numerical methods challenge: Summary</title><link>https://nicoguaro.github.io/posts/numerical_challenge/numerical_summary/</link><dc:creator>Nicolás Guarín-Zapata</dc:creator><description>&lt;p&gt;During October (2017) I wrote a program per day for some well-known numerical
methods in both Python and Julia. It was intended to be an exercise, then don't
expect the code to be good enough for real use. Also, I should mention that I
had almost no experience with Julia, so it probably is not idiomatic Julia but
more Python-like Julia.&lt;/p&gt;
&lt;section id="summary"&gt;
&lt;h2&gt;Summary&lt;/h2&gt;
&lt;p&gt;This post is a summary of that challenge. For the source code you can check
&lt;a class="reference external" href="https://github.com/nicoguaro/numerical_challenge_2017"&gt;the repository&lt;/a&gt;.&lt;/p&gt;
&lt;section id="the-verdict"&gt;
&lt;h3&gt;The verdict&lt;/h3&gt;
&lt;p&gt;Since the challenge is with myself, and the main purpose was to learn some
Julia the verdict is: &lt;strong&gt;success&lt;/strong&gt;. Nevertheless, I failed during day 26
with the Boundary Element Method.&lt;/p&gt;
&lt;/section&gt;
&lt;section id="the-list-of-methods"&gt;
&lt;h3&gt;The list of methods&lt;/h3&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;&lt;th class="head"&gt;&lt;p&gt;Day&lt;/p&gt;&lt;/th&gt;
&lt;th class="head"&gt;&lt;p&gt;Numerical method&lt;/p&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;&lt;td&gt;&lt;p&gt;&lt;a class="reference external" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-01"&gt;01&lt;/a&gt;&lt;/p&gt;&lt;/td&gt;
&lt;td&gt;&lt;p&gt;Bisection&lt;/p&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;&lt;p&gt;&lt;a class="reference external" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-02"&gt;02&lt;/a&gt;&lt;/p&gt;&lt;/td&gt;
&lt;td&gt;&lt;p&gt;Regula falsi&lt;/p&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;&lt;p&gt;&lt;a class="reference external" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-03"&gt;03&lt;/a&gt;&lt;/p&gt;&lt;/td&gt;
&lt;td&gt;&lt;p&gt;Newton&lt;/p&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;&lt;p&gt;&lt;a class="reference external" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-04"&gt;04&lt;/a&gt;&lt;/p&gt;&lt;/td&gt;
&lt;td&gt;&lt;p&gt;Newton multivariate&lt;/p&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;&lt;p&gt;&lt;a class="reference external" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-05"&gt;05&lt;/a&gt;&lt;/p&gt;&lt;/td&gt;
&lt;td&gt;&lt;p&gt;Broyden&lt;/p&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;&lt;p&gt;&lt;a class="reference external" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-06"&gt;06&lt;/a&gt;&lt;/p&gt;&lt;/td&gt;
&lt;td&gt;&lt;p&gt;Gradient descent&lt;/p&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;&lt;p&gt;&lt;a class="reference external" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-07"&gt;07&lt;/a&gt;&lt;/p&gt;&lt;/td&gt;
&lt;td&gt;&lt;p&gt;Nelder-Mead&lt;/p&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;&lt;p&gt;&lt;a class="reference external" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-08"&gt;08&lt;/a&gt;&lt;/p&gt;&lt;/td&gt;
&lt;td&gt;&lt;p&gt;Newton for optimization&lt;/p&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;&lt;p&gt;&lt;a class="reference external" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-09"&gt;09&lt;/a&gt;&lt;/p&gt;&lt;/td&gt;
&lt;td&gt;&lt;p&gt;Lagrange interpolation&lt;/p&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;&lt;p&gt;&lt;a class="reference external" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-10"&gt;10&lt;/a&gt;&lt;/p&gt;&lt;/td&gt;
&lt;td&gt;&lt;p&gt;Lagrange interpolation with Lobatto sampling&lt;/p&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;&lt;p&gt;&lt;a class="reference external" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-11"&gt;11&lt;/a&gt;&lt;/p&gt;&lt;/td&gt;
&lt;td&gt;&lt;p&gt;Lagrange interpolation using Vandermonde matrix&lt;/p&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;&lt;p&gt;&lt;a class="reference external" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-12"&gt;12&lt;/a&gt;&lt;/p&gt;&lt;/td&gt;
&lt;td&gt;&lt;p&gt;Hermite interpolation&lt;/p&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;&lt;p&gt;&lt;a class="reference external" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-13"&gt;13&lt;/a&gt;&lt;/p&gt;&lt;/td&gt;
&lt;td&gt;&lt;p&gt;Spline interpolation&lt;/p&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;&lt;p&gt;&lt;a class="reference external" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-14"&gt;14&lt;/a&gt;&lt;/p&gt;&lt;/td&gt;
&lt;td&gt;&lt;p&gt;Trapezoid quadrature&lt;/p&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;&lt;p&gt;&lt;a class="reference external" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-15"&gt;15&lt;/a&gt;&lt;/p&gt;&lt;/td&gt;
&lt;td&gt;&lt;p&gt;Simpson quadrature&lt;/p&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;&lt;p&gt;&lt;a class="reference external" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-16"&gt;16&lt;/a&gt;&lt;/p&gt;&lt;/td&gt;
&lt;td&gt;&lt;p&gt;Clenshaw-Curtis quadrature&lt;/p&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;&lt;p&gt;&lt;a class="reference external" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-17"&gt;17&lt;/a&gt;&lt;/p&gt;&lt;/td&gt;
&lt;td&gt;&lt;p&gt;Euler integration&lt;/p&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;&lt;p&gt;&lt;a class="reference external" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-18"&gt;18&lt;/a&gt;&lt;/p&gt;&lt;/td&gt;
&lt;td&gt;&lt;p&gt;Runge-Kutta integration&lt;/p&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;&lt;p&gt;&lt;a class="reference external" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-19"&gt;19&lt;/a&gt;&lt;/p&gt;&lt;/td&gt;
&lt;td&gt;&lt;p&gt;Verlet integration&lt;/p&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;&lt;p&gt;&lt;a class="reference external" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-20"&gt;20&lt;/a&gt;&lt;/p&gt;&lt;/td&gt;
&lt;td&gt;&lt;p&gt;Shooting method&lt;/p&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;&lt;p&gt;&lt;a class="reference external" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-21"&gt;21&lt;/a&gt;&lt;/p&gt;&lt;/td&gt;
&lt;td&gt;&lt;p&gt;Finite differences with Jacobi method&lt;/p&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;&lt;p&gt;&lt;a class="reference external" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-22"&gt;22&lt;/a&gt;&lt;/p&gt;&lt;/td&gt;
&lt;td&gt;&lt;p&gt;Finite differences for eigenvalues&lt;/p&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;&lt;p&gt;&lt;a class="reference external" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-23"&gt;23&lt;/a&gt;&lt;/p&gt;&lt;/td&gt;
&lt;td&gt;&lt;p&gt;Ritz method&lt;/p&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;&lt;p&gt;&lt;a class="reference external" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24"&gt;24&lt;/a&gt;&lt;/p&gt;&lt;/td&gt;
&lt;td&gt;&lt;p&gt;Finite element method in 1D&lt;/p&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;&lt;p&gt;&lt;a class="reference external" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25"&gt;25&lt;/a&gt;&lt;/p&gt;&lt;/td&gt;
&lt;td&gt;&lt;p&gt;Finite element method in 2D&lt;/p&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;&lt;p&gt;&lt;a class="reference external" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-26"&gt;26&lt;/a&gt;&lt;/p&gt;&lt;/td&gt;
&lt;td&gt;&lt;p&gt;Boundary element method&lt;/p&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;&lt;p&gt;&lt;a class="reference external" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-27"&gt;27&lt;/a&gt;&lt;/p&gt;&lt;/td&gt;
&lt;td&gt;&lt;p&gt;Monte-Carlo integration&lt;/p&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;&lt;p&gt;&lt;a class="reference external" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-28"&gt;28&lt;/a&gt;&lt;/p&gt;&lt;/td&gt;
&lt;td&gt;&lt;p&gt;LU factorization&lt;/p&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;&lt;p&gt;&lt;a class="reference external" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-29"&gt;29&lt;/a&gt;&lt;/p&gt;&lt;/td&gt;
&lt;td&gt;&lt;p&gt;Cholesky factorization&lt;/p&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;&lt;p&gt;&lt;a class="reference external" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30"&gt;30&lt;/a&gt;&lt;/p&gt;&lt;/td&gt;
&lt;td&gt;&lt;p&gt;Conjugate gradient&lt;/p&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;&lt;p&gt;&lt;a class="reference external" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31"&gt;31&lt;/a&gt;&lt;/p&gt;&lt;/td&gt;
&lt;td&gt;&lt;p&gt;Finite element method with solver&lt;/p&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;/section&gt;
&lt;section id="conclusions"&gt;
&lt;h3&gt;Conclusions&lt;/h3&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;This was an exercise of code-kata to learn some of the details of Julia for
scientific computing. As such, it was really useful for me to get my hands
dirty with Julia.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Implementing the Boundary Element Method in one day seems to be rough. I
knew this beforehand, but I gave it a try anyways … without succcess.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Julia syntax is somewhat in a sweetspot between Python and MATLAB. This makes
it really easy to use, although the documentation of some packages is at
an arcane stage right now.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;I won't take a challenge like this in a while. It takes a lot of atttention
to get it done.&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/section&gt;
&lt;/section&gt;</description><category>julia</category><category>numerical methods</category><category>python</category><category>scientific computing</category><guid>https://nicoguaro.github.io/posts/numerical_challenge/numerical_summary/</guid><pubDate>Tue, 14 Nov 2017 16:22:23 GMT</pubDate></item><item><title>Numerical methods challenge: Day 31</title><link>https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/</link><dc:creator>Nicolás Guarín-Zapata</dc:creator><description>&lt;p&gt;During October (2017) I wrote a program per day for some well-known
numerical methods in both Python and Julia. It was intended to be an exercise,
then don't expect the code to be good enough for real use. Also,
I should mention that I had almost no experience with Julia, so it
probably is not idiomatic Julia but more Python-like Julia.&lt;/p&gt;
&lt;section id="putting-some-things-together"&gt;
&lt;h2&gt;Putting some things together&lt;/h2&gt;
&lt;p&gt;Today, I am putting some things together, namely, I am going to solve the
system of equations that results in the finite element using the conjugate
gradient.&lt;/p&gt;
&lt;p&gt;Following are the codes&lt;/p&gt;
&lt;section id="python"&gt;
&lt;h3&gt;Python&lt;/h3&gt;
&lt;div class="code"&gt;&lt;pre class="code python"&gt;&lt;a id="rest_code_2e50c603bfc9409cb66066c291f7c204-1" name="rest_code_2e50c603bfc9409cb66066c291f7c204-1" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_2e50c603bfc9409cb66066c291f7c204-1"&gt;&lt;/a&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;__future__&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;division&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;print_function&lt;/span&gt;
&lt;a id="rest_code_2e50c603bfc9409cb66066c291f7c204-2" name="rest_code_2e50c603bfc9409cb66066c291f7c204-2" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_2e50c603bfc9409cb66066c291f7c204-2"&gt;&lt;/a&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;numpy&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;np&lt;/span&gt;
&lt;a id="rest_code_2e50c603bfc9409cb66066c291f7c204-3" name="rest_code_2e50c603bfc9409cb66066c291f7c204-3" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_2e50c603bfc9409cb66066c291f7c204-3"&gt;&lt;/a&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;matplotlib.pyplot&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;plt&lt;/span&gt;
&lt;a id="rest_code_2e50c603bfc9409cb66066c291f7c204-4" name="rest_code_2e50c603bfc9409cb66066c291f7c204-4" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_2e50c603bfc9409cb66066c291f7c204-4"&gt;&lt;/a&gt;
&lt;a id="rest_code_2e50c603bfc9409cb66066c291f7c204-5" name="rest_code_2e50c603bfc9409cb66066c291f7c204-5" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_2e50c603bfc9409cb66066c291f7c204-5"&gt;&lt;/a&gt;
&lt;a id="rest_code_2e50c603bfc9409cb66066c291f7c204-6" name="rest_code_2e50c603bfc9409cb66066c291f7c204-6" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_2e50c603bfc9409cb66066c291f7c204-6"&gt;&lt;/a&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;FEM1D&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;source&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_2e50c603bfc9409cb66066c291f7c204-7" name="rest_code_2e50c603bfc9409cb66066c291f7c204-7" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_2e50c603bfc9409cb66066c291f7c204-7"&gt;&lt;/a&gt;    &lt;span class="n"&gt;N&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_2e50c603bfc9409cb66066c291f7c204-8" name="rest_code_2e50c603bfc9409cb66066c291f7c204-8" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_2e50c603bfc9409cb66066c291f7c204-8"&gt;&lt;/a&gt;    &lt;span class="n"&gt;stiff_loc&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;([[&lt;/span&gt;&lt;span class="mf"&gt;2.0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;2.0&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;2.0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;2.0&lt;/span&gt;&lt;span class="p"&gt;]])&lt;/span&gt;
&lt;a id="rest_code_2e50c603bfc9409cb66066c291f7c204-9" name="rest_code_2e50c603bfc9409cb66066c291f7c204-9" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_2e50c603bfc9409cb66066c291f7c204-9"&gt;&lt;/a&gt;    &lt;span class="n"&gt;eles&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="n"&gt;cont&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;cont&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;cont&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;N&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)]&lt;/span&gt;
&lt;a id="rest_code_2e50c603bfc9409cb66066c291f7c204-10" name="rest_code_2e50c603bfc9409cb66066c291f7c204-10" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_2e50c603bfc9409cb66066c291f7c204-10"&gt;&lt;/a&gt;    &lt;span class="n"&gt;stiff&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_2e50c603bfc9409cb66066c291f7c204-11" name="rest_code_2e50c603bfc9409cb66066c291f7c204-11" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_2e50c603bfc9409cb66066c291f7c204-11"&gt;&lt;/a&gt;    &lt;span class="n"&gt;rhs&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_2e50c603bfc9409cb66066c291f7c204-12" name="rest_code_2e50c603bfc9409cb66066c291f7c204-12" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_2e50c603bfc9409cb66066c291f7c204-12"&gt;&lt;/a&gt;    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;ele&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;eles&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a id="rest_code_2e50c603bfc9409cb66066c291f7c204-13" name="rest_code_2e50c603bfc9409cb66066c291f7c204-13" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_2e50c603bfc9409cb66066c291f7c204-13"&gt;&lt;/a&gt;        &lt;span class="n"&gt;jaco&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ele&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]]&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ele&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]]&lt;/span&gt;
&lt;a id="rest_code_2e50c603bfc9409cb66066c291f7c204-14" name="rest_code_2e50c603bfc9409cb66066c291f7c204-14" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_2e50c603bfc9409cb66066c291f7c204-14"&gt;&lt;/a&gt;        &lt;span class="n"&gt;rhs&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ele&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;rhs&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ele&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;jaco&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;source&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ele&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_2e50c603bfc9409cb66066c291f7c204-15" name="rest_code_2e50c603bfc9409cb66066c291f7c204-15" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_2e50c603bfc9409cb66066c291f7c204-15"&gt;&lt;/a&gt;        &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;cont1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;row&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;enumerate&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ele&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_2e50c603bfc9409cb66066c291f7c204-16" name="rest_code_2e50c603bfc9409cb66066c291f7c204-16" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_2e50c603bfc9409cb66066c291f7c204-16"&gt;&lt;/a&gt;            &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;cont2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;col&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;enumerate&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ele&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_2e50c603bfc9409cb66066c291f7c204-17" name="rest_code_2e50c603bfc9409cb66066c291f7c204-17" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_2e50c603bfc9409cb66066c291f7c204-17"&gt;&lt;/a&gt;                &lt;span class="n"&gt;stiff&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;row&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;stiff&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;row&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt;  &lt;span class="n"&gt;stiff_loc&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;cont1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;cont2&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;jaco&lt;/span&gt;
&lt;a id="rest_code_2e50c603bfc9409cb66066c291f7c204-18" name="rest_code_2e50c603bfc9409cb66066c291f7c204-18" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_2e50c603bfc9409cb66066c291f7c204-18"&gt;&lt;/a&gt;    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;stiff&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;rhs&lt;/span&gt;
&lt;a id="rest_code_2e50c603bfc9409cb66066c291f7c204-19" name="rest_code_2e50c603bfc9409cb66066c291f7c204-19" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_2e50c603bfc9409cb66066c291f7c204-19"&gt;&lt;/a&gt;
&lt;a id="rest_code_2e50c603bfc9409cb66066c291f7c204-20" name="rest_code_2e50c603bfc9409cb66066c291f7c204-20" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_2e50c603bfc9409cb66066c291f7c204-20"&gt;&lt;/a&gt;
&lt;a id="rest_code_2e50c603bfc9409cb66066c291f7c204-21" name="rest_code_2e50c603bfc9409cb66066c291f7c204-21" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_2e50c603bfc9409cb66066c291f7c204-21"&gt;&lt;/a&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;conj_grad&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;tol&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mf"&gt;1e-8&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_2e50c603bfc9409cb66066c291f7c204-22" name="rest_code_2e50c603bfc9409cb66066c291f7c204-22" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_2e50c603bfc9409cb66066c291f7c204-22"&gt;&lt;/a&gt;    &lt;span class="n"&gt;r&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;b&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;dot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_2e50c603bfc9409cb66066c291f7c204-23" name="rest_code_2e50c603bfc9409cb66066c291f7c204-23" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_2e50c603bfc9409cb66066c291f7c204-23"&gt;&lt;/a&gt;    &lt;span class="n"&gt;p&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;r&lt;/span&gt;
&lt;a id="rest_code_2e50c603bfc9409cb66066c291f7c204-24" name="rest_code_2e50c603bfc9409cb66066c291f7c204-24" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_2e50c603bfc9409cb66066c291f7c204-24"&gt;&lt;/a&gt;    &lt;span class="n"&gt;rsq_old&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;dot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_2e50c603bfc9409cb66066c291f7c204-25" name="rest_code_2e50c603bfc9409cb66066c291f7c204-25" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_2e50c603bfc9409cb66066c291f7c204-25"&gt;&lt;/a&gt;    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;cont&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;)):&lt;/span&gt;
&lt;a id="rest_code_2e50c603bfc9409cb66066c291f7c204-26" name="rest_code_2e50c603bfc9409cb66066c291f7c204-26" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_2e50c603bfc9409cb66066c291f7c204-26"&gt;&lt;/a&gt;        &lt;span class="n"&gt;Ap&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;dot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_2e50c603bfc9409cb66066c291f7c204-27" name="rest_code_2e50c603bfc9409cb66066c291f7c204-27" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_2e50c603bfc9409cb66066c291f7c204-27"&gt;&lt;/a&gt;        &lt;span class="n"&gt;alpha&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;rsq_old&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;dot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Ap&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_2e50c603bfc9409cb66066c291f7c204-28" name="rest_code_2e50c603bfc9409cb66066c291f7c204-28" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_2e50c603bfc9409cb66066c291f7c204-28"&gt;&lt;/a&gt;        &lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;alpha&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;p&lt;/span&gt;
&lt;a id="rest_code_2e50c603bfc9409cb66066c291f7c204-29" name="rest_code_2e50c603bfc9409cb66066c291f7c204-29" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_2e50c603bfc9409cb66066c291f7c204-29"&gt;&lt;/a&gt;        &lt;span class="n"&gt;r&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;r&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;alpha&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;Ap&lt;/span&gt;
&lt;a id="rest_code_2e50c603bfc9409cb66066c291f7c204-30" name="rest_code_2e50c603bfc9409cb66066c291f7c204-30" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_2e50c603bfc9409cb66066c291f7c204-30"&gt;&lt;/a&gt;        &lt;span class="n"&gt;rsq_new&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;dot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_2e50c603bfc9409cb66066c291f7c204-31" name="rest_code_2e50c603bfc9409cb66066c291f7c204-31" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_2e50c603bfc9409cb66066c291f7c204-31"&gt;&lt;/a&gt;        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sqrt&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;rsq_new&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;tol&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a id="rest_code_2e50c603bfc9409cb66066c291f7c204-32" name="rest_code_2e50c603bfc9409cb66066c291f7c204-32" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_2e50c603bfc9409cb66066c291f7c204-32"&gt;&lt;/a&gt;            &lt;span class="k"&gt;break&lt;/span&gt;
&lt;a id="rest_code_2e50c603bfc9409cb66066c291f7c204-33" name="rest_code_2e50c603bfc9409cb66066c291f7c204-33" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_2e50c603bfc9409cb66066c291f7c204-33"&gt;&lt;/a&gt;        &lt;span class="n"&gt;p&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;r&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;rsq_new&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="n"&gt;rsq_old&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;p&lt;/span&gt;
&lt;a id="rest_code_2e50c603bfc9409cb66066c291f7c204-34" name="rest_code_2e50c603bfc9409cb66066c291f7c204-34" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_2e50c603bfc9409cb66066c291f7c204-34"&gt;&lt;/a&gt;        &lt;span class="n"&gt;rsq_old&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;rsq_new&lt;/span&gt;
&lt;a id="rest_code_2e50c603bfc9409cb66066c291f7c204-35" name="rest_code_2e50c603bfc9409cb66066c291f7c204-35" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_2e50c603bfc9409cb66066c291f7c204-35"&gt;&lt;/a&gt;    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;cont&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sqrt&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;rsq_new&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_2e50c603bfc9409cb66066c291f7c204-36" name="rest_code_2e50c603bfc9409cb66066c291f7c204-36" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_2e50c603bfc9409cb66066c291f7c204-36"&gt;&lt;/a&gt;
&lt;a id="rest_code_2e50c603bfc9409cb66066c291f7c204-37" name="rest_code_2e50c603bfc9409cb66066c291f7c204-37" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_2e50c603bfc9409cb66066c291f7c204-37"&gt;&lt;/a&gt;
&lt;a id="rest_code_2e50c603bfc9409cb66066c291f7c204-38" name="rest_code_2e50c603bfc9409cb66066c291f7c204-38" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_2e50c603bfc9409cb66066c291f7c204-38"&gt;&lt;/a&gt;&lt;span class="n"&gt;fun&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;lambda&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;
&lt;a id="rest_code_2e50c603bfc9409cb66066c291f7c204-39" name="rest_code_2e50c603bfc9409cb66066c291f7c204-39" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_2e50c603bfc9409cb66066c291f7c204-39"&gt;&lt;/a&gt;&lt;span class="n"&gt;N_vec&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;logspace&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;0.5&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;50&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;dtype&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nb"&gt;int&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_2e50c603bfc9409cb66066c291f7c204-40" name="rest_code_2e50c603bfc9409cb66066c291f7c204-40" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_2e50c603bfc9409cb66066c291f7c204-40"&gt;&lt;/a&gt;&lt;span class="n"&gt;err_vec&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros_like&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N_vec&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;dtype&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nb"&gt;float&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_2e50c603bfc9409cb66066c291f7c204-41" name="rest_code_2e50c603bfc9409cb66066c291f7c204-41" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_2e50c603bfc9409cb66066c291f7c204-41"&gt;&lt;/a&gt;&lt;span class="n"&gt;niter_vec&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros_like&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N_vec&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_2e50c603bfc9409cb66066c291f7c204-42" name="rest_code_2e50c603bfc9409cb66066c291f7c204-42" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_2e50c603bfc9409cb66066c291f7c204-42"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;figure&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;figsize&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;8&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_2e50c603bfc9409cb66066c291f7c204-43" name="rest_code_2e50c603bfc9409cb66066c291f7c204-43" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_2e50c603bfc9409cb66066c291f7c204-43"&gt;&lt;/a&gt;&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;cont&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;N&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;enumerate&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N_vec&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_2e50c603bfc9409cb66066c291f7c204-44" name="rest_code_2e50c603bfc9409cb66066c291f7c204-44" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_2e50c603bfc9409cb66066c291f7c204-44"&gt;&lt;/a&gt;    &lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;linspace&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_2e50c603bfc9409cb66066c291f7c204-45" name="rest_code_2e50c603bfc9409cb66066c291f7c204-45" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_2e50c603bfc9409cb66066c291f7c204-45"&gt;&lt;/a&gt;    &lt;span class="n"&gt;stiff&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;rhs&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;FEM1D&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;fun&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_2e50c603bfc9409cb66066c291f7c204-46" name="rest_code_2e50c603bfc9409cb66066c291f7c204-46" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_2e50c603bfc9409cb66066c291f7c204-46"&gt;&lt;/a&gt;    &lt;span class="n"&gt;sol&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_2e50c603bfc9409cb66066c291f7c204-47" name="rest_code_2e50c603bfc9409cb66066c291f7c204-47" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_2e50c603bfc9409cb66066c291f7c204-47"&gt;&lt;/a&gt;    &lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;niter&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;_&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;conj_grad&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;stiff&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;rhs&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;rhs&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_2e50c603bfc9409cb66066c291f7c204-48" name="rest_code_2e50c603bfc9409cb66066c291f7c204-48" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_2e50c603bfc9409cb66066c291f7c204-48"&gt;&lt;/a&gt;    &lt;span class="n"&gt;err&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;linalg&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;norm&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;sol&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="mi"&gt;20&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;linalg&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;norm&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="mi"&gt;20&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_2e50c603bfc9409cb66066c291f7c204-49" name="rest_code_2e50c603bfc9409cb66066c291f7c204-49" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_2e50c603bfc9409cb66066c291f7c204-49"&gt;&lt;/a&gt;    &lt;span class="n"&gt;err_vec&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;cont&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;err&lt;/span&gt;
&lt;a id="rest_code_2e50c603bfc9409cb66066c291f7c204-50" name="rest_code_2e50c603bfc9409cb66066c291f7c204-50" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_2e50c603bfc9409cb66066c291f7c204-50"&gt;&lt;/a&gt;    &lt;span class="n"&gt;niter_vec&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;cont&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;niter&lt;/span&gt;
&lt;a id="rest_code_2e50c603bfc9409cb66066c291f7c204-51" name="rest_code_2e50c603bfc9409cb66066c291f7c204-51" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_2e50c603bfc9409cb66066c291f7c204-51"&gt;&lt;/a&gt;
&lt;a id="rest_code_2e50c603bfc9409cb66066c291f7c204-52" name="rest_code_2e50c603bfc9409cb66066c291f7c204-52" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_2e50c603bfc9409cb66066c291f7c204-52"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;subplot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;121&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_2e50c603bfc9409cb66066c291f7c204-53" name="rest_code_2e50c603bfc9409cb66066c291f7c204-53" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_2e50c603bfc9409cb66066c291f7c204-53"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;loglog&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N_vec&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;err_vec&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_2e50c603bfc9409cb66066c291f7c204-54" name="rest_code_2e50c603bfc9409cb66066c291f7c204-54" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_2e50c603bfc9409cb66066c291f7c204-54"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"Number of nodes"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_2e50c603bfc9409cb66066c291f7c204-55" name="rest_code_2e50c603bfc9409cb66066c291f7c204-55" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_2e50c603bfc9409cb66066c291f7c204-55"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ylabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"Relative error"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_2e50c603bfc9409cb66066c291f7c204-56" name="rest_code_2e50c603bfc9409cb66066c291f7c204-56" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_2e50c603bfc9409cb66066c291f7c204-56"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;subplot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;122&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_2e50c603bfc9409cb66066c291f7c204-57" name="rest_code_2e50c603bfc9409cb66066c291f7c204-57" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_2e50c603bfc9409cb66066c291f7c204-57"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;loglog&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N_vec&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;niter_vec&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_2e50c603bfc9409cb66066c291f7c204-58" name="rest_code_2e50c603bfc9409cb66066c291f7c204-58" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_2e50c603bfc9409cb66066c291f7c204-58"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"Number of nodes"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_2e50c603bfc9409cb66066c291f7c204-59" name="rest_code_2e50c603bfc9409cb66066c291f7c204-59" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_2e50c603bfc9409cb66066c291f7c204-59"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ylabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"Number of iterations"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_2e50c603bfc9409cb66066c291f7c204-60" name="rest_code_2e50c603bfc9409cb66066c291f7c204-60" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_2e50c603bfc9409cb66066c291f7c204-60"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;tight_layout&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a id="rest_code_2e50c603bfc9409cb66066c291f7c204-61" name="rest_code_2e50c603bfc9409cb66066c291f7c204-61" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_2e50c603bfc9409cb66066c291f7c204-61"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;show&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/section&gt;
&lt;section id="julia"&gt;
&lt;h3&gt;Julia&lt;/h3&gt;
&lt;div class="code"&gt;&lt;pre class="code julia"&gt;&lt;a id="rest_code_05d5f56b2b5f47bab3dac84888a78946-1" name="rest_code_05d5f56b2b5f47bab3dac84888a78946-1" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_05d5f56b2b5f47bab3dac84888a78946-1"&gt;&lt;/a&gt;&lt;span class="k"&gt;using&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;PyPlot&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_05d5f56b2b5f47bab3dac84888a78946-2" name="rest_code_05d5f56b2b5f47bab3dac84888a78946-2" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_05d5f56b2b5f47bab3dac84888a78946-2"&gt;&lt;/a&gt;
&lt;a id="rest_code_05d5f56b2b5f47bab3dac84888a78946-3" name="rest_code_05d5f56b2b5f47bab3dac84888a78946-3" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_05d5f56b2b5f47bab3dac84888a78946-3"&gt;&lt;/a&gt;
&lt;a id="rest_code_05d5f56b2b5f47bab3dac84888a78946-4" name="rest_code_05d5f56b2b5f47bab3dac84888a78946-4" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_05d5f56b2b5f47bab3dac84888a78946-4"&gt;&lt;/a&gt;&lt;span class="k"&gt;function&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;FEM1D&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;source&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_05d5f56b2b5f47bab3dac84888a78946-5" name="rest_code_05d5f56b2b5f47bab3dac84888a78946-5" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_05d5f56b2b5f47bab3dac84888a78946-5"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;length&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_05d5f56b2b5f47bab3dac84888a78946-6" name="rest_code_05d5f56b2b5f47bab3dac84888a78946-6" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_05d5f56b2b5f47bab3dac84888a78946-6"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;stiff_loc&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mf"&gt;2.0&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;2.0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;2.0&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;2.0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_05d5f56b2b5f47bab3dac84888a78946-7" name="rest_code_05d5f56b2b5f47bab3dac84888a78946-7" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_05d5f56b2b5f47bab3dac84888a78946-7"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;eles&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;[[&lt;/span&gt;&lt;span class="n"&gt;cont&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;cont&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;for&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;cont&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;in&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_05d5f56b2b5f47bab3dac84888a78946-8" name="rest_code_05d5f56b2b5f47bab3dac84888a78946-8" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_05d5f56b2b5f47bab3dac84888a78946-8"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;stiff&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_05d5f56b2b5f47bab3dac84888a78946-9" name="rest_code_05d5f56b2b5f47bab3dac84888a78946-9" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_05d5f56b2b5f47bab3dac84888a78946-9"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;rhs&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_05d5f56b2b5f47bab3dac84888a78946-10" name="rest_code_05d5f56b2b5f47bab3dac84888a78946-10" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_05d5f56b2b5f47bab3dac84888a78946-10"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;for&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ele&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;in&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;eles&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_05d5f56b2b5f47bab3dac84888a78946-11" name="rest_code_05d5f56b2b5f47bab3dac84888a78946-11" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_05d5f56b2b5f47bab3dac84888a78946-11"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;jaco&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ele&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;]]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ele&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]]&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_05d5f56b2b5f47bab3dac84888a78946-12" name="rest_code_05d5f56b2b5f47bab3dac84888a78946-12" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_05d5f56b2b5f47bab3dac84888a78946-12"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;rhs&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ele&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;rhs&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ele&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;jaco&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;source&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ele&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_05d5f56b2b5f47bab3dac84888a78946-13" name="rest_code_05d5f56b2b5f47bab3dac84888a78946-13" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_05d5f56b2b5f47bab3dac84888a78946-13"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;stiff&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ele&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ele&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;stiff&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ele&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ele&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;stiff_loc&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;jaco&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_05d5f56b2b5f47bab3dac84888a78946-14" name="rest_code_05d5f56b2b5f47bab3dac84888a78946-14" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_05d5f56b2b5f47bab3dac84888a78946-14"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;end&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_05d5f56b2b5f47bab3dac84888a78946-15" name="rest_code_05d5f56b2b5f47bab3dac84888a78946-15" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_05d5f56b2b5f47bab3dac84888a78946-15"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;return&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;stiff&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;rhs&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_05d5f56b2b5f47bab3dac84888a78946-16" name="rest_code_05d5f56b2b5f47bab3dac84888a78946-16" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_05d5f56b2b5f47bab3dac84888a78946-16"&gt;&lt;/a&gt;&lt;span class="k"&gt;end&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_05d5f56b2b5f47bab3dac84888a78946-17" name="rest_code_05d5f56b2b5f47bab3dac84888a78946-17" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_05d5f56b2b5f47bab3dac84888a78946-17"&gt;&lt;/a&gt;
&lt;a id="rest_code_05d5f56b2b5f47bab3dac84888a78946-18" name="rest_code_05d5f56b2b5f47bab3dac84888a78946-18" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_05d5f56b2b5f47bab3dac84888a78946-18"&gt;&lt;/a&gt;
&lt;a id="rest_code_05d5f56b2b5f47bab3dac84888a78946-19" name="rest_code_05d5f56b2b5f47bab3dac84888a78946-19" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_05d5f56b2b5f47bab3dac84888a78946-19"&gt;&lt;/a&gt;&lt;span class="k"&gt;function&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;conj_grad&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;tol&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mf"&gt;1e-8&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_05d5f56b2b5f47bab3dac84888a78946-20" name="rest_code_05d5f56b2b5f47bab3dac84888a78946-20" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_05d5f56b2b5f47bab3dac84888a78946-20"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_05d5f56b2b5f47bab3dac84888a78946-21" name="rest_code_05d5f56b2b5f47bab3dac84888a78946-21" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_05d5f56b2b5f47bab3dac84888a78946-21"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_05d5f56b2b5f47bab3dac84888a78946-22" name="rest_code_05d5f56b2b5f47bab3dac84888a78946-22" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_05d5f56b2b5f47bab3dac84888a78946-22"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;rsq_old&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;dot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_05d5f56b2b5f47bab3dac84888a78946-23" name="rest_code_05d5f56b2b5f47bab3dac84888a78946-23" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_05d5f56b2b5f47bab3dac84888a78946-23"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;niter&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_05d5f56b2b5f47bab3dac84888a78946-24" name="rest_code_05d5f56b2b5f47bab3dac84888a78946-24" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_05d5f56b2b5f47bab3dac84888a78946-24"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;for&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;cont&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="n"&gt;length&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_05d5f56b2b5f47bab3dac84888a78946-25" name="rest_code_05d5f56b2b5f47bab3dac84888a78946-25" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_05d5f56b2b5f47bab3dac84888a78946-25"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;Ap&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_05d5f56b2b5f47bab3dac84888a78946-26" name="rest_code_05d5f56b2b5f47bab3dac84888a78946-26" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_05d5f56b2b5f47bab3dac84888a78946-26"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;alpha&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;rsq_old&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;dot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Ap&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_05d5f56b2b5f47bab3dac84888a78946-27" name="rest_code_05d5f56b2b5f47bab3dac84888a78946-27" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_05d5f56b2b5f47bab3dac84888a78946-27"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;alpha&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_05d5f56b2b5f47bab3dac84888a78946-28" name="rest_code_05d5f56b2b5f47bab3dac84888a78946-28" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_05d5f56b2b5f47bab3dac84888a78946-28"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;alpha&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;Ap&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_05d5f56b2b5f47bab3dac84888a78946-29" name="rest_code_05d5f56b2b5f47bab3dac84888a78946-29" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_05d5f56b2b5f47bab3dac84888a78946-29"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;rsq_new&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;dot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_05d5f56b2b5f47bab3dac84888a78946-30" name="rest_code_05d5f56b2b5f47bab3dac84888a78946-30" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_05d5f56b2b5f47bab3dac84888a78946-30"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;sqrt&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;rsq_new&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;tol&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_05d5f56b2b5f47bab3dac84888a78946-31" name="rest_code_05d5f56b2b5f47bab3dac84888a78946-31" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_05d5f56b2b5f47bab3dac84888a78946-31"&gt;&lt;/a&gt;&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="k"&gt;break&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_05d5f56b2b5f47bab3dac84888a78946-32" name="rest_code_05d5f56b2b5f47bab3dac84888a78946-32" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_05d5f56b2b5f47bab3dac84888a78946-32"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="k"&gt;end&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_05d5f56b2b5f47bab3dac84888a78946-33" name="rest_code_05d5f56b2b5f47bab3dac84888a78946-33" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_05d5f56b2b5f47bab3dac84888a78946-33"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;rsq_new&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;rsq_old&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_05d5f56b2b5f47bab3dac84888a78946-34" name="rest_code_05d5f56b2b5f47bab3dac84888a78946-34" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_05d5f56b2b5f47bab3dac84888a78946-34"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;rsq_old&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;rsq_new&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_05d5f56b2b5f47bab3dac84888a78946-35" name="rest_code_05d5f56b2b5f47bab3dac84888a78946-35" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_05d5f56b2b5f47bab3dac84888a78946-35"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;niter&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_05d5f56b2b5f47bab3dac84888a78946-36" name="rest_code_05d5f56b2b5f47bab3dac84888a78946-36" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_05d5f56b2b5f47bab3dac84888a78946-36"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;end&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_05d5f56b2b5f47bab3dac84888a78946-37" name="rest_code_05d5f56b2b5f47bab3dac84888a78946-37" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_05d5f56b2b5f47bab3dac84888a78946-37"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;return&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;niter&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;norm&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_05d5f56b2b5f47bab3dac84888a78946-38" name="rest_code_05d5f56b2b5f47bab3dac84888a78946-38" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_05d5f56b2b5f47bab3dac84888a78946-38"&gt;&lt;/a&gt;&lt;span class="k"&gt;end&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_05d5f56b2b5f47bab3dac84888a78946-39" name="rest_code_05d5f56b2b5f47bab3dac84888a78946-39" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_05d5f56b2b5f47bab3dac84888a78946-39"&gt;&lt;/a&gt;
&lt;a id="rest_code_05d5f56b2b5f47bab3dac84888a78946-40" name="rest_code_05d5f56b2b5f47bab3dac84888a78946-40" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_05d5f56b2b5f47bab3dac84888a78946-40"&gt;&lt;/a&gt;
&lt;a id="rest_code_05d5f56b2b5f47bab3dac84888a78946-41" name="rest_code_05d5f56b2b5f47bab3dac84888a78946-41" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_05d5f56b2b5f47bab3dac84888a78946-41"&gt;&lt;/a&gt;
&lt;a id="rest_code_05d5f56b2b5f47bab3dac84888a78946-42" name="rest_code_05d5f56b2b5f47bab3dac84888a78946-42" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_05d5f56b2b5f47bab3dac84888a78946-42"&gt;&lt;/a&gt;&lt;span class="n"&gt;fun&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;.^&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_05d5f56b2b5f47bab3dac84888a78946-43" name="rest_code_05d5f56b2b5f47bab3dac84888a78946-43" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_05d5f56b2b5f47bab3dac84888a78946-43"&gt;&lt;/a&gt;&lt;span class="n"&gt;N_vec&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;round&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;logspace&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;0.5&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;50&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_05d5f56b2b5f47bab3dac84888a78946-44" name="rest_code_05d5f56b2b5f47bab3dac84888a78946-44" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_05d5f56b2b5f47bab3dac84888a78946-44"&gt;&lt;/a&gt;&lt;span class="n"&gt;err_vec&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N_vec&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_05d5f56b2b5f47bab3dac84888a78946-45" name="rest_code_05d5f56b2b5f47bab3dac84888a78946-45" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_05d5f56b2b5f47bab3dac84888a78946-45"&gt;&lt;/a&gt;&lt;span class="n"&gt;niter_vec&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N_vec&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_05d5f56b2b5f47bab3dac84888a78946-46" name="rest_code_05d5f56b2b5f47bab3dac84888a78946-46" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_05d5f56b2b5f47bab3dac84888a78946-46"&gt;&lt;/a&gt;&lt;span class="n"&gt;figure&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;figsize&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;8&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_05d5f56b2b5f47bab3dac84888a78946-47" name="rest_code_05d5f56b2b5f47bab3dac84888a78946-47" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_05d5f56b2b5f47bab3dac84888a78946-47"&gt;&lt;/a&gt;&lt;span class="k"&gt;for&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;cont&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;in&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;enumerate&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N_vec&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_05d5f56b2b5f47bab3dac84888a78946-48" name="rest_code_05d5f56b2b5f47bab3dac84888a78946-48" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_05d5f56b2b5f47bab3dac84888a78946-48"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;linspace&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;0.0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;1.0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_05d5f56b2b5f47bab3dac84888a78946-49" name="rest_code_05d5f56b2b5f47bab3dac84888a78946-49" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_05d5f56b2b5f47bab3dac84888a78946-49"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;stiff&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;rhs&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;FEM1D&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;fun&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_05d5f56b2b5f47bab3dac84888a78946-50" name="rest_code_05d5f56b2b5f47bab3dac84888a78946-50" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_05d5f56b2b5f47bab3dac84888a78946-50"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_05d5f56b2b5f47bab3dac84888a78946-51" name="rest_code_05d5f56b2b5f47bab3dac84888a78946-51" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_05d5f56b2b5f47bab3dac84888a78946-51"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="k"&gt;end&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;niter&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;_&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;conj_grad&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;stiff&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="k"&gt;end&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="k"&gt;end&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_05d5f56b2b5f47bab3dac84888a78946-52" name="rest_code_05d5f56b2b5f47bab3dac84888a78946-52" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_05d5f56b2b5f47bab3dac84888a78946-52"&gt;&lt;/a&gt;&lt;span class="w"&gt;                                &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;rhs&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="k"&gt;end&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;rhs&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="k"&gt;end&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_05d5f56b2b5f47bab3dac84888a78946-53" name="rest_code_05d5f56b2b5f47bab3dac84888a78946-53" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_05d5f56b2b5f47bab3dac84888a78946-53"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;err&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;norm&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;.*&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;.^&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="mi"&gt;20&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;norm&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;.*&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;.^&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="mi"&gt;20&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_05d5f56b2b5f47bab3dac84888a78946-54" name="rest_code_05d5f56b2b5f47bab3dac84888a78946-54" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_05d5f56b2b5f47bab3dac84888a78946-54"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;err_vec&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;cont&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;err&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_05d5f56b2b5f47bab3dac84888a78946-55" name="rest_code_05d5f56b2b5f47bab3dac84888a78946-55" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_05d5f56b2b5f47bab3dac84888a78946-55"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;niter_vec&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;cont&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;niter&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_05d5f56b2b5f47bab3dac84888a78946-56" name="rest_code_05d5f56b2b5f47bab3dac84888a78946-56" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_05d5f56b2b5f47bab3dac84888a78946-56"&gt;&lt;/a&gt;&lt;span class="k"&gt;end&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_05d5f56b2b5f47bab3dac84888a78946-57" name="rest_code_05d5f56b2b5f47bab3dac84888a78946-57" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_05d5f56b2b5f47bab3dac84888a78946-57"&gt;&lt;/a&gt;&lt;span class="n"&gt;subplot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;121&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_05d5f56b2b5f47bab3dac84888a78946-58" name="rest_code_05d5f56b2b5f47bab3dac84888a78946-58" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_05d5f56b2b5f47bab3dac84888a78946-58"&gt;&lt;/a&gt;&lt;span class="n"&gt;loglog&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N_vec&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;err_vec&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_05d5f56b2b5f47bab3dac84888a78946-59" name="rest_code_05d5f56b2b5f47bab3dac84888a78946-59" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_05d5f56b2b5f47bab3dac84888a78946-59"&gt;&lt;/a&gt;&lt;span class="n"&gt;xlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;"Number of nodes"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_05d5f56b2b5f47bab3dac84888a78946-60" name="rest_code_05d5f56b2b5f47bab3dac84888a78946-60" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_05d5f56b2b5f47bab3dac84888a78946-60"&gt;&lt;/a&gt;&lt;span class="n"&gt;ylabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;"Relative error"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_05d5f56b2b5f47bab3dac84888a78946-61" name="rest_code_05d5f56b2b5f47bab3dac84888a78946-61" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_05d5f56b2b5f47bab3dac84888a78946-61"&gt;&lt;/a&gt;&lt;span class="n"&gt;subplot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;122&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_05d5f56b2b5f47bab3dac84888a78946-62" name="rest_code_05d5f56b2b5f47bab3dac84888a78946-62" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_05d5f56b2b5f47bab3dac84888a78946-62"&gt;&lt;/a&gt;&lt;span class="n"&gt;loglog&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N_vec&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;niter_vec&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_05d5f56b2b5f47bab3dac84888a78946-63" name="rest_code_05d5f56b2b5f47bab3dac84888a78946-63" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_05d5f56b2b5f47bab3dac84888a78946-63"&gt;&lt;/a&gt;&lt;span class="n"&gt;xlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;"Number of nodes"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_05d5f56b2b5f47bab3dac84888a78946-64" name="rest_code_05d5f56b2b5f47bab3dac84888a78946-64" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_05d5f56b2b5f47bab3dac84888a78946-64"&gt;&lt;/a&gt;&lt;span class="n"&gt;ylabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;"Number of iterations"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_05d5f56b2b5f47bab3dac84888a78946-65" name="rest_code_05d5f56b2b5f47bab3dac84888a78946-65" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_05d5f56b2b5f47bab3dac84888a78946-65"&gt;&lt;/a&gt;&lt;span class="n"&gt;tight_layout&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_05d5f56b2b5f47bab3dac84888a78946-66" name="rest_code_05d5f56b2b5f47bab3dac84888a78946-66" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_05d5f56b2b5f47bab3dac84888a78946-66"&gt;&lt;/a&gt;&lt;span class="n"&gt;show&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;In this case, we are analyzing the error of the solution as a function
of the number of nodes. This, and the number of iterations required
in the conjugate gradient are shown in the following image&lt;/p&gt;
&lt;img alt="Relative error in the solution." class="align-center" src="https://nicoguaro.github.io/images/FEM1D_convergence.svg" style="width: 800px;"&gt;
&lt;/section&gt;
&lt;/section&gt;</description><category>conjugate gradient</category><category>finite element method</category><category>julia</category><category>numerical methods</category><category>python</category><category>scientific computing</category><guid>https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/</guid><pubDate>Wed, 01 Nov 2017 01:45:09 GMT</pubDate></item><item><title>Numerical methods challenge: Day 30</title><link>https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/</link><dc:creator>Nicolás Guarín-Zapata</dc:creator><description>&lt;p&gt;During October (2017) I will write a program per day for some well-known
numerical methods in both Python and Julia. It is intended to be an exercise
then don't expect the code to be good enough for real use. Also,
I should mention that I have almost no experience with Julia, so it
probably won't be idiomatic Julia but more Python-like Julia.&lt;/p&gt;
&lt;section id="conjugate-gradient"&gt;
&lt;h2&gt;Conjugate gradient&lt;/h2&gt;
&lt;p&gt;Today we have the &lt;a class="reference external" href="https://en.wikipedia.org/wiki/Conjugate_gradient_method"&gt;conjugate gradient method&lt;/a&gt;.
This method is commonly used to solve positive-definite linear systems of
equations. Compared with gradient descent, we choose as descent direction
a direction that is conjugated with the residual, that is, it is
orthogonal with the matrix as weighting.&lt;/p&gt;
&lt;p&gt;Following are the codes&lt;/p&gt;
&lt;section id="python"&gt;
&lt;h3&gt;Python&lt;/h3&gt;
&lt;div class="code"&gt;&lt;pre class="code python"&gt;&lt;a id="rest_code_da383d10cdc5439186200d8884c938cb-1" name="rest_code_da383d10cdc5439186200d8884c938cb-1" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_da383d10cdc5439186200d8884c938cb-1"&gt;&lt;/a&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;__future__&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;division&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;print_function&lt;/span&gt;
&lt;a id="rest_code_da383d10cdc5439186200d8884c938cb-2" name="rest_code_da383d10cdc5439186200d8884c938cb-2" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_da383d10cdc5439186200d8884c938cb-2"&gt;&lt;/a&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;numpy&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;np&lt;/span&gt;
&lt;a id="rest_code_da383d10cdc5439186200d8884c938cb-3" name="rest_code_da383d10cdc5439186200d8884c938cb-3" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_da383d10cdc5439186200d8884c938cb-3"&gt;&lt;/a&gt;
&lt;a id="rest_code_da383d10cdc5439186200d8884c938cb-4" name="rest_code_da383d10cdc5439186200d8884c938cb-4" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_da383d10cdc5439186200d8884c938cb-4"&gt;&lt;/a&gt;
&lt;a id="rest_code_da383d10cdc5439186200d8884c938cb-5" name="rest_code_da383d10cdc5439186200d8884c938cb-5" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_da383d10cdc5439186200d8884c938cb-5"&gt;&lt;/a&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;conj_grad&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;tol&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mf"&gt;1e-8&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_da383d10cdc5439186200d8884c938cb-6" name="rest_code_da383d10cdc5439186200d8884c938cb-6" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_da383d10cdc5439186200d8884c938cb-6"&gt;&lt;/a&gt;    &lt;span class="n"&gt;r&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;b&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;dot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_da383d10cdc5439186200d8884c938cb-7" name="rest_code_da383d10cdc5439186200d8884c938cb-7" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_da383d10cdc5439186200d8884c938cb-7"&gt;&lt;/a&gt;    &lt;span class="n"&gt;p&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;r&lt;/span&gt;
&lt;a id="rest_code_da383d10cdc5439186200d8884c938cb-8" name="rest_code_da383d10cdc5439186200d8884c938cb-8" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_da383d10cdc5439186200d8884c938cb-8"&gt;&lt;/a&gt;    &lt;span class="n"&gt;rsq_old&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;dot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_da383d10cdc5439186200d8884c938cb-9" name="rest_code_da383d10cdc5439186200d8884c938cb-9" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_da383d10cdc5439186200d8884c938cb-9"&gt;&lt;/a&gt;    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;cont&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;)):&lt;/span&gt;
&lt;a id="rest_code_da383d10cdc5439186200d8884c938cb-10" name="rest_code_da383d10cdc5439186200d8884c938cb-10" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_da383d10cdc5439186200d8884c938cb-10"&gt;&lt;/a&gt;        &lt;span class="n"&gt;Ap&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;dot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_da383d10cdc5439186200d8884c938cb-11" name="rest_code_da383d10cdc5439186200d8884c938cb-11" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_da383d10cdc5439186200d8884c938cb-11"&gt;&lt;/a&gt;        &lt;span class="n"&gt;alpha&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;rsq_old&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;dot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Ap&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_da383d10cdc5439186200d8884c938cb-12" name="rest_code_da383d10cdc5439186200d8884c938cb-12" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_da383d10cdc5439186200d8884c938cb-12"&gt;&lt;/a&gt;        &lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;alpha&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;p&lt;/span&gt;
&lt;a id="rest_code_da383d10cdc5439186200d8884c938cb-13" name="rest_code_da383d10cdc5439186200d8884c938cb-13" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_da383d10cdc5439186200d8884c938cb-13"&gt;&lt;/a&gt;        &lt;span class="n"&gt;r&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;r&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;alpha&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;Ap&lt;/span&gt;
&lt;a id="rest_code_da383d10cdc5439186200d8884c938cb-14" name="rest_code_da383d10cdc5439186200d8884c938cb-14" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_da383d10cdc5439186200d8884c938cb-14"&gt;&lt;/a&gt;        &lt;span class="n"&gt;rsq_new&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;dot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_da383d10cdc5439186200d8884c938cb-15" name="rest_code_da383d10cdc5439186200d8884c938cb-15" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_da383d10cdc5439186200d8884c938cb-15"&gt;&lt;/a&gt;        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sqrt&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;rsq_new&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;tol&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a id="rest_code_da383d10cdc5439186200d8884c938cb-16" name="rest_code_da383d10cdc5439186200d8884c938cb-16" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_da383d10cdc5439186200d8884c938cb-16"&gt;&lt;/a&gt;            &lt;span class="k"&gt;break&lt;/span&gt;
&lt;a id="rest_code_da383d10cdc5439186200d8884c938cb-17" name="rest_code_da383d10cdc5439186200d8884c938cb-17" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_da383d10cdc5439186200d8884c938cb-17"&gt;&lt;/a&gt;        &lt;span class="n"&gt;p&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;r&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;rsq_new&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="n"&gt;rsq_old&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;p&lt;/span&gt;
&lt;a id="rest_code_da383d10cdc5439186200d8884c938cb-18" name="rest_code_da383d10cdc5439186200d8884c938cb-18" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_da383d10cdc5439186200d8884c938cb-18"&gt;&lt;/a&gt;        &lt;span class="n"&gt;rsq_old&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;rsq_new&lt;/span&gt;
&lt;a id="rest_code_da383d10cdc5439186200d8884c938cb-19" name="rest_code_da383d10cdc5439186200d8884c938cb-19" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_da383d10cdc5439186200d8884c938cb-19"&gt;&lt;/a&gt;    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;cont&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sqrt&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;rsq_new&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_da383d10cdc5439186200d8884c938cb-20" name="rest_code_da383d10cdc5439186200d8884c938cb-20" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_da383d10cdc5439186200d8884c938cb-20"&gt;&lt;/a&gt;
&lt;a id="rest_code_da383d10cdc5439186200d8884c938cb-21" name="rest_code_da383d10cdc5439186200d8884c938cb-21" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_da383d10cdc5439186200d8884c938cb-21"&gt;&lt;/a&gt;
&lt;a id="rest_code_da383d10cdc5439186200d8884c938cb-22" name="rest_code_da383d10cdc5439186200d8884c938cb-22" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_da383d10cdc5439186200d8884c938cb-22"&gt;&lt;/a&gt;&lt;span class="n"&gt;N&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;1000&lt;/span&gt;
&lt;a id="rest_code_da383d10cdc5439186200d8884c938cb-23" name="rest_code_da383d10cdc5439186200d8884c938cb-23" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_da383d10cdc5439186200d8884c938cb-23"&gt;&lt;/a&gt;&lt;span class="n"&gt;A&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;diag&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ones&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;diag&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ones&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt;\
&lt;a id="rest_code_da383d10cdc5439186200d8884c938cb-24" name="rest_code_da383d10cdc5439186200d8884c938cb-24" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_da383d10cdc5439186200d8884c938cb-24"&gt;&lt;/a&gt;    &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;diag&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ones&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_da383d10cdc5439186200d8884c938cb-25" name="rest_code_da383d10cdc5439186200d8884c938cb-25" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_da383d10cdc5439186200d8884c938cb-25"&gt;&lt;/a&gt;&lt;span class="n"&gt;b&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ones&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_da383d10cdc5439186200d8884c938cb-26" name="rest_code_da383d10cdc5439186200d8884c938cb-26" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_da383d10cdc5439186200d8884c938cb-26"&gt;&lt;/a&gt;&lt;span class="n"&gt;x0&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ones&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_da383d10cdc5439186200d8884c938cb-27" name="rest_code_da383d10cdc5439186200d8884c938cb-27" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_da383d10cdc5439186200d8884c938cb-27"&gt;&lt;/a&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;niter&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;accu&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;conj_grad&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;x0&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/section&gt;
&lt;section id="julia"&gt;
&lt;h3&gt;Julia&lt;/h3&gt;
&lt;div class="code"&gt;&lt;pre class="code julia"&gt;&lt;a id="rest_code_f9ea0e9144db4e168bb726a4ee7811df-1" name="rest_code_f9ea0e9144db4e168bb726a4ee7811df-1" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_f9ea0e9144db4e168bb726a4ee7811df-1"&gt;&lt;/a&gt;&lt;span class="k"&gt;function&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;conj_grad&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;tol&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mf"&gt;1e-8&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_f9ea0e9144db4e168bb726a4ee7811df-2" name="rest_code_f9ea0e9144db4e168bb726a4ee7811df-2" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_f9ea0e9144db4e168bb726a4ee7811df-2"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_f9ea0e9144db4e168bb726a4ee7811df-3" name="rest_code_f9ea0e9144db4e168bb726a4ee7811df-3" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_f9ea0e9144db4e168bb726a4ee7811df-3"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_f9ea0e9144db4e168bb726a4ee7811df-4" name="rest_code_f9ea0e9144db4e168bb726a4ee7811df-4" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_f9ea0e9144db4e168bb726a4ee7811df-4"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;rsq_old&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;dot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_f9ea0e9144db4e168bb726a4ee7811df-5" name="rest_code_f9ea0e9144db4e168bb726a4ee7811df-5" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_f9ea0e9144db4e168bb726a4ee7811df-5"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;niter&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_f9ea0e9144db4e168bb726a4ee7811df-6" name="rest_code_f9ea0e9144db4e168bb726a4ee7811df-6" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_f9ea0e9144db4e168bb726a4ee7811df-6"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;for&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;cont&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="n"&gt;length&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_f9ea0e9144db4e168bb726a4ee7811df-7" name="rest_code_f9ea0e9144db4e168bb726a4ee7811df-7" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_f9ea0e9144db4e168bb726a4ee7811df-7"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;Ap&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_f9ea0e9144db4e168bb726a4ee7811df-8" name="rest_code_f9ea0e9144db4e168bb726a4ee7811df-8" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_f9ea0e9144db4e168bb726a4ee7811df-8"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;alpha&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;rsq_old&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;dot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Ap&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_f9ea0e9144db4e168bb726a4ee7811df-9" name="rest_code_f9ea0e9144db4e168bb726a4ee7811df-9" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_f9ea0e9144db4e168bb726a4ee7811df-9"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;alpha&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_f9ea0e9144db4e168bb726a4ee7811df-10" name="rest_code_f9ea0e9144db4e168bb726a4ee7811df-10" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_f9ea0e9144db4e168bb726a4ee7811df-10"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;alpha&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;Ap&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_f9ea0e9144db4e168bb726a4ee7811df-11" name="rest_code_f9ea0e9144db4e168bb726a4ee7811df-11" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_f9ea0e9144db4e168bb726a4ee7811df-11"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;rsq_new&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;dot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_f9ea0e9144db4e168bb726a4ee7811df-12" name="rest_code_f9ea0e9144db4e168bb726a4ee7811df-12" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_f9ea0e9144db4e168bb726a4ee7811df-12"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;sqrt&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;rsq_new&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;tol&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_f9ea0e9144db4e168bb726a4ee7811df-13" name="rest_code_f9ea0e9144db4e168bb726a4ee7811df-13" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_f9ea0e9144db4e168bb726a4ee7811df-13"&gt;&lt;/a&gt;&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="k"&gt;break&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_f9ea0e9144db4e168bb726a4ee7811df-14" name="rest_code_f9ea0e9144db4e168bb726a4ee7811df-14" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_f9ea0e9144db4e168bb726a4ee7811df-14"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="k"&gt;end&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_f9ea0e9144db4e168bb726a4ee7811df-15" name="rest_code_f9ea0e9144db4e168bb726a4ee7811df-15" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_f9ea0e9144db4e168bb726a4ee7811df-15"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;rsq_new&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;rsq_old&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_f9ea0e9144db4e168bb726a4ee7811df-16" name="rest_code_f9ea0e9144db4e168bb726a4ee7811df-16" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_f9ea0e9144db4e168bb726a4ee7811df-16"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;rsq_old&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;rsq_new&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_f9ea0e9144db4e168bb726a4ee7811df-17" name="rest_code_f9ea0e9144db4e168bb726a4ee7811df-17" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_f9ea0e9144db4e168bb726a4ee7811df-17"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;niter&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_f9ea0e9144db4e168bb726a4ee7811df-18" name="rest_code_f9ea0e9144db4e168bb726a4ee7811df-18" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_f9ea0e9144db4e168bb726a4ee7811df-18"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;end&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_f9ea0e9144db4e168bb726a4ee7811df-19" name="rest_code_f9ea0e9144db4e168bb726a4ee7811df-19" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_f9ea0e9144db4e168bb726a4ee7811df-19"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;return&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;niter&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;norm&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_f9ea0e9144db4e168bb726a4ee7811df-20" name="rest_code_f9ea0e9144db4e168bb726a4ee7811df-20" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_f9ea0e9144db4e168bb726a4ee7811df-20"&gt;&lt;/a&gt;&lt;span class="k"&gt;end&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_f9ea0e9144db4e168bb726a4ee7811df-21" name="rest_code_f9ea0e9144db4e168bb726a4ee7811df-21" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_f9ea0e9144db4e168bb726a4ee7811df-21"&gt;&lt;/a&gt;
&lt;a id="rest_code_f9ea0e9144db4e168bb726a4ee7811df-22" name="rest_code_f9ea0e9144db4e168bb726a4ee7811df-22" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_f9ea0e9144db4e168bb726a4ee7811df-22"&gt;&lt;/a&gt;
&lt;a id="rest_code_f9ea0e9144db4e168bb726a4ee7811df-23" name="rest_code_f9ea0e9144db4e168bb726a4ee7811df-23" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_f9ea0e9144db4e168bb726a4ee7811df-23"&gt;&lt;/a&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1000&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_f9ea0e9144db4e168bb726a4ee7811df-24" name="rest_code_f9ea0e9144db4e168bb726a4ee7811df-24" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_f9ea0e9144db4e168bb726a4ee7811df-24"&gt;&lt;/a&gt;&lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;diagm&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;ones&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;diagm&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ones&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;diagm&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ones&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_f9ea0e9144db4e168bb726a4ee7811df-25" name="rest_code_f9ea0e9144db4e168bb726a4ee7811df-25" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_f9ea0e9144db4e168bb726a4ee7811df-25"&gt;&lt;/a&gt;&lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ones&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_f9ea0e9144db4e168bb726a4ee7811df-26" name="rest_code_f9ea0e9144db4e168bb726a4ee7811df-26" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_f9ea0e9144db4e168bb726a4ee7811df-26"&gt;&lt;/a&gt;&lt;span class="n"&gt;x0&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ones&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_f9ea0e9144db4e168bb726a4ee7811df-27" name="rest_code_f9ea0e9144db4e168bb726a4ee7811df-27" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_f9ea0e9144db4e168bb726a4ee7811df-27"&gt;&lt;/a&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;niter&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;accu&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;conj_grad&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;x0&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;In this case, we are testing the method with a matrix that comes from
the discretization of the second order derivative using finite differences.&lt;/p&gt;
&lt;/section&gt;
&lt;section id="comparison-python-julia"&gt;
&lt;h3&gt;Comparison Python/Julia&lt;/h3&gt;
&lt;p&gt;Regarding number of lines we have: 27 in Python and 27 in Julia. The comparison
in execution time is done with &lt;code class="docutils literal"&gt;%timeit&lt;/code&gt; magic command in IPython and
&lt;code class="docutils literal"&gt;@benchmark&lt;/code&gt; in Julia.&lt;/p&gt;
&lt;p&gt;For Python:&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code IPython"&gt;&lt;a id="rest_code_6acf576e0ef442eda7783a4a58998e84-1" name="rest_code_6acf576e0ef442eda7783a4a58998e84-1" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_6acf576e0ef442eda7783a4a58998e84-1"&gt;&lt;/a&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="k"&gt;timeit&lt;/span&gt; conj_grad(A, b, x0)
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;with result&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code text"&gt;&lt;a id="rest_code_d2478854cefa41848fa3ecc0b4ebc42e-1" name="rest_code_d2478854cefa41848fa3ecc0b4ebc42e-1" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_d2478854cefa41848fa3ecc0b4ebc42e-1"&gt;&lt;/a&gt;10 loops, best of 3: 107 ms per loop
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;For Julia:&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code julia"&gt;&lt;a id="rest_code_47173f23e256493a858d0254840c3e24-1" name="rest_code_47173f23e256493a858d0254840c3e24-1" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_47173f23e256493a858d0254840c3e24-1"&gt;&lt;/a&gt;&lt;span class="nd"&gt;@benchmark&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;conj_grad&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;x0&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;with result&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code julia"&gt;&lt;a id="rest_code_a5a1633de2434a43acf3c59dc9f22714-1" name="rest_code_a5a1633de2434a43acf3c59dc9f22714-1" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_a5a1633de2434a43acf3c59dc9f22714-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;BenchmarkTools&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Trial&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_a5a1633de2434a43acf3c59dc9f22714-2" name="rest_code_a5a1633de2434a43acf3c59dc9f22714-2" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_a5a1633de2434a43acf3c59dc9f22714-2"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;memory&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;estimate&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="mf"&gt;27.13&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;MiB&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_a5a1633de2434a43acf3c59dc9f22714-3" name="rest_code_a5a1633de2434a43acf3c59dc9f22714-3" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_a5a1633de2434a43acf3c59dc9f22714-3"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;allocs&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;estimate&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="mi"&gt;3501&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_a5a1633de2434a43acf3c59dc9f22714-4" name="rest_code_a5a1633de2434a43acf3c59dc9f22714-4" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_a5a1633de2434a43acf3c59dc9f22714-4"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="o"&gt;--------------&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_a5a1633de2434a43acf3c59dc9f22714-5" name="rest_code_a5a1633de2434a43acf3c59dc9f22714-5" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_a5a1633de2434a43acf3c59dc9f22714-5"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;minimum&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;     &lt;/span&gt;&lt;span class="mf"&gt;128.477&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ms&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;0.54&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;GC&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_a5a1633de2434a43acf3c59dc9f22714-6" name="rest_code_a5a1633de2434a43acf3c59dc9f22714-6" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_a5a1633de2434a43acf3c59dc9f22714-6"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;median&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="mf"&gt;294.407&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ms&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;0.24&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;GC&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_a5a1633de2434a43acf3c59dc9f22714-7" name="rest_code_a5a1633de2434a43acf3c59dc9f22714-7" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_a5a1633de2434a43acf3c59dc9f22714-7"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;mean&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="mf"&gt;298.208&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ms&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;0.30&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;GC&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_a5a1633de2434a43acf3c59dc9f22714-8" name="rest_code_a5a1633de2434a43acf3c59dc9f22714-8" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_a5a1633de2434a43acf3c59dc9f22714-8"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;maximum&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;     &lt;/span&gt;&lt;span class="mf"&gt;464.223&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ms&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;0.30&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;GC&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_a5a1633de2434a43acf3c59dc9f22714-9" name="rest_code_a5a1633de2434a43acf3c59dc9f22714-9" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_a5a1633de2434a43acf3c59dc9f22714-9"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="o"&gt;--------------&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_a5a1633de2434a43acf3c59dc9f22714-10" name="rest_code_a5a1633de2434a43acf3c59dc9f22714-10" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_a5a1633de2434a43acf3c59dc9f22714-10"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;samples&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;          &lt;/span&gt;&lt;span class="mi"&gt;17&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_a5a1633de2434a43acf3c59dc9f22714-11" name="rest_code_a5a1633de2434a43acf3c59dc9f22714-11" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_a5a1633de2434a43acf3c59dc9f22714-11"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;evals&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;sample&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;     &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;In this case, we can say that the Python code is roughly 2 times faster than
Julia code.&lt;/p&gt;
&lt;/section&gt;
&lt;/section&gt;</description><category>conjugate gradient</category><category>julia</category><category>numerical methods</category><category>python</category><category>scientific computing</category><guid>https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/</guid><pubDate>Tue, 31 Oct 2017 00:38:03 GMT</pubDate></item><item><title>Numerical methods challenge: Day 29</title><link>https://nicoguaro.github.io/posts/numerical_challenge/numerical-29/</link><dc:creator>Nicolás Guarín-Zapata</dc:creator><description>&lt;p&gt;During October (2017) I will write a program per day for some well-known
numerical methods in both Python and Julia. It is intended to be an exercise
then don't expect the code to be good enough for real use. Also,
I should mention that I have almost no experience with Julia, so it
probably won't be idiomatic Julia but more Python-like Julia.&lt;/p&gt;
&lt;section id="cholesky-decomposition"&gt;
&lt;h2&gt;Cholesky decomposition&lt;/h2&gt;
&lt;p&gt;Today we have &lt;a class="reference external" href="https://en.wikipedia.org/wiki/Cholesky_decomposition"&gt;Cholesky decomposition&lt;/a&gt;.
It is a factorization of a Hermitian, positive-definite matrix into
a lower and upper matrix, the main difference with LU decomposition
is that it the lower matrix is the Hermitian transpose of the upper one.&lt;/p&gt;
&lt;p&gt;Following are the codes&lt;/p&gt;
&lt;section id="python"&gt;
&lt;h3&gt;Python&lt;/h3&gt;
&lt;div class="code"&gt;&lt;pre class="code python"&gt;&lt;a id="rest_code_2b6094986c004a37b60ebf7c9a14a098-1" name="rest_code_2b6094986c004a37b60ebf7c9a14a098-1" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-29/#rest_code_2b6094986c004a37b60ebf7c9a14a098-1"&gt;&lt;/a&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;__future__&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;division&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;print_function&lt;/span&gt;
&lt;a id="rest_code_2b6094986c004a37b60ebf7c9a14a098-2" name="rest_code_2b6094986c004a37b60ebf7c9a14a098-2" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-29/#rest_code_2b6094986c004a37b60ebf7c9a14a098-2"&gt;&lt;/a&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;numpy&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;np&lt;/span&gt;
&lt;a id="rest_code_2b6094986c004a37b60ebf7c9a14a098-3" name="rest_code_2b6094986c004a37b60ebf7c9a14a098-3" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-29/#rest_code_2b6094986c004a37b60ebf7c9a14a098-3"&gt;&lt;/a&gt;
&lt;a id="rest_code_2b6094986c004a37b60ebf7c9a14a098-4" name="rest_code_2b6094986c004a37b60ebf7c9a14a098-4" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-29/#rest_code_2b6094986c004a37b60ebf7c9a14a098-4"&gt;&lt;/a&gt;
&lt;a id="rest_code_2b6094986c004a37b60ebf7c9a14a098-5" name="rest_code_2b6094986c004a37b60ebf7c9a14a098-5" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-29/#rest_code_2b6094986c004a37b60ebf7c9a14a098-5"&gt;&lt;/a&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;cholesky&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;mat&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_2b6094986c004a37b60ebf7c9a14a098-6" name="rest_code_2b6094986c004a37b60ebf7c9a14a098-6" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-29/#rest_code_2b6094986c004a37b60ebf7c9a14a098-6"&gt;&lt;/a&gt;    &lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;_&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;mat&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;shape&lt;/span&gt;
&lt;a id="rest_code_2b6094986c004a37b60ebf7c9a14a098-7" name="rest_code_2b6094986c004a37b60ebf7c9a14a098-7" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-29/#rest_code_2b6094986c004a37b60ebf7c9a14a098-7"&gt;&lt;/a&gt;    &lt;span class="n"&gt;mat&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;mat&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;copy&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a id="rest_code_2b6094986c004a37b60ebf7c9a14a098-8" name="rest_code_2b6094986c004a37b60ebf7c9a14a098-8" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-29/#rest_code_2b6094986c004a37b60ebf7c9a14a098-8"&gt;&lt;/a&gt;    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;col&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_2b6094986c004a37b60ebf7c9a14a098-9" name="rest_code_2b6094986c004a37b60ebf7c9a14a098-9" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-29/#rest_code_2b6094986c004a37b60ebf7c9a14a098-9"&gt;&lt;/a&gt;        &lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;mat&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;
&lt;a id="rest_code_2b6094986c004a37b60ebf7c9a14a098-10" name="rest_code_2b6094986c004a37b60ebf7c9a14a098-10" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-29/#rest_code_2b6094986c004a37b60ebf7c9a14a098-10"&gt;&lt;/a&gt;               &lt;span class="n"&gt;mat&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;dot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;mat&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="p"&gt;]))&lt;/span&gt;
&lt;a id="rest_code_2b6094986c004a37b60ebf7c9a14a098-11" name="rest_code_2b6094986c004a37b60ebf7c9a14a098-11" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-29/#rest_code_2b6094986c004a37b60ebf7c9a14a098-11"&gt;&lt;/a&gt;        &lt;span class="n"&gt;mat&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sqrt&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;mat&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;
&lt;a id="rest_code_2b6094986c004a37b60ebf7c9a14a098-12" name="rest_code_2b6094986c004a37b60ebf7c9a14a098-12" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-29/#rest_code_2b6094986c004a37b60ebf7c9a14a098-12"&gt;&lt;/a&gt;               &lt;span class="n"&gt;mat&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;dot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;mat&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="p"&gt;]))&lt;/span&gt;
&lt;a id="rest_code_2b6094986c004a37b60ebf7c9a14a098-13" name="rest_code_2b6094986c004a37b60ebf7c9a14a098-13" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-29/#rest_code_2b6094986c004a37b60ebf7c9a14a098-13"&gt;&lt;/a&gt;        &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;row&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;col&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_2b6094986c004a37b60ebf7c9a14a098-14" name="rest_code_2b6094986c004a37b60ebf7c9a14a098-14" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-29/#rest_code_2b6094986c004a37b60ebf7c9a14a098-14"&gt;&lt;/a&gt;            &lt;span class="n"&gt;mat&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;row&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;mat&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;row&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;
&lt;a id="rest_code_2b6094986c004a37b60ebf7c9a14a098-15" name="rest_code_2b6094986c004a37b60ebf7c9a14a098-15" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-29/#rest_code_2b6094986c004a37b60ebf7c9a14a098-15"&gt;&lt;/a&gt;               &lt;span class="n"&gt;mat&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;row&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;dot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;mat&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="p"&gt;]))&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;mat&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_2b6094986c004a37b60ebf7c9a14a098-16" name="rest_code_2b6094986c004a37b60ebf7c9a14a098-16" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-29/#rest_code_2b6094986c004a37b60ebf7c9a14a098-16"&gt;&lt;/a&gt;    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;row&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_2b6094986c004a37b60ebf7c9a14a098-17" name="rest_code_2b6094986c004a37b60ebf7c9a14a098-17" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-29/#rest_code_2b6094986c004a37b60ebf7c9a14a098-17"&gt;&lt;/a&gt;        &lt;span class="n"&gt;mat&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="n"&gt;row&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;row&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;
&lt;a id="rest_code_2b6094986c004a37b60ebf7c9a14a098-18" name="rest_code_2b6094986c004a37b60ebf7c9a14a098-18" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-29/#rest_code_2b6094986c004a37b60ebf7c9a14a098-18"&gt;&lt;/a&gt;    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;mat&lt;/span&gt;
&lt;a id="rest_code_2b6094986c004a37b60ebf7c9a14a098-19" name="rest_code_2b6094986c004a37b60ebf7c9a14a098-19" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-29/#rest_code_2b6094986c004a37b60ebf7c9a14a098-19"&gt;&lt;/a&gt;
&lt;a id="rest_code_2b6094986c004a37b60ebf7c9a14a098-20" name="rest_code_2b6094986c004a37b60ebf7c9a14a098-20" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-29/#rest_code_2b6094986c004a37b60ebf7c9a14a098-20"&gt;&lt;/a&gt;
&lt;a id="rest_code_2b6094986c004a37b60ebf7c9a14a098-21" name="rest_code_2b6094986c004a37b60ebf7c9a14a098-21" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-29/#rest_code_2b6094986c004a37b60ebf7c9a14a098-21"&gt;&lt;/a&gt;&lt;span class="n"&gt;A&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;
&lt;a id="rest_code_2b6094986c004a37b60ebf7c9a14a098-22" name="rest_code_2b6094986c004a37b60ebf7c9a14a098-22" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-29/#rest_code_2b6094986c004a37b60ebf7c9a14a098-22"&gt;&lt;/a&gt;    &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;
&lt;a id="rest_code_2b6094986c004a37b60ebf7c9a14a098-23" name="rest_code_2b6094986c004a37b60ebf7c9a14a098-23" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-29/#rest_code_2b6094986c004a37b60ebf7c9a14a098-23"&gt;&lt;/a&gt;    &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;4.25&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;2.75&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;
&lt;a id="rest_code_2b6094986c004a37b60ebf7c9a14a098-24" name="rest_code_2b6094986c004a37b60ebf7c9a14a098-24" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-29/#rest_code_2b6094986c004a37b60ebf7c9a14a098-24"&gt;&lt;/a&gt;    &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;2.75&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;3.5&lt;/span&gt;&lt;span class="p"&gt;]],&lt;/span&gt; &lt;span class="n"&gt;dtype&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nb"&gt;float&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_2b6094986c004a37b60ebf7c9a14a098-25" name="rest_code_2b6094986c004a37b60ebf7c9a14a098-25" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-29/#rest_code_2b6094986c004a37b60ebf7c9a14a098-25"&gt;&lt;/a&gt;&lt;span class="n"&gt;B&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;cholesky&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/section&gt;
&lt;section id="julia"&gt;
&lt;h3&gt;Julia&lt;/h3&gt;
&lt;div class="code"&gt;&lt;pre class="code julia"&gt;&lt;a id="rest_code_100561219a6e46c0a71dfed1921ed168-1" name="rest_code_100561219a6e46c0a71dfed1921ed168-1" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-29/#rest_code_100561219a6e46c0a71dfed1921ed168-1"&gt;&lt;/a&gt;&lt;span class="k"&gt;function&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;cholesky&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;mat&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_100561219a6e46c0a71dfed1921ed168-2" name="rest_code_100561219a6e46c0a71dfed1921ed168-2" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-29/#rest_code_100561219a6e46c0a71dfed1921ed168-2"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;_&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;size&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;mat&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_100561219a6e46c0a71dfed1921ed168-3" name="rest_code_100561219a6e46c0a71dfed1921ed168-3" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-29/#rest_code_100561219a6e46c0a71dfed1921ed168-3"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;mat&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;copy&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;mat&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_100561219a6e46c0a71dfed1921ed168-4" name="rest_code_100561219a6e46c0a71dfed1921ed168-4" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-29/#rest_code_100561219a6e46c0a71dfed1921ed168-4"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;for&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_100561219a6e46c0a71dfed1921ed168-5" name="rest_code_100561219a6e46c0a71dfed1921ed168-5" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-29/#rest_code_100561219a6e46c0a71dfed1921ed168-5"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;mat&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;sqrt&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;mat&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_100561219a6e46c0a71dfed1921ed168-6" name="rest_code_100561219a6e46c0a71dfed1921ed168-6" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-29/#rest_code_100561219a6e46c0a71dfed1921ed168-6"&gt;&lt;/a&gt;&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="n"&gt;dot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;mat&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;mat&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]))&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_100561219a6e46c0a71dfed1921ed168-7" name="rest_code_100561219a6e46c0a71dfed1921ed168-7" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-29/#rest_code_100561219a6e46c0a71dfed1921ed168-7"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="k"&gt;for&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;row&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_100561219a6e46c0a71dfed1921ed168-8" name="rest_code_100561219a6e46c0a71dfed1921ed168-8" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-29/#rest_code_100561219a6e46c0a71dfed1921ed168-8"&gt;&lt;/a&gt;&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="n"&gt;mat&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;row&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;mat&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;row&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_100561219a6e46c0a71dfed1921ed168-9" name="rest_code_100561219a6e46c0a71dfed1921ed168-9" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-29/#rest_code_100561219a6e46c0a71dfed1921ed168-9"&gt;&lt;/a&gt;&lt;span class="w"&gt;               &lt;/span&gt;&lt;span class="n"&gt;dot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;mat&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;row&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;mat&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]))&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;mat&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_100561219a6e46c0a71dfed1921ed168-10" name="rest_code_100561219a6e46c0a71dfed1921ed168-10" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-29/#rest_code_100561219a6e46c0a71dfed1921ed168-10"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="k"&gt;end&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_100561219a6e46c0a71dfed1921ed168-11" name="rest_code_100561219a6e46c0a71dfed1921ed168-11" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-29/#rest_code_100561219a6e46c0a71dfed1921ed168-11"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;end&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_100561219a6e46c0a71dfed1921ed168-12" name="rest_code_100561219a6e46c0a71dfed1921ed168-12" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-29/#rest_code_100561219a6e46c0a71dfed1921ed168-12"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;for&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;row&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_100561219a6e46c0a71dfed1921ed168-13" name="rest_code_100561219a6e46c0a71dfed1921ed168-13" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-29/#rest_code_100561219a6e46c0a71dfed1921ed168-13"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;mat&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="n"&gt;row&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;row&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_100561219a6e46c0a71dfed1921ed168-14" name="rest_code_100561219a6e46c0a71dfed1921ed168-14" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-29/#rest_code_100561219a6e46c0a71dfed1921ed168-14"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;end&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_100561219a6e46c0a71dfed1921ed168-15" name="rest_code_100561219a6e46c0a71dfed1921ed168-15" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-29/#rest_code_100561219a6e46c0a71dfed1921ed168-15"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;return&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;mat&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_100561219a6e46c0a71dfed1921ed168-16" name="rest_code_100561219a6e46c0a71dfed1921ed168-16" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-29/#rest_code_100561219a6e46c0a71dfed1921ed168-16"&gt;&lt;/a&gt;&lt;span class="k"&gt;end&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_100561219a6e46c0a71dfed1921ed168-17" name="rest_code_100561219a6e46c0a71dfed1921ed168-17" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-29/#rest_code_100561219a6e46c0a71dfed1921ed168-17"&gt;&lt;/a&gt;
&lt;a id="rest_code_100561219a6e46c0a71dfed1921ed168-18" name="rest_code_100561219a6e46c0a71dfed1921ed168-18" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-29/#rest_code_100561219a6e46c0a71dfed1921ed168-18"&gt;&lt;/a&gt;
&lt;a id="rest_code_100561219a6e46c0a71dfed1921ed168-19" name="rest_code_100561219a6e46c0a71dfed1921ed168-19" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-29/#rest_code_100561219a6e46c0a71dfed1921ed168-19"&gt;&lt;/a&gt;&lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_100561219a6e46c0a71dfed1921ed168-20" name="rest_code_100561219a6e46c0a71dfed1921ed168-20" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-29/#rest_code_100561219a6e46c0a71dfed1921ed168-20"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;4.25&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;2.75&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_100561219a6e46c0a71dfed1921ed168-21" name="rest_code_100561219a6e46c0a71dfed1921ed168-21" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-29/#rest_code_100561219a6e46c0a71dfed1921ed168-21"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;2.75&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;3.5&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_100561219a6e46c0a71dfed1921ed168-22" name="rest_code_100561219a6e46c0a71dfed1921ed168-22" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-29/#rest_code_100561219a6e46c0a71dfed1921ed168-22"&gt;&lt;/a&gt;&lt;span class="n"&gt;B&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;cholesky&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;As an example we have the matrix&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
A = \begin{bmatrix}
     4 &amp;amp;-1 &amp;amp;1\\
    -1 &amp;amp;4.25 &amp;amp;2.75\\
     1 &amp;amp;2.75 &amp;amp;3.5
    \end{bmatrix}
\end{equation*}
&lt;/div&gt;
&lt;p&gt;And, the answer of both codes is&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code text"&gt;&lt;a id="rest_code_0bd4694b7aee445196054cfada61d272-1" name="rest_code_0bd4694b7aee445196054cfada61d272-1" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-29/#rest_code_0bd4694b7aee445196054cfada61d272-1"&gt;&lt;/a&gt;2.0  0.0  0.0
&lt;a id="rest_code_0bd4694b7aee445196054cfada61d272-2" name="rest_code_0bd4694b7aee445196054cfada61d272-2" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-29/#rest_code_0bd4694b7aee445196054cfada61d272-2"&gt;&lt;/a&gt;-0.5  2.0  0.0
&lt;a id="rest_code_0bd4694b7aee445196054cfada61d272-3" name="rest_code_0bd4694b7aee445196054cfada61d272-3" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-29/#rest_code_0bd4694b7aee445196054cfada61d272-3"&gt;&lt;/a&gt;0.5  1.5  1.0
&lt;/pre&gt;&lt;/div&gt;
&lt;/section&gt;
&lt;section id="comparison-python-julia"&gt;
&lt;h3&gt;Comparison Python/Julia&lt;/h3&gt;
&lt;p&gt;Regarding number of lines we have: 23 in Python and 22 in Julia. The comparison
in execution time is done with &lt;code class="docutils literal"&gt;%timeit&lt;/code&gt; magic command in IPython and
&lt;code class="docutils literal"&gt;@benchmark&lt;/code&gt; in Julia.&lt;/p&gt;
&lt;p&gt;For Python:&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code IPython"&gt;&lt;a id="rest_code_d06d828d0c93400dbe858e191986e498-1" name="rest_code_d06d828d0c93400dbe858e191986e498-1" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-29/#rest_code_d06d828d0c93400dbe858e191986e498-1"&gt;&lt;/a&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="k"&gt;timeit&lt;/span&gt; cholesky(np.eye(100))
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;with result&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code text"&gt;&lt;a id="rest_code_feb408a0c3794b91a8f9dda39fb98f4a-1" name="rest_code_feb408a0c3794b91a8f9dda39fb98f4a-1" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-29/#rest_code_feb408a0c3794b91a8f9dda39fb98f4a-1"&gt;&lt;/a&gt;100 loops, best of 3: 13 ms per loop
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;For Julia:&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code julia"&gt;&lt;a id="rest_code_94d3b5a286ff4f108624183836930346-1" name="rest_code_94d3b5a286ff4f108624183836930346-1" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-29/#rest_code_94d3b5a286ff4f108624183836930346-1"&gt;&lt;/a&gt;&lt;span class="nd"&gt;@benchmark&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;cholesky&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;eye&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;100&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;with result&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code julia"&gt;&lt;a id="rest_code_8572dbf0fa194a4ab0b2f4a2fa707c12-1" name="rest_code_8572dbf0fa194a4ab0b2f4a2fa707c12-1" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-29/#rest_code_8572dbf0fa194a4ab0b2f4a2fa707c12-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;BenchmarkTools&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Trial&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_8572dbf0fa194a4ab0b2f4a2fa707c12-2" name="rest_code_8572dbf0fa194a4ab0b2f4a2fa707c12-2" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-29/#rest_code_8572dbf0fa194a4ab0b2f4a2fa707c12-2"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;memory&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;estimate&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="mf"&gt;4.01&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;MiB&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_8572dbf0fa194a4ab0b2f4a2fa707c12-3" name="rest_code_8572dbf0fa194a4ab0b2f4a2fa707c12-3" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-29/#rest_code_8572dbf0fa194a4ab0b2f4a2fa707c12-3"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;allocs&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;estimate&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="mi"&gt;20303&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_8572dbf0fa194a4ab0b2f4a2fa707c12-4" name="rest_code_8572dbf0fa194a4ab0b2f4a2fa707c12-4" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-29/#rest_code_8572dbf0fa194a4ab0b2f4a2fa707c12-4"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="o"&gt;--------------&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_8572dbf0fa194a4ab0b2f4a2fa707c12-5" name="rest_code_8572dbf0fa194a4ab0b2f4a2fa707c12-5" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-29/#rest_code_8572dbf0fa194a4ab0b2f4a2fa707c12-5"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;minimum&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;     &lt;/span&gt;&lt;span class="mf"&gt;1.010&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ms&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;0.00&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;GC&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_8572dbf0fa194a4ab0b2f4a2fa707c12-6" name="rest_code_8572dbf0fa194a4ab0b2f4a2fa707c12-6" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-29/#rest_code_8572dbf0fa194a4ab0b2f4a2fa707c12-6"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;median&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="mf"&gt;1.136&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ms&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;0.00&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;GC&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_8572dbf0fa194a4ab0b2f4a2fa707c12-7" name="rest_code_8572dbf0fa194a4ab0b2f4a2fa707c12-7" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-29/#rest_code_8572dbf0fa194a4ab0b2f4a2fa707c12-7"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;mean&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="mf"&gt;1.370&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ms&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;17.85&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;GC&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_8572dbf0fa194a4ab0b2f4a2fa707c12-8" name="rest_code_8572dbf0fa194a4ab0b2f4a2fa707c12-8" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-29/#rest_code_8572dbf0fa194a4ab0b2f4a2fa707c12-8"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;maximum&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;     &lt;/span&gt;&lt;span class="mf"&gt;4.652&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ms&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;40.37&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;GC&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_8572dbf0fa194a4ab0b2f4a2fa707c12-9" name="rest_code_8572dbf0fa194a4ab0b2f4a2fa707c12-9" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-29/#rest_code_8572dbf0fa194a4ab0b2f4a2fa707c12-9"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="o"&gt;--------------&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_8572dbf0fa194a4ab0b2f4a2fa707c12-10" name="rest_code_8572dbf0fa194a4ab0b2f4a2fa707c12-10" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-29/#rest_code_8572dbf0fa194a4ab0b2f4a2fa707c12-10"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;samples&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;          &lt;/span&gt;&lt;span class="mi"&gt;3637&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_8572dbf0fa194a4ab0b2f4a2fa707c12-11" name="rest_code_8572dbf0fa194a4ab0b2f4a2fa707c12-11" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-29/#rest_code_8572dbf0fa194a4ab0b2f4a2fa707c12-11"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;evals&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;sample&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;     &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;In this case, we can say that the Python code is roughly 10 times slower than
Julia code.&lt;/p&gt;
&lt;/section&gt;
&lt;/section&gt;</description><category>cholesky decomposition</category><category>julia</category><category>numerical methods</category><category>python</category><category>scientific computing</category><guid>https://nicoguaro.github.io/posts/numerical_challenge/numerical-29/</guid><pubDate>Mon, 30 Oct 2017 02:10:08 GMT</pubDate></item></channel></rss>