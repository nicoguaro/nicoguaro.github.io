<?xml version="1.0" encoding="utf-8"?>
<?xml-stylesheet type="text/xsl" href="../assets/xml/rss.xsl" media="all"?><rss version="2.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Nicolás' blog (Posts about boundary element method)</title><link>https://nicoguaro.github.io/</link><description></description><atom:link href="https://nicoguaro.github.io/categories/boundary-element-method.xml" rel="self" type="application/rss+xml"></atom:link><language>en</language><copyright>Contents © 2022 &lt;a href="mailto:nicoguarin@gmail.com"&gt;Nicolás Guarín-Zapata&lt;/a&gt; 
&lt;a rel="license" href="http://creativecommons.org/licenses/by/4.0/"&gt;
&lt;img alt="Creative Commons License"
style="border-width:0"
src="https://i.creativecommons.org/l/by/4.0/88x31.png"&gt;&lt;/a&gt;</copyright><lastBuildDate>Wed, 02 Nov 2022 13:30:46 GMT</lastBuildDate><generator>Nikola (getnikola.com)</generator><docs>http://blogs.law.harvard.edu/tech/rss</docs><item><title>Coming back to the Boundary element method</title><link>https://nicoguaro.github.io/posts/bem_corrected/</link><dc:creator>Nicolás Guarín-Zapata</dc:creator><description>&lt;p&gt;During October (2017) I wrote a program per day for some well-known numerical
methods in both Python and Julia. It was intended to be an exercise to learn
some Julia. You can see a &lt;a class="reference external" href="https://nicoguaro.github.io/posts/numerical_summary"&gt;summary here&lt;/a&gt;. I succeeded
in 30 of the challenges, except for the BEM
(&lt;a class="reference external" href="https://en.wikipedia.org/wiki/Boundary_element_method"&gt;Boundary Element Method&lt;/a&gt;),
where I could not figure out what was wrong that day. The original
post is &lt;a class="reference external" href="https://nicoguaro.github.io/posts/numerical-26"&gt;here&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Thomas Klimpel found the mistake and wrote an email where he described my
mistakes. So, I am creating a new post with a correct implementation
of the BEM.&lt;/p&gt;
&lt;section id="the-boundary-element-method"&gt;
&lt;h2&gt;The Boundary Element Method&lt;/h2&gt;
&lt;p&gt;We want so solve the equation&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
\nabla^2 u = -f(x, y)\quad \forall (x, y) \in \Omega\, ,
\end{equation*}
&lt;/div&gt;
&lt;p&gt;with&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
u(x) = g(x, y), \quad \forall (x, y)\in \partial \Omega \, .
\end{equation*}
&lt;/div&gt;
&lt;p&gt;For this method, we need to use an integral representation of the equation,
that, in this case, is&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
u(\boldsymbol{\xi})  = \int_{S} [u(\mathbf{x}) F(\mathbf{x}, \boldsymbol{\xi})
    - q(\mathbf{x})G(\mathbf{x}, \boldsymbol{\xi})]\mathrm{d}S(\mathbf{x})
    + \int_{V} f(\mathbf{x}) G(\mathbf{x}, \boldsymbol{\xi}) \mathrm{d}V(\mathbf{x})
\end{equation*}
&lt;/div&gt;
&lt;p&gt;with&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
G(\mathbf{x}, \boldsymbol{\xi})= -\frac{1}{2\pi}\ln|\mathbf{x} - \xi|
\end{equation*}
&lt;/div&gt;
&lt;p&gt;and&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
F(\mathbf{x}, \boldsymbol{\xi}) =
  -\frac{1}{2\pi |\mathbf{x} - \boldsymbol{\xi}|^2}
  (\mathbf{x} - \boldsymbol{\xi})\cdot\hat{\mathbf{n}}
\end{equation*}
&lt;/div&gt;
&lt;p&gt;Then, we can form a system of equations&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
[G]\{q\} = [F]\{u\}\, ,
\end{equation*}
&lt;/div&gt;
&lt;p&gt;that we obtain by discretization of the boundary. If we take constant
variables over the discretization, the integral can be computed analytically
by&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
G_{nm} = -\frac{1}{2\pi}\left[r \sin\theta\left(\ln|r| - 1\right)
         + \theta r\cos\theta\right]^{\theta_B, r_B}_{\theta_A, r_A}
\end{equation*}
&lt;/div&gt;
&lt;p&gt;and&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
F_{nm} = \left[\frac{\theta}{2\pi}\right]^{\theta_B}_{\theta_A}
\end{equation*}
&lt;/div&gt;
&lt;p&gt;for points &lt;span class="math"&gt;\(n\)&lt;/span&gt; and &lt;span class="math"&gt;\(m\)&lt;/span&gt; in different elements, and the subindices
&lt;span class="math"&gt;\(A,B\)&lt;/span&gt; refer to the endpoints of the evaluation element. We should be
careful evaluating this expression since both &lt;span class="math"&gt;\(r_A\)&lt;/span&gt; and &lt;span class="math"&gt;\(r_B\)&lt;/span&gt; can
be (close to) zero and make it &lt;em&gt;explode&lt;/em&gt;. Also, here it was the main problem
since I forgot to compute the angles with respect to elements that are,
in general, not aligned with horizontal or vertical axes.&lt;/p&gt;
&lt;p&gt;For diagonal terms the integrals evaluate to&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
G_{nn} = -\frac{L}{2\pi}\left(\ln\left\vert\frac{L}{2}\right\vert - 1\right)
\end{equation*}
&lt;/div&gt;
&lt;p&gt;and&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
F_{nn} = - \frac{1}{2}
\end{equation*}
&lt;/div&gt;
&lt;p&gt;with &lt;span class="math"&gt;\(L\)&lt;/span&gt; the size of the element.&lt;/p&gt;
&lt;p&gt;Following is the code. Keep in mind that this code works for purely Dirichlet
problems. For mixed Dirichlet-Neumann the influence matrices would need
rearranging to separate known and unknowns in opposite sides of the equation.&lt;/p&gt;
&lt;p&gt;You can download the files for this &lt;a class="reference external" href="https://nicoguaro.github.io/downloads/bem.zip"&gt;project here&lt;/a&gt;.
It includes a YML file to create a conda environment with the dependencies
listed. For example, it uses version 3.0 of
&lt;a class="reference external" href="https://github.com/nschloe/meshio"&gt;Meshio&lt;/a&gt;.&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code python"&gt;&lt;a id="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-1" name="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-1" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-1"&gt;&lt;/a&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;numpy&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;np&lt;/span&gt;
&lt;a id="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-2" name="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-2" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-2"&gt;&lt;/a&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;numpy&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;log&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;arctan2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;pi&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;mean&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;arctan&lt;/span&gt;
&lt;a id="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-3" name="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-3" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-3"&gt;&lt;/a&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;numpy.linalg&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;norm&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;solve&lt;/span&gt;
&lt;a id="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-4" name="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-4" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-4"&gt;&lt;/a&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;matplotlib.pyplot&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;plt&lt;/span&gt;
&lt;a id="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-5" name="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-5" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-5"&gt;&lt;/a&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;mpl_toolkits.mplot3d&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;Axes3D&lt;/span&gt;
&lt;a id="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-6" name="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-6" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-6"&gt;&lt;/a&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;meshio&lt;/span&gt;
&lt;a id="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-7" name="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-7" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-7"&gt;&lt;/a&gt;
&lt;a id="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-8" name="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-8" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-8"&gt;&lt;/a&gt;
&lt;a id="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-9" name="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-9" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-9"&gt;&lt;/a&gt;  &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;assem&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;elems&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-10" name="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-10" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-10"&gt;&lt;/a&gt;      &lt;span class="sd"&gt;"""Assembly matrices for the BEM problem&lt;/span&gt;
&lt;a id="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-11" name="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-11" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-11"&gt;&lt;/a&gt;
&lt;a id="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-12" name="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-12" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-12"&gt;&lt;/a&gt;&lt;span class="sd"&gt;      Parameters&lt;/span&gt;
&lt;a id="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-13" name="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-13" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-13"&gt;&lt;/a&gt;&lt;span class="sd"&gt;      ----------&lt;/span&gt;
&lt;a id="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-14" name="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-14" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-14"&gt;&lt;/a&gt;&lt;span class="sd"&gt;      coords : ndarray, float&lt;/span&gt;
&lt;a id="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-15" name="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-15" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-15"&gt;&lt;/a&gt;&lt;span class="sd"&gt;          Coordinates for the nodes.&lt;/span&gt;
&lt;a id="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-16" name="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-16" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-16"&gt;&lt;/a&gt;&lt;span class="sd"&gt;      elems : ndarray, int&lt;/span&gt;
&lt;a id="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-17" name="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-17" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-17"&gt;&lt;/a&gt;&lt;span class="sd"&gt;          Connectivity for the elements.&lt;/span&gt;
&lt;a id="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-18" name="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-18" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-18"&gt;&lt;/a&gt;
&lt;a id="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-19" name="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-19" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-19"&gt;&lt;/a&gt;&lt;span class="sd"&gt;      Returns&lt;/span&gt;
&lt;a id="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-20" name="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-20" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-20"&gt;&lt;/a&gt;&lt;span class="sd"&gt;      -------&lt;/span&gt;
&lt;a id="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-21" name="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-21" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-21"&gt;&lt;/a&gt;&lt;span class="sd"&gt;      Gmat : ndarray, float&lt;/span&gt;
&lt;a id="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-22" name="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-22" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-22"&gt;&lt;/a&gt;&lt;span class="sd"&gt;          Influence matrix for the flow.&lt;/span&gt;
&lt;a id="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-23" name="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-23" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-23"&gt;&lt;/a&gt;&lt;span class="sd"&gt;      Fmat : ndarray, float&lt;/span&gt;
&lt;a id="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-24" name="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-24" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-24"&gt;&lt;/a&gt;&lt;span class="sd"&gt;          Influence matrix for primary variable.&lt;/span&gt;
&lt;a id="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-25" name="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-25" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-25"&gt;&lt;/a&gt;&lt;span class="sd"&gt;      """&lt;/span&gt;
&lt;a id="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-26" name="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-26" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-26"&gt;&lt;/a&gt;      &lt;span class="n"&gt;nelems&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;elems&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;shape&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-27" name="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-27" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-27"&gt;&lt;/a&gt;      &lt;span class="n"&gt;Gmat&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="n"&gt;nelems&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;nelems&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-28" name="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-28" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-28"&gt;&lt;/a&gt;      &lt;span class="n"&gt;Fmat&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="n"&gt;nelems&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;nelems&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-29" name="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-29" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-29"&gt;&lt;/a&gt;      &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;ev_cont&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;elem1&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;enumerate&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;elems&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-30" name="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-30" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-30"&gt;&lt;/a&gt;          &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;col_cont&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;elem2&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;enumerate&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;elems&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-31" name="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-31" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-31"&gt;&lt;/a&gt;              &lt;span class="n"&gt;pt_col&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;mean&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;elem2&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;axis&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-32" name="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-32" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-32"&gt;&lt;/a&gt;              &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;ev_cont&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="n"&gt;col_cont&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a id="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-33" name="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-33" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-33"&gt;&lt;/a&gt;                  &lt;span class="n"&gt;L&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;norm&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;elem1&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]]&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;elem1&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]])&lt;/span&gt;
&lt;a id="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-34" name="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-34" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-34"&gt;&lt;/a&gt;                  &lt;span class="n"&gt;Gmat&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ev_cont&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;ev_cont&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;L&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;pi&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;log&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;L&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-35" name="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-35" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-35"&gt;&lt;/a&gt;                  &lt;span class="n"&gt;Fmat&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ev_cont&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;ev_cont&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="mf"&gt;0.5&lt;/span&gt;
&lt;a id="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-36" name="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-36" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-36"&gt;&lt;/a&gt;              &lt;span class="k"&gt;else&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a id="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-37" name="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-37" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-37"&gt;&lt;/a&gt;                  &lt;span class="n"&gt;Gij&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;Fij&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;influence_coeff&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;elem1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;pt_col&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-38" name="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-38" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-38"&gt;&lt;/a&gt;                  &lt;span class="n"&gt;Gmat&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ev_cont&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;col_cont&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Gij&lt;/span&gt;
&lt;a id="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-39" name="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-39" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-39"&gt;&lt;/a&gt;                  &lt;span class="n"&gt;Fmat&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ev_cont&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;col_cont&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Fij&lt;/span&gt;
&lt;a id="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-40" name="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-40" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-40"&gt;&lt;/a&gt;      &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;Gmat&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;Fmat&lt;/span&gt;
&lt;a id="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-41" name="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-41" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-41"&gt;&lt;/a&gt;
&lt;a id="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-42" name="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-42" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-42"&gt;&lt;/a&gt;
&lt;a id="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-43" name="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-43" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-43"&gt;&lt;/a&gt;  &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;influence_coeff&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;elem&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;pt_col&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-44" name="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-44" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-44"&gt;&lt;/a&gt;      &lt;span class="sd"&gt;"""Compute influence coefficients&lt;/span&gt;
&lt;a id="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-45" name="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-45" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-45"&gt;&lt;/a&gt;
&lt;a id="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-46" name="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-46" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-46"&gt;&lt;/a&gt;&lt;span class="sd"&gt;      Parameters&lt;/span&gt;
&lt;a id="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-47" name="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-47" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-47"&gt;&lt;/a&gt;&lt;span class="sd"&gt;      ----------&lt;/span&gt;
&lt;a id="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-48" name="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-48" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-48"&gt;&lt;/a&gt;&lt;span class="sd"&gt;      elems : ndarray, int&lt;/span&gt;
&lt;a id="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-49" name="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-49" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-49"&gt;&lt;/a&gt;&lt;span class="sd"&gt;          Connectivity for the elements.&lt;/span&gt;
&lt;a id="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-50" name="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-50" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-50"&gt;&lt;/a&gt;&lt;span class="sd"&gt;      coords : ndarray, float&lt;/span&gt;
&lt;a id="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-51" name="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-51" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-51"&gt;&lt;/a&gt;&lt;span class="sd"&gt;          Coordinates for the nodes.&lt;/span&gt;
&lt;a id="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-52" name="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-52" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-52"&gt;&lt;/a&gt;&lt;span class="sd"&gt;      pt_col : ndarray&lt;/span&gt;
&lt;a id="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-53" name="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-53" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-53"&gt;&lt;/a&gt;&lt;span class="sd"&gt;          Coordinates of the colocation point.&lt;/span&gt;
&lt;a id="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-54" name="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-54" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-54"&gt;&lt;/a&gt;
&lt;a id="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-55" name="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-55" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-55"&gt;&lt;/a&gt;&lt;span class="sd"&gt;      Returns&lt;/span&gt;
&lt;a id="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-56" name="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-56" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-56"&gt;&lt;/a&gt;&lt;span class="sd"&gt;      -------&lt;/span&gt;
&lt;a id="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-57" name="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-57" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-57"&gt;&lt;/a&gt;&lt;span class="sd"&gt;      G_coeff : float&lt;/span&gt;
&lt;a id="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-58" name="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-58" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-58"&gt;&lt;/a&gt;&lt;span class="sd"&gt;          Influence coefficient for flows.&lt;/span&gt;
&lt;a id="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-59" name="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-59" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-59"&gt;&lt;/a&gt;&lt;span class="sd"&gt;      F_coeff : float&lt;/span&gt;
&lt;a id="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-60" name="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-60" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-60"&gt;&lt;/a&gt;&lt;span class="sd"&gt;          Influence coefficient for primary variable.&lt;/span&gt;
&lt;a id="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-61" name="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-61" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-61"&gt;&lt;/a&gt;&lt;span class="sd"&gt;      """&lt;/span&gt;
&lt;a id="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-62" name="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-62" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-62"&gt;&lt;/a&gt;      &lt;span class="n"&gt;dcos&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;elem&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]]&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;elem&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]]&lt;/span&gt;
&lt;a id="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-63" name="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-63" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-63"&gt;&lt;/a&gt;      &lt;span class="n"&gt;dcos&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;dcos&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="n"&gt;norm&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;dcos&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-64" name="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-64" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-64"&gt;&lt;/a&gt;      &lt;span class="n"&gt;rotmat&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;([[&lt;/span&gt;&lt;span class="n"&gt;dcos&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;dcos&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]],&lt;/span&gt;
&lt;a id="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-65" name="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-65" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-65"&gt;&lt;/a&gt;                      &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;dcos&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;dcos&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]]])&lt;/span&gt;
&lt;a id="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-66" name="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-66" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-66"&gt;&lt;/a&gt;      &lt;span class="n"&gt;r_A&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;rotmat&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;dot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;elem&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]]&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;pt_col&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-67" name="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-67" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-67"&gt;&lt;/a&gt;      &lt;span class="n"&gt;r_B&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;rotmat&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;dot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;elem&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]]&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;pt_col&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-68" name="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-68" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-68"&gt;&lt;/a&gt;      &lt;span class="n"&gt;theta_A&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;arctan2&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;r_A&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;r_A&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-69" name="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-69" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-69"&gt;&lt;/a&gt;      &lt;span class="n"&gt;theta_B&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;arctan2&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;r_B&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;r_B&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-70" name="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-70" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-70"&gt;&lt;/a&gt;      &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;norm&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;r_A&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="mf"&gt;1e-6&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a id="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-71" name="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-71" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-71"&gt;&lt;/a&gt;          &lt;span class="n"&gt;G_coeff&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;r_B&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;log&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;norm&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;r_B&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;theta_B&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;r_B&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-72" name="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-72" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-72"&gt;&lt;/a&gt;      &lt;span class="k"&gt;elif&lt;/span&gt; &lt;span class="n"&gt;norm&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;r_B&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="mf"&gt;1e-6&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a id="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-73" name="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-73" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-73"&gt;&lt;/a&gt;          &lt;span class="n"&gt;G_coeff&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;r_A&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;log&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;norm&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;r_A&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;theta_A&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;r_A&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-74" name="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-74" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-74"&gt;&lt;/a&gt;      &lt;span class="k"&gt;else&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a id="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-75" name="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-75" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-75"&gt;&lt;/a&gt;          &lt;span class="n"&gt;G_coeff&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;r_B&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;log&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;norm&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;r_B&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;theta_B&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;r_B&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;\
&lt;a id="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-76" name="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-76" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-76"&gt;&lt;/a&gt;                  &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;r_A&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;log&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;norm&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;r_A&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;theta_A&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;r_A&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-77" name="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-77" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-77"&gt;&lt;/a&gt;      &lt;span class="n"&gt;F_coeff&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;theta_B&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;theta_A&lt;/span&gt;
&lt;a id="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-78" name="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-78" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-78"&gt;&lt;/a&gt;      &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;G_coeff&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;pi&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;F_coeff&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;pi&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-79" name="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-79" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-79"&gt;&lt;/a&gt;
&lt;a id="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-80" name="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-80" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-80"&gt;&lt;/a&gt;
&lt;a id="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-81" name="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-81" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-81"&gt;&lt;/a&gt;  &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;eval_sol&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ev_coords&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;elems&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;u_boundary&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;q_boundary&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-82" name="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-82" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-82"&gt;&lt;/a&gt;      &lt;span class="sd"&gt;"""Evaluate the solution in a set of points&lt;/span&gt;
&lt;a id="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-83" name="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-83" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-83"&gt;&lt;/a&gt;
&lt;a id="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-84" name="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-84" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-84"&gt;&lt;/a&gt;&lt;span class="sd"&gt;      Parameters&lt;/span&gt;
&lt;a id="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-85" name="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-85" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-85"&gt;&lt;/a&gt;&lt;span class="sd"&gt;      ----------&lt;/span&gt;
&lt;a id="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-86" name="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-86" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-86"&gt;&lt;/a&gt;&lt;span class="sd"&gt;      ev_coords : ndarray, float&lt;/span&gt;
&lt;a id="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-87" name="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-87" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-87"&gt;&lt;/a&gt;&lt;span class="sd"&gt;          Coordinates of the evaluation points.&lt;/span&gt;
&lt;a id="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-88" name="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-88" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-88"&gt;&lt;/a&gt;&lt;span class="sd"&gt;      coords : ndarray, float&lt;/span&gt;
&lt;a id="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-89" name="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-89" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-89"&gt;&lt;/a&gt;&lt;span class="sd"&gt;          Coordinates for the nodes.&lt;/span&gt;
&lt;a id="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-90" name="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-90" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-90"&gt;&lt;/a&gt;&lt;span class="sd"&gt;      elems : ndarray, int&lt;/span&gt;
&lt;a id="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-91" name="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-91" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-91"&gt;&lt;/a&gt;&lt;span class="sd"&gt;          Connectivity for the elements.&lt;/span&gt;
&lt;a id="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-92" name="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-92" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-92"&gt;&lt;/a&gt;&lt;span class="sd"&gt;      u_boundary : ndarray, float&lt;/span&gt;
&lt;a id="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-93" name="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-93" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-93"&gt;&lt;/a&gt;&lt;span class="sd"&gt;          Primary variable in the nodes.&lt;/span&gt;
&lt;a id="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-94" name="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-94" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-94"&gt;&lt;/a&gt;&lt;span class="sd"&gt;      q_boundary : [type]&lt;/span&gt;
&lt;a id="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-95" name="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-95" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-95"&gt;&lt;/a&gt;&lt;span class="sd"&gt;          Flows in the nodes.&lt;/span&gt;
&lt;a id="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-96" name="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-96" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-96"&gt;&lt;/a&gt;
&lt;a id="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-97" name="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-97" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-97"&gt;&lt;/a&gt;&lt;span class="sd"&gt;      Returns&lt;/span&gt;
&lt;a id="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-98" name="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-98" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-98"&gt;&lt;/a&gt;&lt;span class="sd"&gt;      -------&lt;/span&gt;
&lt;a id="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-99" name="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-99" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-99"&gt;&lt;/a&gt;&lt;span class="sd"&gt;      solution : ndarray, float&lt;/span&gt;
&lt;a id="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-100" name="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-100" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-100"&gt;&lt;/a&gt;&lt;span class="sd"&gt;          Solution evaluated in the given points.&lt;/span&gt;
&lt;a id="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-101" name="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-101" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-101"&gt;&lt;/a&gt;&lt;span class="sd"&gt;      """&lt;/span&gt;
&lt;a id="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-102" name="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-102" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-102"&gt;&lt;/a&gt;      &lt;span class="n"&gt;npts&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;ev_coords&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;shape&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-103" name="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-103" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-103"&gt;&lt;/a&gt;      &lt;span class="n"&gt;solution&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;npts&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-104" name="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-104" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-104"&gt;&lt;/a&gt;      &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;k&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;npts&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-105" name="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-105" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-105"&gt;&lt;/a&gt;          &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;ev_cont&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;elem&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;enumerate&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;elems&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-106" name="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-106" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-106"&gt;&lt;/a&gt;              &lt;span class="n"&gt;pt_col&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;ev_coords&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;k&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-107" name="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-107" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-107"&gt;&lt;/a&gt;              &lt;span class="n"&gt;G&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;F&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;influence_coeff&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;elem&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;pt_col&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-108" name="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-108" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-108"&gt;&lt;/a&gt;              &lt;span class="n"&gt;solution&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;k&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;+=&lt;/span&gt; &lt;span class="n"&gt;u_boundary&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ev_cont&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;F&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;q_boundary&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ev_cont&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;G&lt;/span&gt;
&lt;a id="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-109" name="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-109" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-109"&gt;&lt;/a&gt;      &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;solution&lt;/span&gt;
&lt;a id="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-110" name="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-110" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-110"&gt;&lt;/a&gt;
&lt;a id="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-111" name="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-111" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-111"&gt;&lt;/a&gt;
&lt;a id="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-112" name="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-112" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-112"&gt;&lt;/a&gt;&lt;span class="c1"&gt;#%% Simulation&lt;/span&gt;
&lt;a id="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-113" name="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-113" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-113"&gt;&lt;/a&gt;&lt;span class="n"&gt;mesh&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;meshio&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;read&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"disk.msh"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-114" name="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-114" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-114"&gt;&lt;/a&gt;&lt;span class="n"&gt;elems&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;mesh&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;cells&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;"line"&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-115" name="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-115" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-115"&gt;&lt;/a&gt;&lt;span class="n"&gt;bound_nodes&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;list&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;set&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;elems&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;flatten&lt;/span&gt;&lt;span class="p"&gt;()))&lt;/span&gt;
&lt;a id="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-116" name="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-116" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-116"&gt;&lt;/a&gt;&lt;span class="n"&gt;coords&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;mesh&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;points&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;bound_nodes&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-117" name="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-117" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-117"&gt;&lt;/a&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;y&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;T&lt;/span&gt;
&lt;a id="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-118" name="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-118" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-118"&gt;&lt;/a&gt;&lt;span class="n"&gt;x_m&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;y_m&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;0.5&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;elems&lt;/span&gt;&lt;span class="p"&gt;[:,&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]]&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;elems&lt;/span&gt;&lt;span class="p"&gt;[:,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]])&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;T&lt;/span&gt;
&lt;a id="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-119" name="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-119" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-119"&gt;&lt;/a&gt;&lt;span class="n"&gt;theta&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;arctan2&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;y_m&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;x_m&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-120" name="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-120" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-120"&gt;&lt;/a&gt;&lt;span class="n"&gt;u_boundary&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;cos&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;6&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;theta&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-121" name="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-121" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-121"&gt;&lt;/a&gt;
&lt;a id="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-122" name="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-122" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-122"&gt;&lt;/a&gt;
&lt;a id="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-123" name="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-123" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-123"&gt;&lt;/a&gt;&lt;span class="c1"&gt;#%% Assembly&lt;/span&gt;
&lt;a id="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-124" name="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-124" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-124"&gt;&lt;/a&gt;&lt;span class="n"&gt;Gmat&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;Fmat&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;assem&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;elems&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-125" name="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-125" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-125"&gt;&lt;/a&gt;
&lt;a id="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-126" name="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-126" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-126"&gt;&lt;/a&gt;&lt;span class="c1"&gt;#%% Solution&lt;/span&gt;
&lt;a id="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-127" name="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-127" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-127"&gt;&lt;/a&gt;&lt;span class="n"&gt;q_boundary&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;solve&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Gmat&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;Fmat&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;dot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;u_boundary&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-128" name="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-128" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-128"&gt;&lt;/a&gt;
&lt;a id="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-129" name="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-129" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-129"&gt;&lt;/a&gt;&lt;span class="c1"&gt;#%% Evaluation&lt;/span&gt;
&lt;a id="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-130" name="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-130" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-130"&gt;&lt;/a&gt;&lt;span class="n"&gt;ev_coords&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt;  &lt;span class="n"&gt;mesh&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;points&lt;/span&gt;&lt;span class="p"&gt;[:,&lt;/span&gt; &lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-131" name="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-131" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-131"&gt;&lt;/a&gt;&lt;span class="n"&gt;ev_x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;ev_y&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;ev_coords&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;T&lt;/span&gt;
&lt;a id="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-132" name="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-132" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-132"&gt;&lt;/a&gt;&lt;span class="n"&gt;solution&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;eval_sol&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ev_coords&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;elems&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;u_boundary&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;q_boundary&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-133" name="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-133" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-133"&gt;&lt;/a&gt;
&lt;a id="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-134" name="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-134" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-134"&gt;&lt;/a&gt;&lt;span class="c1"&gt;#%% Visualization&lt;/span&gt;
&lt;a id="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-135" name="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-135" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-135"&gt;&lt;/a&gt;&lt;span class="n"&gt;tris&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;mesh&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;cells&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;"triangle"&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-136" name="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-136" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-136"&gt;&lt;/a&gt;&lt;span class="n"&gt;fig&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;figure&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a id="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-137" name="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-137" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-137"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;fig&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;add_subplot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;111&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;projection&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'3d'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-138" name="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-138" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-138"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;plot_trisurf&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ev_x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;ev_y&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;solution&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;cmap&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;"RdYlBu"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;lw&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mf"&gt;0.3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;a id="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-139" name="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-139" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-139"&gt;&lt;/a&gt;                &lt;span class="n"&gt;edgecolor&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;"#3c3c3c"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-140" name="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-140" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-140"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xticks&lt;/span&gt;&lt;span class="p"&gt;([])&lt;/span&gt;
&lt;a id="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-141" name="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-141" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-141"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;yticks&lt;/span&gt;&lt;span class="p"&gt;([])&lt;/span&gt;
&lt;a id="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-142" name="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-142" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-142"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_zticks&lt;/span&gt;&lt;span class="p"&gt;([])&lt;/span&gt;
&lt;a id="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-143" name="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-143" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-143"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;savefig&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"bem_solution.png"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;bbox_inches&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;"tight"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;transparent&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;True&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;a id="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-144" name="rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-144" href="https://nicoguaro.github.io/posts/bem_corrected/#rest_code_5f2ae17960aa4bc9ab50bbae4a3d0de7-144"&gt;&lt;/a&gt;            &lt;span class="n"&gt;dpi&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;300&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;The result in this case is the following.&lt;/p&gt;
&lt;img alt="Solution of the differential equation using the BEM." class="align-center" src="https://nicoguaro.github.io/images/bem_solution.png" style="width: 600px;"&gt;
&lt;/section&gt;</description><category>boundary element method</category><category>numerical methods</category><category>python</category><category>scientific computing</category><guid>https://nicoguaro.github.io/posts/bem_corrected/</guid><pubDate>Mon, 22 Feb 2021 15:00:00 GMT</pubDate></item><item><title>Numerical methods challenge: Day 26</title><link>https://nicoguaro.github.io/posts/numerical_challenge/numerical-26/</link><dc:creator>Nicolás Guarín-Zapata</dc:creator><description>&lt;p&gt;During October (2017) I will write a program per day for some well-known
numerical methods in both Python and Julia. It is intended to be an exercise
then don't expect the code to be good enough for real use. Also,
I should mention that I have almost no experience with Julia, so it
probably won't be idiomatic Julia but more Python-like Julia.&lt;/p&gt;
&lt;section id="boundary-element-method"&gt;
&lt;h2&gt;Boundary element method&lt;/h2&gt;
&lt;p&gt;Today we have the &lt;a class="reference external" href="https://en.wikipedia.org/wiki/Boundary_element_method"&gt;Boundary element method&lt;/a&gt;
, or, an attempt. We want so solve the equation&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
\nabla^2 u = -f(x)
\end{equation*}
&lt;/div&gt;
&lt;p&gt;with&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
u(x) = g(x),\quad \forall (x, y)\in \partial \Omega
\end{equation*}
&lt;/div&gt;
&lt;p&gt;For this method, we need to use an integral representation of the equation,
that in this case is&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
u(\xi)  = \int_{S} [u(x) F(x, \xi) - q(x)G(x, \xi)]dS(x) +
          \int_{V} f(x) G(x, \xi) dV(x)
\end{equation*}
&lt;/div&gt;
&lt;p&gt;with&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
G(x,\xi)= -\frac{1}{2\pi}\ln|x- \xi|
\end{equation*}
&lt;/div&gt;
&lt;p&gt;and&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
F(x,\xi) = -\frac{1}{2\pi |x- \xi|^2}(x - \xi)\cdot\hat{n}
\end{equation*}
&lt;/div&gt;
&lt;p&gt;Then, we can form a system of equations&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
[G]\{q\} = [F]\{u\}\, ,
\end{equation*}
&lt;/div&gt;
&lt;p&gt;that we obtain by discretization of the boundary. If we take constant
variables over the discretization, the integral can be computed analytically
by&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
G_{nm} = -\frac{1}{2\pi}\left[r \sin\theta\left(\ln|r| - 1\right)
         + \theta r\cos\theta\right]^{\theta_B, r_B}_{\theta_A, r_A}
\end{equation*}
&lt;/div&gt;
&lt;p&gt;and&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
F_{nm} = \left[\frac{\theta}{2\pi}\right]^{\theta_B}_{\theta_A}
\end{equation*}
&lt;/div&gt;
&lt;p&gt;for points &lt;span class="math"&gt;\(n\)&lt;/span&gt; and &lt;span class="math"&gt;\(m\)&lt;/span&gt; in different elements, and the subindices
&lt;span class="math"&gt;\(A,B\)&lt;/span&gt; refer to the endpoints of the evaluation element. For diagonal
terms the integrals evaluate to&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
G_{nn} = -\frac{L}{2\pi}\left(\ln\left\vert\frac{L}{2}\right\vert - 1\right)
\end{equation*}
&lt;/div&gt;
&lt;p&gt;and&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
F_{nn} = - \frac{1}{2\pi}
\end{equation*}
&lt;/div&gt;
&lt;p&gt;with &lt;span class="math"&gt;\(L\)&lt;/span&gt; the size of the element.&lt;/p&gt;
&lt;p&gt;Below is the Python code. In this case, I did not succeed and the
code is not working right now.&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code python"&gt;&lt;a id="rest_code_46e5c515a27d4a4599c1a7688ded911d-1" name="rest_code_46e5c515a27d4a4599c1a7688ded911d-1" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-26/#rest_code_46e5c515a27d4a4599c1a7688ded911d-1"&gt;&lt;/a&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;__future__&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;division&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;print_function&lt;/span&gt;
&lt;a id="rest_code_46e5c515a27d4a4599c1a7688ded911d-2" name="rest_code_46e5c515a27d4a4599c1a7688ded911d-2" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-26/#rest_code_46e5c515a27d4a4599c1a7688ded911d-2"&gt;&lt;/a&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;numpy&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;np&lt;/span&gt;
&lt;a id="rest_code_46e5c515a27d4a4599c1a7688ded911d-3" name="rest_code_46e5c515a27d4a4599c1a7688ded911d-3" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-26/#rest_code_46e5c515a27d4a4599c1a7688ded911d-3"&gt;&lt;/a&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;numpy&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;log&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;sin&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;cos&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;arctan2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;pi&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;mean&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;arctan&lt;/span&gt;
&lt;a id="rest_code_46e5c515a27d4a4599c1a7688ded911d-4" name="rest_code_46e5c515a27d4a4599c1a7688ded911d-4" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-26/#rest_code_46e5c515a27d4a4599c1a7688ded911d-4"&gt;&lt;/a&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;numpy.linalg&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;norm&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;solve&lt;/span&gt;
&lt;a id="rest_code_46e5c515a27d4a4599c1a7688ded911d-5" name="rest_code_46e5c515a27d4a4599c1a7688ded911d-5" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-26/#rest_code_46e5c515a27d4a4599c1a7688ded911d-5"&gt;&lt;/a&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;matplotlib.pyplot&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;plt&lt;/span&gt;
&lt;a id="rest_code_46e5c515a27d4a4599c1a7688ded911d-6" name="rest_code_46e5c515a27d4a4599c1a7688ded911d-6" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-26/#rest_code_46e5c515a27d4a4599c1a7688ded911d-6"&gt;&lt;/a&gt;
&lt;a id="rest_code_46e5c515a27d4a4599c1a7688ded911d-7" name="rest_code_46e5c515a27d4a4599c1a7688ded911d-7" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-26/#rest_code_46e5c515a27d4a4599c1a7688ded911d-7"&gt;&lt;/a&gt;
&lt;a id="rest_code_46e5c515a27d4a4599c1a7688ded911d-8" name="rest_code_46e5c515a27d4a4599c1a7688ded911d-8" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-26/#rest_code_46e5c515a27d4a4599c1a7688ded911d-8"&gt;&lt;/a&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;assem&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;elems&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_46e5c515a27d4a4599c1a7688ded911d-9" name="rest_code_46e5c515a27d4a4599c1a7688ded911d-9" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-26/#rest_code_46e5c515a27d4a4599c1a7688ded911d-9"&gt;&lt;/a&gt;    &lt;span class="n"&gt;nelems&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;elems&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;shape&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_46e5c515a27d4a4599c1a7688ded911d-10" name="rest_code_46e5c515a27d4a4599c1a7688ded911d-10" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-26/#rest_code_46e5c515a27d4a4599c1a7688ded911d-10"&gt;&lt;/a&gt;    &lt;span class="n"&gt;Gmat&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="n"&gt;nelems&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;nelems&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_46e5c515a27d4a4599c1a7688ded911d-11" name="rest_code_46e5c515a27d4a4599c1a7688ded911d-11" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-26/#rest_code_46e5c515a27d4a4599c1a7688ded911d-11"&gt;&lt;/a&gt;    &lt;span class="n"&gt;Fmat&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="n"&gt;nelems&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;nelems&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_46e5c515a27d4a4599c1a7688ded911d-12" name="rest_code_46e5c515a27d4a4599c1a7688ded911d-12" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-26/#rest_code_46e5c515a27d4a4599c1a7688ded911d-12"&gt;&lt;/a&gt;    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;ev_cont&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;elem1&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;enumerate&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;elems&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_46e5c515a27d4a4599c1a7688ded911d-13" name="rest_code_46e5c515a27d4a4599c1a7688ded911d-13" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-26/#rest_code_46e5c515a27d4a4599c1a7688ded911d-13"&gt;&lt;/a&gt;        &lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;elem1&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]],&lt;/span&gt; &lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;elem1&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]])&lt;/span&gt;
&lt;a id="rest_code_46e5c515a27d4a4599c1a7688ded911d-14" name="rest_code_46e5c515a27d4a4599c1a7688ded911d-14" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-26/#rest_code_46e5c515a27d4a4599c1a7688ded911d-14"&gt;&lt;/a&gt;        &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;col_cont&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;elem2&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;enumerate&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;elems&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_46e5c515a27d4a4599c1a7688ded911d-15" name="rest_code_46e5c515a27d4a4599c1a7688ded911d-15" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-26/#rest_code_46e5c515a27d4a4599c1a7688ded911d-15"&gt;&lt;/a&gt;            &lt;span class="n"&gt;pt_col&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;mean&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;elem2&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;axis&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_46e5c515a27d4a4599c1a7688ded911d-16" name="rest_code_46e5c515a27d4a4599c1a7688ded911d-16" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-26/#rest_code_46e5c515a27d4a4599c1a7688ded911d-16"&gt;&lt;/a&gt;            &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;ev_cont&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="n"&gt;col_cont&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a id="rest_code_46e5c515a27d4a4599c1a7688ded911d-17" name="rest_code_46e5c515a27d4a4599c1a7688ded911d-17" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-26/#rest_code_46e5c515a27d4a4599c1a7688ded911d-17"&gt;&lt;/a&gt;                &lt;span class="n"&gt;L&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;norm&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;elem1&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]]&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;elem1&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]])&lt;/span&gt;
&lt;a id="rest_code_46e5c515a27d4a4599c1a7688ded911d-18" name="rest_code_46e5c515a27d4a4599c1a7688ded911d-18" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-26/#rest_code_46e5c515a27d4a4599c1a7688ded911d-18"&gt;&lt;/a&gt;                &lt;span class="n"&gt;Gmat&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ev_cont&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;ev_cont&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;L&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;pi&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;log&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;L&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_46e5c515a27d4a4599c1a7688ded911d-19" name="rest_code_46e5c515a27d4a4599c1a7688ded911d-19" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-26/#rest_code_46e5c515a27d4a4599c1a7688ded911d-19"&gt;&lt;/a&gt;                &lt;span class="n"&gt;Fmat&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ev_cont&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;ev_cont&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="mf"&gt;0.5&lt;/span&gt;
&lt;a id="rest_code_46e5c515a27d4a4599c1a7688ded911d-20" name="rest_code_46e5c515a27d4a4599c1a7688ded911d-20" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-26/#rest_code_46e5c515a27d4a4599c1a7688ded911d-20"&gt;&lt;/a&gt;            &lt;span class="k"&gt;else&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a id="rest_code_46e5c515a27d4a4599c1a7688ded911d-21" name="rest_code_46e5c515a27d4a4599c1a7688ded911d-21" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-26/#rest_code_46e5c515a27d4a4599c1a7688ded911d-21"&gt;&lt;/a&gt;                &lt;span class="n"&gt;Gij&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;Fij&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;influence_coeff&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;elem1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;pt_col&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_46e5c515a27d4a4599c1a7688ded911d-22" name="rest_code_46e5c515a27d4a4599c1a7688ded911d-22" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-26/#rest_code_46e5c515a27d4a4599c1a7688ded911d-22"&gt;&lt;/a&gt;                &lt;span class="n"&gt;Gmat&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ev_cont&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;col_cont&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Gij&lt;/span&gt;
&lt;a id="rest_code_46e5c515a27d4a4599c1a7688ded911d-23" name="rest_code_46e5c515a27d4a4599c1a7688ded911d-23" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-26/#rest_code_46e5c515a27d4a4599c1a7688ded911d-23"&gt;&lt;/a&gt;                &lt;span class="n"&gt;Fmat&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ev_cont&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;col_cont&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Fij&lt;/span&gt;
&lt;a id="rest_code_46e5c515a27d4a4599c1a7688ded911d-24" name="rest_code_46e5c515a27d4a4599c1a7688ded911d-24" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-26/#rest_code_46e5c515a27d4a4599c1a7688ded911d-24"&gt;&lt;/a&gt;    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;Gmat&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;Fmat&lt;/span&gt;
&lt;a id="rest_code_46e5c515a27d4a4599c1a7688ded911d-25" name="rest_code_46e5c515a27d4a4599c1a7688ded911d-25" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-26/#rest_code_46e5c515a27d4a4599c1a7688ded911d-25"&gt;&lt;/a&gt;
&lt;a id="rest_code_46e5c515a27d4a4599c1a7688ded911d-26" name="rest_code_46e5c515a27d4a4599c1a7688ded911d-26" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-26/#rest_code_46e5c515a27d4a4599c1a7688ded911d-26"&gt;&lt;/a&gt;
&lt;a id="rest_code_46e5c515a27d4a4599c1a7688ded911d-27" name="rest_code_46e5c515a27d4a4599c1a7688ded911d-27" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-26/#rest_code_46e5c515a27d4a4599c1a7688ded911d-27"&gt;&lt;/a&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;influence_coeff&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;elem&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;pt_col&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_46e5c515a27d4a4599c1a7688ded911d-28" name="rest_code_46e5c515a27d4a4599c1a7688ded911d-28" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-26/#rest_code_46e5c515a27d4a4599c1a7688ded911d-28"&gt;&lt;/a&gt;    &lt;span class="n"&gt;r_A&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;elem&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]]&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;pt_col&lt;/span&gt;
&lt;a id="rest_code_46e5c515a27d4a4599c1a7688ded911d-29" name="rest_code_46e5c515a27d4a4599c1a7688ded911d-29" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-26/#rest_code_46e5c515a27d4a4599c1a7688ded911d-29"&gt;&lt;/a&gt;    &lt;span class="n"&gt;r_B&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;elem&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]]&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;pt_col&lt;/span&gt;
&lt;a id="rest_code_46e5c515a27d4a4599c1a7688ded911d-30" name="rest_code_46e5c515a27d4a4599c1a7688ded911d-30" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-26/#rest_code_46e5c515a27d4a4599c1a7688ded911d-30"&gt;&lt;/a&gt;    &lt;span class="n"&gt;theta_A&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;arctan2&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;r_A&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;r_A&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_46e5c515a27d4a4599c1a7688ded911d-31" name="rest_code_46e5c515a27d4a4599c1a7688ded911d-31" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-26/#rest_code_46e5c515a27d4a4599c1a7688ded911d-31"&gt;&lt;/a&gt;    &lt;span class="n"&gt;theta_B&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;arctan2&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;r_B&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;r_B&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_46e5c515a27d4a4599c1a7688ded911d-32" name="rest_code_46e5c515a27d4a4599c1a7688ded911d-32" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-26/#rest_code_46e5c515a27d4a4599c1a7688ded911d-32"&gt;&lt;/a&gt;    &lt;span class="n"&gt;G_coeff&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;r_B&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;log&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;norm&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;r_B&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;theta_B&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;r_B&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;\
&lt;a id="rest_code_46e5c515a27d4a4599c1a7688ded911d-33" name="rest_code_46e5c515a27d4a4599c1a7688ded911d-33" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-26/#rest_code_46e5c515a27d4a4599c1a7688ded911d-33"&gt;&lt;/a&gt;              &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;r_A&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;log&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;norm&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;r_A&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;theta_A&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;r_A&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_46e5c515a27d4a4599c1a7688ded911d-34" name="rest_code_46e5c515a27d4a4599c1a7688ded911d-34" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-26/#rest_code_46e5c515a27d4a4599c1a7688ded911d-34"&gt;&lt;/a&gt;    &lt;span class="n"&gt;F_coeff&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;theta_B&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;theta_A&lt;/span&gt;
&lt;a id="rest_code_46e5c515a27d4a4599c1a7688ded911d-35" name="rest_code_46e5c515a27d4a4599c1a7688ded911d-35" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-26/#rest_code_46e5c515a27d4a4599c1a7688ded911d-35"&gt;&lt;/a&gt;    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;G_coeff&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;pi&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;F_coeff&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;pi&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_46e5c515a27d4a4599c1a7688ded911d-36" name="rest_code_46e5c515a27d4a4599c1a7688ded911d-36" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-26/#rest_code_46e5c515a27d4a4599c1a7688ded911d-36"&gt;&lt;/a&gt;
&lt;a id="rest_code_46e5c515a27d4a4599c1a7688ded911d-37" name="rest_code_46e5c515a27d4a4599c1a7688ded911d-37" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-26/#rest_code_46e5c515a27d4a4599c1a7688ded911d-37"&gt;&lt;/a&gt;
&lt;a id="rest_code_46e5c515a27d4a4599c1a7688ded911d-38" name="rest_code_46e5c515a27d4a4599c1a7688ded911d-38" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-26/#rest_code_46e5c515a27d4a4599c1a7688ded911d-38"&gt;&lt;/a&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;eval_sol&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ev_coords&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_46e5c515a27d4a4599c1a7688ded911d-39" name="rest_code_46e5c515a27d4a4599c1a7688ded911d-39" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-26/#rest_code_46e5c515a27d4a4599c1a7688ded911d-39"&gt;&lt;/a&gt;    &lt;span class="n"&gt;nelems&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;elems&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;shape&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_46e5c515a27d4a4599c1a7688ded911d-40" name="rest_code_46e5c515a27d4a4599c1a7688ded911d-40" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-26/#rest_code_46e5c515a27d4a4599c1a7688ded911d-40"&gt;&lt;/a&gt;    &lt;span class="n"&gt;Gmat&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="n"&gt;nelems&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;nelems&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_46e5c515a27d4a4599c1a7688ded911d-41" name="rest_code_46e5c515a27d4a4599c1a7688ded911d-41" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-26/#rest_code_46e5c515a27d4a4599c1a7688ded911d-41"&gt;&lt;/a&gt;    &lt;span class="n"&gt;Fmat&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="n"&gt;nelems&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;nelems&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_46e5c515a27d4a4599c1a7688ded911d-42" name="rest_code_46e5c515a27d4a4599c1a7688ded911d-42" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-26/#rest_code_46e5c515a27d4a4599c1a7688ded911d-42"&gt;&lt;/a&gt;    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;ev_cont&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;elem1&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;enumerate&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;elems&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_46e5c515a27d4a4599c1a7688ded911d-43" name="rest_code_46e5c515a27d4a4599c1a7688ded911d-43" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-26/#rest_code_46e5c515a27d4a4599c1a7688ded911d-43"&gt;&lt;/a&gt;        &lt;span class="n"&gt;L&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;norm&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;elem1&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]]&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;elem1&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]])&lt;/span&gt;
&lt;a id="rest_code_46e5c515a27d4a4599c1a7688ded911d-44" name="rest_code_46e5c515a27d4a4599c1a7688ded911d-44" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-26/#rest_code_46e5c515a27d4a4599c1a7688ded911d-44"&gt;&lt;/a&gt;        &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;col_cont&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;elem2&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;enumerate&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;elems&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_46e5c515a27d4a4599c1a7688ded911d-45" name="rest_code_46e5c515a27d4a4599c1a7688ded911d-45" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-26/#rest_code_46e5c515a27d4a4599c1a7688ded911d-45"&gt;&lt;/a&gt;            &lt;span class="n"&gt;pt_col&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;mean&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;elem2&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;axis&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_46e5c515a27d4a4599c1a7688ded911d-46" name="rest_code_46e5c515a27d4a4599c1a7688ded911d-46" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-26/#rest_code_46e5c515a27d4a4599c1a7688ded911d-46"&gt;&lt;/a&gt;            &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;ev_cont&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="n"&gt;col_cont&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a id="rest_code_46e5c515a27d4a4599c1a7688ded911d-47" name="rest_code_46e5c515a27d4a4599c1a7688ded911d-47" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-26/#rest_code_46e5c515a27d4a4599c1a7688ded911d-47"&gt;&lt;/a&gt;                &lt;span class="n"&gt;Gmat&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ev_cont&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;ev_cont&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;L&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;pi&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;log&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;L&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_46e5c515a27d4a4599c1a7688ded911d-48" name="rest_code_46e5c515a27d4a4599c1a7688ded911d-48" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-26/#rest_code_46e5c515a27d4a4599c1a7688ded911d-48"&gt;&lt;/a&gt;                &lt;span class="n"&gt;Fmat&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ev_cont&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;ev_cont&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="mf"&gt;0.5&lt;/span&gt;
&lt;a id="rest_code_46e5c515a27d4a4599c1a7688ded911d-49" name="rest_code_46e5c515a27d4a4599c1a7688ded911d-49" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-26/#rest_code_46e5c515a27d4a4599c1a7688ded911d-49"&gt;&lt;/a&gt;            &lt;span class="k"&gt;else&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a id="rest_code_46e5c515a27d4a4599c1a7688ded911d-50" name="rest_code_46e5c515a27d4a4599c1a7688ded911d-50" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-26/#rest_code_46e5c515a27d4a4599c1a7688ded911d-50"&gt;&lt;/a&gt;                &lt;span class="n"&gt;Gmat&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ev_cont&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;col_cont&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;Fmat&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ev_cont&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;col_cont&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; \
&lt;a id="rest_code_46e5c515a27d4a4599c1a7688ded911d-51" name="rest_code_46e5c515a27d4a4599c1a7688ded911d-51" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-26/#rest_code_46e5c515a27d4a4599c1a7688ded911d-51"&gt;&lt;/a&gt;                    &lt;span class="n"&gt;influence_coeff&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;elem1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;pt_col&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_46e5c515a27d4a4599c1a7688ded911d-52" name="rest_code_46e5c515a27d4a4599c1a7688ded911d-52" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-26/#rest_code_46e5c515a27d4a4599c1a7688ded911d-52"&gt;&lt;/a&gt;
&lt;a id="rest_code_46e5c515a27d4a4599c1a7688ded911d-53" name="rest_code_46e5c515a27d4a4599c1a7688ded911d-53" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-26/#rest_code_46e5c515a27d4a4599c1a7688ded911d-53"&gt;&lt;/a&gt;&lt;span class="n"&gt;nelems&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt;
&lt;a id="rest_code_46e5c515a27d4a4599c1a7688ded911d-54" name="rest_code_46e5c515a27d4a4599c1a7688ded911d-54" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-26/#rest_code_46e5c515a27d4a4599c1a7688ded911d-54"&gt;&lt;/a&gt;&lt;span class="n"&gt;rad&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;1.0&lt;/span&gt;
&lt;a id="rest_code_46e5c515a27d4a4599c1a7688ded911d-55" name="rest_code_46e5c515a27d4a4599c1a7688ded911d-55" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-26/#rest_code_46e5c515a27d4a4599c1a7688ded911d-55"&gt;&lt;/a&gt;&lt;span class="n"&gt;theta&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt;  &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;linspace&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;pi&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;nelems&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;endpoint&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;False&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_46e5c515a27d4a4599c1a7688ded911d-56" name="rest_code_46e5c515a27d4a4599c1a7688ded911d-56" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-26/#rest_code_46e5c515a27d4a4599c1a7688ded911d-56"&gt;&lt;/a&gt;&lt;span class="n"&gt;coords&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;rad&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;vstack&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="n"&gt;cos&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;theta&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;sin&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;theta&lt;/span&gt;&lt;span class="p"&gt;)))&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;T&lt;/span&gt;
&lt;a id="rest_code_46e5c515a27d4a4599c1a7688ded911d-57" name="rest_code_46e5c515a27d4a4599c1a7688ded911d-57" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-26/#rest_code_46e5c515a27d4a4599c1a7688ded911d-57"&gt;&lt;/a&gt;&lt;span class="n"&gt;elems&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;([[&lt;/span&gt;&lt;span class="n"&gt;cont&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;cont&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="n"&gt;nelems&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;cont&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;nelems&lt;/span&gt;&lt;span class="p"&gt;)])&lt;/span&gt;
&lt;a id="rest_code_46e5c515a27d4a4599c1a7688ded911d-58" name="rest_code_46e5c515a27d4a4599c1a7688ded911d-58" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-26/#rest_code_46e5c515a27d4a4599c1a7688ded911d-58"&gt;&lt;/a&gt;&lt;span class="n"&gt;Gmat&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;Fmat&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;assem&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;elems&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_46e5c515a27d4a4599c1a7688ded911d-59" name="rest_code_46e5c515a27d4a4599c1a7688ded911d-59" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-26/#rest_code_46e5c515a27d4a4599c1a7688ded911d-59"&gt;&lt;/a&gt;&lt;span class="n"&gt;u_boundary&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ones_like&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;theta&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_46e5c515a27d4a4599c1a7688ded911d-60" name="rest_code_46e5c515a27d4a4599c1a7688ded911d-60" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-26/#rest_code_46e5c515a27d4a4599c1a7688ded911d-60"&gt;&lt;/a&gt;&lt;span class="n"&gt;q_boundary&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;solve&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Gmat&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;Fmat&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;dot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;u_boundary&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/section&gt;</description><category>boundary element method</category><category>julia</category><category>numerical methods</category><category>python</category><category>scientific computing</category><guid>https://nicoguaro.github.io/posts/numerical_challenge/numerical-26/</guid><pubDate>Fri, 27 Oct 2017 00:15:08 GMT</pubDate></item></channel></rss>