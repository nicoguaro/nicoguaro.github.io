<?xml version="1.0" encoding="utf-8"?>
<?xml-stylesheet type="text/xsl" href="../assets/xml/rss.xsl" media="all"?><rss version="2.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Nicolás' blog (Posts about julia)</title><link>https://nicoguaro.github.io/</link><description></description><atom:link href="https://nicoguaro.github.io/categories/julia.xml" rel="self" type="application/rss+xml"></atom:link><language>en</language><copyright>Contents © 2022 &lt;a href="mailto:nicoguarin@gmail.com"&gt;Nicolás Guarín-Zapata&lt;/a&gt; 
&lt;a rel="license" href="http://creativecommons.org/licenses/by/4.0/"&gt;
&lt;img alt="Creative Commons License"
style="border-width:0"
src="https://i.creativecommons.org/l/by/4.0/88x31.png"&gt;&lt;/a&gt;</copyright><lastBuildDate>Wed, 17 Aug 2022 03:33:45 GMT</lastBuildDate><generator>Nikola (getnikola.com)</generator><docs>http://blogs.law.harvard.edu/tech/rss</docs><item><title>Numerical methods challenge: Summary</title><link>https://nicoguaro.github.io/posts/numerical_challenge/numerical_summary/</link><dc:creator>Nicolás Guarín-Zapata</dc:creator><description>&lt;p&gt;During October (2017) I wrote a program per day for some well-known numerical
methods in both Python and Julia. It was intended to be an exercise, then don't
expect the code to be good enough for real use. Also, I should mention that I
had almost no experience with Julia, so it probably is not idiomatic Julia but
more Python-like Julia.&lt;/p&gt;
&lt;section id="summary"&gt;
&lt;h2&gt;Summary&lt;/h2&gt;
&lt;p&gt;This post is a summary of that challenge. For the source code you can check
&lt;a class="reference external" href="https://github.com/nicoguaro/numerical_challenge_2017"&gt;the repository&lt;/a&gt;.&lt;/p&gt;
&lt;section id="the-verdict"&gt;
&lt;h3&gt;The verdict&lt;/h3&gt;
&lt;p&gt;Since the challenge is with myself, and the main purpose was to learn some
Julia the verdict is: &lt;strong&gt;success&lt;/strong&gt;. Nevertheless, I failed during day 26
with the Boundary Element Method.&lt;/p&gt;
&lt;/section&gt;
&lt;section id="the-list-of-methods"&gt;
&lt;h3&gt;The list of methods&lt;/h3&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;&lt;th class="head"&gt;&lt;p&gt;Day&lt;/p&gt;&lt;/th&gt;
&lt;th class="head"&gt;&lt;p&gt;Numerical method&lt;/p&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;&lt;td&gt;&lt;p&gt;&lt;a class="reference external" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-01"&gt;01&lt;/a&gt;&lt;/p&gt;&lt;/td&gt;
&lt;td&gt;&lt;p&gt;Bisection&lt;/p&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;&lt;p&gt;&lt;a class="reference external" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-02"&gt;02&lt;/a&gt;&lt;/p&gt;&lt;/td&gt;
&lt;td&gt;&lt;p&gt;Regula falsi&lt;/p&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;&lt;p&gt;&lt;a class="reference external" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-03"&gt;03&lt;/a&gt;&lt;/p&gt;&lt;/td&gt;
&lt;td&gt;&lt;p&gt;Newton&lt;/p&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;&lt;p&gt;&lt;a class="reference external" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-04"&gt;04&lt;/a&gt;&lt;/p&gt;&lt;/td&gt;
&lt;td&gt;&lt;p&gt;Newton multivariate&lt;/p&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;&lt;p&gt;&lt;a class="reference external" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-05"&gt;05&lt;/a&gt;&lt;/p&gt;&lt;/td&gt;
&lt;td&gt;&lt;p&gt;Broyden&lt;/p&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;&lt;p&gt;&lt;a class="reference external" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-06"&gt;06&lt;/a&gt;&lt;/p&gt;&lt;/td&gt;
&lt;td&gt;&lt;p&gt;Gradient descent&lt;/p&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;&lt;p&gt;&lt;a class="reference external" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-07"&gt;07&lt;/a&gt;&lt;/p&gt;&lt;/td&gt;
&lt;td&gt;&lt;p&gt;Nelder-Mead&lt;/p&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;&lt;p&gt;&lt;a class="reference external" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-08"&gt;08&lt;/a&gt;&lt;/p&gt;&lt;/td&gt;
&lt;td&gt;&lt;p&gt;Newton for optimization&lt;/p&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;&lt;p&gt;&lt;a class="reference external" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-09"&gt;09&lt;/a&gt;&lt;/p&gt;&lt;/td&gt;
&lt;td&gt;&lt;p&gt;Lagrange interpolation&lt;/p&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;&lt;p&gt;&lt;a class="reference external" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-10"&gt;10&lt;/a&gt;&lt;/p&gt;&lt;/td&gt;
&lt;td&gt;&lt;p&gt;Lagrange interpolation with Lobatto sampling&lt;/p&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;&lt;p&gt;&lt;a class="reference external" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-11"&gt;11&lt;/a&gt;&lt;/p&gt;&lt;/td&gt;
&lt;td&gt;&lt;p&gt;Lagrange interpolation using Vandermonde matrix&lt;/p&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;&lt;p&gt;&lt;a class="reference external" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-12"&gt;12&lt;/a&gt;&lt;/p&gt;&lt;/td&gt;
&lt;td&gt;&lt;p&gt;Hermite interpolation&lt;/p&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;&lt;p&gt;&lt;a class="reference external" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-13"&gt;13&lt;/a&gt;&lt;/p&gt;&lt;/td&gt;
&lt;td&gt;&lt;p&gt;Spline interpolation&lt;/p&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;&lt;p&gt;&lt;a class="reference external" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-14"&gt;14&lt;/a&gt;&lt;/p&gt;&lt;/td&gt;
&lt;td&gt;&lt;p&gt;Trapezoid quadrature&lt;/p&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;&lt;p&gt;&lt;a class="reference external" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-15"&gt;15&lt;/a&gt;&lt;/p&gt;&lt;/td&gt;
&lt;td&gt;&lt;p&gt;Simpson quadrature&lt;/p&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;&lt;p&gt;&lt;a class="reference external" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-16"&gt;16&lt;/a&gt;&lt;/p&gt;&lt;/td&gt;
&lt;td&gt;&lt;p&gt;Clenshaw-Curtis quadrature&lt;/p&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;&lt;p&gt;&lt;a class="reference external" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-17"&gt;17&lt;/a&gt;&lt;/p&gt;&lt;/td&gt;
&lt;td&gt;&lt;p&gt;Euler integration&lt;/p&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;&lt;p&gt;&lt;a class="reference external" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-18"&gt;18&lt;/a&gt;&lt;/p&gt;&lt;/td&gt;
&lt;td&gt;&lt;p&gt;Runge-Kutta integration&lt;/p&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;&lt;p&gt;&lt;a class="reference external" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-19"&gt;19&lt;/a&gt;&lt;/p&gt;&lt;/td&gt;
&lt;td&gt;&lt;p&gt;Verlet integration&lt;/p&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;&lt;p&gt;&lt;a class="reference external" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-20"&gt;20&lt;/a&gt;&lt;/p&gt;&lt;/td&gt;
&lt;td&gt;&lt;p&gt;Shooting method&lt;/p&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;&lt;p&gt;&lt;a class="reference external" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-21"&gt;21&lt;/a&gt;&lt;/p&gt;&lt;/td&gt;
&lt;td&gt;&lt;p&gt;Finite differences with Jacobi method&lt;/p&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;&lt;p&gt;&lt;a class="reference external" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-22"&gt;22&lt;/a&gt;&lt;/p&gt;&lt;/td&gt;
&lt;td&gt;&lt;p&gt;Finite differences for eigenvalues&lt;/p&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;&lt;p&gt;&lt;a class="reference external" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-23"&gt;23&lt;/a&gt;&lt;/p&gt;&lt;/td&gt;
&lt;td&gt;&lt;p&gt;Ritz method&lt;/p&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;&lt;p&gt;&lt;a class="reference external" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24"&gt;24&lt;/a&gt;&lt;/p&gt;&lt;/td&gt;
&lt;td&gt;&lt;p&gt;Finite element method in 1D&lt;/p&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;&lt;p&gt;&lt;a class="reference external" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25"&gt;25&lt;/a&gt;&lt;/p&gt;&lt;/td&gt;
&lt;td&gt;&lt;p&gt;Finite element method in 2D&lt;/p&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;&lt;p&gt;&lt;a class="reference external" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-26"&gt;26&lt;/a&gt;&lt;/p&gt;&lt;/td&gt;
&lt;td&gt;&lt;p&gt;Boundary element method&lt;/p&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;&lt;p&gt;&lt;a class="reference external" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-27"&gt;27&lt;/a&gt;&lt;/p&gt;&lt;/td&gt;
&lt;td&gt;&lt;p&gt;Monte-Carlo integration&lt;/p&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;&lt;p&gt;&lt;a class="reference external" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-28"&gt;28&lt;/a&gt;&lt;/p&gt;&lt;/td&gt;
&lt;td&gt;&lt;p&gt;LU factorization&lt;/p&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;&lt;p&gt;&lt;a class="reference external" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-29"&gt;29&lt;/a&gt;&lt;/p&gt;&lt;/td&gt;
&lt;td&gt;&lt;p&gt;Cholesky factorization&lt;/p&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;&lt;p&gt;&lt;a class="reference external" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30"&gt;30&lt;/a&gt;&lt;/p&gt;&lt;/td&gt;
&lt;td&gt;&lt;p&gt;Conjugate gradient&lt;/p&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;&lt;p&gt;&lt;a class="reference external" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31"&gt;31&lt;/a&gt;&lt;/p&gt;&lt;/td&gt;
&lt;td&gt;&lt;p&gt;Finite element method with solver&lt;/p&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;/section&gt;
&lt;section id="conclusions"&gt;
&lt;h3&gt;Conclusions&lt;/h3&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;This was an exercise of code-kata to learn some of the details of Julia for
scientific computing. As such, it was really useful for me to get my hands
dirty with Julia.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Implementing the Boundary Element Method in one day seems to be rough. I
knew this beforehand, but I gave it a try anyways … without succcess.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Julia syntax is somewhat in a sweetspot between Python and MATLAB. This makes
it really easy to use, although the documentation of some packages is at
an arcane stage right now.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;I won't take a challenge like this in a while. It takes a lot of atttention
to get it done.&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/section&gt;
&lt;/section&gt;</description><category>julia</category><category>numerical methods</category><category>python</category><category>scientific computing</category><guid>https://nicoguaro.github.io/posts/numerical_challenge/numerical_summary/</guid><pubDate>Tue, 14 Nov 2017 16:22:23 GMT</pubDate></item><item><title>Numerical methods challenge: Day 31</title><link>https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/</link><dc:creator>Nicolás Guarín-Zapata</dc:creator><description>&lt;p&gt;During October (2017) I wrote a program per day for some well-known
numerical methods in both Python and Julia. It was intended to be an exercise,
then don't expect the code to be good enough for real use. Also,
I should mention that I had almost no experience with Julia, so it
probably is not idiomatic Julia but more Python-like Julia.&lt;/p&gt;
&lt;section id="putting-some-things-together"&gt;
&lt;h2&gt;Putting some things together&lt;/h2&gt;
&lt;p&gt;Today, I am putting some things together, namely, I am going to solve the
system of equations that results in the finite element using the conjugate
gradient.&lt;/p&gt;
&lt;p&gt;Following are the codes&lt;/p&gt;
&lt;section id="python"&gt;
&lt;h3&gt;Python&lt;/h3&gt;
&lt;div class="code"&gt;&lt;pre class="code python"&gt;&lt;a id="rest_code_f3f372631f8b42008702731beb851786-1" name="rest_code_f3f372631f8b42008702731beb851786-1" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_f3f372631f8b42008702731beb851786-1"&gt;&lt;/a&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;__future__&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;division&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;print_function&lt;/span&gt;
&lt;a id="rest_code_f3f372631f8b42008702731beb851786-2" name="rest_code_f3f372631f8b42008702731beb851786-2" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_f3f372631f8b42008702731beb851786-2"&gt;&lt;/a&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;numpy&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;np&lt;/span&gt;
&lt;a id="rest_code_f3f372631f8b42008702731beb851786-3" name="rest_code_f3f372631f8b42008702731beb851786-3" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_f3f372631f8b42008702731beb851786-3"&gt;&lt;/a&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;matplotlib.pyplot&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;plt&lt;/span&gt;
&lt;a id="rest_code_f3f372631f8b42008702731beb851786-4" name="rest_code_f3f372631f8b42008702731beb851786-4" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_f3f372631f8b42008702731beb851786-4"&gt;&lt;/a&gt;
&lt;a id="rest_code_f3f372631f8b42008702731beb851786-5" name="rest_code_f3f372631f8b42008702731beb851786-5" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_f3f372631f8b42008702731beb851786-5"&gt;&lt;/a&gt;
&lt;a id="rest_code_f3f372631f8b42008702731beb851786-6" name="rest_code_f3f372631f8b42008702731beb851786-6" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_f3f372631f8b42008702731beb851786-6"&gt;&lt;/a&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;FEM1D&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;source&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_f3f372631f8b42008702731beb851786-7" name="rest_code_f3f372631f8b42008702731beb851786-7" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_f3f372631f8b42008702731beb851786-7"&gt;&lt;/a&gt;    &lt;span class="n"&gt;N&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_f3f372631f8b42008702731beb851786-8" name="rest_code_f3f372631f8b42008702731beb851786-8" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_f3f372631f8b42008702731beb851786-8"&gt;&lt;/a&gt;    &lt;span class="n"&gt;stiff_loc&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;([[&lt;/span&gt;&lt;span class="mf"&gt;2.0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;2.0&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;2.0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;2.0&lt;/span&gt;&lt;span class="p"&gt;]])&lt;/span&gt;
&lt;a id="rest_code_f3f372631f8b42008702731beb851786-9" name="rest_code_f3f372631f8b42008702731beb851786-9" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_f3f372631f8b42008702731beb851786-9"&gt;&lt;/a&gt;    &lt;span class="n"&gt;eles&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="n"&gt;cont&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;cont&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;cont&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;N&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)]&lt;/span&gt;
&lt;a id="rest_code_f3f372631f8b42008702731beb851786-10" name="rest_code_f3f372631f8b42008702731beb851786-10" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_f3f372631f8b42008702731beb851786-10"&gt;&lt;/a&gt;    &lt;span class="n"&gt;stiff&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_f3f372631f8b42008702731beb851786-11" name="rest_code_f3f372631f8b42008702731beb851786-11" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_f3f372631f8b42008702731beb851786-11"&gt;&lt;/a&gt;    &lt;span class="n"&gt;rhs&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_f3f372631f8b42008702731beb851786-12" name="rest_code_f3f372631f8b42008702731beb851786-12" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_f3f372631f8b42008702731beb851786-12"&gt;&lt;/a&gt;    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;ele&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;eles&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a id="rest_code_f3f372631f8b42008702731beb851786-13" name="rest_code_f3f372631f8b42008702731beb851786-13" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_f3f372631f8b42008702731beb851786-13"&gt;&lt;/a&gt;        &lt;span class="n"&gt;jaco&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ele&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]]&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ele&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]]&lt;/span&gt;
&lt;a id="rest_code_f3f372631f8b42008702731beb851786-14" name="rest_code_f3f372631f8b42008702731beb851786-14" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_f3f372631f8b42008702731beb851786-14"&gt;&lt;/a&gt;        &lt;span class="n"&gt;rhs&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ele&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;rhs&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ele&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;jaco&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;source&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ele&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_f3f372631f8b42008702731beb851786-15" name="rest_code_f3f372631f8b42008702731beb851786-15" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_f3f372631f8b42008702731beb851786-15"&gt;&lt;/a&gt;        &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;cont1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;row&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;enumerate&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ele&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_f3f372631f8b42008702731beb851786-16" name="rest_code_f3f372631f8b42008702731beb851786-16" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_f3f372631f8b42008702731beb851786-16"&gt;&lt;/a&gt;            &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;cont2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;col&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;enumerate&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ele&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_f3f372631f8b42008702731beb851786-17" name="rest_code_f3f372631f8b42008702731beb851786-17" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_f3f372631f8b42008702731beb851786-17"&gt;&lt;/a&gt;                &lt;span class="n"&gt;stiff&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;row&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;stiff&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;row&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt;  &lt;span class="n"&gt;stiff_loc&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;cont1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;cont2&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;jaco&lt;/span&gt;
&lt;a id="rest_code_f3f372631f8b42008702731beb851786-18" name="rest_code_f3f372631f8b42008702731beb851786-18" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_f3f372631f8b42008702731beb851786-18"&gt;&lt;/a&gt;    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;stiff&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;rhs&lt;/span&gt;
&lt;a id="rest_code_f3f372631f8b42008702731beb851786-19" name="rest_code_f3f372631f8b42008702731beb851786-19" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_f3f372631f8b42008702731beb851786-19"&gt;&lt;/a&gt;
&lt;a id="rest_code_f3f372631f8b42008702731beb851786-20" name="rest_code_f3f372631f8b42008702731beb851786-20" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_f3f372631f8b42008702731beb851786-20"&gt;&lt;/a&gt;
&lt;a id="rest_code_f3f372631f8b42008702731beb851786-21" name="rest_code_f3f372631f8b42008702731beb851786-21" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_f3f372631f8b42008702731beb851786-21"&gt;&lt;/a&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;conj_grad&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;tol&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mf"&gt;1e-8&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_f3f372631f8b42008702731beb851786-22" name="rest_code_f3f372631f8b42008702731beb851786-22" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_f3f372631f8b42008702731beb851786-22"&gt;&lt;/a&gt;    &lt;span class="n"&gt;r&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;b&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;dot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_f3f372631f8b42008702731beb851786-23" name="rest_code_f3f372631f8b42008702731beb851786-23" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_f3f372631f8b42008702731beb851786-23"&gt;&lt;/a&gt;    &lt;span class="n"&gt;p&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;r&lt;/span&gt;
&lt;a id="rest_code_f3f372631f8b42008702731beb851786-24" name="rest_code_f3f372631f8b42008702731beb851786-24" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_f3f372631f8b42008702731beb851786-24"&gt;&lt;/a&gt;    &lt;span class="n"&gt;rsq_old&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;dot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_f3f372631f8b42008702731beb851786-25" name="rest_code_f3f372631f8b42008702731beb851786-25" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_f3f372631f8b42008702731beb851786-25"&gt;&lt;/a&gt;    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;cont&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;)):&lt;/span&gt;
&lt;a id="rest_code_f3f372631f8b42008702731beb851786-26" name="rest_code_f3f372631f8b42008702731beb851786-26" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_f3f372631f8b42008702731beb851786-26"&gt;&lt;/a&gt;        &lt;span class="n"&gt;Ap&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;dot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_f3f372631f8b42008702731beb851786-27" name="rest_code_f3f372631f8b42008702731beb851786-27" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_f3f372631f8b42008702731beb851786-27"&gt;&lt;/a&gt;        &lt;span class="n"&gt;alpha&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;rsq_old&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;dot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Ap&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_f3f372631f8b42008702731beb851786-28" name="rest_code_f3f372631f8b42008702731beb851786-28" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_f3f372631f8b42008702731beb851786-28"&gt;&lt;/a&gt;        &lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;alpha&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;p&lt;/span&gt;
&lt;a id="rest_code_f3f372631f8b42008702731beb851786-29" name="rest_code_f3f372631f8b42008702731beb851786-29" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_f3f372631f8b42008702731beb851786-29"&gt;&lt;/a&gt;        &lt;span class="n"&gt;r&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;r&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;alpha&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;Ap&lt;/span&gt;
&lt;a id="rest_code_f3f372631f8b42008702731beb851786-30" name="rest_code_f3f372631f8b42008702731beb851786-30" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_f3f372631f8b42008702731beb851786-30"&gt;&lt;/a&gt;        &lt;span class="n"&gt;rsq_new&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;dot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_f3f372631f8b42008702731beb851786-31" name="rest_code_f3f372631f8b42008702731beb851786-31" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_f3f372631f8b42008702731beb851786-31"&gt;&lt;/a&gt;        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sqrt&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;rsq_new&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;tol&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a id="rest_code_f3f372631f8b42008702731beb851786-32" name="rest_code_f3f372631f8b42008702731beb851786-32" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_f3f372631f8b42008702731beb851786-32"&gt;&lt;/a&gt;            &lt;span class="k"&gt;break&lt;/span&gt;
&lt;a id="rest_code_f3f372631f8b42008702731beb851786-33" name="rest_code_f3f372631f8b42008702731beb851786-33" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_f3f372631f8b42008702731beb851786-33"&gt;&lt;/a&gt;        &lt;span class="n"&gt;p&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;r&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;rsq_new&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="n"&gt;rsq_old&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;p&lt;/span&gt;
&lt;a id="rest_code_f3f372631f8b42008702731beb851786-34" name="rest_code_f3f372631f8b42008702731beb851786-34" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_f3f372631f8b42008702731beb851786-34"&gt;&lt;/a&gt;        &lt;span class="n"&gt;rsq_old&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;rsq_new&lt;/span&gt;
&lt;a id="rest_code_f3f372631f8b42008702731beb851786-35" name="rest_code_f3f372631f8b42008702731beb851786-35" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_f3f372631f8b42008702731beb851786-35"&gt;&lt;/a&gt;    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;cont&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sqrt&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;rsq_new&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_f3f372631f8b42008702731beb851786-36" name="rest_code_f3f372631f8b42008702731beb851786-36" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_f3f372631f8b42008702731beb851786-36"&gt;&lt;/a&gt;
&lt;a id="rest_code_f3f372631f8b42008702731beb851786-37" name="rest_code_f3f372631f8b42008702731beb851786-37" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_f3f372631f8b42008702731beb851786-37"&gt;&lt;/a&gt;
&lt;a id="rest_code_f3f372631f8b42008702731beb851786-38" name="rest_code_f3f372631f8b42008702731beb851786-38" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_f3f372631f8b42008702731beb851786-38"&gt;&lt;/a&gt;&lt;span class="n"&gt;fun&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;lambda&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;
&lt;a id="rest_code_f3f372631f8b42008702731beb851786-39" name="rest_code_f3f372631f8b42008702731beb851786-39" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_f3f372631f8b42008702731beb851786-39"&gt;&lt;/a&gt;&lt;span class="n"&gt;N_vec&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;logspace&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;0.5&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;50&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;dtype&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nb"&gt;int&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_f3f372631f8b42008702731beb851786-40" name="rest_code_f3f372631f8b42008702731beb851786-40" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_f3f372631f8b42008702731beb851786-40"&gt;&lt;/a&gt;&lt;span class="n"&gt;err_vec&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros_like&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N_vec&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;dtype&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nb"&gt;float&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_f3f372631f8b42008702731beb851786-41" name="rest_code_f3f372631f8b42008702731beb851786-41" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_f3f372631f8b42008702731beb851786-41"&gt;&lt;/a&gt;&lt;span class="n"&gt;niter_vec&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros_like&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N_vec&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_f3f372631f8b42008702731beb851786-42" name="rest_code_f3f372631f8b42008702731beb851786-42" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_f3f372631f8b42008702731beb851786-42"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;figure&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;figsize&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;8&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_f3f372631f8b42008702731beb851786-43" name="rest_code_f3f372631f8b42008702731beb851786-43" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_f3f372631f8b42008702731beb851786-43"&gt;&lt;/a&gt;&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;cont&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;N&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;enumerate&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N_vec&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_f3f372631f8b42008702731beb851786-44" name="rest_code_f3f372631f8b42008702731beb851786-44" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_f3f372631f8b42008702731beb851786-44"&gt;&lt;/a&gt;    &lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;linspace&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_f3f372631f8b42008702731beb851786-45" name="rest_code_f3f372631f8b42008702731beb851786-45" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_f3f372631f8b42008702731beb851786-45"&gt;&lt;/a&gt;    &lt;span class="n"&gt;stiff&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;rhs&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;FEM1D&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;fun&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_f3f372631f8b42008702731beb851786-46" name="rest_code_f3f372631f8b42008702731beb851786-46" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_f3f372631f8b42008702731beb851786-46"&gt;&lt;/a&gt;    &lt;span class="n"&gt;sol&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_f3f372631f8b42008702731beb851786-47" name="rest_code_f3f372631f8b42008702731beb851786-47" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_f3f372631f8b42008702731beb851786-47"&gt;&lt;/a&gt;    &lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;niter&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;_&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;conj_grad&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;stiff&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;rhs&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;rhs&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_f3f372631f8b42008702731beb851786-48" name="rest_code_f3f372631f8b42008702731beb851786-48" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_f3f372631f8b42008702731beb851786-48"&gt;&lt;/a&gt;    &lt;span class="n"&gt;err&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;linalg&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;norm&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;sol&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="mi"&gt;20&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;linalg&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;norm&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="mi"&gt;20&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_f3f372631f8b42008702731beb851786-49" name="rest_code_f3f372631f8b42008702731beb851786-49" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_f3f372631f8b42008702731beb851786-49"&gt;&lt;/a&gt;    &lt;span class="n"&gt;err_vec&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;cont&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;err&lt;/span&gt;
&lt;a id="rest_code_f3f372631f8b42008702731beb851786-50" name="rest_code_f3f372631f8b42008702731beb851786-50" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_f3f372631f8b42008702731beb851786-50"&gt;&lt;/a&gt;    &lt;span class="n"&gt;niter_vec&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;cont&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;niter&lt;/span&gt;
&lt;a id="rest_code_f3f372631f8b42008702731beb851786-51" name="rest_code_f3f372631f8b42008702731beb851786-51" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_f3f372631f8b42008702731beb851786-51"&gt;&lt;/a&gt;
&lt;a id="rest_code_f3f372631f8b42008702731beb851786-52" name="rest_code_f3f372631f8b42008702731beb851786-52" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_f3f372631f8b42008702731beb851786-52"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;subplot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;121&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_f3f372631f8b42008702731beb851786-53" name="rest_code_f3f372631f8b42008702731beb851786-53" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_f3f372631f8b42008702731beb851786-53"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;loglog&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N_vec&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;err_vec&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_f3f372631f8b42008702731beb851786-54" name="rest_code_f3f372631f8b42008702731beb851786-54" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_f3f372631f8b42008702731beb851786-54"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"Number of nodes"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_f3f372631f8b42008702731beb851786-55" name="rest_code_f3f372631f8b42008702731beb851786-55" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_f3f372631f8b42008702731beb851786-55"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ylabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"Relative error"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_f3f372631f8b42008702731beb851786-56" name="rest_code_f3f372631f8b42008702731beb851786-56" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_f3f372631f8b42008702731beb851786-56"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;subplot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;122&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_f3f372631f8b42008702731beb851786-57" name="rest_code_f3f372631f8b42008702731beb851786-57" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_f3f372631f8b42008702731beb851786-57"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;loglog&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N_vec&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;niter_vec&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_f3f372631f8b42008702731beb851786-58" name="rest_code_f3f372631f8b42008702731beb851786-58" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_f3f372631f8b42008702731beb851786-58"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"Number of nodes"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_f3f372631f8b42008702731beb851786-59" name="rest_code_f3f372631f8b42008702731beb851786-59" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_f3f372631f8b42008702731beb851786-59"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ylabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"Number of iterations"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_f3f372631f8b42008702731beb851786-60" name="rest_code_f3f372631f8b42008702731beb851786-60" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_f3f372631f8b42008702731beb851786-60"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;tight_layout&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a id="rest_code_f3f372631f8b42008702731beb851786-61" name="rest_code_f3f372631f8b42008702731beb851786-61" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_f3f372631f8b42008702731beb851786-61"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;show&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/section&gt;
&lt;section id="julia"&gt;
&lt;h3&gt;Julia&lt;/h3&gt;
&lt;div class="code"&gt;&lt;pre class="code julia"&gt;&lt;a id="rest_code_064ed616fca74bbf8f86c0939d24ba9c-1" name="rest_code_064ed616fca74bbf8f86c0939d24ba9c-1" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_064ed616fca74bbf8f86c0939d24ba9c-1"&gt;&lt;/a&gt;&lt;span class="k"&gt;using&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;PyPlot&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_064ed616fca74bbf8f86c0939d24ba9c-2" name="rest_code_064ed616fca74bbf8f86c0939d24ba9c-2" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_064ed616fca74bbf8f86c0939d24ba9c-2"&gt;&lt;/a&gt;
&lt;a id="rest_code_064ed616fca74bbf8f86c0939d24ba9c-3" name="rest_code_064ed616fca74bbf8f86c0939d24ba9c-3" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_064ed616fca74bbf8f86c0939d24ba9c-3"&gt;&lt;/a&gt;
&lt;a id="rest_code_064ed616fca74bbf8f86c0939d24ba9c-4" name="rest_code_064ed616fca74bbf8f86c0939d24ba9c-4" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_064ed616fca74bbf8f86c0939d24ba9c-4"&gt;&lt;/a&gt;&lt;span class="k"&gt;function&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;FEM1D&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;source&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_064ed616fca74bbf8f86c0939d24ba9c-5" name="rest_code_064ed616fca74bbf8f86c0939d24ba9c-5" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_064ed616fca74bbf8f86c0939d24ba9c-5"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;length&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_064ed616fca74bbf8f86c0939d24ba9c-6" name="rest_code_064ed616fca74bbf8f86c0939d24ba9c-6" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_064ed616fca74bbf8f86c0939d24ba9c-6"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;stiff_loc&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mf"&gt;2.0&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;2.0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;2.0&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;2.0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_064ed616fca74bbf8f86c0939d24ba9c-7" name="rest_code_064ed616fca74bbf8f86c0939d24ba9c-7" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_064ed616fca74bbf8f86c0939d24ba9c-7"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;eles&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;[[&lt;/span&gt;&lt;span class="n"&gt;cont&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;cont&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;for&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;cont&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;in&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_064ed616fca74bbf8f86c0939d24ba9c-8" name="rest_code_064ed616fca74bbf8f86c0939d24ba9c-8" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_064ed616fca74bbf8f86c0939d24ba9c-8"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;stiff&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_064ed616fca74bbf8f86c0939d24ba9c-9" name="rest_code_064ed616fca74bbf8f86c0939d24ba9c-9" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_064ed616fca74bbf8f86c0939d24ba9c-9"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;rhs&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_064ed616fca74bbf8f86c0939d24ba9c-10" name="rest_code_064ed616fca74bbf8f86c0939d24ba9c-10" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_064ed616fca74bbf8f86c0939d24ba9c-10"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;for&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ele&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;in&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;eles&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_064ed616fca74bbf8f86c0939d24ba9c-11" name="rest_code_064ed616fca74bbf8f86c0939d24ba9c-11" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_064ed616fca74bbf8f86c0939d24ba9c-11"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;jaco&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ele&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;]]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ele&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]]&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_064ed616fca74bbf8f86c0939d24ba9c-12" name="rest_code_064ed616fca74bbf8f86c0939d24ba9c-12" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_064ed616fca74bbf8f86c0939d24ba9c-12"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;rhs&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ele&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;rhs&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ele&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;jaco&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;source&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ele&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_064ed616fca74bbf8f86c0939d24ba9c-13" name="rest_code_064ed616fca74bbf8f86c0939d24ba9c-13" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_064ed616fca74bbf8f86c0939d24ba9c-13"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;stiff&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ele&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ele&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;stiff&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ele&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ele&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;stiff_loc&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;jaco&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_064ed616fca74bbf8f86c0939d24ba9c-14" name="rest_code_064ed616fca74bbf8f86c0939d24ba9c-14" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_064ed616fca74bbf8f86c0939d24ba9c-14"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;end&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_064ed616fca74bbf8f86c0939d24ba9c-15" name="rest_code_064ed616fca74bbf8f86c0939d24ba9c-15" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_064ed616fca74bbf8f86c0939d24ba9c-15"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;return&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;stiff&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;rhs&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_064ed616fca74bbf8f86c0939d24ba9c-16" name="rest_code_064ed616fca74bbf8f86c0939d24ba9c-16" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_064ed616fca74bbf8f86c0939d24ba9c-16"&gt;&lt;/a&gt;&lt;span class="k"&gt;end&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_064ed616fca74bbf8f86c0939d24ba9c-17" name="rest_code_064ed616fca74bbf8f86c0939d24ba9c-17" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_064ed616fca74bbf8f86c0939d24ba9c-17"&gt;&lt;/a&gt;
&lt;a id="rest_code_064ed616fca74bbf8f86c0939d24ba9c-18" name="rest_code_064ed616fca74bbf8f86c0939d24ba9c-18" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_064ed616fca74bbf8f86c0939d24ba9c-18"&gt;&lt;/a&gt;
&lt;a id="rest_code_064ed616fca74bbf8f86c0939d24ba9c-19" name="rest_code_064ed616fca74bbf8f86c0939d24ba9c-19" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_064ed616fca74bbf8f86c0939d24ba9c-19"&gt;&lt;/a&gt;&lt;span class="k"&gt;function&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;conj_grad&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;tol&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mf"&gt;1e-8&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_064ed616fca74bbf8f86c0939d24ba9c-20" name="rest_code_064ed616fca74bbf8f86c0939d24ba9c-20" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_064ed616fca74bbf8f86c0939d24ba9c-20"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_064ed616fca74bbf8f86c0939d24ba9c-21" name="rest_code_064ed616fca74bbf8f86c0939d24ba9c-21" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_064ed616fca74bbf8f86c0939d24ba9c-21"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_064ed616fca74bbf8f86c0939d24ba9c-22" name="rest_code_064ed616fca74bbf8f86c0939d24ba9c-22" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_064ed616fca74bbf8f86c0939d24ba9c-22"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;rsq_old&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;dot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_064ed616fca74bbf8f86c0939d24ba9c-23" name="rest_code_064ed616fca74bbf8f86c0939d24ba9c-23" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_064ed616fca74bbf8f86c0939d24ba9c-23"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;niter&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_064ed616fca74bbf8f86c0939d24ba9c-24" name="rest_code_064ed616fca74bbf8f86c0939d24ba9c-24" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_064ed616fca74bbf8f86c0939d24ba9c-24"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;for&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;cont&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="n"&gt;length&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_064ed616fca74bbf8f86c0939d24ba9c-25" name="rest_code_064ed616fca74bbf8f86c0939d24ba9c-25" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_064ed616fca74bbf8f86c0939d24ba9c-25"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;Ap&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_064ed616fca74bbf8f86c0939d24ba9c-26" name="rest_code_064ed616fca74bbf8f86c0939d24ba9c-26" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_064ed616fca74bbf8f86c0939d24ba9c-26"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;alpha&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;rsq_old&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;dot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Ap&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_064ed616fca74bbf8f86c0939d24ba9c-27" name="rest_code_064ed616fca74bbf8f86c0939d24ba9c-27" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_064ed616fca74bbf8f86c0939d24ba9c-27"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;alpha&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_064ed616fca74bbf8f86c0939d24ba9c-28" name="rest_code_064ed616fca74bbf8f86c0939d24ba9c-28" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_064ed616fca74bbf8f86c0939d24ba9c-28"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;alpha&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;Ap&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_064ed616fca74bbf8f86c0939d24ba9c-29" name="rest_code_064ed616fca74bbf8f86c0939d24ba9c-29" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_064ed616fca74bbf8f86c0939d24ba9c-29"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;rsq_new&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;dot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_064ed616fca74bbf8f86c0939d24ba9c-30" name="rest_code_064ed616fca74bbf8f86c0939d24ba9c-30" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_064ed616fca74bbf8f86c0939d24ba9c-30"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;sqrt&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;rsq_new&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;tol&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_064ed616fca74bbf8f86c0939d24ba9c-31" name="rest_code_064ed616fca74bbf8f86c0939d24ba9c-31" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_064ed616fca74bbf8f86c0939d24ba9c-31"&gt;&lt;/a&gt;&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="k"&gt;break&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_064ed616fca74bbf8f86c0939d24ba9c-32" name="rest_code_064ed616fca74bbf8f86c0939d24ba9c-32" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_064ed616fca74bbf8f86c0939d24ba9c-32"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="k"&gt;end&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_064ed616fca74bbf8f86c0939d24ba9c-33" name="rest_code_064ed616fca74bbf8f86c0939d24ba9c-33" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_064ed616fca74bbf8f86c0939d24ba9c-33"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;rsq_new&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;rsq_old&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_064ed616fca74bbf8f86c0939d24ba9c-34" name="rest_code_064ed616fca74bbf8f86c0939d24ba9c-34" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_064ed616fca74bbf8f86c0939d24ba9c-34"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;rsq_old&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;rsq_new&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_064ed616fca74bbf8f86c0939d24ba9c-35" name="rest_code_064ed616fca74bbf8f86c0939d24ba9c-35" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_064ed616fca74bbf8f86c0939d24ba9c-35"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;niter&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_064ed616fca74bbf8f86c0939d24ba9c-36" name="rest_code_064ed616fca74bbf8f86c0939d24ba9c-36" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_064ed616fca74bbf8f86c0939d24ba9c-36"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;end&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_064ed616fca74bbf8f86c0939d24ba9c-37" name="rest_code_064ed616fca74bbf8f86c0939d24ba9c-37" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_064ed616fca74bbf8f86c0939d24ba9c-37"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;return&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;niter&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;norm&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_064ed616fca74bbf8f86c0939d24ba9c-38" name="rest_code_064ed616fca74bbf8f86c0939d24ba9c-38" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_064ed616fca74bbf8f86c0939d24ba9c-38"&gt;&lt;/a&gt;&lt;span class="k"&gt;end&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_064ed616fca74bbf8f86c0939d24ba9c-39" name="rest_code_064ed616fca74bbf8f86c0939d24ba9c-39" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_064ed616fca74bbf8f86c0939d24ba9c-39"&gt;&lt;/a&gt;
&lt;a id="rest_code_064ed616fca74bbf8f86c0939d24ba9c-40" name="rest_code_064ed616fca74bbf8f86c0939d24ba9c-40" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_064ed616fca74bbf8f86c0939d24ba9c-40"&gt;&lt;/a&gt;
&lt;a id="rest_code_064ed616fca74bbf8f86c0939d24ba9c-41" name="rest_code_064ed616fca74bbf8f86c0939d24ba9c-41" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_064ed616fca74bbf8f86c0939d24ba9c-41"&gt;&lt;/a&gt;
&lt;a id="rest_code_064ed616fca74bbf8f86c0939d24ba9c-42" name="rest_code_064ed616fca74bbf8f86c0939d24ba9c-42" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_064ed616fca74bbf8f86c0939d24ba9c-42"&gt;&lt;/a&gt;&lt;span class="n"&gt;fun&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;.^&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_064ed616fca74bbf8f86c0939d24ba9c-43" name="rest_code_064ed616fca74bbf8f86c0939d24ba9c-43" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_064ed616fca74bbf8f86c0939d24ba9c-43"&gt;&lt;/a&gt;&lt;span class="n"&gt;N_vec&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;round&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;logspace&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;0.5&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;50&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_064ed616fca74bbf8f86c0939d24ba9c-44" name="rest_code_064ed616fca74bbf8f86c0939d24ba9c-44" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_064ed616fca74bbf8f86c0939d24ba9c-44"&gt;&lt;/a&gt;&lt;span class="n"&gt;err_vec&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N_vec&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_064ed616fca74bbf8f86c0939d24ba9c-45" name="rest_code_064ed616fca74bbf8f86c0939d24ba9c-45" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_064ed616fca74bbf8f86c0939d24ba9c-45"&gt;&lt;/a&gt;&lt;span class="n"&gt;niter_vec&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N_vec&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_064ed616fca74bbf8f86c0939d24ba9c-46" name="rest_code_064ed616fca74bbf8f86c0939d24ba9c-46" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_064ed616fca74bbf8f86c0939d24ba9c-46"&gt;&lt;/a&gt;&lt;span class="n"&gt;figure&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;figsize&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;8&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_064ed616fca74bbf8f86c0939d24ba9c-47" name="rest_code_064ed616fca74bbf8f86c0939d24ba9c-47" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_064ed616fca74bbf8f86c0939d24ba9c-47"&gt;&lt;/a&gt;&lt;span class="k"&gt;for&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;cont&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;in&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;enumerate&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N_vec&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_064ed616fca74bbf8f86c0939d24ba9c-48" name="rest_code_064ed616fca74bbf8f86c0939d24ba9c-48" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_064ed616fca74bbf8f86c0939d24ba9c-48"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;linspace&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;0.0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;1.0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_064ed616fca74bbf8f86c0939d24ba9c-49" name="rest_code_064ed616fca74bbf8f86c0939d24ba9c-49" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_064ed616fca74bbf8f86c0939d24ba9c-49"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;stiff&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;rhs&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;FEM1D&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;fun&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_064ed616fca74bbf8f86c0939d24ba9c-50" name="rest_code_064ed616fca74bbf8f86c0939d24ba9c-50" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_064ed616fca74bbf8f86c0939d24ba9c-50"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_064ed616fca74bbf8f86c0939d24ba9c-51" name="rest_code_064ed616fca74bbf8f86c0939d24ba9c-51" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_064ed616fca74bbf8f86c0939d24ba9c-51"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="k"&gt;end&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;niter&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;_&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;conj_grad&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;stiff&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="k"&gt;end&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="k"&gt;end&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_064ed616fca74bbf8f86c0939d24ba9c-52" name="rest_code_064ed616fca74bbf8f86c0939d24ba9c-52" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_064ed616fca74bbf8f86c0939d24ba9c-52"&gt;&lt;/a&gt;&lt;span class="w"&gt;                                &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;rhs&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="k"&gt;end&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;rhs&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="k"&gt;end&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_064ed616fca74bbf8f86c0939d24ba9c-53" name="rest_code_064ed616fca74bbf8f86c0939d24ba9c-53" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_064ed616fca74bbf8f86c0939d24ba9c-53"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;err&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;norm&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;.*&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;.^&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="mi"&gt;20&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;norm&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;.*&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;.^&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="mi"&gt;20&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_064ed616fca74bbf8f86c0939d24ba9c-54" name="rest_code_064ed616fca74bbf8f86c0939d24ba9c-54" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_064ed616fca74bbf8f86c0939d24ba9c-54"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;err_vec&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;cont&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;err&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_064ed616fca74bbf8f86c0939d24ba9c-55" name="rest_code_064ed616fca74bbf8f86c0939d24ba9c-55" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_064ed616fca74bbf8f86c0939d24ba9c-55"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;niter_vec&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;cont&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;niter&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_064ed616fca74bbf8f86c0939d24ba9c-56" name="rest_code_064ed616fca74bbf8f86c0939d24ba9c-56" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_064ed616fca74bbf8f86c0939d24ba9c-56"&gt;&lt;/a&gt;&lt;span class="k"&gt;end&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_064ed616fca74bbf8f86c0939d24ba9c-57" name="rest_code_064ed616fca74bbf8f86c0939d24ba9c-57" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_064ed616fca74bbf8f86c0939d24ba9c-57"&gt;&lt;/a&gt;&lt;span class="n"&gt;subplot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;121&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_064ed616fca74bbf8f86c0939d24ba9c-58" name="rest_code_064ed616fca74bbf8f86c0939d24ba9c-58" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_064ed616fca74bbf8f86c0939d24ba9c-58"&gt;&lt;/a&gt;&lt;span class="n"&gt;loglog&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N_vec&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;err_vec&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_064ed616fca74bbf8f86c0939d24ba9c-59" name="rest_code_064ed616fca74bbf8f86c0939d24ba9c-59" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_064ed616fca74bbf8f86c0939d24ba9c-59"&gt;&lt;/a&gt;&lt;span class="n"&gt;xlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;"Number of nodes"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_064ed616fca74bbf8f86c0939d24ba9c-60" name="rest_code_064ed616fca74bbf8f86c0939d24ba9c-60" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_064ed616fca74bbf8f86c0939d24ba9c-60"&gt;&lt;/a&gt;&lt;span class="n"&gt;ylabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;"Relative error"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_064ed616fca74bbf8f86c0939d24ba9c-61" name="rest_code_064ed616fca74bbf8f86c0939d24ba9c-61" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_064ed616fca74bbf8f86c0939d24ba9c-61"&gt;&lt;/a&gt;&lt;span class="n"&gt;subplot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;122&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_064ed616fca74bbf8f86c0939d24ba9c-62" name="rest_code_064ed616fca74bbf8f86c0939d24ba9c-62" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_064ed616fca74bbf8f86c0939d24ba9c-62"&gt;&lt;/a&gt;&lt;span class="n"&gt;loglog&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N_vec&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;niter_vec&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_064ed616fca74bbf8f86c0939d24ba9c-63" name="rest_code_064ed616fca74bbf8f86c0939d24ba9c-63" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_064ed616fca74bbf8f86c0939d24ba9c-63"&gt;&lt;/a&gt;&lt;span class="n"&gt;xlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;"Number of nodes"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_064ed616fca74bbf8f86c0939d24ba9c-64" name="rest_code_064ed616fca74bbf8f86c0939d24ba9c-64" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_064ed616fca74bbf8f86c0939d24ba9c-64"&gt;&lt;/a&gt;&lt;span class="n"&gt;ylabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;"Number of iterations"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_064ed616fca74bbf8f86c0939d24ba9c-65" name="rest_code_064ed616fca74bbf8f86c0939d24ba9c-65" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_064ed616fca74bbf8f86c0939d24ba9c-65"&gt;&lt;/a&gt;&lt;span class="n"&gt;tight_layout&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_064ed616fca74bbf8f86c0939d24ba9c-66" name="rest_code_064ed616fca74bbf8f86c0939d24ba9c-66" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_064ed616fca74bbf8f86c0939d24ba9c-66"&gt;&lt;/a&gt;&lt;span class="n"&gt;show&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;In this case, we are analyzing the error of the solution as a function
of the number of nodes. This, and the number of iterations required
in the conjugate gradient are shown in the following image&lt;/p&gt;
&lt;img alt="Relative error in the solution." class="align-center" src="https://nicoguaro.github.io/images/FEM1D_convergence.svg" style="width: 800px;"&gt;
&lt;/section&gt;
&lt;/section&gt;</description><category>conjugate gradient</category><category>finite element method</category><category>julia</category><category>numerical methods</category><category>python</category><category>scientific computing</category><guid>https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/</guid><pubDate>Wed, 01 Nov 2017 01:45:09 GMT</pubDate></item><item><title>Numerical methods challenge: Day 30</title><link>https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/</link><dc:creator>Nicolás Guarín-Zapata</dc:creator><description>&lt;p&gt;During October (2017) I will write a program per day for some well-known
numerical methods in both Python and Julia. It is intended to be an exercise
then don't expect the code to be good enough for real use. Also,
I should mention that I have almost no experience with Julia, so it
probably won't be idiomatic Julia but more Python-like Julia.&lt;/p&gt;
&lt;section id="conjugate-gradient"&gt;
&lt;h2&gt;Conjugate gradient&lt;/h2&gt;
&lt;p&gt;Today we have the &lt;a class="reference external" href="https://en.wikipedia.org/wiki/Conjugate_gradient_method"&gt;conjugate gradient method&lt;/a&gt;.
This method is commonly used to solve positive-definite linear systems of
equations. Compared with gradient descent, we choose as descent direction
a direction that is conjugated with the residual, that is, it is
orthogonal with the matrix as weighting.&lt;/p&gt;
&lt;p&gt;Following are the codes&lt;/p&gt;
&lt;section id="python"&gt;
&lt;h3&gt;Python&lt;/h3&gt;
&lt;div class="code"&gt;&lt;pre class="code python"&gt;&lt;a id="rest_code_e85a9b9b658c40469b00e77a9c26e566-1" name="rest_code_e85a9b9b658c40469b00e77a9c26e566-1" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_e85a9b9b658c40469b00e77a9c26e566-1"&gt;&lt;/a&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;__future__&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;division&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;print_function&lt;/span&gt;
&lt;a id="rest_code_e85a9b9b658c40469b00e77a9c26e566-2" name="rest_code_e85a9b9b658c40469b00e77a9c26e566-2" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_e85a9b9b658c40469b00e77a9c26e566-2"&gt;&lt;/a&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;numpy&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;np&lt;/span&gt;
&lt;a id="rest_code_e85a9b9b658c40469b00e77a9c26e566-3" name="rest_code_e85a9b9b658c40469b00e77a9c26e566-3" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_e85a9b9b658c40469b00e77a9c26e566-3"&gt;&lt;/a&gt;
&lt;a id="rest_code_e85a9b9b658c40469b00e77a9c26e566-4" name="rest_code_e85a9b9b658c40469b00e77a9c26e566-4" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_e85a9b9b658c40469b00e77a9c26e566-4"&gt;&lt;/a&gt;
&lt;a id="rest_code_e85a9b9b658c40469b00e77a9c26e566-5" name="rest_code_e85a9b9b658c40469b00e77a9c26e566-5" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_e85a9b9b658c40469b00e77a9c26e566-5"&gt;&lt;/a&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;conj_grad&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;tol&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mf"&gt;1e-8&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_e85a9b9b658c40469b00e77a9c26e566-6" name="rest_code_e85a9b9b658c40469b00e77a9c26e566-6" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_e85a9b9b658c40469b00e77a9c26e566-6"&gt;&lt;/a&gt;    &lt;span class="n"&gt;r&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;b&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;dot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_e85a9b9b658c40469b00e77a9c26e566-7" name="rest_code_e85a9b9b658c40469b00e77a9c26e566-7" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_e85a9b9b658c40469b00e77a9c26e566-7"&gt;&lt;/a&gt;    &lt;span class="n"&gt;p&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;r&lt;/span&gt;
&lt;a id="rest_code_e85a9b9b658c40469b00e77a9c26e566-8" name="rest_code_e85a9b9b658c40469b00e77a9c26e566-8" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_e85a9b9b658c40469b00e77a9c26e566-8"&gt;&lt;/a&gt;    &lt;span class="n"&gt;rsq_old&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;dot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_e85a9b9b658c40469b00e77a9c26e566-9" name="rest_code_e85a9b9b658c40469b00e77a9c26e566-9" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_e85a9b9b658c40469b00e77a9c26e566-9"&gt;&lt;/a&gt;    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;cont&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;)):&lt;/span&gt;
&lt;a id="rest_code_e85a9b9b658c40469b00e77a9c26e566-10" name="rest_code_e85a9b9b658c40469b00e77a9c26e566-10" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_e85a9b9b658c40469b00e77a9c26e566-10"&gt;&lt;/a&gt;        &lt;span class="n"&gt;Ap&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;dot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_e85a9b9b658c40469b00e77a9c26e566-11" name="rest_code_e85a9b9b658c40469b00e77a9c26e566-11" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_e85a9b9b658c40469b00e77a9c26e566-11"&gt;&lt;/a&gt;        &lt;span class="n"&gt;alpha&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;rsq_old&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;dot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Ap&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_e85a9b9b658c40469b00e77a9c26e566-12" name="rest_code_e85a9b9b658c40469b00e77a9c26e566-12" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_e85a9b9b658c40469b00e77a9c26e566-12"&gt;&lt;/a&gt;        &lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;alpha&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;p&lt;/span&gt;
&lt;a id="rest_code_e85a9b9b658c40469b00e77a9c26e566-13" name="rest_code_e85a9b9b658c40469b00e77a9c26e566-13" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_e85a9b9b658c40469b00e77a9c26e566-13"&gt;&lt;/a&gt;        &lt;span class="n"&gt;r&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;r&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;alpha&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;Ap&lt;/span&gt;
&lt;a id="rest_code_e85a9b9b658c40469b00e77a9c26e566-14" name="rest_code_e85a9b9b658c40469b00e77a9c26e566-14" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_e85a9b9b658c40469b00e77a9c26e566-14"&gt;&lt;/a&gt;        &lt;span class="n"&gt;rsq_new&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;dot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_e85a9b9b658c40469b00e77a9c26e566-15" name="rest_code_e85a9b9b658c40469b00e77a9c26e566-15" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_e85a9b9b658c40469b00e77a9c26e566-15"&gt;&lt;/a&gt;        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sqrt&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;rsq_new&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;tol&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a id="rest_code_e85a9b9b658c40469b00e77a9c26e566-16" name="rest_code_e85a9b9b658c40469b00e77a9c26e566-16" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_e85a9b9b658c40469b00e77a9c26e566-16"&gt;&lt;/a&gt;            &lt;span class="k"&gt;break&lt;/span&gt;
&lt;a id="rest_code_e85a9b9b658c40469b00e77a9c26e566-17" name="rest_code_e85a9b9b658c40469b00e77a9c26e566-17" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_e85a9b9b658c40469b00e77a9c26e566-17"&gt;&lt;/a&gt;        &lt;span class="n"&gt;p&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;r&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;rsq_new&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="n"&gt;rsq_old&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;p&lt;/span&gt;
&lt;a id="rest_code_e85a9b9b658c40469b00e77a9c26e566-18" name="rest_code_e85a9b9b658c40469b00e77a9c26e566-18" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_e85a9b9b658c40469b00e77a9c26e566-18"&gt;&lt;/a&gt;        &lt;span class="n"&gt;rsq_old&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;rsq_new&lt;/span&gt;
&lt;a id="rest_code_e85a9b9b658c40469b00e77a9c26e566-19" name="rest_code_e85a9b9b658c40469b00e77a9c26e566-19" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_e85a9b9b658c40469b00e77a9c26e566-19"&gt;&lt;/a&gt;    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;cont&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sqrt&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;rsq_new&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_e85a9b9b658c40469b00e77a9c26e566-20" name="rest_code_e85a9b9b658c40469b00e77a9c26e566-20" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_e85a9b9b658c40469b00e77a9c26e566-20"&gt;&lt;/a&gt;
&lt;a id="rest_code_e85a9b9b658c40469b00e77a9c26e566-21" name="rest_code_e85a9b9b658c40469b00e77a9c26e566-21" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_e85a9b9b658c40469b00e77a9c26e566-21"&gt;&lt;/a&gt;
&lt;a id="rest_code_e85a9b9b658c40469b00e77a9c26e566-22" name="rest_code_e85a9b9b658c40469b00e77a9c26e566-22" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_e85a9b9b658c40469b00e77a9c26e566-22"&gt;&lt;/a&gt;&lt;span class="n"&gt;N&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;1000&lt;/span&gt;
&lt;a id="rest_code_e85a9b9b658c40469b00e77a9c26e566-23" name="rest_code_e85a9b9b658c40469b00e77a9c26e566-23" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_e85a9b9b658c40469b00e77a9c26e566-23"&gt;&lt;/a&gt;&lt;span class="n"&gt;A&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;diag&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ones&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;diag&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ones&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt;\
&lt;a id="rest_code_e85a9b9b658c40469b00e77a9c26e566-24" name="rest_code_e85a9b9b658c40469b00e77a9c26e566-24" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_e85a9b9b658c40469b00e77a9c26e566-24"&gt;&lt;/a&gt;    &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;diag&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ones&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_e85a9b9b658c40469b00e77a9c26e566-25" name="rest_code_e85a9b9b658c40469b00e77a9c26e566-25" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_e85a9b9b658c40469b00e77a9c26e566-25"&gt;&lt;/a&gt;&lt;span class="n"&gt;b&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ones&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_e85a9b9b658c40469b00e77a9c26e566-26" name="rest_code_e85a9b9b658c40469b00e77a9c26e566-26" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_e85a9b9b658c40469b00e77a9c26e566-26"&gt;&lt;/a&gt;&lt;span class="n"&gt;x0&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ones&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_e85a9b9b658c40469b00e77a9c26e566-27" name="rest_code_e85a9b9b658c40469b00e77a9c26e566-27" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_e85a9b9b658c40469b00e77a9c26e566-27"&gt;&lt;/a&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;niter&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;accu&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;conj_grad&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;x0&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/section&gt;
&lt;section id="julia"&gt;
&lt;h3&gt;Julia&lt;/h3&gt;
&lt;div class="code"&gt;&lt;pre class="code julia"&gt;&lt;a id="rest_code_bc76159ab3f9445bb8aa3f7ed78d1621-1" name="rest_code_bc76159ab3f9445bb8aa3f7ed78d1621-1" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_bc76159ab3f9445bb8aa3f7ed78d1621-1"&gt;&lt;/a&gt;&lt;span class="k"&gt;function&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;conj_grad&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;tol&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mf"&gt;1e-8&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_bc76159ab3f9445bb8aa3f7ed78d1621-2" name="rest_code_bc76159ab3f9445bb8aa3f7ed78d1621-2" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_bc76159ab3f9445bb8aa3f7ed78d1621-2"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_bc76159ab3f9445bb8aa3f7ed78d1621-3" name="rest_code_bc76159ab3f9445bb8aa3f7ed78d1621-3" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_bc76159ab3f9445bb8aa3f7ed78d1621-3"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_bc76159ab3f9445bb8aa3f7ed78d1621-4" name="rest_code_bc76159ab3f9445bb8aa3f7ed78d1621-4" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_bc76159ab3f9445bb8aa3f7ed78d1621-4"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;rsq_old&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;dot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_bc76159ab3f9445bb8aa3f7ed78d1621-5" name="rest_code_bc76159ab3f9445bb8aa3f7ed78d1621-5" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_bc76159ab3f9445bb8aa3f7ed78d1621-5"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;niter&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_bc76159ab3f9445bb8aa3f7ed78d1621-6" name="rest_code_bc76159ab3f9445bb8aa3f7ed78d1621-6" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_bc76159ab3f9445bb8aa3f7ed78d1621-6"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;for&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;cont&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="n"&gt;length&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_bc76159ab3f9445bb8aa3f7ed78d1621-7" name="rest_code_bc76159ab3f9445bb8aa3f7ed78d1621-7" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_bc76159ab3f9445bb8aa3f7ed78d1621-7"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;Ap&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_bc76159ab3f9445bb8aa3f7ed78d1621-8" name="rest_code_bc76159ab3f9445bb8aa3f7ed78d1621-8" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_bc76159ab3f9445bb8aa3f7ed78d1621-8"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;alpha&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;rsq_old&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;dot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Ap&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_bc76159ab3f9445bb8aa3f7ed78d1621-9" name="rest_code_bc76159ab3f9445bb8aa3f7ed78d1621-9" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_bc76159ab3f9445bb8aa3f7ed78d1621-9"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;alpha&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_bc76159ab3f9445bb8aa3f7ed78d1621-10" name="rest_code_bc76159ab3f9445bb8aa3f7ed78d1621-10" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_bc76159ab3f9445bb8aa3f7ed78d1621-10"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;alpha&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;Ap&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_bc76159ab3f9445bb8aa3f7ed78d1621-11" name="rest_code_bc76159ab3f9445bb8aa3f7ed78d1621-11" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_bc76159ab3f9445bb8aa3f7ed78d1621-11"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;rsq_new&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;dot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_bc76159ab3f9445bb8aa3f7ed78d1621-12" name="rest_code_bc76159ab3f9445bb8aa3f7ed78d1621-12" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_bc76159ab3f9445bb8aa3f7ed78d1621-12"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;sqrt&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;rsq_new&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;tol&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_bc76159ab3f9445bb8aa3f7ed78d1621-13" name="rest_code_bc76159ab3f9445bb8aa3f7ed78d1621-13" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_bc76159ab3f9445bb8aa3f7ed78d1621-13"&gt;&lt;/a&gt;&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="k"&gt;break&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_bc76159ab3f9445bb8aa3f7ed78d1621-14" name="rest_code_bc76159ab3f9445bb8aa3f7ed78d1621-14" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_bc76159ab3f9445bb8aa3f7ed78d1621-14"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="k"&gt;end&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_bc76159ab3f9445bb8aa3f7ed78d1621-15" name="rest_code_bc76159ab3f9445bb8aa3f7ed78d1621-15" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_bc76159ab3f9445bb8aa3f7ed78d1621-15"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;rsq_new&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;rsq_old&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_bc76159ab3f9445bb8aa3f7ed78d1621-16" name="rest_code_bc76159ab3f9445bb8aa3f7ed78d1621-16" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_bc76159ab3f9445bb8aa3f7ed78d1621-16"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;rsq_old&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;rsq_new&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_bc76159ab3f9445bb8aa3f7ed78d1621-17" name="rest_code_bc76159ab3f9445bb8aa3f7ed78d1621-17" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_bc76159ab3f9445bb8aa3f7ed78d1621-17"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;niter&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_bc76159ab3f9445bb8aa3f7ed78d1621-18" name="rest_code_bc76159ab3f9445bb8aa3f7ed78d1621-18" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_bc76159ab3f9445bb8aa3f7ed78d1621-18"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;end&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_bc76159ab3f9445bb8aa3f7ed78d1621-19" name="rest_code_bc76159ab3f9445bb8aa3f7ed78d1621-19" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_bc76159ab3f9445bb8aa3f7ed78d1621-19"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;return&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;niter&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;norm&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_bc76159ab3f9445bb8aa3f7ed78d1621-20" name="rest_code_bc76159ab3f9445bb8aa3f7ed78d1621-20" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_bc76159ab3f9445bb8aa3f7ed78d1621-20"&gt;&lt;/a&gt;&lt;span class="k"&gt;end&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_bc76159ab3f9445bb8aa3f7ed78d1621-21" name="rest_code_bc76159ab3f9445bb8aa3f7ed78d1621-21" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_bc76159ab3f9445bb8aa3f7ed78d1621-21"&gt;&lt;/a&gt;
&lt;a id="rest_code_bc76159ab3f9445bb8aa3f7ed78d1621-22" name="rest_code_bc76159ab3f9445bb8aa3f7ed78d1621-22" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_bc76159ab3f9445bb8aa3f7ed78d1621-22"&gt;&lt;/a&gt;
&lt;a id="rest_code_bc76159ab3f9445bb8aa3f7ed78d1621-23" name="rest_code_bc76159ab3f9445bb8aa3f7ed78d1621-23" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_bc76159ab3f9445bb8aa3f7ed78d1621-23"&gt;&lt;/a&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1000&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_bc76159ab3f9445bb8aa3f7ed78d1621-24" name="rest_code_bc76159ab3f9445bb8aa3f7ed78d1621-24" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_bc76159ab3f9445bb8aa3f7ed78d1621-24"&gt;&lt;/a&gt;&lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;diagm&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;ones&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;diagm&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ones&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;diagm&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ones&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_bc76159ab3f9445bb8aa3f7ed78d1621-25" name="rest_code_bc76159ab3f9445bb8aa3f7ed78d1621-25" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_bc76159ab3f9445bb8aa3f7ed78d1621-25"&gt;&lt;/a&gt;&lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ones&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_bc76159ab3f9445bb8aa3f7ed78d1621-26" name="rest_code_bc76159ab3f9445bb8aa3f7ed78d1621-26" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_bc76159ab3f9445bb8aa3f7ed78d1621-26"&gt;&lt;/a&gt;&lt;span class="n"&gt;x0&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ones&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_bc76159ab3f9445bb8aa3f7ed78d1621-27" name="rest_code_bc76159ab3f9445bb8aa3f7ed78d1621-27" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_bc76159ab3f9445bb8aa3f7ed78d1621-27"&gt;&lt;/a&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;niter&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;accu&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;conj_grad&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;x0&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;In this case, we are testing the method with a matrix that comes from
the discretization of the second order derivative using finite differences.&lt;/p&gt;
&lt;/section&gt;
&lt;section id="comparison-python-julia"&gt;
&lt;h3&gt;Comparison Python/Julia&lt;/h3&gt;
&lt;p&gt;Regarding number of lines we have: 27 in Python and 27 in Julia. The comparison
in execution time is done with &lt;code class="docutils literal"&gt;%timeit&lt;/code&gt; magic command in IPython and
&lt;code class="docutils literal"&gt;@benchmark&lt;/code&gt; in Julia.&lt;/p&gt;
&lt;p&gt;For Python:&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code IPython"&gt;&lt;a id="rest_code_49bf517fa0fe44f6866dc7e109f94aed-1" name="rest_code_49bf517fa0fe44f6866dc7e109f94aed-1" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_49bf517fa0fe44f6866dc7e109f94aed-1"&gt;&lt;/a&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="k"&gt;timeit&lt;/span&gt; conj_grad(A, b, x0)
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;with result&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code text"&gt;&lt;a id="rest_code_3ca713f4812b46a385f2d5ec445c9d06-1" name="rest_code_3ca713f4812b46a385f2d5ec445c9d06-1" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_3ca713f4812b46a385f2d5ec445c9d06-1"&gt;&lt;/a&gt;10 loops, best of 3: 107 ms per loop
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;For Julia:&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code julia"&gt;&lt;a id="rest_code_990fa11766974b7aa664ce0934448e33-1" name="rest_code_990fa11766974b7aa664ce0934448e33-1" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_990fa11766974b7aa664ce0934448e33-1"&gt;&lt;/a&gt;&lt;span class="nd"&gt;@benchmark&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;conj_grad&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;x0&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;with result&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code julia"&gt;&lt;a id="rest_code_07a949a04f4d468fa0aebb6f5f63e51e-1" name="rest_code_07a949a04f4d468fa0aebb6f5f63e51e-1" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_07a949a04f4d468fa0aebb6f5f63e51e-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;BenchmarkTools&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Trial&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_07a949a04f4d468fa0aebb6f5f63e51e-2" name="rest_code_07a949a04f4d468fa0aebb6f5f63e51e-2" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_07a949a04f4d468fa0aebb6f5f63e51e-2"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;memory&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;estimate&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="mf"&gt;27.13&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;MiB&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_07a949a04f4d468fa0aebb6f5f63e51e-3" name="rest_code_07a949a04f4d468fa0aebb6f5f63e51e-3" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_07a949a04f4d468fa0aebb6f5f63e51e-3"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;allocs&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;estimate&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="mi"&gt;3501&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_07a949a04f4d468fa0aebb6f5f63e51e-4" name="rest_code_07a949a04f4d468fa0aebb6f5f63e51e-4" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_07a949a04f4d468fa0aebb6f5f63e51e-4"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="o"&gt;--------------&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_07a949a04f4d468fa0aebb6f5f63e51e-5" name="rest_code_07a949a04f4d468fa0aebb6f5f63e51e-5" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_07a949a04f4d468fa0aebb6f5f63e51e-5"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;minimum&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;     &lt;/span&gt;&lt;span class="mf"&gt;128.477&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ms&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;0.54&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;GC&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_07a949a04f4d468fa0aebb6f5f63e51e-6" name="rest_code_07a949a04f4d468fa0aebb6f5f63e51e-6" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_07a949a04f4d468fa0aebb6f5f63e51e-6"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;median&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="mf"&gt;294.407&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ms&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;0.24&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;GC&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_07a949a04f4d468fa0aebb6f5f63e51e-7" name="rest_code_07a949a04f4d468fa0aebb6f5f63e51e-7" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_07a949a04f4d468fa0aebb6f5f63e51e-7"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;mean&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="mf"&gt;298.208&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ms&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;0.30&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;GC&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_07a949a04f4d468fa0aebb6f5f63e51e-8" name="rest_code_07a949a04f4d468fa0aebb6f5f63e51e-8" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_07a949a04f4d468fa0aebb6f5f63e51e-8"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;maximum&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;     &lt;/span&gt;&lt;span class="mf"&gt;464.223&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ms&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;0.30&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;GC&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_07a949a04f4d468fa0aebb6f5f63e51e-9" name="rest_code_07a949a04f4d468fa0aebb6f5f63e51e-9" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_07a949a04f4d468fa0aebb6f5f63e51e-9"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="o"&gt;--------------&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_07a949a04f4d468fa0aebb6f5f63e51e-10" name="rest_code_07a949a04f4d468fa0aebb6f5f63e51e-10" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_07a949a04f4d468fa0aebb6f5f63e51e-10"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;samples&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;          &lt;/span&gt;&lt;span class="mi"&gt;17&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_07a949a04f4d468fa0aebb6f5f63e51e-11" name="rest_code_07a949a04f4d468fa0aebb6f5f63e51e-11" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_07a949a04f4d468fa0aebb6f5f63e51e-11"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;evals&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;sample&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;     &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;In this case, we can say that the Python code is roughly 2 times faster than
Julia code.&lt;/p&gt;
&lt;/section&gt;
&lt;/section&gt;</description><category>conjugate gradient</category><category>julia</category><category>numerical methods</category><category>python</category><category>scientific computing</category><guid>https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/</guid><pubDate>Tue, 31 Oct 2017 00:38:03 GMT</pubDate></item><item><title>Numerical methods challenge: Day 29</title><link>https://nicoguaro.github.io/posts/numerical_challenge/numerical-29/</link><dc:creator>Nicolás Guarín-Zapata</dc:creator><description>&lt;p&gt;During October (2017) I will write a program per day for some well-known
numerical methods in both Python and Julia. It is intended to be an exercise
then don't expect the code to be good enough for real use. Also,
I should mention that I have almost no experience with Julia, so it
probably won't be idiomatic Julia but more Python-like Julia.&lt;/p&gt;
&lt;section id="cholesky-decomposition"&gt;
&lt;h2&gt;Cholesky decomposition&lt;/h2&gt;
&lt;p&gt;Today we have &lt;a class="reference external" href="https://en.wikipedia.org/wiki/Cholesky_decomposition"&gt;Cholesky decomposition&lt;/a&gt;.
It is a factorization of a Hermitian, positive-definite matrix into
a lower and upper matrix, the main difference with LU decomposition
is that it the lower matrix is the Hermitian transpose of the upper one.&lt;/p&gt;
&lt;p&gt;Following are the codes&lt;/p&gt;
&lt;section id="python"&gt;
&lt;h3&gt;Python&lt;/h3&gt;
&lt;div class="code"&gt;&lt;pre class="code python"&gt;&lt;a id="rest_code_c4632d7a0b944686bd9b9139b05023ef-1" name="rest_code_c4632d7a0b944686bd9b9139b05023ef-1" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-29/#rest_code_c4632d7a0b944686bd9b9139b05023ef-1"&gt;&lt;/a&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;__future__&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;division&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;print_function&lt;/span&gt;
&lt;a id="rest_code_c4632d7a0b944686bd9b9139b05023ef-2" name="rest_code_c4632d7a0b944686bd9b9139b05023ef-2" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-29/#rest_code_c4632d7a0b944686bd9b9139b05023ef-2"&gt;&lt;/a&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;numpy&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;np&lt;/span&gt;
&lt;a id="rest_code_c4632d7a0b944686bd9b9139b05023ef-3" name="rest_code_c4632d7a0b944686bd9b9139b05023ef-3" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-29/#rest_code_c4632d7a0b944686bd9b9139b05023ef-3"&gt;&lt;/a&gt;
&lt;a id="rest_code_c4632d7a0b944686bd9b9139b05023ef-4" name="rest_code_c4632d7a0b944686bd9b9139b05023ef-4" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-29/#rest_code_c4632d7a0b944686bd9b9139b05023ef-4"&gt;&lt;/a&gt;
&lt;a id="rest_code_c4632d7a0b944686bd9b9139b05023ef-5" name="rest_code_c4632d7a0b944686bd9b9139b05023ef-5" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-29/#rest_code_c4632d7a0b944686bd9b9139b05023ef-5"&gt;&lt;/a&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;cholesky&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;mat&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_c4632d7a0b944686bd9b9139b05023ef-6" name="rest_code_c4632d7a0b944686bd9b9139b05023ef-6" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-29/#rest_code_c4632d7a0b944686bd9b9139b05023ef-6"&gt;&lt;/a&gt;    &lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;_&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;mat&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;shape&lt;/span&gt;
&lt;a id="rest_code_c4632d7a0b944686bd9b9139b05023ef-7" name="rest_code_c4632d7a0b944686bd9b9139b05023ef-7" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-29/#rest_code_c4632d7a0b944686bd9b9139b05023ef-7"&gt;&lt;/a&gt;    &lt;span class="n"&gt;mat&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;mat&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;copy&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a id="rest_code_c4632d7a0b944686bd9b9139b05023ef-8" name="rest_code_c4632d7a0b944686bd9b9139b05023ef-8" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-29/#rest_code_c4632d7a0b944686bd9b9139b05023ef-8"&gt;&lt;/a&gt;    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;col&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_c4632d7a0b944686bd9b9139b05023ef-9" name="rest_code_c4632d7a0b944686bd9b9139b05023ef-9" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-29/#rest_code_c4632d7a0b944686bd9b9139b05023ef-9"&gt;&lt;/a&gt;        &lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;mat&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;
&lt;a id="rest_code_c4632d7a0b944686bd9b9139b05023ef-10" name="rest_code_c4632d7a0b944686bd9b9139b05023ef-10" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-29/#rest_code_c4632d7a0b944686bd9b9139b05023ef-10"&gt;&lt;/a&gt;               &lt;span class="n"&gt;mat&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;dot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;mat&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="p"&gt;]))&lt;/span&gt;
&lt;a id="rest_code_c4632d7a0b944686bd9b9139b05023ef-11" name="rest_code_c4632d7a0b944686bd9b9139b05023ef-11" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-29/#rest_code_c4632d7a0b944686bd9b9139b05023ef-11"&gt;&lt;/a&gt;        &lt;span class="n"&gt;mat&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sqrt&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;mat&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;
&lt;a id="rest_code_c4632d7a0b944686bd9b9139b05023ef-12" name="rest_code_c4632d7a0b944686bd9b9139b05023ef-12" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-29/#rest_code_c4632d7a0b944686bd9b9139b05023ef-12"&gt;&lt;/a&gt;               &lt;span class="n"&gt;mat&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;dot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;mat&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="p"&gt;]))&lt;/span&gt;
&lt;a id="rest_code_c4632d7a0b944686bd9b9139b05023ef-13" name="rest_code_c4632d7a0b944686bd9b9139b05023ef-13" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-29/#rest_code_c4632d7a0b944686bd9b9139b05023ef-13"&gt;&lt;/a&gt;        &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;row&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;col&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_c4632d7a0b944686bd9b9139b05023ef-14" name="rest_code_c4632d7a0b944686bd9b9139b05023ef-14" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-29/#rest_code_c4632d7a0b944686bd9b9139b05023ef-14"&gt;&lt;/a&gt;            &lt;span class="n"&gt;mat&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;row&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;mat&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;row&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;
&lt;a id="rest_code_c4632d7a0b944686bd9b9139b05023ef-15" name="rest_code_c4632d7a0b944686bd9b9139b05023ef-15" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-29/#rest_code_c4632d7a0b944686bd9b9139b05023ef-15"&gt;&lt;/a&gt;               &lt;span class="n"&gt;mat&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;row&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;dot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;mat&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="p"&gt;]))&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;mat&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_c4632d7a0b944686bd9b9139b05023ef-16" name="rest_code_c4632d7a0b944686bd9b9139b05023ef-16" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-29/#rest_code_c4632d7a0b944686bd9b9139b05023ef-16"&gt;&lt;/a&gt;    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;row&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_c4632d7a0b944686bd9b9139b05023ef-17" name="rest_code_c4632d7a0b944686bd9b9139b05023ef-17" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-29/#rest_code_c4632d7a0b944686bd9b9139b05023ef-17"&gt;&lt;/a&gt;        &lt;span class="n"&gt;mat&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="n"&gt;row&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;row&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;
&lt;a id="rest_code_c4632d7a0b944686bd9b9139b05023ef-18" name="rest_code_c4632d7a0b944686bd9b9139b05023ef-18" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-29/#rest_code_c4632d7a0b944686bd9b9139b05023ef-18"&gt;&lt;/a&gt;    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;mat&lt;/span&gt;
&lt;a id="rest_code_c4632d7a0b944686bd9b9139b05023ef-19" name="rest_code_c4632d7a0b944686bd9b9139b05023ef-19" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-29/#rest_code_c4632d7a0b944686bd9b9139b05023ef-19"&gt;&lt;/a&gt;
&lt;a id="rest_code_c4632d7a0b944686bd9b9139b05023ef-20" name="rest_code_c4632d7a0b944686bd9b9139b05023ef-20" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-29/#rest_code_c4632d7a0b944686bd9b9139b05023ef-20"&gt;&lt;/a&gt;
&lt;a id="rest_code_c4632d7a0b944686bd9b9139b05023ef-21" name="rest_code_c4632d7a0b944686bd9b9139b05023ef-21" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-29/#rest_code_c4632d7a0b944686bd9b9139b05023ef-21"&gt;&lt;/a&gt;&lt;span class="n"&gt;A&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;
&lt;a id="rest_code_c4632d7a0b944686bd9b9139b05023ef-22" name="rest_code_c4632d7a0b944686bd9b9139b05023ef-22" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-29/#rest_code_c4632d7a0b944686bd9b9139b05023ef-22"&gt;&lt;/a&gt;    &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;
&lt;a id="rest_code_c4632d7a0b944686bd9b9139b05023ef-23" name="rest_code_c4632d7a0b944686bd9b9139b05023ef-23" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-29/#rest_code_c4632d7a0b944686bd9b9139b05023ef-23"&gt;&lt;/a&gt;    &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;4.25&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;2.75&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;
&lt;a id="rest_code_c4632d7a0b944686bd9b9139b05023ef-24" name="rest_code_c4632d7a0b944686bd9b9139b05023ef-24" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-29/#rest_code_c4632d7a0b944686bd9b9139b05023ef-24"&gt;&lt;/a&gt;    &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;2.75&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;3.5&lt;/span&gt;&lt;span class="p"&gt;]],&lt;/span&gt; &lt;span class="n"&gt;dtype&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nb"&gt;float&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_c4632d7a0b944686bd9b9139b05023ef-25" name="rest_code_c4632d7a0b944686bd9b9139b05023ef-25" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-29/#rest_code_c4632d7a0b944686bd9b9139b05023ef-25"&gt;&lt;/a&gt;&lt;span class="n"&gt;B&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;cholesky&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/section&gt;
&lt;section id="julia"&gt;
&lt;h3&gt;Julia&lt;/h3&gt;
&lt;div class="code"&gt;&lt;pre class="code julia"&gt;&lt;a id="rest_code_e916473fa6ed470d8ecf250a2079cad0-1" name="rest_code_e916473fa6ed470d8ecf250a2079cad0-1" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-29/#rest_code_e916473fa6ed470d8ecf250a2079cad0-1"&gt;&lt;/a&gt;&lt;span class="k"&gt;function&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;cholesky&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;mat&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_e916473fa6ed470d8ecf250a2079cad0-2" name="rest_code_e916473fa6ed470d8ecf250a2079cad0-2" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-29/#rest_code_e916473fa6ed470d8ecf250a2079cad0-2"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;_&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;size&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;mat&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_e916473fa6ed470d8ecf250a2079cad0-3" name="rest_code_e916473fa6ed470d8ecf250a2079cad0-3" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-29/#rest_code_e916473fa6ed470d8ecf250a2079cad0-3"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;mat&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;copy&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;mat&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_e916473fa6ed470d8ecf250a2079cad0-4" name="rest_code_e916473fa6ed470d8ecf250a2079cad0-4" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-29/#rest_code_e916473fa6ed470d8ecf250a2079cad0-4"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;for&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_e916473fa6ed470d8ecf250a2079cad0-5" name="rest_code_e916473fa6ed470d8ecf250a2079cad0-5" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-29/#rest_code_e916473fa6ed470d8ecf250a2079cad0-5"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;mat&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;sqrt&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;mat&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_e916473fa6ed470d8ecf250a2079cad0-6" name="rest_code_e916473fa6ed470d8ecf250a2079cad0-6" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-29/#rest_code_e916473fa6ed470d8ecf250a2079cad0-6"&gt;&lt;/a&gt;&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="n"&gt;dot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;mat&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;mat&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]))&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_e916473fa6ed470d8ecf250a2079cad0-7" name="rest_code_e916473fa6ed470d8ecf250a2079cad0-7" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-29/#rest_code_e916473fa6ed470d8ecf250a2079cad0-7"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="k"&gt;for&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;row&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_e916473fa6ed470d8ecf250a2079cad0-8" name="rest_code_e916473fa6ed470d8ecf250a2079cad0-8" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-29/#rest_code_e916473fa6ed470d8ecf250a2079cad0-8"&gt;&lt;/a&gt;&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="n"&gt;mat&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;row&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;mat&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;row&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_e916473fa6ed470d8ecf250a2079cad0-9" name="rest_code_e916473fa6ed470d8ecf250a2079cad0-9" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-29/#rest_code_e916473fa6ed470d8ecf250a2079cad0-9"&gt;&lt;/a&gt;&lt;span class="w"&gt;               &lt;/span&gt;&lt;span class="n"&gt;dot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;mat&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;row&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;mat&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]))&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;mat&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_e916473fa6ed470d8ecf250a2079cad0-10" name="rest_code_e916473fa6ed470d8ecf250a2079cad0-10" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-29/#rest_code_e916473fa6ed470d8ecf250a2079cad0-10"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="k"&gt;end&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_e916473fa6ed470d8ecf250a2079cad0-11" name="rest_code_e916473fa6ed470d8ecf250a2079cad0-11" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-29/#rest_code_e916473fa6ed470d8ecf250a2079cad0-11"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;end&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_e916473fa6ed470d8ecf250a2079cad0-12" name="rest_code_e916473fa6ed470d8ecf250a2079cad0-12" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-29/#rest_code_e916473fa6ed470d8ecf250a2079cad0-12"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;for&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;row&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_e916473fa6ed470d8ecf250a2079cad0-13" name="rest_code_e916473fa6ed470d8ecf250a2079cad0-13" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-29/#rest_code_e916473fa6ed470d8ecf250a2079cad0-13"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;mat&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="n"&gt;row&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;row&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_e916473fa6ed470d8ecf250a2079cad0-14" name="rest_code_e916473fa6ed470d8ecf250a2079cad0-14" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-29/#rest_code_e916473fa6ed470d8ecf250a2079cad0-14"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;end&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_e916473fa6ed470d8ecf250a2079cad0-15" name="rest_code_e916473fa6ed470d8ecf250a2079cad0-15" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-29/#rest_code_e916473fa6ed470d8ecf250a2079cad0-15"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;return&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;mat&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_e916473fa6ed470d8ecf250a2079cad0-16" name="rest_code_e916473fa6ed470d8ecf250a2079cad0-16" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-29/#rest_code_e916473fa6ed470d8ecf250a2079cad0-16"&gt;&lt;/a&gt;&lt;span class="k"&gt;end&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_e916473fa6ed470d8ecf250a2079cad0-17" name="rest_code_e916473fa6ed470d8ecf250a2079cad0-17" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-29/#rest_code_e916473fa6ed470d8ecf250a2079cad0-17"&gt;&lt;/a&gt;
&lt;a id="rest_code_e916473fa6ed470d8ecf250a2079cad0-18" name="rest_code_e916473fa6ed470d8ecf250a2079cad0-18" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-29/#rest_code_e916473fa6ed470d8ecf250a2079cad0-18"&gt;&lt;/a&gt;
&lt;a id="rest_code_e916473fa6ed470d8ecf250a2079cad0-19" name="rest_code_e916473fa6ed470d8ecf250a2079cad0-19" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-29/#rest_code_e916473fa6ed470d8ecf250a2079cad0-19"&gt;&lt;/a&gt;&lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_e916473fa6ed470d8ecf250a2079cad0-20" name="rest_code_e916473fa6ed470d8ecf250a2079cad0-20" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-29/#rest_code_e916473fa6ed470d8ecf250a2079cad0-20"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;4.25&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;2.75&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_e916473fa6ed470d8ecf250a2079cad0-21" name="rest_code_e916473fa6ed470d8ecf250a2079cad0-21" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-29/#rest_code_e916473fa6ed470d8ecf250a2079cad0-21"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;2.75&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;3.5&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_e916473fa6ed470d8ecf250a2079cad0-22" name="rest_code_e916473fa6ed470d8ecf250a2079cad0-22" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-29/#rest_code_e916473fa6ed470d8ecf250a2079cad0-22"&gt;&lt;/a&gt;&lt;span class="n"&gt;B&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;cholesky&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;As an example we have the matrix&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
A = \begin{bmatrix}
     4 &amp;amp;-1 &amp;amp;1\\
    -1 &amp;amp;4.25 &amp;amp;2.75\\
     1 &amp;amp;2.75 &amp;amp;3.5
    \end{bmatrix}
\end{equation*}
&lt;/div&gt;
&lt;p&gt;And, the answer of both codes is&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code text"&gt;&lt;a id="rest_code_cfba754240da49378cb66d30e4f0a3da-1" name="rest_code_cfba754240da49378cb66d30e4f0a3da-1" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-29/#rest_code_cfba754240da49378cb66d30e4f0a3da-1"&gt;&lt;/a&gt;2.0  0.0  0.0
&lt;a id="rest_code_cfba754240da49378cb66d30e4f0a3da-2" name="rest_code_cfba754240da49378cb66d30e4f0a3da-2" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-29/#rest_code_cfba754240da49378cb66d30e4f0a3da-2"&gt;&lt;/a&gt;-0.5  2.0  0.0
&lt;a id="rest_code_cfba754240da49378cb66d30e4f0a3da-3" name="rest_code_cfba754240da49378cb66d30e4f0a3da-3" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-29/#rest_code_cfba754240da49378cb66d30e4f0a3da-3"&gt;&lt;/a&gt;0.5  1.5  1.0
&lt;/pre&gt;&lt;/div&gt;
&lt;/section&gt;
&lt;section id="comparison-python-julia"&gt;
&lt;h3&gt;Comparison Python/Julia&lt;/h3&gt;
&lt;p&gt;Regarding number of lines we have: 23 in Python and 22 in Julia. The comparison
in execution time is done with &lt;code class="docutils literal"&gt;%timeit&lt;/code&gt; magic command in IPython and
&lt;code class="docutils literal"&gt;@benchmark&lt;/code&gt; in Julia.&lt;/p&gt;
&lt;p&gt;For Python:&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code IPython"&gt;&lt;a id="rest_code_9c3cd3dceec044a0b8f3173a8186dce0-1" name="rest_code_9c3cd3dceec044a0b8f3173a8186dce0-1" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-29/#rest_code_9c3cd3dceec044a0b8f3173a8186dce0-1"&gt;&lt;/a&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="k"&gt;timeit&lt;/span&gt; cholesky(np.eye(100))
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;with result&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code text"&gt;&lt;a id="rest_code_de119416e8d94484bd8e485f5b667511-1" name="rest_code_de119416e8d94484bd8e485f5b667511-1" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-29/#rest_code_de119416e8d94484bd8e485f5b667511-1"&gt;&lt;/a&gt;100 loops, best of 3: 13 ms per loop
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;For Julia:&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code julia"&gt;&lt;a id="rest_code_c3d9f2c5e2d644c384b243627892539f-1" name="rest_code_c3d9f2c5e2d644c384b243627892539f-1" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-29/#rest_code_c3d9f2c5e2d644c384b243627892539f-1"&gt;&lt;/a&gt;&lt;span class="nd"&gt;@benchmark&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;cholesky&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;eye&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;100&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;with result&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code julia"&gt;&lt;a id="rest_code_4028ebf87a214c00b636a87232748699-1" name="rest_code_4028ebf87a214c00b636a87232748699-1" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-29/#rest_code_4028ebf87a214c00b636a87232748699-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;BenchmarkTools&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Trial&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_4028ebf87a214c00b636a87232748699-2" name="rest_code_4028ebf87a214c00b636a87232748699-2" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-29/#rest_code_4028ebf87a214c00b636a87232748699-2"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;memory&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;estimate&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="mf"&gt;4.01&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;MiB&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_4028ebf87a214c00b636a87232748699-3" name="rest_code_4028ebf87a214c00b636a87232748699-3" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-29/#rest_code_4028ebf87a214c00b636a87232748699-3"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;allocs&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;estimate&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="mi"&gt;20303&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_4028ebf87a214c00b636a87232748699-4" name="rest_code_4028ebf87a214c00b636a87232748699-4" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-29/#rest_code_4028ebf87a214c00b636a87232748699-4"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="o"&gt;--------------&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_4028ebf87a214c00b636a87232748699-5" name="rest_code_4028ebf87a214c00b636a87232748699-5" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-29/#rest_code_4028ebf87a214c00b636a87232748699-5"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;minimum&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;     &lt;/span&gt;&lt;span class="mf"&gt;1.010&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ms&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;0.00&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;GC&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_4028ebf87a214c00b636a87232748699-6" name="rest_code_4028ebf87a214c00b636a87232748699-6" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-29/#rest_code_4028ebf87a214c00b636a87232748699-6"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;median&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="mf"&gt;1.136&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ms&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;0.00&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;GC&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_4028ebf87a214c00b636a87232748699-7" name="rest_code_4028ebf87a214c00b636a87232748699-7" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-29/#rest_code_4028ebf87a214c00b636a87232748699-7"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;mean&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="mf"&gt;1.370&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ms&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;17.85&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;GC&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_4028ebf87a214c00b636a87232748699-8" name="rest_code_4028ebf87a214c00b636a87232748699-8" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-29/#rest_code_4028ebf87a214c00b636a87232748699-8"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;maximum&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;     &lt;/span&gt;&lt;span class="mf"&gt;4.652&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ms&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;40.37&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;GC&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_4028ebf87a214c00b636a87232748699-9" name="rest_code_4028ebf87a214c00b636a87232748699-9" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-29/#rest_code_4028ebf87a214c00b636a87232748699-9"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="o"&gt;--------------&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_4028ebf87a214c00b636a87232748699-10" name="rest_code_4028ebf87a214c00b636a87232748699-10" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-29/#rest_code_4028ebf87a214c00b636a87232748699-10"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;samples&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;          &lt;/span&gt;&lt;span class="mi"&gt;3637&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_4028ebf87a214c00b636a87232748699-11" name="rest_code_4028ebf87a214c00b636a87232748699-11" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-29/#rest_code_4028ebf87a214c00b636a87232748699-11"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;evals&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;sample&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;     &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;In this case, we can say that the Python code is roughly 10 times slower than
Julia code.&lt;/p&gt;
&lt;/section&gt;
&lt;/section&gt;</description><category>cholesky decomposition</category><category>julia</category><category>numerical methods</category><category>python</category><category>scientific computing</category><guid>https://nicoguaro.github.io/posts/numerical_challenge/numerical-29/</guid><pubDate>Mon, 30 Oct 2017 02:10:08 GMT</pubDate></item><item><title>Numerical methods challenge: Day 28</title><link>https://nicoguaro.github.io/posts/numerical_challenge/numerical-28/</link><dc:creator>Nicolás Guarín-Zapata</dc:creator><description>&lt;p&gt;During October (2017) I will write a program per day for some well-known
numerical methods in both Python and Julia. It is intended to be an exercise
then don't expect the code to be good enough for real use. Also,
I should mention that I have almost no experience with Julia, so it
probably won't be idiomatic Julia but more Python-like Julia.&lt;/p&gt;
&lt;section id="lu-factorization"&gt;
&lt;h2&gt;LU factorization&lt;/h2&gt;
&lt;p&gt;Today we have &lt;a class="reference external" href="https://en.wikipedia.org/wiki/LU_decomposition"&gt;LU decomposition&lt;/a&gt;.
That is a factorization of a matrix into a lower (L) and upper (U) matrix.
Basically it stores de steps of a Gauss elimination in matrices.&lt;/p&gt;
&lt;p&gt;Following are the codes&lt;/p&gt;
&lt;section id="python"&gt;
&lt;h3&gt;Python&lt;/h3&gt;
&lt;div class="code"&gt;&lt;pre class="code python"&gt;&lt;a id="rest_code_821689e91830437d858da28b4605d4df-1" name="rest_code_821689e91830437d858da28b4605d4df-1" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-28/#rest_code_821689e91830437d858da28b4605d4df-1"&gt;&lt;/a&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;__future__&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;division&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;print_function&lt;/span&gt;
&lt;a id="rest_code_821689e91830437d858da28b4605d4df-2" name="rest_code_821689e91830437d858da28b4605d4df-2" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-28/#rest_code_821689e91830437d858da28b4605d4df-2"&gt;&lt;/a&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;numpy&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;np&lt;/span&gt;
&lt;a id="rest_code_821689e91830437d858da28b4605d4df-3" name="rest_code_821689e91830437d858da28b4605d4df-3" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-28/#rest_code_821689e91830437d858da28b4605d4df-3"&gt;&lt;/a&gt;
&lt;a id="rest_code_821689e91830437d858da28b4605d4df-4" name="rest_code_821689e91830437d858da28b4605d4df-4" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-28/#rest_code_821689e91830437d858da28b4605d4df-4"&gt;&lt;/a&gt;
&lt;a id="rest_code_821689e91830437d858da28b4605d4df-5" name="rest_code_821689e91830437d858da28b4605d4df-5" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-28/#rest_code_821689e91830437d858da28b4605d4df-5"&gt;&lt;/a&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;LU&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;mat&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_821689e91830437d858da28b4605d4df-6" name="rest_code_821689e91830437d858da28b4605d4df-6" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-28/#rest_code_821689e91830437d858da28b4605d4df-6"&gt;&lt;/a&gt;    &lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;_&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;mat&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;shape&lt;/span&gt;
&lt;a id="rest_code_821689e91830437d858da28b4605d4df-7" name="rest_code_821689e91830437d858da28b4605d4df-7" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-28/#rest_code_821689e91830437d858da28b4605d4df-7"&gt;&lt;/a&gt;    &lt;span class="n"&gt;mat&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;mat&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;copy&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a id="rest_code_821689e91830437d858da28b4605d4df-8" name="rest_code_821689e91830437d858da28b4605d4df-8" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-28/#rest_code_821689e91830437d858da28b4605d4df-8"&gt;&lt;/a&gt;    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;col&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;m&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_821689e91830437d858da28b4605d4df-9" name="rest_code_821689e91830437d858da28b4605d4df-9" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-28/#rest_code_821689e91830437d858da28b4605d4df-9"&gt;&lt;/a&gt;        &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;row&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;col&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_821689e91830437d858da28b4605d4df-10" name="rest_code_821689e91830437d858da28b4605d4df-10" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-28/#rest_code_821689e91830437d858da28b4605d4df-10"&gt;&lt;/a&gt;            &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;mat&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;row&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;!=&lt;/span&gt; &lt;span class="mf"&gt;0.0&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a id="rest_code_821689e91830437d858da28b4605d4df-11" name="rest_code_821689e91830437d858da28b4605d4df-11" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-28/#rest_code_821689e91830437d858da28b4605d4df-11"&gt;&lt;/a&gt;                &lt;span class="n"&gt;lam&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;mat&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;row&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;mat&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_821689e91830437d858da28b4605d4df-12" name="rest_code_821689e91830437d858da28b4605d4df-12" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-28/#rest_code_821689e91830437d858da28b4605d4df-12"&gt;&lt;/a&gt;                &lt;span class="n"&gt;mat&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;row&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;col&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;mat&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;row&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;col&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;\
&lt;a id="rest_code_821689e91830437d858da28b4605d4df-13" name="rest_code_821689e91830437d858da28b4605d4df-13" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-28/#rest_code_821689e91830437d858da28b4605d4df-13"&gt;&lt;/a&gt;                                      &lt;span class="n"&gt;lam&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;mat&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;col&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_821689e91830437d858da28b4605d4df-14" name="rest_code_821689e91830437d858da28b4605d4df-14" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-28/#rest_code_821689e91830437d858da28b4605d4df-14"&gt;&lt;/a&gt;                &lt;span class="n"&gt;mat&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;row&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;lam&lt;/span&gt;
&lt;a id="rest_code_821689e91830437d858da28b4605d4df-15" name="rest_code_821689e91830437d858da28b4605d4df-15" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-28/#rest_code_821689e91830437d858da28b4605d4df-15"&gt;&lt;/a&gt;    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;mat&lt;/span&gt;
&lt;a id="rest_code_821689e91830437d858da28b4605d4df-16" name="rest_code_821689e91830437d858da28b4605d4df-16" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-28/#rest_code_821689e91830437d858da28b4605d4df-16"&gt;&lt;/a&gt;
&lt;a id="rest_code_821689e91830437d858da28b4605d4df-17" name="rest_code_821689e91830437d858da28b4605d4df-17" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-28/#rest_code_821689e91830437d858da28b4605d4df-17"&gt;&lt;/a&gt;
&lt;a id="rest_code_821689e91830437d858da28b4605d4df-18" name="rest_code_821689e91830437d858da28b4605d4df-18" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-28/#rest_code_821689e91830437d858da28b4605d4df-18"&gt;&lt;/a&gt;&lt;span class="n"&gt;A&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;
&lt;a id="rest_code_821689e91830437d858da28b4605d4df-19" name="rest_code_821689e91830437d858da28b4605d4df-19" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-28/#rest_code_821689e91830437d858da28b4605d4df-19"&gt;&lt;/a&gt;    &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;
&lt;a id="rest_code_821689e91830437d858da28b4605d4df-20" name="rest_code_821689e91830437d858da28b4605d4df-20" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-28/#rest_code_821689e91830437d858da28b4605d4df-20"&gt;&lt;/a&gt;    &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;
&lt;a id="rest_code_821689e91830437d858da28b4605d4df-21" name="rest_code_821689e91830437d858da28b4605d4df-21" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-28/#rest_code_821689e91830437d858da28b4605d4df-21"&gt;&lt;/a&gt;    &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;
&lt;a id="rest_code_821689e91830437d858da28b4605d4df-22" name="rest_code_821689e91830437d858da28b4605d4df-22" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-28/#rest_code_821689e91830437d858da28b4605d4df-22"&gt;&lt;/a&gt;    &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]],&lt;/span&gt; &lt;span class="n"&gt;dtype&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nb"&gt;float&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_821689e91830437d858da28b4605d4df-23" name="rest_code_821689e91830437d858da28b4605d4df-23" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-28/#rest_code_821689e91830437d858da28b4605d4df-23"&gt;&lt;/a&gt;&lt;span class="n"&gt;B&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;LU&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/section&gt;
&lt;section id="julia"&gt;
&lt;h3&gt;Julia&lt;/h3&gt;
&lt;div class="code"&gt;&lt;pre class="code julia"&gt;&lt;a id="rest_code_637c98a6ab5841079d84f6249a6e397b-1" name="rest_code_637c98a6ab5841079d84f6249a6e397b-1" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-28/#rest_code_637c98a6ab5841079d84f6249a6e397b-1"&gt;&lt;/a&gt;&lt;span class="k"&gt;function&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;LU&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;mat&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_637c98a6ab5841079d84f6249a6e397b-2" name="rest_code_637c98a6ab5841079d84f6249a6e397b-2" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-28/#rest_code_637c98a6ab5841079d84f6249a6e397b-2"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;_&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;size&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;mat&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_637c98a6ab5841079d84f6249a6e397b-3" name="rest_code_637c98a6ab5841079d84f6249a6e397b-3" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-28/#rest_code_637c98a6ab5841079d84f6249a6e397b-3"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;mat&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;copy&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;mat&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_637c98a6ab5841079d84f6249a6e397b-4" name="rest_code_637c98a6ab5841079d84f6249a6e397b-4" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-28/#rest_code_637c98a6ab5841079d84f6249a6e397b-4"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;for&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_637c98a6ab5841079d84f6249a6e397b-5" name="rest_code_637c98a6ab5841079d84f6249a6e397b-5" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-28/#rest_code_637c98a6ab5841079d84f6249a6e397b-5"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="k"&gt;for&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;row&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_637c98a6ab5841079d84f6249a6e397b-6" name="rest_code_637c98a6ab5841079d84f6249a6e397b-6" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-28/#rest_code_637c98a6ab5841079d84f6249a6e397b-6"&gt;&lt;/a&gt;&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;mat&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;row&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;!=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;0.0&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_637c98a6ab5841079d84f6249a6e397b-7" name="rest_code_637c98a6ab5841079d84f6249a6e397b-7" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-28/#rest_code_637c98a6ab5841079d84f6249a6e397b-7"&gt;&lt;/a&gt;&lt;span class="w"&gt;                &lt;/span&gt;&lt;span class="n"&gt;lam&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;mat&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;row&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;mat&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_637c98a6ab5841079d84f6249a6e397b-8" name="rest_code_637c98a6ab5841079d84f6249a6e397b-8" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-28/#rest_code_637c98a6ab5841079d84f6249a6e397b-8"&gt;&lt;/a&gt;&lt;span class="w"&gt;                &lt;/span&gt;&lt;span class="n"&gt;mat&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;row&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;mat&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;row&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_637c98a6ab5841079d84f6249a6e397b-9" name="rest_code_637c98a6ab5841079d84f6249a6e397b-9" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-28/#rest_code_637c98a6ab5841079d84f6249a6e397b-9"&gt;&lt;/a&gt;&lt;span class="w"&gt;                                      &lt;/span&gt;&lt;span class="n"&gt;lam&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;mat&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_637c98a6ab5841079d84f6249a6e397b-10" name="rest_code_637c98a6ab5841079d84f6249a6e397b-10" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-28/#rest_code_637c98a6ab5841079d84f6249a6e397b-10"&gt;&lt;/a&gt;&lt;span class="w"&gt;                &lt;/span&gt;&lt;span class="n"&gt;mat&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;row&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;lam&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_637c98a6ab5841079d84f6249a6e397b-11" name="rest_code_637c98a6ab5841079d84f6249a6e397b-11" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-28/#rest_code_637c98a6ab5841079d84f6249a6e397b-11"&gt;&lt;/a&gt;&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="k"&gt;end&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_637c98a6ab5841079d84f6249a6e397b-12" name="rest_code_637c98a6ab5841079d84f6249a6e397b-12" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-28/#rest_code_637c98a6ab5841079d84f6249a6e397b-12"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="k"&gt;end&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_637c98a6ab5841079d84f6249a6e397b-13" name="rest_code_637c98a6ab5841079d84f6249a6e397b-13" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-28/#rest_code_637c98a6ab5841079d84f6249a6e397b-13"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;end&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_637c98a6ab5841079d84f6249a6e397b-14" name="rest_code_637c98a6ab5841079d84f6249a6e397b-14" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-28/#rest_code_637c98a6ab5841079d84f6249a6e397b-14"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;return&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;mat&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_637c98a6ab5841079d84f6249a6e397b-15" name="rest_code_637c98a6ab5841079d84f6249a6e397b-15" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-28/#rest_code_637c98a6ab5841079d84f6249a6e397b-15"&gt;&lt;/a&gt;&lt;span class="k"&gt;end&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_637c98a6ab5841079d84f6249a6e397b-16" name="rest_code_637c98a6ab5841079d84f6249a6e397b-16" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-28/#rest_code_637c98a6ab5841079d84f6249a6e397b-16"&gt;&lt;/a&gt;
&lt;a id="rest_code_637c98a6ab5841079d84f6249a6e397b-17" name="rest_code_637c98a6ab5841079d84f6249a6e397b-17" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-28/#rest_code_637c98a6ab5841079d84f6249a6e397b-17"&gt;&lt;/a&gt;
&lt;a id="rest_code_637c98a6ab5841079d84f6249a6e397b-18" name="rest_code_637c98a6ab5841079d84f6249a6e397b-18" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-28/#rest_code_637c98a6ab5841079d84f6249a6e397b-18"&gt;&lt;/a&gt;&lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mf"&gt;1.0&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;1.0&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;0.0&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;3.0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_637c98a6ab5841079d84f6249a6e397b-19" name="rest_code_637c98a6ab5841079d84f6249a6e397b-19" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-28/#rest_code_637c98a6ab5841079d84f6249a6e397b-19"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="mf"&gt;2.0&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;1.0&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;1.0&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;1.0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_637c98a6ab5841079d84f6249a6e397b-20" name="rest_code_637c98a6ab5841079d84f6249a6e397b-20" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-28/#rest_code_637c98a6ab5841079d84f6249a6e397b-20"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="mf"&gt;3.0&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;1.0&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;1.0&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;2.0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_637c98a6ab5841079d84f6249a6e397b-21" name="rest_code_637c98a6ab5841079d84f6249a6e397b-21" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-28/#rest_code_637c98a6ab5841079d84f6249a6e397b-21"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;1.0&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;2.0&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;3.0&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;1.0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_637c98a6ab5841079d84f6249a6e397b-22" name="rest_code_637c98a6ab5841079d84f6249a6e397b-22" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-28/#rest_code_637c98a6ab5841079d84f6249a6e397b-22"&gt;&lt;/a&gt;&lt;span class="n"&gt;B&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;LU&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;As an example we have the matrix&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
A = \begin{bmatrix}
    1 &amp;amp;1 &amp;amp;0 &amp;amp;3\\
    2 &amp;amp;1 &amp;amp;-1 &amp;amp;1\\
    3 &amp;amp;-1 &amp;amp;-1 &amp;amp;2\\
    -1 &amp;amp;2 &amp;amp;3 &amp;amp;-1
    \end{bmatrix} =
    \begin{bmatrix}
    1 &amp;amp;1 &amp;amp;0 &amp;amp;0\\
    2 &amp;amp;1 &amp;amp;0 &amp;amp;0\\
    3 &amp;amp;4 &amp;amp;1 &amp;amp;2\\
    -1 &amp;amp;-3 &amp;amp;0 &amp;amp;1
    \end{bmatrix}
    \begin{bmatrix}
    1 &amp;amp;1 &amp;amp;0 &amp;amp;3\\
    0 &amp;amp;-1 &amp;amp;-1 &amp;amp;-5\\
    0 &amp;amp;0 &amp;amp;3 &amp;amp;13\\
    0 &amp;amp;0 &amp;amp;0 &amp;amp;-13
    \end{bmatrix}
\end{equation*}
&lt;/div&gt;
&lt;p&gt;And, the answer of both codes is&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code text"&gt;&lt;a id="rest_code_01276cda1ed0429bbdda51ec73707a36-1" name="rest_code_01276cda1ed0429bbdda51ec73707a36-1" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-28/#rest_code_01276cda1ed0429bbdda51ec73707a36-1"&gt;&lt;/a&gt;[[  1.,   1.,   0.,   3.],
&lt;a id="rest_code_01276cda1ed0429bbdda51ec73707a36-2" name="rest_code_01276cda1ed0429bbdda51ec73707a36-2" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-28/#rest_code_01276cda1ed0429bbdda51ec73707a36-2"&gt;&lt;/a&gt; [  2.,  -1.,  -1.,  -5.],
&lt;a id="rest_code_01276cda1ed0429bbdda51ec73707a36-3" name="rest_code_01276cda1ed0429bbdda51ec73707a36-3" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-28/#rest_code_01276cda1ed0429bbdda51ec73707a36-3"&gt;&lt;/a&gt; [  3.,   4.,   3.,  13.],
&lt;a id="rest_code_01276cda1ed0429bbdda51ec73707a36-4" name="rest_code_01276cda1ed0429bbdda51ec73707a36-4" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-28/#rest_code_01276cda1ed0429bbdda51ec73707a36-4"&gt;&lt;/a&gt; [ -1.,  -3.,   0., -13.]]
&lt;/pre&gt;&lt;/div&gt;
&lt;/section&gt;
&lt;section id="comparison-python-julia"&gt;
&lt;h3&gt;Comparison Python/Julia&lt;/h3&gt;
&lt;p&gt;Regarding number of lines we have: 23 in Python and 22 in Julia. The comparison
in execution time is done with &lt;code class="docutils literal"&gt;%timeit&lt;/code&gt; magic command in IPython and
&lt;code class="docutils literal"&gt;@benchmark&lt;/code&gt; in Julia.&lt;/p&gt;
&lt;p&gt;For Python:&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code IPython"&gt;&lt;a id="rest_code_9e5b6e95ffb840189c5119fef22127ba-1" name="rest_code_9e5b6e95ffb840189c5119fef22127ba-1" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-28/#rest_code_9e5b6e95ffb840189c5119fef22127ba-1"&gt;&lt;/a&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="k"&gt;timeit&lt;/span&gt; LU(np.random.rand(10, 10))
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;with result&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code text"&gt;&lt;a id="rest_code_8713189e9ad949848694c8454d8b7140-1" name="rest_code_8713189e9ad949848694c8454d8b7140-1" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-28/#rest_code_8713189e9ad949848694c8454d8b7140-1"&gt;&lt;/a&gt;1000 loops, best of 3: 303 µs per loop
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;For Julia:&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code julia"&gt;&lt;a id="rest_code_eda9e99490504b818840ab64163f165d-1" name="rest_code_eda9e99490504b818840ab64163f165d-1" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-28/#rest_code_eda9e99490504b818840ab64163f165d-1"&gt;&lt;/a&gt;&lt;span class="nd"&gt;@benchmark&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;LU&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;rand&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;with result&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code julia"&gt;&lt;a id="rest_code_e6bbc3c314b742efbcb08fd360f02148-1" name="rest_code_e6bbc3c314b742efbcb08fd360f02148-1" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-28/#rest_code_e6bbc3c314b742efbcb08fd360f02148-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;BenchmarkTools&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Trial&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_e6bbc3c314b742efbcb08fd360f02148-2" name="rest_code_e6bbc3c314b742efbcb08fd360f02148-2" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-28/#rest_code_e6bbc3c314b742efbcb08fd360f02148-2"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;memory&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;estimate&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="mf"&gt;29.25&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;KiB&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_e6bbc3c314b742efbcb08fd360f02148-3" name="rest_code_e6bbc3c314b742efbcb08fd360f02148-3" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-28/#rest_code_e6bbc3c314b742efbcb08fd360f02148-3"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;allocs&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;estimate&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="mi"&gt;310&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_e6bbc3c314b742efbcb08fd360f02148-4" name="rest_code_e6bbc3c314b742efbcb08fd360f02148-4" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-28/#rest_code_e6bbc3c314b742efbcb08fd360f02148-4"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="o"&gt;--------------&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_e6bbc3c314b742efbcb08fd360f02148-5" name="rest_code_e6bbc3c314b742efbcb08fd360f02148-5" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-28/#rest_code_e6bbc3c314b742efbcb08fd360f02148-5"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;minimum&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;     &lt;/span&gt;&lt;span class="mf"&gt;9.993&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;μs&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;0.00&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;GC&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_e6bbc3c314b742efbcb08fd360f02148-6" name="rest_code_e6bbc3c314b742efbcb08fd360f02148-6" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-28/#rest_code_e6bbc3c314b742efbcb08fd360f02148-6"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;median&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="mf"&gt;11.725&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;μs&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;0.00&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;GC&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_e6bbc3c314b742efbcb08fd360f02148-7" name="rest_code_e6bbc3c314b742efbcb08fd360f02148-7" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-28/#rest_code_e6bbc3c314b742efbcb08fd360f02148-7"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;mean&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="mf"&gt;14.943&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;μs&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;15.90&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;GC&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_e6bbc3c314b742efbcb08fd360f02148-8" name="rest_code_e6bbc3c314b742efbcb08fd360f02148-8" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-28/#rest_code_e6bbc3c314b742efbcb08fd360f02148-8"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;maximum&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;     &lt;/span&gt;&lt;span class="mf"&gt;3.285&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ms&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;95.64&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;GC&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_e6bbc3c314b742efbcb08fd360f02148-9" name="rest_code_e6bbc3c314b742efbcb08fd360f02148-9" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-28/#rest_code_e6bbc3c314b742efbcb08fd360f02148-9"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="o"&gt;--------------&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_e6bbc3c314b742efbcb08fd360f02148-10" name="rest_code_e6bbc3c314b742efbcb08fd360f02148-10" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-28/#rest_code_e6bbc3c314b742efbcb08fd360f02148-10"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;samples&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;          &lt;/span&gt;&lt;span class="mi"&gt;10000&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_e6bbc3c314b742efbcb08fd360f02148-11" name="rest_code_e6bbc3c314b742efbcb08fd360f02148-11" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-28/#rest_code_e6bbc3c314b742efbcb08fd360f02148-11"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;evals&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;sample&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;     &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;In this case, we can say that the Python code is roughly 30 times slower than
Julia code.&lt;/p&gt;
&lt;/section&gt;
&lt;/section&gt;</description><category>julia</category><category>lu factorization</category><category>numerical methods</category><category>python</category><category>scientific computing</category><guid>https://nicoguaro.github.io/posts/numerical_challenge/numerical-28/</guid><pubDate>Sat, 28 Oct 2017 22:02:38 GMT</pubDate></item><item><title>Numerical methods challenge: Day 27</title><link>https://nicoguaro.github.io/posts/numerical_challenge/numerical-27/</link><dc:creator>Nicolás Guarín-Zapata</dc:creator><description>&lt;p&gt;During October (2017) I will write a program per day for some well-known
numerical methods in both Python and Julia. It is intended to be an exercise
then don't expect the code to be good enough for real use. Also,
I should mention that I have almost no experience with Julia, so it
probably won't be idiomatic Julia but more Python-like Julia.&lt;/p&gt;
&lt;section id="monte-carlo-integration"&gt;
&lt;h2&gt;Monte Carlo integration&lt;/h2&gt;
&lt;p&gt;Today we have &lt;a class="reference external" href="https://en.wikipedia.org/wiki/Monte_Carlo_integration"&gt;Monte Carlo integration&lt;/a&gt;.
Where we use random sampling to numerically compute an integral. This
method is important when we want to evaluate higher-dimensional
integrals since common quadrature techniques imply an exponential
growing in the number of sampling points.&lt;/p&gt;
&lt;p&gt;The method computes an integral&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
I = \int_\Omega f(x) dx
\end{equation*}
&lt;/div&gt;
&lt;p&gt;where &lt;span class="math"&gt;\(\Omega\)&lt;/span&gt; has volume &lt;span class="math"&gt;\(V\)&lt;/span&gt;.&lt;/p&gt;
&lt;p&gt;The integral is approximated as&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
I \approx \frac{V}{N} \sum_{i=1}^{N} f(x_i)
\end{equation*}
&lt;/div&gt;
&lt;p&gt;where the &lt;span class="math"&gt;\(x_i\)&lt;/span&gt; distribute uniform over &lt;span class="math"&gt;\(\Omega\)&lt;/span&gt;.&lt;/p&gt;
&lt;p&gt;Following are the codes&lt;/p&gt;
&lt;section id="python"&gt;
&lt;h3&gt;Python&lt;/h3&gt;
&lt;div class="code"&gt;&lt;pre class="code python"&gt;&lt;a id="rest_code_5806579ccc214817a3b3b7fff7e2c56e-1" name="rest_code_5806579ccc214817a3b3b7fff7e2c56e-1" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-27/#rest_code_5806579ccc214817a3b3b7fff7e2c56e-1"&gt;&lt;/a&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;__future__&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;division&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;print_function&lt;/span&gt;
&lt;a id="rest_code_5806579ccc214817a3b3b7fff7e2c56e-2" name="rest_code_5806579ccc214817a3b3b7fff7e2c56e-2" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-27/#rest_code_5806579ccc214817a3b3b7fff7e2c56e-2"&gt;&lt;/a&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;numpy&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;np&lt;/span&gt;
&lt;a id="rest_code_5806579ccc214817a3b3b7fff7e2c56e-3" name="rest_code_5806579ccc214817a3b3b7fff7e2c56e-3" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-27/#rest_code_5806579ccc214817a3b3b7fff7e2c56e-3"&gt;&lt;/a&gt;
&lt;a id="rest_code_5806579ccc214817a3b3b7fff7e2c56e-4" name="rest_code_5806579ccc214817a3b3b7fff7e2c56e-4" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-27/#rest_code_5806579ccc214817a3b3b7fff7e2c56e-4"&gt;&lt;/a&gt;
&lt;a id="rest_code_5806579ccc214817a3b3b7fff7e2c56e-5" name="rest_code_5806579ccc214817a3b3b7fff7e2c56e-5" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-27/#rest_code_5806579ccc214817a3b3b7fff7e2c56e-5"&gt;&lt;/a&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;monte_carlo_int&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;fun&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;low&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;high&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;args&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;()):&lt;/span&gt;
&lt;a id="rest_code_5806579ccc214817a3b3b7fff7e2c56e-6" name="rest_code_5806579ccc214817a3b3b7fff7e2c56e-6" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-27/#rest_code_5806579ccc214817a3b3b7fff7e2c56e-6"&gt;&lt;/a&gt;    &lt;span class="n"&gt;ndims&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;low&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_5806579ccc214817a3b3b7fff7e2c56e-7" name="rest_code_5806579ccc214817a3b3b7fff7e2c56e-7" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-27/#rest_code_5806579ccc214817a3b3b7fff7e2c56e-7"&gt;&lt;/a&gt;    &lt;span class="n"&gt;pts&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;random&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;uniform&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;low&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;low&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;high&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;high&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;size&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;ndims&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_5806579ccc214817a3b3b7fff7e2c56e-8" name="rest_code_5806579ccc214817a3b3b7fff7e2c56e-8" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-27/#rest_code_5806579ccc214817a3b3b7fff7e2c56e-8"&gt;&lt;/a&gt;    &lt;span class="n"&gt;V&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;prod&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;asarray&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;high&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;asarray&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;low&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_5806579ccc214817a3b3b7fff7e2c56e-9" name="rest_code_5806579ccc214817a3b3b7fff7e2c56e-9" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-27/#rest_code_5806579ccc214817a3b3b7fff7e2c56e-9"&gt;&lt;/a&gt;    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;V&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sum&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;fun&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;pts&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;args&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;
&lt;a id="rest_code_5806579ccc214817a3b3b7fff7e2c56e-10" name="rest_code_5806579ccc214817a3b3b7fff7e2c56e-10" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-27/#rest_code_5806579ccc214817a3b3b7fff7e2c56e-10"&gt;&lt;/a&gt;
&lt;a id="rest_code_5806579ccc214817a3b3b7fff7e2c56e-11" name="rest_code_5806579ccc214817a3b3b7fff7e2c56e-11" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-27/#rest_code_5806579ccc214817a3b3b7fff7e2c56e-11"&gt;&lt;/a&gt;
&lt;a id="rest_code_5806579ccc214817a3b3b7fff7e2c56e-12" name="rest_code_5806579ccc214817a3b3b7fff7e2c56e-12" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-27/#rest_code_5806579ccc214817a3b3b7fff7e2c56e-12"&gt;&lt;/a&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;circ&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;rad&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_5806579ccc214817a3b3b7fff7e2c56e-13" name="rest_code_5806579ccc214817a3b3b7fff7e2c56e-13" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-27/#rest_code_5806579ccc214817a3b3b7fff7e2c56e-13"&gt;&lt;/a&gt;    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="mf"&gt;0.5&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sign&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[:,&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[:,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;rad&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_5806579ccc214817a3b3b7fff7e2c56e-14" name="rest_code_5806579ccc214817a3b3b7fff7e2c56e-14" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-27/#rest_code_5806579ccc214817a3b3b7fff7e2c56e-14"&gt;&lt;/a&gt;
&lt;a id="rest_code_5806579ccc214817a3b3b7fff7e2c56e-15" name="rest_code_5806579ccc214817a3b3b7fff7e2c56e-15" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-27/#rest_code_5806579ccc214817a3b3b7fff7e2c56e-15"&gt;&lt;/a&gt;
&lt;a id="rest_code_5806579ccc214817a3b3b7fff7e2c56e-16" name="rest_code_5806579ccc214817a3b3b7fff7e2c56e-16" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-27/#rest_code_5806579ccc214817a3b3b7fff7e2c56e-16"&gt;&lt;/a&gt;&lt;span class="n"&gt;N&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;1000000&lt;/span&gt;
&lt;a id="rest_code_5806579ccc214817a3b3b7fff7e2c56e-17" name="rest_code_5806579ccc214817a3b3b7fff7e2c56e-17" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-27/#rest_code_5806579ccc214817a3b3b7fff7e2c56e-17"&gt;&lt;/a&gt;&lt;span class="n"&gt;low&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_5806579ccc214817a3b3b7fff7e2c56e-18" name="rest_code_5806579ccc214817a3b3b7fff7e2c56e-18" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-27/#rest_code_5806579ccc214817a3b3b7fff7e2c56e-18"&gt;&lt;/a&gt;&lt;span class="n"&gt;high&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_5806579ccc214817a3b3b7fff7e2c56e-19" name="rest_code_5806579ccc214817a3b3b7fff7e2c56e-19" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-27/#rest_code_5806579ccc214817a3b3b7fff7e2c56e-19"&gt;&lt;/a&gt;&lt;span class="n"&gt;rad&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;
&lt;a id="rest_code_5806579ccc214817a3b3b7fff7e2c56e-20" name="rest_code_5806579ccc214817a3b3b7fff7e2c56e-20" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-27/#rest_code_5806579ccc214817a3b3b7fff7e2c56e-20"&gt;&lt;/a&gt;&lt;span class="n"&gt;inte&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;monte_carlo_int&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;circ&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;low&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;high&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;args&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;rad&lt;/span&gt;&lt;span class="p"&gt;,))&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/section&gt;
&lt;section id="julia"&gt;
&lt;h3&gt;Julia&lt;/h3&gt;
&lt;div class="code"&gt;&lt;pre class="code julia"&gt;&lt;a id="rest_code_29726fc06f6b41c38f8402dba83d4469-1" name="rest_code_29726fc06f6b41c38f8402dba83d4469-1" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-27/#rest_code_29726fc06f6b41c38f8402dba83d4469-1"&gt;&lt;/a&gt;&lt;span class="k"&gt;using&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Distributions&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_29726fc06f6b41c38f8402dba83d4469-2" name="rest_code_29726fc06f6b41c38f8402dba83d4469-2" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-27/#rest_code_29726fc06f6b41c38f8402dba83d4469-2"&gt;&lt;/a&gt;
&lt;a id="rest_code_29726fc06f6b41c38f8402dba83d4469-3" name="rest_code_29726fc06f6b41c38f8402dba83d4469-3" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-27/#rest_code_29726fc06f6b41c38f8402dba83d4469-3"&gt;&lt;/a&gt;
&lt;a id="rest_code_29726fc06f6b41c38f8402dba83d4469-4" name="rest_code_29726fc06f6b41c38f8402dba83d4469-4" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-27/#rest_code_29726fc06f6b41c38f8402dba83d4469-4"&gt;&lt;/a&gt;&lt;span class="k"&gt;function&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;monte_carlo_int&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;fun&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;low&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;high&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;args&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_29726fc06f6b41c38f8402dba83d4469-5" name="rest_code_29726fc06f6b41c38f8402dba83d4469-5" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-27/#rest_code_29726fc06f6b41c38f8402dba83d4469-5"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;ndims&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;length&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;low&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_29726fc06f6b41c38f8402dba83d4469-6" name="rest_code_29726fc06f6b41c38f8402dba83d4469-6" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-27/#rest_code_29726fc06f6b41c38f8402dba83d4469-6"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;pts&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;rand&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Uniform&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ndims&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_29726fc06f6b41c38f8402dba83d4469-7" name="rest_code_29726fc06f6b41c38f8402dba83d4469-7" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-27/#rest_code_29726fc06f6b41c38f8402dba83d4469-7"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;for&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;cont&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="n"&gt;ndims&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_29726fc06f6b41c38f8402dba83d4469-8" name="rest_code_29726fc06f6b41c38f8402dba83d4469-8" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-27/#rest_code_29726fc06f6b41c38f8402dba83d4469-8"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;pts&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;cont&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;pts&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;cont&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;high&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;cont&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;low&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;cont&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;low&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;cont&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_29726fc06f6b41c38f8402dba83d4469-9" name="rest_code_29726fc06f6b41c38f8402dba83d4469-9" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-27/#rest_code_29726fc06f6b41c38f8402dba83d4469-9"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;end&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_29726fc06f6b41c38f8402dba83d4469-10" name="rest_code_29726fc06f6b41c38f8402dba83d4469-10" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-27/#rest_code_29726fc06f6b41c38f8402dba83d4469-10"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;V&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;prod&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;high&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;low&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_29726fc06f6b41c38f8402dba83d4469-11" name="rest_code_29726fc06f6b41c38f8402dba83d4469-11" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-27/#rest_code_29726fc06f6b41c38f8402dba83d4469-11"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;return&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;V&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;sum&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;fun&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;pts&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;args&lt;/span&gt;&lt;span class="o"&gt;...&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_29726fc06f6b41c38f8402dba83d4469-12" name="rest_code_29726fc06f6b41c38f8402dba83d4469-12" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-27/#rest_code_29726fc06f6b41c38f8402dba83d4469-12"&gt;&lt;/a&gt;&lt;span class="k"&gt;end&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_29726fc06f6b41c38f8402dba83d4469-13" name="rest_code_29726fc06f6b41c38f8402dba83d4469-13" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-27/#rest_code_29726fc06f6b41c38f8402dba83d4469-13"&gt;&lt;/a&gt;
&lt;a id="rest_code_29726fc06f6b41c38f8402dba83d4469-14" name="rest_code_29726fc06f6b41c38f8402dba83d4469-14" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-27/#rest_code_29726fc06f6b41c38f8402dba83d4469-14"&gt;&lt;/a&gt;
&lt;a id="rest_code_29726fc06f6b41c38f8402dba83d4469-15" name="rest_code_29726fc06f6b41c38f8402dba83d4469-15" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-27/#rest_code_29726fc06f6b41c38f8402dba83d4469-15"&gt;&lt;/a&gt;&lt;span class="k"&gt;function&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;circ&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;rad&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_29726fc06f6b41c38f8402dba83d4469-16" name="rest_code_29726fc06f6b41c38f8402dba83d4469-16" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-27/#rest_code_29726fc06f6b41c38f8402dba83d4469-16"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;return&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;0.5&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;sign&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.^&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.^&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;rad&lt;/span&gt;&lt;span class="o"&gt;^&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_29726fc06f6b41c38f8402dba83d4469-17" name="rest_code_29726fc06f6b41c38f8402dba83d4469-17" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-27/#rest_code_29726fc06f6b41c38f8402dba83d4469-17"&gt;&lt;/a&gt;&lt;span class="k"&gt;end&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_29726fc06f6b41c38f8402dba83d4469-18" name="rest_code_29726fc06f6b41c38f8402dba83d4469-18" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-27/#rest_code_29726fc06f6b41c38f8402dba83d4469-18"&gt;&lt;/a&gt;
&lt;a id="rest_code_29726fc06f6b41c38f8402dba83d4469-19" name="rest_code_29726fc06f6b41c38f8402dba83d4469-19" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-27/#rest_code_29726fc06f6b41c38f8402dba83d4469-19"&gt;&lt;/a&gt;
&lt;a id="rest_code_29726fc06f6b41c38f8402dba83d4469-20" name="rest_code_29726fc06f6b41c38f8402dba83d4469-20" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-27/#rest_code_29726fc06f6b41c38f8402dba83d4469-20"&gt;&lt;/a&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1000000&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_29726fc06f6b41c38f8402dba83d4469-21" name="rest_code_29726fc06f6b41c38f8402dba83d4469-21" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-27/#rest_code_29726fc06f6b41c38f8402dba83d4469-21"&gt;&lt;/a&gt;&lt;span class="n"&gt;low&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_29726fc06f6b41c38f8402dba83d4469-22" name="rest_code_29726fc06f6b41c38f8402dba83d4469-22" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-27/#rest_code_29726fc06f6b41c38f8402dba83d4469-22"&gt;&lt;/a&gt;&lt;span class="n"&gt;high&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_29726fc06f6b41c38f8402dba83d4469-23" name="rest_code_29726fc06f6b41c38f8402dba83d4469-23" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-27/#rest_code_29726fc06f6b41c38f8402dba83d4469-23"&gt;&lt;/a&gt;&lt;span class="n"&gt;rad&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_29726fc06f6b41c38f8402dba83d4469-24" name="rest_code_29726fc06f6b41c38f8402dba83d4469-24" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-27/#rest_code_29726fc06f6b41c38f8402dba83d4469-24"&gt;&lt;/a&gt;&lt;span class="n"&gt;inte&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;monte_carlo_int&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;circ&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;low&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;high&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;args&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;rad&lt;/span&gt;&lt;span class="p"&gt;,))&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;One of the most common examples is the computation of &lt;span class="math"&gt;\(\pi\)&lt;/span&gt;, this
is illustrated in the following animation.&lt;/p&gt;
&lt;img alt="Pi approximation using Monte Carlo." class="align-center" src="https://upload.wikimedia.org/wikipedia/commons/8/84/Pi_30K.gif" style="width: 500px;"&gt;
&lt;/section&gt;
&lt;section id="comparison-python-julia"&gt;
&lt;h3&gt;Comparison Python/Julia&lt;/h3&gt;
&lt;p&gt;Regarding number of lines we have: 20 in Python and 24 in Julia. The comparison
in execution time is done with &lt;code class="docutils literal"&gt;%timeit&lt;/code&gt; magic command in IPython and
&lt;code class="docutils literal"&gt;@benchmark&lt;/code&gt; in Julia.&lt;/p&gt;
&lt;p&gt;For Python:&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code IPython"&gt;&lt;a id="rest_code_6c4ccddda814479188843af10fad1ef7-1" name="rest_code_6c4ccddda814479188843af10fad1ef7-1" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-27/#rest_code_6c4ccddda814479188843af10fad1ef7-1"&gt;&lt;/a&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="k"&gt;timeit&lt;/span&gt; monte_carlo_int(circ, N, low, high, args=(rad,))
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;with result&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code text"&gt;&lt;a id="rest_code_0aaf47d715ce493ba589d821526fd90b-1" name="rest_code_0aaf47d715ce493ba589d821526fd90b-1" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-27/#rest_code_0aaf47d715ce493ba589d821526fd90b-1"&gt;&lt;/a&gt;10 loops, best of 3: 53.2 ms per loop
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;For Julia:&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code julia"&gt;&lt;a id="rest_code_a09b3911ec10438ebfea4b3455f19099-1" name="rest_code_a09b3911ec10438ebfea4b3455f19099-1" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-27/#rest_code_a09b3911ec10438ebfea4b3455f19099-1"&gt;&lt;/a&gt;&lt;span class="nd"&gt;@benchmark&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;monte_carlo_int&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;circ&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;low&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;high&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;args&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;rad&lt;/span&gt;&lt;span class="p"&gt;,))&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;with result&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code julia"&gt;&lt;a id="rest_code_48843cf3444a42608e49d3d40e0205fd-1" name="rest_code_48843cf3444a42608e49d3d40e0205fd-1" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-27/#rest_code_48843cf3444a42608e49d3d40e0205fd-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;BenchmarkTools&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Trial&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_48843cf3444a42608e49d3d40e0205fd-2" name="rest_code_48843cf3444a42608e49d3d40e0205fd-2" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-27/#rest_code_48843cf3444a42608e49d3d40e0205fd-2"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;memory&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;estimate&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="mf"&gt;129.70&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;MiB&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_48843cf3444a42608e49d3d40e0205fd-3" name="rest_code_48843cf3444a42608e49d3d40e0205fd-3" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-27/#rest_code_48843cf3444a42608e49d3d40e0205fd-3"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;allocs&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;estimate&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="mi"&gt;46&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_48843cf3444a42608e49d3d40e0205fd-4" name="rest_code_48843cf3444a42608e49d3d40e0205fd-4" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-27/#rest_code_48843cf3444a42608e49d3d40e0205fd-4"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="o"&gt;--------------&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_48843cf3444a42608e49d3d40e0205fd-5" name="rest_code_48843cf3444a42608e49d3d40e0205fd-5" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-27/#rest_code_48843cf3444a42608e49d3d40e0205fd-5"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;minimum&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;     &lt;/span&gt;&lt;span class="mf"&gt;60.131&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ms&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;5.15&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;GC&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_48843cf3444a42608e49d3d40e0205fd-6" name="rest_code_48843cf3444a42608e49d3d40e0205fd-6" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-27/#rest_code_48843cf3444a42608e49d3d40e0205fd-6"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;median&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="mf"&gt;164.018&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ms&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;55.64&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;GC&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_48843cf3444a42608e49d3d40e0205fd-7" name="rest_code_48843cf3444a42608e49d3d40e0205fd-7" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-27/#rest_code_48843cf3444a42608e49d3d40e0205fd-7"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;mean&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="mf"&gt;204.366&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ms&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;49.50&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;GC&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_48843cf3444a42608e49d3d40e0205fd-8" name="rest_code_48843cf3444a42608e49d3d40e0205fd-8" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-27/#rest_code_48843cf3444a42608e49d3d40e0205fd-8"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;maximum&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;     &lt;/span&gt;&lt;span class="mf"&gt;357.749&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ms&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;64.04&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;GC&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_48843cf3444a42608e49d3d40e0205fd-9" name="rest_code_48843cf3444a42608e49d3d40e0205fd-9" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-27/#rest_code_48843cf3444a42608e49d3d40e0205fd-9"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="o"&gt;--------------&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_48843cf3444a42608e49d3d40e0205fd-10" name="rest_code_48843cf3444a42608e49d3d40e0205fd-10" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-27/#rest_code_48843cf3444a42608e49d3d40e0205fd-10"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;samples&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;          &lt;/span&gt;&lt;span class="mi"&gt;25&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_48843cf3444a42608e49d3d40e0205fd-11" name="rest_code_48843cf3444a42608e49d3d40e0205fd-11" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-27/#rest_code_48843cf3444a42608e49d3d40e0205fd-11"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;evals&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;sample&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;     &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;In this case, we can say that the Python code is roughly 3 times faster than
Julia code.&lt;/p&gt;
&lt;/section&gt;
&lt;/section&gt;</description><category>julia</category><category>monte carlo</category><category>numerical methods</category><category>python</category><category>scientific computing</category><guid>https://nicoguaro.github.io/posts/numerical_challenge/numerical-27/</guid><pubDate>Sat, 28 Oct 2017 02:27:06 GMT</pubDate></item><item><title>Numerical methods challenge: Day 26</title><link>https://nicoguaro.github.io/posts/numerical_challenge/numerical-26/</link><dc:creator>Nicolás Guarín-Zapata</dc:creator><description>&lt;p&gt;During October (2017) I will write a program per day for some well-known
numerical methods in both Python and Julia. It is intended to be an exercise
then don't expect the code to be good enough for real use. Also,
I should mention that I have almost no experience with Julia, so it
probably won't be idiomatic Julia but more Python-like Julia.&lt;/p&gt;
&lt;section id="boundary-element-method"&gt;
&lt;h2&gt;Boundary element method&lt;/h2&gt;
&lt;p&gt;Today we have the &lt;a class="reference external" href="https://en.wikipedia.org/wiki/Boundary_element_method"&gt;Boundary element method&lt;/a&gt;
, or, an attempt. We want so solve the equation&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
\nabla^2 u = -f(x)
\end{equation*}
&lt;/div&gt;
&lt;p&gt;with&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
u(x) = g(x),\quad \forall (x, y)\in \partial \Omega
\end{equation*}
&lt;/div&gt;
&lt;p&gt;For this method, we need to use an integral representation of the equation,
that in this case is&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
u(\xi)  = \int_{S} [u(x) F(x, \xi) - q(x)G(x, \xi)]dS(x) +
          \int_{V} f(x) G(x, \xi) dV(x)
\end{equation*}
&lt;/div&gt;
&lt;p&gt;with&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
G(x,\xi)= -\frac{1}{2\pi}\ln|x- \xi|
\end{equation*}
&lt;/div&gt;
&lt;p&gt;and&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
F(x,\xi) = -\frac{1}{2\pi |x- \xi|^2}(x - \xi)\cdot\hat{n}
\end{equation*}
&lt;/div&gt;
&lt;p&gt;Then, we can form a system of equations&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
[G]\{q\} = [F]\{u\}\, ,
\end{equation*}
&lt;/div&gt;
&lt;p&gt;that we obtain by discretization of the boundary. If we take constant
variables over the discretization, the integral can be computed analytically
by&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
G_{nm} = -\frac{1}{2\pi}\left[r \sin\theta\left(\ln|r| - 1\right)
         + \theta r\cos\theta\right]^{\theta_B, r_B}_{\theta_A, r_A}
\end{equation*}
&lt;/div&gt;
&lt;p&gt;and&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
F_{nm} = \left[\frac{\theta}{2\pi}\right]^{\theta_B}_{\theta_A}
\end{equation*}
&lt;/div&gt;
&lt;p&gt;for points &lt;span class="math"&gt;\(n\)&lt;/span&gt; and &lt;span class="math"&gt;\(m\)&lt;/span&gt; in different elements, and the subindices
&lt;span class="math"&gt;\(A,B\)&lt;/span&gt; refer to the endpoints of the evaluation element. For diagonal
terms the integrals evaluate to&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
G_{nn} = -\frac{L}{2\pi}\left(\ln\left\vert\frac{L}{2}\right\vert - 1\right)
\end{equation*}
&lt;/div&gt;
&lt;p&gt;and&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
F_{nn} = - \frac{1}{2\pi}
\end{equation*}
&lt;/div&gt;
&lt;p&gt;with &lt;span class="math"&gt;\(L\)&lt;/span&gt; the size of the element.&lt;/p&gt;
&lt;p&gt;Below is the Python code. In this case, I did not succeed and the
code is not working right now.&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code python"&gt;&lt;a id="rest_code_8f62e2bf3b504d2a925f1439846d56b6-1" name="rest_code_8f62e2bf3b504d2a925f1439846d56b6-1" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-26/#rest_code_8f62e2bf3b504d2a925f1439846d56b6-1"&gt;&lt;/a&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;__future__&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;division&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;print_function&lt;/span&gt;
&lt;a id="rest_code_8f62e2bf3b504d2a925f1439846d56b6-2" name="rest_code_8f62e2bf3b504d2a925f1439846d56b6-2" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-26/#rest_code_8f62e2bf3b504d2a925f1439846d56b6-2"&gt;&lt;/a&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;numpy&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;np&lt;/span&gt;
&lt;a id="rest_code_8f62e2bf3b504d2a925f1439846d56b6-3" name="rest_code_8f62e2bf3b504d2a925f1439846d56b6-3" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-26/#rest_code_8f62e2bf3b504d2a925f1439846d56b6-3"&gt;&lt;/a&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;numpy&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;log&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;sin&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;cos&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;arctan2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;pi&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;mean&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;arctan&lt;/span&gt;
&lt;a id="rest_code_8f62e2bf3b504d2a925f1439846d56b6-4" name="rest_code_8f62e2bf3b504d2a925f1439846d56b6-4" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-26/#rest_code_8f62e2bf3b504d2a925f1439846d56b6-4"&gt;&lt;/a&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;numpy.linalg&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;norm&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;solve&lt;/span&gt;
&lt;a id="rest_code_8f62e2bf3b504d2a925f1439846d56b6-5" name="rest_code_8f62e2bf3b504d2a925f1439846d56b6-5" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-26/#rest_code_8f62e2bf3b504d2a925f1439846d56b6-5"&gt;&lt;/a&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;matplotlib.pyplot&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;plt&lt;/span&gt;
&lt;a id="rest_code_8f62e2bf3b504d2a925f1439846d56b6-6" name="rest_code_8f62e2bf3b504d2a925f1439846d56b6-6" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-26/#rest_code_8f62e2bf3b504d2a925f1439846d56b6-6"&gt;&lt;/a&gt;
&lt;a id="rest_code_8f62e2bf3b504d2a925f1439846d56b6-7" name="rest_code_8f62e2bf3b504d2a925f1439846d56b6-7" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-26/#rest_code_8f62e2bf3b504d2a925f1439846d56b6-7"&gt;&lt;/a&gt;
&lt;a id="rest_code_8f62e2bf3b504d2a925f1439846d56b6-8" name="rest_code_8f62e2bf3b504d2a925f1439846d56b6-8" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-26/#rest_code_8f62e2bf3b504d2a925f1439846d56b6-8"&gt;&lt;/a&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;assem&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;elems&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_8f62e2bf3b504d2a925f1439846d56b6-9" name="rest_code_8f62e2bf3b504d2a925f1439846d56b6-9" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-26/#rest_code_8f62e2bf3b504d2a925f1439846d56b6-9"&gt;&lt;/a&gt;    &lt;span class="n"&gt;nelems&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;elems&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;shape&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_8f62e2bf3b504d2a925f1439846d56b6-10" name="rest_code_8f62e2bf3b504d2a925f1439846d56b6-10" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-26/#rest_code_8f62e2bf3b504d2a925f1439846d56b6-10"&gt;&lt;/a&gt;    &lt;span class="n"&gt;Gmat&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="n"&gt;nelems&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;nelems&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_8f62e2bf3b504d2a925f1439846d56b6-11" name="rest_code_8f62e2bf3b504d2a925f1439846d56b6-11" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-26/#rest_code_8f62e2bf3b504d2a925f1439846d56b6-11"&gt;&lt;/a&gt;    &lt;span class="n"&gt;Fmat&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="n"&gt;nelems&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;nelems&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_8f62e2bf3b504d2a925f1439846d56b6-12" name="rest_code_8f62e2bf3b504d2a925f1439846d56b6-12" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-26/#rest_code_8f62e2bf3b504d2a925f1439846d56b6-12"&gt;&lt;/a&gt;    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;ev_cont&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;elem1&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;enumerate&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;elems&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_8f62e2bf3b504d2a925f1439846d56b6-13" name="rest_code_8f62e2bf3b504d2a925f1439846d56b6-13" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-26/#rest_code_8f62e2bf3b504d2a925f1439846d56b6-13"&gt;&lt;/a&gt;        &lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;elem1&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]],&lt;/span&gt; &lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;elem1&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]])&lt;/span&gt;
&lt;a id="rest_code_8f62e2bf3b504d2a925f1439846d56b6-14" name="rest_code_8f62e2bf3b504d2a925f1439846d56b6-14" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-26/#rest_code_8f62e2bf3b504d2a925f1439846d56b6-14"&gt;&lt;/a&gt;        &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;col_cont&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;elem2&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;enumerate&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;elems&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_8f62e2bf3b504d2a925f1439846d56b6-15" name="rest_code_8f62e2bf3b504d2a925f1439846d56b6-15" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-26/#rest_code_8f62e2bf3b504d2a925f1439846d56b6-15"&gt;&lt;/a&gt;            &lt;span class="n"&gt;pt_col&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;mean&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;elem2&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;axis&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_8f62e2bf3b504d2a925f1439846d56b6-16" name="rest_code_8f62e2bf3b504d2a925f1439846d56b6-16" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-26/#rest_code_8f62e2bf3b504d2a925f1439846d56b6-16"&gt;&lt;/a&gt;            &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;ev_cont&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="n"&gt;col_cont&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a id="rest_code_8f62e2bf3b504d2a925f1439846d56b6-17" name="rest_code_8f62e2bf3b504d2a925f1439846d56b6-17" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-26/#rest_code_8f62e2bf3b504d2a925f1439846d56b6-17"&gt;&lt;/a&gt;                &lt;span class="n"&gt;L&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;norm&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;elem1&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]]&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;elem1&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]])&lt;/span&gt;
&lt;a id="rest_code_8f62e2bf3b504d2a925f1439846d56b6-18" name="rest_code_8f62e2bf3b504d2a925f1439846d56b6-18" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-26/#rest_code_8f62e2bf3b504d2a925f1439846d56b6-18"&gt;&lt;/a&gt;                &lt;span class="n"&gt;Gmat&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ev_cont&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;ev_cont&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;L&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;pi&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;log&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;L&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_8f62e2bf3b504d2a925f1439846d56b6-19" name="rest_code_8f62e2bf3b504d2a925f1439846d56b6-19" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-26/#rest_code_8f62e2bf3b504d2a925f1439846d56b6-19"&gt;&lt;/a&gt;                &lt;span class="n"&gt;Fmat&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ev_cont&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;ev_cont&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="mf"&gt;0.5&lt;/span&gt;
&lt;a id="rest_code_8f62e2bf3b504d2a925f1439846d56b6-20" name="rest_code_8f62e2bf3b504d2a925f1439846d56b6-20" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-26/#rest_code_8f62e2bf3b504d2a925f1439846d56b6-20"&gt;&lt;/a&gt;            &lt;span class="k"&gt;else&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a id="rest_code_8f62e2bf3b504d2a925f1439846d56b6-21" name="rest_code_8f62e2bf3b504d2a925f1439846d56b6-21" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-26/#rest_code_8f62e2bf3b504d2a925f1439846d56b6-21"&gt;&lt;/a&gt;                &lt;span class="n"&gt;Gij&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;Fij&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;influence_coeff&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;elem1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;pt_col&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_8f62e2bf3b504d2a925f1439846d56b6-22" name="rest_code_8f62e2bf3b504d2a925f1439846d56b6-22" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-26/#rest_code_8f62e2bf3b504d2a925f1439846d56b6-22"&gt;&lt;/a&gt;                &lt;span class="n"&gt;Gmat&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ev_cont&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;col_cont&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Gij&lt;/span&gt;
&lt;a id="rest_code_8f62e2bf3b504d2a925f1439846d56b6-23" name="rest_code_8f62e2bf3b504d2a925f1439846d56b6-23" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-26/#rest_code_8f62e2bf3b504d2a925f1439846d56b6-23"&gt;&lt;/a&gt;                &lt;span class="n"&gt;Fmat&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ev_cont&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;col_cont&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Fij&lt;/span&gt;
&lt;a id="rest_code_8f62e2bf3b504d2a925f1439846d56b6-24" name="rest_code_8f62e2bf3b504d2a925f1439846d56b6-24" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-26/#rest_code_8f62e2bf3b504d2a925f1439846d56b6-24"&gt;&lt;/a&gt;    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;Gmat&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;Fmat&lt;/span&gt;
&lt;a id="rest_code_8f62e2bf3b504d2a925f1439846d56b6-25" name="rest_code_8f62e2bf3b504d2a925f1439846d56b6-25" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-26/#rest_code_8f62e2bf3b504d2a925f1439846d56b6-25"&gt;&lt;/a&gt;
&lt;a id="rest_code_8f62e2bf3b504d2a925f1439846d56b6-26" name="rest_code_8f62e2bf3b504d2a925f1439846d56b6-26" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-26/#rest_code_8f62e2bf3b504d2a925f1439846d56b6-26"&gt;&lt;/a&gt;
&lt;a id="rest_code_8f62e2bf3b504d2a925f1439846d56b6-27" name="rest_code_8f62e2bf3b504d2a925f1439846d56b6-27" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-26/#rest_code_8f62e2bf3b504d2a925f1439846d56b6-27"&gt;&lt;/a&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;influence_coeff&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;elem&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;pt_col&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_8f62e2bf3b504d2a925f1439846d56b6-28" name="rest_code_8f62e2bf3b504d2a925f1439846d56b6-28" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-26/#rest_code_8f62e2bf3b504d2a925f1439846d56b6-28"&gt;&lt;/a&gt;    &lt;span class="n"&gt;r_A&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;elem&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]]&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;pt_col&lt;/span&gt;
&lt;a id="rest_code_8f62e2bf3b504d2a925f1439846d56b6-29" name="rest_code_8f62e2bf3b504d2a925f1439846d56b6-29" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-26/#rest_code_8f62e2bf3b504d2a925f1439846d56b6-29"&gt;&lt;/a&gt;    &lt;span class="n"&gt;r_B&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;elem&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]]&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;pt_col&lt;/span&gt;
&lt;a id="rest_code_8f62e2bf3b504d2a925f1439846d56b6-30" name="rest_code_8f62e2bf3b504d2a925f1439846d56b6-30" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-26/#rest_code_8f62e2bf3b504d2a925f1439846d56b6-30"&gt;&lt;/a&gt;    &lt;span class="n"&gt;theta_A&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;arctan2&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;r_A&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;r_A&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_8f62e2bf3b504d2a925f1439846d56b6-31" name="rest_code_8f62e2bf3b504d2a925f1439846d56b6-31" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-26/#rest_code_8f62e2bf3b504d2a925f1439846d56b6-31"&gt;&lt;/a&gt;    &lt;span class="n"&gt;theta_B&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;arctan2&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;r_B&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;r_B&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_8f62e2bf3b504d2a925f1439846d56b6-32" name="rest_code_8f62e2bf3b504d2a925f1439846d56b6-32" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-26/#rest_code_8f62e2bf3b504d2a925f1439846d56b6-32"&gt;&lt;/a&gt;    &lt;span class="n"&gt;G_coeff&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;r_B&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;log&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;norm&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;r_B&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;theta_B&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;r_B&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;\
&lt;a id="rest_code_8f62e2bf3b504d2a925f1439846d56b6-33" name="rest_code_8f62e2bf3b504d2a925f1439846d56b6-33" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-26/#rest_code_8f62e2bf3b504d2a925f1439846d56b6-33"&gt;&lt;/a&gt;              &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;r_A&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;log&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;norm&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;r_A&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;theta_A&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;r_A&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_8f62e2bf3b504d2a925f1439846d56b6-34" name="rest_code_8f62e2bf3b504d2a925f1439846d56b6-34" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-26/#rest_code_8f62e2bf3b504d2a925f1439846d56b6-34"&gt;&lt;/a&gt;    &lt;span class="n"&gt;F_coeff&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;theta_B&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;theta_A&lt;/span&gt;
&lt;a id="rest_code_8f62e2bf3b504d2a925f1439846d56b6-35" name="rest_code_8f62e2bf3b504d2a925f1439846d56b6-35" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-26/#rest_code_8f62e2bf3b504d2a925f1439846d56b6-35"&gt;&lt;/a&gt;    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;G_coeff&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;pi&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;F_coeff&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;pi&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_8f62e2bf3b504d2a925f1439846d56b6-36" name="rest_code_8f62e2bf3b504d2a925f1439846d56b6-36" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-26/#rest_code_8f62e2bf3b504d2a925f1439846d56b6-36"&gt;&lt;/a&gt;
&lt;a id="rest_code_8f62e2bf3b504d2a925f1439846d56b6-37" name="rest_code_8f62e2bf3b504d2a925f1439846d56b6-37" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-26/#rest_code_8f62e2bf3b504d2a925f1439846d56b6-37"&gt;&lt;/a&gt;
&lt;a id="rest_code_8f62e2bf3b504d2a925f1439846d56b6-38" name="rest_code_8f62e2bf3b504d2a925f1439846d56b6-38" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-26/#rest_code_8f62e2bf3b504d2a925f1439846d56b6-38"&gt;&lt;/a&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;eval_sol&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ev_coords&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_8f62e2bf3b504d2a925f1439846d56b6-39" name="rest_code_8f62e2bf3b504d2a925f1439846d56b6-39" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-26/#rest_code_8f62e2bf3b504d2a925f1439846d56b6-39"&gt;&lt;/a&gt;    &lt;span class="n"&gt;nelems&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;elems&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;shape&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_8f62e2bf3b504d2a925f1439846d56b6-40" name="rest_code_8f62e2bf3b504d2a925f1439846d56b6-40" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-26/#rest_code_8f62e2bf3b504d2a925f1439846d56b6-40"&gt;&lt;/a&gt;    &lt;span class="n"&gt;Gmat&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="n"&gt;nelems&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;nelems&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_8f62e2bf3b504d2a925f1439846d56b6-41" name="rest_code_8f62e2bf3b504d2a925f1439846d56b6-41" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-26/#rest_code_8f62e2bf3b504d2a925f1439846d56b6-41"&gt;&lt;/a&gt;    &lt;span class="n"&gt;Fmat&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="n"&gt;nelems&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;nelems&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_8f62e2bf3b504d2a925f1439846d56b6-42" name="rest_code_8f62e2bf3b504d2a925f1439846d56b6-42" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-26/#rest_code_8f62e2bf3b504d2a925f1439846d56b6-42"&gt;&lt;/a&gt;    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;ev_cont&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;elem1&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;enumerate&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;elems&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_8f62e2bf3b504d2a925f1439846d56b6-43" name="rest_code_8f62e2bf3b504d2a925f1439846d56b6-43" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-26/#rest_code_8f62e2bf3b504d2a925f1439846d56b6-43"&gt;&lt;/a&gt;        &lt;span class="n"&gt;L&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;norm&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;elem1&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]]&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;elem1&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]])&lt;/span&gt;
&lt;a id="rest_code_8f62e2bf3b504d2a925f1439846d56b6-44" name="rest_code_8f62e2bf3b504d2a925f1439846d56b6-44" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-26/#rest_code_8f62e2bf3b504d2a925f1439846d56b6-44"&gt;&lt;/a&gt;        &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;col_cont&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;elem2&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;enumerate&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;elems&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_8f62e2bf3b504d2a925f1439846d56b6-45" name="rest_code_8f62e2bf3b504d2a925f1439846d56b6-45" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-26/#rest_code_8f62e2bf3b504d2a925f1439846d56b6-45"&gt;&lt;/a&gt;            &lt;span class="n"&gt;pt_col&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;mean&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;elem2&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;axis&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_8f62e2bf3b504d2a925f1439846d56b6-46" name="rest_code_8f62e2bf3b504d2a925f1439846d56b6-46" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-26/#rest_code_8f62e2bf3b504d2a925f1439846d56b6-46"&gt;&lt;/a&gt;            &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;ev_cont&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="n"&gt;col_cont&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a id="rest_code_8f62e2bf3b504d2a925f1439846d56b6-47" name="rest_code_8f62e2bf3b504d2a925f1439846d56b6-47" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-26/#rest_code_8f62e2bf3b504d2a925f1439846d56b6-47"&gt;&lt;/a&gt;                &lt;span class="n"&gt;Gmat&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ev_cont&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;ev_cont&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;L&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;pi&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;log&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;L&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_8f62e2bf3b504d2a925f1439846d56b6-48" name="rest_code_8f62e2bf3b504d2a925f1439846d56b6-48" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-26/#rest_code_8f62e2bf3b504d2a925f1439846d56b6-48"&gt;&lt;/a&gt;                &lt;span class="n"&gt;Fmat&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ev_cont&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;ev_cont&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="mf"&gt;0.5&lt;/span&gt;
&lt;a id="rest_code_8f62e2bf3b504d2a925f1439846d56b6-49" name="rest_code_8f62e2bf3b504d2a925f1439846d56b6-49" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-26/#rest_code_8f62e2bf3b504d2a925f1439846d56b6-49"&gt;&lt;/a&gt;            &lt;span class="k"&gt;else&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a id="rest_code_8f62e2bf3b504d2a925f1439846d56b6-50" name="rest_code_8f62e2bf3b504d2a925f1439846d56b6-50" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-26/#rest_code_8f62e2bf3b504d2a925f1439846d56b6-50"&gt;&lt;/a&gt;                &lt;span class="n"&gt;Gmat&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ev_cont&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;col_cont&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;Fmat&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ev_cont&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;col_cont&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; \
&lt;a id="rest_code_8f62e2bf3b504d2a925f1439846d56b6-51" name="rest_code_8f62e2bf3b504d2a925f1439846d56b6-51" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-26/#rest_code_8f62e2bf3b504d2a925f1439846d56b6-51"&gt;&lt;/a&gt;                    &lt;span class="n"&gt;influence_coeff&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;elem1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;pt_col&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_8f62e2bf3b504d2a925f1439846d56b6-52" name="rest_code_8f62e2bf3b504d2a925f1439846d56b6-52" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-26/#rest_code_8f62e2bf3b504d2a925f1439846d56b6-52"&gt;&lt;/a&gt;
&lt;a id="rest_code_8f62e2bf3b504d2a925f1439846d56b6-53" name="rest_code_8f62e2bf3b504d2a925f1439846d56b6-53" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-26/#rest_code_8f62e2bf3b504d2a925f1439846d56b6-53"&gt;&lt;/a&gt;&lt;span class="n"&gt;nelems&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt;
&lt;a id="rest_code_8f62e2bf3b504d2a925f1439846d56b6-54" name="rest_code_8f62e2bf3b504d2a925f1439846d56b6-54" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-26/#rest_code_8f62e2bf3b504d2a925f1439846d56b6-54"&gt;&lt;/a&gt;&lt;span class="n"&gt;rad&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;1.0&lt;/span&gt;
&lt;a id="rest_code_8f62e2bf3b504d2a925f1439846d56b6-55" name="rest_code_8f62e2bf3b504d2a925f1439846d56b6-55" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-26/#rest_code_8f62e2bf3b504d2a925f1439846d56b6-55"&gt;&lt;/a&gt;&lt;span class="n"&gt;theta&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt;  &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;linspace&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;pi&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;nelems&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;endpoint&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;False&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_8f62e2bf3b504d2a925f1439846d56b6-56" name="rest_code_8f62e2bf3b504d2a925f1439846d56b6-56" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-26/#rest_code_8f62e2bf3b504d2a925f1439846d56b6-56"&gt;&lt;/a&gt;&lt;span class="n"&gt;coords&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;rad&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;vstack&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="n"&gt;cos&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;theta&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;sin&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;theta&lt;/span&gt;&lt;span class="p"&gt;)))&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;T&lt;/span&gt;
&lt;a id="rest_code_8f62e2bf3b504d2a925f1439846d56b6-57" name="rest_code_8f62e2bf3b504d2a925f1439846d56b6-57" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-26/#rest_code_8f62e2bf3b504d2a925f1439846d56b6-57"&gt;&lt;/a&gt;&lt;span class="n"&gt;elems&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;([[&lt;/span&gt;&lt;span class="n"&gt;cont&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;cont&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="n"&gt;nelems&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;cont&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;nelems&lt;/span&gt;&lt;span class="p"&gt;)])&lt;/span&gt;
&lt;a id="rest_code_8f62e2bf3b504d2a925f1439846d56b6-58" name="rest_code_8f62e2bf3b504d2a925f1439846d56b6-58" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-26/#rest_code_8f62e2bf3b504d2a925f1439846d56b6-58"&gt;&lt;/a&gt;&lt;span class="n"&gt;Gmat&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;Fmat&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;assem&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;elems&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_8f62e2bf3b504d2a925f1439846d56b6-59" name="rest_code_8f62e2bf3b504d2a925f1439846d56b6-59" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-26/#rest_code_8f62e2bf3b504d2a925f1439846d56b6-59"&gt;&lt;/a&gt;&lt;span class="n"&gt;u_boundary&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ones_like&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;theta&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_8f62e2bf3b504d2a925f1439846d56b6-60" name="rest_code_8f62e2bf3b504d2a925f1439846d56b6-60" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-26/#rest_code_8f62e2bf3b504d2a925f1439846d56b6-60"&gt;&lt;/a&gt;&lt;span class="n"&gt;q_boundary&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;solve&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Gmat&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;Fmat&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;dot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;u_boundary&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/section&gt;</description><category>boundary element method</category><category>julia</category><category>numerical methods</category><category>python</category><category>scientific computing</category><guid>https://nicoguaro.github.io/posts/numerical_challenge/numerical-26/</guid><pubDate>Fri, 27 Oct 2017 00:15:08 GMT</pubDate></item><item><title>Numerical methods challenge: Day 25</title><link>https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/</link><dc:creator>Nicolás Guarín-Zapata</dc:creator><description>&lt;p&gt;During October (2017) I will write a program per day for some well-known
numerical methods in both Python and Julia. It is intended to be an exercise
then don't expect the code to be good enough for real use. Also,
I should mention that I have almost no experience with Julia, so it
probably won't be idiomatic Julia but more Python-like Julia.&lt;/p&gt;
&lt;section id="finite-element-method"&gt;
&lt;h2&gt;Finite element method&lt;/h2&gt;
&lt;p&gt;Today we have the &lt;a class="reference external" href="https://en.wikipedia.org/wiki/Finite_element_method"&gt;Finite element method&lt;/a&gt;
to solve the equation:&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
\nabla^2 u = -f(x)
\end{equation*}
&lt;/div&gt;
&lt;p&gt;with&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
u(\sqrt{3}, 1) = 0
\end{equation*}
&lt;/div&gt;
&lt;p&gt;As in the &lt;a class="reference external" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/posts/numerical-23"&gt;Ritz method&lt;/a&gt; we form
a functional that is &lt;em&gt;equivalent&lt;/em&gt; to the
differential equation, propose an approximation as a linear combination of
a set of basis functions and find the &lt;em&gt;best&lt;/em&gt; set of coefficients for that
combination. That &lt;em&gt;best&lt;/em&gt; solution is found minimizing the functional.&lt;/p&gt;
&lt;p&gt;The functional for this differential equation is&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
\Pi[u] = -\int_\Omega \left(\nabla u\right)^2 d\Omega
         -\int_\Omega  u f(x) d\Omega
\end{equation*}
&lt;/div&gt;
&lt;p&gt;Using linear triangles, the local stiffness matrices read&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
K_\text{local} =  \frac{1}{2|J|}
    \begin{bmatrix}
        2 &amp;amp; -1 &amp;amp;1\\
        -1 &amp;amp; 1 &amp;amp;0\\
        -1 &amp;amp; 0 &amp;amp;1\\
    \end{bmatrix}
\end{equation*}
&lt;/div&gt;
&lt;p&gt;and&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
b_\text{local} = -|J| f(x_m) \mathbf{1}_3\, ,
\end{equation*}
&lt;/div&gt;
&lt;p&gt;where &lt;span class="math"&gt;\(|J|\)&lt;/span&gt; is the Jacobian determinant of the transformation and
&lt;span class="math"&gt;\(x_m\)&lt;/span&gt; is the centroid of the triangle. I am
skipping a great deal about assembling, but it would be just too extensive
to describe the complete process.&lt;/p&gt;
&lt;p&gt;We will solve the problem in a mesh with 6 triangles forming
a regular hexagon&lt;/p&gt;
&lt;p&gt;Following are the codes.&lt;/p&gt;
&lt;section id="python"&gt;
&lt;h3&gt;Python&lt;/h3&gt;
&lt;div class="code"&gt;&lt;pre class="code python"&gt;&lt;a id="rest_code_eae9451b79294bffbac302bbf9e80cea-1" name="rest_code_eae9451b79294bffbac302bbf9e80cea-1" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_eae9451b79294bffbac302bbf9e80cea-1"&gt;&lt;/a&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;__future__&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;division&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;print_function&lt;/span&gt;
&lt;a id="rest_code_eae9451b79294bffbac302bbf9e80cea-2" name="rest_code_eae9451b79294bffbac302bbf9e80cea-2" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_eae9451b79294bffbac302bbf9e80cea-2"&gt;&lt;/a&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;numpy&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;np&lt;/span&gt;
&lt;a id="rest_code_eae9451b79294bffbac302bbf9e80cea-3" name="rest_code_eae9451b79294bffbac302bbf9e80cea-3" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_eae9451b79294bffbac302bbf9e80cea-3"&gt;&lt;/a&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;matplotlib.pyplot&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;plt&lt;/span&gt;
&lt;a id="rest_code_eae9451b79294bffbac302bbf9e80cea-4" name="rest_code_eae9451b79294bffbac302bbf9e80cea-4" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_eae9451b79294bffbac302bbf9e80cea-4"&gt;&lt;/a&gt;
&lt;a id="rest_code_eae9451b79294bffbac302bbf9e80cea-5" name="rest_code_eae9451b79294bffbac302bbf9e80cea-5" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_eae9451b79294bffbac302bbf9e80cea-5"&gt;&lt;/a&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;assem&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;elems&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;source&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_eae9451b79294bffbac302bbf9e80cea-6" name="rest_code_eae9451b79294bffbac302bbf9e80cea-6" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_eae9451b79294bffbac302bbf9e80cea-6"&gt;&lt;/a&gt;    &lt;span class="n"&gt;ncoords&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;shape&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_eae9451b79294bffbac302bbf9e80cea-7" name="rest_code_eae9451b79294bffbac302bbf9e80cea-7" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_eae9451b79294bffbac302bbf9e80cea-7"&gt;&lt;/a&gt;    &lt;span class="n"&gt;stiff&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="n"&gt;ncoords&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;ncoords&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_eae9451b79294bffbac302bbf9e80cea-8" name="rest_code_eae9451b79294bffbac302bbf9e80cea-8" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_eae9451b79294bffbac302bbf9e80cea-8"&gt;&lt;/a&gt;    &lt;span class="n"&gt;rhs&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="n"&gt;ncoords&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_eae9451b79294bffbac302bbf9e80cea-9" name="rest_code_eae9451b79294bffbac302bbf9e80cea-9" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_eae9451b79294bffbac302bbf9e80cea-9"&gt;&lt;/a&gt;    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;el_cont&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;elem&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;enumerate&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;elems&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_eae9451b79294bffbac302bbf9e80cea-10" name="rest_code_eae9451b79294bffbac302bbf9e80cea-10" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_eae9451b79294bffbac302bbf9e80cea-10"&gt;&lt;/a&gt;        &lt;span class="n"&gt;stiff_loc&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;jaco&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;local_stiff&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;elem&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_eae9451b79294bffbac302bbf9e80cea-11" name="rest_code_eae9451b79294bffbac302bbf9e80cea-11" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_eae9451b79294bffbac302bbf9e80cea-11"&gt;&lt;/a&gt;        &lt;span class="n"&gt;rhs&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;elem&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;+=&lt;/span&gt; &lt;span class="n"&gt;jaco&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;mean&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;source&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;elem&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_eae9451b79294bffbac302bbf9e80cea-12" name="rest_code_eae9451b79294bffbac302bbf9e80cea-12" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_eae9451b79294bffbac302bbf9e80cea-12"&gt;&lt;/a&gt;        &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;row&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_eae9451b79294bffbac302bbf9e80cea-13" name="rest_code_eae9451b79294bffbac302bbf9e80cea-13" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_eae9451b79294bffbac302bbf9e80cea-13"&gt;&lt;/a&gt;            &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;col&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_eae9451b79294bffbac302bbf9e80cea-14" name="rest_code_eae9451b79294bffbac302bbf9e80cea-14" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_eae9451b79294bffbac302bbf9e80cea-14"&gt;&lt;/a&gt;                &lt;span class="n"&gt;row_glob&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;col_glob&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;elem&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;row&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;elem&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_eae9451b79294bffbac302bbf9e80cea-15" name="rest_code_eae9451b79294bffbac302bbf9e80cea-15" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_eae9451b79294bffbac302bbf9e80cea-15"&gt;&lt;/a&gt;                &lt;span class="n"&gt;stiff&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;row_glob&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;col_glob&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;+=&lt;/span&gt; &lt;span class="n"&gt;stiff_loc&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;row&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_eae9451b79294bffbac302bbf9e80cea-16" name="rest_code_eae9451b79294bffbac302bbf9e80cea-16" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_eae9451b79294bffbac302bbf9e80cea-16"&gt;&lt;/a&gt;    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;stiff&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;rhs&lt;/span&gt;
&lt;a id="rest_code_eae9451b79294bffbac302bbf9e80cea-17" name="rest_code_eae9451b79294bffbac302bbf9e80cea-17" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_eae9451b79294bffbac302bbf9e80cea-17"&gt;&lt;/a&gt;
&lt;a id="rest_code_eae9451b79294bffbac302bbf9e80cea-18" name="rest_code_eae9451b79294bffbac302bbf9e80cea-18" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_eae9451b79294bffbac302bbf9e80cea-18"&gt;&lt;/a&gt;
&lt;a id="rest_code_eae9451b79294bffbac302bbf9e80cea-19" name="rest_code_eae9451b79294bffbac302bbf9e80cea-19" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_eae9451b79294bffbac302bbf9e80cea-19"&gt;&lt;/a&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;local_stiff&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_eae9451b79294bffbac302bbf9e80cea-20" name="rest_code_eae9451b79294bffbac302bbf9e80cea-20" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_eae9451b79294bffbac302bbf9e80cea-20"&gt;&lt;/a&gt;    &lt;span class="n"&gt;dHdr&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;([[&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]])&lt;/span&gt;
&lt;a id="rest_code_eae9451b79294bffbac302bbf9e80cea-21" name="rest_code_eae9451b79294bffbac302bbf9e80cea-21" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_eae9451b79294bffbac302bbf9e80cea-21"&gt;&lt;/a&gt;    &lt;span class="n"&gt;jaco&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;dHdr&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;dot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_eae9451b79294bffbac302bbf9e80cea-22" name="rest_code_eae9451b79294bffbac302bbf9e80cea-22" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_eae9451b79294bffbac302bbf9e80cea-22"&gt;&lt;/a&gt;    &lt;span class="n"&gt;stiff&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;0.5&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;([[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]])&lt;/span&gt;
&lt;a id="rest_code_eae9451b79294bffbac302bbf9e80cea-23" name="rest_code_eae9451b79294bffbac302bbf9e80cea-23" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_eae9451b79294bffbac302bbf9e80cea-23"&gt;&lt;/a&gt;    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;stiff&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;linalg&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;det&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;jaco&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;linalg&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;det&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;jaco&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_eae9451b79294bffbac302bbf9e80cea-24" name="rest_code_eae9451b79294bffbac302bbf9e80cea-24" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_eae9451b79294bffbac302bbf9e80cea-24"&gt;&lt;/a&gt;
&lt;a id="rest_code_eae9451b79294bffbac302bbf9e80cea-25" name="rest_code_eae9451b79294bffbac302bbf9e80cea-25" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_eae9451b79294bffbac302bbf9e80cea-25"&gt;&lt;/a&gt;
&lt;a id="rest_code_eae9451b79294bffbac302bbf9e80cea-26" name="rest_code_eae9451b79294bffbac302bbf9e80cea-26" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_eae9451b79294bffbac302bbf9e80cea-26"&gt;&lt;/a&gt;&lt;span class="n"&gt;sq3&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sqrt&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_eae9451b79294bffbac302bbf9e80cea-27" name="rest_code_eae9451b79294bffbac302bbf9e80cea-27" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_eae9451b79294bffbac302bbf9e80cea-27"&gt;&lt;/a&gt;&lt;span class="n"&gt;coords&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;
&lt;a id="rest_code_eae9451b79294bffbac302bbf9e80cea-28" name="rest_code_eae9451b79294bffbac302bbf9e80cea-28" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_eae9451b79294bffbac302bbf9e80cea-28"&gt;&lt;/a&gt;        &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;sq3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;
&lt;a id="rest_code_eae9451b79294bffbac302bbf9e80cea-29" name="rest_code_eae9451b79294bffbac302bbf9e80cea-29" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_eae9451b79294bffbac302bbf9e80cea-29"&gt;&lt;/a&gt;        &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;
&lt;a id="rest_code_eae9451b79294bffbac302bbf9e80cea-30" name="rest_code_eae9451b79294bffbac302bbf9e80cea-30" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_eae9451b79294bffbac302bbf9e80cea-30"&gt;&lt;/a&gt;        &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;sq3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;
&lt;a id="rest_code_eae9451b79294bffbac302bbf9e80cea-31" name="rest_code_eae9451b79294bffbac302bbf9e80cea-31" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_eae9451b79294bffbac302bbf9e80cea-31"&gt;&lt;/a&gt;        &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;
&lt;a id="rest_code_eae9451b79294bffbac302bbf9e80cea-32" name="rest_code_eae9451b79294bffbac302bbf9e80cea-32" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_eae9451b79294bffbac302bbf9e80cea-32"&gt;&lt;/a&gt;        &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;sq3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;
&lt;a id="rest_code_eae9451b79294bffbac302bbf9e80cea-33" name="rest_code_eae9451b79294bffbac302bbf9e80cea-33" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_eae9451b79294bffbac302bbf9e80cea-33"&gt;&lt;/a&gt;        &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;sq3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;
&lt;a id="rest_code_eae9451b79294bffbac302bbf9e80cea-34" name="rest_code_eae9451b79294bffbac302bbf9e80cea-34" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_eae9451b79294bffbac302bbf9e80cea-34"&gt;&lt;/a&gt;        &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;sq3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]])&lt;/span&gt;
&lt;a id="rest_code_eae9451b79294bffbac302bbf9e80cea-35" name="rest_code_eae9451b79294bffbac302bbf9e80cea-35" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_eae9451b79294bffbac302bbf9e80cea-35"&gt;&lt;/a&gt;&lt;span class="n"&gt;elems&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;
&lt;a id="rest_code_eae9451b79294bffbac302bbf9e80cea-36" name="rest_code_eae9451b79294bffbac302bbf9e80cea-36" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_eae9451b79294bffbac302bbf9e80cea-36"&gt;&lt;/a&gt;        &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;6&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;
&lt;a id="rest_code_eae9451b79294bffbac302bbf9e80cea-37" name="rest_code_eae9451b79294bffbac302bbf9e80cea-37" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_eae9451b79294bffbac302bbf9e80cea-37"&gt;&lt;/a&gt;        &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;6&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;
&lt;a id="rest_code_eae9451b79294bffbac302bbf9e80cea-38" name="rest_code_eae9451b79294bffbac302bbf9e80cea-38" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_eae9451b79294bffbac302bbf9e80cea-38"&gt;&lt;/a&gt;        &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;6&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;
&lt;a id="rest_code_eae9451b79294bffbac302bbf9e80cea-39" name="rest_code_eae9451b79294bffbac302bbf9e80cea-39" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_eae9451b79294bffbac302bbf9e80cea-39"&gt;&lt;/a&gt;        &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;6&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;
&lt;a id="rest_code_eae9451b79294bffbac302bbf9e80cea-40" name="rest_code_eae9451b79294bffbac302bbf9e80cea-40" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_eae9451b79294bffbac302bbf9e80cea-40"&gt;&lt;/a&gt;        &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;6&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;
&lt;a id="rest_code_eae9451b79294bffbac302bbf9e80cea-41" name="rest_code_eae9451b79294bffbac302bbf9e80cea-41" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_eae9451b79294bffbac302bbf9e80cea-41"&gt;&lt;/a&gt;        &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;6&lt;/span&gt;&lt;span class="p"&gt;]])&lt;/span&gt;
&lt;a id="rest_code_eae9451b79294bffbac302bbf9e80cea-42" name="rest_code_eae9451b79294bffbac302bbf9e80cea-42" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_eae9451b79294bffbac302bbf9e80cea-42"&gt;&lt;/a&gt;&lt;span class="n"&gt;source&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ones&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;7&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_eae9451b79294bffbac302bbf9e80cea-43" name="rest_code_eae9451b79294bffbac302bbf9e80cea-43" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_eae9451b79294bffbac302bbf9e80cea-43"&gt;&lt;/a&gt;&lt;span class="n"&gt;stiff&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;rhs&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;assem&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;elems&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;source&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_eae9451b79294bffbac302bbf9e80cea-44" name="rest_code_eae9451b79294bffbac302bbf9e80cea-44" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_eae9451b79294bffbac302bbf9e80cea-44"&gt;&lt;/a&gt;&lt;span class="n"&gt;free&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;6&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_eae9451b79294bffbac302bbf9e80cea-45" name="rest_code_eae9451b79294bffbac302bbf9e80cea-45" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_eae9451b79294bffbac302bbf9e80cea-45"&gt;&lt;/a&gt;&lt;span class="n"&gt;sol&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;linalg&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;solve&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;stiff&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ix_&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;free&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;free&lt;/span&gt;&lt;span class="p"&gt;)],&lt;/span&gt; &lt;span class="n"&gt;rhs&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;free&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_eae9451b79294bffbac302bbf9e80cea-46" name="rest_code_eae9451b79294bffbac302bbf9e80cea-46" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_eae9451b79294bffbac302bbf9e80cea-46"&gt;&lt;/a&gt;&lt;span class="n"&gt;sol_c&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;shape&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_eae9451b79294bffbac302bbf9e80cea-47" name="rest_code_eae9451b79294bffbac302bbf9e80cea-47" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_eae9451b79294bffbac302bbf9e80cea-47"&gt;&lt;/a&gt;&lt;span class="n"&gt;sol_c&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;free&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;sol&lt;/span&gt;
&lt;a id="rest_code_eae9451b79294bffbac302bbf9e80cea-48" name="rest_code_eae9451b79294bffbac302bbf9e80cea-48" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_eae9451b79294bffbac302bbf9e80cea-48"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;tricontourf&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;[:,&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;[:,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;sol_c&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;cmap&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;"hot"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_eae9451b79294bffbac302bbf9e80cea-49" name="rest_code_eae9451b79294bffbac302bbf9e80cea-49" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_eae9451b79294bffbac302bbf9e80cea-49"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;colorbar&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a id="rest_code_eae9451b79294bffbac302bbf9e80cea-50" name="rest_code_eae9451b79294bffbac302bbf9e80cea-50" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_eae9451b79294bffbac302bbf9e80cea-50"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;axis&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"image"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_eae9451b79294bffbac302bbf9e80cea-51" name="rest_code_eae9451b79294bffbac302bbf9e80cea-51" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_eae9451b79294bffbac302bbf9e80cea-51"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;show&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/section&gt;
&lt;section id="julia"&gt;
&lt;h3&gt;Julia&lt;/h3&gt;
&lt;div class="code"&gt;&lt;pre class="code julia"&gt;&lt;a id="rest_code_33b3f08c53564249bf5e6e58fd2a9f3a-1" name="rest_code_33b3f08c53564249bf5e6e58fd2a9f3a-1" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_33b3f08c53564249bf5e6e58fd2a9f3a-1"&gt;&lt;/a&gt;&lt;span class="k"&gt;using&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;PyPlot&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_33b3f08c53564249bf5e6e58fd2a9f3a-2" name="rest_code_33b3f08c53564249bf5e6e58fd2a9f3a-2" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_33b3f08c53564249bf5e6e58fd2a9f3a-2"&gt;&lt;/a&gt;
&lt;a id="rest_code_33b3f08c53564249bf5e6e58fd2a9f3a-3" name="rest_code_33b3f08c53564249bf5e6e58fd2a9f3a-3" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_33b3f08c53564249bf5e6e58fd2a9f3a-3"&gt;&lt;/a&gt;
&lt;a id="rest_code_33b3f08c53564249bf5e6e58fd2a9f3a-4" name="rest_code_33b3f08c53564249bf5e6e58fd2a9f3a-4" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_33b3f08c53564249bf5e6e58fd2a9f3a-4"&gt;&lt;/a&gt;&lt;span class="k"&gt;function&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;assem&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;elems&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;source&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_33b3f08c53564249bf5e6e58fd2a9f3a-5" name="rest_code_33b3f08c53564249bf5e6e58fd2a9f3a-5" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_33b3f08c53564249bf5e6e58fd2a9f3a-5"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;ncoords&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;size&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;)[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_33b3f08c53564249bf5e6e58fd2a9f3a-6" name="rest_code_33b3f08c53564249bf5e6e58fd2a9f3a-6" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_33b3f08c53564249bf5e6e58fd2a9f3a-6"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;nelems&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;size&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;elems&lt;/span&gt;&lt;span class="p"&gt;)[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_33b3f08c53564249bf5e6e58fd2a9f3a-7" name="rest_code_33b3f08c53564249bf5e6e58fd2a9f3a-7" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_33b3f08c53564249bf5e6e58fd2a9f3a-7"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;stiff&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ncoords&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ncoords&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_33b3f08c53564249bf5e6e58fd2a9f3a-8" name="rest_code_33b3f08c53564249bf5e6e58fd2a9f3a-8" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_33b3f08c53564249bf5e6e58fd2a9f3a-8"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;rhs&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ncoords&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_33b3f08c53564249bf5e6e58fd2a9f3a-9" name="rest_code_33b3f08c53564249bf5e6e58fd2a9f3a-9" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_33b3f08c53564249bf5e6e58fd2a9f3a-9"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;for&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;el_cont&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="n"&gt;nelems&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_33b3f08c53564249bf5e6e58fd2a9f3a-10" name="rest_code_33b3f08c53564249bf5e6e58fd2a9f3a-10" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_33b3f08c53564249bf5e6e58fd2a9f3a-10"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;elem&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;elems&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;el_cont&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_33b3f08c53564249bf5e6e58fd2a9f3a-11" name="rest_code_33b3f08c53564249bf5e6e58fd2a9f3a-11" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_33b3f08c53564249bf5e6e58fd2a9f3a-11"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;stiff_loc&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;jaco&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;local_stiff&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;elem&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_33b3f08c53564249bf5e6e58fd2a9f3a-12" name="rest_code_33b3f08c53564249bf5e6e58fd2a9f3a-12" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_33b3f08c53564249bf5e6e58fd2a9f3a-12"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;rhs&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;elem&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;jaco&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;mean&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;source&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;elem&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_33b3f08c53564249bf5e6e58fd2a9f3a-13" name="rest_code_33b3f08c53564249bf5e6e58fd2a9f3a-13" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_33b3f08c53564249bf5e6e58fd2a9f3a-13"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="k"&gt;for&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;row&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_33b3f08c53564249bf5e6e58fd2a9f3a-14" name="rest_code_33b3f08c53564249bf5e6e58fd2a9f3a-14" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_33b3f08c53564249bf5e6e58fd2a9f3a-14"&gt;&lt;/a&gt;&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="k"&gt;for&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_33b3f08c53564249bf5e6e58fd2a9f3a-15" name="rest_code_33b3f08c53564249bf5e6e58fd2a9f3a-15" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_33b3f08c53564249bf5e6e58fd2a9f3a-15"&gt;&lt;/a&gt;&lt;span class="w"&gt;                &lt;/span&gt;&lt;span class="n"&gt;row_glob&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;elem&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;row&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_33b3f08c53564249bf5e6e58fd2a9f3a-16" name="rest_code_33b3f08c53564249bf5e6e58fd2a9f3a-16" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_33b3f08c53564249bf5e6e58fd2a9f3a-16"&gt;&lt;/a&gt;&lt;span class="w"&gt;                &lt;/span&gt;&lt;span class="n"&gt;col_glob&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;elem&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_33b3f08c53564249bf5e6e58fd2a9f3a-17" name="rest_code_33b3f08c53564249bf5e6e58fd2a9f3a-17" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_33b3f08c53564249bf5e6e58fd2a9f3a-17"&gt;&lt;/a&gt;&lt;span class="w"&gt;                &lt;/span&gt;&lt;span class="n"&gt;stiff&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;row_glob&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;col_glob&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;stiff_loc&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;row&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_33b3f08c53564249bf5e6e58fd2a9f3a-18" name="rest_code_33b3f08c53564249bf5e6e58fd2a9f3a-18" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_33b3f08c53564249bf5e6e58fd2a9f3a-18"&gt;&lt;/a&gt;&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="k"&gt;end&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_33b3f08c53564249bf5e6e58fd2a9f3a-19" name="rest_code_33b3f08c53564249bf5e6e58fd2a9f3a-19" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_33b3f08c53564249bf5e6e58fd2a9f3a-19"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="k"&gt;end&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_33b3f08c53564249bf5e6e58fd2a9f3a-20" name="rest_code_33b3f08c53564249bf5e6e58fd2a9f3a-20" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_33b3f08c53564249bf5e6e58fd2a9f3a-20"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;end&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_33b3f08c53564249bf5e6e58fd2a9f3a-21" name="rest_code_33b3f08c53564249bf5e6e58fd2a9f3a-21" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_33b3f08c53564249bf5e6e58fd2a9f3a-21"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;return&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;stiff&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;rhs&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_33b3f08c53564249bf5e6e58fd2a9f3a-22" name="rest_code_33b3f08c53564249bf5e6e58fd2a9f3a-22" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_33b3f08c53564249bf5e6e58fd2a9f3a-22"&gt;&lt;/a&gt;&lt;span class="k"&gt;end&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_33b3f08c53564249bf5e6e58fd2a9f3a-23" name="rest_code_33b3f08c53564249bf5e6e58fd2a9f3a-23" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_33b3f08c53564249bf5e6e58fd2a9f3a-23"&gt;&lt;/a&gt;
&lt;a id="rest_code_33b3f08c53564249bf5e6e58fd2a9f3a-24" name="rest_code_33b3f08c53564249bf5e6e58fd2a9f3a-24" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_33b3f08c53564249bf5e6e58fd2a9f3a-24"&gt;&lt;/a&gt;
&lt;a id="rest_code_33b3f08c53564249bf5e6e58fd2a9f3a-25" name="rest_code_33b3f08c53564249bf5e6e58fd2a9f3a-25" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_33b3f08c53564249bf5e6e58fd2a9f3a-25"&gt;&lt;/a&gt;&lt;span class="k"&gt;function&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;local_stiff&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_33b3f08c53564249bf5e6e58fd2a9f3a-26" name="rest_code_33b3f08c53564249bf5e6e58fd2a9f3a-26" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_33b3f08c53564249bf5e6e58fd2a9f3a-26"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;dHdr&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_33b3f08c53564249bf5e6e58fd2a9f3a-27" name="rest_code_33b3f08c53564249bf5e6e58fd2a9f3a-27" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_33b3f08c53564249bf5e6e58fd2a9f3a-27"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;jaco&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;dHdr&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_33b3f08c53564249bf5e6e58fd2a9f3a-28" name="rest_code_33b3f08c53564249bf5e6e58fd2a9f3a-28" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_33b3f08c53564249bf5e6e58fd2a9f3a-28"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;stiff&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;0.5&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_33b3f08c53564249bf5e6e58fd2a9f3a-29" name="rest_code_33b3f08c53564249bf5e6e58fd2a9f3a-29" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_33b3f08c53564249bf5e6e58fd2a9f3a-29"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;return&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;stiff&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;det&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;jaco&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;det&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;jaco&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_33b3f08c53564249bf5e6e58fd2a9f3a-30" name="rest_code_33b3f08c53564249bf5e6e58fd2a9f3a-30" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_33b3f08c53564249bf5e6e58fd2a9f3a-30"&gt;&lt;/a&gt;&lt;span class="k"&gt;end&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_33b3f08c53564249bf5e6e58fd2a9f3a-31" name="rest_code_33b3f08c53564249bf5e6e58fd2a9f3a-31" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_33b3f08c53564249bf5e6e58fd2a9f3a-31"&gt;&lt;/a&gt;
&lt;a id="rest_code_33b3f08c53564249bf5e6e58fd2a9f3a-32" name="rest_code_33b3f08c53564249bf5e6e58fd2a9f3a-32" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_33b3f08c53564249bf5e6e58fd2a9f3a-32"&gt;&lt;/a&gt;
&lt;a id="rest_code_33b3f08c53564249bf5e6e58fd2a9f3a-33" name="rest_code_33b3f08c53564249bf5e6e58fd2a9f3a-33" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_33b3f08c53564249bf5e6e58fd2a9f3a-33"&gt;&lt;/a&gt;&lt;span class="n"&gt;sq3&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;sqrt&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_33b3f08c53564249bf5e6e58fd2a9f3a-34" name="rest_code_33b3f08c53564249bf5e6e58fd2a9f3a-34" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_33b3f08c53564249bf5e6e58fd2a9f3a-34"&gt;&lt;/a&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;sq3&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_33b3f08c53564249bf5e6e58fd2a9f3a-35" name="rest_code_33b3f08c53564249bf5e6e58fd2a9f3a-35" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_33b3f08c53564249bf5e6e58fd2a9f3a-35"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_33b3f08c53564249bf5e6e58fd2a9f3a-36" name="rest_code_33b3f08c53564249bf5e6e58fd2a9f3a-36" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_33b3f08c53564249bf5e6e58fd2a9f3a-36"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;sq3&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_33b3f08c53564249bf5e6e58fd2a9f3a-37" name="rest_code_33b3f08c53564249bf5e6e58fd2a9f3a-37" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_33b3f08c53564249bf5e6e58fd2a9f3a-37"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_33b3f08c53564249bf5e6e58fd2a9f3a-38" name="rest_code_33b3f08c53564249bf5e6e58fd2a9f3a-38" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_33b3f08c53564249bf5e6e58fd2a9f3a-38"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;sq3&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_33b3f08c53564249bf5e6e58fd2a9f3a-39" name="rest_code_33b3f08c53564249bf5e6e58fd2a9f3a-39" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_33b3f08c53564249bf5e6e58fd2a9f3a-39"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;sq3&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_33b3f08c53564249bf5e6e58fd2a9f3a-40" name="rest_code_33b3f08c53564249bf5e6e58fd2a9f3a-40" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_33b3f08c53564249bf5e6e58fd2a9f3a-40"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;sq3&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_33b3f08c53564249bf5e6e58fd2a9f3a-41" name="rest_code_33b3f08c53564249bf5e6e58fd2a9f3a-41" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_33b3f08c53564249bf5e6e58fd2a9f3a-41"&gt;&lt;/a&gt;&lt;span class="n"&gt;elems&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;7&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_33b3f08c53564249bf5e6e58fd2a9f3a-42" name="rest_code_33b3f08c53564249bf5e6e58fd2a9f3a-42" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_33b3f08c53564249bf5e6e58fd2a9f3a-42"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;7&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_33b3f08c53564249bf5e6e58fd2a9f3a-43" name="rest_code_33b3f08c53564249bf5e6e58fd2a9f3a-43" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_33b3f08c53564249bf5e6e58fd2a9f3a-43"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;7&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_33b3f08c53564249bf5e6e58fd2a9f3a-44" name="rest_code_33b3f08c53564249bf5e6e58fd2a9f3a-44" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_33b3f08c53564249bf5e6e58fd2a9f3a-44"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;6&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;7&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_33b3f08c53564249bf5e6e58fd2a9f3a-45" name="rest_code_33b3f08c53564249bf5e6e58fd2a9f3a-45" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_33b3f08c53564249bf5e6e58fd2a9f3a-45"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="mi"&gt;6&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;7&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_33b3f08c53564249bf5e6e58fd2a9f3a-46" name="rest_code_33b3f08c53564249bf5e6e58fd2a9f3a-46" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_33b3f08c53564249bf5e6e58fd2a9f3a-46"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;7&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_33b3f08c53564249bf5e6e58fd2a9f3a-47" name="rest_code_33b3f08c53564249bf5e6e58fd2a9f3a-47" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_33b3f08c53564249bf5e6e58fd2a9f3a-47"&gt;&lt;/a&gt;&lt;span class="n"&gt;source&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;ones&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;7&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_33b3f08c53564249bf5e6e58fd2a9f3a-48" name="rest_code_33b3f08c53564249bf5e6e58fd2a9f3a-48" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_33b3f08c53564249bf5e6e58fd2a9f3a-48"&gt;&lt;/a&gt;&lt;span class="n"&gt;stiff&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;rhs&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;assem&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;elems&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;source&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_33b3f08c53564249bf5e6e58fd2a9f3a-49" name="rest_code_33b3f08c53564249bf5e6e58fd2a9f3a-49" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_33b3f08c53564249bf5e6e58fd2a9f3a-49"&gt;&lt;/a&gt;&lt;span class="n"&gt;free&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;6&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_33b3f08c53564249bf5e6e58fd2a9f3a-50" name="rest_code_33b3f08c53564249bf5e6e58fd2a9f3a-50" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_33b3f08c53564249bf5e6e58fd2a9f3a-50"&gt;&lt;/a&gt;&lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;stiff&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;free&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;free&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;\&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;rhs&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;free&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_33b3f08c53564249bf5e6e58fd2a9f3a-51" name="rest_code_33b3f08c53564249bf5e6e58fd2a9f3a-51" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_33b3f08c53564249bf5e6e58fd2a9f3a-51"&gt;&lt;/a&gt;&lt;span class="n"&gt;sol_c&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;size&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;)[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_33b3f08c53564249bf5e6e58fd2a9f3a-52" name="rest_code_33b3f08c53564249bf5e6e58fd2a9f3a-52" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_33b3f08c53564249bf5e6e58fd2a9f3a-52"&gt;&lt;/a&gt;&lt;span class="n"&gt;sol_c&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;free&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_33b3f08c53564249bf5e6e58fd2a9f3a-53" name="rest_code_33b3f08c53564249bf5e6e58fd2a9f3a-53" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_33b3f08c53564249bf5e6e58fd2a9f3a-53"&gt;&lt;/a&gt;&lt;span class="n"&gt;tricontourf&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;sol_c&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;cmap&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;"hot"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_33b3f08c53564249bf5e6e58fd2a9f3a-54" name="rest_code_33b3f08c53564249bf5e6e58fd2a9f3a-54" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_33b3f08c53564249bf5e6e58fd2a9f3a-54"&gt;&lt;/a&gt;&lt;span class="n"&gt;colorbar&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_33b3f08c53564249bf5e6e58fd2a9f3a-55" name="rest_code_33b3f08c53564249bf5e6e58fd2a9f3a-55" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_33b3f08c53564249bf5e6e58fd2a9f3a-55"&gt;&lt;/a&gt;&lt;span class="n"&gt;axis&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;"image"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_33b3f08c53564249bf5e6e58fd2a9f3a-56" name="rest_code_33b3f08c53564249bf5e6e58fd2a9f3a-56" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_33b3f08c53564249bf5e6e58fd2a9f3a-56"&gt;&lt;/a&gt;&lt;span class="n"&gt;show&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Both have the same result, as follows&lt;/p&gt;
&lt;img alt="Finite element method approximation." class="align-center" src="https://nicoguaro.github.io/images/FEM2D.svg" style="width: 500px;"&gt;
&lt;/section&gt;
&lt;section id="comparison-python-julia"&gt;
&lt;h3&gt;Comparison Python/Julia&lt;/h3&gt;
&lt;p&gt;Regarding number of lines we have: 51 in Python and 56 in Julia. The comparison
in execution time is done with &lt;code class="docutils literal"&gt;%timeit&lt;/code&gt; magic command in IPython and
&lt;code class="docutils literal"&gt;@benchmark&lt;/code&gt; in Julia. For the test we are just comparing the time it takes
to generate the matrices.&lt;/p&gt;
&lt;p&gt;For Python:&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code IPython"&gt;&lt;a id="rest_code_f39991b4719b4e5e8dfe253433566416-1" name="rest_code_f39991b4719b4e5e8dfe253433566416-1" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_f39991b4719b4e5e8dfe253433566416-1"&gt;&lt;/a&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="k"&gt;timeit&lt;/span&gt; assem(coords, elems, source)
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;with result&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code text"&gt;&lt;a id="rest_code_4b006c5b63984ac4b2c697fdc5a88f5b-1" name="rest_code_4b006c5b63984ac4b2c697fdc5a88f5b-1" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_4b006c5b63984ac4b2c697fdc5a88f5b-1"&gt;&lt;/a&gt;1000 loops, best of 3: 671 µs per loop
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;For Julia:&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code julia"&gt;&lt;a id="rest_code_7ba1d3909e6447b7b04846b65bbb2cfc-1" name="rest_code_7ba1d3909e6447b7b04846b65bbb2cfc-1" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_7ba1d3909e6447b7b04846b65bbb2cfc-1"&gt;&lt;/a&gt;&lt;span class="nd"&gt;@benchmark&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;assem&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;elems&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;source&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;with result&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code julia"&gt;&lt;a id="rest_code_fb30ee0691a444ce8419c06e3bcbfd96-1" name="rest_code_fb30ee0691a444ce8419c06e3bcbfd96-1" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_fb30ee0691a444ce8419c06e3bcbfd96-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;BenchmarkTools&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Trial&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_fb30ee0691a444ce8419c06e3bcbfd96-2" name="rest_code_fb30ee0691a444ce8419c06e3bcbfd96-2" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_fb30ee0691a444ce8419c06e3bcbfd96-2"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;memory&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;estimate&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="mf"&gt;13.30&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;KiB&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_fb30ee0691a444ce8419c06e3bcbfd96-3" name="rest_code_fb30ee0691a444ce8419c06e3bcbfd96-3" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_fb30ee0691a444ce8419c06e3bcbfd96-3"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;allocs&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;estimate&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="mi"&gt;179&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_fb30ee0691a444ce8419c06e3bcbfd96-4" name="rest_code_fb30ee0691a444ce8419c06e3bcbfd96-4" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_fb30ee0691a444ce8419c06e3bcbfd96-4"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="o"&gt;--------------&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_fb30ee0691a444ce8419c06e3bcbfd96-5" name="rest_code_fb30ee0691a444ce8419c06e3bcbfd96-5" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_fb30ee0691a444ce8419c06e3bcbfd96-5"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;minimum&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;     &lt;/span&gt;&lt;span class="mf"&gt;7.777&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;μs&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;0.00&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;GC&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_fb30ee0691a444ce8419c06e3bcbfd96-6" name="rest_code_fb30ee0691a444ce8419c06e3bcbfd96-6" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_fb30ee0691a444ce8419c06e3bcbfd96-6"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;median&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="mf"&gt;8.934&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;μs&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;0.00&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;GC&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_fb30ee0691a444ce8419c06e3bcbfd96-7" name="rest_code_fb30ee0691a444ce8419c06e3bcbfd96-7" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_fb30ee0691a444ce8419c06e3bcbfd96-7"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;mean&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="mf"&gt;10.810&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;μs&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;14.54&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;GC&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_fb30ee0691a444ce8419c06e3bcbfd96-8" name="rest_code_fb30ee0691a444ce8419c06e3bcbfd96-8" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_fb30ee0691a444ce8419c06e3bcbfd96-8"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;maximum&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;     &lt;/span&gt;&lt;span class="mf"&gt;797.432&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;μs&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;95.85&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;GC&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_fb30ee0691a444ce8419c06e3bcbfd96-9" name="rest_code_fb30ee0691a444ce8419c06e3bcbfd96-9" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_fb30ee0691a444ce8419c06e3bcbfd96-9"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="o"&gt;--------------&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_fb30ee0691a444ce8419c06e3bcbfd96-10" name="rest_code_fb30ee0691a444ce8419c06e3bcbfd96-10" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_fb30ee0691a444ce8419c06e3bcbfd96-10"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;samples&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;          &lt;/span&gt;&lt;span class="mi"&gt;10000&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_fb30ee0691a444ce8419c06e3bcbfd96-11" name="rest_code_fb30ee0691a444ce8419c06e3bcbfd96-11" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/#rest_code_fb30ee0691a444ce8419c06e3bcbfd96-11"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;evals&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;sample&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;     &lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;In this case, we can say that the Python code is about 70 times slower than
Julia code.&lt;/p&gt;
&lt;/section&gt;
&lt;/section&gt;</description><category>finite element method</category><category>julia</category><category>numerical methods</category><category>python</category><category>scientific computing</category><guid>https://nicoguaro.github.io/posts/numerical_challenge/numerical-25/</guid><pubDate>Thu, 26 Oct 2017 02:41:53 GMT</pubDate></item><item><title>Numerical methods challenge: Day 24</title><link>https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/</link><dc:creator>Nicolás Guarín-Zapata</dc:creator><description>&lt;p&gt;During October (2017) I will write a program per day for some well-known
numerical methods in both Python and Julia. It is intended to be an exercise
then don't expect the code to be good enough for real use. Also,
I should mention that I have almost no experience with Julia, so it
probably won't be idiomatic Julia but more Python-like Julia.&lt;/p&gt;
&lt;section id="finite-element-method"&gt;
&lt;h2&gt;Finite element method&lt;/h2&gt;
&lt;p&gt;Today we have the &lt;a class="reference external" href="https://en.wikipedia.org/wiki/Finite_element_method"&gt;Finite element method&lt;/a&gt;
to solve the equation:&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
\frac{d^2 u}{dx^2} = f(x)
\end{equation*}
&lt;/div&gt;
&lt;p&gt;with&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
u(0) = u(1)  = 0
\end{equation*}
&lt;/div&gt;
&lt;p&gt;As in the &lt;a class="reference external" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/posts/numerical-23"&gt;Ritz method&lt;/a&gt; we form
a functional that is &lt;em&gt;equivalent&lt;/em&gt; to the
differential equation, propose an approximation as a linear combination of
a set of basis functions and find the &lt;em&gt;best&lt;/em&gt; set of coefficients for that
combination. That &lt;em&gt;best&lt;/em&gt; solution is found minimizing the functional.&lt;/p&gt;
&lt;p&gt;The functional for this differential equation is&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
\Pi[u] = -\int_{0}^{1} \left(\frac{d u}{d x}\right)^2 dx
         -\int_{0}^{1}  u f(x) dx
\end{equation*}
&lt;/div&gt;
&lt;p&gt;The main difference is that we use a piecewise interpolation for the basis
functions,&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
\hat{u}(x) = \sum_{n=0}^{N} u_n N_n(x)\, ,
\end{equation*}
&lt;/div&gt;
&lt;p&gt;this leads to the system of equations&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
[K]\{\mathbf{c}\} = \{\mathbf{b}\}
\end{equation*}
&lt;/div&gt;
&lt;p&gt;where the local stiffness matrices read&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
K_\text{local} =  \frac{1}{|J|}\begin{bmatrix} 2 &amp;amp; -2\\ -2 &amp;amp;2\end{bmatrix}
\end{equation*}
&lt;/div&gt;
&lt;p&gt;and&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
b_\text{local} = -|J|\begin{bmatrix} f(x_m)\\ f(x_{n})\end{bmatrix}\, ,
\end{equation*}
&lt;/div&gt;
&lt;p&gt;where &lt;span class="math"&gt;\(|J|\)&lt;/span&gt; is the Jacobian determinant of the transformation. I am
skipping a great deal about assembling, but it would be just too extensive
to describe the complete process.&lt;/p&gt;
&lt;p&gt;We will test the implementation with the function &lt;span class="math"&gt;\(f(x) = x^3\)&lt;/span&gt;, that
leads to the solution&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
u(x) = \frac{x (x^4 - 1)}{20}
\end{equation*}
&lt;/div&gt;
&lt;p&gt;Following are the codes.&lt;/p&gt;
&lt;section id="python"&gt;
&lt;h3&gt;Python&lt;/h3&gt;
&lt;div class="code"&gt;&lt;pre class="code python"&gt;&lt;a id="rest_code_66a40a23098144f585d6a4e8cecded50-1" name="rest_code_66a40a23098144f585d6a4e8cecded50-1" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_66a40a23098144f585d6a4e8cecded50-1"&gt;&lt;/a&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;__future__&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;division&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;print_function&lt;/span&gt;
&lt;a id="rest_code_66a40a23098144f585d6a4e8cecded50-2" name="rest_code_66a40a23098144f585d6a4e8cecded50-2" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_66a40a23098144f585d6a4e8cecded50-2"&gt;&lt;/a&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;numpy&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;np&lt;/span&gt;
&lt;a id="rest_code_66a40a23098144f585d6a4e8cecded50-3" name="rest_code_66a40a23098144f585d6a4e8cecded50-3" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_66a40a23098144f585d6a4e8cecded50-3"&gt;&lt;/a&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;matplotlib.pyplot&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;plt&lt;/span&gt;
&lt;a id="rest_code_66a40a23098144f585d6a4e8cecded50-4" name="rest_code_66a40a23098144f585d6a4e8cecded50-4" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_66a40a23098144f585d6a4e8cecded50-4"&gt;&lt;/a&gt;
&lt;a id="rest_code_66a40a23098144f585d6a4e8cecded50-5" name="rest_code_66a40a23098144f585d6a4e8cecded50-5" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_66a40a23098144f585d6a4e8cecded50-5"&gt;&lt;/a&gt;
&lt;a id="rest_code_66a40a23098144f585d6a4e8cecded50-6" name="rest_code_66a40a23098144f585d6a4e8cecded50-6" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_66a40a23098144f585d6a4e8cecded50-6"&gt;&lt;/a&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;FEM1D&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;source&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_66a40a23098144f585d6a4e8cecded50-7" name="rest_code_66a40a23098144f585d6a4e8cecded50-7" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_66a40a23098144f585d6a4e8cecded50-7"&gt;&lt;/a&gt;    &lt;span class="n"&gt;N&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_66a40a23098144f585d6a4e8cecded50-8" name="rest_code_66a40a23098144f585d6a4e8cecded50-8" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_66a40a23098144f585d6a4e8cecded50-8"&gt;&lt;/a&gt;    &lt;span class="n"&gt;stiff_loc&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;([[&lt;/span&gt;&lt;span class="mf"&gt;2.0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;2.0&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;2.0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;2.0&lt;/span&gt;&lt;span class="p"&gt;]])&lt;/span&gt;
&lt;a id="rest_code_66a40a23098144f585d6a4e8cecded50-9" name="rest_code_66a40a23098144f585d6a4e8cecded50-9" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_66a40a23098144f585d6a4e8cecded50-9"&gt;&lt;/a&gt;    &lt;span class="n"&gt;eles&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="n"&gt;cont&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;cont&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;cont&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;N&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)]&lt;/span&gt;
&lt;a id="rest_code_66a40a23098144f585d6a4e8cecded50-10" name="rest_code_66a40a23098144f585d6a4e8cecded50-10" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_66a40a23098144f585d6a4e8cecded50-10"&gt;&lt;/a&gt;    &lt;span class="n"&gt;stiff&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_66a40a23098144f585d6a4e8cecded50-11" name="rest_code_66a40a23098144f585d6a4e8cecded50-11" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_66a40a23098144f585d6a4e8cecded50-11"&gt;&lt;/a&gt;    &lt;span class="n"&gt;rhs&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_66a40a23098144f585d6a4e8cecded50-12" name="rest_code_66a40a23098144f585d6a4e8cecded50-12" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_66a40a23098144f585d6a4e8cecded50-12"&gt;&lt;/a&gt;    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;ele&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;eles&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a id="rest_code_66a40a23098144f585d6a4e8cecded50-13" name="rest_code_66a40a23098144f585d6a4e8cecded50-13" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_66a40a23098144f585d6a4e8cecded50-13"&gt;&lt;/a&gt;        &lt;span class="n"&gt;jaco&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ele&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]]&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ele&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]]&lt;/span&gt;
&lt;a id="rest_code_66a40a23098144f585d6a4e8cecded50-14" name="rest_code_66a40a23098144f585d6a4e8cecded50-14" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_66a40a23098144f585d6a4e8cecded50-14"&gt;&lt;/a&gt;        &lt;span class="n"&gt;rhs&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ele&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;rhs&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ele&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;jaco&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;source&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ele&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_66a40a23098144f585d6a4e8cecded50-15" name="rest_code_66a40a23098144f585d6a4e8cecded50-15" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_66a40a23098144f585d6a4e8cecded50-15"&gt;&lt;/a&gt;        &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;cont1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;row&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;enumerate&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ele&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_66a40a23098144f585d6a4e8cecded50-16" name="rest_code_66a40a23098144f585d6a4e8cecded50-16" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_66a40a23098144f585d6a4e8cecded50-16"&gt;&lt;/a&gt;            &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;cont2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;col&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;enumerate&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ele&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_66a40a23098144f585d6a4e8cecded50-17" name="rest_code_66a40a23098144f585d6a4e8cecded50-17" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_66a40a23098144f585d6a4e8cecded50-17"&gt;&lt;/a&gt;                &lt;span class="n"&gt;stiff&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;row&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;stiff&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;row&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt;  &lt;span class="n"&gt;stiff_loc&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;cont1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;cont2&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;jaco&lt;/span&gt;
&lt;a id="rest_code_66a40a23098144f585d6a4e8cecded50-18" name="rest_code_66a40a23098144f585d6a4e8cecded50-18" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_66a40a23098144f585d6a4e8cecded50-18"&gt;&lt;/a&gt;    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;stiff&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;rhs&lt;/span&gt;
&lt;a id="rest_code_66a40a23098144f585d6a4e8cecded50-19" name="rest_code_66a40a23098144f585d6a4e8cecded50-19" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_66a40a23098144f585d6a4e8cecded50-19"&gt;&lt;/a&gt;
&lt;a id="rest_code_66a40a23098144f585d6a4e8cecded50-20" name="rest_code_66a40a23098144f585d6a4e8cecded50-20" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_66a40a23098144f585d6a4e8cecded50-20"&gt;&lt;/a&gt;
&lt;a id="rest_code_66a40a23098144f585d6a4e8cecded50-21" name="rest_code_66a40a23098144f585d6a4e8cecded50-21" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_66a40a23098144f585d6a4e8cecded50-21"&gt;&lt;/a&gt;&lt;span class="n"&gt;N&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;100&lt;/span&gt;
&lt;a id="rest_code_66a40a23098144f585d6a4e8cecded50-22" name="rest_code_66a40a23098144f585d6a4e8cecded50-22" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_66a40a23098144f585d6a4e8cecded50-22"&gt;&lt;/a&gt;&lt;span class="n"&gt;fun&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;lambda&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;
&lt;a id="rest_code_66a40a23098144f585d6a4e8cecded50-23" name="rest_code_66a40a23098144f585d6a4e8cecded50-23" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_66a40a23098144f585d6a4e8cecded50-23"&gt;&lt;/a&gt;&lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;linspace&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_66a40a23098144f585d6a4e8cecded50-24" name="rest_code_66a40a23098144f585d6a4e8cecded50-24" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_66a40a23098144f585d6a4e8cecded50-24"&gt;&lt;/a&gt;&lt;span class="n"&gt;stiff&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;rhs&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;FEM1D&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;fun&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_66a40a23098144f585d6a4e8cecded50-25" name="rest_code_66a40a23098144f585d6a4e8cecded50-25" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_66a40a23098144f585d6a4e8cecded50-25"&gt;&lt;/a&gt;&lt;span class="n"&gt;sol&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_66a40a23098144f585d6a4e8cecded50-26" name="rest_code_66a40a23098144f585d6a4e8cecded50-26" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_66a40a23098144f585d6a4e8cecded50-26"&gt;&lt;/a&gt;&lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;linalg&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;solve&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;stiff&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;rhs&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_66a40a23098144f585d6a4e8cecded50-27" name="rest_code_66a40a23098144f585d6a4e8cecded50-27" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_66a40a23098144f585d6a4e8cecded50-27"&gt;&lt;/a&gt;
&lt;a id="rest_code_66a40a23098144f585d6a4e8cecded50-28" name="rest_code_66a40a23098144f585d6a4e8cecded50-28" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_66a40a23098144f585d6a4e8cecded50-28"&gt;&lt;/a&gt;
&lt;a id="rest_code_66a40a23098144f585d6a4e8cecded50-29" name="rest_code_66a40a23098144f585d6a4e8cecded50-29" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_66a40a23098144f585d6a4e8cecded50-29"&gt;&lt;/a&gt;&lt;span class="c1"&gt;#%% Plotting&lt;/span&gt;
&lt;a id="rest_code_66a40a23098144f585d6a4e8cecded50-30" name="rest_code_66a40a23098144f585d6a4e8cecded50-30" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_66a40a23098144f585d6a4e8cecded50-30"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;figure&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;figsize&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_66a40a23098144f585d6a4e8cecded50-31" name="rest_code_66a40a23098144f585d6a4e8cecded50-31" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_66a40a23098144f585d6a4e8cecded50-31"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;plot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_66a40a23098144f585d6a4e8cecded50-32" name="rest_code_66a40a23098144f585d6a4e8cecded50-32" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_66a40a23098144f585d6a4e8cecded50-32"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;plot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="mi"&gt;20&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;linestyle&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;"dashed"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_66a40a23098144f585d6a4e8cecded50-33" name="rest_code_66a40a23098144f585d6a4e8cecded50-33" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_66a40a23098144f585d6a4e8cecded50-33"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="sa"&gt;r&lt;/span&gt;&lt;span class="s2"&gt;"$x$"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_66a40a23098144f585d6a4e8cecded50-34" name="rest_code_66a40a23098144f585d6a4e8cecded50-34" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_66a40a23098144f585d6a4e8cecded50-34"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ylabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="sa"&gt;r&lt;/span&gt;&lt;span class="s2"&gt;"$y$"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_66a40a23098144f585d6a4e8cecded50-35" name="rest_code_66a40a23098144f585d6a4e8cecded50-35" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_66a40a23098144f585d6a4e8cecded50-35"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;legend&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="s2"&gt;"FEM solution"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;"Exact solution"&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_66a40a23098144f585d6a4e8cecded50-36" name="rest_code_66a40a23098144f585d6a4e8cecded50-36" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_66a40a23098144f585d6a4e8cecded50-36"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;tight_layout&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a id="rest_code_66a40a23098144f585d6a4e8cecded50-37" name="rest_code_66a40a23098144f585d6a4e8cecded50-37" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_66a40a23098144f585d6a4e8cecded50-37"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;show&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/section&gt;
&lt;section id="julia"&gt;
&lt;h3&gt;Julia&lt;/h3&gt;
&lt;div class="code"&gt;&lt;pre class="code julia"&gt;&lt;a id="rest_code_6791afdfab5c42c48075086820c72971-1" name="rest_code_6791afdfab5c42c48075086820c72971-1" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_6791afdfab5c42c48075086820c72971-1"&gt;&lt;/a&gt;&lt;span class="k"&gt;using&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;PyPlot&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_6791afdfab5c42c48075086820c72971-2" name="rest_code_6791afdfab5c42c48075086820c72971-2" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_6791afdfab5c42c48075086820c72971-2"&gt;&lt;/a&gt;
&lt;a id="rest_code_6791afdfab5c42c48075086820c72971-3" name="rest_code_6791afdfab5c42c48075086820c72971-3" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_6791afdfab5c42c48075086820c72971-3"&gt;&lt;/a&gt;
&lt;a id="rest_code_6791afdfab5c42c48075086820c72971-4" name="rest_code_6791afdfab5c42c48075086820c72971-4" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_6791afdfab5c42c48075086820c72971-4"&gt;&lt;/a&gt;&lt;span class="k"&gt;function&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;FEM1D&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;source&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_6791afdfab5c42c48075086820c72971-5" name="rest_code_6791afdfab5c42c48075086820c72971-5" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_6791afdfab5c42c48075086820c72971-5"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;length&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_6791afdfab5c42c48075086820c72971-6" name="rest_code_6791afdfab5c42c48075086820c72971-6" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_6791afdfab5c42c48075086820c72971-6"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;stiff_loc&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mf"&gt;2.0&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;2.0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;2.0&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;2.0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_6791afdfab5c42c48075086820c72971-7" name="rest_code_6791afdfab5c42c48075086820c72971-7" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_6791afdfab5c42c48075086820c72971-7"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;eles&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;[[&lt;/span&gt;&lt;span class="n"&gt;cont&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;cont&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;for&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;cont&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;in&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_6791afdfab5c42c48075086820c72971-8" name="rest_code_6791afdfab5c42c48075086820c72971-8" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_6791afdfab5c42c48075086820c72971-8"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;stiff&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_6791afdfab5c42c48075086820c72971-9" name="rest_code_6791afdfab5c42c48075086820c72971-9" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_6791afdfab5c42c48075086820c72971-9"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;rhs&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_6791afdfab5c42c48075086820c72971-10" name="rest_code_6791afdfab5c42c48075086820c72971-10" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_6791afdfab5c42c48075086820c72971-10"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;for&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ele&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;in&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;eles&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_6791afdfab5c42c48075086820c72971-11" name="rest_code_6791afdfab5c42c48075086820c72971-11" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_6791afdfab5c42c48075086820c72971-11"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;jaco&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ele&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;]]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ele&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]]&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_6791afdfab5c42c48075086820c72971-12" name="rest_code_6791afdfab5c42c48075086820c72971-12" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_6791afdfab5c42c48075086820c72971-12"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;rhs&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ele&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;rhs&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ele&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;jaco&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;source&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ele&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_6791afdfab5c42c48075086820c72971-13" name="rest_code_6791afdfab5c42c48075086820c72971-13" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_6791afdfab5c42c48075086820c72971-13"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;stiff&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ele&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ele&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;stiff&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ele&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ele&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;stiff_loc&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;jaco&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_6791afdfab5c42c48075086820c72971-14" name="rest_code_6791afdfab5c42c48075086820c72971-14" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_6791afdfab5c42c48075086820c72971-14"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;end&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_6791afdfab5c42c48075086820c72971-15" name="rest_code_6791afdfab5c42c48075086820c72971-15" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_6791afdfab5c42c48075086820c72971-15"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;return&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;stiff&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;rhs&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_6791afdfab5c42c48075086820c72971-16" name="rest_code_6791afdfab5c42c48075086820c72971-16" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_6791afdfab5c42c48075086820c72971-16"&gt;&lt;/a&gt;&lt;span class="k"&gt;end&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_6791afdfab5c42c48075086820c72971-17" name="rest_code_6791afdfab5c42c48075086820c72971-17" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_6791afdfab5c42c48075086820c72971-17"&gt;&lt;/a&gt;
&lt;a id="rest_code_6791afdfab5c42c48075086820c72971-18" name="rest_code_6791afdfab5c42c48075086820c72971-18" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_6791afdfab5c42c48075086820c72971-18"&gt;&lt;/a&gt;
&lt;a id="rest_code_6791afdfab5c42c48075086820c72971-19" name="rest_code_6791afdfab5c42c48075086820c72971-19" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_6791afdfab5c42c48075086820c72971-19"&gt;&lt;/a&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;100&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_6791afdfab5c42c48075086820c72971-20" name="rest_code_6791afdfab5c42c48075086820c72971-20" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_6791afdfab5c42c48075086820c72971-20"&gt;&lt;/a&gt;&lt;span class="n"&gt;fun&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;.^&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_6791afdfab5c42c48075086820c72971-21" name="rest_code_6791afdfab5c42c48075086820c72971-21" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_6791afdfab5c42c48075086820c72971-21"&gt;&lt;/a&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;linspace&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_6791afdfab5c42c48075086820c72971-22" name="rest_code_6791afdfab5c42c48075086820c72971-22" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_6791afdfab5c42c48075086820c72971-22"&gt;&lt;/a&gt;&lt;span class="n"&gt;stiff&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;rhs&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;FEM1D&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;fun&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_6791afdfab5c42c48075086820c72971-23" name="rest_code_6791afdfab5c42c48075086820c72971-23" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_6791afdfab5c42c48075086820c72971-23"&gt;&lt;/a&gt;&lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_6791afdfab5c42c48075086820c72971-24" name="rest_code_6791afdfab5c42c48075086820c72971-24" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_6791afdfab5c42c48075086820c72971-24"&gt;&lt;/a&gt;&lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="k"&gt;end&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;stiff&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="k"&gt;end&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="k"&gt;end&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;\&lt;/span&gt;&lt;span class="n"&gt;rhs&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="k"&gt;end&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_6791afdfab5c42c48075086820c72971-25" name="rest_code_6791afdfab5c42c48075086820c72971-25" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_6791afdfab5c42c48075086820c72971-25"&gt;&lt;/a&gt;
&lt;a id="rest_code_6791afdfab5c42c48075086820c72971-26" name="rest_code_6791afdfab5c42c48075086820c72971-26" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_6791afdfab5c42c48075086820c72971-26"&gt;&lt;/a&gt;
&lt;a id="rest_code_6791afdfab5c42c48075086820c72971-27" name="rest_code_6791afdfab5c42c48075086820c72971-27" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_6791afdfab5c42c48075086820c72971-27"&gt;&lt;/a&gt;&lt;span class="c"&gt;#%% Plotting&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_6791afdfab5c42c48075086820c72971-28" name="rest_code_6791afdfab5c42c48075086820c72971-28" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_6791afdfab5c42c48075086820c72971-28"&gt;&lt;/a&gt;&lt;span class="n"&gt;figure&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;figsize&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_6791afdfab5c42c48075086820c72971-29" name="rest_code_6791afdfab5c42c48075086820c72971-29" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_6791afdfab5c42c48075086820c72971-29"&gt;&lt;/a&gt;&lt;span class="n"&gt;plot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_6791afdfab5c42c48075086820c72971-30" name="rest_code_6791afdfab5c42c48075086820c72971-30" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_6791afdfab5c42c48075086820c72971-30"&gt;&lt;/a&gt;&lt;span class="n"&gt;plot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;.*&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;.^&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="mi"&gt;20&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;linestyle&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;"dashed"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_6791afdfab5c42c48075086820c72971-31" name="rest_code_6791afdfab5c42c48075086820c72971-31" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_6791afdfab5c42c48075086820c72971-31"&gt;&lt;/a&gt;&lt;span class="n"&gt;xlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="sa"&gt;L&lt;/span&gt;&lt;span class="s"&gt;"&lt;/span&gt;&lt;span class="si"&gt;$x&lt;/span&gt;&lt;span class="s"&gt;$"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_6791afdfab5c42c48075086820c72971-32" name="rest_code_6791afdfab5c42c48075086820c72971-32" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_6791afdfab5c42c48075086820c72971-32"&gt;&lt;/a&gt;&lt;span class="n"&gt;ylabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="sa"&gt;L&lt;/span&gt;&lt;span class="s"&gt;"&lt;/span&gt;&lt;span class="si"&gt;$y&lt;/span&gt;&lt;span class="s"&gt;$"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_6791afdfab5c42c48075086820c72971-33" name="rest_code_6791afdfab5c42c48075086820c72971-33" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_6791afdfab5c42c48075086820c72971-33"&gt;&lt;/a&gt;&lt;span class="n"&gt;legend&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="s"&gt;"FEM solution"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s"&gt;"Exact solution"&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_6791afdfab5c42c48075086820c72971-34" name="rest_code_6791afdfab5c42c48075086820c72971-34" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_6791afdfab5c42c48075086820c72971-34"&gt;&lt;/a&gt;&lt;span class="n"&gt;tight_layout&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_6791afdfab5c42c48075086820c72971-35" name="rest_code_6791afdfab5c42c48075086820c72971-35" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_6791afdfab5c42c48075086820c72971-35"&gt;&lt;/a&gt;&lt;span class="n"&gt;show&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Both have the same result, as follows&lt;/p&gt;
&lt;img alt="Finite element method approximation." class="align-center" src="https://nicoguaro.github.io/images/FEM1D.svg" style="width: 400px;"&gt;
&lt;/section&gt;
&lt;section id="comparison-python-julia"&gt;
&lt;h3&gt;Comparison Python/Julia&lt;/h3&gt;
&lt;p&gt;Regarding number of lines we have: 37 in Python and 35 in Julia. The comparison
in execution time is done with &lt;code class="docutils literal"&gt;%timeit&lt;/code&gt; magic command in IPython and
&lt;code class="docutils literal"&gt;@benchmark&lt;/code&gt; in Julia. For the test we are just comparing the time it takes
to generate the matrices.&lt;/p&gt;
&lt;p&gt;For Python:&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code IPython"&gt;&lt;a id="rest_code_a8ac176f522d4e359f45aafe6981189c-1" name="rest_code_a8ac176f522d4e359f45aafe6981189c-1" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_a8ac176f522d4e359f45aafe6981189c-1"&gt;&lt;/a&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="k"&gt;timeit&lt;/span&gt; FEM1D(x, fun)
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;with result&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code text"&gt;&lt;a id="rest_code_e7f79a7a7c174459a73b17396ece1584-1" name="rest_code_e7f79a7a7c174459a73b17396ece1584-1" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_e7f79a7a7c174459a73b17396ece1584-1"&gt;&lt;/a&gt;100 loops, best of 3: 2.15 ms per loop
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;For Julia:&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code julia"&gt;&lt;a id="rest_code_6dbc66f9d6f54a4fbb4779652a8f9ca4-1" name="rest_code_6dbc66f9d6f54a4fbb4779652a8f9ca4-1" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_6dbc66f9d6f54a4fbb4779652a8f9ca4-1"&gt;&lt;/a&gt;&lt;span class="nd"&gt;@benchmark&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;FEM1D&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;fun&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;with result&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code julia"&gt;&lt;a id="rest_code_fc59ae5bdfe34245b84617eab95330ad-1" name="rest_code_fc59ae5bdfe34245b84617eab95330ad-1" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_fc59ae5bdfe34245b84617eab95330ad-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;BenchmarkTools&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Trial&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_fc59ae5bdfe34245b84617eab95330ad-2" name="rest_code_fc59ae5bdfe34245b84617eab95330ad-2" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_fc59ae5bdfe34245b84617eab95330ad-2"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;memory&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;estimate&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="mf"&gt;183.73&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;KiB&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_fc59ae5bdfe34245b84617eab95330ad-3" name="rest_code_fc59ae5bdfe34245b84617eab95330ad-3" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_fc59ae5bdfe34245b84617eab95330ad-3"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;allocs&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;estimate&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="mi"&gt;1392&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_fc59ae5bdfe34245b84617eab95330ad-4" name="rest_code_fc59ae5bdfe34245b84617eab95330ad-4" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_fc59ae5bdfe34245b84617eab95330ad-4"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="o"&gt;--------------&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_fc59ae5bdfe34245b84617eab95330ad-5" name="rest_code_fc59ae5bdfe34245b84617eab95330ad-5" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_fc59ae5bdfe34245b84617eab95330ad-5"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;minimum&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;     &lt;/span&gt;&lt;span class="mf"&gt;60.045&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;μs&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;0.00&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;GC&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_fc59ae5bdfe34245b84617eab95330ad-6" name="rest_code_fc59ae5bdfe34245b84617eab95330ad-6" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_fc59ae5bdfe34245b84617eab95330ad-6"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;median&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="mf"&gt;70.445&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;μs&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;0.00&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;GC&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_fc59ae5bdfe34245b84617eab95330ad-7" name="rest_code_fc59ae5bdfe34245b84617eab95330ad-7" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_fc59ae5bdfe34245b84617eab95330ad-7"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;mean&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="mf"&gt;98.276&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;μs&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;25.64&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;GC&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_fc59ae5bdfe34245b84617eab95330ad-8" name="rest_code_fc59ae5bdfe34245b84617eab95330ad-8" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_fc59ae5bdfe34245b84617eab95330ad-8"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;maximum&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;     &lt;/span&gt;&lt;span class="mf"&gt;4.269&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ms&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;96.70&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;GC&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_fc59ae5bdfe34245b84617eab95330ad-9" name="rest_code_fc59ae5bdfe34245b84617eab95330ad-9" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_fc59ae5bdfe34245b84617eab95330ad-9"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="o"&gt;--------------&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_fc59ae5bdfe34245b84617eab95330ad-10" name="rest_code_fc59ae5bdfe34245b84617eab95330ad-10" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_fc59ae5bdfe34245b84617eab95330ad-10"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;samples&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;          &lt;/span&gt;&lt;span class="mi"&gt;10000&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_fc59ae5bdfe34245b84617eab95330ad-11" name="rest_code_fc59ae5bdfe34245b84617eab95330ad-11" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/#rest_code_fc59ae5bdfe34245b84617eab95330ad-11"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;evals&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;sample&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;     &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;In this case, we can say that the Python code is roughly 30 times slower than
Julia code.&lt;/p&gt;
&lt;/section&gt;
&lt;/section&gt;</description><category>finite element method</category><category>julia</category><category>numerical methods</category><category>python</category><category>scientific computing</category><guid>https://nicoguaro.github.io/posts/numerical_challenge/numerical-24/</guid><pubDate>Tue, 24 Oct 2017 20:17:58 GMT</pubDate></item><item><title>Numerical methods challenge: Day 23</title><link>https://nicoguaro.github.io/posts/numerical_challenge/numerical-23/</link><dc:creator>Nicolás Guarín-Zapata</dc:creator><description>&lt;p&gt;During October (2017) I will write a program per day for some well-known
numerical methods in both Python and Julia. It is intended to be an exercise
then don't expect the code to be good enough for real use. Also,
I should mention that I have almost no experience with Julia, so it
probably won't be idiomatic Julia but more Python-like Julia.&lt;/p&gt;
&lt;section id="ritz-method"&gt;
&lt;h2&gt;Ritz method&lt;/h2&gt;
&lt;p&gt;Today we have the &lt;a class="reference external" href="https://en.wikipedia.org/wiki/Ritz_method"&gt;Ritz method&lt;/a&gt;
to solve the equation:&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
\frac{d^2 u}{dx^2} = f(x)
\end{equation*}
&lt;/div&gt;
&lt;p&gt;with&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
u(0) = u(1)  = 0
\end{equation*}
&lt;/div&gt;
&lt;p&gt;The method consist in forming a functional that is &lt;em&gt;equivalent&lt;/em&gt; to the
differential equation, propose an approximation as a linear combination of
a set of basis functions and find the &lt;em&gt;best&lt;/em&gt; set of coefficients for that
combination. That &lt;em&gt;best&lt;/em&gt; solution is found minimizing the functional.&lt;/p&gt;
&lt;p&gt;The functional for this differential equation is&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
\Pi[u] = -\int_{0}^{1} \left(\frac{d u}{d x}\right)^2 dx
         -\int_{0}^{1}  u f(x) dx
\end{equation*}
&lt;/div&gt;
&lt;p&gt;In this case, we are using the approximation&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
\hat{u}(x) = x (1 - x)\sum_{n=0}^{N} c_n x^n\, ,
\end{equation*}
&lt;/div&gt;
&lt;p&gt;where we picked the factor &lt;span class="math"&gt;\(x (1 - x)\)&lt;/span&gt; to enforce that the basis
functions satisfy the boundary conditions. The approximated functional
reads&lt;/p&gt;
&lt;div class="math"&gt;
\begin{align*}
\Pi[\hat{u}] = -\sum_{n=0}^{N} \sum_{m=0}^{N} c_n c_m
    \left[\frac{2 + 2m + 2n + 2mn}{(n + m + 1)(n + m + 2)(n + m +3)}\right]
    -\\ \sum_{n=0}^{N} c_n\int_{0}^{1} x^{n + 1}(1 - x) f(x) dx
\end{align*}
&lt;/div&gt;
&lt;p&gt;where, in general, we will need to perform numerical integration for the
second term.&lt;/p&gt;
&lt;p&gt;Minimizing the functional&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
\frac{\partial \Pi[\hat{u}]}{\partial c_m} = 0\, ,
\end{equation*}
&lt;/div&gt;
&lt;p&gt;we obtain the system of equations&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
[K]\{\mathbf{c}\} = \{\mathbf{b}\}
\end{equation*}
&lt;/div&gt;
&lt;p&gt;with&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
K_{mn} = \frac{2 + 2m + 2n + 2mn}{(n + m + 1)(n + m + 2)(n + m +3)}
\end{equation*}
&lt;/div&gt;
&lt;p&gt;and&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
b_m = -\int_{0}^{1} x^{m + 1}(1 - x) f(x) dx\, .
\end{equation*}
&lt;/div&gt;
&lt;p&gt;We will test the implementation with the function &lt;span class="math"&gt;\(f(x) = x^3\)&lt;/span&gt;, that
leads to the solution&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
u(x) = \frac{x (x^4 - 1)}{20}
\end{equation*}
&lt;/div&gt;
&lt;p&gt;Following are the codes.&lt;/p&gt;
&lt;section id="python"&gt;
&lt;h3&gt;Python&lt;/h3&gt;
&lt;div class="code"&gt;&lt;pre class="code python"&gt;&lt;a id="rest_code_ff629757f2164c9a8fb30825c0cf1c0f-1" name="rest_code_ff629757f2164c9a8fb30825c0cf1c0f-1" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-23/#rest_code_ff629757f2164c9a8fb30825c0cf1c0f-1"&gt;&lt;/a&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;__future__&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;division&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;print_function&lt;/span&gt;
&lt;a id="rest_code_ff629757f2164c9a8fb30825c0cf1c0f-2" name="rest_code_ff629757f2164c9a8fb30825c0cf1c0f-2" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-23/#rest_code_ff629757f2164c9a8fb30825c0cf1c0f-2"&gt;&lt;/a&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;numpy&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;np&lt;/span&gt;
&lt;a id="rest_code_ff629757f2164c9a8fb30825c0cf1c0f-3" name="rest_code_ff629757f2164c9a8fb30825c0cf1c0f-3" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-23/#rest_code_ff629757f2164c9a8fb30825c0cf1c0f-3"&gt;&lt;/a&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;scipy.integrate&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;quad&lt;/span&gt;
&lt;a id="rest_code_ff629757f2164c9a8fb30825c0cf1c0f-4" name="rest_code_ff629757f2164c9a8fb30825c0cf1c0f-4" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-23/#rest_code_ff629757f2164c9a8fb30825c0cf1c0f-4"&gt;&lt;/a&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;scipy.linalg&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;solve&lt;/span&gt;
&lt;a id="rest_code_ff629757f2164c9a8fb30825c0cf1c0f-5" name="rest_code_ff629757f2164c9a8fb30825c0cf1c0f-5" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-23/#rest_code_ff629757f2164c9a8fb30825c0cf1c0f-5"&gt;&lt;/a&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;matplotlib.pyplot&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;plt&lt;/span&gt;
&lt;a id="rest_code_ff629757f2164c9a8fb30825c0cf1c0f-6" name="rest_code_ff629757f2164c9a8fb30825c0cf1c0f-6" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-23/#rest_code_ff629757f2164c9a8fb30825c0cf1c0f-6"&gt;&lt;/a&gt;
&lt;a id="rest_code_ff629757f2164c9a8fb30825c0cf1c0f-7" name="rest_code_ff629757f2164c9a8fb30825c0cf1c0f-7" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-23/#rest_code_ff629757f2164c9a8fb30825c0cf1c0f-7"&gt;&lt;/a&gt;
&lt;a id="rest_code_ff629757f2164c9a8fb30825c0cf1c0f-8" name="rest_code_ff629757f2164c9a8fb30825c0cf1c0f-8" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-23/#rest_code_ff629757f2164c9a8fb30825c0cf1c0f-8"&gt;&lt;/a&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;ritz&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;source&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_ff629757f2164c9a8fb30825c0cf1c0f-9" name="rest_code_ff629757f2164c9a8fb30825c0cf1c0f-9" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-23/#rest_code_ff629757f2164c9a8fb30825c0cf1c0f-9"&gt;&lt;/a&gt;    &lt;span class="n"&gt;stiff_mat&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_ff629757f2164c9a8fb30825c0cf1c0f-10" name="rest_code_ff629757f2164c9a8fb30825c0cf1c0f-10" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-23/#rest_code_ff629757f2164c9a8fb30825c0cf1c0f-10"&gt;&lt;/a&gt;    &lt;span class="n"&gt;rhs&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_ff629757f2164c9a8fb30825c0cf1c0f-11" name="rest_code_ff629757f2164c9a8fb30825c0cf1c0f-11" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-23/#rest_code_ff629757f2164c9a8fb30825c0cf1c0f-11"&gt;&lt;/a&gt;    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;row&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_ff629757f2164c9a8fb30825c0cf1c0f-12" name="rest_code_ff629757f2164c9a8fb30825c0cf1c0f-12" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-23/#rest_code_ff629757f2164c9a8fb30825c0cf1c0f-12"&gt;&lt;/a&gt;        &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;col&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_ff629757f2164c9a8fb30825c0cf1c0f-13" name="rest_code_ff629757f2164c9a8fb30825c0cf1c0f-13" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-23/#rest_code_ff629757f2164c9a8fb30825c0cf1c0f-13"&gt;&lt;/a&gt;            &lt;span class="n"&gt;numer&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;row&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;col&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;row&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_ff629757f2164c9a8fb30825c0cf1c0f-14" name="rest_code_ff629757f2164c9a8fb30825c0cf1c0f-14" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-23/#rest_code_ff629757f2164c9a8fb30825c0cf1c0f-14"&gt;&lt;/a&gt;            &lt;span class="n"&gt;denom&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;row&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;col&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;row&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;col&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;row&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;col&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_ff629757f2164c9a8fb30825c0cf1c0f-15" name="rest_code_ff629757f2164c9a8fb30825c0cf1c0f-15" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-23/#rest_code_ff629757f2164c9a8fb30825c0cf1c0f-15"&gt;&lt;/a&gt;            &lt;span class="n"&gt;stiff_mat&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;row&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;numer&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;denom&lt;/span&gt;
&lt;a id="rest_code_ff629757f2164c9a8fb30825c0cf1c0f-16" name="rest_code_ff629757f2164c9a8fb30825c0cf1c0f-16" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-23/#rest_code_ff629757f2164c9a8fb30825c0cf1c0f-16"&gt;&lt;/a&gt;        &lt;span class="n"&gt;fun&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;lambda&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;row&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;source&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_ff629757f2164c9a8fb30825c0cf1c0f-17" name="rest_code_ff629757f2164c9a8fb30825c0cf1c0f-17" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-23/#rest_code_ff629757f2164c9a8fb30825c0cf1c0f-17"&gt;&lt;/a&gt;        &lt;span class="n"&gt;rhs&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;row&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;_&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;quad&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;fun&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_ff629757f2164c9a8fb30825c0cf1c0f-18" name="rest_code_ff629757f2164c9a8fb30825c0cf1c0f-18" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-23/#rest_code_ff629757f2164c9a8fb30825c0cf1c0f-18"&gt;&lt;/a&gt;    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;stiff_mat&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;rhs&lt;/span&gt;
&lt;a id="rest_code_ff629757f2164c9a8fb30825c0cf1c0f-19" name="rest_code_ff629757f2164c9a8fb30825c0cf1c0f-19" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-23/#rest_code_ff629757f2164c9a8fb30825c0cf1c0f-19"&gt;&lt;/a&gt;
&lt;a id="rest_code_ff629757f2164c9a8fb30825c0cf1c0f-20" name="rest_code_ff629757f2164c9a8fb30825c0cf1c0f-20" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-23/#rest_code_ff629757f2164c9a8fb30825c0cf1c0f-20"&gt;&lt;/a&gt;
&lt;a id="rest_code_ff629757f2164c9a8fb30825c0cf1c0f-21" name="rest_code_ff629757f2164c9a8fb30825c0cf1c0f-21" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-23/#rest_code_ff629757f2164c9a8fb30825c0cf1c0f-21"&gt;&lt;/a&gt;&lt;span class="n"&gt;N&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;
&lt;a id="rest_code_ff629757f2164c9a8fb30825c0cf1c0f-22" name="rest_code_ff629757f2164c9a8fb30825c0cf1c0f-22" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-23/#rest_code_ff629757f2164c9a8fb30825c0cf1c0f-22"&gt;&lt;/a&gt;&lt;span class="n"&gt;source&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;lambda&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;
&lt;a id="rest_code_ff629757f2164c9a8fb30825c0cf1c0f-23" name="rest_code_ff629757f2164c9a8fb30825c0cf1c0f-23" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-23/#rest_code_ff629757f2164c9a8fb30825c0cf1c0f-23"&gt;&lt;/a&gt;&lt;span class="n"&gt;mat&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;rhs&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;ritz&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;source&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_ff629757f2164c9a8fb30825c0cf1c0f-24" name="rest_code_ff629757f2164c9a8fb30825c0cf1c0f-24" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-23/#rest_code_ff629757f2164c9a8fb30825c0cf1c0f-24"&gt;&lt;/a&gt;&lt;span class="n"&gt;c&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;solve&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;mat&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;rhs&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_ff629757f2164c9a8fb30825c0cf1c0f-25" name="rest_code_ff629757f2164c9a8fb30825c0cf1c0f-25" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-23/#rest_code_ff629757f2164c9a8fb30825c0cf1c0f-25"&gt;&lt;/a&gt;&lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;linspace&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;100&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_ff629757f2164c9a8fb30825c0cf1c0f-26" name="rest_code_ff629757f2164c9a8fb30825c0cf1c0f-26" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-23/#rest_code_ff629757f2164c9a8fb30825c0cf1c0f-26"&gt;&lt;/a&gt;&lt;span class="n"&gt;y&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros_like&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_ff629757f2164c9a8fb30825c0cf1c0f-27" name="rest_code_ff629757f2164c9a8fb30825c0cf1c0f-27" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-23/#rest_code_ff629757f2164c9a8fb30825c0cf1c0f-27"&gt;&lt;/a&gt;&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;cont&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_ff629757f2164c9a8fb30825c0cf1c0f-28" name="rest_code_ff629757f2164c9a8fb30825c0cf1c0f-28" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-23/#rest_code_ff629757f2164c9a8fb30825c0cf1c0f-28"&gt;&lt;/a&gt;    &lt;span class="n"&gt;y&lt;/span&gt; &lt;span class="o"&gt;+=&lt;/span&gt; &lt;span class="n"&gt;c&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;cont&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;cont&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_ff629757f2164c9a8fb30825c0cf1c0f-29" name="rest_code_ff629757f2164c9a8fb30825c0cf1c0f-29" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-23/#rest_code_ff629757f2164c9a8fb30825c0cf1c0f-29"&gt;&lt;/a&gt;
&lt;a id="rest_code_ff629757f2164c9a8fb30825c0cf1c0f-30" name="rest_code_ff629757f2164c9a8fb30825c0cf1c0f-30" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-23/#rest_code_ff629757f2164c9a8fb30825c0cf1c0f-30"&gt;&lt;/a&gt;&lt;span class="c1"&gt;#%% Plotting&lt;/span&gt;
&lt;a id="rest_code_ff629757f2164c9a8fb30825c0cf1c0f-31" name="rest_code_ff629757f2164c9a8fb30825c0cf1c0f-31" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-23/#rest_code_ff629757f2164c9a8fb30825c0cf1c0f-31"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;figure&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;figsize&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_ff629757f2164c9a8fb30825c0cf1c0f-32" name="rest_code_ff629757f2164c9a8fb30825c0cf1c0f-32" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-23/#rest_code_ff629757f2164c9a8fb30825c0cf1c0f-32"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;plot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_ff629757f2164c9a8fb30825c0cf1c0f-33" name="rest_code_ff629757f2164c9a8fb30825c0cf1c0f-33" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-23/#rest_code_ff629757f2164c9a8fb30825c0cf1c0f-33"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;plot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="mi"&gt;20&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;linestyle&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;"dashed"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_ff629757f2164c9a8fb30825c0cf1c0f-34" name="rest_code_ff629757f2164c9a8fb30825c0cf1c0f-34" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-23/#rest_code_ff629757f2164c9a8fb30825c0cf1c0f-34"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="sa"&gt;r&lt;/span&gt;&lt;span class="s2"&gt;"$x$"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_ff629757f2164c9a8fb30825c0cf1c0f-35" name="rest_code_ff629757f2164c9a8fb30825c0cf1c0f-35" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-23/#rest_code_ff629757f2164c9a8fb30825c0cf1c0f-35"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ylabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="sa"&gt;r&lt;/span&gt;&lt;span class="s2"&gt;"$y$"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_ff629757f2164c9a8fb30825c0cf1c0f-36" name="rest_code_ff629757f2164c9a8fb30825c0cf1c0f-36" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-23/#rest_code_ff629757f2164c9a8fb30825c0cf1c0f-36"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;legend&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="s2"&gt;"Ritz solution"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;"Exact solution"&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_ff629757f2164c9a8fb30825c0cf1c0f-37" name="rest_code_ff629757f2164c9a8fb30825c0cf1c0f-37" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-23/#rest_code_ff629757f2164c9a8fb30825c0cf1c0f-37"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;tight_layout&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a id="rest_code_ff629757f2164c9a8fb30825c0cf1c0f-38" name="rest_code_ff629757f2164c9a8fb30825c0cf1c0f-38" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-23/#rest_code_ff629757f2164c9a8fb30825c0cf1c0f-38"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;show&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/section&gt;
&lt;section id="julia"&gt;
&lt;h3&gt;Julia&lt;/h3&gt;
&lt;div class="code"&gt;&lt;pre class="code julia"&gt;&lt;a id="rest_code_3f2f820ca091438ea63801d2bc0b8ba8-1" name="rest_code_3f2f820ca091438ea63801d2bc0b8ba8-1" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-23/#rest_code_3f2f820ca091438ea63801d2bc0b8ba8-1"&gt;&lt;/a&gt;&lt;span class="k"&gt;using&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;PyPlot&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_3f2f820ca091438ea63801d2bc0b8ba8-2" name="rest_code_3f2f820ca091438ea63801d2bc0b8ba8-2" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-23/#rest_code_3f2f820ca091438ea63801d2bc0b8ba8-2"&gt;&lt;/a&gt;
&lt;a id="rest_code_3f2f820ca091438ea63801d2bc0b8ba8-3" name="rest_code_3f2f820ca091438ea63801d2bc0b8ba8-3" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-23/#rest_code_3f2f820ca091438ea63801d2bc0b8ba8-3"&gt;&lt;/a&gt;
&lt;a id="rest_code_3f2f820ca091438ea63801d2bc0b8ba8-4" name="rest_code_3f2f820ca091438ea63801d2bc0b8ba8-4" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-23/#rest_code_3f2f820ca091438ea63801d2bc0b8ba8-4"&gt;&lt;/a&gt;&lt;span class="k"&gt;function&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ritz&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;source&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_3f2f820ca091438ea63801d2bc0b8ba8-5" name="rest_code_3f2f820ca091438ea63801d2bc0b8ba8-5" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-23/#rest_code_3f2f820ca091438ea63801d2bc0b8ba8-5"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;stiff_mat&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_3f2f820ca091438ea63801d2bc0b8ba8-6" name="rest_code_3f2f820ca091438ea63801d2bc0b8ba8-6" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-23/#rest_code_3f2f820ca091438ea63801d2bc0b8ba8-6"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;rhs&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_3f2f820ca091438ea63801d2bc0b8ba8-7" name="rest_code_3f2f820ca091438ea63801d2bc0b8ba8-7" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-23/#rest_code_3f2f820ca091438ea63801d2bc0b8ba8-7"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;for&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;row&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;in&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_3f2f820ca091438ea63801d2bc0b8ba8-8" name="rest_code_3f2f820ca091438ea63801d2bc0b8ba8-8" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-23/#rest_code_3f2f820ca091438ea63801d2bc0b8ba8-8"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="k"&gt;for&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;in&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_3f2f820ca091438ea63801d2bc0b8ba8-9" name="rest_code_3f2f820ca091438ea63801d2bc0b8ba8-9" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-23/#rest_code_3f2f820ca091438ea63801d2bc0b8ba8-9"&gt;&lt;/a&gt;&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="n"&gt;numer&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;row&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;row&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_3f2f820ca091438ea63801d2bc0b8ba8-10" name="rest_code_3f2f820ca091438ea63801d2bc0b8ba8-10" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-23/#rest_code_3f2f820ca091438ea63801d2bc0b8ba8-10"&gt;&lt;/a&gt;&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="n"&gt;denom&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;row&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;row&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;row&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_3f2f820ca091438ea63801d2bc0b8ba8-11" name="rest_code_3f2f820ca091438ea63801d2bc0b8ba8-11" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-23/#rest_code_3f2f820ca091438ea63801d2bc0b8ba8-11"&gt;&lt;/a&gt;&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="n"&gt;stiff_mat&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;row&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;numer&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;denom&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_3f2f820ca091438ea63801d2bc0b8ba8-12" name="rest_code_3f2f820ca091438ea63801d2bc0b8ba8-12" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-23/#rest_code_3f2f820ca091438ea63801d2bc0b8ba8-12"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="k"&gt;end&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_3f2f820ca091438ea63801d2bc0b8ba8-13" name="rest_code_3f2f820ca091438ea63801d2bc0b8ba8-13" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-23/#rest_code_3f2f820ca091438ea63801d2bc0b8ba8-13"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;fun&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;^&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;row&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;source&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_3f2f820ca091438ea63801d2bc0b8ba8-14" name="rest_code_3f2f820ca091438ea63801d2bc0b8ba8-14" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-23/#rest_code_3f2f820ca091438ea63801d2bc0b8ba8-14"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;rhs&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;row&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;_&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;quadgk&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;fun&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_3f2f820ca091438ea63801d2bc0b8ba8-15" name="rest_code_3f2f820ca091438ea63801d2bc0b8ba8-15" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-23/#rest_code_3f2f820ca091438ea63801d2bc0b8ba8-15"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;end&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_3f2f820ca091438ea63801d2bc0b8ba8-16" name="rest_code_3f2f820ca091438ea63801d2bc0b8ba8-16" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-23/#rest_code_3f2f820ca091438ea63801d2bc0b8ba8-16"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;return&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;stiff_mat&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;rhs&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_3f2f820ca091438ea63801d2bc0b8ba8-17" name="rest_code_3f2f820ca091438ea63801d2bc0b8ba8-17" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-23/#rest_code_3f2f820ca091438ea63801d2bc0b8ba8-17"&gt;&lt;/a&gt;&lt;span class="k"&gt;end&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_3f2f820ca091438ea63801d2bc0b8ba8-18" name="rest_code_3f2f820ca091438ea63801d2bc0b8ba8-18" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-23/#rest_code_3f2f820ca091438ea63801d2bc0b8ba8-18"&gt;&lt;/a&gt;
&lt;a id="rest_code_3f2f820ca091438ea63801d2bc0b8ba8-19" name="rest_code_3f2f820ca091438ea63801d2bc0b8ba8-19" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-23/#rest_code_3f2f820ca091438ea63801d2bc0b8ba8-19"&gt;&lt;/a&gt;
&lt;a id="rest_code_3f2f820ca091438ea63801d2bc0b8ba8-20" name="rest_code_3f2f820ca091438ea63801d2bc0b8ba8-20" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-23/#rest_code_3f2f820ca091438ea63801d2bc0b8ba8-20"&gt;&lt;/a&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_3f2f820ca091438ea63801d2bc0b8ba8-21" name="rest_code_3f2f820ca091438ea63801d2bc0b8ba8-21" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-23/#rest_code_3f2f820ca091438ea63801d2bc0b8ba8-21"&gt;&lt;/a&gt;&lt;span class="n"&gt;source&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;^&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_3f2f820ca091438ea63801d2bc0b8ba8-22" name="rest_code_3f2f820ca091438ea63801d2bc0b8ba8-22" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-23/#rest_code_3f2f820ca091438ea63801d2bc0b8ba8-22"&gt;&lt;/a&gt;&lt;span class="n"&gt;mat&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;rhs&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ritz&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;source&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_3f2f820ca091438ea63801d2bc0b8ba8-23" name="rest_code_3f2f820ca091438ea63801d2bc0b8ba8-23" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-23/#rest_code_3f2f820ca091438ea63801d2bc0b8ba8-23"&gt;&lt;/a&gt;&lt;span class="n"&gt;c&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;mat&lt;/span&gt;&lt;span class="o"&gt;\&lt;/span&gt;&lt;span class="n"&gt;rhs&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_3f2f820ca091438ea63801d2bc0b8ba8-24" name="rest_code_3f2f820ca091438ea63801d2bc0b8ba8-24" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-23/#rest_code_3f2f820ca091438ea63801d2bc0b8ba8-24"&gt;&lt;/a&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;linspace&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;100&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_3f2f820ca091438ea63801d2bc0b8ba8-25" name="rest_code_3f2f820ca091438ea63801d2bc0b8ba8-25" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-23/#rest_code_3f2f820ca091438ea63801d2bc0b8ba8-25"&gt;&lt;/a&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_3f2f820ca091438ea63801d2bc0b8ba8-26" name="rest_code_3f2f820ca091438ea63801d2bc0b8ba8-26" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-23/#rest_code_3f2f820ca091438ea63801d2bc0b8ba8-26"&gt;&lt;/a&gt;&lt;span class="k"&gt;for&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;cont&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;in&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_3f2f820ca091438ea63801d2bc0b8ba8-27" name="rest_code_3f2f820ca091438ea63801d2bc0b8ba8-27" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-23/#rest_code_3f2f820ca091438ea63801d2bc0b8ba8-27"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;c&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;cont&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;.^&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;cont&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.*&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_3f2f820ca091438ea63801d2bc0b8ba8-28" name="rest_code_3f2f820ca091438ea63801d2bc0b8ba8-28" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-23/#rest_code_3f2f820ca091438ea63801d2bc0b8ba8-28"&gt;&lt;/a&gt;&lt;span class="k"&gt;end&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_3f2f820ca091438ea63801d2bc0b8ba8-29" name="rest_code_3f2f820ca091438ea63801d2bc0b8ba8-29" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-23/#rest_code_3f2f820ca091438ea63801d2bc0b8ba8-29"&gt;&lt;/a&gt;
&lt;a id="rest_code_3f2f820ca091438ea63801d2bc0b8ba8-30" name="rest_code_3f2f820ca091438ea63801d2bc0b8ba8-30" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-23/#rest_code_3f2f820ca091438ea63801d2bc0b8ba8-30"&gt;&lt;/a&gt;&lt;span class="c"&gt;#%% Plotting&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_3f2f820ca091438ea63801d2bc0b8ba8-31" name="rest_code_3f2f820ca091438ea63801d2bc0b8ba8-31" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-23/#rest_code_3f2f820ca091438ea63801d2bc0b8ba8-31"&gt;&lt;/a&gt;&lt;span class="n"&gt;figure&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;figsize&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_3f2f820ca091438ea63801d2bc0b8ba8-32" name="rest_code_3f2f820ca091438ea63801d2bc0b8ba8-32" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-23/#rest_code_3f2f820ca091438ea63801d2bc0b8ba8-32"&gt;&lt;/a&gt;&lt;span class="n"&gt;plot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_3f2f820ca091438ea63801d2bc0b8ba8-33" name="rest_code_3f2f820ca091438ea63801d2bc0b8ba8-33" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-23/#rest_code_3f2f820ca091438ea63801d2bc0b8ba8-33"&gt;&lt;/a&gt;&lt;span class="n"&gt;plot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;.*&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;.^&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="mi"&gt;20&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;linestyle&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;"dashed"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_3f2f820ca091438ea63801d2bc0b8ba8-34" name="rest_code_3f2f820ca091438ea63801d2bc0b8ba8-34" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-23/#rest_code_3f2f820ca091438ea63801d2bc0b8ba8-34"&gt;&lt;/a&gt;&lt;span class="n"&gt;xlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="sa"&gt;L&lt;/span&gt;&lt;span class="s"&gt;"&lt;/span&gt;&lt;span class="si"&gt;$x&lt;/span&gt;&lt;span class="s"&gt;$"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_3f2f820ca091438ea63801d2bc0b8ba8-35" name="rest_code_3f2f820ca091438ea63801d2bc0b8ba8-35" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-23/#rest_code_3f2f820ca091438ea63801d2bc0b8ba8-35"&gt;&lt;/a&gt;&lt;span class="n"&gt;ylabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="sa"&gt;L&lt;/span&gt;&lt;span class="s"&gt;"&lt;/span&gt;&lt;span class="si"&gt;$y&lt;/span&gt;&lt;span class="s"&gt;$"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_3f2f820ca091438ea63801d2bc0b8ba8-36" name="rest_code_3f2f820ca091438ea63801d2bc0b8ba8-36" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-23/#rest_code_3f2f820ca091438ea63801d2bc0b8ba8-36"&gt;&lt;/a&gt;&lt;span class="n"&gt;legend&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="s"&gt;"Ritz solution"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s"&gt;"Exact solution"&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_3f2f820ca091438ea63801d2bc0b8ba8-37" name="rest_code_3f2f820ca091438ea63801d2bc0b8ba8-37" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-23/#rest_code_3f2f820ca091438ea63801d2bc0b8ba8-37"&gt;&lt;/a&gt;&lt;span class="n"&gt;tight_layout&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_3f2f820ca091438ea63801d2bc0b8ba8-38" name="rest_code_3f2f820ca091438ea63801d2bc0b8ba8-38" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-23/#rest_code_3f2f820ca091438ea63801d2bc0b8ba8-38"&gt;&lt;/a&gt;&lt;span class="n"&gt;show&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Both have (almost) the same result, as follows&lt;/p&gt;
&lt;img alt="Ritz method approximation using 2 terms." class="align-center" src="https://nicoguaro.github.io/images/ritz.svg" style="width: 400px;"&gt;
&lt;p&gt;And if we consider 3 terms in the expansion, we get&lt;/p&gt;
&lt;img alt="Ritz method approximation using 3 terms." class="align-center" src="https://nicoguaro.github.io/images/ritz-N-3.svg" style="width: 400px;"&gt;
&lt;/section&gt;
&lt;section id="comparison-python-julia"&gt;
&lt;h3&gt;Comparison Python/Julia&lt;/h3&gt;
&lt;p&gt;Regarding number of lines we have: 38 in Python and 38 in Julia. The comparison
in execution time is done with &lt;code class="docutils literal"&gt;%timeit&lt;/code&gt; magic command in IPython and
&lt;code class="docutils literal"&gt;@benchmark&lt;/code&gt; in Julia.&lt;/p&gt;
&lt;p&gt;For Python:&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code IPython"&gt;&lt;a id="rest_code_ef8c73ddccec4783bc51c5e64ddbe038-1" name="rest_code_ef8c73ddccec4783bc51c5e64ddbe038-1" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-23/#rest_code_ef8c73ddccec4783bc51c5e64ddbe038-1"&gt;&lt;/a&gt;&lt;span class="o"&gt;%%time&lt;/span&gt;it
&lt;a id="rest_code_ef8c73ddccec4783bc51c5e64ddbe038-2" name="rest_code_ef8c73ddccec4783bc51c5e64ddbe038-2" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-23/#rest_code_ef8c73ddccec4783bc51c5e64ddbe038-2"&gt;&lt;/a&gt;&lt;span class="n"&gt;mat&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;rhs&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;ritz&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;source&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_ef8c73ddccec4783bc51c5e64ddbe038-3" name="rest_code_ef8c73ddccec4783bc51c5e64ddbe038-3" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-23/#rest_code_ef8c73ddccec4783bc51c5e64ddbe038-3"&gt;&lt;/a&gt;&lt;span class="n"&gt;c&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;solve&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;mat&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;rhs&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;with result&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code text"&gt;&lt;a id="rest_code_035e7d69d2be43c2a00af3c150f06228-1" name="rest_code_035e7d69d2be43c2a00af3c150f06228-1" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-23/#rest_code_035e7d69d2be43c2a00af3c150f06228-1"&gt;&lt;/a&gt;1000 loops, best of 3: 228 µs per loop
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;For Julia:&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code julia"&gt;&lt;a id="rest_code_ff122ff758404ab7aa9e6cd70f87e0c1-1" name="rest_code_ff122ff758404ab7aa9e6cd70f87e0c1-1" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-23/#rest_code_ff122ff758404ab7aa9e6cd70f87e0c1-1"&gt;&lt;/a&gt;&lt;span class="k"&gt;function&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;bench&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_ff122ff758404ab7aa9e6cd70f87e0c1-2" name="rest_code_ff122ff758404ab7aa9e6cd70f87e0c1-2" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-23/#rest_code_ff122ff758404ab7aa9e6cd70f87e0c1-2"&gt;&lt;/a&gt;&lt;span class="w"&gt;   &lt;/span&gt;&lt;span class="n"&gt;mat&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;rhs&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ritz&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;source&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_ff122ff758404ab7aa9e6cd70f87e0c1-3" name="rest_code_ff122ff758404ab7aa9e6cd70f87e0c1-3" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-23/#rest_code_ff122ff758404ab7aa9e6cd70f87e0c1-3"&gt;&lt;/a&gt;&lt;span class="w"&gt;   &lt;/span&gt;&lt;span class="n"&gt;c&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;mat&lt;/span&gt;&lt;span class="o"&gt;\&lt;/span&gt;&lt;span class="n"&gt;rhs&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_ff122ff758404ab7aa9e6cd70f87e0c1-4" name="rest_code_ff122ff758404ab7aa9e6cd70f87e0c1-4" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-23/#rest_code_ff122ff758404ab7aa9e6cd70f87e0c1-4"&gt;&lt;/a&gt;&lt;span class="k"&gt;end&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_ff122ff758404ab7aa9e6cd70f87e0c1-5" name="rest_code_ff122ff758404ab7aa9e6cd70f87e0c1-5" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-23/#rest_code_ff122ff758404ab7aa9e6cd70f87e0c1-5"&gt;&lt;/a&gt;&lt;span class="nd"&gt;@benchmark&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;bench&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;with result&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code julia"&gt;&lt;a id="rest_code_653bbcac34f14e9d841961bb308f725e-1" name="rest_code_653bbcac34f14e9d841961bb308f725e-1" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-23/#rest_code_653bbcac34f14e9d841961bb308f725e-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;BenchmarkTools&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Trial&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_653bbcac34f14e9d841961bb308f725e-2" name="rest_code_653bbcac34f14e9d841961bb308f725e-2" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-23/#rest_code_653bbcac34f14e9d841961bb308f725e-2"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;memory&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;estimate&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="mf"&gt;6.56&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;KiB&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_653bbcac34f14e9d841961bb308f725e-3" name="rest_code_653bbcac34f14e9d841961bb308f725e-3" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-23/#rest_code_653bbcac34f14e9d841961bb308f725e-3"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;allocs&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;estimate&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="mi"&gt;340&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_653bbcac34f14e9d841961bb308f725e-4" name="rest_code_653bbcac34f14e9d841961bb308f725e-4" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-23/#rest_code_653bbcac34f14e9d841961bb308f725e-4"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="o"&gt;--------------&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_653bbcac34f14e9d841961bb308f725e-5" name="rest_code_653bbcac34f14e9d841961bb308f725e-5" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-23/#rest_code_653bbcac34f14e9d841961bb308f725e-5"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;minimum&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;     &lt;/span&gt;&lt;span class="mf"&gt;13.527&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;μs&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;0.00&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;GC&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_653bbcac34f14e9d841961bb308f725e-6" name="rest_code_653bbcac34f14e9d841961bb308f725e-6" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-23/#rest_code_653bbcac34f14e9d841961bb308f725e-6"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;median&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="mf"&gt;15.927&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;μs&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;0.00&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;GC&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_653bbcac34f14e9d841961bb308f725e-7" name="rest_code_653bbcac34f14e9d841961bb308f725e-7" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-23/#rest_code_653bbcac34f14e9d841961bb308f725e-7"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;mean&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="mf"&gt;17.133&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;μs&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;4.50&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;GC&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_653bbcac34f14e9d841961bb308f725e-8" name="rest_code_653bbcac34f14e9d841961bb308f725e-8" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-23/#rest_code_653bbcac34f14e9d841961bb308f725e-8"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;maximum&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;     &lt;/span&gt;&lt;span class="mf"&gt;2.807&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ms&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;97.36&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;GC&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_653bbcac34f14e9d841961bb308f725e-9" name="rest_code_653bbcac34f14e9d841961bb308f725e-9" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-23/#rest_code_653bbcac34f14e9d841961bb308f725e-9"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="o"&gt;--------------&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_653bbcac34f14e9d841961bb308f725e-10" name="rest_code_653bbcac34f14e9d841961bb308f725e-10" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-23/#rest_code_653bbcac34f14e9d841961bb308f725e-10"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;samples&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;          &lt;/span&gt;&lt;span class="mi"&gt;10000&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_653bbcac34f14e9d841961bb308f725e-11" name="rest_code_653bbcac34f14e9d841961bb308f725e-11" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-23/#rest_code_653bbcac34f14e9d841961bb308f725e-11"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;evals&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;sample&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;     &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;In this case, we can say that the Python code is roughly 14 times slower than
Julia.&lt;/p&gt;
&lt;/section&gt;
&lt;/section&gt;</description><category>julia</category><category>numerical methods</category><category>python</category><category>ritz method</category><category>scientific computing</category><guid>https://nicoguaro.github.io/posts/numerical_challenge/numerical-23/</guid><pubDate>Tue, 24 Oct 2017 01:30:03 GMT</pubDate></item></channel></rss>