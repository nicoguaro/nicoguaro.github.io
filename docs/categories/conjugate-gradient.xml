<?xml version="1.0" encoding="utf-8"?>
<?xml-stylesheet type="text/xsl" href="../assets/xml/rss.xsl" media="all"?><rss version="2.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Nicolás' blog (Posts about conjugate gradient)</title><link>https://nicoguaro.github.io/</link><description></description><atom:link href="https://nicoguaro.github.io/categories/conjugate-gradient.xml" rel="self" type="application/rss+xml"></atom:link><language>en</language><copyright>Contents © 2022 &lt;a href="mailto:nicoguarin@gmail.com"&gt;Nicolás Guarín-Zapata&lt;/a&gt; 
&lt;a rel="license" href="http://creativecommons.org/licenses/by/4.0/"&gt;
&lt;img alt="Creative Commons License"
style="border-width:0"
src="https://i.creativecommons.org/l/by/4.0/88x31.png"&gt;&lt;/a&gt;</copyright><lastBuildDate>Wed, 02 Nov 2022 17:08:37 GMT</lastBuildDate><generator>Nikola (getnikola.com)</generator><docs>http://blogs.law.harvard.edu/tech/rss</docs><item><title>Numerical methods challenge: Day 31</title><link>https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/</link><dc:creator>Nicolás Guarín-Zapata</dc:creator><description>&lt;p&gt;During October (2017) I wrote a program per day for some well-known
numerical methods in both Python and Julia. It was intended to be an exercise,
then don't expect the code to be good enough for real use. Also,
I should mention that I had almost no experience with Julia, so it
probably is not idiomatic Julia but more Python-like Julia.&lt;/p&gt;
&lt;section id="putting-some-things-together"&gt;
&lt;h2&gt;Putting some things together&lt;/h2&gt;
&lt;p&gt;Today, I am putting some things together, namely, I am going to solve the
system of equations that results in the finite element using the conjugate
gradient.&lt;/p&gt;
&lt;p&gt;Following are the codes&lt;/p&gt;
&lt;section id="python"&gt;
&lt;h3&gt;Python&lt;/h3&gt;
&lt;div class="code"&gt;&lt;pre class="code python"&gt;&lt;a id="rest_code_2e50c603bfc9409cb66066c291f7c204-1" name="rest_code_2e50c603bfc9409cb66066c291f7c204-1" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_2e50c603bfc9409cb66066c291f7c204-1"&gt;&lt;/a&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;__future__&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;division&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;print_function&lt;/span&gt;
&lt;a id="rest_code_2e50c603bfc9409cb66066c291f7c204-2" name="rest_code_2e50c603bfc9409cb66066c291f7c204-2" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_2e50c603bfc9409cb66066c291f7c204-2"&gt;&lt;/a&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;numpy&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;np&lt;/span&gt;
&lt;a id="rest_code_2e50c603bfc9409cb66066c291f7c204-3" name="rest_code_2e50c603bfc9409cb66066c291f7c204-3" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_2e50c603bfc9409cb66066c291f7c204-3"&gt;&lt;/a&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;matplotlib.pyplot&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;plt&lt;/span&gt;
&lt;a id="rest_code_2e50c603bfc9409cb66066c291f7c204-4" name="rest_code_2e50c603bfc9409cb66066c291f7c204-4" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_2e50c603bfc9409cb66066c291f7c204-4"&gt;&lt;/a&gt;
&lt;a id="rest_code_2e50c603bfc9409cb66066c291f7c204-5" name="rest_code_2e50c603bfc9409cb66066c291f7c204-5" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_2e50c603bfc9409cb66066c291f7c204-5"&gt;&lt;/a&gt;
&lt;a id="rest_code_2e50c603bfc9409cb66066c291f7c204-6" name="rest_code_2e50c603bfc9409cb66066c291f7c204-6" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_2e50c603bfc9409cb66066c291f7c204-6"&gt;&lt;/a&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;FEM1D&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;source&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_2e50c603bfc9409cb66066c291f7c204-7" name="rest_code_2e50c603bfc9409cb66066c291f7c204-7" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_2e50c603bfc9409cb66066c291f7c204-7"&gt;&lt;/a&gt;    &lt;span class="n"&gt;N&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_2e50c603bfc9409cb66066c291f7c204-8" name="rest_code_2e50c603bfc9409cb66066c291f7c204-8" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_2e50c603bfc9409cb66066c291f7c204-8"&gt;&lt;/a&gt;    &lt;span class="n"&gt;stiff_loc&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;([[&lt;/span&gt;&lt;span class="mf"&gt;2.0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;2.0&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;2.0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;2.0&lt;/span&gt;&lt;span class="p"&gt;]])&lt;/span&gt;
&lt;a id="rest_code_2e50c603bfc9409cb66066c291f7c204-9" name="rest_code_2e50c603bfc9409cb66066c291f7c204-9" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_2e50c603bfc9409cb66066c291f7c204-9"&gt;&lt;/a&gt;    &lt;span class="n"&gt;eles&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="n"&gt;cont&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;cont&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;cont&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;N&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)]&lt;/span&gt;
&lt;a id="rest_code_2e50c603bfc9409cb66066c291f7c204-10" name="rest_code_2e50c603bfc9409cb66066c291f7c204-10" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_2e50c603bfc9409cb66066c291f7c204-10"&gt;&lt;/a&gt;    &lt;span class="n"&gt;stiff&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_2e50c603bfc9409cb66066c291f7c204-11" name="rest_code_2e50c603bfc9409cb66066c291f7c204-11" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_2e50c603bfc9409cb66066c291f7c204-11"&gt;&lt;/a&gt;    &lt;span class="n"&gt;rhs&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_2e50c603bfc9409cb66066c291f7c204-12" name="rest_code_2e50c603bfc9409cb66066c291f7c204-12" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_2e50c603bfc9409cb66066c291f7c204-12"&gt;&lt;/a&gt;    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;ele&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;eles&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a id="rest_code_2e50c603bfc9409cb66066c291f7c204-13" name="rest_code_2e50c603bfc9409cb66066c291f7c204-13" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_2e50c603bfc9409cb66066c291f7c204-13"&gt;&lt;/a&gt;        &lt;span class="n"&gt;jaco&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ele&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]]&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ele&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]]&lt;/span&gt;
&lt;a id="rest_code_2e50c603bfc9409cb66066c291f7c204-14" name="rest_code_2e50c603bfc9409cb66066c291f7c204-14" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_2e50c603bfc9409cb66066c291f7c204-14"&gt;&lt;/a&gt;        &lt;span class="n"&gt;rhs&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ele&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;rhs&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ele&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;jaco&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;source&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ele&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_2e50c603bfc9409cb66066c291f7c204-15" name="rest_code_2e50c603bfc9409cb66066c291f7c204-15" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_2e50c603bfc9409cb66066c291f7c204-15"&gt;&lt;/a&gt;        &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;cont1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;row&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;enumerate&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ele&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_2e50c603bfc9409cb66066c291f7c204-16" name="rest_code_2e50c603bfc9409cb66066c291f7c204-16" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_2e50c603bfc9409cb66066c291f7c204-16"&gt;&lt;/a&gt;            &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;cont2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;col&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;enumerate&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ele&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_2e50c603bfc9409cb66066c291f7c204-17" name="rest_code_2e50c603bfc9409cb66066c291f7c204-17" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_2e50c603bfc9409cb66066c291f7c204-17"&gt;&lt;/a&gt;                &lt;span class="n"&gt;stiff&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;row&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;stiff&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;row&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt;  &lt;span class="n"&gt;stiff_loc&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;cont1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;cont2&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;jaco&lt;/span&gt;
&lt;a id="rest_code_2e50c603bfc9409cb66066c291f7c204-18" name="rest_code_2e50c603bfc9409cb66066c291f7c204-18" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_2e50c603bfc9409cb66066c291f7c204-18"&gt;&lt;/a&gt;    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;stiff&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;rhs&lt;/span&gt;
&lt;a id="rest_code_2e50c603bfc9409cb66066c291f7c204-19" name="rest_code_2e50c603bfc9409cb66066c291f7c204-19" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_2e50c603bfc9409cb66066c291f7c204-19"&gt;&lt;/a&gt;
&lt;a id="rest_code_2e50c603bfc9409cb66066c291f7c204-20" name="rest_code_2e50c603bfc9409cb66066c291f7c204-20" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_2e50c603bfc9409cb66066c291f7c204-20"&gt;&lt;/a&gt;
&lt;a id="rest_code_2e50c603bfc9409cb66066c291f7c204-21" name="rest_code_2e50c603bfc9409cb66066c291f7c204-21" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_2e50c603bfc9409cb66066c291f7c204-21"&gt;&lt;/a&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;conj_grad&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;tol&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mf"&gt;1e-8&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_2e50c603bfc9409cb66066c291f7c204-22" name="rest_code_2e50c603bfc9409cb66066c291f7c204-22" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_2e50c603bfc9409cb66066c291f7c204-22"&gt;&lt;/a&gt;    &lt;span class="n"&gt;r&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;b&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;dot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_2e50c603bfc9409cb66066c291f7c204-23" name="rest_code_2e50c603bfc9409cb66066c291f7c204-23" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_2e50c603bfc9409cb66066c291f7c204-23"&gt;&lt;/a&gt;    &lt;span class="n"&gt;p&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;r&lt;/span&gt;
&lt;a id="rest_code_2e50c603bfc9409cb66066c291f7c204-24" name="rest_code_2e50c603bfc9409cb66066c291f7c204-24" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_2e50c603bfc9409cb66066c291f7c204-24"&gt;&lt;/a&gt;    &lt;span class="n"&gt;rsq_old&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;dot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_2e50c603bfc9409cb66066c291f7c204-25" name="rest_code_2e50c603bfc9409cb66066c291f7c204-25" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_2e50c603bfc9409cb66066c291f7c204-25"&gt;&lt;/a&gt;    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;cont&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;)):&lt;/span&gt;
&lt;a id="rest_code_2e50c603bfc9409cb66066c291f7c204-26" name="rest_code_2e50c603bfc9409cb66066c291f7c204-26" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_2e50c603bfc9409cb66066c291f7c204-26"&gt;&lt;/a&gt;        &lt;span class="n"&gt;Ap&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;dot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_2e50c603bfc9409cb66066c291f7c204-27" name="rest_code_2e50c603bfc9409cb66066c291f7c204-27" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_2e50c603bfc9409cb66066c291f7c204-27"&gt;&lt;/a&gt;        &lt;span class="n"&gt;alpha&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;rsq_old&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;dot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Ap&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_2e50c603bfc9409cb66066c291f7c204-28" name="rest_code_2e50c603bfc9409cb66066c291f7c204-28" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_2e50c603bfc9409cb66066c291f7c204-28"&gt;&lt;/a&gt;        &lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;alpha&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;p&lt;/span&gt;
&lt;a id="rest_code_2e50c603bfc9409cb66066c291f7c204-29" name="rest_code_2e50c603bfc9409cb66066c291f7c204-29" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_2e50c603bfc9409cb66066c291f7c204-29"&gt;&lt;/a&gt;        &lt;span class="n"&gt;r&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;r&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;alpha&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;Ap&lt;/span&gt;
&lt;a id="rest_code_2e50c603bfc9409cb66066c291f7c204-30" name="rest_code_2e50c603bfc9409cb66066c291f7c204-30" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_2e50c603bfc9409cb66066c291f7c204-30"&gt;&lt;/a&gt;        &lt;span class="n"&gt;rsq_new&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;dot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_2e50c603bfc9409cb66066c291f7c204-31" name="rest_code_2e50c603bfc9409cb66066c291f7c204-31" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_2e50c603bfc9409cb66066c291f7c204-31"&gt;&lt;/a&gt;        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sqrt&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;rsq_new&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;tol&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a id="rest_code_2e50c603bfc9409cb66066c291f7c204-32" name="rest_code_2e50c603bfc9409cb66066c291f7c204-32" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_2e50c603bfc9409cb66066c291f7c204-32"&gt;&lt;/a&gt;            &lt;span class="k"&gt;break&lt;/span&gt;
&lt;a id="rest_code_2e50c603bfc9409cb66066c291f7c204-33" name="rest_code_2e50c603bfc9409cb66066c291f7c204-33" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_2e50c603bfc9409cb66066c291f7c204-33"&gt;&lt;/a&gt;        &lt;span class="n"&gt;p&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;r&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;rsq_new&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="n"&gt;rsq_old&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;p&lt;/span&gt;
&lt;a id="rest_code_2e50c603bfc9409cb66066c291f7c204-34" name="rest_code_2e50c603bfc9409cb66066c291f7c204-34" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_2e50c603bfc9409cb66066c291f7c204-34"&gt;&lt;/a&gt;        &lt;span class="n"&gt;rsq_old&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;rsq_new&lt;/span&gt;
&lt;a id="rest_code_2e50c603bfc9409cb66066c291f7c204-35" name="rest_code_2e50c603bfc9409cb66066c291f7c204-35" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_2e50c603bfc9409cb66066c291f7c204-35"&gt;&lt;/a&gt;    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;cont&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sqrt&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;rsq_new&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_2e50c603bfc9409cb66066c291f7c204-36" name="rest_code_2e50c603bfc9409cb66066c291f7c204-36" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_2e50c603bfc9409cb66066c291f7c204-36"&gt;&lt;/a&gt;
&lt;a id="rest_code_2e50c603bfc9409cb66066c291f7c204-37" name="rest_code_2e50c603bfc9409cb66066c291f7c204-37" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_2e50c603bfc9409cb66066c291f7c204-37"&gt;&lt;/a&gt;
&lt;a id="rest_code_2e50c603bfc9409cb66066c291f7c204-38" name="rest_code_2e50c603bfc9409cb66066c291f7c204-38" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_2e50c603bfc9409cb66066c291f7c204-38"&gt;&lt;/a&gt;&lt;span class="n"&gt;fun&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;lambda&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;
&lt;a id="rest_code_2e50c603bfc9409cb66066c291f7c204-39" name="rest_code_2e50c603bfc9409cb66066c291f7c204-39" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_2e50c603bfc9409cb66066c291f7c204-39"&gt;&lt;/a&gt;&lt;span class="n"&gt;N_vec&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;logspace&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;0.5&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;50&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;dtype&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nb"&gt;int&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_2e50c603bfc9409cb66066c291f7c204-40" name="rest_code_2e50c603bfc9409cb66066c291f7c204-40" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_2e50c603bfc9409cb66066c291f7c204-40"&gt;&lt;/a&gt;&lt;span class="n"&gt;err_vec&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros_like&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N_vec&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;dtype&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nb"&gt;float&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_2e50c603bfc9409cb66066c291f7c204-41" name="rest_code_2e50c603bfc9409cb66066c291f7c204-41" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_2e50c603bfc9409cb66066c291f7c204-41"&gt;&lt;/a&gt;&lt;span class="n"&gt;niter_vec&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros_like&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N_vec&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_2e50c603bfc9409cb66066c291f7c204-42" name="rest_code_2e50c603bfc9409cb66066c291f7c204-42" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_2e50c603bfc9409cb66066c291f7c204-42"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;figure&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;figsize&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;8&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_2e50c603bfc9409cb66066c291f7c204-43" name="rest_code_2e50c603bfc9409cb66066c291f7c204-43" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_2e50c603bfc9409cb66066c291f7c204-43"&gt;&lt;/a&gt;&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;cont&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;N&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;enumerate&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N_vec&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_2e50c603bfc9409cb66066c291f7c204-44" name="rest_code_2e50c603bfc9409cb66066c291f7c204-44" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_2e50c603bfc9409cb66066c291f7c204-44"&gt;&lt;/a&gt;    &lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;linspace&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_2e50c603bfc9409cb66066c291f7c204-45" name="rest_code_2e50c603bfc9409cb66066c291f7c204-45" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_2e50c603bfc9409cb66066c291f7c204-45"&gt;&lt;/a&gt;    &lt;span class="n"&gt;stiff&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;rhs&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;FEM1D&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;fun&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_2e50c603bfc9409cb66066c291f7c204-46" name="rest_code_2e50c603bfc9409cb66066c291f7c204-46" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_2e50c603bfc9409cb66066c291f7c204-46"&gt;&lt;/a&gt;    &lt;span class="n"&gt;sol&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_2e50c603bfc9409cb66066c291f7c204-47" name="rest_code_2e50c603bfc9409cb66066c291f7c204-47" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_2e50c603bfc9409cb66066c291f7c204-47"&gt;&lt;/a&gt;    &lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;niter&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;_&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;conj_grad&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;stiff&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;rhs&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;rhs&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_2e50c603bfc9409cb66066c291f7c204-48" name="rest_code_2e50c603bfc9409cb66066c291f7c204-48" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_2e50c603bfc9409cb66066c291f7c204-48"&gt;&lt;/a&gt;    &lt;span class="n"&gt;err&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;linalg&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;norm&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;sol&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="mi"&gt;20&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;linalg&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;norm&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="mi"&gt;20&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_2e50c603bfc9409cb66066c291f7c204-49" name="rest_code_2e50c603bfc9409cb66066c291f7c204-49" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_2e50c603bfc9409cb66066c291f7c204-49"&gt;&lt;/a&gt;    &lt;span class="n"&gt;err_vec&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;cont&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;err&lt;/span&gt;
&lt;a id="rest_code_2e50c603bfc9409cb66066c291f7c204-50" name="rest_code_2e50c603bfc9409cb66066c291f7c204-50" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_2e50c603bfc9409cb66066c291f7c204-50"&gt;&lt;/a&gt;    &lt;span class="n"&gt;niter_vec&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;cont&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;niter&lt;/span&gt;
&lt;a id="rest_code_2e50c603bfc9409cb66066c291f7c204-51" name="rest_code_2e50c603bfc9409cb66066c291f7c204-51" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_2e50c603bfc9409cb66066c291f7c204-51"&gt;&lt;/a&gt;
&lt;a id="rest_code_2e50c603bfc9409cb66066c291f7c204-52" name="rest_code_2e50c603bfc9409cb66066c291f7c204-52" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_2e50c603bfc9409cb66066c291f7c204-52"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;subplot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;121&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_2e50c603bfc9409cb66066c291f7c204-53" name="rest_code_2e50c603bfc9409cb66066c291f7c204-53" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_2e50c603bfc9409cb66066c291f7c204-53"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;loglog&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N_vec&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;err_vec&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_2e50c603bfc9409cb66066c291f7c204-54" name="rest_code_2e50c603bfc9409cb66066c291f7c204-54" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_2e50c603bfc9409cb66066c291f7c204-54"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"Number of nodes"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_2e50c603bfc9409cb66066c291f7c204-55" name="rest_code_2e50c603bfc9409cb66066c291f7c204-55" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_2e50c603bfc9409cb66066c291f7c204-55"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ylabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"Relative error"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_2e50c603bfc9409cb66066c291f7c204-56" name="rest_code_2e50c603bfc9409cb66066c291f7c204-56" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_2e50c603bfc9409cb66066c291f7c204-56"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;subplot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;122&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_2e50c603bfc9409cb66066c291f7c204-57" name="rest_code_2e50c603bfc9409cb66066c291f7c204-57" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_2e50c603bfc9409cb66066c291f7c204-57"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;loglog&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N_vec&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;niter_vec&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_2e50c603bfc9409cb66066c291f7c204-58" name="rest_code_2e50c603bfc9409cb66066c291f7c204-58" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_2e50c603bfc9409cb66066c291f7c204-58"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"Number of nodes"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_2e50c603bfc9409cb66066c291f7c204-59" name="rest_code_2e50c603bfc9409cb66066c291f7c204-59" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_2e50c603bfc9409cb66066c291f7c204-59"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ylabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"Number of iterations"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_2e50c603bfc9409cb66066c291f7c204-60" name="rest_code_2e50c603bfc9409cb66066c291f7c204-60" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_2e50c603bfc9409cb66066c291f7c204-60"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;tight_layout&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a id="rest_code_2e50c603bfc9409cb66066c291f7c204-61" name="rest_code_2e50c603bfc9409cb66066c291f7c204-61" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_2e50c603bfc9409cb66066c291f7c204-61"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;show&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/section&gt;
&lt;section id="julia"&gt;
&lt;h3&gt;Julia&lt;/h3&gt;
&lt;div class="code"&gt;&lt;pre class="code julia"&gt;&lt;a id="rest_code_05d5f56b2b5f47bab3dac84888a78946-1" name="rest_code_05d5f56b2b5f47bab3dac84888a78946-1" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_05d5f56b2b5f47bab3dac84888a78946-1"&gt;&lt;/a&gt;&lt;span class="k"&gt;using&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;PyPlot&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_05d5f56b2b5f47bab3dac84888a78946-2" name="rest_code_05d5f56b2b5f47bab3dac84888a78946-2" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_05d5f56b2b5f47bab3dac84888a78946-2"&gt;&lt;/a&gt;
&lt;a id="rest_code_05d5f56b2b5f47bab3dac84888a78946-3" name="rest_code_05d5f56b2b5f47bab3dac84888a78946-3" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_05d5f56b2b5f47bab3dac84888a78946-3"&gt;&lt;/a&gt;
&lt;a id="rest_code_05d5f56b2b5f47bab3dac84888a78946-4" name="rest_code_05d5f56b2b5f47bab3dac84888a78946-4" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_05d5f56b2b5f47bab3dac84888a78946-4"&gt;&lt;/a&gt;&lt;span class="k"&gt;function&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;FEM1D&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;source&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_05d5f56b2b5f47bab3dac84888a78946-5" name="rest_code_05d5f56b2b5f47bab3dac84888a78946-5" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_05d5f56b2b5f47bab3dac84888a78946-5"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;length&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_05d5f56b2b5f47bab3dac84888a78946-6" name="rest_code_05d5f56b2b5f47bab3dac84888a78946-6" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_05d5f56b2b5f47bab3dac84888a78946-6"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;stiff_loc&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mf"&gt;2.0&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;2.0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;2.0&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;2.0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_05d5f56b2b5f47bab3dac84888a78946-7" name="rest_code_05d5f56b2b5f47bab3dac84888a78946-7" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_05d5f56b2b5f47bab3dac84888a78946-7"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;eles&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;[[&lt;/span&gt;&lt;span class="n"&gt;cont&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;cont&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;for&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;cont&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;in&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_05d5f56b2b5f47bab3dac84888a78946-8" name="rest_code_05d5f56b2b5f47bab3dac84888a78946-8" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_05d5f56b2b5f47bab3dac84888a78946-8"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;stiff&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_05d5f56b2b5f47bab3dac84888a78946-9" name="rest_code_05d5f56b2b5f47bab3dac84888a78946-9" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_05d5f56b2b5f47bab3dac84888a78946-9"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;rhs&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_05d5f56b2b5f47bab3dac84888a78946-10" name="rest_code_05d5f56b2b5f47bab3dac84888a78946-10" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_05d5f56b2b5f47bab3dac84888a78946-10"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;for&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ele&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;in&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;eles&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_05d5f56b2b5f47bab3dac84888a78946-11" name="rest_code_05d5f56b2b5f47bab3dac84888a78946-11" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_05d5f56b2b5f47bab3dac84888a78946-11"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;jaco&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ele&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;]]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ele&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]]&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_05d5f56b2b5f47bab3dac84888a78946-12" name="rest_code_05d5f56b2b5f47bab3dac84888a78946-12" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_05d5f56b2b5f47bab3dac84888a78946-12"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;rhs&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ele&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;rhs&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ele&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;jaco&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;source&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ele&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_05d5f56b2b5f47bab3dac84888a78946-13" name="rest_code_05d5f56b2b5f47bab3dac84888a78946-13" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_05d5f56b2b5f47bab3dac84888a78946-13"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;stiff&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ele&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ele&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;stiff&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ele&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ele&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;stiff_loc&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;jaco&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_05d5f56b2b5f47bab3dac84888a78946-14" name="rest_code_05d5f56b2b5f47bab3dac84888a78946-14" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_05d5f56b2b5f47bab3dac84888a78946-14"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;end&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_05d5f56b2b5f47bab3dac84888a78946-15" name="rest_code_05d5f56b2b5f47bab3dac84888a78946-15" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_05d5f56b2b5f47bab3dac84888a78946-15"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;return&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;stiff&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;rhs&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_05d5f56b2b5f47bab3dac84888a78946-16" name="rest_code_05d5f56b2b5f47bab3dac84888a78946-16" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_05d5f56b2b5f47bab3dac84888a78946-16"&gt;&lt;/a&gt;&lt;span class="k"&gt;end&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_05d5f56b2b5f47bab3dac84888a78946-17" name="rest_code_05d5f56b2b5f47bab3dac84888a78946-17" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_05d5f56b2b5f47bab3dac84888a78946-17"&gt;&lt;/a&gt;
&lt;a id="rest_code_05d5f56b2b5f47bab3dac84888a78946-18" name="rest_code_05d5f56b2b5f47bab3dac84888a78946-18" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_05d5f56b2b5f47bab3dac84888a78946-18"&gt;&lt;/a&gt;
&lt;a id="rest_code_05d5f56b2b5f47bab3dac84888a78946-19" name="rest_code_05d5f56b2b5f47bab3dac84888a78946-19" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_05d5f56b2b5f47bab3dac84888a78946-19"&gt;&lt;/a&gt;&lt;span class="k"&gt;function&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;conj_grad&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;tol&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mf"&gt;1e-8&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_05d5f56b2b5f47bab3dac84888a78946-20" name="rest_code_05d5f56b2b5f47bab3dac84888a78946-20" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_05d5f56b2b5f47bab3dac84888a78946-20"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_05d5f56b2b5f47bab3dac84888a78946-21" name="rest_code_05d5f56b2b5f47bab3dac84888a78946-21" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_05d5f56b2b5f47bab3dac84888a78946-21"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_05d5f56b2b5f47bab3dac84888a78946-22" name="rest_code_05d5f56b2b5f47bab3dac84888a78946-22" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_05d5f56b2b5f47bab3dac84888a78946-22"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;rsq_old&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;dot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_05d5f56b2b5f47bab3dac84888a78946-23" name="rest_code_05d5f56b2b5f47bab3dac84888a78946-23" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_05d5f56b2b5f47bab3dac84888a78946-23"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;niter&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_05d5f56b2b5f47bab3dac84888a78946-24" name="rest_code_05d5f56b2b5f47bab3dac84888a78946-24" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_05d5f56b2b5f47bab3dac84888a78946-24"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;for&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;cont&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="n"&gt;length&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_05d5f56b2b5f47bab3dac84888a78946-25" name="rest_code_05d5f56b2b5f47bab3dac84888a78946-25" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_05d5f56b2b5f47bab3dac84888a78946-25"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;Ap&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_05d5f56b2b5f47bab3dac84888a78946-26" name="rest_code_05d5f56b2b5f47bab3dac84888a78946-26" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_05d5f56b2b5f47bab3dac84888a78946-26"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;alpha&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;rsq_old&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;dot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Ap&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_05d5f56b2b5f47bab3dac84888a78946-27" name="rest_code_05d5f56b2b5f47bab3dac84888a78946-27" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_05d5f56b2b5f47bab3dac84888a78946-27"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;alpha&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_05d5f56b2b5f47bab3dac84888a78946-28" name="rest_code_05d5f56b2b5f47bab3dac84888a78946-28" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_05d5f56b2b5f47bab3dac84888a78946-28"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;alpha&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;Ap&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_05d5f56b2b5f47bab3dac84888a78946-29" name="rest_code_05d5f56b2b5f47bab3dac84888a78946-29" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_05d5f56b2b5f47bab3dac84888a78946-29"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;rsq_new&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;dot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_05d5f56b2b5f47bab3dac84888a78946-30" name="rest_code_05d5f56b2b5f47bab3dac84888a78946-30" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_05d5f56b2b5f47bab3dac84888a78946-30"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;sqrt&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;rsq_new&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;tol&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_05d5f56b2b5f47bab3dac84888a78946-31" name="rest_code_05d5f56b2b5f47bab3dac84888a78946-31" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_05d5f56b2b5f47bab3dac84888a78946-31"&gt;&lt;/a&gt;&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="k"&gt;break&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_05d5f56b2b5f47bab3dac84888a78946-32" name="rest_code_05d5f56b2b5f47bab3dac84888a78946-32" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_05d5f56b2b5f47bab3dac84888a78946-32"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="k"&gt;end&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_05d5f56b2b5f47bab3dac84888a78946-33" name="rest_code_05d5f56b2b5f47bab3dac84888a78946-33" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_05d5f56b2b5f47bab3dac84888a78946-33"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;rsq_new&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;rsq_old&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_05d5f56b2b5f47bab3dac84888a78946-34" name="rest_code_05d5f56b2b5f47bab3dac84888a78946-34" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_05d5f56b2b5f47bab3dac84888a78946-34"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;rsq_old&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;rsq_new&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_05d5f56b2b5f47bab3dac84888a78946-35" name="rest_code_05d5f56b2b5f47bab3dac84888a78946-35" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_05d5f56b2b5f47bab3dac84888a78946-35"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;niter&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_05d5f56b2b5f47bab3dac84888a78946-36" name="rest_code_05d5f56b2b5f47bab3dac84888a78946-36" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_05d5f56b2b5f47bab3dac84888a78946-36"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;end&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_05d5f56b2b5f47bab3dac84888a78946-37" name="rest_code_05d5f56b2b5f47bab3dac84888a78946-37" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_05d5f56b2b5f47bab3dac84888a78946-37"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;return&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;niter&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;norm&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_05d5f56b2b5f47bab3dac84888a78946-38" name="rest_code_05d5f56b2b5f47bab3dac84888a78946-38" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_05d5f56b2b5f47bab3dac84888a78946-38"&gt;&lt;/a&gt;&lt;span class="k"&gt;end&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_05d5f56b2b5f47bab3dac84888a78946-39" name="rest_code_05d5f56b2b5f47bab3dac84888a78946-39" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_05d5f56b2b5f47bab3dac84888a78946-39"&gt;&lt;/a&gt;
&lt;a id="rest_code_05d5f56b2b5f47bab3dac84888a78946-40" name="rest_code_05d5f56b2b5f47bab3dac84888a78946-40" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_05d5f56b2b5f47bab3dac84888a78946-40"&gt;&lt;/a&gt;
&lt;a id="rest_code_05d5f56b2b5f47bab3dac84888a78946-41" name="rest_code_05d5f56b2b5f47bab3dac84888a78946-41" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_05d5f56b2b5f47bab3dac84888a78946-41"&gt;&lt;/a&gt;
&lt;a id="rest_code_05d5f56b2b5f47bab3dac84888a78946-42" name="rest_code_05d5f56b2b5f47bab3dac84888a78946-42" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_05d5f56b2b5f47bab3dac84888a78946-42"&gt;&lt;/a&gt;&lt;span class="n"&gt;fun&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;.^&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_05d5f56b2b5f47bab3dac84888a78946-43" name="rest_code_05d5f56b2b5f47bab3dac84888a78946-43" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_05d5f56b2b5f47bab3dac84888a78946-43"&gt;&lt;/a&gt;&lt;span class="n"&gt;N_vec&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;round&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;logspace&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;0.5&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;50&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_05d5f56b2b5f47bab3dac84888a78946-44" name="rest_code_05d5f56b2b5f47bab3dac84888a78946-44" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_05d5f56b2b5f47bab3dac84888a78946-44"&gt;&lt;/a&gt;&lt;span class="n"&gt;err_vec&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N_vec&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_05d5f56b2b5f47bab3dac84888a78946-45" name="rest_code_05d5f56b2b5f47bab3dac84888a78946-45" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_05d5f56b2b5f47bab3dac84888a78946-45"&gt;&lt;/a&gt;&lt;span class="n"&gt;niter_vec&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N_vec&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_05d5f56b2b5f47bab3dac84888a78946-46" name="rest_code_05d5f56b2b5f47bab3dac84888a78946-46" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_05d5f56b2b5f47bab3dac84888a78946-46"&gt;&lt;/a&gt;&lt;span class="n"&gt;figure&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;figsize&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;8&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_05d5f56b2b5f47bab3dac84888a78946-47" name="rest_code_05d5f56b2b5f47bab3dac84888a78946-47" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_05d5f56b2b5f47bab3dac84888a78946-47"&gt;&lt;/a&gt;&lt;span class="k"&gt;for&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;cont&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;in&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;enumerate&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N_vec&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_05d5f56b2b5f47bab3dac84888a78946-48" name="rest_code_05d5f56b2b5f47bab3dac84888a78946-48" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_05d5f56b2b5f47bab3dac84888a78946-48"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;linspace&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;0.0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;1.0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_05d5f56b2b5f47bab3dac84888a78946-49" name="rest_code_05d5f56b2b5f47bab3dac84888a78946-49" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_05d5f56b2b5f47bab3dac84888a78946-49"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;stiff&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;rhs&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;FEM1D&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;fun&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_05d5f56b2b5f47bab3dac84888a78946-50" name="rest_code_05d5f56b2b5f47bab3dac84888a78946-50" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_05d5f56b2b5f47bab3dac84888a78946-50"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_05d5f56b2b5f47bab3dac84888a78946-51" name="rest_code_05d5f56b2b5f47bab3dac84888a78946-51" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_05d5f56b2b5f47bab3dac84888a78946-51"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="k"&gt;end&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;niter&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;_&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;conj_grad&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;stiff&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="k"&gt;end&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="k"&gt;end&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_05d5f56b2b5f47bab3dac84888a78946-52" name="rest_code_05d5f56b2b5f47bab3dac84888a78946-52" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_05d5f56b2b5f47bab3dac84888a78946-52"&gt;&lt;/a&gt;&lt;span class="w"&gt;                                &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;rhs&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="k"&gt;end&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;rhs&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="k"&gt;end&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_05d5f56b2b5f47bab3dac84888a78946-53" name="rest_code_05d5f56b2b5f47bab3dac84888a78946-53" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_05d5f56b2b5f47bab3dac84888a78946-53"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;err&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;norm&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;.*&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;.^&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="mi"&gt;20&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;norm&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;.*&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;.^&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="mi"&gt;20&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_05d5f56b2b5f47bab3dac84888a78946-54" name="rest_code_05d5f56b2b5f47bab3dac84888a78946-54" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_05d5f56b2b5f47bab3dac84888a78946-54"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;err_vec&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;cont&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;err&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_05d5f56b2b5f47bab3dac84888a78946-55" name="rest_code_05d5f56b2b5f47bab3dac84888a78946-55" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_05d5f56b2b5f47bab3dac84888a78946-55"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;niter_vec&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;cont&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;niter&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_05d5f56b2b5f47bab3dac84888a78946-56" name="rest_code_05d5f56b2b5f47bab3dac84888a78946-56" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_05d5f56b2b5f47bab3dac84888a78946-56"&gt;&lt;/a&gt;&lt;span class="k"&gt;end&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_05d5f56b2b5f47bab3dac84888a78946-57" name="rest_code_05d5f56b2b5f47bab3dac84888a78946-57" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_05d5f56b2b5f47bab3dac84888a78946-57"&gt;&lt;/a&gt;&lt;span class="n"&gt;subplot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;121&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_05d5f56b2b5f47bab3dac84888a78946-58" name="rest_code_05d5f56b2b5f47bab3dac84888a78946-58" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_05d5f56b2b5f47bab3dac84888a78946-58"&gt;&lt;/a&gt;&lt;span class="n"&gt;loglog&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N_vec&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;err_vec&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_05d5f56b2b5f47bab3dac84888a78946-59" name="rest_code_05d5f56b2b5f47bab3dac84888a78946-59" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_05d5f56b2b5f47bab3dac84888a78946-59"&gt;&lt;/a&gt;&lt;span class="n"&gt;xlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;"Number of nodes"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_05d5f56b2b5f47bab3dac84888a78946-60" name="rest_code_05d5f56b2b5f47bab3dac84888a78946-60" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_05d5f56b2b5f47bab3dac84888a78946-60"&gt;&lt;/a&gt;&lt;span class="n"&gt;ylabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;"Relative error"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_05d5f56b2b5f47bab3dac84888a78946-61" name="rest_code_05d5f56b2b5f47bab3dac84888a78946-61" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_05d5f56b2b5f47bab3dac84888a78946-61"&gt;&lt;/a&gt;&lt;span class="n"&gt;subplot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;122&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_05d5f56b2b5f47bab3dac84888a78946-62" name="rest_code_05d5f56b2b5f47bab3dac84888a78946-62" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_05d5f56b2b5f47bab3dac84888a78946-62"&gt;&lt;/a&gt;&lt;span class="n"&gt;loglog&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N_vec&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;niter_vec&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_05d5f56b2b5f47bab3dac84888a78946-63" name="rest_code_05d5f56b2b5f47bab3dac84888a78946-63" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_05d5f56b2b5f47bab3dac84888a78946-63"&gt;&lt;/a&gt;&lt;span class="n"&gt;xlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;"Number of nodes"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_05d5f56b2b5f47bab3dac84888a78946-64" name="rest_code_05d5f56b2b5f47bab3dac84888a78946-64" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_05d5f56b2b5f47bab3dac84888a78946-64"&gt;&lt;/a&gt;&lt;span class="n"&gt;ylabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;"Number of iterations"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_05d5f56b2b5f47bab3dac84888a78946-65" name="rest_code_05d5f56b2b5f47bab3dac84888a78946-65" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_05d5f56b2b5f47bab3dac84888a78946-65"&gt;&lt;/a&gt;&lt;span class="n"&gt;tight_layout&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_05d5f56b2b5f47bab3dac84888a78946-66" name="rest_code_05d5f56b2b5f47bab3dac84888a78946-66" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/#rest_code_05d5f56b2b5f47bab3dac84888a78946-66"&gt;&lt;/a&gt;&lt;span class="n"&gt;show&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;In this case, we are analyzing the error of the solution as a function
of the number of nodes. This, and the number of iterations required
in the conjugate gradient are shown in the following image&lt;/p&gt;
&lt;img alt="Relative error in the solution." class="align-center" src="https://nicoguaro.github.io/images/FEM1D_convergence.svg" style="width: 800px;"&gt;
&lt;/section&gt;
&lt;/section&gt;</description><category>conjugate gradient</category><category>finite element method</category><category>julia</category><category>numerical methods</category><category>python</category><category>scientific computing</category><guid>https://nicoguaro.github.io/posts/numerical_challenge/numerical-31/</guid><pubDate>Wed, 01 Nov 2017 01:45:09 GMT</pubDate></item><item><title>Numerical methods challenge: Day 30</title><link>https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/</link><dc:creator>Nicolás Guarín-Zapata</dc:creator><description>&lt;p&gt;During October (2017) I will write a program per day for some well-known
numerical methods in both Python and Julia. It is intended to be an exercise
then don't expect the code to be good enough for real use. Also,
I should mention that I have almost no experience with Julia, so it
probably won't be idiomatic Julia but more Python-like Julia.&lt;/p&gt;
&lt;section id="conjugate-gradient"&gt;
&lt;h2&gt;Conjugate gradient&lt;/h2&gt;
&lt;p&gt;Today we have the &lt;a class="reference external" href="https://en.wikipedia.org/wiki/Conjugate_gradient_method"&gt;conjugate gradient method&lt;/a&gt;.
This method is commonly used to solve positive-definite linear systems of
equations. Compared with gradient descent, we choose as descent direction
a direction that is conjugated with the residual, that is, it is
orthogonal with the matrix as weighting.&lt;/p&gt;
&lt;p&gt;Following are the codes&lt;/p&gt;
&lt;section id="python"&gt;
&lt;h3&gt;Python&lt;/h3&gt;
&lt;div class="code"&gt;&lt;pre class="code python"&gt;&lt;a id="rest_code_da383d10cdc5439186200d8884c938cb-1" name="rest_code_da383d10cdc5439186200d8884c938cb-1" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_da383d10cdc5439186200d8884c938cb-1"&gt;&lt;/a&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;__future__&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;division&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;print_function&lt;/span&gt;
&lt;a id="rest_code_da383d10cdc5439186200d8884c938cb-2" name="rest_code_da383d10cdc5439186200d8884c938cb-2" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_da383d10cdc5439186200d8884c938cb-2"&gt;&lt;/a&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;numpy&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;np&lt;/span&gt;
&lt;a id="rest_code_da383d10cdc5439186200d8884c938cb-3" name="rest_code_da383d10cdc5439186200d8884c938cb-3" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_da383d10cdc5439186200d8884c938cb-3"&gt;&lt;/a&gt;
&lt;a id="rest_code_da383d10cdc5439186200d8884c938cb-4" name="rest_code_da383d10cdc5439186200d8884c938cb-4" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_da383d10cdc5439186200d8884c938cb-4"&gt;&lt;/a&gt;
&lt;a id="rest_code_da383d10cdc5439186200d8884c938cb-5" name="rest_code_da383d10cdc5439186200d8884c938cb-5" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_da383d10cdc5439186200d8884c938cb-5"&gt;&lt;/a&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;conj_grad&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;tol&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mf"&gt;1e-8&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_da383d10cdc5439186200d8884c938cb-6" name="rest_code_da383d10cdc5439186200d8884c938cb-6" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_da383d10cdc5439186200d8884c938cb-6"&gt;&lt;/a&gt;    &lt;span class="n"&gt;r&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;b&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;dot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_da383d10cdc5439186200d8884c938cb-7" name="rest_code_da383d10cdc5439186200d8884c938cb-7" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_da383d10cdc5439186200d8884c938cb-7"&gt;&lt;/a&gt;    &lt;span class="n"&gt;p&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;r&lt;/span&gt;
&lt;a id="rest_code_da383d10cdc5439186200d8884c938cb-8" name="rest_code_da383d10cdc5439186200d8884c938cb-8" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_da383d10cdc5439186200d8884c938cb-8"&gt;&lt;/a&gt;    &lt;span class="n"&gt;rsq_old&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;dot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_da383d10cdc5439186200d8884c938cb-9" name="rest_code_da383d10cdc5439186200d8884c938cb-9" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_da383d10cdc5439186200d8884c938cb-9"&gt;&lt;/a&gt;    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;cont&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;)):&lt;/span&gt;
&lt;a id="rest_code_da383d10cdc5439186200d8884c938cb-10" name="rest_code_da383d10cdc5439186200d8884c938cb-10" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_da383d10cdc5439186200d8884c938cb-10"&gt;&lt;/a&gt;        &lt;span class="n"&gt;Ap&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;dot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_da383d10cdc5439186200d8884c938cb-11" name="rest_code_da383d10cdc5439186200d8884c938cb-11" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_da383d10cdc5439186200d8884c938cb-11"&gt;&lt;/a&gt;        &lt;span class="n"&gt;alpha&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;rsq_old&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;dot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Ap&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_da383d10cdc5439186200d8884c938cb-12" name="rest_code_da383d10cdc5439186200d8884c938cb-12" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_da383d10cdc5439186200d8884c938cb-12"&gt;&lt;/a&gt;        &lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;alpha&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;p&lt;/span&gt;
&lt;a id="rest_code_da383d10cdc5439186200d8884c938cb-13" name="rest_code_da383d10cdc5439186200d8884c938cb-13" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_da383d10cdc5439186200d8884c938cb-13"&gt;&lt;/a&gt;        &lt;span class="n"&gt;r&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;r&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;alpha&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;Ap&lt;/span&gt;
&lt;a id="rest_code_da383d10cdc5439186200d8884c938cb-14" name="rest_code_da383d10cdc5439186200d8884c938cb-14" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_da383d10cdc5439186200d8884c938cb-14"&gt;&lt;/a&gt;        &lt;span class="n"&gt;rsq_new&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;dot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_da383d10cdc5439186200d8884c938cb-15" name="rest_code_da383d10cdc5439186200d8884c938cb-15" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_da383d10cdc5439186200d8884c938cb-15"&gt;&lt;/a&gt;        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sqrt&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;rsq_new&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;tol&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a id="rest_code_da383d10cdc5439186200d8884c938cb-16" name="rest_code_da383d10cdc5439186200d8884c938cb-16" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_da383d10cdc5439186200d8884c938cb-16"&gt;&lt;/a&gt;            &lt;span class="k"&gt;break&lt;/span&gt;
&lt;a id="rest_code_da383d10cdc5439186200d8884c938cb-17" name="rest_code_da383d10cdc5439186200d8884c938cb-17" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_da383d10cdc5439186200d8884c938cb-17"&gt;&lt;/a&gt;        &lt;span class="n"&gt;p&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;r&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;rsq_new&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="n"&gt;rsq_old&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;p&lt;/span&gt;
&lt;a id="rest_code_da383d10cdc5439186200d8884c938cb-18" name="rest_code_da383d10cdc5439186200d8884c938cb-18" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_da383d10cdc5439186200d8884c938cb-18"&gt;&lt;/a&gt;        &lt;span class="n"&gt;rsq_old&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;rsq_new&lt;/span&gt;
&lt;a id="rest_code_da383d10cdc5439186200d8884c938cb-19" name="rest_code_da383d10cdc5439186200d8884c938cb-19" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_da383d10cdc5439186200d8884c938cb-19"&gt;&lt;/a&gt;    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;cont&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sqrt&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;rsq_new&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_da383d10cdc5439186200d8884c938cb-20" name="rest_code_da383d10cdc5439186200d8884c938cb-20" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_da383d10cdc5439186200d8884c938cb-20"&gt;&lt;/a&gt;
&lt;a id="rest_code_da383d10cdc5439186200d8884c938cb-21" name="rest_code_da383d10cdc5439186200d8884c938cb-21" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_da383d10cdc5439186200d8884c938cb-21"&gt;&lt;/a&gt;
&lt;a id="rest_code_da383d10cdc5439186200d8884c938cb-22" name="rest_code_da383d10cdc5439186200d8884c938cb-22" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_da383d10cdc5439186200d8884c938cb-22"&gt;&lt;/a&gt;&lt;span class="n"&gt;N&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;1000&lt;/span&gt;
&lt;a id="rest_code_da383d10cdc5439186200d8884c938cb-23" name="rest_code_da383d10cdc5439186200d8884c938cb-23" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_da383d10cdc5439186200d8884c938cb-23"&gt;&lt;/a&gt;&lt;span class="n"&gt;A&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;diag&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ones&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;diag&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ones&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt;\
&lt;a id="rest_code_da383d10cdc5439186200d8884c938cb-24" name="rest_code_da383d10cdc5439186200d8884c938cb-24" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_da383d10cdc5439186200d8884c938cb-24"&gt;&lt;/a&gt;    &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;diag&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ones&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_da383d10cdc5439186200d8884c938cb-25" name="rest_code_da383d10cdc5439186200d8884c938cb-25" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_da383d10cdc5439186200d8884c938cb-25"&gt;&lt;/a&gt;&lt;span class="n"&gt;b&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ones&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_da383d10cdc5439186200d8884c938cb-26" name="rest_code_da383d10cdc5439186200d8884c938cb-26" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_da383d10cdc5439186200d8884c938cb-26"&gt;&lt;/a&gt;&lt;span class="n"&gt;x0&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ones&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_da383d10cdc5439186200d8884c938cb-27" name="rest_code_da383d10cdc5439186200d8884c938cb-27" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_da383d10cdc5439186200d8884c938cb-27"&gt;&lt;/a&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;niter&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;accu&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;conj_grad&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;x0&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/section&gt;
&lt;section id="julia"&gt;
&lt;h3&gt;Julia&lt;/h3&gt;
&lt;div class="code"&gt;&lt;pre class="code julia"&gt;&lt;a id="rest_code_f9ea0e9144db4e168bb726a4ee7811df-1" name="rest_code_f9ea0e9144db4e168bb726a4ee7811df-1" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_f9ea0e9144db4e168bb726a4ee7811df-1"&gt;&lt;/a&gt;&lt;span class="k"&gt;function&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;conj_grad&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;tol&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mf"&gt;1e-8&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_f9ea0e9144db4e168bb726a4ee7811df-2" name="rest_code_f9ea0e9144db4e168bb726a4ee7811df-2" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_f9ea0e9144db4e168bb726a4ee7811df-2"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_f9ea0e9144db4e168bb726a4ee7811df-3" name="rest_code_f9ea0e9144db4e168bb726a4ee7811df-3" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_f9ea0e9144db4e168bb726a4ee7811df-3"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_f9ea0e9144db4e168bb726a4ee7811df-4" name="rest_code_f9ea0e9144db4e168bb726a4ee7811df-4" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_f9ea0e9144db4e168bb726a4ee7811df-4"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;rsq_old&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;dot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_f9ea0e9144db4e168bb726a4ee7811df-5" name="rest_code_f9ea0e9144db4e168bb726a4ee7811df-5" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_f9ea0e9144db4e168bb726a4ee7811df-5"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;niter&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_f9ea0e9144db4e168bb726a4ee7811df-6" name="rest_code_f9ea0e9144db4e168bb726a4ee7811df-6" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_f9ea0e9144db4e168bb726a4ee7811df-6"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;for&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;cont&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="n"&gt;length&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_f9ea0e9144db4e168bb726a4ee7811df-7" name="rest_code_f9ea0e9144db4e168bb726a4ee7811df-7" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_f9ea0e9144db4e168bb726a4ee7811df-7"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;Ap&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_f9ea0e9144db4e168bb726a4ee7811df-8" name="rest_code_f9ea0e9144db4e168bb726a4ee7811df-8" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_f9ea0e9144db4e168bb726a4ee7811df-8"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;alpha&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;rsq_old&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;dot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Ap&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_f9ea0e9144db4e168bb726a4ee7811df-9" name="rest_code_f9ea0e9144db4e168bb726a4ee7811df-9" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_f9ea0e9144db4e168bb726a4ee7811df-9"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;alpha&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_f9ea0e9144db4e168bb726a4ee7811df-10" name="rest_code_f9ea0e9144db4e168bb726a4ee7811df-10" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_f9ea0e9144db4e168bb726a4ee7811df-10"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;alpha&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;Ap&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_f9ea0e9144db4e168bb726a4ee7811df-11" name="rest_code_f9ea0e9144db4e168bb726a4ee7811df-11" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_f9ea0e9144db4e168bb726a4ee7811df-11"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;rsq_new&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;dot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_f9ea0e9144db4e168bb726a4ee7811df-12" name="rest_code_f9ea0e9144db4e168bb726a4ee7811df-12" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_f9ea0e9144db4e168bb726a4ee7811df-12"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;sqrt&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;rsq_new&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;tol&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_f9ea0e9144db4e168bb726a4ee7811df-13" name="rest_code_f9ea0e9144db4e168bb726a4ee7811df-13" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_f9ea0e9144db4e168bb726a4ee7811df-13"&gt;&lt;/a&gt;&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="k"&gt;break&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_f9ea0e9144db4e168bb726a4ee7811df-14" name="rest_code_f9ea0e9144db4e168bb726a4ee7811df-14" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_f9ea0e9144db4e168bb726a4ee7811df-14"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="k"&gt;end&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_f9ea0e9144db4e168bb726a4ee7811df-15" name="rest_code_f9ea0e9144db4e168bb726a4ee7811df-15" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_f9ea0e9144db4e168bb726a4ee7811df-15"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;rsq_new&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;rsq_old&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_f9ea0e9144db4e168bb726a4ee7811df-16" name="rest_code_f9ea0e9144db4e168bb726a4ee7811df-16" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_f9ea0e9144db4e168bb726a4ee7811df-16"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;rsq_old&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;rsq_new&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_f9ea0e9144db4e168bb726a4ee7811df-17" name="rest_code_f9ea0e9144db4e168bb726a4ee7811df-17" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_f9ea0e9144db4e168bb726a4ee7811df-17"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;niter&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_f9ea0e9144db4e168bb726a4ee7811df-18" name="rest_code_f9ea0e9144db4e168bb726a4ee7811df-18" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_f9ea0e9144db4e168bb726a4ee7811df-18"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;end&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_f9ea0e9144db4e168bb726a4ee7811df-19" name="rest_code_f9ea0e9144db4e168bb726a4ee7811df-19" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_f9ea0e9144db4e168bb726a4ee7811df-19"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;return&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;niter&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;norm&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_f9ea0e9144db4e168bb726a4ee7811df-20" name="rest_code_f9ea0e9144db4e168bb726a4ee7811df-20" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_f9ea0e9144db4e168bb726a4ee7811df-20"&gt;&lt;/a&gt;&lt;span class="k"&gt;end&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_f9ea0e9144db4e168bb726a4ee7811df-21" name="rest_code_f9ea0e9144db4e168bb726a4ee7811df-21" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_f9ea0e9144db4e168bb726a4ee7811df-21"&gt;&lt;/a&gt;
&lt;a id="rest_code_f9ea0e9144db4e168bb726a4ee7811df-22" name="rest_code_f9ea0e9144db4e168bb726a4ee7811df-22" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_f9ea0e9144db4e168bb726a4ee7811df-22"&gt;&lt;/a&gt;
&lt;a id="rest_code_f9ea0e9144db4e168bb726a4ee7811df-23" name="rest_code_f9ea0e9144db4e168bb726a4ee7811df-23" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_f9ea0e9144db4e168bb726a4ee7811df-23"&gt;&lt;/a&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1000&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_f9ea0e9144db4e168bb726a4ee7811df-24" name="rest_code_f9ea0e9144db4e168bb726a4ee7811df-24" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_f9ea0e9144db4e168bb726a4ee7811df-24"&gt;&lt;/a&gt;&lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;diagm&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;ones&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;diagm&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ones&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;diagm&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ones&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_f9ea0e9144db4e168bb726a4ee7811df-25" name="rest_code_f9ea0e9144db4e168bb726a4ee7811df-25" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_f9ea0e9144db4e168bb726a4ee7811df-25"&gt;&lt;/a&gt;&lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ones&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_f9ea0e9144db4e168bb726a4ee7811df-26" name="rest_code_f9ea0e9144db4e168bb726a4ee7811df-26" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_f9ea0e9144db4e168bb726a4ee7811df-26"&gt;&lt;/a&gt;&lt;span class="n"&gt;x0&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ones&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_f9ea0e9144db4e168bb726a4ee7811df-27" name="rest_code_f9ea0e9144db4e168bb726a4ee7811df-27" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_f9ea0e9144db4e168bb726a4ee7811df-27"&gt;&lt;/a&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;niter&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;accu&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;conj_grad&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;x0&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;In this case, we are testing the method with a matrix that comes from
the discretization of the second order derivative using finite differences.&lt;/p&gt;
&lt;/section&gt;
&lt;section id="comparison-python-julia"&gt;
&lt;h3&gt;Comparison Python/Julia&lt;/h3&gt;
&lt;p&gt;Regarding number of lines we have: 27 in Python and 27 in Julia. The comparison
in execution time is done with &lt;code class="docutils literal"&gt;%timeit&lt;/code&gt; magic command in IPython and
&lt;code class="docutils literal"&gt;@benchmark&lt;/code&gt; in Julia.&lt;/p&gt;
&lt;p&gt;For Python:&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code IPython"&gt;&lt;a id="rest_code_6acf576e0ef442eda7783a4a58998e84-1" name="rest_code_6acf576e0ef442eda7783a4a58998e84-1" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_6acf576e0ef442eda7783a4a58998e84-1"&gt;&lt;/a&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="k"&gt;timeit&lt;/span&gt; conj_grad(A, b, x0)
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;with result&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code text"&gt;&lt;a id="rest_code_d2478854cefa41848fa3ecc0b4ebc42e-1" name="rest_code_d2478854cefa41848fa3ecc0b4ebc42e-1" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_d2478854cefa41848fa3ecc0b4ebc42e-1"&gt;&lt;/a&gt;10 loops, best of 3: 107 ms per loop
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;For Julia:&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code julia"&gt;&lt;a id="rest_code_47173f23e256493a858d0254840c3e24-1" name="rest_code_47173f23e256493a858d0254840c3e24-1" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_47173f23e256493a858d0254840c3e24-1"&gt;&lt;/a&gt;&lt;span class="nd"&gt;@benchmark&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;conj_grad&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;x0&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;with result&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code julia"&gt;&lt;a id="rest_code_a5a1633de2434a43acf3c59dc9f22714-1" name="rest_code_a5a1633de2434a43acf3c59dc9f22714-1" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_a5a1633de2434a43acf3c59dc9f22714-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;BenchmarkTools&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Trial&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_a5a1633de2434a43acf3c59dc9f22714-2" name="rest_code_a5a1633de2434a43acf3c59dc9f22714-2" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_a5a1633de2434a43acf3c59dc9f22714-2"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;memory&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;estimate&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="mf"&gt;27.13&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;MiB&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_a5a1633de2434a43acf3c59dc9f22714-3" name="rest_code_a5a1633de2434a43acf3c59dc9f22714-3" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_a5a1633de2434a43acf3c59dc9f22714-3"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;allocs&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;estimate&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="mi"&gt;3501&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_a5a1633de2434a43acf3c59dc9f22714-4" name="rest_code_a5a1633de2434a43acf3c59dc9f22714-4" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_a5a1633de2434a43acf3c59dc9f22714-4"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="o"&gt;--------------&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_a5a1633de2434a43acf3c59dc9f22714-5" name="rest_code_a5a1633de2434a43acf3c59dc9f22714-5" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_a5a1633de2434a43acf3c59dc9f22714-5"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;minimum&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;     &lt;/span&gt;&lt;span class="mf"&gt;128.477&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ms&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;0.54&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;GC&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_a5a1633de2434a43acf3c59dc9f22714-6" name="rest_code_a5a1633de2434a43acf3c59dc9f22714-6" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_a5a1633de2434a43acf3c59dc9f22714-6"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;median&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="mf"&gt;294.407&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ms&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;0.24&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;GC&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_a5a1633de2434a43acf3c59dc9f22714-7" name="rest_code_a5a1633de2434a43acf3c59dc9f22714-7" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_a5a1633de2434a43acf3c59dc9f22714-7"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;mean&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="mf"&gt;298.208&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ms&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;0.30&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;GC&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_a5a1633de2434a43acf3c59dc9f22714-8" name="rest_code_a5a1633de2434a43acf3c59dc9f22714-8" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_a5a1633de2434a43acf3c59dc9f22714-8"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;maximum&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;     &lt;/span&gt;&lt;span class="mf"&gt;464.223&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ms&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;0.30&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;GC&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_a5a1633de2434a43acf3c59dc9f22714-9" name="rest_code_a5a1633de2434a43acf3c59dc9f22714-9" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_a5a1633de2434a43acf3c59dc9f22714-9"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="o"&gt;--------------&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_a5a1633de2434a43acf3c59dc9f22714-10" name="rest_code_a5a1633de2434a43acf3c59dc9f22714-10" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_a5a1633de2434a43acf3c59dc9f22714-10"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;samples&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;          &lt;/span&gt;&lt;span class="mi"&gt;17&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_a5a1633de2434a43acf3c59dc9f22714-11" name="rest_code_a5a1633de2434a43acf3c59dc9f22714-11" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/#rest_code_a5a1633de2434a43acf3c59dc9f22714-11"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;evals&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;sample&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;     &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;In this case, we can say that the Python code is roughly 2 times faster than
Julia code.&lt;/p&gt;
&lt;/section&gt;
&lt;/section&gt;</description><category>conjugate gradient</category><category>julia</category><category>numerical methods</category><category>python</category><category>scientific computing</category><guid>https://nicoguaro.github.io/posts/numerical_challenge/numerical-30/</guid><pubDate>Tue, 31 Oct 2017 00:38:03 GMT</pubDate></item></channel></rss>