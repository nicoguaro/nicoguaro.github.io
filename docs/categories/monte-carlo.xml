<?xml version="1.0" encoding="utf-8"?>
<?xml-stylesheet type="text/xsl" href="../assets/xml/rss.xsl" media="all"?><rss version="2.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Nicolás' blog (Posts about monte carlo)</title><link>https://nicoguaro.github.io/</link><description></description><atom:link href="https://nicoguaro.github.io/categories/monte-carlo.xml" rel="self" type="application/rss+xml"></atom:link><language>en</language><copyright>Contents © 2025 &lt;a href="mailto:nicoguarin@gmail.com"&gt;Nicolás Guarín-Zapata&lt;/a&gt; 
&lt;a rel="license" href="http://creativecommons.org/licenses/by/4.0/"&gt;
&lt;img alt="Creative Commons License"
style="border-width:0"
src="https://i.creativecommons.org/l/by/4.0/88x31.png"&gt;&lt;/a&gt;</copyright><lastBuildDate>Tue, 15 Apr 2025 20:33:29 GMT</lastBuildDate><generator>Nikola (getnikola.com)</generator><docs>http://blogs.law.harvard.edu/tech/rss</docs><item><title>Randomized Marking of a Tetrahedron</title><link>https://nicoguaro.github.io/posts/marking-tetrahedron/</link><dc:creator>Nicolás Guarín-Zapata</dc:creator><description>&lt;p&gt;Yesterday (June 4, 2020), Christian Howard posted on
&lt;a class="reference external" href="https://twitter.com/choward1491/status/1268736220055699457"&gt;Twitter&lt;/a&gt;
the following question&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;You are given a tetrahedron τ. For each triangular facet of τ,
we uniformly at random mark one of their edges. What is the
probability that there exists an edge of τ that is marked twice?&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;I thought about a little bit but I couldn't find how to count
properly. Then, a number popped up in my mind out of the blue:
&lt;span class="math"&gt;\(2/3\)&lt;/span&gt;, but I don't know why. So, I decided to run a
simulation to check this number.&lt;/p&gt;
&lt;p&gt;The right answer is &lt;span class="math"&gt;\(51/81\)&lt;/span&gt; that is approximately 63%. This
calculation is well explained in
&lt;a class="reference external" href="https://medium.com/@choward1491/randomized-marking-of-a-tetrahedron-f978593f43d2"&gt;Christian's blog&lt;/a&gt;
and with some cool drawings (and memes).&lt;/p&gt;
&lt;section id="the-algorithm"&gt;
&lt;h2&gt;The algorithm&lt;/h2&gt;
&lt;p&gt;The algorithm is quite simple. I number the edges in each face following
a counter-clockwise orientation:&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;&lt;strong&gt;face 0&lt;/strong&gt;: edge 0, edge 1, edge 2&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;strong&gt;face 1&lt;/strong&gt;: edge 0, edge 3, edge 4&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;strong&gt;face 2&lt;/strong&gt;: edge 1, edge 5, edge 3&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;strong&gt;face 3&lt;/strong&gt;: edge 2, edge 4, edge 5&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Then, I take each face and pick a random number from &lt;span class="math"&gt;\((0, 1, 2)\)&lt;/span&gt; and
mark the corresponding edge, and move to the following face. I repeat
this process several times and I count the favorable cases and divide
them by the number of trials to get an estimate of the probability.&lt;/p&gt;
&lt;p&gt;Following is a Python code that follows this idea.&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code python"&gt;&lt;a id="rest_code_f8262e61ff864e6397def81f935cd7fa-1" name="rest_code_f8262e61ff864e6397def81f935cd7fa-1" href="https://nicoguaro.github.io/posts/marking-tetrahedron/#rest_code_f8262e61ff864e6397def81f935cd7fa-1"&gt;&lt;/a&gt;&lt;span class="kn"&gt;import&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nn"&gt;numpy&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;as&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nn"&gt;np&lt;/span&gt;
&lt;a id="rest_code_f8262e61ff864e6397def81f935cd7fa-2" name="rest_code_f8262e61ff864e6397def81f935cd7fa-2" href="https://nicoguaro.github.io/posts/marking-tetrahedron/#rest_code_f8262e61ff864e6397def81f935cd7fa-2"&gt;&lt;/a&gt;&lt;span class="kn"&gt;import&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nn"&gt;matplotlib.pyplot&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;as&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nn"&gt;plt&lt;/span&gt;
&lt;a id="rest_code_f8262e61ff864e6397def81f935cd7fa-3" name="rest_code_f8262e61ff864e6397def81f935cd7fa-3" href="https://nicoguaro.github.io/posts/marking-tetrahedron/#rest_code_f8262e61ff864e6397def81f935cd7fa-3"&gt;&lt;/a&gt;
&lt;a id="rest_code_f8262e61ff864e6397def81f935cd7fa-4" name="rest_code_f8262e61ff864e6397def81f935cd7fa-4" href="https://nicoguaro.github.io/posts/marking-tetrahedron/#rest_code_f8262e61ff864e6397def81f935cd7fa-4"&gt;&lt;/a&gt;&lt;span class="n"&gt;faces&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;
&lt;a id="rest_code_f8262e61ff864e6397def81f935cd7fa-5" name="rest_code_f8262e61ff864e6397def81f935cd7fa-5" href="https://nicoguaro.github.io/posts/marking-tetrahedron/#rest_code_f8262e61ff864e6397def81f935cd7fa-5"&gt;&lt;/a&gt;        &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;
&lt;a id="rest_code_f8262e61ff864e6397def81f935cd7fa-6" name="rest_code_f8262e61ff864e6397def81f935cd7fa-6" href="https://nicoguaro.github.io/posts/marking-tetrahedron/#rest_code_f8262e61ff864e6397def81f935cd7fa-6"&gt;&lt;/a&gt;        &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;
&lt;a id="rest_code_f8262e61ff864e6397def81f935cd7fa-7" name="rest_code_f8262e61ff864e6397def81f935cd7fa-7" href="https://nicoguaro.github.io/posts/marking-tetrahedron/#rest_code_f8262e61ff864e6397def81f935cd7fa-7"&gt;&lt;/a&gt;        &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;
&lt;a id="rest_code_f8262e61ff864e6397def81f935cd7fa-8" name="rest_code_f8262e61ff864e6397def81f935cd7fa-8" href="https://nicoguaro.github.io/posts/marking-tetrahedron/#rest_code_f8262e61ff864e6397def81f935cd7fa-8"&gt;&lt;/a&gt;        &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;]])&lt;/span&gt;
&lt;a id="rest_code_f8262e61ff864e6397def81f935cd7fa-9" name="rest_code_f8262e61ff864e6397def81f935cd7fa-9" href="https://nicoguaro.github.io/posts/marking-tetrahedron/#rest_code_f8262e61ff864e6397def81f935cd7fa-9"&gt;&lt;/a&gt;
&lt;a id="rest_code_f8262e61ff864e6397def81f935cd7fa-10" name="rest_code_f8262e61ff864e6397def81f935cd7fa-10" href="https://nicoguaro.github.io/posts/marking-tetrahedron/#rest_code_f8262e61ff864e6397def81f935cd7fa-10"&gt;&lt;/a&gt;
&lt;a id="rest_code_f8262e61ff864e6397def81f935cd7fa-11" name="rest_code_f8262e61ff864e6397def81f935cd7fa-11" href="https://nicoguaro.github.io/posts/marking-tetrahedron/#rest_code_f8262e61ff864e6397def81f935cd7fa-11"&gt;&lt;/a&gt;&lt;span class="k"&gt;def&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nf"&gt;mark_edges&lt;/span&gt;&lt;span class="p"&gt;():&lt;/span&gt;
&lt;a id="rest_code_f8262e61ff864e6397def81f935cd7fa-12" name="rest_code_f8262e61ff864e6397def81f935cd7fa-12" href="https://nicoguaro.github.io/posts/marking-tetrahedron/#rest_code_f8262e61ff864e6397def81f935cd7fa-12"&gt;&lt;/a&gt;    &lt;span class="n"&gt;marked_edges&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="mi"&gt;6&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;dtype&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nb"&gt;int&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_f8262e61ff864e6397def81f935cd7fa-13" name="rest_code_f8262e61ff864e6397def81f935cd7fa-13" href="https://nicoguaro.github.io/posts/marking-tetrahedron/#rest_code_f8262e61ff864e6397def81f935cd7fa-13"&gt;&lt;/a&gt;    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;face&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;faces&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a id="rest_code_f8262e61ff864e6397def81f935cd7fa-14" name="rest_code_f8262e61ff864e6397def81f935cd7fa-14" href="https://nicoguaro.github.io/posts/marking-tetrahedron/#rest_code_f8262e61ff864e6397def81f935cd7fa-14"&gt;&lt;/a&gt;        &lt;span class="n"&gt;num&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;random&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;randint&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_f8262e61ff864e6397def81f935cd7fa-15" name="rest_code_f8262e61ff864e6397def81f935cd7fa-15" href="https://nicoguaro.github.io/posts/marking-tetrahedron/#rest_code_f8262e61ff864e6397def81f935cd7fa-15"&gt;&lt;/a&gt;        &lt;span class="n"&gt;edge&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;face&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;num&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_f8262e61ff864e6397def81f935cd7fa-16" name="rest_code_f8262e61ff864e6397def81f935cd7fa-16" href="https://nicoguaro.github.io/posts/marking-tetrahedron/#rest_code_f8262e61ff864e6397def81f935cd7fa-16"&gt;&lt;/a&gt;        &lt;span class="n"&gt;marked_edges&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;edge&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;+=&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;
&lt;a id="rest_code_f8262e61ff864e6397def81f935cd7fa-17" name="rest_code_f8262e61ff864e6397def81f935cd7fa-17" href="https://nicoguaro.github.io/posts/marking-tetrahedron/#rest_code_f8262e61ff864e6397def81f935cd7fa-17"&gt;&lt;/a&gt;    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;marked_edges&lt;/span&gt;
&lt;a id="rest_code_f8262e61ff864e6397def81f935cd7fa-18" name="rest_code_f8262e61ff864e6397def81f935cd7fa-18" href="https://nicoguaro.github.io/posts/marking-tetrahedron/#rest_code_f8262e61ff864e6397def81f935cd7fa-18"&gt;&lt;/a&gt;
&lt;a id="rest_code_f8262e61ff864e6397def81f935cd7fa-19" name="rest_code_f8262e61ff864e6397def81f935cd7fa-19" href="https://nicoguaro.github.io/posts/marking-tetrahedron/#rest_code_f8262e61ff864e6397def81f935cd7fa-19"&gt;&lt;/a&gt;
&lt;a id="rest_code_f8262e61ff864e6397def81f935cd7fa-20" name="rest_code_f8262e61ff864e6397def81f935cd7fa-20" href="https://nicoguaro.github.io/posts/marking-tetrahedron/#rest_code_f8262e61ff864e6397def81f935cd7fa-20"&gt;&lt;/a&gt;&lt;span class="k"&gt;def&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nf"&gt;comp_probs&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N_min&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;N_max&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;ntrials&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;100&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_f8262e61ff864e6397def81f935cd7fa-21" name="rest_code_f8262e61ff864e6397def81f935cd7fa-21" href="https://nicoguaro.github.io/posts/marking-tetrahedron/#rest_code_f8262e61ff864e6397def81f935cd7fa-21"&gt;&lt;/a&gt;    &lt;span class="n"&gt;prob&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[]&lt;/span&gt;
&lt;a id="rest_code_f8262e61ff864e6397def81f935cd7fa-22" name="rest_code_f8262e61ff864e6397def81f935cd7fa-22" href="https://nicoguaro.github.io/posts/marking-tetrahedron/#rest_code_f8262e61ff864e6397def81f935cd7fa-22"&gt;&lt;/a&gt;    &lt;span class="n"&gt;N_vals&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;logspace&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N_min&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;N_max&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;ntrials&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;dtype&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nb"&gt;int&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_f8262e61ff864e6397def81f935cd7fa-23" name="rest_code_f8262e61ff864e6397def81f935cd7fa-23" href="https://nicoguaro.github.io/posts/marking-tetrahedron/#rest_code_f8262e61ff864e6397def81f935cd7fa-23"&gt;&lt;/a&gt;    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;N&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;N_vals&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a id="rest_code_f8262e61ff864e6397def81f935cd7fa-24" name="rest_code_f8262e61ff864e6397def81f935cd7fa-24" href="https://nicoguaro.github.io/posts/marking-tetrahedron/#rest_code_f8262e61ff864e6397def81f935cd7fa-24"&gt;&lt;/a&gt;        &lt;span class="n"&gt;cont_marked&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;
&lt;a id="rest_code_f8262e61ff864e6397def81f935cd7fa-25" name="rest_code_f8262e61ff864e6397def81f935cd7fa-25" href="https://nicoguaro.github.io/posts/marking-tetrahedron/#rest_code_f8262e61ff864e6397def81f935cd7fa-25"&gt;&lt;/a&gt;        &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;cont&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_f8262e61ff864e6397def81f935cd7fa-26" name="rest_code_f8262e61ff864e6397def81f935cd7fa-26" href="https://nicoguaro.github.io/posts/marking-tetrahedron/#rest_code_f8262e61ff864e6397def81f935cd7fa-26"&gt;&lt;/a&gt;            &lt;span class="n"&gt;marked&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;mark_edges&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a id="rest_code_f8262e61ff864e6397def81f935cd7fa-27" name="rest_code_f8262e61ff864e6397def81f935cd7fa-27" href="https://nicoguaro.github.io/posts/marking-tetrahedron/#rest_code_f8262e61ff864e6397def81f935cd7fa-27"&gt;&lt;/a&gt;            &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;marked&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a id="rest_code_f8262e61ff864e6397def81f935cd7fa-28" name="rest_code_f8262e61ff864e6397def81f935cd7fa-28" href="https://nicoguaro.github.io/posts/marking-tetrahedron/#rest_code_f8262e61ff864e6397def81f935cd7fa-28"&gt;&lt;/a&gt;                &lt;span class="n"&gt;cont_marked&lt;/span&gt; &lt;span class="o"&gt;+=&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;
&lt;a id="rest_code_f8262e61ff864e6397def81f935cd7fa-29" name="rest_code_f8262e61ff864e6397def81f935cd7fa-29" href="https://nicoguaro.github.io/posts/marking-tetrahedron/#rest_code_f8262e61ff864e6397def81f935cd7fa-29"&gt;&lt;/a&gt;        &lt;span class="n"&gt;prob&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;append&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;cont_marked&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_f8262e61ff864e6397def81f935cd7fa-30" name="rest_code_f8262e61ff864e6397def81f935cd7fa-30" href="https://nicoguaro.github.io/posts/marking-tetrahedron/#rest_code_f8262e61ff864e6397def81f935cd7fa-30"&gt;&lt;/a&gt;    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;N_vals&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;prob&lt;/span&gt;
&lt;a id="rest_code_f8262e61ff864e6397def81f935cd7fa-31" name="rest_code_f8262e61ff864e6397def81f935cd7fa-31" href="https://nicoguaro.github.io/posts/marking-tetrahedron/#rest_code_f8262e61ff864e6397def81f935cd7fa-31"&gt;&lt;/a&gt;
&lt;a id="rest_code_f8262e61ff864e6397def81f935cd7fa-32" name="rest_code_f8262e61ff864e6397def81f935cd7fa-32" href="https://nicoguaro.github.io/posts/marking-tetrahedron/#rest_code_f8262e61ff864e6397def81f935cd7fa-32"&gt;&lt;/a&gt;
&lt;a id="rest_code_f8262e61ff864e6397def81f935cd7fa-33" name="rest_code_f8262e61ff864e6397def81f935cd7fa-33" href="https://nicoguaro.github.io/posts/marking-tetrahedron/#rest_code_f8262e61ff864e6397def81f935cd7fa-33"&gt;&lt;/a&gt;&lt;span class="c1"&gt;#%% Computation&lt;/span&gt;
&lt;a id="rest_code_f8262e61ff864e6397def81f935cd7fa-34" name="rest_code_f8262e61ff864e6397def81f935cd7fa-34" href="https://nicoguaro.github.io/posts/marking-tetrahedron/#rest_code_f8262e61ff864e6397def81f935cd7fa-34"&gt;&lt;/a&gt;&lt;span class="n"&gt;N_min&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;
&lt;a id="rest_code_f8262e61ff864e6397def81f935cd7fa-35" name="rest_code_f8262e61ff864e6397def81f935cd7fa-35" href="https://nicoguaro.github.io/posts/marking-tetrahedron/#rest_code_f8262e61ff864e6397def81f935cd7fa-35"&gt;&lt;/a&gt;&lt;span class="n"&gt;N_max&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;5&lt;/span&gt;
&lt;a id="rest_code_f8262e61ff864e6397def81f935cd7fa-36" name="rest_code_f8262e61ff864e6397def81f935cd7fa-36" href="https://nicoguaro.github.io/posts/marking-tetrahedron/#rest_code_f8262e61ff864e6397def81f935cd7fa-36"&gt;&lt;/a&gt;&lt;span class="n"&gt;ntrials&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;100&lt;/span&gt;
&lt;a id="rest_code_f8262e61ff864e6397def81f935cd7fa-37" name="rest_code_f8262e61ff864e6397def81f935cd7fa-37" href="https://nicoguaro.github.io/posts/marking-tetrahedron/#rest_code_f8262e61ff864e6397def81f935cd7fa-37"&gt;&lt;/a&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;random&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;seed&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;seed&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_f8262e61ff864e6397def81f935cd7fa-38" name="rest_code_f8262e61ff864e6397def81f935cd7fa-38" href="https://nicoguaro.github.io/posts/marking-tetrahedron/#rest_code_f8262e61ff864e6397def81f935cd7fa-38"&gt;&lt;/a&gt;&lt;span class="n"&gt;N_vals&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;prob&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;comp_probs&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N_min&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;N_max&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;ntrials&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_f8262e61ff864e6397def81f935cd7fa-39" name="rest_code_f8262e61ff864e6397def81f935cd7fa-39" href="https://nicoguaro.github.io/posts/marking-tetrahedron/#rest_code_f8262e61ff864e6397def81f935cd7fa-39"&gt;&lt;/a&gt;
&lt;a id="rest_code_f8262e61ff864e6397def81f935cd7fa-40" name="rest_code_f8262e61ff864e6397def81f935cd7fa-40" href="https://nicoguaro.github.io/posts/marking-tetrahedron/#rest_code_f8262e61ff864e6397def81f935cd7fa-40"&gt;&lt;/a&gt;&lt;span class="c1"&gt;#%% Plotting&lt;/span&gt;
&lt;a id="rest_code_f8262e61ff864e6397def81f935cd7fa-41" name="rest_code_f8262e61ff864e6397def81f935cd7fa-41" href="https://nicoguaro.github.io/posts/marking-tetrahedron/#rest_code_f8262e61ff864e6397def81f935cd7fa-41"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;figure&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;figsize&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_f8262e61ff864e6397def81f935cd7fa-42" name="rest_code_f8262e61ff864e6397def81f935cd7fa-42" href="https://nicoguaro.github.io/posts/marking-tetrahedron/#rest_code_f8262e61ff864e6397def81f935cd7fa-42"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;hlines&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;0.63&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="n"&gt;N_min&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="n"&gt;N_max&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;color&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;"#3f3f3f"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_f8262e61ff864e6397def81f935cd7fa-43" name="rest_code_f8262e61ff864e6397def81f935cd7fa-43" href="https://nicoguaro.github.io/posts/marking-tetrahedron/#rest_code_f8262e61ff864e6397def81f935cd7fa-43"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;semilogx&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N_vals&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;prob&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="s2"&gt;"o"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;alpha&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mf"&gt;0.5&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_f8262e61ff864e6397def81f935cd7fa-44" name="rest_code_f8262e61ff864e6397def81f935cd7fa-44" href="https://nicoguaro.github.io/posts/marking-tetrahedron/#rest_code_f8262e61ff864e6397def81f935cd7fa-44"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"Number of trials"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_f8262e61ff864e6397def81f935cd7fa-45" name="rest_code_f8262e61ff864e6397def81f935cd7fa-45" href="https://nicoguaro.github.io/posts/marking-tetrahedron/#rest_code_f8262e61ff864e6397def81f935cd7fa-45"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ylabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"Estimated probability"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_f8262e61ff864e6397def81f935cd7fa-46" name="rest_code_f8262e61ff864e6397def81f935cd7fa-46" href="https://nicoguaro.github.io/posts/marking-tetrahedron/#rest_code_f8262e61ff864e6397def81f935cd7fa-46"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;savefig&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"prob_tet.svg"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;dpi&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;300&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;bbox_inches&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;"tight"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_f8262e61ff864e6397def81f935cd7fa-47" name="rest_code_f8262e61ff864e6397def81f935cd7fa-47" href="https://nicoguaro.github.io/posts/marking-tetrahedron/#rest_code_f8262e61ff864e6397def81f935cd7fa-47"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;show&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;And we can see the following evolution for different number of trials.&lt;/p&gt;
&lt;img alt="Estimated probabilities for different sample sizes." class="align-center" src="https://nicoguaro.github.io/images/marked_tets.svg" style="width: 600px;"&gt;
&lt;/section&gt;</description><category>combinatorics</category><category>computational geometry</category><category>monte carlo</category><guid>https://nicoguaro.github.io/posts/marking-tetrahedron/</guid><pubDate>Sat, 06 Jun 2020 03:58:32 GMT</pubDate></item><item><title>Probability that a random tetrahedron over a sphere contains its center</title><link>https://nicoguaro.github.io/posts/putnam_prob/</link><dc:creator>Nicolás Guarín-Zapata</dc:creator><description>&lt;p&gt;I got interested in this problem watching the YouTube channel
&lt;a class="reference external" href="https://www.youtube.com/channel/UCYO_jab_esuFRV4b17AJtAw"&gt;3Blue1Brown&lt;/a&gt;,
by Grant Sanderson, where he explains a way to tackle the problem that
is just … elegant!&lt;/p&gt;
&lt;p&gt;I can't emphasize enough how much I like this channel. For example,
his approach to linear algebra in
&lt;a class="reference external" href="https://www.youtube.com/watch?v=kjBOesZCoqc&amp;amp;list=PLZHQObOWTQDPD3MizzM2xVFitgF8hE_ab"&gt;Essence of linear algebra&lt;/a&gt; is really
good. I mention it, just in case you don't know it.&lt;/p&gt;
&lt;section id="the-problem"&gt;
&lt;h2&gt;The problem&lt;/h2&gt;
&lt;p&gt;Let's talk business now. The problem was originally part of the 53rd
&lt;a class="reference external" href="http://kskedlaya.org/putnam-archive/1992.pdf"&gt;Putnam competition on 1992&lt;/a&gt;
and was stated as&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Four points are chosen at random on the surface of a
sphere.   What is the probability that the center of the
sphere lies inside the tetrahedron whose vertices are at
the four points?  (It is understood that each point is in-
dependently chosen relative to a uniform distribution on
the sphere.)&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;As shown in the mentioned video, the probability is &lt;span class="math"&gt;\(1/8\)&lt;/span&gt;. Let's
come with an algorithm to obtain this result —approximately, at least.&lt;/p&gt;
&lt;/section&gt;
&lt;section id="the-proposed-approach"&gt;
&lt;h2&gt;The proposed approach&lt;/h2&gt;
&lt;p&gt;The approach that we are going to use is pretty straightforward. We are
going to obtain a sample of (independent) random sets, with four points
each, and check how many of them satisfy the condition of being inside
the tetrahedron with the points as vertices.&lt;/p&gt;
&lt;p&gt;For this approach to work, we need two things:&lt;/p&gt;
&lt;ol class="arabic simple"&gt;
&lt;li&gt;&lt;p&gt;A way to generate random numbers uniformly distributed. This is already
in &lt;code class="docutils literal"&gt;numpy.random.uniform&lt;/code&gt;, so we don't need to do much about it.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;A way to check if a point is inside a tetrahedron.&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;section id="checking-that-a-point-is-inside-a-tetrahedron"&gt;
&lt;h3&gt;Checking that a point is inside a tetrahedron&lt;/h3&gt;
&lt;p&gt;To find if a point is inside a tetrahedron, we could compute the
&lt;a class="reference external" href="https://en.wikipedia.org/wiki/Barycentric_coordinate_system"&gt;barycentric coordinates&lt;/a&gt;
for that point and check that all of them are have the same sign. Equivalently,
as proposed &lt;a class="reference external" href="http://steve.hollasch.net/cgindex/geometry/ptintet.html"&gt;here&lt;/a&gt;,
we can check that the determinants of the matrices&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
M_0 =
\begin{bmatrix}
x_0 &amp;amp;y_0 &amp;amp;z_0 &amp;amp;1\\
x_1 &amp;amp;y_1 &amp;amp;z_1 &amp;amp;1\\
x_2 &amp;amp;y_2 &amp;amp;z_2 &amp;amp;1\\
x_3 &amp;amp;y_3 &amp;amp;z_3 &amp;amp;1
\end{bmatrix}\, ,
\end{equation*}
&lt;/div&gt;
&lt;div class="math"&gt;
\begin{equation*}
M_1 =
\begin{bmatrix}
x &amp;amp;y &amp;amp;z &amp;amp;1\\
x_1 &amp;amp;y_1 &amp;amp;z_1 &amp;amp;1\\
x_2 &amp;amp;y_2 &amp;amp;z_2 &amp;amp;1\\
x_3 &amp;amp;y_3 &amp;amp;z_3 &amp;amp;1
\end{bmatrix}\, ,
\end{equation*}
&lt;/div&gt;
&lt;div class="math"&gt;
\begin{equation*}
M_2 =
\begin{bmatrix}
x_0 &amp;amp;y_0 &amp;amp;z_0 &amp;amp;1\\
x &amp;amp;y &amp;amp;z &amp;amp;1\\
x_2 &amp;amp;y_2 &amp;amp;z_2 &amp;amp;1\\
x_3 &amp;amp;y_3 &amp;amp;z_3 &amp;amp;1
\end{bmatrix}\, ,
\end{equation*}
&lt;/div&gt;
&lt;div class="math"&gt;
\begin{equation*}
M_3 =
\begin{bmatrix}
x_0 &amp;amp;y_0 &amp;amp;z_0 &amp;amp;1\\
x_1 &amp;amp;y_1 &amp;amp;z_1 &amp;amp;1\\
x &amp;amp;y &amp;amp;z &amp;amp;1\\
x_3 &amp;amp;y_3 &amp;amp;z_3 &amp;amp;1
\end{bmatrix}\, ,
\end{equation*}
&lt;/div&gt;
&lt;div class="math"&gt;
\begin{equation*}
M_4 =
\begin{bmatrix}
x_0 &amp;amp;y_0 &amp;amp;z_0 &amp;amp;1\\
x_1 &amp;amp;y_1 &amp;amp;z_1 &amp;amp;1\\
x_2 &amp;amp;y_2 &amp;amp;z_2 &amp;amp;1\\
x &amp;amp;y &amp;amp;z &amp;amp;1
\end{bmatrix}\, ,
\end{equation*}
&lt;/div&gt;
&lt;p&gt;have the same sign. In this case, &lt;span class="math"&gt;\((x, y, z)\)&lt;/span&gt; is the point of interest
and &lt;span class="math"&gt;\((x_i, y_i, z_i)\)&lt;/span&gt; are the coordinates of each vertex.&lt;/p&gt;
&lt;/section&gt;
&lt;/section&gt;
&lt;section id="the-algorithm"&gt;
&lt;h2&gt;The algorithm&lt;/h2&gt;
&lt;p&gt;Below is a Python implementation of the approach discussed before&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code python"&gt;&lt;a id="rest_code_ee7622f7f158452caf1315fc844f21d0-1" name="rest_code_ee7622f7f158452caf1315fc844f21d0-1" href="https://nicoguaro.github.io/posts/putnam_prob/#rest_code_ee7622f7f158452caf1315fc844f21d0-1"&gt;&lt;/a&gt;&lt;span class="kn"&gt;from&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nn"&gt;__future__&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;division&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;print_function&lt;/span&gt;
&lt;a id="rest_code_ee7622f7f158452caf1315fc844f21d0-2" name="rest_code_ee7622f7f158452caf1315fc844f21d0-2" href="https://nicoguaro.github.io/posts/putnam_prob/#rest_code_ee7622f7f158452caf1315fc844f21d0-2"&gt;&lt;/a&gt;&lt;span class="kn"&gt;from&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nn"&gt;numpy&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;random&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;pi&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;cos&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;sin&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;sign&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;hstack&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;a id="rest_code_ee7622f7f158452caf1315fc844f21d0-3" name="rest_code_ee7622f7f158452caf1315fc844f21d0-3" href="https://nicoguaro.github.io/posts/putnam_prob/#rest_code_ee7622f7f158452caf1315fc844f21d0-3"&gt;&lt;/a&gt;                   &lt;span class="n"&gt;column_stack&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;logspace&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_ee7622f7f158452caf1315fc844f21d0-4" name="rest_code_ee7622f7f158452caf1315fc844f21d0-4" href="https://nicoguaro.github.io/posts/putnam_prob/#rest_code_ee7622f7f158452caf1315fc844f21d0-4"&gt;&lt;/a&gt;&lt;span class="kn"&gt;from&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nn"&gt;numpy.linalg&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;det&lt;/span&gt;
&lt;a id="rest_code_ee7622f7f158452caf1315fc844f21d0-5" name="rest_code_ee7622f7f158452caf1315fc844f21d0-5" href="https://nicoguaro.github.io/posts/putnam_prob/#rest_code_ee7622f7f158452caf1315fc844f21d0-5"&gt;&lt;/a&gt;&lt;span class="kn"&gt;import&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nn"&gt;matplotlib.pyplot&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;as&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nn"&gt;plt&lt;/span&gt;
&lt;a id="rest_code_ee7622f7f158452caf1315fc844f21d0-6" name="rest_code_ee7622f7f158452caf1315fc844f21d0-6" href="https://nicoguaro.github.io/posts/putnam_prob/#rest_code_ee7622f7f158452caf1315fc844f21d0-6"&gt;&lt;/a&gt;
&lt;a id="rest_code_ee7622f7f158452caf1315fc844f21d0-7" name="rest_code_ee7622f7f158452caf1315fc844f21d0-7" href="https://nicoguaro.github.io/posts/putnam_prob/#rest_code_ee7622f7f158452caf1315fc844f21d0-7"&gt;&lt;/a&gt;
&lt;a id="rest_code_ee7622f7f158452caf1315fc844f21d0-8" name="rest_code_ee7622f7f158452caf1315fc844f21d0-8" href="https://nicoguaro.github.io/posts/putnam_prob/#rest_code_ee7622f7f158452caf1315fc844f21d0-8"&gt;&lt;/a&gt;&lt;span class="k"&gt;def&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nf"&gt;in_tet&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;z&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;pt&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_ee7622f7f158452caf1315fc844f21d0-9" name="rest_code_ee7622f7f158452caf1315fc844f21d0-9" href="https://nicoguaro.github.io/posts/putnam_prob/#rest_code_ee7622f7f158452caf1315fc844f21d0-9"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="sd"&gt;"""&lt;/span&gt;
&lt;a id="rest_code_ee7622f7f158452caf1315fc844f21d0-10" name="rest_code_ee7622f7f158452caf1315fc844f21d0-10" href="https://nicoguaro.github.io/posts/putnam_prob/#rest_code_ee7622f7f158452caf1315fc844f21d0-10"&gt;&lt;/a&gt;&lt;span class="sd"&gt;    Determine if the point pt is inside the&lt;/span&gt;
&lt;a id="rest_code_ee7622f7f158452caf1315fc844f21d0-11" name="rest_code_ee7622f7f158452caf1315fc844f21d0-11" href="https://nicoguaro.github.io/posts/putnam_prob/#rest_code_ee7622f7f158452caf1315fc844f21d0-11"&gt;&lt;/a&gt;&lt;span class="sd"&gt;    tetrahedron with vertices coordinates x, y, z&lt;/span&gt;
&lt;a id="rest_code_ee7622f7f158452caf1315fc844f21d0-12" name="rest_code_ee7622f7f158452caf1315fc844f21d0-12" href="https://nicoguaro.github.io/posts/putnam_prob/#rest_code_ee7622f7f158452caf1315fc844f21d0-12"&gt;&lt;/a&gt;&lt;span class="sd"&gt;    """&lt;/span&gt;
&lt;a id="rest_code_ee7622f7f158452caf1315fc844f21d0-13" name="rest_code_ee7622f7f158452caf1315fc844f21d0-13" href="https://nicoguaro.github.io/posts/putnam_prob/#rest_code_ee7622f7f158452caf1315fc844f21d0-13"&gt;&lt;/a&gt;    &lt;span class="n"&gt;mat0&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;column_stack&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;z&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]))&lt;/span&gt;
&lt;a id="rest_code_ee7622f7f158452caf1315fc844f21d0-14" name="rest_code_ee7622f7f158452caf1315fc844f21d0-14" href="https://nicoguaro.github.io/posts/putnam_prob/#rest_code_ee7622f7f158452caf1315fc844f21d0-14"&gt;&lt;/a&gt;    &lt;span class="n"&gt;det0&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;det&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;mat0&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_ee7622f7f158452caf1315fc844f21d0-15" name="rest_code_ee7622f7f158452caf1315fc844f21d0-15" href="https://nicoguaro.github.io/posts/putnam_prob/#rest_code_ee7622f7f158452caf1315fc844f21d0-15"&gt;&lt;/a&gt;    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;cont&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_ee7622f7f158452caf1315fc844f21d0-16" name="rest_code_ee7622f7f158452caf1315fc844f21d0-16" href="https://nicoguaro.github.io/posts/putnam_prob/#rest_code_ee7622f7f158452caf1315fc844f21d0-16"&gt;&lt;/a&gt;        &lt;span class="n"&gt;mat&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;mat0&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;copy&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a id="rest_code_ee7622f7f158452caf1315fc844f21d0-17" name="rest_code_ee7622f7f158452caf1315fc844f21d0-17" href="https://nicoguaro.github.io/posts/putnam_prob/#rest_code_ee7622f7f158452caf1315fc844f21d0-17"&gt;&lt;/a&gt;        &lt;span class="n"&gt;mat&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;cont&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;hstack&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="n"&gt;pt&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_ee7622f7f158452caf1315fc844f21d0-18" name="rest_code_ee7622f7f158452caf1315fc844f21d0-18" href="https://nicoguaro.github.io/posts/putnam_prob/#rest_code_ee7622f7f158452caf1315fc844f21d0-18"&gt;&lt;/a&gt;        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;sign&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;det&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;mat&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;det0&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a id="rest_code_ee7622f7f158452caf1315fc844f21d0-19" name="rest_code_ee7622f7f158452caf1315fc844f21d0-19" href="https://nicoguaro.github.io/posts/putnam_prob/#rest_code_ee7622f7f158452caf1315fc844f21d0-19"&gt;&lt;/a&gt;            &lt;span class="n"&gt;inside&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="kc"&gt;False&lt;/span&gt;
&lt;a id="rest_code_ee7622f7f158452caf1315fc844f21d0-20" name="rest_code_ee7622f7f158452caf1315fc844f21d0-20" href="https://nicoguaro.github.io/posts/putnam_prob/#rest_code_ee7622f7f158452caf1315fc844f21d0-20"&gt;&lt;/a&gt;            &lt;span class="k"&gt;break&lt;/span&gt;
&lt;a id="rest_code_ee7622f7f158452caf1315fc844f21d0-21" name="rest_code_ee7622f7f158452caf1315fc844f21d0-21" href="https://nicoguaro.github.io/posts/putnam_prob/#rest_code_ee7622f7f158452caf1315fc844f21d0-21"&gt;&lt;/a&gt;        &lt;span class="k"&gt;else&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a id="rest_code_ee7622f7f158452caf1315fc844f21d0-22" name="rest_code_ee7622f7f158452caf1315fc844f21d0-22" href="https://nicoguaro.github.io/posts/putnam_prob/#rest_code_ee7622f7f158452caf1315fc844f21d0-22"&gt;&lt;/a&gt;            &lt;span class="n"&gt;inside&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="kc"&gt;True&lt;/span&gt;
&lt;a id="rest_code_ee7622f7f158452caf1315fc844f21d0-23" name="rest_code_ee7622f7f158452caf1315fc844f21d0-23" href="https://nicoguaro.github.io/posts/putnam_prob/#rest_code_ee7622f7f158452caf1315fc844f21d0-23"&gt;&lt;/a&gt;    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;inside&lt;/span&gt;
&lt;a id="rest_code_ee7622f7f158452caf1315fc844f21d0-24" name="rest_code_ee7622f7f158452caf1315fc844f21d0-24" href="https://nicoguaro.github.io/posts/putnam_prob/#rest_code_ee7622f7f158452caf1315fc844f21d0-24"&gt;&lt;/a&gt;
&lt;a id="rest_code_ee7622f7f158452caf1315fc844f21d0-25" name="rest_code_ee7622f7f158452caf1315fc844f21d0-25" href="https://nicoguaro.github.io/posts/putnam_prob/#rest_code_ee7622f7f158452caf1315fc844f21d0-25"&gt;&lt;/a&gt;
&lt;a id="rest_code_ee7622f7f158452caf1315fc844f21d0-26" name="rest_code_ee7622f7f158452caf1315fc844f21d0-26" href="https://nicoguaro.github.io/posts/putnam_prob/#rest_code_ee7622f7f158452caf1315fc844f21d0-26"&gt;&lt;/a&gt;&lt;span class="c1"&gt;#%% Computation&lt;/span&gt;
&lt;a id="rest_code_ee7622f7f158452caf1315fc844f21d0-27" name="rest_code_ee7622f7f158452caf1315fc844f21d0-27" href="https://nicoguaro.github.io/posts/putnam_prob/#rest_code_ee7622f7f158452caf1315fc844f21d0-27"&gt;&lt;/a&gt;&lt;span class="n"&gt;prob&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[]&lt;/span&gt;
&lt;a id="rest_code_ee7622f7f158452caf1315fc844f21d0-28" name="rest_code_ee7622f7f158452caf1315fc844f21d0-28" href="https://nicoguaro.github.io/posts/putnam_prob/#rest_code_ee7622f7f158452caf1315fc844f21d0-28"&gt;&lt;/a&gt;&lt;span class="n"&gt;random&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;seed&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;seed&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_ee7622f7f158452caf1315fc844f21d0-29" name="rest_code_ee7622f7f158452caf1315fc844f21d0-29" href="https://nicoguaro.github.io/posts/putnam_prob/#rest_code_ee7622f7f158452caf1315fc844f21d0-29"&gt;&lt;/a&gt;&lt;span class="n"&gt;N_min&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;
&lt;a id="rest_code_ee7622f7f158452caf1315fc844f21d0-30" name="rest_code_ee7622f7f158452caf1315fc844f21d0-30" href="https://nicoguaro.github.io/posts/putnam_prob/#rest_code_ee7622f7f158452caf1315fc844f21d0-30"&gt;&lt;/a&gt;&lt;span class="n"&gt;N_max&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;5&lt;/span&gt;
&lt;a id="rest_code_ee7622f7f158452caf1315fc844f21d0-31" name="rest_code_ee7622f7f158452caf1315fc844f21d0-31" href="https://nicoguaro.github.io/posts/putnam_prob/#rest_code_ee7622f7f158452caf1315fc844f21d0-31"&gt;&lt;/a&gt;&lt;span class="n"&gt;N_vals&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;logspace&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N_min&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;N_max&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;100&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;dtype&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nb"&gt;int&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_ee7622f7f158452caf1315fc844f21d0-32" name="rest_code_ee7622f7f158452caf1315fc844f21d0-32" href="https://nicoguaro.github.io/posts/putnam_prob/#rest_code_ee7622f7f158452caf1315fc844f21d0-32"&gt;&lt;/a&gt;&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;N&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;N_vals&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a id="rest_code_ee7622f7f158452caf1315fc844f21d0-33" name="rest_code_ee7622f7f158452caf1315fc844f21d0-33" href="https://nicoguaro.github.io/posts/putnam_prob/#rest_code_ee7622f7f158452caf1315fc844f21d0-33"&gt;&lt;/a&gt;    &lt;span class="n"&gt;inside_cont&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;
&lt;a id="rest_code_ee7622f7f158452caf1315fc844f21d0-34" name="rest_code_ee7622f7f158452caf1315fc844f21d0-34" href="https://nicoguaro.github.io/posts/putnam_prob/#rest_code_ee7622f7f158452caf1315fc844f21d0-34"&gt;&lt;/a&gt;    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;cont_pts&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_ee7622f7f158452caf1315fc844f21d0-35" name="rest_code_ee7622f7f158452caf1315fc844f21d0-35" href="https://nicoguaro.github.io/posts/putnam_prob/#rest_code_ee7622f7f158452caf1315fc844f21d0-35"&gt;&lt;/a&gt;        &lt;span class="n"&gt;phi&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;random&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;uniform&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;low&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mf"&gt;0.0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;high&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;pi&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;size&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_ee7622f7f158452caf1315fc844f21d0-36" name="rest_code_ee7622f7f158452caf1315fc844f21d0-36" href="https://nicoguaro.github.io/posts/putnam_prob/#rest_code_ee7622f7f158452caf1315fc844f21d0-36"&gt;&lt;/a&gt;        &lt;span class="n"&gt;theta&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;random&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;uniform&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;low&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mf"&gt;0.0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;high&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;pi&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;size&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_ee7622f7f158452caf1315fc844f21d0-37" name="rest_code_ee7622f7f158452caf1315fc844f21d0-37" href="https://nicoguaro.github.io/posts/putnam_prob/#rest_code_ee7622f7f158452caf1315fc844f21d0-37"&gt;&lt;/a&gt;        &lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;sin&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;theta&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;cos&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;phi&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_ee7622f7f158452caf1315fc844f21d0-38" name="rest_code_ee7622f7f158452caf1315fc844f21d0-38" href="https://nicoguaro.github.io/posts/putnam_prob/#rest_code_ee7622f7f158452caf1315fc844f21d0-38"&gt;&lt;/a&gt;        &lt;span class="n"&gt;y&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;sin&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;theta&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;sin&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;phi&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_ee7622f7f158452caf1315fc844f21d0-39" name="rest_code_ee7622f7f158452caf1315fc844f21d0-39" href="https://nicoguaro.github.io/posts/putnam_prob/#rest_code_ee7622f7f158452caf1315fc844f21d0-39"&gt;&lt;/a&gt;        &lt;span class="n"&gt;z&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;cos&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;theta&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_ee7622f7f158452caf1315fc844f21d0-40" name="rest_code_ee7622f7f158452caf1315fc844f21d0-40" href="https://nicoguaro.github.io/posts/putnam_prob/#rest_code_ee7622f7f158452caf1315fc844f21d0-40"&gt;&lt;/a&gt;        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;in_tet&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;z&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]):&lt;/span&gt;
&lt;a id="rest_code_ee7622f7f158452caf1315fc844f21d0-41" name="rest_code_ee7622f7f158452caf1315fc844f21d0-41" href="https://nicoguaro.github.io/posts/putnam_prob/#rest_code_ee7622f7f158452caf1315fc844f21d0-41"&gt;&lt;/a&gt;            &lt;span class="n"&gt;inside_cont&lt;/span&gt; &lt;span class="o"&gt;+=&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;
&lt;a id="rest_code_ee7622f7f158452caf1315fc844f21d0-42" name="rest_code_ee7622f7f158452caf1315fc844f21d0-42" href="https://nicoguaro.github.io/posts/putnam_prob/#rest_code_ee7622f7f158452caf1315fc844f21d0-42"&gt;&lt;/a&gt;
&lt;a id="rest_code_ee7622f7f158452caf1315fc844f21d0-43" name="rest_code_ee7622f7f158452caf1315fc844f21d0-43" href="https://nicoguaro.github.io/posts/putnam_prob/#rest_code_ee7622f7f158452caf1315fc844f21d0-43"&gt;&lt;/a&gt;    &lt;span class="n"&gt;prob&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;append&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;inside_cont&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_ee7622f7f158452caf1315fc844f21d0-44" name="rest_code_ee7622f7f158452caf1315fc844f21d0-44" href="https://nicoguaro.github.io/posts/putnam_prob/#rest_code_ee7622f7f158452caf1315fc844f21d0-44"&gt;&lt;/a&gt;
&lt;a id="rest_code_ee7622f7f158452caf1315fc844f21d0-45" name="rest_code_ee7622f7f158452caf1315fc844f21d0-45" href="https://nicoguaro.github.io/posts/putnam_prob/#rest_code_ee7622f7f158452caf1315fc844f21d0-45"&gt;&lt;/a&gt;
&lt;a id="rest_code_ee7622f7f158452caf1315fc844f21d0-46" name="rest_code_ee7622f7f158452caf1315fc844f21d0-46" href="https://nicoguaro.github.io/posts/putnam_prob/#rest_code_ee7622f7f158452caf1315fc844f21d0-46"&gt;&lt;/a&gt;&lt;span class="c1"&gt;#%% Plotting&lt;/span&gt;
&lt;a id="rest_code_ee7622f7f158452caf1315fc844f21d0-47" name="rest_code_ee7622f7f158452caf1315fc844f21d0-47" href="https://nicoguaro.github.io/posts/putnam_prob/#rest_code_ee7622f7f158452caf1315fc844f21d0-47"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;figure&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;figsize&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_ee7622f7f158452caf1315fc844f21d0-48" name="rest_code_ee7622f7f158452caf1315fc844f21d0-48" href="https://nicoguaro.github.io/posts/putnam_prob/#rest_code_ee7622f7f158452caf1315fc844f21d0-48"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;hlines&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;0.125&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="n"&gt;N_min&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="n"&gt;N_max&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;color&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;"#3f3f3f"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_ee7622f7f158452caf1315fc844f21d0-49" name="rest_code_ee7622f7f158452caf1315fc844f21d0-49" href="https://nicoguaro.github.io/posts/putnam_prob/#rest_code_ee7622f7f158452caf1315fc844f21d0-49"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;semilogx&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N_vals&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;prob&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;"o"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;alpha&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mf"&gt;0.5&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_ee7622f7f158452caf1315fc844f21d0-50" name="rest_code_ee7622f7f158452caf1315fc844f21d0-50" href="https://nicoguaro.github.io/posts/putnam_prob/#rest_code_ee7622f7f158452caf1315fc844f21d0-50"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"Number of trials"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_ee7622f7f158452caf1315fc844f21d0-51" name="rest_code_ee7622f7f158452caf1315fc844f21d0-51" href="https://nicoguaro.github.io/posts/putnam_prob/#rest_code_ee7622f7f158452caf1315fc844f21d0-51"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ylabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"Computed probability"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_ee7622f7f158452caf1315fc844f21d0-52" name="rest_code_ee7622f7f158452caf1315fc844f21d0-52" href="https://nicoguaro.github.io/posts/putnam_prob/#rest_code_ee7622f7f158452caf1315fc844f21d0-52"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;tight_layout&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a id="rest_code_ee7622f7f158452caf1315fc844f21d0-53" name="rest_code_ee7622f7f158452caf1315fc844f21d0-53" href="https://nicoguaro.github.io/posts/putnam_prob/#rest_code_ee7622f7f158452caf1315fc844f21d0-53"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;show&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;As expected, when the number of samples is sufficiently large, the
estimated probability is close to the theoretical value: 0.125. This
can be seen in the following figure.&lt;/p&gt;
&lt;img alt="Computed probability for different sample sizes" class="align-center" src="https://nicoguaro.github.io/images/random_tets.svg" style="width: 600px;"&gt;
&lt;/section&gt;</description><category>barycentric coordinates</category><category>computational geometry</category><category>monte carlo</category><category>probability</category><category>python</category><guid>https://nicoguaro.github.io/posts/putnam_prob/</guid><pubDate>Wed, 13 Dec 2017 20:24:52 GMT</pubDate></item><item><title>Numerical methods challenge: Day 27</title><link>https://nicoguaro.github.io/posts/numerical_challenge/numerical-27/</link><dc:creator>Nicolás Guarín-Zapata</dc:creator><description>&lt;p&gt;During October (2017) I will write a program per day for some well-known
numerical methods in both Python and Julia. It is intended to be an exercise
then don't expect the code to be good enough for real use. Also,
I should mention that I have almost no experience with Julia, so it
probably won't be idiomatic Julia but more Python-like Julia.&lt;/p&gt;
&lt;section id="monte-carlo-integration"&gt;
&lt;h2&gt;Monte Carlo integration&lt;/h2&gt;
&lt;p&gt;Today we have &lt;a class="reference external" href="https://en.wikipedia.org/wiki/Monte_Carlo_integration"&gt;Monte Carlo integration&lt;/a&gt;.
Where we use random sampling to numerically compute an integral. This
method is important when we want to evaluate higher-dimensional
integrals since common quadrature techniques imply an exponential
growing in the number of sampling points.&lt;/p&gt;
&lt;p&gt;The method computes an integral&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
I = \int_\Omega f(x) dx
\end{equation*}
&lt;/div&gt;
&lt;p&gt;where &lt;span class="math"&gt;\(\Omega\)&lt;/span&gt; has volume &lt;span class="math"&gt;\(V\)&lt;/span&gt;.&lt;/p&gt;
&lt;p&gt;The integral is approximated as&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
I \approx \frac{V}{N} \sum_{i=1}^{N} f(x_i)
\end{equation*}
&lt;/div&gt;
&lt;p&gt;where the &lt;span class="math"&gt;\(x_i\)&lt;/span&gt; distribute uniform over &lt;span class="math"&gt;\(\Omega\)&lt;/span&gt;.&lt;/p&gt;
&lt;p&gt;Following are the codes&lt;/p&gt;
&lt;section id="python"&gt;
&lt;h3&gt;Python&lt;/h3&gt;
&lt;div class="code"&gt;&lt;pre class="code python"&gt;&lt;a id="rest_code_a896af94b21b44f88f23bd703c4afcc6-1" name="rest_code_a896af94b21b44f88f23bd703c4afcc6-1" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-27/#rest_code_a896af94b21b44f88f23bd703c4afcc6-1"&gt;&lt;/a&gt;&lt;span class="kn"&gt;from&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nn"&gt;__future__&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;division&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;print_function&lt;/span&gt;
&lt;a id="rest_code_a896af94b21b44f88f23bd703c4afcc6-2" name="rest_code_a896af94b21b44f88f23bd703c4afcc6-2" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-27/#rest_code_a896af94b21b44f88f23bd703c4afcc6-2"&gt;&lt;/a&gt;&lt;span class="kn"&gt;import&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nn"&gt;numpy&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;as&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nn"&gt;np&lt;/span&gt;
&lt;a id="rest_code_a896af94b21b44f88f23bd703c4afcc6-3" name="rest_code_a896af94b21b44f88f23bd703c4afcc6-3" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-27/#rest_code_a896af94b21b44f88f23bd703c4afcc6-3"&gt;&lt;/a&gt;
&lt;a id="rest_code_a896af94b21b44f88f23bd703c4afcc6-4" name="rest_code_a896af94b21b44f88f23bd703c4afcc6-4" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-27/#rest_code_a896af94b21b44f88f23bd703c4afcc6-4"&gt;&lt;/a&gt;
&lt;a id="rest_code_a896af94b21b44f88f23bd703c4afcc6-5" name="rest_code_a896af94b21b44f88f23bd703c4afcc6-5" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-27/#rest_code_a896af94b21b44f88f23bd703c4afcc6-5"&gt;&lt;/a&gt;&lt;span class="k"&gt;def&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nf"&gt;monte_carlo_int&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;fun&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;low&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;high&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;args&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;()):&lt;/span&gt;
&lt;a id="rest_code_a896af94b21b44f88f23bd703c4afcc6-6" name="rest_code_a896af94b21b44f88f23bd703c4afcc6-6" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-27/#rest_code_a896af94b21b44f88f23bd703c4afcc6-6"&gt;&lt;/a&gt;    &lt;span class="n"&gt;ndims&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;low&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_a896af94b21b44f88f23bd703c4afcc6-7" name="rest_code_a896af94b21b44f88f23bd703c4afcc6-7" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-27/#rest_code_a896af94b21b44f88f23bd703c4afcc6-7"&gt;&lt;/a&gt;    &lt;span class="n"&gt;pts&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;random&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;uniform&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;low&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;low&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;high&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;high&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;size&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;ndims&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_a896af94b21b44f88f23bd703c4afcc6-8" name="rest_code_a896af94b21b44f88f23bd703c4afcc6-8" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-27/#rest_code_a896af94b21b44f88f23bd703c4afcc6-8"&gt;&lt;/a&gt;    &lt;span class="n"&gt;V&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;prod&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;asarray&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;high&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;asarray&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;low&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_a896af94b21b44f88f23bd703c4afcc6-9" name="rest_code_a896af94b21b44f88f23bd703c4afcc6-9" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-27/#rest_code_a896af94b21b44f88f23bd703c4afcc6-9"&gt;&lt;/a&gt;    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;V&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sum&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;fun&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;pts&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;args&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;
&lt;a id="rest_code_a896af94b21b44f88f23bd703c4afcc6-10" name="rest_code_a896af94b21b44f88f23bd703c4afcc6-10" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-27/#rest_code_a896af94b21b44f88f23bd703c4afcc6-10"&gt;&lt;/a&gt;
&lt;a id="rest_code_a896af94b21b44f88f23bd703c4afcc6-11" name="rest_code_a896af94b21b44f88f23bd703c4afcc6-11" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-27/#rest_code_a896af94b21b44f88f23bd703c4afcc6-11"&gt;&lt;/a&gt;
&lt;a id="rest_code_a896af94b21b44f88f23bd703c4afcc6-12" name="rest_code_a896af94b21b44f88f23bd703c4afcc6-12" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-27/#rest_code_a896af94b21b44f88f23bd703c4afcc6-12"&gt;&lt;/a&gt;&lt;span class="k"&gt;def&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nf"&gt;circ&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;rad&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_a896af94b21b44f88f23bd703c4afcc6-13" name="rest_code_a896af94b21b44f88f23bd703c4afcc6-13" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-27/#rest_code_a896af94b21b44f88f23bd703c4afcc6-13"&gt;&lt;/a&gt;    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="mf"&gt;0.5&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sign&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[:,&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[:,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;rad&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_a896af94b21b44f88f23bd703c4afcc6-14" name="rest_code_a896af94b21b44f88f23bd703c4afcc6-14" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-27/#rest_code_a896af94b21b44f88f23bd703c4afcc6-14"&gt;&lt;/a&gt;
&lt;a id="rest_code_a896af94b21b44f88f23bd703c4afcc6-15" name="rest_code_a896af94b21b44f88f23bd703c4afcc6-15" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-27/#rest_code_a896af94b21b44f88f23bd703c4afcc6-15"&gt;&lt;/a&gt;
&lt;a id="rest_code_a896af94b21b44f88f23bd703c4afcc6-16" name="rest_code_a896af94b21b44f88f23bd703c4afcc6-16" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-27/#rest_code_a896af94b21b44f88f23bd703c4afcc6-16"&gt;&lt;/a&gt;&lt;span class="n"&gt;N&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;1000000&lt;/span&gt;
&lt;a id="rest_code_a896af94b21b44f88f23bd703c4afcc6-17" name="rest_code_a896af94b21b44f88f23bd703c4afcc6-17" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-27/#rest_code_a896af94b21b44f88f23bd703c4afcc6-17"&gt;&lt;/a&gt;&lt;span class="n"&gt;low&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_a896af94b21b44f88f23bd703c4afcc6-18" name="rest_code_a896af94b21b44f88f23bd703c4afcc6-18" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-27/#rest_code_a896af94b21b44f88f23bd703c4afcc6-18"&gt;&lt;/a&gt;&lt;span class="n"&gt;high&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_a896af94b21b44f88f23bd703c4afcc6-19" name="rest_code_a896af94b21b44f88f23bd703c4afcc6-19" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-27/#rest_code_a896af94b21b44f88f23bd703c4afcc6-19"&gt;&lt;/a&gt;&lt;span class="n"&gt;rad&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;
&lt;a id="rest_code_a896af94b21b44f88f23bd703c4afcc6-20" name="rest_code_a896af94b21b44f88f23bd703c4afcc6-20" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-27/#rest_code_a896af94b21b44f88f23bd703c4afcc6-20"&gt;&lt;/a&gt;&lt;span class="n"&gt;inte&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;monte_carlo_int&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;circ&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;low&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;high&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;args&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;rad&lt;/span&gt;&lt;span class="p"&gt;,))&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/section&gt;
&lt;section id="julia"&gt;
&lt;h3&gt;Julia&lt;/h3&gt;
&lt;div class="code"&gt;&lt;pre class="code julia"&gt;&lt;a id="rest_code_8262ff71e90441009f206b73baae3e87-1" name="rest_code_8262ff71e90441009f206b73baae3e87-1" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-27/#rest_code_8262ff71e90441009f206b73baae3e87-1"&gt;&lt;/a&gt;&lt;span class="k"&gt;using&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Distributions&lt;/span&gt;
&lt;a id="rest_code_8262ff71e90441009f206b73baae3e87-2" name="rest_code_8262ff71e90441009f206b73baae3e87-2" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-27/#rest_code_8262ff71e90441009f206b73baae3e87-2"&gt;&lt;/a&gt;
&lt;a id="rest_code_8262ff71e90441009f206b73baae3e87-3" name="rest_code_8262ff71e90441009f206b73baae3e87-3" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-27/#rest_code_8262ff71e90441009f206b73baae3e87-3"&gt;&lt;/a&gt;
&lt;a id="rest_code_8262ff71e90441009f206b73baae3e87-4" name="rest_code_8262ff71e90441009f206b73baae3e87-4" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-27/#rest_code_8262ff71e90441009f206b73baae3e87-4"&gt;&lt;/a&gt;&lt;span class="k"&gt;function&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;monte_carlo_int&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;fun&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;low&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;high&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;args&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt;
&lt;a id="rest_code_8262ff71e90441009f206b73baae3e87-5" name="rest_code_8262ff71e90441009f206b73baae3e87-5" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-27/#rest_code_8262ff71e90441009f206b73baae3e87-5"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;ndims&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;length&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;low&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_8262ff71e90441009f206b73baae3e87-6" name="rest_code_8262ff71e90441009f206b73baae3e87-6" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-27/#rest_code_8262ff71e90441009f206b73baae3e87-6"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;pts&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;rand&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Uniform&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ndims&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_8262ff71e90441009f206b73baae3e87-7" name="rest_code_8262ff71e90441009f206b73baae3e87-7" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-27/#rest_code_8262ff71e90441009f206b73baae3e87-7"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;for&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;cont&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="n"&gt;ndims&lt;/span&gt;
&lt;a id="rest_code_8262ff71e90441009f206b73baae3e87-8" name="rest_code_8262ff71e90441009f206b73baae3e87-8" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-27/#rest_code_8262ff71e90441009f206b73baae3e87-8"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;pts&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;cont&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;pts&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;cont&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;high&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;cont&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;low&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;cont&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;low&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;cont&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_8262ff71e90441009f206b73baae3e87-9" name="rest_code_8262ff71e90441009f206b73baae3e87-9" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-27/#rest_code_8262ff71e90441009f206b73baae3e87-9"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;end&lt;/span&gt;
&lt;a id="rest_code_8262ff71e90441009f206b73baae3e87-10" name="rest_code_8262ff71e90441009f206b73baae3e87-10" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-27/#rest_code_8262ff71e90441009f206b73baae3e87-10"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;V&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;prod&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;high&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;low&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_8262ff71e90441009f206b73baae3e87-11" name="rest_code_8262ff71e90441009f206b73baae3e87-11" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-27/#rest_code_8262ff71e90441009f206b73baae3e87-11"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;return&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;V&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;sum&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;fun&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;pts&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;args&lt;/span&gt;&lt;span class="o"&gt;...&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;
&lt;a id="rest_code_8262ff71e90441009f206b73baae3e87-12" name="rest_code_8262ff71e90441009f206b73baae3e87-12" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-27/#rest_code_8262ff71e90441009f206b73baae3e87-12"&gt;&lt;/a&gt;&lt;span class="k"&gt;end&lt;/span&gt;
&lt;a id="rest_code_8262ff71e90441009f206b73baae3e87-13" name="rest_code_8262ff71e90441009f206b73baae3e87-13" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-27/#rest_code_8262ff71e90441009f206b73baae3e87-13"&gt;&lt;/a&gt;
&lt;a id="rest_code_8262ff71e90441009f206b73baae3e87-14" name="rest_code_8262ff71e90441009f206b73baae3e87-14" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-27/#rest_code_8262ff71e90441009f206b73baae3e87-14"&gt;&lt;/a&gt;
&lt;a id="rest_code_8262ff71e90441009f206b73baae3e87-15" name="rest_code_8262ff71e90441009f206b73baae3e87-15" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-27/#rest_code_8262ff71e90441009f206b73baae3e87-15"&gt;&lt;/a&gt;&lt;span class="k"&gt;function&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;circ&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;rad&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_8262ff71e90441009f206b73baae3e87-16" name="rest_code_8262ff71e90441009f206b73baae3e87-16" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-27/#rest_code_8262ff71e90441009f206b73baae3e87-16"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;return&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;0.5&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;sign&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.^&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.^&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;rad&lt;/span&gt;&lt;span class="o"&gt;^&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_8262ff71e90441009f206b73baae3e87-17" name="rest_code_8262ff71e90441009f206b73baae3e87-17" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-27/#rest_code_8262ff71e90441009f206b73baae3e87-17"&gt;&lt;/a&gt;&lt;span class="k"&gt;end&lt;/span&gt;
&lt;a id="rest_code_8262ff71e90441009f206b73baae3e87-18" name="rest_code_8262ff71e90441009f206b73baae3e87-18" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-27/#rest_code_8262ff71e90441009f206b73baae3e87-18"&gt;&lt;/a&gt;
&lt;a id="rest_code_8262ff71e90441009f206b73baae3e87-19" name="rest_code_8262ff71e90441009f206b73baae3e87-19" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-27/#rest_code_8262ff71e90441009f206b73baae3e87-19"&gt;&lt;/a&gt;
&lt;a id="rest_code_8262ff71e90441009f206b73baae3e87-20" name="rest_code_8262ff71e90441009f206b73baae3e87-20" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-27/#rest_code_8262ff71e90441009f206b73baae3e87-20"&gt;&lt;/a&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1000000&lt;/span&gt;
&lt;a id="rest_code_8262ff71e90441009f206b73baae3e87-21" name="rest_code_8262ff71e90441009f206b73baae3e87-21" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-27/#rest_code_8262ff71e90441009f206b73baae3e87-21"&gt;&lt;/a&gt;&lt;span class="n"&gt;low&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_8262ff71e90441009f206b73baae3e87-22" name="rest_code_8262ff71e90441009f206b73baae3e87-22" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-27/#rest_code_8262ff71e90441009f206b73baae3e87-22"&gt;&lt;/a&gt;&lt;span class="n"&gt;high&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_8262ff71e90441009f206b73baae3e87-23" name="rest_code_8262ff71e90441009f206b73baae3e87-23" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-27/#rest_code_8262ff71e90441009f206b73baae3e87-23"&gt;&lt;/a&gt;&lt;span class="n"&gt;rad&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;
&lt;a id="rest_code_8262ff71e90441009f206b73baae3e87-24" name="rest_code_8262ff71e90441009f206b73baae3e87-24" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-27/#rest_code_8262ff71e90441009f206b73baae3e87-24"&gt;&lt;/a&gt;&lt;span class="n"&gt;inte&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;monte_carlo_int&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;circ&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;low&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;high&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;args&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;rad&lt;/span&gt;&lt;span class="p"&gt;,))&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;One of the most common examples is the computation of &lt;span class="math"&gt;\(\pi\)&lt;/span&gt;, this
is illustrated in the following animation.&lt;/p&gt;
&lt;img alt="Pi approximation using Monte Carlo." class="align-center" src="https://upload.wikimedia.org/wikipedia/commons/8/84/Pi_30K.gif" style="width: 500px;"&gt;
&lt;/section&gt;
&lt;section id="comparison-python-julia"&gt;
&lt;h3&gt;Comparison Python/Julia&lt;/h3&gt;
&lt;p&gt;Regarding number of lines we have: 20 in Python and 24 in Julia. The comparison
in execution time is done with &lt;code class="docutils literal"&gt;%timeit&lt;/code&gt; magic command in IPython and
&lt;code class="docutils literal"&gt;@benchmark&lt;/code&gt; in Julia.&lt;/p&gt;
&lt;p&gt;For Python:&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code IPython"&gt;&lt;a id="rest_code_c2c3c91ac3bf4f4783a84211a3fdd9cb-1" name="rest_code_c2c3c91ac3bf4f4783a84211a3fdd9cb-1" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-27/#rest_code_c2c3c91ac3bf4f4783a84211a3fdd9cb-1"&gt;&lt;/a&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="k"&gt;timeit&lt;/span&gt; monte_carlo_int(circ, N, low, high, args=(rad,))
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;with result&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code text"&gt;&lt;a id="rest_code_cabf63935124489183bd89d5e5d27d0c-1" name="rest_code_cabf63935124489183bd89d5e5d27d0c-1" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-27/#rest_code_cabf63935124489183bd89d5e5d27d0c-1"&gt;&lt;/a&gt;10 loops, best of 3: 53.2 ms per loop
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;For Julia:&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code julia"&gt;&lt;a id="rest_code_c6ceb8c2c12340459862d8ec63fedf16-1" name="rest_code_c6ceb8c2c12340459862d8ec63fedf16-1" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-27/#rest_code_c6ceb8c2c12340459862d8ec63fedf16-1"&gt;&lt;/a&gt;&lt;span class="nd"&gt;@benchmark&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;monte_carlo_int&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;circ&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;low&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;high&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;args&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;rad&lt;/span&gt;&lt;span class="p"&gt;,))&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;with result&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code julia"&gt;&lt;a id="rest_code_702e499125f84cdaae9c36f6a74fd592-1" name="rest_code_702e499125f84cdaae9c36f6a74fd592-1" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-27/#rest_code_702e499125f84cdaae9c36f6a74fd592-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;BenchmarkTools&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Trial&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
&lt;a id="rest_code_702e499125f84cdaae9c36f6a74fd592-2" name="rest_code_702e499125f84cdaae9c36f6a74fd592-2" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-27/#rest_code_702e499125f84cdaae9c36f6a74fd592-2"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;memory&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;estimate&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="mf"&gt;129.70&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;MiB&lt;/span&gt;
&lt;a id="rest_code_702e499125f84cdaae9c36f6a74fd592-3" name="rest_code_702e499125f84cdaae9c36f6a74fd592-3" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-27/#rest_code_702e499125f84cdaae9c36f6a74fd592-3"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;allocs&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;estimate&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="mi"&gt;46&lt;/span&gt;
&lt;a id="rest_code_702e499125f84cdaae9c36f6a74fd592-4" name="rest_code_702e499125f84cdaae9c36f6a74fd592-4" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-27/#rest_code_702e499125f84cdaae9c36f6a74fd592-4"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="o"&gt;--------------&lt;/span&gt;
&lt;a id="rest_code_702e499125f84cdaae9c36f6a74fd592-5" name="rest_code_702e499125f84cdaae9c36f6a74fd592-5" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-27/#rest_code_702e499125f84cdaae9c36f6a74fd592-5"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;minimum&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;     &lt;/span&gt;&lt;span class="mf"&gt;60.131&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ms&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;5.15&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;GC&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_702e499125f84cdaae9c36f6a74fd592-6" name="rest_code_702e499125f84cdaae9c36f6a74fd592-6" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-27/#rest_code_702e499125f84cdaae9c36f6a74fd592-6"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;median&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="mf"&gt;164.018&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ms&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;55.64&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;GC&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_702e499125f84cdaae9c36f6a74fd592-7" name="rest_code_702e499125f84cdaae9c36f6a74fd592-7" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-27/#rest_code_702e499125f84cdaae9c36f6a74fd592-7"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;mean&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="mf"&gt;204.366&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ms&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;49.50&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;GC&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_702e499125f84cdaae9c36f6a74fd592-8" name="rest_code_702e499125f84cdaae9c36f6a74fd592-8" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-27/#rest_code_702e499125f84cdaae9c36f6a74fd592-8"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;maximum&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;     &lt;/span&gt;&lt;span class="mf"&gt;357.749&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ms&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;64.04&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;GC&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_702e499125f84cdaae9c36f6a74fd592-9" name="rest_code_702e499125f84cdaae9c36f6a74fd592-9" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-27/#rest_code_702e499125f84cdaae9c36f6a74fd592-9"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="o"&gt;--------------&lt;/span&gt;
&lt;a id="rest_code_702e499125f84cdaae9c36f6a74fd592-10" name="rest_code_702e499125f84cdaae9c36f6a74fd592-10" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-27/#rest_code_702e499125f84cdaae9c36f6a74fd592-10"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;samples&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;          &lt;/span&gt;&lt;span class="mi"&gt;25&lt;/span&gt;
&lt;a id="rest_code_702e499125f84cdaae9c36f6a74fd592-11" name="rest_code_702e499125f84cdaae9c36f6a74fd592-11" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-27/#rest_code_702e499125f84cdaae9c36f6a74fd592-11"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;evals&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;sample&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;     &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;In this case, we can say that the Python code is roughly 3 times faster than
Julia code.&lt;/p&gt;
&lt;/section&gt;
&lt;/section&gt;</description><category>julia</category><category>monte carlo</category><category>numerical methods</category><category>python</category><category>scientific computing</category><guid>https://nicoguaro.github.io/posts/numerical_challenge/numerical-27/</guid><pubDate>Sat, 28 Oct 2017 02:27:06 GMT</pubDate></item></channel></rss>