<!DOCTYPE html>
<html prefix="" lang="en">
<head>
<meta charset="utf-8">
<meta name="description" content="Personal blog and website">
<meta name="viewport" content="width=device-width">
<title>Nicolás' blog (old posts, page 5) | Nicolás' blog</title>
<link href="assets/css/all.css" rel="stylesheet" type="text/css">
<link rel="stylesheet" href="//fonts.googleapis.com/css?family=PT+Serif:400,400italic,700%7CPT+Sans:400">
<link rel="alternate" type="application/rss+xml" title="RSS (en)" href="rss.xml">
<link rel="alternate" type="application/rss+xml" title="RSS (es)" href="es/rss.xml">
<link rel="canonical" href="https://nicoguaro.github.io/index-5.html">
<link rel="prev" href="." type="text/html">
<link rel="next" href="index-4.html" type="text/html">
<!--[if lt IE 9]><script src="assets/js/html5.js"></script><![endif]-->
</head>
<body>
    <a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>
    <!-- Target for toggling the sidebar `.sidebar-checkbox` is for regular
            styles, `#sidebar-checkbox` for behavior. -->
    <input type="checkbox" class="sidebar-checkbox" id="sidebar-checkbox"><!-- Toggleable sidebar --><div class="sidebar" id="sidebar">
        <div class="sidebar-item">
            <p>A reserved <a href="https://getnikola.com" target="_blank">Nikola</a> theme that places the utmost gravity on content with a hidden drawer. Made by <a href="https://twitter.com/mdo" target="_blank">@mdo</a> for Jekyll,
            ported to Nikola by <a href="https://twitter.com/ralsina" target="_blank">@ralsina</a>.</p>
        </div>
        
    <nav id="menu" role="navigation" class="sidebar-nav"><a class="sidebar-nav-item" href="pages/about/">About</a>
        <a class="sidebar-nav-item" href="index.html">Blog</a>
        <a class="sidebar-nav-item" href="pages/preprints-archive/">Preprints</a>
        <a class="sidebar-nav-item" href="pages/links/">Links</a>
        <a class="sidebar-nav-item" href="archive.html">Archive</a>
        <a class="sidebar-nav-item" href="categories/">Tags</a>
        <a class="sidebar-nav-item" href="rss.xml">RSS feed</a>
    
    
    </nav>
</div>

    <!-- Wrap is the content to shift when toggling the sidebar. We wrap the
         content to avoid any CSS collisions with our real content. -->
    <div class="wrap">
      <div class="masthead">
        <div class="container">
          
    <h3 id="brand" class="masthead-title">
      <a href="https://nicoguaro.github.io/" title="Nicolás' blog" rel="home">Nicolás' blog</a>
    </h3>

        </div>
      </div>

      <div class="container content" id="content">
        

<div class="posts">
    <article class="post h-entry post-text"><header><h1 class="post-title p-name"><a href="posts/infinite_fdm/" class="u-url">Finite differences in infinite domains</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn">Nicolás Guarín-Zapata</span></p>
            <p class="dateline"><a href="posts/infinite_fdm/" rel="bookmark"><time class="post-date published dt-published" datetime="2018-05-17T15:57:00-05:00" title="2018-05-17 15:57">2018-05-17 15:57</time></a></p>
                <p class="commentline">
        
    <a href="posts/infinite_fdm/#disqus_thread" data-disqus-identifier="cache/posts/infinite_fdm.html">Comments</a>


        </p>
</div>
    </header><div class="e-content entry-content">
    <div class="section" id="finite-differences-in-infinite-domains">
<h2>Finite differences in infinite domains</h2>
<p>Because of my friend, <a class="reference external" href="http://cosmoscalibur.com/">Edward Villegas</a>, I
ended up thinking about using a change of variables when solving an
eigenvalue problem with finite difference.</p>
<div class="section" id="the-problem">
<h3>The problem</h3>
<p>Let's say that we want to solve a differential equation over an infinite
domain. A common case is to solve the <a class="reference external" href="https://en.wikipedia.org/wiki/Schr%C3%B6dinger_equation#Time-independent_equation">Time independent Schrödinger
equation</a>
subject to a potential <span class="math">\(V(x)\)</span>. For example</p>
<div class="math">
\begin{equation*}
-\frac{1}{2}\frac{\mathrm{d}^2}{\mathrm{d}x^2}\psi(x) + V(x) \psi(x) = E\psi(x),\quad \forall x\in (-\infty, \infty),
\end{equation*}
</div>
<p>where we want to find the pairs of eigenvalues/eigenfunctions
<span class="math">\((E_n, \psi_n(x))\)</span>.</p>
<p>What I normally do when using <a class="reference external" href="https://en.wikipedia.org/wiki/Finite_difference_method">finite
differences</a>
is to regularly divide the domain. Where I take a <em>large enough</em> domain,
so the solution have decayed close to zero. What I do in this post is to
make a change of variable to render the interval finite first and then
regularly divide the transformed domain in finite intervals.</p>
</div>
<div class="section" id="my-usual-approach">
<h3>My usual approach</h3>
<p>My usual approach is to approach the second derivative with a <a class="reference external" href="https://en.wikipedia.org/wiki/Finite_difference_coefficient">centered
difference</a>
for the point <span class="math">\(x_i\)</span> like this</p>
<div class="math">
\begin{equation*}
\frac{\mathrm{d}^2 f(x)}{\mathrm{d}x^2} \approx \frac{f(x + \Delta x) - 2 f(x_i) + f(x - \Delta x)}{\Delta x^2}\, ,
\end{equation*}
</div>
<p>with <span class="math">\(\Delta x\)</span> the separation between points.</p>
<p>We can solve this in Python with the following snippet:</p>
<pre class="code ipython3"><a name="rest_code_c4d19a06e84645a29ca20e8df3ac6ac0-1"></a><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<a name="rest_code_c4d19a06e84645a29ca20e8df3ac6ac0-2"></a><span class="kn">from</span> <span class="nn">scipy.sparse</span> <span class="kn">import</span> <span class="n">diags</span>
<a name="rest_code_c4d19a06e84645a29ca20e8df3ac6ac0-3"></a><span class="kn">from</span> <span class="nn">scipy.sparse.linalg</span> <span class="kn">import</span> <span class="n">eigs</span>
<a name="rest_code_c4d19a06e84645a29ca20e8df3ac6ac0-4"></a>
<a name="rest_code_c4d19a06e84645a29ca20e8df3ac6ac0-5"></a>
<a name="rest_code_c4d19a06e84645a29ca20e8df3ac6ac0-6"></a><span class="k">def</span> <span class="nf">regular_FD</span><span class="p">(</span><span class="n">pot</span><span class="p">,</span> <span class="n">npts</span><span class="o">=</span><span class="mi">101</span><span class="p">,</span> <span class="n">x_max</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">nvals</span><span class="o">=</span><span class="mi">6</span><span class="p">):</span>
<a name="rest_code_c4d19a06e84645a29ca20e8df3ac6ac0-7"></a>    <span class="sd">"""</span>
<a name="rest_code_c4d19a06e84645a29ca20e8df3ac6ac0-8"></a><span class="sd">    Find eigenvalues/eigenfunctions for Schrodinger</span>
<a name="rest_code_c4d19a06e84645a29ca20e8df3ac6ac0-9"></a><span class="sd">    equation for the given potential `pot` using</span>
<a name="rest_code_c4d19a06e84645a29ca20e8df3ac6ac0-10"></a><span class="sd">    finite differences</span>
<a name="rest_code_c4d19a06e84645a29ca20e8df3ac6ac0-11"></a><span class="sd">    """</span>
<a name="rest_code_c4d19a06e84645a29ca20e8df3ac6ac0-12"></a>    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="n">x_max</span><span class="p">,</span> <span class="n">x_max</span><span class="p">,</span> <span class="n">npts</span><span class="p">)</span>
<a name="rest_code_c4d19a06e84645a29ca20e8df3ac6ac0-13"></a>    <span class="n">dx</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<a name="rest_code_c4d19a06e84645a29ca20e8df3ac6ac0-14"></a>    <span class="n">D2</span> <span class="o">=</span> <span class="n">diags</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="n">npts</span><span class="p">,</span> <span class="n">npts</span><span class="p">))</span><span class="o">/</span><span class="n">dx</span><span class="o">**</span><span class="mi">2</span>
<a name="rest_code_c4d19a06e84645a29ca20e8df3ac6ac0-15"></a>    <span class="n">V</span> <span class="o">=</span> <span class="n">diags</span><span class="p">(</span><span class="n">pot</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<a name="rest_code_c4d19a06e84645a29ca20e8df3ac6ac0-16"></a>    <span class="n">H</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.5</span><span class="o">*</span><span class="n">D2</span> <span class="o">+</span> <span class="n">V</span>
<a name="rest_code_c4d19a06e84645a29ca20e8df3ac6ac0-17"></a>    <span class="n">vals</span><span class="p">,</span> <span class="n">vecs</span> <span class="o">=</span> <span class="n">eigs</span><span class="p">(</span><span class="n">H</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="n">nvals</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s2">"SM"</span><span class="p">)</span>
<a name="rest_code_c4d19a06e84645a29ca20e8df3ac6ac0-18"></a>    <span class="k">return</span> <span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">vals</span><span class="p">),</span> <span class="n">vecs</span>
</pre>
<p>Let's setup the plotting details.</p>
<pre class="code ipython3"><a name="rest_code_64157fc468494d8d913e433e67395407-1"></a><span class="c1"># Jupyter notebook plotting setup &amp; imports</span>
<a name="rest_code_64157fc468494d8d913e433e67395407-2"></a><span class="o">%</span><span class="k">matplotlib</span> notebook
<a name="rest_code_64157fc468494d8d913e433e67395407-3"></a><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<a name="rest_code_64157fc468494d8d913e433e67395407-4"></a>
<a name="rest_code_64157fc468494d8d913e433e67395407-5"></a><span class="n">gray</span> <span class="o">=</span> <span class="s1">'#757575'</span>
<a name="rest_code_64157fc468494d8d913e433e67395407-6"></a><span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s2">"figure.figsize"</span><span class="p">]</span> <span class="o">=</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">4</span>
<a name="rest_code_64157fc468494d8d913e433e67395407-7"></a><span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s2">"mathtext.fontset"</span><span class="p">]</span> <span class="o">=</span> <span class="s2">"cm"</span>
<a name="rest_code_64157fc468494d8d913e433e67395407-8"></a><span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s2">"text.color"</span><span class="p">]</span> <span class="o">=</span> <span class="n">gray</span>
<a name="rest_code_64157fc468494d8d913e433e67395407-9"></a><span class="n">fontsize</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s2">"font.size"</span><span class="p">]</span> <span class="o">=</span> <span class="mi">12</span>
<a name="rest_code_64157fc468494d8d913e433e67395407-10"></a><span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s2">"xtick.color"</span><span class="p">]</span> <span class="o">=</span> <span class="n">gray</span>
<a name="rest_code_64157fc468494d8d913e433e67395407-11"></a><span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s2">"ytick.color"</span><span class="p">]</span> <span class="o">=</span> <span class="n">gray</span>
<a name="rest_code_64157fc468494d8d913e433e67395407-12"></a><span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s2">"axes.labelcolor"</span><span class="p">]</span> <span class="o">=</span> <span class="n">gray</span>
<a name="rest_code_64157fc468494d8d913e433e67395407-13"></a><span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s2">"axes.edgecolor"</span><span class="p">]</span> <span class="o">=</span> <span class="n">gray</span>
<a name="rest_code_64157fc468494d8d913e433e67395407-14"></a><span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s2">"axes.spines.right"</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
<a name="rest_code_64157fc468494d8d913e433e67395407-15"></a><span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s2">"axes.spines.top"</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
</pre>
<p>Let's consider the <a class="reference external" href="https://en.wikipedia.org/wiki/Quantum_harmonic_oscillator">Quantum harmonic
oscillator</a>,
that has as eigenvalues</p>
<div class="math">
\begin{equation*}
E_n = n + \frac{1}{2},\quad \forall n = 0, 1, 2 \cdots
\end{equation*}
</div>
<p>Using the finite difference method we have values that are really close
to the analytic ones.</p>
<pre class="code ipython3"><a name="rest_code_50307c95910742a6924f9b5c3d6f99ab-1"></a><span class="n">x</span><span class="p">,</span> <span class="n">vals</span><span class="p">,</span> <span class="n">vecs</span> <span class="o">=</span> <span class="n">regular_FD</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="n">npts</span><span class="o">=</span><span class="mi">201</span><span class="p">)</span>
<a name="rest_code_50307c95910742a6924f9b5c3d6f99ab-2"></a><span class="n">vals</span>
</pre>
<p>with output</p>
<pre class="literal-block">array([0.4996873 , 1.49843574, 2.49593063, 3.49216962, 4.48715031,
       5.4808703 ])</pre>
<p>With the analytic ones</p>
<pre class="code text"><a name="rest_code_edb09bea982346bc90f507eb50595160-1"></a>[0.5, 1.5, 2.5, 3.5, 4.5, 5.5])
</pre>
<p>If we plot these two, we obtain the following.</p>
<pre class="code ipython3"><a name="rest_code_412a7575852f42968345972493ef0f19-1"></a><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<a name="rest_code_412a7575852f42968345972493ef0f19-2"></a><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">anal_vals</span><span class="p">)</span>
<a name="rest_code_412a7575852f42968345972493ef0f19-3"></a><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">vals</span><span class="p">,</span> <span class="s2">"o"</span><span class="p">)</span>
<a name="rest_code_412a7575852f42968345972493ef0f19-4"></a><span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">"$n$"</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<a name="rest_code_412a7575852f42968345972493ef0f19-5"></a><span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">"$E_n$"</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<a name="rest_code_412a7575852f42968345972493ef0f19-6"></a><span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s2">"Analytic"</span><span class="p">,</span> <span class="s2">"Finite differences"</span><span class="p">])</span>
<a name="rest_code_412a7575852f42968345972493ef0f19-7"></a><span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">();</span>
</pre>
<img alt="Eigenvalues for the regular finite difference" class="align-center" src="images/infinite_fdm/eigvals_regular.svg" style="width: 600px;"><p>Let's see the eigenfunctions.</p>
<pre class="code ipython3"><a name="rest_code_c156b37a1ca34c94b777a513e9275410-1"></a><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<a name="rest_code_c156b37a1ca34c94b777a513e9275410-2"></a><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">vecs</span><span class="p">[:,</span> <span class="p">:</span><span class="mi">3</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<a name="rest_code_c156b37a1ca34c94b777a513e9275410-3"></a><span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
<a name="rest_code_c156b37a1ca34c94b777a513e9275410-4"></a><span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">"$x$"</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<a name="rest_code_c156b37a1ca34c94b777a513e9275410-5"></a><span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">"$|\psi_n(x)|^2$"</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<a name="rest_code_c156b37a1ca34c94b777a513e9275410-6"></a><span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">([])</span>
<a name="rest_code_c156b37a1ca34c94b777a513e9275410-7"></a><span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">();</span>
</pre>
<img alt="Eigenfunctions for the regular finite difference" class="align-center" src="images/infinite_fdm/eigvecs_regular.svg" style="width: 600px;"><p>One inconvenient with this method is the redundant sampling towards the
extreme of the intervals, while under sample the middle part.</p>
</div>
<div class="section" id="changing-the-domain">
<h3>Changing the domain</h3>
<p>Let's now consider the case where we transform the infinite domain to a
finite one with a change of variable</p>
<div class="math">
\begin{equation*}
\xi = \xi(x)
\end{equation*}
</div>
<p>with <span class="math">\(\xi \in (-1, 1)\)</span>. Two options for this transformation are:</p>
<ul class="simple">
<li><p><span class="math">\(\xi = \tanh x\)</span>; and</p></li>
<li><p><span class="math">\(\xi = \frac{2}{\pi} \arctan x\)</span>.</p></li>
</ul>
<p>Making this change of variable the equation we need to solve the
following equation</p>
<div class="math">
\begin{equation*}
-\frac{1}{2}\left(\frac{\mathrm{d}\xi}{\mathrm{d}x}\right)^2\frac{\mathrm{d}^2}{\mathrm{d}\xi^2}\psi(\xi) - \frac{1}{2}\frac{\mathrm{d}^2\xi}{\mathrm{d}x^2}\frac{\mathrm{d}}{\mathrm{d}\xi}\psi(\xi) + V(\xi) \psi(\xi) = E\psi(\xi)
\end{equation*}
</div>
<p>The following snippet solve the eigenproblem for the mapped domain:</p>
<pre class="code ipython3"><a name="rest_code_468e67bf919242c089d796d8896c4f82-1"></a><span class="k">def</span> <span class="nf">mapped_FD</span><span class="p">(</span><span class="n">pot</span><span class="p">,</span> <span class="n">fun</span><span class="p">,</span> <span class="n">dxdxi</span><span class="p">,</span> <span class="n">dxdxi2</span><span class="p">,</span> <span class="n">npts</span><span class="o">=</span><span class="mi">101</span><span class="p">,</span> <span class="n">nvals</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">xi_tol</span><span class="o">=</span><span class="mf">1e-6</span><span class="p">):</span>
<a name="rest_code_468e67bf919242c089d796d8896c4f82-2"></a>    <span class="sd">"""</span>
<a name="rest_code_468e67bf919242c089d796d8896c4f82-3"></a><span class="sd">    Find eigenvalues/eigenfunctions for Schrodinger</span>
<a name="rest_code_468e67bf919242c089d796d8896c4f82-4"></a><span class="sd">    equation for the given potential `pot` using</span>
<a name="rest_code_468e67bf919242c089d796d8896c4f82-5"></a><span class="sd">    finite differences over a mapped domain on (-1, 1)</span>
<a name="rest_code_468e67bf919242c089d796d8896c4f82-6"></a><span class="sd">    """</span>
<a name="rest_code_468e67bf919242c089d796d8896c4f82-7"></a>    <span class="n">xi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span> <span class="o">+</span> <span class="n">xi_tol</span><span class="p">,</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">xi_tol</span><span class="p">,</span> <span class="n">npts</span><span class="p">)</span>
<a name="rest_code_468e67bf919242c089d796d8896c4f82-8"></a>    <span class="n">x</span> <span class="o">=</span> <span class="n">fun</span><span class="p">(</span><span class="n">xi</span><span class="p">)</span>
<a name="rest_code_468e67bf919242c089d796d8896c4f82-9"></a>    <span class="n">dxi</span> <span class="o">=</span> <span class="n">xi</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">xi</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<a name="rest_code_468e67bf919242c089d796d8896c4f82-10"></a>    <span class="n">D2</span> <span class="o">=</span> <span class="n">diags</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="n">npts</span><span class="p">,</span> <span class="n">npts</span><span class="p">))</span><span class="o">/</span><span class="n">dxi</span><span class="o">**</span><span class="mi">2</span>
<a name="rest_code_468e67bf919242c089d796d8896c4f82-11"></a>    <span class="n">D1</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">diags</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="n">npts</span><span class="p">,</span> <span class="n">npts</span><span class="p">))</span><span class="o">/</span><span class="n">dxi</span>
<a name="rest_code_468e67bf919242c089d796d8896c4f82-12"></a>    <span class="n">V</span> <span class="o">=</span> <span class="n">diags</span><span class="p">(</span><span class="n">pot</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<a name="rest_code_468e67bf919242c089d796d8896c4f82-13"></a>    <span class="n">fac1</span> <span class="o">=</span> <span class="n">diags</span><span class="p">(</span><span class="n">dxdxi</span><span class="p">(</span><span class="n">xi</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<a name="rest_code_468e67bf919242c089d796d8896c4f82-14"></a>    <span class="n">fac2</span> <span class="o">=</span> <span class="n">diags</span><span class="p">(</span><span class="n">dxdxi2</span><span class="p">(</span><span class="n">xi</span><span class="p">))</span>
<a name="rest_code_468e67bf919242c089d796d8896c4f82-15"></a>    <span class="n">H</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.5</span><span class="o">*</span><span class="n">fac1</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">D2</span><span class="p">)</span> <span class="o">-</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">fac2</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">D1</span><span class="p">)</span> <span class="o">+</span> <span class="n">V</span>
<a name="rest_code_468e67bf919242c089d796d8896c4f82-16"></a>    <span class="n">vals</span><span class="p">,</span> <span class="n">vecs</span> <span class="o">=</span> <span class="n">eigs</span><span class="p">(</span><span class="n">H</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="n">nvals</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s2">"SM"</span><span class="p">)</span>
<a name="rest_code_468e67bf919242c089d796d8896c4f82-17"></a>    <span class="k">return</span> <span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">vals</span><span class="p">),</span> <span class="n">vecs</span>
</pre>
<div class="section" id="first-transformation-xi-tanh-x">
<h4>First transformation: <span class="math">\(\xi = \tanh(x)\)</span>
</h4>
<p>Let's consider first the transformation</p>
<div class="math">
\begin{equation*}
\xi = \tanh(x)\, .
\end{equation*}
</div>
<p>In this case</p>
<div class="math">
\begin{equation*}
\frac{\mathrm{d}\xi}{\mathrm{d}x} = 1 - \tanh^2(x) = 1 - \xi^2\, ,
\end{equation*}
</div>
<p>and</p>
<div class="math">
\begin{equation*}
\frac{\mathrm{d}^2\xi}{\mathrm{d}x^2} = -2\tanh(x)[1 - \tanh^2(x)] = -2\xi[1 - \xi^2]\, .
\end{equation*}
</div>
<p>We need to define the functions</p>
<pre class="code ipython3"><a name="rest_code_57bc66c1050344d18d5968c75caf7f0f-1"></a><span class="n">pot</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span>
<a name="rest_code_57bc66c1050344d18d5968c75caf7f0f-2"></a><span class="n">fun</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">xi</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">arctanh</span><span class="p">(</span><span class="n">xi</span><span class="p">)</span>
<a name="rest_code_57bc66c1050344d18d5968c75caf7f0f-3"></a><span class="n">dxdxi</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">xi</span><span class="p">:</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">xi</span><span class="o">**</span><span class="mi">2</span>
<a name="rest_code_57bc66c1050344d18d5968c75caf7f0f-4"></a><span class="n">dxdxi2</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">xi</span><span class="p">:</span> <span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">xi</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">xi</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
</pre>
<p>and run the function</p>
<pre class="code ipython3"><a name="rest_code_e3c98d7eddcf49848469426c02e17750-1"></a><span class="n">x</span><span class="p">,</span> <span class="n">vals</span><span class="p">,</span> <span class="n">vecs</span> <span class="o">=</span> <span class="n">mapped_FD</span><span class="p">(</span><span class="n">pot</span><span class="p">,</span> <span class="n">fun</span><span class="p">,</span> <span class="n">dxdxi</span><span class="p">,</span> <span class="n">dxdxi2</span><span class="p">,</span> <span class="n">npts</span><span class="o">=</span><span class="mi">201</span><span class="p">)</span>
<a name="rest_code_e3c98d7eddcf49848469426c02e17750-2"></a><span class="n">vals</span>
</pre>
<p>And we obtain the following</p>
<pre class="literal-block">array([0.49989989, 1.4984226 , 2.49003572, 3.46934257, 4.46935021,
       5.59552989])</pre>
<p>If we compare with the analytic values we get the following.</p>
<pre class="code ipython3"><a name="rest_code_0c670aa2dfd64df49f5d6f5cf34c3cbc-1"></a><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<a name="rest_code_0c670aa2dfd64df49f5d6f5cf34c3cbc-2"></a><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">anal_vals</span><span class="p">)</span>
<a name="rest_code_0c670aa2dfd64df49f5d6f5cf34c3cbc-3"></a><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">vals</span><span class="p">,</span> <span class="s2">"o"</span><span class="p">)</span>
<a name="rest_code_0c670aa2dfd64df49f5d6f5cf34c3cbc-4"></a><span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s2">"Analytic"</span><span class="p">,</span> <span class="s2">"Finite differences"</span><span class="p">])</span>
<a name="rest_code_0c670aa2dfd64df49f5d6f5cf34c3cbc-5"></a><span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">"$n$"</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<a name="rest_code_0c670aa2dfd64df49f5d6f5cf34c3cbc-6"></a><span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">"$E_n$"</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<a name="rest_code_0c670aa2dfd64df49f5d6f5cf34c3cbc-7"></a><span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">();</span>
</pre>
<img alt="Eigenvalues for the first transformation" class="align-center" src="images/infinite_fdm/eigvals_tanh.svg" style="width: 600px;"><p>And the following are the eigenfunctions.</p>
<pre class="code ipython3"><a name="rest_code_026b444419ea4fe28b3a7a727f7a8994-1"></a><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<a name="rest_code_026b444419ea4fe28b3a7a727f7a8994-2"></a><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">vecs</span><span class="p">[:,</span> <span class="p">:</span><span class="mi">3</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<a name="rest_code_026b444419ea4fe28b3a7a727f7a8994-3"></a><span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
<a name="rest_code_026b444419ea4fe28b3a7a727f7a8994-4"></a><span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">"$x$"</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<a name="rest_code_026b444419ea4fe28b3a7a727f7a8994-5"></a><span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">"$|\psi_n(x)|^2$"</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<a name="rest_code_026b444419ea4fe28b3a7a727f7a8994-6"></a><span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">([])</span>
<a name="rest_code_026b444419ea4fe28b3a7a727f7a8994-7"></a><span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">();</span>
</pre>
<img alt="Eigenfunctions for the first transformation" class="align-center" src="images/infinite_fdm/eigvecs_tanh.svg" style="width: 600px;">
</div>
<div class="section" id="second-transformation-xi-frac-2-pi-mathrm-atan-x">
<h4>Second transformation: <span class="math">\(\xi = \frac{2}{\pi}\mathrm{atan}(x)\)</span>
</h4>
<p>Let's consider first the transformation</p>
<div class="math">
\begin{equation*}
\xi = \frac{2}{\pi}\mathrm{atan}(x)\, .
\end{equation*}
</div>
<p>In this case</p>
<div class="math">
\begin{equation*}
\frac{\mathrm{d}\xi}{\mathrm{d}x} = \frac{2}{\pi(1 + x^2)} = \frac{2 \cos^2\xi}{\pi} \, ,
\end{equation*}
</div>
<p>and</p>
<div class="math">
\begin{equation*}
\frac{\mathrm{d}^2\xi}{\mathrm{d}x^2} = -\frac{4x}{\pi(1 + x^2)^2} = -\frac{4 \cos^4\xi \tan \xi}{\pi}\, .
\end{equation*}
</div>
<p>Once, again, we define the functions.</p>
<pre class="code ipython3"><a name="rest_code_28d81b3d3780477c9e16273dfe2a4217-1"></a><span class="n">pot</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span>
<a name="rest_code_28d81b3d3780477c9e16273dfe2a4217-2"></a><span class="n">fun</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">xi</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">tan</span><span class="p">(</span><span class="mf">0.5</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">xi</span><span class="p">)</span>
<a name="rest_code_28d81b3d3780477c9e16273dfe2a4217-3"></a><span class="n">dxdxi</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">xi</span><span class="p">:</span> <span class="mi">2</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mf">0.5</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">xi</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>
<a name="rest_code_28d81b3d3780477c9e16273dfe2a4217-4"></a><span class="n">dxdxi2</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">xi</span><span class="p">:</span> <span class="o">-</span><span class="mi">4</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mf">0.5</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">xi</span><span class="p">)</span><span class="o">**</span><span class="mi">4</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">tan</span><span class="p">(</span><span class="mf">0.5</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">xi</span><span class="p">)</span>
</pre>
<p>and run the function</p>
<pre class="code ipython3"><a name="rest_code_52d0bd014d0140ac9355c421d8ebacdb-1"></a><span class="n">x</span><span class="p">,</span> <span class="n">vals</span><span class="p">,</span> <span class="n">vecs</span> <span class="o">=</span> <span class="n">mapped_FD</span><span class="p">(</span><span class="n">pot</span><span class="p">,</span> <span class="n">fun</span><span class="p">,</span> <span class="n">dxdxi</span><span class="p">,</span> <span class="n">dxdxi2</span><span class="p">,</span> <span class="n">npts</span><span class="o">=</span><span class="mi">201</span><span class="p">)</span>
<a name="rest_code_52d0bd014d0140ac9355c421d8ebacdb-2"></a><span class="n">vals</span>
</pre>
<p>to obtain the following eigenvalues</p>
<pre class="literal-block">array([0.49997815, 1.49979632, 2.49930872, 3.49824697, 4.49627555,
       5.49295665])</pre>
<p>with this plot</p>
<pre class="code ipython3"><a name="rest_code_2a1f482354384c3586e1b45e1413f9b1-1"></a><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<a name="rest_code_2a1f482354384c3586e1b45e1413f9b1-2"></a><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">anal_vals</span><span class="p">)</span>
<a name="rest_code_2a1f482354384c3586e1b45e1413f9b1-3"></a><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">vals</span><span class="p">,</span> <span class="s2">"o"</span><span class="p">)</span>
<a name="rest_code_2a1f482354384c3586e1b45e1413f9b1-4"></a><span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s2">"Analytic"</span><span class="p">,</span> <span class="s2">"Finite differences"</span><span class="p">])</span>
<a name="rest_code_2a1f482354384c3586e1b45e1413f9b1-5"></a><span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">"$n$"</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<a name="rest_code_2a1f482354384c3586e1b45e1413f9b1-6"></a><span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">"$E_n$"</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<a name="rest_code_2a1f482354384c3586e1b45e1413f9b1-7"></a><span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">();</span>
</pre>
<img alt="Eigenvalues for the second transformation" class="align-center" src="images/infinite_fdm/eigvals_atan.svg" style="width: 600px;"><p>and the following eigenfunctions.</p>
<pre class="code ipython3"><a name="rest_code_27b4fcd32638405a80efcbebdb494ce7-1"></a><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<a name="rest_code_27b4fcd32638405a80efcbebdb494ce7-2"></a><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">vecs</span><span class="p">[:,</span> <span class="p">:</span><span class="mi">3</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<a name="rest_code_27b4fcd32638405a80efcbebdb494ce7-3"></a><span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">"$x$"</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<a name="rest_code_27b4fcd32638405a80efcbebdb494ce7-4"></a><span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">"$|\psi|^2$"</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<a name="rest_code_27b4fcd32638405a80efcbebdb494ce7-5"></a><span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
<a name="rest_code_27b4fcd32638405a80efcbebdb494ce7-6"></a><span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">"$x$"</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<a name="rest_code_27b4fcd32638405a80efcbebdb494ce7-7"></a><span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">"$|\psi_n(x)|^2$"</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<a name="rest_code_27b4fcd32638405a80efcbebdb494ce7-8"></a><span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">([])</span>
<a name="rest_code_27b4fcd32638405a80efcbebdb494ce7-9"></a><span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">();</span>
</pre>
<img alt="Eigenfunctions for the second transformation" class="align-center" src="images/infinite_fdm/eigvecs_atan.svg" style="width: 600px;">
</div>
</div>
<div class="section" id="conclusion">
<h3>Conclusion</h3>
<p>The method works fine, although the differential equation is more
convoluted due to the change of variable. Although there are more
elegant methods to consider infinite domains, this is simple enough to
be solved in 10 lines of code.</p>
<p>We can see that the mapping <span class="math">\(\xi = \mathrm{atan}(x)\)</span>, covers
better the domain than <span class="math">\(\xi = \tanh(x)\)</span>, where most of the points
are placed in the center of the interval.</p>
<p>Thanks for reading!</p>
<small>
  <i>
    This post was written in the Jupyter notebook. You can
    <a href="downloads/notebooks/finite_diff_map.ipynb">download</a>
    this notebook, or see a static view on
    <a href="http://nbviewer.jupyter.org/url/nicoguaro.github.io/downloads/notebooks/finite_diff_map.ipynb">nbviewer</a>.
  <i>
</i></i></small>
</div>
</div>
    </div>
    </article><article class="post h-entry post-text"><header><h1 class="post-title p-name"><a href="posts/cyclic_colormaps/" class="u-url">Cyclic colormaps comparison</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn">Nicolás Guarín-Zapata</span></p>
            <p class="dateline"><a href="posts/cyclic_colormaps/" rel="bookmark"><time class="post-date published dt-published" datetime="2018-01-02T18:55:41-05:00" title="2018-01-02 18:55">2018-01-02 18:55</time></a></p>
                <p class="commentline">
        
    <a href="posts/cyclic_colormaps/#disqus_thread" data-disqus-identifier="cache/posts/cyclic_colormaps.html">Comments</a>


        </p>
</div>
    </header><div class="e-content entry-content">
    <div>
<p>I started this post looking for a
<a class="reference external" href="https://en.wikipedia.org/wiki/Diffusion_map">diffusion map</a> on Python,
that I didn't find. Then I continued following an
<a class="reference external" href="http://scikit-learn.org/stable/auto_examples/manifold/plot_compare_methods.html#sphx-glr-auto-examples-manifold-plot-compare-methods-py">example</a>
on <a class="reference external" href="https://en.wikipedia.org/wiki/Nonlinear_dimensionality_reduction">manifold learning</a>
by <a class="reference external" href="https://jakevdp.github.io/">Jake Vanderplas</a> on a <a class="reference external" href="https://commons.wikimedia.org/wiki/File:Diffusion_map_of_a_torodial_helix.jpg">different dataset</a>.
It worked nicely,</p>
<img alt="/images/manifold_learning_toroidal_helix.svg" src="images/manifold_learning_toroidal_helix.svg"><p>but the colormap used is <a class="reference external" href="https://matplotlib.org/examples/color/colormaps_reference.html">Spectral</a>,
that is divergent. This made me think about
using a cyclic colormap, and ended up in
<a class="reference external" href="https://stackoverflow.com/q/23712207/3358223">this StackOverflow</a> question.
And I decided to compare some cyclic colormaps.</p>
<p>I picked up colormaps from different sources</p>
<ul class="simple">
<li>
<p><a class="reference external" href="https://matplotlib.org/cmocean/">cmocean</a>:</p>
<ul>
<li><p>phase</p></li>
</ul>
</li>
<li>
<p><a class="reference external" href="http://paraview.org/">Paraview</a>:</p>
<ul>
<li><p>hue_L60</p></li>
<li><p>erdc_iceFire</p></li>
<li><p>nic_Edge</p></li>
</ul>
</li>
<li>
<p><a class="reference external" href="https://github.com/bokeh/colorcet">Colorcet</a>:</p>
<ul>
<li><p>colorwheel</p></li>
<li><p>cyclic_mrybm_35_75_c68</p></li>
<li><p>cyclic_mygbm_30_95_c78</p></li>
</ul>
</li>
</ul>
<p>and, of course, <code class="docutils literal">hsv</code>. You can download the colormaps in text
format from <a class="reference external" href="downloads/cyclic_colormaps.zip">here</a>.</p>
<div class="section" id="comparison">
<h2>Comparison</h2>
<p>For all the examples below the following imports are done:</p>
<pre class="code python"><a name="rest_code_d732ac2f09184a3ab891b6db116f5516-1"></a><span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">division</span><span class="p">,</span> <span class="n">print_function</span>
<a name="rest_code_d732ac2f09184a3ab891b6db116f5516-2"></a><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<a name="rest_code_d732ac2f09184a3ab891b6db116f5516-3"></a><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<a name="rest_code_d732ac2f09184a3ab891b6db116f5516-4"></a><span class="kn">from</span> <span class="nn">matplotlib.colors</span> <span class="kn">import</span> <span class="n">LinearSegmentedColormap</span>
<a name="rest_code_d732ac2f09184a3ab891b6db116f5516-5"></a><span class="kn">from</span> <span class="nn">colorspacious</span> <span class="kn">import</span> <span class="n">cspace_convert</span>
</pre>
<div class="section" id="color-map-test-image">
<h3>Color map test image</h3>
<p>Peter Kovesi proposed a way to compare cyclic colormaps on a
<a class="reference external" href="http://peterkovesi.com/projects/colourmaps/colourmaptestimage.html">paper</a>
on 2015. It consists of a spiral ramp with an undulation. In polar coordinates
it reads</p>
<div class="math">
\begin{equation*}
c = (A \rho^p \sin(n \theta) + \theta)\, \mathrm{mod}\, 2\pi
\end{equation*}
</div>
<p>with <span class="math">\(A\)</span> the amplitude of the oscilation, <span class="math">\(\rho\)</span> the normalized
radius in [0, 1], <span class="math">\(p\)</span> a positive number, and <span class="math">\(n\)</span> the number
of cycles.</p>
<p>And the following function creates the grid in Python</p>
<pre class="code python"><a name="rest_code_1275c698065d4bbd8b4c8b18abb879d3-1"></a><span class="k">def</span> <span class="nf">circle_sine_ramp</span><span class="p">(</span><span class="n">r_max</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">r_min</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">amp</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">5</span><span class="p">,</span> <span class="n">cycles</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span>
<a name="rest_code_1275c698065d4bbd8b4c8b18abb879d3-2"></a>                     <span class="n">power</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">nr</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">ntheta</span><span class="o">=</span><span class="mi">1025</span><span class="p">):</span>
<a name="rest_code_1275c698065d4bbd8b4c8b18abb879d3-3"></a><span class="n">r</span><span class="p">,</span> <span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mgrid</span><span class="p">[</span><span class="n">r_min</span><span class="p">:</span><span class="n">r_max</span><span class="p">:</span><span class="n">nr</span><span class="o">*</span><span class="mi">1</span><span class="n">j</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">:</span><span class="n">ntheta</span><span class="o">*</span><span class="mi">1</span><span class="n">j</span><span class="p">]</span>
<a name="rest_code_1275c698065d4bbd8b4c8b18abb879d3-4"></a><span class="n">r_norm</span> <span class="o">=</span> <span class="p">(</span><span class="n">r</span> <span class="o">-</span> <span class="n">r_min</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">r_max</span> <span class="o">-</span> <span class="n">r_min</span><span class="p">)</span>
<a name="rest_code_1275c698065d4bbd8b4c8b18abb879d3-5"></a><span class="n">vals</span> <span class="o">=</span> <span class="n">amp</span> <span class="o">*</span> <span class="n">r_norm</span><span class="o">**</span><span class="n">power</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">cycles</span><span class="o">*</span><span class="n">t</span><span class="p">)</span> <span class="o">+</span> <span class="n">t</span>
<a name="rest_code_1275c698065d4bbd8b4c8b18abb879d3-6"></a><span class="n">vals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mod</span><span class="p">(</span><span class="n">vals</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span>
<a name="rest_code_1275c698065d4bbd8b4c8b18abb879d3-7"></a><span class="k">return</span> <span class="n">t</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">vals</span>
</pre>
<p>The following is the result</p>
<img alt="/images/sine_helix_cyclic_cmap.png" src="images/sine_helix_cyclic_cmap.png">
</div>
<div class="section" id="colorblindness-test">
<h3>Colorblindness test</h3>
<pre class="code python"><a name="rest_code_87ffdf1f77424e3fa0650f76b4de6d22-1"></a><span class="n">t</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">vals</span> <span class="o">=</span> <span class="n">circle_sine_ramp</span><span class="p">(</span><span class="n">cycles</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<a name="rest_code_87ffdf1f77424e3fa0650f76b4de6d22-2"></a><span class="n">cmaps</span> <span class="o">=</span> <span class="p">[</span><span class="s2">"hsv"</span><span class="p">,</span>
<a name="rest_code_87ffdf1f77424e3fa0650f76b4de6d22-3"></a>         <span class="s2">"cmocean_phase"</span><span class="p">,</span>
<a name="rest_code_87ffdf1f77424e3fa0650f76b4de6d22-4"></a>         <span class="s2">"hue_L60"</span><span class="p">,</span>
<a name="rest_code_87ffdf1f77424e3fa0650f76b4de6d22-5"></a>         <span class="s2">"erdc_iceFire"</span><span class="p">,</span>
<a name="rest_code_87ffdf1f77424e3fa0650f76b4de6d22-6"></a>         <span class="s2">"nic_Edge"</span><span class="p">,</span>
<a name="rest_code_87ffdf1f77424e3fa0650f76b4de6d22-7"></a>         <span class="s2">"colorwheel"</span><span class="p">,</span>
<a name="rest_code_87ffdf1f77424e3fa0650f76b4de6d22-8"></a>         <span class="s2">"cyclic_mrybm"</span><span class="p">,</span>
<a name="rest_code_87ffdf1f77424e3fa0650f76b4de6d22-9"></a>         <span class="s2">"cyclic_mygbm"</span><span class="p">]</span>
<a name="rest_code_87ffdf1f77424e3fa0650f76b4de6d22-10"></a><span class="n">severity</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">50</span><span class="p">]</span>
<a name="rest_code_87ffdf1f77424e3fa0650f76b4de6d22-11"></a><span class="k">for</span> <span class="n">colormap</span> <span class="ow">in</span> <span class="n">cmaps</span><span class="p">:</span>
<a name="rest_code_87ffdf1f77424e3fa0650f76b4de6d22-12"></a>    <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="n">colormap</span> <span class="o">+</span> <span class="s2">".txt"</span><span class="p">)</span>
<a name="rest_code_87ffdf1f77424e3fa0650f76b4de6d22-13"></a>    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<a name="rest_code_87ffdf1f77424e3fa0650f76b4de6d22-14"></a>    <span class="k">for</span> <span class="n">cont</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
<a name="rest_code_87ffdf1f77424e3fa0650f76b4de6d22-15"></a>        <span class="n">cvd_space</span> <span class="o">=</span> <span class="p">{</span><span class="s2">"name"</span><span class="p">:</span> <span class="s2">"sRGB1+CVD"</span><span class="p">,</span>
<a name="rest_code_87ffdf1f77424e3fa0650f76b4de6d22-16"></a>             <span class="s2">"cvd_type"</span><span class="p">:</span> <span class="n">cvd_type</span><span class="p">[</span><span class="n">cont</span><span class="p">],</span>
<a name="rest_code_87ffdf1f77424e3fa0650f76b4de6d22-17"></a>             <span class="s2">"severity"</span><span class="p">:</span> <span class="n">severity</span><span class="p">[</span><span class="n">cont</span><span class="p">]}</span>
<a name="rest_code_87ffdf1f77424e3fa0650f76b4de6d22-18"></a>        <span class="n">data2</span> <span class="o">=</span> <span class="n">cspace_convert</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">cvd_space</span><span class="p">,</span> <span class="s2">"sRGB1"</span><span class="p">)</span>
<a name="rest_code_87ffdf1f77424e3fa0650f76b4de6d22-19"></a>        <span class="n">data2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">data2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<a name="rest_code_87ffdf1f77424e3fa0650f76b4de6d22-20"></a>        <span class="n">cmap</span> <span class="o">=</span> <span class="n">LinearSegmentedColormap</span><span class="o">.</span><span class="n">from_list</span><span class="p">(</span><span class="s1">'my_colormap'</span><span class="p">,</span> <span class="n">data2</span><span class="p">)</span>
<a name="rest_code_87ffdf1f77424e3fa0650f76b4de6d22-21"></a>        <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">cont</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="s2">"polar"</span><span class="p">)</span>
<a name="rest_code_87ffdf1f77424e3fa0650f76b4de6d22-22"></a>        <span class="n">ax</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">vals</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">)</span>
<a name="rest_code_87ffdf1f77424e3fa0650f76b4de6d22-23"></a>        <span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">([])</span>
<a name="rest_code_87ffdf1f77424e3fa0650f76b4de6d22-24"></a>        <span class="n">ax</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([])</span>
<a name="rest_code_87ffdf1f77424e3fa0650f76b4de6d22-25"></a>    <span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="n">colormap</span><span class="p">)</span>
<a name="rest_code_87ffdf1f77424e3fa0650f76b4de6d22-26"></a>    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<a name="rest_code_87ffdf1f77424e3fa0650f76b4de6d22-27"></a>    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">colormap</span> <span class="o">+</span> <span class="s2">".png"</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>
</pre>
<div class="figure align-center">
<img alt="/images/hsv_eval.png" src="images/hsv_eval.png"><p class="caption"><code class="docutils literal">hsv</code> colormap comparison for different color vision deficiencies.</p>
</div>
<div class="figure align-center">
<img alt="/images/cmocean_phase_eval.png" src="images/cmocean_phase_eval.png"><p class="caption"><code class="docutils literal">Phase</code> colormap comparison for different color vision deficiencies.</p>
</div>
<div class="figure align-center">
<img alt="/images/hue_L60_eval.png" src="images/hue_L60_eval.png"><p class="caption"><code class="docutils literal">hue_L60</code> colormap comparison for different color vision deficiencies.</p>
</div>
<div class="figure align-center">
<img alt="/images/erdc_iceFire_eval.png" src="images/erdc_iceFire_eval.png"><p class="caption"><code class="docutils literal">erdc_iceFire</code> colormap comparison for different color vision deficiencies.</p>
</div>
<div class="figure align-center">
<img alt="/images/nic_Edge_eval.png" src="images/nic_Edge_eval.png"><p class="caption"><code class="docutils literal">nic_Edge</code> colormap comparison for different color vision deficiencies.</p>
</div>
<div class="figure align-center">
<img alt="/images/colorwheel_eval.png" src="images/colorwheel_eval.png"><p class="caption"><code class="docutils literal">Colorwheel</code> colormap comparison for different color vision deficiencies.</p>
</div>
<div class="figure align-center">
<img alt="/images/cyclic_mrybm_eval.png" src="images/cyclic_mrybm_eval.png"><p class="caption"><code class="docutils literal">Cyclic_mrybm</code> colormap comparison for different color vision deficiencies.</p>
</div>
<div class="figure align-center">
<img alt="/images/cyclic_mygbm_eval.png" src="images/cyclic_mygbm_eval.png"><p class="caption"><code class="docutils literal">Cyclic_mygbm</code> colormap comparison for different color vision deficiencies.</p>
</div>
</div>
</div>
<div class="section" id="randomly-generated-cyclic-colormaps">
<h2>Randomly generated cyclic colormaps</h2>
<p>What if we generate some random colormaps that are cyclic? How would they
look like?</p>
<p>Following are the snippet and resulting colormaps.</p>
<pre class="code python"><a name="rest_code_59eff08646354a298a94acbf3c4bcd6e-1"></a><span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">division</span><span class="p">,</span> <span class="n">print_function</span>
<a name="rest_code_59eff08646354a298a94acbf3c4bcd6e-2"></a><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<a name="rest_code_59eff08646354a298a94acbf3c4bcd6e-3"></a><span class="kn">from</span> <span class="nn">mpl_toolkits.mplot3d</span> <span class="kn">import</span> <span class="n">Axes3D</span>
<a name="rest_code_59eff08646354a298a94acbf3c4bcd6e-4"></a><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<a name="rest_code_59eff08646354a298a94acbf3c4bcd6e-5"></a><span class="kn">from</span> <span class="nn">matplotlib.colors</span> <span class="kn">import</span> <span class="n">LinearSegmentedColormap</span>
<a name="rest_code_59eff08646354a298a94acbf3c4bcd6e-6"></a>
<a name="rest_code_59eff08646354a298a94acbf3c4bcd6e-7"></a>
<a name="rest_code_59eff08646354a298a94acbf3c4bcd6e-8"></a><span class="c1"># Next line to silence pyflakes. This import is needed.</span>
<a name="rest_code_59eff08646354a298a94acbf3c4bcd6e-9"></a><span class="n">Axes3D</span>
<a name="rest_code_59eff08646354a298a94acbf3c4bcd6e-10"></a>
<a name="rest_code_59eff08646354a298a94acbf3c4bcd6e-11"></a><span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="s2">"all"</span><span class="p">)</span>
<a name="rest_code_59eff08646354a298a94acbf3c4bcd6e-12"></a><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<a name="rest_code_59eff08646354a298a94acbf3c4bcd6e-13"></a><span class="n">fig2</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<a name="rest_code_59eff08646354a298a94acbf3c4bcd6e-14"></a><span class="n">nx</span> <span class="o">=</span> <span class="mi">4</span>
<a name="rest_code_59eff08646354a298a94acbf3c4bcd6e-15"></a><span class="n">ny</span> <span class="o">=</span> <span class="mi">4</span>
<a name="rest_code_59eff08646354a298a94acbf3c4bcd6e-16"></a><span class="n">azimuths</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">361</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<a name="rest_code_59eff08646354a298a94acbf3c4bcd6e-17"></a><span class="n">zeniths</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mi">70</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<a name="rest_code_59eff08646354a298a94acbf3c4bcd6e-18"></a><span class="n">values</span> <span class="o">=</span> <span class="n">azimuths</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">30</span><span class="p">,</span> <span class="mi">361</span><span class="p">))</span>
<a name="rest_code_59eff08646354a298a94acbf3c4bcd6e-19"></a><span class="k">for</span> <span class="n">cont</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nx</span> <span class="o">*</span> <span class="n">ny</span><span class="p">):</span>
<a name="rest_code_59eff08646354a298a94acbf3c4bcd6e-20"></a>    <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="n">cont</span><span class="p">)</span>
<a name="rest_code_59eff08646354a298a94acbf3c4bcd6e-21"></a>    <span class="n">rad</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)</span>
<a name="rest_code_59eff08646354a298a94acbf3c4bcd6e-22"></a>    <span class="n">center</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="n">rad</span><span class="p">,</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">rad</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<a name="rest_code_59eff08646354a298a94acbf3c4bcd6e-23"></a>    <span class="n">mat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<a name="rest_code_59eff08646354a298a94acbf3c4bcd6e-24"></a>    <span class="n">rot_mat</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">qr</span><span class="p">(</span><span class="n">mat</span><span class="p">)</span>
<a name="rest_code_59eff08646354a298a94acbf3c4bcd6e-25"></a>    <span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mi">256</span><span class="p">)</span>
<a name="rest_code_59eff08646354a298a94acbf3c4bcd6e-26"></a>    <span class="n">x</span> <span class="o">=</span> <span class="n">rad</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
<a name="rest_code_59eff08646354a298a94acbf3c4bcd6e-27"></a>    <span class="n">y</span> <span class="o">=</span> <span class="n">rad</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
<a name="rest_code_59eff08646354a298a94acbf3c4bcd6e-28"></a>    <span class="n">z</span> <span class="o">=</span> <span class="mf">0.0</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
<a name="rest_code_59eff08646354a298a94acbf3c4bcd6e-29"></a>    <span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">((</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">))</span>
<a name="rest_code_59eff08646354a298a94acbf3c4bcd6e-30"></a>    <span class="n">X</span> <span class="o">=</span> <span class="n">rot_mat</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">X</span><span class="p">)</span> <span class="o">+</span> <span class="n">center</span>
<a name="rest_code_59eff08646354a298a94acbf3c4bcd6e-31"></a>
<a name="rest_code_59eff08646354a298a94acbf3c4bcd6e-32"></a>    <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">ny</span><span class="p">,</span> <span class="n">nx</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">cont</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="s1">'polar'</span><span class="p">)</span>
<a name="rest_code_59eff08646354a298a94acbf3c4bcd6e-33"></a>    <span class="n">cmap</span> <span class="o">=</span> <span class="n">LinearSegmentedColormap</span><span class="o">.</span><span class="n">from_list</span><span class="p">(</span><span class="s1">'my_colormap'</span><span class="p">,</span> <span class="n">X</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
<a name="rest_code_59eff08646354a298a94acbf3c4bcd6e-34"></a>    <span class="n">ax</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span><span class="n">azimuths</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mf">180.0</span><span class="p">,</span> <span class="n">zeniths</span><span class="p">,</span> <span class="n">values</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">)</span>
<a name="rest_code_59eff08646354a298a94acbf3c4bcd6e-35"></a>    <span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">([])</span>
<a name="rest_code_59eff08646354a298a94acbf3c4bcd6e-36"></a>    <span class="n">ax</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([])</span>
<a name="rest_code_59eff08646354a298a94acbf3c4bcd6e-37"></a>
<a name="rest_code_59eff08646354a298a94acbf3c4bcd6e-38"></a>    <span class="n">ax2</span> <span class="o">=</span> <span class="n">fig2</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">ny</span><span class="p">,</span> <span class="n">nx</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">cont</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="s1">'3d'</span><span class="p">)</span>
<a name="rest_code_59eff08646354a298a94acbf3c4bcd6e-39"></a>    <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:],</span> <span class="n">X</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:],</span> <span class="n">X</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="p">:])</span>
<a name="rest_code_59eff08646354a298a94acbf3c4bcd6e-40"></a>    <span class="n">ax2</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<a name="rest_code_59eff08646354a298a94acbf3c4bcd6e-41"></a>    <span class="n">ax2</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<a name="rest_code_59eff08646354a298a94acbf3c4bcd6e-42"></a>    <span class="n">ax2</span><span class="o">.</span><span class="n">set_zlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<a name="rest_code_59eff08646354a298a94acbf3c4bcd6e-43"></a>    <span class="n">ax2</span><span class="o">.</span><span class="n">view_init</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="o">-</span><span class="mi">60</span><span class="p">)</span>
<a name="rest_code_59eff08646354a298a94acbf3c4bcd6e-44"></a>    <span class="n">ax2</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">])</span>
<a name="rest_code_59eff08646354a298a94acbf3c4bcd6e-45"></a>    <span class="n">ax2</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">])</span>
<a name="rest_code_59eff08646354a298a94acbf3c4bcd6e-46"></a>    <span class="n">ax2</span><span class="o">.</span><span class="n">set_zticks</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">])</span>
<a name="rest_code_59eff08646354a298a94acbf3c4bcd6e-47"></a>    <span class="n">ax2</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">([])</span>
<a name="rest_code_59eff08646354a298a94acbf3c4bcd6e-48"></a>    <span class="n">ax2</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">([])</span>
<a name="rest_code_59eff08646354a298a94acbf3c4bcd6e-49"></a>    <span class="n">ax2</span><span class="o">.</span><span class="n">set_zticklabels</span><span class="p">([])</span>
<a name="rest_code_59eff08646354a298a94acbf3c4bcd6e-50"></a>
<a name="rest_code_59eff08646354a298a94acbf3c4bcd6e-51"></a>
<a name="rest_code_59eff08646354a298a94acbf3c4bcd6e-52"></a><span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">"random_cmaps.png"</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span> <span class="n">transparent</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a name="rest_code_59eff08646354a298a94acbf3c4bcd6e-53"></a><span class="n">fig2</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">"random_cmaps_traj.svg"</span><span class="p">,</span> <span class="n">transparent</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre>
<div class="figure align-center">
<img alt="/images/random_cmaps.png" src="images/random_cmaps.png"><p class="caption">16 randomly generated colormaps.</p>
</div>
<div class="figure align-center">
<img alt="/images/random_cmaps_traj.svg" src="images/random_cmaps_traj.svg"><p class="caption">Trajectories in RGB space for the randomly generated colormaps.</p>
</div>
<p>A good idea would be to take these colormaps and optimize some perceptual
parameters such as lightness to get some usable ones.</p>
</div>
<div class="section" id="conclusions">
<h2>Conclusions</h2>
<p>I probably would use <code class="docutils literal">phase</code>, <code class="docutils literal">colorwheel</code>, or <code class="docutils literal">mrybm</code> in the
future.</p>
<div class="figure align-center">
<img alt="/images/toroidal_helix_phase.svg" src="images/toroidal_helix_phase.svg"><p class="caption">Initial image using <code class="docutils literal">phase</code>.</p>
</div>
<div class="figure align-center">
<img alt="/images/toroidal_helix_colorwheel.svg" src="images/toroidal_helix_colorwheel.svg"><p class="caption">Initial image using <code class="docutils literal">colorwheel</code>.</p>
</div>
<div class="figure align-center">
<img alt="/images/toroidal_helix_mrybm.svg" src="images/toroidal_helix_mrybm.svg"><p class="caption">Initial image using <code class="docutils literal">mrybm</code>.</p>
</div>
</div>
<div class="section" id="references">
<h2>References</h2>
<ol class="arabic simple">
<li><p>Peter Kovesi. Good Colour Maps: How to Design Them.
arXiv:1509.03700 [cs.GR] 2015</p></li>
</ol>
</div>
</div>
    </div>
    </article><article class="post h-entry post-text"><header><h1 class="post-title p-name"><a href="posts/putnam_prob/" class="u-url">Probability that a random tetrahedron over a sphere contains its center</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn">Nicolás Guarín-Zapata</span></p>
            <p class="dateline"><a href="posts/putnam_prob/" rel="bookmark"><time class="post-date published dt-published" datetime="2017-12-13T15:24:52-05:00" title="2017-12-13 15:24">2017-12-13 15:24</time></a></p>
                <p class="commentline">
        
    <a href="posts/putnam_prob/#disqus_thread" data-disqus-identifier="cache/posts/putnam_prob.html">Comments</a>


        </p>
</div>
    </header><div class="e-content entry-content">
    <div>
<p>I got interested in this problem watching the YouTube channel
<a class="reference external" href="https://www.youtube.com/channel/UCYO_jab_esuFRV4b17AJtAw">3Blue1Brown</a>,
by Grant Sanderson, where he explains a way to tackle the problem that
is just … elegant!</p>
<p>I can't emphasize enough how much I like this channel. For example,
his approach to linear algebra in
<a class="reference external" href="https://www.youtube.com/watch?v=kjBOesZCoqc&amp;list=PLZHQObOWTQDPD3MizzM2xVFitgF8hE_ab">Essence of linear algebra</a> is really
good. I mention it, just in case you don't know it.</p>
<div class="section" id="the-problem">
<h2>The problem</h2>
<p>Let's talk business now. The problem was originally part of the 53rd
<a class="reference external" href="http://kskedlaya.org/putnam-archive/1992.pdf">Putnam competition on 1992</a>
and was stated as</p>
<blockquote>
<p>Four points are chosen at random on the surface of a
sphere.   What is the probability that the center of the
sphere lies inside the tetrahedron whose vertices are at
the four points?  (It is understood that each point is in-
dependently chosen relative to a uniform distribution on
the sphere.)</p>
</blockquote>
<p>As shown in the mentioned video, the probability is <span class="math">\(1/8\)</span>. Let's
come with an algorithm to obtain this result —approximately, at least.</p>
</div>
<div class="section" id="the-proposed-approach">
<h2>The proposed approach</h2>
<p>The approach that we are going to use is pretty straightforward. We are
going to obtain a sample of (independent) random sets, with four points
each, and check how many of them satisfy the condition of being inside
the tetrahedron with the points as vertices.</p>
<p>For this approach to work, we need two things:</p>
<ol class="arabic simple">
<li><p>A way to generate random numbers uniformly distributed. This is already
in <code class="docutils literal">numpy.random.uniform</code>, so we don't need to do much about it.</p></li>
<li><p>A way to check if a point is inside a tetrahedron.</p></li>
</ol>
<div class="section" id="checking-that-a-point-is-inside-a-tetrahedron">
<h3>Checking that a point is inside a tetrahedron</h3>
<p>To find if a point is inside a tetrahedron, we could compute the
<a class="reference external" href="https://en.wikipedia.org/wiki/Barycentric_coordinate_system">barycentric coordinates</a>
for that point and check that all of them are have the same sign. Equivalently,
as proposed <a class="reference external" href="http://steve.hollasch.net/cgindex/geometry/ptintet.html">here</a>,
we can check that the determinants of the matrices</p>
<div class="math">
\begin{equation*}
M_0 =
\begin{bmatrix}
x_0 &amp;y_0 &amp;z_0 &amp;1\\
x_1 &amp;y_1 &amp;z_1 &amp;1\\
x_2 &amp;y_2 &amp;z_2 &amp;1\\
x_3 &amp;y_3 &amp;z_3 &amp;1
\end{bmatrix}\, ,
\end{equation*}
</div>
<div class="math">
\begin{equation*}
M_1 =
\begin{bmatrix}
x &amp;y &amp;z &amp;1\\
x_1 &amp;y_1 &amp;z_1 &amp;1\\
x_2 &amp;y_2 &amp;z_2 &amp;1\\
x_3 &amp;y_3 &amp;z_3 &amp;1
\end{bmatrix}\, ,
\end{equation*}
</div>
<div class="math">
\begin{equation*}
M_2 =
\begin{bmatrix}
x_0 &amp;y_0 &amp;z_0 &amp;1\\
x &amp;y &amp;z &amp;1\\
x_2 &amp;y_2 &amp;z_2 &amp;1\\
x_3 &amp;y_3 &amp;z_3 &amp;1
\end{bmatrix}\, ,
\end{equation*}
</div>
<div class="math">
\begin{equation*}
M_3 =
\begin{bmatrix}
x_0 &amp;y_0 &amp;z_0 &amp;1\\
x_1 &amp;y_1 &amp;z_1 &amp;1\\
x &amp;y &amp;z &amp;1\\
x_3 &amp;y_3 &amp;z_3 &amp;1
\end{bmatrix}\, ,
\end{equation*}
</div>
<div class="math">
\begin{equation*}
M_4 =
\begin{bmatrix}
x_0 &amp;y_0 &amp;z_0 &amp;1\\
x_1 &amp;y_1 &amp;z_1 &amp;1\\
x_2 &amp;y_2 &amp;z_2 &amp;1\\
x &amp;y &amp;z &amp;1
\end{bmatrix}\, ,
\end{equation*}
</div>
<p>have the same sign. In this case, <span class="math">\((x, y, z)\)</span> is the point of interest
and <span class="math">\((x_i, y_i, z_i)\)</span> are the coordinates of each vertex.</p>
</div>
</div>
<div class="section" id="the-algorithm">
<h2>The algorithm</h2>
<p>Below is a Python implementation of the approach discussed before</p>
<pre class="code python"><a name="rest_code_302464fb223b45a581781697d3bb60d6-1"></a><span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">division</span><span class="p">,</span> <span class="n">print_function</span>
<a name="rest_code_302464fb223b45a581781697d3bb60d6-2"></a><span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="p">(</span><span class="n">random</span><span class="p">,</span> <span class="n">pi</span><span class="p">,</span> <span class="n">cos</span><span class="p">,</span> <span class="n">sin</span><span class="p">,</span> <span class="n">sign</span><span class="p">,</span> <span class="n">hstack</span><span class="p">,</span>
<a name="rest_code_302464fb223b45a581781697d3bb60d6-3"></a>                   <span class="n">column_stack</span><span class="p">,</span> <span class="n">logspace</span><span class="p">)</span>
<a name="rest_code_302464fb223b45a581781697d3bb60d6-4"></a><span class="kn">from</span> <span class="nn">numpy.linalg</span> <span class="kn">import</span> <span class="n">det</span>
<a name="rest_code_302464fb223b45a581781697d3bb60d6-5"></a><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<a name="rest_code_302464fb223b45a581781697d3bb60d6-6"></a>
<a name="rest_code_302464fb223b45a581781697d3bb60d6-7"></a>
<a name="rest_code_302464fb223b45a581781697d3bb60d6-8"></a><span class="k">def</span> <span class="nf">in_tet</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">pt</span><span class="p">):</span>
<a name="rest_code_302464fb223b45a581781697d3bb60d6-9"></a>    <span class="sd">"""</span>
<a name="rest_code_302464fb223b45a581781697d3bb60d6-10"></a><span class="sd">    Determine if the point pt is inside the</span>
<a name="rest_code_302464fb223b45a581781697d3bb60d6-11"></a><span class="sd">    tetrahedron with vertices coordinates x, y, z</span>
<a name="rest_code_302464fb223b45a581781697d3bb60d6-12"></a><span class="sd">    """</span>
<a name="rest_code_302464fb223b45a581781697d3bb60d6-13"></a>    <span class="n">mat0</span> <span class="o">=</span> <span class="n">column_stack</span><span class="p">((</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]))</span>
<a name="rest_code_302464fb223b45a581781697d3bb60d6-14"></a>    <span class="n">det0</span> <span class="o">=</span> <span class="n">det</span><span class="p">(</span><span class="n">mat0</span><span class="p">)</span>
<a name="rest_code_302464fb223b45a581781697d3bb60d6-15"></a>    <span class="k">for</span> <span class="n">cont</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
<a name="rest_code_302464fb223b45a581781697d3bb60d6-16"></a>        <span class="n">mat</span> <span class="o">=</span> <span class="n">mat0</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<a name="rest_code_302464fb223b45a581781697d3bb60d6-17"></a>        <span class="n">mat</span><span class="p">[</span><span class="n">cont</span><span class="p">]</span> <span class="o">=</span> <span class="n">hstack</span><span class="p">((</span><span class="n">pt</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<a name="rest_code_302464fb223b45a581781697d3bb60d6-18"></a>        <span class="k">if</span> <span class="n">sign</span><span class="p">(</span><span class="n">det</span><span class="p">(</span><span class="n">mat</span><span class="p">)</span><span class="o">*</span><span class="n">det0</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
<a name="rest_code_302464fb223b45a581781697d3bb60d6-19"></a>            <span class="n">inside</span> <span class="o">=</span> <span class="kc">False</span>
<a name="rest_code_302464fb223b45a581781697d3bb60d6-20"></a>            <span class="k">break</span>
<a name="rest_code_302464fb223b45a581781697d3bb60d6-21"></a>        <span class="k">else</span><span class="p">:</span>
<a name="rest_code_302464fb223b45a581781697d3bb60d6-22"></a>            <span class="n">inside</span> <span class="o">=</span> <span class="kc">True</span>
<a name="rest_code_302464fb223b45a581781697d3bb60d6-23"></a>    <span class="k">return</span> <span class="n">inside</span>
<a name="rest_code_302464fb223b45a581781697d3bb60d6-24"></a>
<a name="rest_code_302464fb223b45a581781697d3bb60d6-25"></a>
<a name="rest_code_302464fb223b45a581781697d3bb60d6-26"></a><span class="c1">#%% Computation</span>
<a name="rest_code_302464fb223b45a581781697d3bb60d6-27"></a><span class="n">prob</span> <span class="o">=</span> <span class="p">[]</span>
<a name="rest_code_302464fb223b45a581781697d3bb60d6-28"></a><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<a name="rest_code_302464fb223b45a581781697d3bb60d6-29"></a><span class="n">N_min</span> <span class="o">=</span> <span class="mi">1</span>
<a name="rest_code_302464fb223b45a581781697d3bb60d6-30"></a><span class="n">N_max</span> <span class="o">=</span> <span class="mi">5</span>
<a name="rest_code_302464fb223b45a581781697d3bb60d6-31"></a><span class="n">N_vals</span> <span class="o">=</span> <span class="n">logspace</span><span class="p">(</span><span class="n">N_min</span><span class="p">,</span> <span class="n">N_max</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
<a name="rest_code_302464fb223b45a581781697d3bb60d6-32"></a><span class="k">for</span> <span class="n">N</span> <span class="ow">in</span> <span class="n">N_vals</span><span class="p">:</span>
<a name="rest_code_302464fb223b45a581781697d3bb60d6-33"></a>    <span class="n">inside_cont</span> <span class="o">=</span> <span class="mi">0</span>
<a name="rest_code_302464fb223b45a581781697d3bb60d6-34"></a>    <span class="k">for</span> <span class="n">cont_pts</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
<a name="rest_code_302464fb223b45a581781697d3bb60d6-35"></a>        <span class="n">phi</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="n">low</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">high</span><span class="o">=</span><span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<a name="rest_code_302464fb223b45a581781697d3bb60d6-36"></a>        <span class="n">theta</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="n">low</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">high</span><span class="o">=</span><span class="n">pi</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<a name="rest_code_302464fb223b45a581781697d3bb60d6-37"></a>        <span class="n">x</span> <span class="o">=</span> <span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">phi</span><span class="p">)</span>
<a name="rest_code_302464fb223b45a581781697d3bb60d6-38"></a>        <span class="n">y</span> <span class="o">=</span> <span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">phi</span><span class="p">)</span>
<a name="rest_code_302464fb223b45a581781697d3bb60d6-39"></a>        <span class="n">z</span> <span class="o">=</span> <span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>
<a name="rest_code_302464fb223b45a581781697d3bb60d6-40"></a>        <span class="k">if</span> <span class="n">in_tet</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]):</span>
<a name="rest_code_302464fb223b45a581781697d3bb60d6-41"></a>            <span class="n">inside_cont</span> <span class="o">+=</span> <span class="mi">1</span>
<a name="rest_code_302464fb223b45a581781697d3bb60d6-42"></a>
<a name="rest_code_302464fb223b45a581781697d3bb60d6-43"></a>    <span class="n">prob</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">inside_cont</span><span class="o">/</span><span class="n">N</span><span class="p">)</span>
<a name="rest_code_302464fb223b45a581781697d3bb60d6-44"></a>
<a name="rest_code_302464fb223b45a581781697d3bb60d6-45"></a>
<a name="rest_code_302464fb223b45a581781697d3bb60d6-46"></a><span class="c1">#%% Plotting</span>
<a name="rest_code_302464fb223b45a581781697d3bb60d6-47"></a><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<a name="rest_code_302464fb223b45a581781697d3bb60d6-48"></a><span class="n">plt</span><span class="o">.</span><span class="n">hlines</span><span class="p">(</span><span class="mf">0.125</span><span class="p">,</span> <span class="mi">10</span><span class="o">**</span><span class="n">N_min</span><span class="p">,</span> <span class="mi">10</span><span class="o">**</span><span class="n">N_max</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">"#3f3f3f"</span><span class="p">)</span>
<a name="rest_code_302464fb223b45a581781697d3bb60d6-49"></a><span class="n">plt</span><span class="o">.</span><span class="n">semilogx</span><span class="p">(</span><span class="n">N_vals</span><span class="p">,</span> <span class="n">prob</span><span class="p">,</span> <span class="s2">"o"</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<a name="rest_code_302464fb223b45a581781697d3bb60d6-50"></a><span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">"Number of trials"</span><span class="p">)</span>
<a name="rest_code_302464fb223b45a581781697d3bb60d6-51"></a><span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">"Computed probability"</span><span class="p">)</span>
<a name="rest_code_302464fb223b45a581781697d3bb60d6-52"></a><span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<a name="rest_code_302464fb223b45a581781697d3bb60d6-53"></a><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre>
<p>As expected, when the number of samples is sufficiently large, the
estimated probability is close to the theoretical value: 0.125. This
can be seen in the following figure.</p>
<img alt="Computed probability for different sample sizes" class="align-center" src="images/random_tets.svg" style="width: 600px;">
</div>
</div>
    </div>
    </article>
</div>

        <nav class="postindexpager"><ul class="pager">
<li class="previous">
                <a href="." rel="prev">Newer posts</a>
            </li>
            <li class="next">
                <a href="index-4.html" rel="next">Older posts</a>
            </li>
        </ul></nav><script>var disqus_shortname="nicoguaro-github";(function(){var a=document.createElement("script");a.async=true;a.src="https://"+disqus_shortname+".disqus.com/count.js";(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(a)}());</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML" integrity="sha256-SDRP1VVYu+tgAGKhddBSl5+ezofHKZeI+OzxakbIe/Y=" crossorigin="anonymous"></script><script type="text/x-mathjax-config">
        MathJax.Hub.Config({tex2jax: {inlineMath: [['$latex ','$'], ['\\(','\\)']]}});
        </script><footer id="footer"><p>Contents © 2021 <a href="mailto:nicoguarin@gmail.com">Nicolás Guarín-Zapata</a> - Powered by <a href="https://getnikola.com" rel="nofollow">Nikola</a> 
<a rel="license" href="http://creativecommons.org/licenses/by/4.0/">
<img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by/4.0/88x31.png"></a></p>
            
        </footer>
</div>
    </div>
    <label for="sidebar-checkbox" class="sidebar-toggle"></label>
    
<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-145359674-1', 'auto');
ga('send', 'pageview');
</script><script src="assets/js/all-nocdn.js"></script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates -->
</body>
</html>
