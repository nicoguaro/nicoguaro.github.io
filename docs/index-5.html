<!DOCTYPE html>
<html prefix="" lang="en">
<head>
<meta charset="utf-8">
<meta name="description" content="Personal blog and website">
<meta name="viewport" content="width=device-width">
<title>Nicolás' blog (old posts, page 5) | Nicolás' blog</title>
<link href="assets/css/all.css" rel="stylesheet" type="text/css">
<link rel="stylesheet" href="//fonts.googleapis.com/css?family=PT+Serif:400,400italic,700|PT+Sans:400">
<link rel="alternate" type="application/rss+xml" title="RSS (en)" href="rss.xml">
<link rel="alternate" type="application/rss+xml" title="RSS (es)" href="es/rss.xml">
<link rel="canonical" href="https://nicoguaro.github.io/index-5.html">
<link rel="prev" href="." type="text/html">
<link rel="next" href="index-4.html" type="text/html">
<!--[if lt IE 9]><script src="assets/js/html5.js"></script><![endif]-->
</head>
<body>
    <a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>
    <!-- Target for toggling the sidebar `.sidebar-checkbox` is for regular
            styles, `#sidebar-checkbox` for behavior. -->
    <input type="checkbox" class="sidebar-checkbox" id="sidebar-checkbox"><!-- Toggleable sidebar --><div class="sidebar" id="sidebar">
        <div class="sidebar-item">
            <p>A reserved <a href="https://getnikola.com" target="_blank">Nikola</a> theme that places the utmost gravity on content with a hidden drawer. Made by <a href="https://twitter.com/mdo" target="_blank">@mdo</a> for Jekyll,
            ported to Nikola by <a href="https://twitter.com/ralsina" target="_blank">@ralsina</a>.</p>
        </div>
        
    <nav id="menu" role="navigation" class="sidebar-nav"><a class="sidebar-nav-item" href="pages/about/">About</a>
        <a class="sidebar-nav-item" href="index.html">Blog</a>
        <a class="sidebar-nav-item" href="pages/preprints-archive/">Preprints</a>
        <a class="sidebar-nav-item" href="pages/links/">Links</a>
        <a class="sidebar-nav-item" href="archive.html">Archives</a>
        <a class="sidebar-nav-item" href="categories/">Tags</a>
        <a class="sidebar-nav-item" href="rss.xml">RSS feed</a>
    
    
    </nav>
</div>

    <!-- Wrap is the content to shift when toggling the sidebar. We wrap the
         content to avoid any CSS collisions with our real content. -->
    <div class="wrap">
      <div class="masthead">
        <div class="container">
          
    <h3 id="brand" class="masthead-title">
      <a href="https://nicoguaro.github.io/" title="Nicolás' blog" rel="home">Nicolás' blog</a>
    </h3>

        </div>
      </div>

      <div class="container content" id="content">
        

<div class="posts">
    <article class="post h-entry post-text"><header><h1 class="post-title p-name"><a href="posts/ortografia_jupyter/" class="u-url">Spell Check in Jupyter Notebook</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn">Nicolás Guarín-Zapata</span></p>
            <p class="dateline"><a href="posts/ortografia_jupyter/" rel="bookmark"><time class="post-date published dt-published" datetime="2019-08-20T14:45:41-05:00" title="2019-08-20 14:45">2019-08-20 14:45</time></a></p>
                <p class="commentline">
    
    <a href="posts/ortografia_jupyter/#disqus_thread" data-disqus-identifier="cache/posts/ortografia_jupyter.html">Comments</a>


        </p>
</div>
    </header><div class="e-content entry-content">
    <p>The purpose of this post is to show how to have automatic spell check in
Jupyter Notebook, as shown below.</p>
<img alt="Example of spell checking in Jupyter Notebook." class="align-center" src="images/ortografia_jupyter/ejemplo_ortografia.png" style="width: 600px;"><p>There are <a class="reference external" href="https://stackoverflow.com/q/39324039/3358223">several ways</a>
to do this. However, the easiest way is through the (<em>nbextension</em>)
<a class="reference external" href="posts/ortografia_jupyter/&lt;https:/jupyter-contrib-nbextensions.readthedocs.io/en/latest/nbextensions/spellchecker/README.html">Spellchecker</a>. plugin.</p>
<section id="step-by-step"><h2>Step by step</h2>
<p>The steps to follow are those:</p>
<ol class="arabic simple">
<li><p>Install Jupyter notebook extensions (<a class="reference external" href="https://github.com/ipython-contrib/jupyter_contrib_nbextensions">nbextensions</a>). This includes
<a class="reference external" href="posts/ortografia_jupyter/&lt;https:/jupyter-contrib-nbextensions.readthedocs.io/en/latest/nbextensions/spellchecker/README.html">Spellchecker</a>.</p></li>
<li><p>Locate the dictionaries in the folder where the plugin is. Dictionaries
must use UTF-8 encoding.</p></li>
<li><p>Configure the path of the dictionaries. This can be a URL or a path
relative to the folder where the plugin is located.</p></li>
</ol>
<p>We will describe each step in detail below.</p>
<section id="step-1-install-nbextensions"><h3>Step 1: Install nbextensions</h3>
<p>There is a list of plugins that add some commonly used functionality to
the Jupyter notebook.</p>
<p>Type the following in a terminal, to install it using PIP.</p>
<div class="code"><pre class="code bash"><a id="rest_code_7286b06d5dc74b2aab7bec68086e634a-1" name="rest_code_7286b06d5dc74b2aab7bec68086e634a-1" href="posts/ortografia_jupyter/#rest_code_7286b06d5dc74b2aab7bec68086e634a-1"></a>pip<span class="w"> </span>install<span class="w"> </span>jupyter_contrib_nbextensions
</pre></div>
<p>However, if Anaconda is being used the <strong>recommended method</strong> is to use
<code class="docutils literal">conda</code>, as shown below.</p>
<div class="code"><pre class="code bash"><a id="rest_code_613aa60deee248018dec7368f063ccec-1" name="rest_code_613aa60deee248018dec7368f063ccec-1" href="posts/ortografia_jupyter/#rest_code_613aa60deee248018dec7368f063ccec-1"></a>conda<span class="w"> </span>install<span class="w"> </span>-c<span class="w"> </span>conda-forge<span class="w"> </span>jupyter_contrib_nbextensions
</pre></div>
<p>This should install the plugins and also the
<a class="reference external" href="https://github.com/Jupyter-contrib/jupyter_nbextensions_configurator">configuration interface</a>.
In the main menu of Jupyter notebook a new tab named <em>Nbextension</em> will
appear. Here you can choose the add-ons to use. The appearance is
as follows.</p>
<img alt="Graphical interface for Jupyter plugins." class="align-center" src="images/ortografia_jupyter/interfaz_nbextensions.png" style="width: 600px;"><p>Some recommended plugins are:</p>
<ul class="simple">
<li><p><strong>Collapsible Headings:</strong> that allows to hide sections of the documents.</p></li>
<li><p><strong>RISE:</strong> that turns notebooks into presentations.</p></li>
</ul></section><section id="step-2-dictionaries-for-spanish"><h3>Step 2: Dictionaries for Spanish</h3>
<p>The documentation of <a class="reference external" href="posts/ortografia_jupyter/&lt;https:/jupyter-contrib-nbextensions.readthedocs.io/en/latest/nbextensions/spellchecker/README.html">Spellchecker</a> suggests using a Python script to
download dictionaries from project <a class="reference external" href="https://chromium.googlesource.com/chromium/deps/hunspell_dictionaries/+/master">Chromium</a>.
However, these are encoded in  ISO-8859-1 (western) and it fails
for characters with accents or tildes. So, to avoid problems the
dictionary must be <a class="reference external" href="https://en.wikipedia.org/wiki/UTF-8">UTF-8</a>.
They can be downloaded at <a class="reference external" href="downloads/dict_es_ES.zip">this link</a>.</p>
<p>Once you have the dictionaries, they must be located in the path of the
plugin. On my computer this would be</p>
<div class="code"><pre class="code text"><a id="rest_code_597e1023e0aa48028768baf32175c613-1" name="rest_code_597e1023e0aa48028768baf32175c613-1" href="posts/ortografia_jupyter/#rest_code_597e1023e0aa48028768baf32175c613-1"></a>~/.local/share/jupyter/nbextensions/spellchecker/
</pre></div>
<p>and within this we will place them in</p>
<div class="code"><pre class="code text"><a id="rest_code_cc13977993ef4cfa8c0013b1e2e1a1f0-1" name="rest_code_cc13977993ef4cfa8c0013b1e2e1a1f0-1" href="posts/ortografia_jupyter/#rest_code_cc13977993ef4cfa8c0013b1e2e1a1f0-1"></a>~/.local/share/jupyter/nbextensions/spellchecker/typo/dictionaries
</pre></div>
<p>This location is arbitrary, the important thing is that we need to know
the relative path to the plugin.</p>
</section><section id="step-3-plugin-configuration"><h3>Step 3: Plugin Configuration</h3>
<p>Now, in the <em>Nbextensions</em> tab we select the plugin and fill the fields
with the information from our dictionary:</p>
<ul class="simple">
<li><p>language code to use with typo.js: <code class="docutils literal">es_ES</code></p></li>
<li><p>url for the dictionary .dic file to use: <code class="docutils literal">./typo/dictionaries/es_ES.dic</code></p></li>
<li><p>url for the dictionary .aff file to use: <code class="docutils literal">./typo/dictionaries/es_ES.aff</code></p></li>
</ul>
<p>This is shown below.</p>
<img alt="Configuration with local files." class="align-center" src="images/ortografia_jupyter/config_local.png" style="width: 600px;"><p>Another option is to use the URL for the files. The dictionaries of the
project <a class="reference external" href="https://hunspell.github.io/">hunspell</a> in UTF-8 are available
at <a class="reference external" href="https://github.com/wooorm/dictionaries">https://github.com/wooorm/dictionaries</a>. In this case, the configuration
would be:</p>
<ul class="simple">
<li><p>language code to use with typo.js: <code class="docutils literal">es_ES</code></p></li>
<li><p>url for the dictionary .dic file to use: <code class="docutils literal"><span class="pre">https://raw.githubusercontent.com/wooorm/dictionaries/master/dictionaries/es/index.dic</span></code></p></li>
<li><p>url for the dictionary .aff file to use: <code class="docutils literal"><span class="pre">https://raw.githubusercontent.com/wooorm/dictionaries/master/dictionaries/es/index.aff</span></code></p></li>
</ul>
<p>And it is shown below.</p>
<img alt="Configuration with remote files." class="align-center" src="images/ortografia_jupyter/config_url.png" style="width: 600px;"></section></section>
</div>
    </article><article class="post h-entry post-text"><header><h1 class="post-title p-name"><a href="posts/graph_makeover/" class="u-url">#SWDchallenge: Graph makeover</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn">Nicolás Guarín-Zapata</span></p>
            <p class="dateline"><a href="posts/graph_makeover/" rel="bookmark"><time class="post-date published dt-published" datetime="2018-07-12T18:32:40-05:00" title="2018-07-12 18:32">2018-07-12 18:32</time></a></p>
                <p class="commentline">
    
    <a href="posts/graph_makeover/#disqus_thread" data-disqus-identifier="cache/posts/graph_makeover.html">Comments</a>


        </p>
</div>
    </header><div class="e-content entry-content">
    <p>At <a class="reference external" href="http://www.storytellingwithdata.com/">storytelling with data</a>, they run
a monthly challenge on data visualization named
<a class="reference external" href="http://www.storytellingwithdata.com/swdchallenge/">#SWDchallenge</a>. The main
idea of the challenges is to test data visualization and
storytelling skills.</p>
<p>Each month the challenge has a different topic. This
<a class="reference external" href="http://www.storytellingwithdata.com/blog/2018/7/1/swdchallenge-your-choice-makeover">month</a>
the challenge was to improve an existing graph. I decided to take a previous
graph of mine that was published on a
<a class="reference external" href="https://www.sciencedirect.com/science/article/pii/S1742706115002172">paper</a>
that was published on 2015.</p>
<section id="the-original"><h2>The "original"</h2>
<p>The following is the graph that we are going to start with.</p>
<img alt="Original plot" class="align-center" src="images/graph_makeover/energy_vs_D_orig.svg" style="width: 600px;"><p>This is not the exact same graph that was presented in the article on 2015, but
it serves the purpose of the challenge. The data can be downloaded from
<a class="reference external" href="downloads/Energy_vs_D.csv">here</a>. This graph present the fraction of energy (<span class="math">\(\eta\)</span>) transmitted for helical composites
with different geometrical parameters. The parameters varied were:</p>
<ul class="simple">
<li><p>Pitch angle <span class="math">\(\alpha\)</span>: the angle between consecutive layers;</p></li>
<li><p>Composite thickness <span class="math">\(D\)</span>, that is normalized to the wavelength <span class="math">\(\lambda\)</span>; and</p></li>
<li><p>Number of layers <span class="math">\(N\)</span> in each cell of the composite.</p></li>
</ul>
<p>The following schematic illustrate these parameters.</p>
<img alt="Composites" class="align-center" src="images/graph_makeover/coordinates_and_cells.png" style="width: 600px;"><p>I would not say that the graph is awful, and, in comparison to what you would
find in most scientific literature it is even good. But … in the land of the
blind, the one-eyed is king. So, let's enumerate what are the <em>sins</em> of the
plot and see if we can correct them:</p>
<ul class="simple">
<li><p>It has two x axes.</p></li>
<li><p>The legend is enclosed in a box that seems unnecessary.</p></li>
<li><p>Right and top spines are not contributing to the plot.</p></li>
<li><p>Annotations are stealing protagonism from the data.</p></li>
<li><p>It looks clutterd with lines and markers.</p></li>
<li><p>It is a <a class="reference external" href="http://www.storytellingwithdata.com/blog/2013/03/avoiding-spaghetti-graph">spaghetti graph</a>.</p></li>
</ul>
<p>The following snippet generates this graph.</p>
<div class="code"><pre class="code python"><a id="rest_code_79182cb5bba74352869e044b96caee22-1" name="rest_code_79182cb5bba74352869e044b96caee22-1" href="posts/graph_makeover/#rest_code_79182cb5bba74352869e044b96caee22-1"></a><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<a id="rest_code_79182cb5bba74352869e044b96caee22-2" name="rest_code_79182cb5bba74352869e044b96caee22-2" href="posts/graph_makeover/#rest_code_79182cb5bba74352869e044b96caee22-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">matplotlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<a id="rest_code_79182cb5bba74352869e044b96caee22-3" name="rest_code_79182cb5bba74352869e044b96caee22-3" href="posts/graph_makeover/#rest_code_79182cb5bba74352869e044b96caee22-3"></a><span class="kn">from</span><span class="w"> </span><span class="nn">matplotlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">rcParams</span>
<a id="rest_code_79182cb5bba74352869e044b96caee22-4" name="rest_code_79182cb5bba74352869e044b96caee22-4" href="posts/graph_makeover/#rest_code_79182cb5bba74352869e044b96caee22-4"></a>
<a id="rest_code_79182cb5bba74352869e044b96caee22-5" name="rest_code_79182cb5bba74352869e044b96caee22-5" href="posts/graph_makeover/#rest_code_79182cb5bba74352869e044b96caee22-5"></a><span class="n">rcParams</span><span class="p">[</span><span class="s1">'font.family'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'serif'</span>
<a id="rest_code_79182cb5bba74352869e044b96caee22-6" name="rest_code_79182cb5bba74352869e044b96caee22-6" href="posts/graph_makeover/#rest_code_79182cb5bba74352869e044b96caee22-6"></a><span class="n">rcParams</span><span class="p">[</span><span class="s1">'font.size'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">16</span>
<a id="rest_code_79182cb5bba74352869e044b96caee22-7" name="rest_code_79182cb5bba74352869e044b96caee22-7" href="posts/graph_makeover/#rest_code_79182cb5bba74352869e044b96caee22-7"></a><span class="n">rcParams</span><span class="p">[</span><span class="s1">'legend.fontsize'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">15</span>
<a id="rest_code_79182cb5bba74352869e044b96caee22-8" name="rest_code_79182cb5bba74352869e044b96caee22-8" href="posts/graph_makeover/#rest_code_79182cb5bba74352869e044b96caee22-8"></a><span class="n">rcParams</span><span class="p">[</span><span class="s1">'mathtext.fontset'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'cm'</span>
<a id="rest_code_79182cb5bba74352869e044b96caee22-9" name="rest_code_79182cb5bba74352869e044b96caee22-9" href="posts/graph_makeover/#rest_code_79182cb5bba74352869e044b96caee22-9"></a>
<a id="rest_code_79182cb5bba74352869e044b96caee22-10" name="rest_code_79182cb5bba74352869e044b96caee22-10" href="posts/graph_makeover/#rest_code_79182cb5bba74352869e044b96caee22-10"></a><span class="n">markers</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'o'</span><span class="p">,</span> <span class="s1">'^'</span><span class="p">,</span> <span class="s1">'v'</span><span class="p">,</span> <span class="s1">'s'</span><span class="p">,</span> <span class="s1">'&lt;'</span><span class="p">,</span> <span class="s1">'&gt;'</span><span class="p">,</span> <span class="s1">'d'</span><span class="p">,</span> <span class="s1">'*'</span><span class="p">,</span> <span class="s1">'x'</span><span class="p">,</span> <span class="s1">'D'</span><span class="p">,</span> <span class="s1">'+'</span><span class="p">,</span> <span class="s1">'H'</span><span class="p">]</span>
<a id="rest_code_79182cb5bba74352869e044b96caee22-11" name="rest_code_79182cb5bba74352869e044b96caee22-11" href="posts/graph_makeover/#rest_code_79182cb5bba74352869e044b96caee22-11"></a><span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="s2">"Energy_vs_D.csv"</span><span class="p">,</span> <span class="n">skiprows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s2">","</span><span class="p">)</span>
<a id="rest_code_79182cb5bba74352869e044b96caee22-12" name="rest_code_79182cb5bba74352869e044b96caee22-12" href="posts/graph_makeover/#rest_code_79182cb5bba74352869e044b96caee22-12"></a><span class="n">labels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="s2">"Energy_vs_D.csv"</span><span class="p">,</span> <span class="n">skiprows</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s2">","</span><span class="p">,</span>
<a id="rest_code_79182cb5bba74352869e044b96caee22-13" name="rest_code_79182cb5bba74352869e044b96caee22-13" href="posts/graph_makeover/#rest_code_79182cb5bba74352869e044b96caee22-13"></a>                    <span class="n">usecols</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">9</span><span class="p">))</span>
<a id="rest_code_79182cb5bba74352869e044b96caee22-14" name="rest_code_79182cb5bba74352869e044b96caee22-14" href="posts/graph_makeover/#rest_code_79182cb5bba74352869e044b96caee22-14"></a><span class="n">labels</span> <span class="o">=</span> <span class="n">labels</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:]</span>
<a id="rest_code_79182cb5bba74352869e044b96caee22-15" name="rest_code_79182cb5bba74352869e044b96caee22-15" href="posts/graph_makeover/#rest_code_79182cb5bba74352869e044b96caee22-15"></a>
<a id="rest_code_79182cb5bba74352869e044b96caee22-16" name="rest_code_79182cb5bba74352869e044b96caee22-16" href="posts/graph_makeover/#rest_code_79182cb5bba74352869e044b96caee22-16"></a><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<a id="rest_code_79182cb5bba74352869e044b96caee22-17" name="rest_code_79182cb5bba74352869e044b96caee22-17" href="posts/graph_makeover/#rest_code_79182cb5bba74352869e044b96caee22-17"></a><span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>
<a id="rest_code_79182cb5bba74352869e044b96caee22-18" name="rest_code_79182cb5bba74352869e044b96caee22-18" href="posts/graph_makeover/#rest_code_79182cb5bba74352869e044b96caee22-18"></a><span class="k">for</span> <span class="n">cont</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">8</span><span class="p">):</span>
<a id="rest_code_79182cb5bba74352869e044b96caee22-19" name="rest_code_79182cb5bba74352869e044b96caee22-19" href="posts/graph_makeover/#rest_code_79182cb5bba74352869e044b96caee22-19"></a>    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">data</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">data</span><span class="p">[:,</span> <span class="n">cont</span> <span class="o">+</span> <span class="mi">1</span><span class="p">],</span> <span class="n">marker</span><span class="o">=</span><span class="n">markers</span><span class="p">[</span><span class="n">cont</span><span class="p">],</span>
<a id="rest_code_79182cb5bba74352869e044b96caee22-20" name="rest_code_79182cb5bba74352869e044b96caee22-20" href="posts/graph_makeover/#rest_code_79182cb5bba74352869e044b96caee22-20"></a>             <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s2">"$D/\lambda=</span><span class="si">{:.3g}</span><span class="s2">$"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">labels</span><span class="p">[</span><span class="n">cont</span><span class="p">]))</span>
<a id="rest_code_79182cb5bba74352869e044b96caee22-21" name="rest_code_79182cb5bba74352869e044b96caee22-21" href="posts/graph_makeover/#rest_code_79182cb5bba74352869e044b96caee22-21"></a>
<a id="rest_code_79182cb5bba74352869e044b96caee22-22" name="rest_code_79182cb5bba74352869e044b96caee22-22" href="posts/graph_makeover/#rest_code_79182cb5bba74352869e044b96caee22-22"></a><span class="c1"># First x-axis</span>
<a id="rest_code_79182cb5bba74352869e044b96caee22-23" name="rest_code_79182cb5bba74352869e044b96caee22-23" href="posts/graph_makeover/#rest_code_79182cb5bba74352869e044b96caee22-23"></a><span class="n">xticks</span><span class="p">,</span> <span class="n">xlabels</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">()</span>
<a id="rest_code_79182cb5bba74352869e044b96caee22-24" name="rest_code_79182cb5bba74352869e044b96caee22-24" href="posts/graph_makeover/#rest_code_79182cb5bba74352869e044b96caee22-24"></a><span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">"Number of layers - $N$"</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<a id="rest_code_79182cb5bba74352869e044b96caee22-25" name="rest_code_79182cb5bba74352869e044b96caee22-25" href="posts/graph_makeover/#rest_code_79182cb5bba74352869e044b96caee22-25"></a><span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">"Fraction of Energy - $\eta$"</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<a id="rest_code_79182cb5bba74352869e044b96caee22-26" name="rest_code_79182cb5bba74352869e044b96caee22-26" href="posts/graph_makeover/#rest_code_79182cb5bba74352869e044b96caee22-26"></a><span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">'center left'</span><span class="p">,</span> <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">))</span>
<a id="rest_code_79182cb5bba74352869e044b96caee22-27" name="rest_code_79182cb5bba74352869e044b96caee22-27" href="posts/graph_makeover/#rest_code_79182cb5bba74352869e044b96caee22-27"></a>
<a id="rest_code_79182cb5bba74352869e044b96caee22-28" name="rest_code_79182cb5bba74352869e044b96caee22-28" href="posts/graph_makeover/#rest_code_79182cb5bba74352869e044b96caee22-28"></a><span class="c1"># Second x-axis</span>
<a id="rest_code_79182cb5bba74352869e044b96caee22-29" name="rest_code_79182cb5bba74352869e044b96caee22-29" href="posts/graph_makeover/#rest_code_79182cb5bba74352869e044b96caee22-29"></a><span class="n">ax2</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">twiny</span><span class="p">()</span>
<a id="rest_code_79182cb5bba74352869e044b96caee22-30" name="rest_code_79182cb5bba74352869e044b96caee22-30" href="posts/graph_makeover/#rest_code_79182cb5bba74352869e044b96caee22-30"></a><span class="n">ax2</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">xticks</span><span class="p">[</span><span class="mi">2</span><span class="p">:])</span>
<a id="rest_code_79182cb5bba74352869e044b96caee22-31" name="rest_code_79182cb5bba74352869e044b96caee22-31" href="posts/graph_makeover/#rest_code_79182cb5bba74352869e044b96caee22-31"></a><span class="n">ax2</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="mf">180.</span><span class="o">/</span><span class="n">xticks</span><span class="p">[</span><span class="mi">2</span><span class="p">:])</span>
<a id="rest_code_79182cb5bba74352869e044b96caee22-32" name="rest_code_79182cb5bba74352869e044b96caee22-32" href="posts/graph_makeover/#rest_code_79182cb5bba74352869e044b96caee22-32"></a><span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">"Angle - $\alpha\ (^\circ)$"</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<a id="rest_code_79182cb5bba74352869e044b96caee22-33" name="rest_code_79182cb5bba74352869e044b96caee22-33" href="posts/graph_makeover/#rest_code_79182cb5bba74352869e044b96caee22-33"></a>
<a id="rest_code_79182cb5bba74352869e044b96caee22-34" name="rest_code_79182cb5bba74352869e044b96caee22-34" href="posts/graph_makeover/#rest_code_79182cb5bba74352869e044b96caee22-34"></a><span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<a id="rest_code_79182cb5bba74352869e044b96caee22-35" name="rest_code_79182cb5bba74352869e044b96caee22-35" href="posts/graph_makeover/#rest_code_79182cb5bba74352869e044b96caee22-35"></a><span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">"energy_vs_D_orig.svg"</span><span class="p">)</span>
<a id="rest_code_79182cb5bba74352869e044b96caee22-36" name="rest_code_79182cb5bba74352869e044b96caee22-36" href="posts/graph_makeover/#rest_code_79182cb5bba74352869e044b96caee22-36"></a><span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">"energy_vs_D_orig.png"</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>
</pre></div>
</section><section id="corrections"><h2>Corrections</h2>
<p>I will vindicate the graph one <em>sin</em> at a time, let's see how it turns out.</p>
<section id="it-has-two-x-axes"><h3>It has two x axes</h3>
<p>I, originally, added two axes to show both the number of layers
and the angle between them at the same time. The general recommendation is
to avoid this, so let's get rid of the top one.</p>
<img alt="First iteration" class="align-center" src="images/graph_makeover/energy_vs_D_1.svg" style="width: 600px;"></section><section id="legend-in-a-box"><h3>Legend in a box</h3>
<p>Pretty straightforward …</p>
<img alt="Second iteration" class="align-center" src="images/graph_makeover/energy_vs_D_2.svg" style="width: 600px;"></section><section id="right-and-top-spines"><h3>Right and top spines</h3>
<p>Let's remove them</p>
<img alt="Third iteration" class="align-center" src="images/graph_makeover/energy_vs_D_3.svg" style="width: 600px;"></section><section id="annotations-are-stealing-protagonism"><h3>Annotations are stealing protagonism</h3>
<p>Let's move all the annotations to the background by changing the color
to a lighter gray.</p>
<img alt="Fourth iteration" class="align-center" src="images/graph_makeover/energy_vs_D_4.svg" style="width: 600px;"></section><section id="clutterd-with-lines-and-markers"><h3>Clutterd with lines and markers</h3>
<p>Let's just keep the lines.</p>
<img alt="Fifth iteration" class="align-center" src="images/graph_makeover/energy_vs_D_5.svg" style="width: 600px;"><p>And increase the linewidth.</p>
<img alt="Sixth iteration" class="align-center" src="images/graph_makeover/energy_vs_D_6.svg" style="width: 600px;"></section><section id="it-is-a-spaghetti-graph"><h3>It is a spaghetti graph</h3>
<p>I think that a good option for this graph would be to highlight
one line at a time. Doing this, we end up with.</p>
<img alt="Seventh iteration" class="align-center" src="images/graph_makeover/energy_vs_D_7.svg" style="width: 600px;"><p>The following snippet generates this version.</p>
<div class="code"><pre class="code python"><a id="rest_code_54e0c80c9a1b46a8a6f14d53e0bbd744-1" name="rest_code_54e0c80c9a1b46a8a6f14d53e0bbd744-1" href="posts/graph_makeover/#rest_code_54e0c80c9a1b46a8a6f14d53e0bbd744-1"></a><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<a id="rest_code_54e0c80c9a1b46a8a6f14d53e0bbd744-2" name="rest_code_54e0c80c9a1b46a8a6f14d53e0bbd744-2" href="posts/graph_makeover/#rest_code_54e0c80c9a1b46a8a6f14d53e0bbd744-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">matplotlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<a id="rest_code_54e0c80c9a1b46a8a6f14d53e0bbd744-3" name="rest_code_54e0c80c9a1b46a8a6f14d53e0bbd744-3" href="posts/graph_makeover/#rest_code_54e0c80c9a1b46a8a6f14d53e0bbd744-3"></a><span class="kn">from</span><span class="w"> </span><span class="nn">matplotlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">rcParams</span>
<a id="rest_code_54e0c80c9a1b46a8a6f14d53e0bbd744-4" name="rest_code_54e0c80c9a1b46a8a6f14d53e0bbd744-4" href="posts/graph_makeover/#rest_code_54e0c80c9a1b46a8a6f14d53e0bbd744-4"></a>
<a id="rest_code_54e0c80c9a1b46a8a6f14d53e0bbd744-5" name="rest_code_54e0c80c9a1b46a8a6f14d53e0bbd744-5" href="posts/graph_makeover/#rest_code_54e0c80c9a1b46a8a6f14d53e0bbd744-5"></a><span class="c1"># Plots setup</span>
<a id="rest_code_54e0c80c9a1b46a8a6f14d53e0bbd744-6" name="rest_code_54e0c80c9a1b46a8a6f14d53e0bbd744-6" href="posts/graph_makeover/#rest_code_54e0c80c9a1b46a8a6f14d53e0bbd744-6"></a><span class="n">gray</span> <span class="o">=</span> <span class="s1">'#757575'</span>
<a id="rest_code_54e0c80c9a1b46a8a6f14d53e0bbd744-7" name="rest_code_54e0c80c9a1b46a8a6f14d53e0bbd744-7" href="posts/graph_makeover/#rest_code_54e0c80c9a1b46a8a6f14d53e0bbd744-7"></a><span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s2">"mathtext.fontset"</span><span class="p">]</span> <span class="o">=</span> <span class="s2">"cm"</span>
<a id="rest_code_54e0c80c9a1b46a8a6f14d53e0bbd744-8" name="rest_code_54e0c80c9a1b46a8a6f14d53e0bbd744-8" href="posts/graph_makeover/#rest_code_54e0c80c9a1b46a8a6f14d53e0bbd744-8"></a><span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s2">"text.color"</span><span class="p">]</span> <span class="o">=</span> <span class="n">gray</span>
<a id="rest_code_54e0c80c9a1b46a8a6f14d53e0bbd744-9" name="rest_code_54e0c80c9a1b46a8a6f14d53e0bbd744-9" href="posts/graph_makeover/#rest_code_54e0c80c9a1b46a8a6f14d53e0bbd744-9"></a><span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s2">"xtick.color"</span><span class="p">]</span> <span class="o">=</span> <span class="n">gray</span>
<a id="rest_code_54e0c80c9a1b46a8a6f14d53e0bbd744-10" name="rest_code_54e0c80c9a1b46a8a6f14d53e0bbd744-10" href="posts/graph_makeover/#rest_code_54e0c80c9a1b46a8a6f14d53e0bbd744-10"></a><span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s2">"ytick.color"</span><span class="p">]</span> <span class="o">=</span> <span class="n">gray</span>
<a id="rest_code_54e0c80c9a1b46a8a6f14d53e0bbd744-11" name="rest_code_54e0c80c9a1b46a8a6f14d53e0bbd744-11" href="posts/graph_makeover/#rest_code_54e0c80c9a1b46a8a6f14d53e0bbd744-11"></a><span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s2">"axes.labelcolor"</span><span class="p">]</span> <span class="o">=</span> <span class="n">gray</span>
<a id="rest_code_54e0c80c9a1b46a8a6f14d53e0bbd744-12" name="rest_code_54e0c80c9a1b46a8a6f14d53e0bbd744-12" href="posts/graph_makeover/#rest_code_54e0c80c9a1b46a8a6f14d53e0bbd744-12"></a><span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s2">"axes.edgecolor"</span><span class="p">]</span> <span class="o">=</span> <span class="n">gray</span>
<a id="rest_code_54e0c80c9a1b46a8a6f14d53e0bbd744-13" name="rest_code_54e0c80c9a1b46a8a6f14d53e0bbd744-13" href="posts/graph_makeover/#rest_code_54e0c80c9a1b46a8a6f14d53e0bbd744-13"></a><span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s2">"axes.spines.right"</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
<a id="rest_code_54e0c80c9a1b46a8a6f14d53e0bbd744-14" name="rest_code_54e0c80c9a1b46a8a6f14d53e0bbd744-14" href="posts/graph_makeover/#rest_code_54e0c80c9a1b46a8a6f14d53e0bbd744-14"></a><span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s2">"axes.spines.top"</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
<a id="rest_code_54e0c80c9a1b46a8a6f14d53e0bbd744-15" name="rest_code_54e0c80c9a1b46a8a6f14d53e0bbd744-15" href="posts/graph_makeover/#rest_code_54e0c80c9a1b46a8a6f14d53e0bbd744-15"></a><span class="n">rcParams</span><span class="p">[</span><span class="s1">'font.family'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'serif'</span>
<a id="rest_code_54e0c80c9a1b46a8a6f14d53e0bbd744-16" name="rest_code_54e0c80c9a1b46a8a6f14d53e0bbd744-16" href="posts/graph_makeover/#rest_code_54e0c80c9a1b46a8a6f14d53e0bbd744-16"></a><span class="n">rcParams</span><span class="p">[</span><span class="s1">'mathtext.fontset'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'cm'</span>
<a id="rest_code_54e0c80c9a1b46a8a6f14d53e0bbd744-17" name="rest_code_54e0c80c9a1b46a8a6f14d53e0bbd744-17" href="posts/graph_makeover/#rest_code_54e0c80c9a1b46a8a6f14d53e0bbd744-17"></a>
<a id="rest_code_54e0c80c9a1b46a8a6f14d53e0bbd744-18" name="rest_code_54e0c80c9a1b46a8a6f14d53e0bbd744-18" href="posts/graph_makeover/#rest_code_54e0c80c9a1b46a8a6f14d53e0bbd744-18"></a>
<a id="rest_code_54e0c80c9a1b46a8a6f14d53e0bbd744-19" name="rest_code_54e0c80c9a1b46a8a6f14d53e0bbd744-19" href="posts/graph_makeover/#rest_code_54e0c80c9a1b46a8a6f14d53e0bbd744-19"></a>
<a id="rest_code_54e0c80c9a1b46a8a6f14d53e0bbd744-20" name="rest_code_54e0c80c9a1b46a8a6f14d53e0bbd744-20" href="posts/graph_makeover/#rest_code_54e0c80c9a1b46a8a6f14d53e0bbd744-20"></a><span class="k">def</span><span class="w"> </span><span class="nf">line_plots</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">highlight_line</span><span class="p">,</span> <span class="n">title</span><span class="p">):</span>
<a id="rest_code_54e0c80c9a1b46a8a6f14d53e0bbd744-21" name="rest_code_54e0c80c9a1b46a8a6f14d53e0bbd744-21" href="posts/graph_makeover/#rest_code_54e0c80c9a1b46a8a6f14d53e0bbd744-21"></a>    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
<a id="rest_code_54e0c80c9a1b46a8a6f14d53e0bbd744-22" name="rest_code_54e0c80c9a1b46a8a6f14d53e0bbd744-22" href="posts/graph_makeover/#rest_code_54e0c80c9a1b46a8a6f14d53e0bbd744-22"></a>    <span class="k">for</span> <span class="n">cont</span><span class="p">,</span> <span class="n">datum</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">data</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">:]</span><span class="o">.</span><span class="n">T</span><span class="p">):</span>
<a id="rest_code_54e0c80c9a1b46a8a6f14d53e0bbd744-23" name="rest_code_54e0c80c9a1b46a8a6f14d53e0bbd744-23" href="posts/graph_makeover/#rest_code_54e0c80c9a1b46a8a6f14d53e0bbd744-23"></a>        <span class="k">if</span> <span class="n">cont</span> <span class="o">==</span> <span class="n">highlight_line</span><span class="p">:</span>
<a id="rest_code_54e0c80c9a1b46a8a6f14d53e0bbd744-24" name="rest_code_54e0c80c9a1b46a8a6f14d53e0bbd744-24" href="posts/graph_makeover/#rest_code_54e0c80c9a1b46a8a6f14d53e0bbd744-24"></a>            <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">data</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">datum</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">"#984ea3"</span><span class="p">,</span>
<a id="rest_code_54e0c80c9a1b46a8a6f14d53e0bbd744-25" name="rest_code_54e0c80c9a1b46a8a6f14d53e0bbd744-25" href="posts/graph_makeover/#rest_code_54e0c80c9a1b46a8a6f14d53e0bbd744-25"></a>                     <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<a id="rest_code_54e0c80c9a1b46a8a6f14d53e0bbd744-26" name="rest_code_54e0c80c9a1b46a8a6f14d53e0bbd744-26" href="posts/graph_makeover/#rest_code_54e0c80c9a1b46a8a6f14d53e0bbd744-26"></a>        <span class="k">else</span><span class="p">:</span>
<a id="rest_code_54e0c80c9a1b46a8a6f14d53e0bbd744-27" name="rest_code_54e0c80c9a1b46a8a6f14d53e0bbd744-27" href="posts/graph_makeover/#rest_code_54e0c80c9a1b46a8a6f14d53e0bbd744-27"></a>            <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">data</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">datum</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">gray</span><span class="p">,</span>
<a id="rest_code_54e0c80c9a1b46a8a6f14d53e0bbd744-28" name="rest_code_54e0c80c9a1b46a8a6f14d53e0bbd744-28" href="posts/graph_makeover/#rest_code_54e0c80c9a1b46a8a6f14d53e0bbd744-28"></a>                     <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<a id="rest_code_54e0c80c9a1b46a8a6f14d53e0bbd744-29" name="rest_code_54e0c80c9a1b46a8a6f14d53e0bbd744-29" href="posts/graph_makeover/#rest_code_54e0c80c9a1b46a8a6f14d53e0bbd744-29"></a>
<a id="rest_code_54e0c80c9a1b46a8a6f14d53e0bbd744-30" name="rest_code_54e0c80c9a1b46a8a6f14d53e0bbd744-30" href="posts/graph_makeover/#rest_code_54e0c80c9a1b46a8a6f14d53e0bbd744-30"></a>
<a id="rest_code_54e0c80c9a1b46a8a6f14d53e0bbd744-31" name="rest_code_54e0c80c9a1b46a8a6f14d53e0bbd744-31" href="posts/graph_makeover/#rest_code_54e0c80c9a1b46a8a6f14d53e0bbd744-31"></a><span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="s2">"Energy_vs_D.csv"</span><span class="p">,</span> <span class="n">skiprows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s2">","</span><span class="p">)</span>
<a id="rest_code_54e0c80c9a1b46a8a6f14d53e0bbd744-32" name="rest_code_54e0c80c9a1b46a8a6f14d53e0bbd744-32" href="posts/graph_makeover/#rest_code_54e0c80c9a1b46a8a6f14d53e0bbd744-32"></a><span class="n">labels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="s2">"Energy_vs_D.csv"</span><span class="p">,</span> <span class="n">skiprows</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s2">","</span><span class="p">,</span>
<a id="rest_code_54e0c80c9a1b46a8a6f14d53e0bbd744-33" name="rest_code_54e0c80c9a1b46a8a6f14d53e0bbd744-33" href="posts/graph_makeover/#rest_code_54e0c80c9a1b46a8a6f14d53e0bbd744-33"></a>                    <span class="n">usecols</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">9</span><span class="p">))</span>
<a id="rest_code_54e0c80c9a1b46a8a6f14d53e0bbd744-34" name="rest_code_54e0c80c9a1b46a8a6f14d53e0bbd744-34" href="posts/graph_makeover/#rest_code_54e0c80c9a1b46a8a6f14d53e0bbd744-34"></a><span class="n">labels</span> <span class="o">=</span> <span class="n">labels</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:]</span>
<a id="rest_code_54e0c80c9a1b46a8a6f14d53e0bbd744-35" name="rest_code_54e0c80c9a1b46a8a6f14d53e0bbd744-35" href="posts/graph_makeover/#rest_code_54e0c80c9a1b46a8a6f14d53e0bbd744-35"></a>
<a id="rest_code_54e0c80c9a1b46a8a6f14d53e0bbd744-36" name="rest_code_54e0c80c9a1b46a8a6f14d53e0bbd744-36" href="posts/graph_makeover/#rest_code_54e0c80c9a1b46a8a6f14d53e0bbd744-36"></a><span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="s2">"all"</span><span class="p">)</span>
<a id="rest_code_54e0c80c9a1b46a8a6f14d53e0bbd744-37" name="rest_code_54e0c80c9a1b46a8a6f14d53e0bbd744-37" href="posts/graph_makeover/#rest_code_54e0c80c9a1b46a8a6f14d53e0bbd744-37"></a><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<a id="rest_code_54e0c80c9a1b46a8a6f14d53e0bbd744-38" name="rest_code_54e0c80c9a1b46a8a6f14d53e0bbd744-38" href="posts/graph_makeover/#rest_code_54e0c80c9a1b46a8a6f14d53e0bbd744-38"></a><span class="k">for</span> <span class="n">cont</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">8</span><span class="p">):</span>
<a id="rest_code_54e0c80c9a1b46a8a6f14d53e0bbd744-39" name="rest_code_54e0c80c9a1b46a8a6f14d53e0bbd744-39" href="posts/graph_makeover/#rest_code_54e0c80c9a1b46a8a6f14d53e0bbd744-39"></a>    <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">cont</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<a id="rest_code_54e0c80c9a1b46a8a6f14d53e0bbd744-40" name="rest_code_54e0c80c9a1b46a8a6f14d53e0bbd744-40" href="posts/graph_makeover/#rest_code_54e0c80c9a1b46a8a6f14d53e0bbd744-40"></a>    <span class="n">title</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">"$D/\lambda=</span><span class="si">{:.3g}</span><span class="s2">$"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">labels</span><span class="p">[</span><span class="n">cont</span><span class="p">])</span>
<a id="rest_code_54e0c80c9a1b46a8a6f14d53e0bbd744-41" name="rest_code_54e0c80c9a1b46a8a6f14d53e0bbd744-41" href="posts/graph_makeover/#rest_code_54e0c80c9a1b46a8a6f14d53e0bbd744-41"></a>    <span class="n">line_plots</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">cont</span><span class="p">,</span> <span class="n">title</span><span class="p">)</span>
<a id="rest_code_54e0c80c9a1b46a8a6f14d53e0bbd744-42" name="rest_code_54e0c80c9a1b46a8a6f14d53e0bbd744-42" href="posts/graph_makeover/#rest_code_54e0c80c9a1b46a8a6f14d53e0bbd744-42"></a>    <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mf">0.4</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>
<a id="rest_code_54e0c80c9a1b46a8a6f14d53e0bbd744-43" name="rest_code_54e0c80c9a1b46a8a6f14d53e0bbd744-43" href="posts/graph_makeover/#rest_code_54e0c80c9a1b46a8a6f14d53e0bbd744-43"></a>    <span class="k">if</span> <span class="n">cont</span> <span class="o">&lt;</span> <span class="mi">4</span><span class="p">:</span>
<a id="rest_code_54e0c80c9a1b46a8a6f14d53e0bbd744-44" name="rest_code_54e0c80c9a1b46a8a6f14d53e0bbd744-44" href="posts/graph_makeover/#rest_code_54e0c80c9a1b46a8a6f14d53e0bbd744-44"></a>        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">""</span><span class="p">)</span>
<a id="rest_code_54e0c80c9a1b46a8a6f14d53e0bbd744-45" name="rest_code_54e0c80c9a1b46a8a6f14d53e0bbd744-45" href="posts/graph_makeover/#rest_code_54e0c80c9a1b46a8a6f14d53e0bbd744-45"></a>        <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_ticks</span><span class="p">([])</span>
<a id="rest_code_54e0c80c9a1b46a8a6f14d53e0bbd744-46" name="rest_code_54e0c80c9a1b46a8a6f14d53e0bbd744-46" href="posts/graph_makeover/#rest_code_54e0c80c9a1b46a8a6f14d53e0bbd744-46"></a>        <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s2">"bottom"</span><span class="p">]</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="s2">"none"</span><span class="p">)</span>
<a id="rest_code_54e0c80c9a1b46a8a6f14d53e0bbd744-47" name="rest_code_54e0c80c9a1b46a8a6f14d53e0bbd744-47" href="posts/graph_makeover/#rest_code_54e0c80c9a1b46a8a6f14d53e0bbd744-47"></a>    <span class="k">else</span><span class="p">:</span>
<a id="rest_code_54e0c80c9a1b46a8a6f14d53e0bbd744-48" name="rest_code_54e0c80c9a1b46a8a6f14d53e0bbd744-48" href="posts/graph_makeover/#rest_code_54e0c80c9a1b46a8a6f14d53e0bbd744-48"></a>        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">"Number of layers - $N$"</span><span class="p">)</span>
<a id="rest_code_54e0c80c9a1b46a8a6f14d53e0bbd744-49" name="rest_code_54e0c80c9a1b46a8a6f14d53e0bbd744-49" href="posts/graph_makeover/#rest_code_54e0c80c9a1b46a8a6f14d53e0bbd744-49"></a>    <span class="k">if</span> <span class="n">cont</span> <span class="o">%</span> <span class="mi">4</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
<a id="rest_code_54e0c80c9a1b46a8a6f14d53e0bbd744-50" name="rest_code_54e0c80c9a1b46a8a6f14d53e0bbd744-50" href="posts/graph_makeover/#rest_code_54e0c80c9a1b46a8a6f14d53e0bbd744-50"></a>        <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_ticks</span><span class="p">([])</span>
<a id="rest_code_54e0c80c9a1b46a8a6f14d53e0bbd744-51" name="rest_code_54e0c80c9a1b46a8a6f14d53e0bbd744-51" href="posts/graph_makeover/#rest_code_54e0c80c9a1b46a8a6f14d53e0bbd744-51"></a>        <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s2">"left"</span><span class="p">]</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="s2">"none"</span><span class="p">)</span>
<a id="rest_code_54e0c80c9a1b46a8a6f14d53e0bbd744-52" name="rest_code_54e0c80c9a1b46a8a6f14d53e0bbd744-52" href="posts/graph_makeover/#rest_code_54e0c80c9a1b46a8a6f14d53e0bbd744-52"></a>    <span class="k">else</span><span class="p">:</span>
<a id="rest_code_54e0c80c9a1b46a8a6f14d53e0bbd744-53" name="rest_code_54e0c80c9a1b46a8a6f14d53e0bbd744-53" href="posts/graph_makeover/#rest_code_54e0c80c9a1b46a8a6f14d53e0bbd744-53"></a>        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">"Fraction of Energy - $\eta$"</span><span class="p">)</span>
<a id="rest_code_54e0c80c9a1b46a8a6f14d53e0bbd744-54" name="rest_code_54e0c80c9a1b46a8a6f14d53e0bbd744-54" href="posts/graph_makeover/#rest_code_54e0c80c9a1b46a8a6f14d53e0bbd744-54"></a>
<a id="rest_code_54e0c80c9a1b46a8a6f14d53e0bbd744-55" name="rest_code_54e0c80c9a1b46a8a6f14d53e0bbd744-55" href="posts/graph_makeover/#rest_code_54e0c80c9a1b46a8a6f14d53e0bbd744-55"></a>
<a id="rest_code_54e0c80c9a1b46a8a6f14d53e0bbd744-56" name="rest_code_54e0c80c9a1b46a8a6f14d53e0bbd744-56" href="posts/graph_makeover/#rest_code_54e0c80c9a1b46a8a6f14d53e0bbd744-56"></a><span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<a id="rest_code_54e0c80c9a1b46a8a6f14d53e0bbd744-57" name="rest_code_54e0c80c9a1b46a8a6f14d53e0bbd744-57" href="posts/graph_makeover/#rest_code_54e0c80c9a1b46a8a6f14d53e0bbd744-57"></a><span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">"energy_vs_D_7.svg"</span><span class="p">)</span>
<a id="rest_code_54e0c80c9a1b46a8a6f14d53e0bbd744-58" name="rest_code_54e0c80c9a1b46a8a6f14d53e0bbd744-58" href="posts/graph_makeover/#rest_code_54e0c80c9a1b46a8a6f14d53e0bbd744-58"></a><span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">"energy_vs_D_7.png"</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>
</pre></div>
</section></section><section id="final-tweaks"><h2>Final tweaks</h2>
<p>Using Inkscape I added some final details to get the following version.</p>
<img alt="Final" class="align-center" src="images/graph_makeover/energy_vs_D_final.svg" style="width: 600px;"></section><section id="further-reading"><h2>Further reading</h2>
<ul class="simple">
<li><p>Knaflic, Cole Nussbaumer. <a class="reference external" href="http://www.storytellingwithdata.com/book/">Storytelling with data: A data visualization guide for business professionals</a>.
John Wiley &amp; Sons, 2015.</p></li>
<li><p>Nicolás Guarín-Zapata et al. <a class="reference external" href="https://www.sciencedirect.com/science/article/pii/S1742706115002172">"Shear wave filtering in naturally-occurring Bouligand structures."</a>
Acta biomaterialia 23 (2015): 11-20. Preprint: <a class="reference external" href="https://arxiv.org/pdf/1505.04203.pdf">https://arxiv.org/pdf/1505.04203.pdf</a></p></li>
</ul></section>
</div>
    </article><article class="post h-entry post-text"><header><h1 class="post-title p-name"><a href="posts/isometric_inkscape2/" class="u-url">Isometric graphics in Inkscape: Part 2</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn">Nicolás Guarín-Zapata</span></p>
            <p class="dateline"><a href="posts/isometric_inkscape2/" rel="bookmark"><time class="post-date published dt-published" datetime="2018-05-30T12:40:57-05:00" title="2018-05-30 12:40">2018-05-30 12:40</time></a></p>
                <p class="commentline">
    
    <a href="posts/isometric_inkscape2/#disqus_thread" data-disqus-identifier="cache/posts/isometric_inkscape2.html">Comments</a>


        </p>
</div>
    </header><div class="e-content entry-content">
    <p><a class="reference external" href="posts/isometric_inkscape">Last week</a>  I posted a quick guide on isometric
drawing using <a class="reference external" href="https://inkscape.org/en/">Inkscape</a>. In that post, I
showed how to obtain images that are projected to the faces of an
isometric box.</p>
<p>After my post, I was asked by <a class="reference external" href="https://twitter.com/parresianz">Biswajit Banerjee</a>
on <a class="reference external" href="https://twitter.com/parresianz/status/999787980658126848">Twitter</a> if
I could repeat the process with a more complex example, and he suggested
the following schematic</p>
<img alt="Computing the moment of force in a beam" class="align-center" src="https://upload.wikimedia.org/wikipedia/commons/thumb/6/69/Beam_moment_plain.svg/512px-Beam_moment_plain.svg.png"><p>which, I guess, was created in Inkscape using the "Create 3D Box" option.</p>
<p>In this post, I will:</p>
<ol class="arabic simple">
<li><p>Use the same approach from last week to recreate this schematic</p></li>
<li><p>Suggest my preferred approach for drawing this schematic</p></li>
</ol>
<section id="first-approach"><h2>First approach</h2>
<p>I will repeat the cheatsheet from last week. Keep in mind that Inkscape
treats clockwise rotation as positive. Opposite to common notation in
mathematics.</p>
<img alt="Cheatsheet for isometric schematics in Inkscape" class="align-center" src="images/isometric_inkscape/isometric_instructions.svg" style="width: 500px;"><p>Then, to create a box with desired dimensions we first create each rectangle
with the right dimensiones (in parallel projections). In the following
example we used faces with aspect ratios 3:2, 2:1 and 4:3. The box at the right
is the figure obtained after applying the transformations described in
the previous schematic.</p>
<img alt="Orthogonal views and final isometric figure" class="align-center" src="images/isometric_inkscape/isometric_ex2.svg" style="width: 500px;"><p>We can now proceed, to recreate the desired figure. I don't know the
exact dimensions of the box; my guess is that the cross-section was
a square and the aspect ratio was 5:1. After applying the transformations
to each rectangle we obtain the following (adding some tweaks here and there).</p>
<img alt="Recreated figure using the described approach" class="align-center" src="images/isometric_inkscape/isometric_beam.svg" style="width: 500px;"></section><section id="second-approach"><h2>Second approach</h2>
<p>For this type of schematic, I would prefer to create an axonometric grid
(<code class="docutils literal">File &gt; Document Properties &gt; Grids</code>). After adding the grid to our
canvas it is pretty straightforward to draw the figures in isometric
view. The canvas should look similar to the following image.</p>
<img alt="Second approach: using an axonometric grid" class="align-center" src="images/isometric_inkscape/screenshot_inkscape.png" style="width: 500px;"><p>We can then draw each face using the grid. If we want to be more precise
we can activate <code class="docutils literal">Snap to Cusp Nodes</code>. The following animation shows
the step by step construction.</p>
<img alt="Step by step construction of the isometric" class="align-center" src="images/isometric_inkscape/isometric_construction.gif" style="width: 500px;"><p>And we obtain the final image.</p>
<img alt="Recreated figure using the second approach" class="align-center" src="images/isometric_inkscape/isometric_beam2.svg" style="width: 500px;"></section><section id="conclusion"><h2>Conclusion</h2>
<p>As I mentioned, Inkscape can be used for drawing simple figures in isometric
projection. Nevertheless, I strongly suggest to use a CAD like
<a class="reference external" href="https://freecadweb.org/">FreeCAD</a> for more complicated geometries.</p>
</section>
</div>
    </article><article class="post h-entry post-text"><header><h1 class="post-title p-name"><a href="posts/isometric_inkscape/" class="u-url">Isometric graphics in Inkscape</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn">Nicolás Guarín-Zapata</span></p>
            <p class="dateline"><a href="posts/isometric_inkscape/" rel="bookmark"><time class="post-date published dt-published" datetime="2018-05-24T15:42:02-05:00" title="2018-05-24 15:42">2018-05-24 15:42</time></a></p>
                <p class="commentline">
    
    <a href="posts/isometric_inkscape/#disqus_thread" data-disqus-identifier="cache/posts/isometric_inkscape.html">Comments</a>


        </p>
</div>
    </header><div class="e-content entry-content">
    <p>Sometimes I find myself in need of making a schematic using an
<a class="reference external" href="https://en.wikipedia.org/wiki/Isometric_projection">isometric projection</a>.
When the schematic is complicated the best shot is to use some
CAD like <a class="reference external" href="https://freecadweb.org/">FreeCAD</a>, but sometimes it's just
needed in simple diagrams. Another situation where this is a common needed
is in <a class="reference external" href="https://en.wikipedia.org/wiki/Isometric_graphics_in_video_games_and_pixel_art">video games</a>,
where <a class="reference external" href="https://youtu.be/toWMFcWB4HA">"isometric art"</a> and
<a class="reference external" href="https://en.wikipedia.org/wiki/Pixel_art">pixel art</a> are pretty common.</p>
<p>What we want is depicted in the following figure.</p>
<img alt="Views names in third angle representation" class="align-center" src="images/isometric_inkscape/isometric_example.svg" style="width: 400px;"><p>That is, we want to start with some information that is drawn, or
written in the case of the example, and we want to obtain how would it
been seen on one of the faces of an isometric box.</p>
<p>Following, I will describe briefly the transformations involved in this process.
If you are just interested in the recipe for doing this in Inkscape, skip to
the end of this post.</p>
<section id="transformations-involved"><h2>Transformations involved</h2>
<p>Since we are working on a computer screen, we are talking of 2 dimensions.
Hence, all transformations are represented by 2×2 matrices. In the particular
example of interest in this post we need the following transformations:</p>
<ol class="arabic simple">
<li><p>Vertical scaling</p></li>
<li><p>Horizontal skew</p></li>
<li><p>Rotation</p></li>
</ol>
<p>Following are the transformation matrices.</p>
<section id="scaling-in-the-vertical-direction"><h3>Scaling in the vertical direction</h3>
<p>The matrix is given by</p>
<div class="math">
\begin{equation*}
M_\text{scaling} = \begin{bmatrix} 1 &amp;0\\ 0 &amp;a\end{bmatrix}\, ,
\end{equation*}
</div>
<p>where <span class="math">\(a\)</span> is the scaling factor.</p>
</section><section id="horizontal-skew"><h3>Horizontal skew</h3>
<p>The matrix is given by</p>
<div class="math">
\begin{equation*}
M_\text{skew} = \begin{bmatrix} 1 &amp;\tan a\\ 0 &amp;1\end{bmatrix}\, ,
\end{equation*}
</div>
<p>where <span class="math">\(a\)</span> is the skewing angle.</p>
</section><section id="rotation"><h3>Rotation</h3>
<p>The matrix is given by</p>
<div class="math">
\begin{equation*}
M_\text{rotation} = \begin{bmatrix} \cos a &amp;-\sin a\\ \sin a &amp;\cos a\end{bmatrix}\, ,
\end{equation*}
</div>
<p>where <span class="math">\(a\)</span> is the rotation angle.</p>
</section><section id="complete-transformation"><h3>Complete transformation</h3>
<p>The complete transformation is given by</p>
<div class="math">
\begin{equation*}
M_\text{complete} = M_\text{rotation} M_\text{skew} M_\text{scaling}\, ,
\end{equation*}
</div>
<p>particularly,</p>
<div class="math">
\begin{align*}
&amp;M_\text{side} =
  \frac{1}{2}\begin{bmatrix} \sqrt{3} &amp; 0\\ -1 &amp;2\end{bmatrix}\approx
  \begin{bmatrix} 0.866 &amp; 0.000\\ -0.500 &amp;1.000\end{bmatrix}\, , \\
&amp;M_\text{front} = \frac{1}{2}\begin{bmatrix} \sqrt{3} &amp; 0\\ 1 &amp;2\end{bmatrix}\approx
  \begin{bmatrix} 0.866 &amp; 0.000\\ 0.500 &amp;1.000\end{bmatrix}\, , \\
&amp;M_\text{plant} = \frac{1}{2}\begin{bmatrix} \sqrt{3} &amp; -\sqrt{3}\\ -1 &amp;1\end{bmatrix}\approx
  \begin{bmatrix} 0.866 &amp; -0.866\\ 0.500 &amp;0.500\end{bmatrix}\, .
\end{align*}
</div>
<p>The values seem a bit arbitrary, but they can be obtained from the
<a class="reference external" href="https://en.wikipedia.org/wiki/Isometric_projection#Mathematics">isometric projection</a>
itself. But that explanation would be a bit too long for this post.</p>
</section><section id="tranformation-in-inkscape"><h3>Tranformation in Inkscape</h3>
<p>We already have the transformation matrices and we can use them in Inkscape.
But first, we need to understand how it works. Inkscape uses
<a class="reference external" href="https://en.wikipedia.org/wiki/Scalable_Vector_Graphics">SVG</a>, the web
standard for vector graphics. <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/SVG/Attribute/transform">Transformations</a> in SVG are done using the following
matrix</p>
<div class="math">
\begin{equation*}
\begin{bmatrix} a &amp;c &amp;e\\ b &amp;d &amp;f\\ 0 &amp;0 &amp;1\end{bmatrix}\, ,
\end{equation*}
</div>
<p>that uses <a class="reference external" href="https://en.wikipedia.org/wiki/Homogeneous_coordinates">homogeneous coordinates</a>. So, one can just press <code class="docutils literal">Shift + Ctrl + M</code>
and type the components of the matrices obtained above for
<span class="math">\(a\)</span>, <span class="math">\(b\)</span>, <span class="math">\(c\)</span>, and <span class="math">\(d\)</span>; leaving
<span class="math">\(e\)</span> and <span class="math">\(f\)</span> as zero.</p>
<p>My preferred method, though, is to apply each transformation after the
other in the <cite>Transform</cite> dialog (<code class="docutils literal">Shift + Ctrl + M</code>). And, this is the
method presented in the cheatsheet at the bottom of this post.</p>
</section></section><section id="tl-dr"><h2>TL;DR</h2>
<p>If you are just interested in the transformations needed in Inkscape
you can check the cheatsheet below. It uses third-angle as presented
below.</p>
<img alt="Views names in third angle representation" class="align-center" src="images/isometric_inkscape/third_angle.svg" style="width: 400px;"><section id="cheatsheet"><h3>Cheatsheet</h3>
<p>Keep in mind that Inkscape treats clockwise rotation as positive. Opposite
to common notation in mathematics.</p>
<img alt="Cheatsheet for isometric schematics in Inkscape" class="align-center" src="images/isometric_inkscape/isometric_instructions.svg" style="width: 500px;"></section></section>
</div>
    </article><article class="post h-entry post-text"><header><h1 class="post-title p-name"><a href="posts/infinite_fdm/" class="u-url">Finite differences in infinite domains</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn">Nicolás Guarín-Zapata</span></p>
            <p class="dateline"><a href="posts/infinite_fdm/" rel="bookmark"><time class="post-date published dt-published" datetime="2018-05-17T15:57:00-05:00" title="2018-05-17 15:57">2018-05-17 15:57</time></a></p>
                <p class="commentline">
    
    <a href="posts/infinite_fdm/#disqus_thread" data-disqus-identifier="cache/posts/infinite_fdm.html">Comments</a>


        </p>
</div>
    </header><div class="e-content entry-content">
    <section id="finite-differences-in-infinite-domains"><h2>Finite differences in infinite domains</h2>
<p>Because of my friend, <a class="reference external" href="http://cosmoscalibur.com/">Edward Villegas</a>, I
ended up thinking about using a change of variables when solving an
eigenvalue problem with finite difference.</p>
<section id="the-problem"><h3>The problem</h3>
<p>Let's say that we want to solve a differential equation over an infinite
domain. A common case is to solve the <a class="reference external" href="https://en.wikipedia.org/wiki/Schr%C3%B6dinger_equation#Time-independent_equation">Time independent Schrödinger
equation</a>
subject to a potential <span class="math">\(V(x)\)</span>. For example</p>
<div class="math">
\begin{equation*}
-\frac{1}{2}\frac{\mathrm{d}^2}{\mathrm{d}x^2}\psi(x) + V(x) \psi(x) = E\psi(x),\quad \forall x\in (-\infty, \infty),
\end{equation*}
</div>
<p>where we want to find the pairs of eigenvalues/eigenfunctions
<span class="math">\((E_n, \psi_n(x))\)</span>.</p>
<p>What I normally do when using <a class="reference external" href="https://en.wikipedia.org/wiki/Finite_difference_method">finite
differences</a>
is to regularly divide the domain. Where I take a <em>large enough</em> domain,
so the solution have decayed close to zero. What I do in this post is to
make a change of variable to render the interval finite first and then
regularly divide the transformed domain in finite intervals.</p>
</section><section id="my-usual-approach"><h3>My usual approach</h3>
<p>My usual approach is to approach the second derivative with a <a class="reference external" href="https://en.wikipedia.org/wiki/Finite_difference_coefficient">centered
difference</a>
for the point <span class="math">\(x_i\)</span> like this</p>
<div class="math">
\begin{equation*}
\frac{\mathrm{d}^2 f(x)}{\mathrm{d}x^2} \approx \frac{f(x + \Delta x) - 2 f(x_i) + f(x - \Delta x)}{\Delta x^2}\, ,
\end{equation*}
</div>
<p>with <span class="math">\(\Delta x\)</span> the separation between points.</p>
<p>We can solve this in Python with the following snippet:</p>
<div class="code"><pre class="code ipython3"><a id="rest_code_bb0e0a9a94b440c685ccf2ae6b15287b-1" name="rest_code_bb0e0a9a94b440c685ccf2ae6b15287b-1" href="posts/infinite_fdm/#rest_code_bb0e0a9a94b440c685ccf2ae6b15287b-1"></a><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<a id="rest_code_bb0e0a9a94b440c685ccf2ae6b15287b-2" name="rest_code_bb0e0a9a94b440c685ccf2ae6b15287b-2" href="posts/infinite_fdm/#rest_code_bb0e0a9a94b440c685ccf2ae6b15287b-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">scipy.sparse</span><span class="w"> </span><span class="kn">import</span> <span class="n">diags</span>
<a id="rest_code_bb0e0a9a94b440c685ccf2ae6b15287b-3" name="rest_code_bb0e0a9a94b440c685ccf2ae6b15287b-3" href="posts/infinite_fdm/#rest_code_bb0e0a9a94b440c685ccf2ae6b15287b-3"></a><span class="kn">from</span><span class="w"> </span><span class="nn">scipy.sparse.linalg</span><span class="w"> </span><span class="kn">import</span> <span class="n">eigs</span>
<a id="rest_code_bb0e0a9a94b440c685ccf2ae6b15287b-4" name="rest_code_bb0e0a9a94b440c685ccf2ae6b15287b-4" href="posts/infinite_fdm/#rest_code_bb0e0a9a94b440c685ccf2ae6b15287b-4"></a>
<a id="rest_code_bb0e0a9a94b440c685ccf2ae6b15287b-5" name="rest_code_bb0e0a9a94b440c685ccf2ae6b15287b-5" href="posts/infinite_fdm/#rest_code_bb0e0a9a94b440c685ccf2ae6b15287b-5"></a>
<a id="rest_code_bb0e0a9a94b440c685ccf2ae6b15287b-6" name="rest_code_bb0e0a9a94b440c685ccf2ae6b15287b-6" href="posts/infinite_fdm/#rest_code_bb0e0a9a94b440c685ccf2ae6b15287b-6"></a><span class="k">def</span><span class="w"> </span><span class="nf">regular_FD</span><span class="p">(</span><span class="n">pot</span><span class="p">,</span> <span class="n">npts</span><span class="o">=</span><span class="mi">101</span><span class="p">,</span> <span class="n">x_max</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">nvals</span><span class="o">=</span><span class="mi">6</span><span class="p">):</span>
<a id="rest_code_bb0e0a9a94b440c685ccf2ae6b15287b-7" name="rest_code_bb0e0a9a94b440c685ccf2ae6b15287b-7" href="posts/infinite_fdm/#rest_code_bb0e0a9a94b440c685ccf2ae6b15287b-7"></a><span class="w">    </span><span class="sd">"""</span>
<a id="rest_code_bb0e0a9a94b440c685ccf2ae6b15287b-8" name="rest_code_bb0e0a9a94b440c685ccf2ae6b15287b-8" href="posts/infinite_fdm/#rest_code_bb0e0a9a94b440c685ccf2ae6b15287b-8"></a><span class="sd">    Find eigenvalues/eigenfunctions for Schrodinger</span>
<a id="rest_code_bb0e0a9a94b440c685ccf2ae6b15287b-9" name="rest_code_bb0e0a9a94b440c685ccf2ae6b15287b-9" href="posts/infinite_fdm/#rest_code_bb0e0a9a94b440c685ccf2ae6b15287b-9"></a><span class="sd">    equation for the given potential `pot` using</span>
<a id="rest_code_bb0e0a9a94b440c685ccf2ae6b15287b-10" name="rest_code_bb0e0a9a94b440c685ccf2ae6b15287b-10" href="posts/infinite_fdm/#rest_code_bb0e0a9a94b440c685ccf2ae6b15287b-10"></a><span class="sd">    finite differences</span>
<a id="rest_code_bb0e0a9a94b440c685ccf2ae6b15287b-11" name="rest_code_bb0e0a9a94b440c685ccf2ae6b15287b-11" href="posts/infinite_fdm/#rest_code_bb0e0a9a94b440c685ccf2ae6b15287b-11"></a><span class="sd">    """</span>
<a id="rest_code_bb0e0a9a94b440c685ccf2ae6b15287b-12" name="rest_code_bb0e0a9a94b440c685ccf2ae6b15287b-12" href="posts/infinite_fdm/#rest_code_bb0e0a9a94b440c685ccf2ae6b15287b-12"></a>    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="n">x_max</span><span class="p">,</span> <span class="n">x_max</span><span class="p">,</span> <span class="n">npts</span><span class="p">)</span>
<a id="rest_code_bb0e0a9a94b440c685ccf2ae6b15287b-13" name="rest_code_bb0e0a9a94b440c685ccf2ae6b15287b-13" href="posts/infinite_fdm/#rest_code_bb0e0a9a94b440c685ccf2ae6b15287b-13"></a>    <span class="n">dx</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<a id="rest_code_bb0e0a9a94b440c685ccf2ae6b15287b-14" name="rest_code_bb0e0a9a94b440c685ccf2ae6b15287b-14" href="posts/infinite_fdm/#rest_code_bb0e0a9a94b440c685ccf2ae6b15287b-14"></a>    <span class="n">D2</span> <span class="o">=</span> <span class="n">diags</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="n">npts</span><span class="p">,</span> <span class="n">npts</span><span class="p">))</span><span class="o">/</span><span class="n">dx</span><span class="o">**</span><span class="mi">2</span>
<a id="rest_code_bb0e0a9a94b440c685ccf2ae6b15287b-15" name="rest_code_bb0e0a9a94b440c685ccf2ae6b15287b-15" href="posts/infinite_fdm/#rest_code_bb0e0a9a94b440c685ccf2ae6b15287b-15"></a>    <span class="n">V</span> <span class="o">=</span> <span class="n">diags</span><span class="p">(</span><span class="n">pot</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<a id="rest_code_bb0e0a9a94b440c685ccf2ae6b15287b-16" name="rest_code_bb0e0a9a94b440c685ccf2ae6b15287b-16" href="posts/infinite_fdm/#rest_code_bb0e0a9a94b440c685ccf2ae6b15287b-16"></a>    <span class="n">H</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.5</span><span class="o">*</span><span class="n">D2</span> <span class="o">+</span> <span class="n">V</span>
<a id="rest_code_bb0e0a9a94b440c685ccf2ae6b15287b-17" name="rest_code_bb0e0a9a94b440c685ccf2ae6b15287b-17" href="posts/infinite_fdm/#rest_code_bb0e0a9a94b440c685ccf2ae6b15287b-17"></a>    <span class="n">vals</span><span class="p">,</span> <span class="n">vecs</span> <span class="o">=</span> <span class="n">eigs</span><span class="p">(</span><span class="n">H</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="n">nvals</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s2">"SM"</span><span class="p">)</span>
<a id="rest_code_bb0e0a9a94b440c685ccf2ae6b15287b-18" name="rest_code_bb0e0a9a94b440c685ccf2ae6b15287b-18" href="posts/infinite_fdm/#rest_code_bb0e0a9a94b440c685ccf2ae6b15287b-18"></a>    <span class="k">return</span> <span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">vals</span><span class="p">),</span> <span class="n">vecs</span>
</pre></div>
<p>Let's setup the plotting details.</p>
<div class="code"><pre class="code ipython3"><a id="rest_code_b9dcd1d7354c43f7b78a78948a512074-1" name="rest_code_b9dcd1d7354c43f7b78a78948a512074-1" href="posts/infinite_fdm/#rest_code_b9dcd1d7354c43f7b78a78948a512074-1"></a><span class="c1"># Jupyter notebook plotting setup &amp; imports</span>
<a id="rest_code_b9dcd1d7354c43f7b78a78948a512074-2" name="rest_code_b9dcd1d7354c43f7b78a78948a512074-2" href="posts/infinite_fdm/#rest_code_b9dcd1d7354c43f7b78a78948a512074-2"></a><span class="o">%</span><span class="k">matplotlib</span> notebook
<a id="rest_code_b9dcd1d7354c43f7b78a78948a512074-3" name="rest_code_b9dcd1d7354c43f7b78a78948a512074-3" href="posts/infinite_fdm/#rest_code_b9dcd1d7354c43f7b78a78948a512074-3"></a><span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<a id="rest_code_b9dcd1d7354c43f7b78a78948a512074-4" name="rest_code_b9dcd1d7354c43f7b78a78948a512074-4" href="posts/infinite_fdm/#rest_code_b9dcd1d7354c43f7b78a78948a512074-4"></a>
<a id="rest_code_b9dcd1d7354c43f7b78a78948a512074-5" name="rest_code_b9dcd1d7354c43f7b78a78948a512074-5" href="posts/infinite_fdm/#rest_code_b9dcd1d7354c43f7b78a78948a512074-5"></a><span class="n">gray</span> <span class="o">=</span> <span class="s1">'#757575'</span>
<a id="rest_code_b9dcd1d7354c43f7b78a78948a512074-6" name="rest_code_b9dcd1d7354c43f7b78a78948a512074-6" href="posts/infinite_fdm/#rest_code_b9dcd1d7354c43f7b78a78948a512074-6"></a><span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s2">"figure.figsize"</span><span class="p">]</span> <span class="o">=</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">4</span>
<a id="rest_code_b9dcd1d7354c43f7b78a78948a512074-7" name="rest_code_b9dcd1d7354c43f7b78a78948a512074-7" href="posts/infinite_fdm/#rest_code_b9dcd1d7354c43f7b78a78948a512074-7"></a><span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s2">"mathtext.fontset"</span><span class="p">]</span> <span class="o">=</span> <span class="s2">"cm"</span>
<a id="rest_code_b9dcd1d7354c43f7b78a78948a512074-8" name="rest_code_b9dcd1d7354c43f7b78a78948a512074-8" href="posts/infinite_fdm/#rest_code_b9dcd1d7354c43f7b78a78948a512074-8"></a><span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s2">"text.color"</span><span class="p">]</span> <span class="o">=</span> <span class="n">gray</span>
<a id="rest_code_b9dcd1d7354c43f7b78a78948a512074-9" name="rest_code_b9dcd1d7354c43f7b78a78948a512074-9" href="posts/infinite_fdm/#rest_code_b9dcd1d7354c43f7b78a78948a512074-9"></a><span class="n">fontsize</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s2">"font.size"</span><span class="p">]</span> <span class="o">=</span> <span class="mi">12</span>
<a id="rest_code_b9dcd1d7354c43f7b78a78948a512074-10" name="rest_code_b9dcd1d7354c43f7b78a78948a512074-10" href="posts/infinite_fdm/#rest_code_b9dcd1d7354c43f7b78a78948a512074-10"></a><span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s2">"xtick.color"</span><span class="p">]</span> <span class="o">=</span> <span class="n">gray</span>
<a id="rest_code_b9dcd1d7354c43f7b78a78948a512074-11" name="rest_code_b9dcd1d7354c43f7b78a78948a512074-11" href="posts/infinite_fdm/#rest_code_b9dcd1d7354c43f7b78a78948a512074-11"></a><span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s2">"ytick.color"</span><span class="p">]</span> <span class="o">=</span> <span class="n">gray</span>
<a id="rest_code_b9dcd1d7354c43f7b78a78948a512074-12" name="rest_code_b9dcd1d7354c43f7b78a78948a512074-12" href="posts/infinite_fdm/#rest_code_b9dcd1d7354c43f7b78a78948a512074-12"></a><span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s2">"axes.labelcolor"</span><span class="p">]</span> <span class="o">=</span> <span class="n">gray</span>
<a id="rest_code_b9dcd1d7354c43f7b78a78948a512074-13" name="rest_code_b9dcd1d7354c43f7b78a78948a512074-13" href="posts/infinite_fdm/#rest_code_b9dcd1d7354c43f7b78a78948a512074-13"></a><span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s2">"axes.edgecolor"</span><span class="p">]</span> <span class="o">=</span> <span class="n">gray</span>
<a id="rest_code_b9dcd1d7354c43f7b78a78948a512074-14" name="rest_code_b9dcd1d7354c43f7b78a78948a512074-14" href="posts/infinite_fdm/#rest_code_b9dcd1d7354c43f7b78a78948a512074-14"></a><span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s2">"axes.spines.right"</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
<a id="rest_code_b9dcd1d7354c43f7b78a78948a512074-15" name="rest_code_b9dcd1d7354c43f7b78a78948a512074-15" href="posts/infinite_fdm/#rest_code_b9dcd1d7354c43f7b78a78948a512074-15"></a><span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s2">"axes.spines.top"</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
</pre></div>
<p>Let's consider the <a class="reference external" href="https://en.wikipedia.org/wiki/Quantum_harmonic_oscillator">Quantum harmonic
oscillator</a>,
that has as eigenvalues</p>
<div class="math">
\begin{equation*}
E_n = n + \frac{1}{2},\quad \forall n = 0, 1, 2 \cdots
\end{equation*}
</div>
<p>Using the finite difference method we have values that are really close
to the analytic ones.</p>
<div class="code"><pre class="code ipython3"><a id="rest_code_7b7b0f5829c84ef09d084d49b0597d14-1" name="rest_code_7b7b0f5829c84ef09d084d49b0597d14-1" href="posts/infinite_fdm/#rest_code_7b7b0f5829c84ef09d084d49b0597d14-1"></a><span class="n">x</span><span class="p">,</span> <span class="n">vals</span><span class="p">,</span> <span class="n">vecs</span> <span class="o">=</span> <span class="n">regular_FD</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="n">npts</span><span class="o">=</span><span class="mi">201</span><span class="p">)</span>
<a id="rest_code_7b7b0f5829c84ef09d084d49b0597d14-2" name="rest_code_7b7b0f5829c84ef09d084d49b0597d14-2" href="posts/infinite_fdm/#rest_code_7b7b0f5829c84ef09d084d49b0597d14-2"></a><span class="n">vals</span>
</pre></div>
<p>with output</p>
<pre class="literal-block">array([0.4996873 , 1.49843574, 2.49593063, 3.49216962, 4.48715031,
       5.4808703 ])</pre>
<p>With the analytic ones</p>
<div class="code"><pre class="code text"><a id="rest_code_e7679396f2514d88a1bbd0a4fd66f19d-1" name="rest_code_e7679396f2514d88a1bbd0a4fd66f19d-1" href="posts/infinite_fdm/#rest_code_e7679396f2514d88a1bbd0a4fd66f19d-1"></a>[0.5, 1.5, 2.5, 3.5, 4.5, 5.5])
</pre></div>
<p>If we plot these two, we obtain the following.</p>
<div class="code"><pre class="code ipython3"><a id="rest_code_ceeba1f940d7455fbb3f7cec2643e37b-1" name="rest_code_ceeba1f940d7455fbb3f7cec2643e37b-1" href="posts/infinite_fdm/#rest_code_ceeba1f940d7455fbb3f7cec2643e37b-1"></a><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<a id="rest_code_ceeba1f940d7455fbb3f7cec2643e37b-2" name="rest_code_ceeba1f940d7455fbb3f7cec2643e37b-2" href="posts/infinite_fdm/#rest_code_ceeba1f940d7455fbb3f7cec2643e37b-2"></a><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">anal_vals</span><span class="p">)</span>
<a id="rest_code_ceeba1f940d7455fbb3f7cec2643e37b-3" name="rest_code_ceeba1f940d7455fbb3f7cec2643e37b-3" href="posts/infinite_fdm/#rest_code_ceeba1f940d7455fbb3f7cec2643e37b-3"></a><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">vals</span><span class="p">,</span> <span class="s2">"o"</span><span class="p">)</span>
<a id="rest_code_ceeba1f940d7455fbb3f7cec2643e37b-4" name="rest_code_ceeba1f940d7455fbb3f7cec2643e37b-4" href="posts/infinite_fdm/#rest_code_ceeba1f940d7455fbb3f7cec2643e37b-4"></a><span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">"$n$"</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<a id="rest_code_ceeba1f940d7455fbb3f7cec2643e37b-5" name="rest_code_ceeba1f940d7455fbb3f7cec2643e37b-5" href="posts/infinite_fdm/#rest_code_ceeba1f940d7455fbb3f7cec2643e37b-5"></a><span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">"$E_n$"</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<a id="rest_code_ceeba1f940d7455fbb3f7cec2643e37b-6" name="rest_code_ceeba1f940d7455fbb3f7cec2643e37b-6" href="posts/infinite_fdm/#rest_code_ceeba1f940d7455fbb3f7cec2643e37b-6"></a><span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s2">"Analytic"</span><span class="p">,</span> <span class="s2">"Finite differences"</span><span class="p">])</span>
<a id="rest_code_ceeba1f940d7455fbb3f7cec2643e37b-7" name="rest_code_ceeba1f940d7455fbb3f7cec2643e37b-7" href="posts/infinite_fdm/#rest_code_ceeba1f940d7455fbb3f7cec2643e37b-7"></a><span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">();</span>
</pre></div>
<img alt="Eigenvalues for the regular finite difference" class="align-center" src="images/infinite_fdm/eigvals_regular.svg" style="width: 600px;"><p>Let's see the eigenfunctions.</p>
<div class="code"><pre class="code ipython3"><a id="rest_code_87f6265976274518a90f75749d6d6261-1" name="rest_code_87f6265976274518a90f75749d6d6261-1" href="posts/infinite_fdm/#rest_code_87f6265976274518a90f75749d6d6261-1"></a><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<a id="rest_code_87f6265976274518a90f75749d6d6261-2" name="rest_code_87f6265976274518a90f75749d6d6261-2" href="posts/infinite_fdm/#rest_code_87f6265976274518a90f75749d6d6261-2"></a><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">vecs</span><span class="p">[:,</span> <span class="p">:</span><span class="mi">3</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<a id="rest_code_87f6265976274518a90f75749d6d6261-3" name="rest_code_87f6265976274518a90f75749d6d6261-3" href="posts/infinite_fdm/#rest_code_87f6265976274518a90f75749d6d6261-3"></a><span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
<a id="rest_code_87f6265976274518a90f75749d6d6261-4" name="rest_code_87f6265976274518a90f75749d6d6261-4" href="posts/infinite_fdm/#rest_code_87f6265976274518a90f75749d6d6261-4"></a><span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">"$x$"</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<a id="rest_code_87f6265976274518a90f75749d6d6261-5" name="rest_code_87f6265976274518a90f75749d6d6261-5" href="posts/infinite_fdm/#rest_code_87f6265976274518a90f75749d6d6261-5"></a><span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">"$|\psi_n(x)|^2$"</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<a id="rest_code_87f6265976274518a90f75749d6d6261-6" name="rest_code_87f6265976274518a90f75749d6d6261-6" href="posts/infinite_fdm/#rest_code_87f6265976274518a90f75749d6d6261-6"></a><span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">([])</span>
<a id="rest_code_87f6265976274518a90f75749d6d6261-7" name="rest_code_87f6265976274518a90f75749d6d6261-7" href="posts/infinite_fdm/#rest_code_87f6265976274518a90f75749d6d6261-7"></a><span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">();</span>
</pre></div>
<img alt="Eigenfunctions for the regular finite difference" class="align-center" src="images/infinite_fdm/eigvecs_regular.svg" style="width: 600px;"><p>One inconvenient with this method is the redundant sampling towards the
extreme of the intervals, while under sample the middle part.</p>
</section><section id="changing-the-domain"><h3>Changing the domain</h3>
<p>Let's now consider the case where we transform the infinite domain to a
finite one with a change of variable</p>
<div class="math">
\begin{equation*}
\xi = \xi(x)
\end{equation*}
</div>
<p>with <span class="math">\(\xi \in (-1, 1)\)</span>. Two options for this transformation are:</p>
<ul class="simple">
<li><p><span class="math">\(\xi = \tanh x\)</span>; and</p></li>
<li><p><span class="math">\(\xi = \frac{2}{\pi} \arctan x\)</span>.</p></li>
</ul>
<p>Making this change of variable the equation we need to solve the
following equation</p>
<div class="math">
\begin{equation*}
-\frac{1}{2}\left(\frac{\mathrm{d}\xi}{\mathrm{d}x}\right)^2\frac{\mathrm{d}^2}{\mathrm{d}\xi^2}\psi(\xi) - \frac{1}{2}\frac{\mathrm{d}^2\xi}{\mathrm{d}x^2}\frac{\mathrm{d}}{\mathrm{d}\xi}\psi(\xi) + V(\xi) \psi(\xi) = E\psi(\xi)
\end{equation*}
</div>
<p>The following snippet solve the eigenproblem for the mapped domain:</p>
<div class="code"><pre class="code ipython3"><a id="rest_code_5a13894b72e84976a77dd6e694eb1827-1" name="rest_code_5a13894b72e84976a77dd6e694eb1827-1" href="posts/infinite_fdm/#rest_code_5a13894b72e84976a77dd6e694eb1827-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">mapped_FD</span><span class="p">(</span><span class="n">pot</span><span class="p">,</span> <span class="n">fun</span><span class="p">,</span> <span class="n">dxdxi</span><span class="p">,</span> <span class="n">dxdxi2</span><span class="p">,</span> <span class="n">npts</span><span class="o">=</span><span class="mi">101</span><span class="p">,</span> <span class="n">nvals</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">xi_tol</span><span class="o">=</span><span class="mf">1e-6</span><span class="p">):</span>
<a id="rest_code_5a13894b72e84976a77dd6e694eb1827-2" name="rest_code_5a13894b72e84976a77dd6e694eb1827-2" href="posts/infinite_fdm/#rest_code_5a13894b72e84976a77dd6e694eb1827-2"></a><span class="w">    </span><span class="sd">"""</span>
<a id="rest_code_5a13894b72e84976a77dd6e694eb1827-3" name="rest_code_5a13894b72e84976a77dd6e694eb1827-3" href="posts/infinite_fdm/#rest_code_5a13894b72e84976a77dd6e694eb1827-3"></a><span class="sd">    Find eigenvalues/eigenfunctions for Schrodinger</span>
<a id="rest_code_5a13894b72e84976a77dd6e694eb1827-4" name="rest_code_5a13894b72e84976a77dd6e694eb1827-4" href="posts/infinite_fdm/#rest_code_5a13894b72e84976a77dd6e694eb1827-4"></a><span class="sd">    equation for the given potential `pot` using</span>
<a id="rest_code_5a13894b72e84976a77dd6e694eb1827-5" name="rest_code_5a13894b72e84976a77dd6e694eb1827-5" href="posts/infinite_fdm/#rest_code_5a13894b72e84976a77dd6e694eb1827-5"></a><span class="sd">    finite differences over a mapped domain on (-1, 1)</span>
<a id="rest_code_5a13894b72e84976a77dd6e694eb1827-6" name="rest_code_5a13894b72e84976a77dd6e694eb1827-6" href="posts/infinite_fdm/#rest_code_5a13894b72e84976a77dd6e694eb1827-6"></a><span class="sd">    """</span>
<a id="rest_code_5a13894b72e84976a77dd6e694eb1827-7" name="rest_code_5a13894b72e84976a77dd6e694eb1827-7" href="posts/infinite_fdm/#rest_code_5a13894b72e84976a77dd6e694eb1827-7"></a>    <span class="n">xi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span> <span class="o">+</span> <span class="n">xi_tol</span><span class="p">,</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">xi_tol</span><span class="p">,</span> <span class="n">npts</span><span class="p">)</span>
<a id="rest_code_5a13894b72e84976a77dd6e694eb1827-8" name="rest_code_5a13894b72e84976a77dd6e694eb1827-8" href="posts/infinite_fdm/#rest_code_5a13894b72e84976a77dd6e694eb1827-8"></a>    <span class="n">x</span> <span class="o">=</span> <span class="n">fun</span><span class="p">(</span><span class="n">xi</span><span class="p">)</span>
<a id="rest_code_5a13894b72e84976a77dd6e694eb1827-9" name="rest_code_5a13894b72e84976a77dd6e694eb1827-9" href="posts/infinite_fdm/#rest_code_5a13894b72e84976a77dd6e694eb1827-9"></a>    <span class="n">dxi</span> <span class="o">=</span> <span class="n">xi</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">xi</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<a id="rest_code_5a13894b72e84976a77dd6e694eb1827-10" name="rest_code_5a13894b72e84976a77dd6e694eb1827-10" href="posts/infinite_fdm/#rest_code_5a13894b72e84976a77dd6e694eb1827-10"></a>    <span class="n">D2</span> <span class="o">=</span> <span class="n">diags</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="n">npts</span><span class="p">,</span> <span class="n">npts</span><span class="p">))</span><span class="o">/</span><span class="n">dxi</span><span class="o">**</span><span class="mi">2</span>
<a id="rest_code_5a13894b72e84976a77dd6e694eb1827-11" name="rest_code_5a13894b72e84976a77dd6e694eb1827-11" href="posts/infinite_fdm/#rest_code_5a13894b72e84976a77dd6e694eb1827-11"></a>    <span class="n">D1</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">diags</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="n">npts</span><span class="p">,</span> <span class="n">npts</span><span class="p">))</span><span class="o">/</span><span class="n">dxi</span>
<a id="rest_code_5a13894b72e84976a77dd6e694eb1827-12" name="rest_code_5a13894b72e84976a77dd6e694eb1827-12" href="posts/infinite_fdm/#rest_code_5a13894b72e84976a77dd6e694eb1827-12"></a>    <span class="n">V</span> <span class="o">=</span> <span class="n">diags</span><span class="p">(</span><span class="n">pot</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<a id="rest_code_5a13894b72e84976a77dd6e694eb1827-13" name="rest_code_5a13894b72e84976a77dd6e694eb1827-13" href="posts/infinite_fdm/#rest_code_5a13894b72e84976a77dd6e694eb1827-13"></a>    <span class="n">fac1</span> <span class="o">=</span> <span class="n">diags</span><span class="p">(</span><span class="n">dxdxi</span><span class="p">(</span><span class="n">xi</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<a id="rest_code_5a13894b72e84976a77dd6e694eb1827-14" name="rest_code_5a13894b72e84976a77dd6e694eb1827-14" href="posts/infinite_fdm/#rest_code_5a13894b72e84976a77dd6e694eb1827-14"></a>    <span class="n">fac2</span> <span class="o">=</span> <span class="n">diags</span><span class="p">(</span><span class="n">dxdxi2</span><span class="p">(</span><span class="n">xi</span><span class="p">))</span>
<a id="rest_code_5a13894b72e84976a77dd6e694eb1827-15" name="rest_code_5a13894b72e84976a77dd6e694eb1827-15" href="posts/infinite_fdm/#rest_code_5a13894b72e84976a77dd6e694eb1827-15"></a>    <span class="n">H</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.5</span><span class="o">*</span><span class="n">fac1</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">D2</span><span class="p">)</span> <span class="o">-</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">fac2</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">D1</span><span class="p">)</span> <span class="o">+</span> <span class="n">V</span>
<a id="rest_code_5a13894b72e84976a77dd6e694eb1827-16" name="rest_code_5a13894b72e84976a77dd6e694eb1827-16" href="posts/infinite_fdm/#rest_code_5a13894b72e84976a77dd6e694eb1827-16"></a>    <span class="n">vals</span><span class="p">,</span> <span class="n">vecs</span> <span class="o">=</span> <span class="n">eigs</span><span class="p">(</span><span class="n">H</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="n">nvals</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s2">"SM"</span><span class="p">)</span>
<a id="rest_code_5a13894b72e84976a77dd6e694eb1827-17" name="rest_code_5a13894b72e84976a77dd6e694eb1827-17" href="posts/infinite_fdm/#rest_code_5a13894b72e84976a77dd6e694eb1827-17"></a>    <span class="k">return</span> <span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">vals</span><span class="p">),</span> <span class="n">vecs</span>
</pre></div>
<section id="first-transformation-xi-tanh-x"><h4>First transformation: <span class="math">\(\xi = \tanh(x)\)</span>
</h4>
<p>Let's consider first the transformation</p>
<div class="math">
\begin{equation*}
\xi = \tanh(x)\, .
\end{equation*}
</div>
<p>In this case</p>
<div class="math">
\begin{equation*}
\frac{\mathrm{d}\xi}{\mathrm{d}x} = 1 - \tanh^2(x) = 1 - \xi^2\, ,
\end{equation*}
</div>
<p>and</p>
<div class="math">
\begin{equation*}
\frac{\mathrm{d}^2\xi}{\mathrm{d}x^2} = -2\tanh(x)[1 - \tanh^2(x)] = -2\xi[1 - \xi^2]\, .
\end{equation*}
</div>
<p>We need to define the functions</p>
<div class="code"><pre class="code ipython3"><a id="rest_code_6a6ab075e9454fff9ea364052e9334e2-1" name="rest_code_6a6ab075e9454fff9ea364052e9334e2-1" href="posts/infinite_fdm/#rest_code_6a6ab075e9454fff9ea364052e9334e2-1"></a><span class="n">pot</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span>
<a id="rest_code_6a6ab075e9454fff9ea364052e9334e2-2" name="rest_code_6a6ab075e9454fff9ea364052e9334e2-2" href="posts/infinite_fdm/#rest_code_6a6ab075e9454fff9ea364052e9334e2-2"></a><span class="n">fun</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">xi</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">arctanh</span><span class="p">(</span><span class="n">xi</span><span class="p">)</span>
<a id="rest_code_6a6ab075e9454fff9ea364052e9334e2-3" name="rest_code_6a6ab075e9454fff9ea364052e9334e2-3" href="posts/infinite_fdm/#rest_code_6a6ab075e9454fff9ea364052e9334e2-3"></a><span class="n">dxdxi</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">xi</span><span class="p">:</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">xi</span><span class="o">**</span><span class="mi">2</span>
<a id="rest_code_6a6ab075e9454fff9ea364052e9334e2-4" name="rest_code_6a6ab075e9454fff9ea364052e9334e2-4" href="posts/infinite_fdm/#rest_code_6a6ab075e9454fff9ea364052e9334e2-4"></a><span class="n">dxdxi2</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">xi</span><span class="p">:</span> <span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">xi</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">xi</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
<p>and run the function</p>
<div class="code"><pre class="code ipython3"><a id="rest_code_cbdc4889a0c743098682adf70b42c116-1" name="rest_code_cbdc4889a0c743098682adf70b42c116-1" href="posts/infinite_fdm/#rest_code_cbdc4889a0c743098682adf70b42c116-1"></a><span class="n">x</span><span class="p">,</span> <span class="n">vals</span><span class="p">,</span> <span class="n">vecs</span> <span class="o">=</span> <span class="n">mapped_FD</span><span class="p">(</span><span class="n">pot</span><span class="p">,</span> <span class="n">fun</span><span class="p">,</span> <span class="n">dxdxi</span><span class="p">,</span> <span class="n">dxdxi2</span><span class="p">,</span> <span class="n">npts</span><span class="o">=</span><span class="mi">201</span><span class="p">)</span>
<a id="rest_code_cbdc4889a0c743098682adf70b42c116-2" name="rest_code_cbdc4889a0c743098682adf70b42c116-2" href="posts/infinite_fdm/#rest_code_cbdc4889a0c743098682adf70b42c116-2"></a><span class="n">vals</span>
</pre></div>
<p>And we obtain the following</p>
<pre class="literal-block">array([0.49989989, 1.4984226 , 2.49003572, 3.46934257, 4.46935021,
       5.59552989])</pre>
<p>If we compare with the analytic values we get the following.</p>
<div class="code"><pre class="code ipython3"><a id="rest_code_85df4e0d9f424bdb8c8b976d286b2614-1" name="rest_code_85df4e0d9f424bdb8c8b976d286b2614-1" href="posts/infinite_fdm/#rest_code_85df4e0d9f424bdb8c8b976d286b2614-1"></a><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<a id="rest_code_85df4e0d9f424bdb8c8b976d286b2614-2" name="rest_code_85df4e0d9f424bdb8c8b976d286b2614-2" href="posts/infinite_fdm/#rest_code_85df4e0d9f424bdb8c8b976d286b2614-2"></a><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">anal_vals</span><span class="p">)</span>
<a id="rest_code_85df4e0d9f424bdb8c8b976d286b2614-3" name="rest_code_85df4e0d9f424bdb8c8b976d286b2614-3" href="posts/infinite_fdm/#rest_code_85df4e0d9f424bdb8c8b976d286b2614-3"></a><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">vals</span><span class="p">,</span> <span class="s2">"o"</span><span class="p">)</span>
<a id="rest_code_85df4e0d9f424bdb8c8b976d286b2614-4" name="rest_code_85df4e0d9f424bdb8c8b976d286b2614-4" href="posts/infinite_fdm/#rest_code_85df4e0d9f424bdb8c8b976d286b2614-4"></a><span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s2">"Analytic"</span><span class="p">,</span> <span class="s2">"Finite differences"</span><span class="p">])</span>
<a id="rest_code_85df4e0d9f424bdb8c8b976d286b2614-5" name="rest_code_85df4e0d9f424bdb8c8b976d286b2614-5" href="posts/infinite_fdm/#rest_code_85df4e0d9f424bdb8c8b976d286b2614-5"></a><span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">"$n$"</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<a id="rest_code_85df4e0d9f424bdb8c8b976d286b2614-6" name="rest_code_85df4e0d9f424bdb8c8b976d286b2614-6" href="posts/infinite_fdm/#rest_code_85df4e0d9f424bdb8c8b976d286b2614-6"></a><span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">"$E_n$"</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<a id="rest_code_85df4e0d9f424bdb8c8b976d286b2614-7" name="rest_code_85df4e0d9f424bdb8c8b976d286b2614-7" href="posts/infinite_fdm/#rest_code_85df4e0d9f424bdb8c8b976d286b2614-7"></a><span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">();</span>
</pre></div>
<img alt="Eigenvalues for the first transformation" class="align-center" src="images/infinite_fdm/eigvals_tanh.svg" style="width: 600px;"><p>And the following are the eigenfunctions.</p>
<div class="code"><pre class="code ipython3"><a id="rest_code_26fe6f4c95da4fb38906feb14c1a773b-1" name="rest_code_26fe6f4c95da4fb38906feb14c1a773b-1" href="posts/infinite_fdm/#rest_code_26fe6f4c95da4fb38906feb14c1a773b-1"></a><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<a id="rest_code_26fe6f4c95da4fb38906feb14c1a773b-2" name="rest_code_26fe6f4c95da4fb38906feb14c1a773b-2" href="posts/infinite_fdm/#rest_code_26fe6f4c95da4fb38906feb14c1a773b-2"></a><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">vecs</span><span class="p">[:,</span> <span class="p">:</span><span class="mi">3</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<a id="rest_code_26fe6f4c95da4fb38906feb14c1a773b-3" name="rest_code_26fe6f4c95da4fb38906feb14c1a773b-3" href="posts/infinite_fdm/#rest_code_26fe6f4c95da4fb38906feb14c1a773b-3"></a><span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
<a id="rest_code_26fe6f4c95da4fb38906feb14c1a773b-4" name="rest_code_26fe6f4c95da4fb38906feb14c1a773b-4" href="posts/infinite_fdm/#rest_code_26fe6f4c95da4fb38906feb14c1a773b-4"></a><span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">"$x$"</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<a id="rest_code_26fe6f4c95da4fb38906feb14c1a773b-5" name="rest_code_26fe6f4c95da4fb38906feb14c1a773b-5" href="posts/infinite_fdm/#rest_code_26fe6f4c95da4fb38906feb14c1a773b-5"></a><span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">"$|\psi_n(x)|^2$"</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<a id="rest_code_26fe6f4c95da4fb38906feb14c1a773b-6" name="rest_code_26fe6f4c95da4fb38906feb14c1a773b-6" href="posts/infinite_fdm/#rest_code_26fe6f4c95da4fb38906feb14c1a773b-6"></a><span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">([])</span>
<a id="rest_code_26fe6f4c95da4fb38906feb14c1a773b-7" name="rest_code_26fe6f4c95da4fb38906feb14c1a773b-7" href="posts/infinite_fdm/#rest_code_26fe6f4c95da4fb38906feb14c1a773b-7"></a><span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">();</span>
</pre></div>
<img alt="Eigenfunctions for the first transformation" class="align-center" src="images/infinite_fdm/eigvecs_tanh.svg" style="width: 600px;"></section><section id="second-transformation-xi-frac-2-pi-mathrm-atan-x"><h4>Second transformation: <span class="math">\(\xi = \frac{2}{\pi}\mathrm{atan}(x)\)</span>
</h4>
<p>Let's consider first the transformation</p>
<div class="math">
\begin{equation*}
\xi = \frac{2}{\pi}\mathrm{atan}(x)\, .
\end{equation*}
</div>
<p>In this case</p>
<div class="math">
\begin{equation*}
\frac{\mathrm{d}\xi}{\mathrm{d}x} = \frac{2}{\pi(1 + x^2)} = \frac{2 \cos^2\xi}{\pi} \, ,
\end{equation*}
</div>
<p>and</p>
<div class="math">
\begin{equation*}
\frac{\mathrm{d}^2\xi}{\mathrm{d}x^2} = -\frac{4x}{\pi(1 + x^2)^2} = -\frac{4 \cos^4\xi \tan \xi}{\pi}\, .
\end{equation*}
</div>
<p>Once, again, we define the functions.</p>
<div class="code"><pre class="code ipython3"><a id="rest_code_a25f72d532af4e7085bc025cfaddf219-1" name="rest_code_a25f72d532af4e7085bc025cfaddf219-1" href="posts/infinite_fdm/#rest_code_a25f72d532af4e7085bc025cfaddf219-1"></a><span class="n">pot</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span>
<a id="rest_code_a25f72d532af4e7085bc025cfaddf219-2" name="rest_code_a25f72d532af4e7085bc025cfaddf219-2" href="posts/infinite_fdm/#rest_code_a25f72d532af4e7085bc025cfaddf219-2"></a><span class="n">fun</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">xi</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">tan</span><span class="p">(</span><span class="mf">0.5</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">xi</span><span class="p">)</span>
<a id="rest_code_a25f72d532af4e7085bc025cfaddf219-3" name="rest_code_a25f72d532af4e7085bc025cfaddf219-3" href="posts/infinite_fdm/#rest_code_a25f72d532af4e7085bc025cfaddf219-3"></a><span class="n">dxdxi</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">xi</span><span class="p">:</span> <span class="mi">2</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mf">0.5</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">xi</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>
<a id="rest_code_a25f72d532af4e7085bc025cfaddf219-4" name="rest_code_a25f72d532af4e7085bc025cfaddf219-4" href="posts/infinite_fdm/#rest_code_a25f72d532af4e7085bc025cfaddf219-4"></a><span class="n">dxdxi2</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">xi</span><span class="p">:</span> <span class="o">-</span><span class="mi">4</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mf">0.5</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">xi</span><span class="p">)</span><span class="o">**</span><span class="mi">4</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">tan</span><span class="p">(</span><span class="mf">0.5</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">xi</span><span class="p">)</span>
</pre></div>
<p>and run the function</p>
<div class="code"><pre class="code ipython3"><a id="rest_code_ee70737218d6447d98162f8d24d90f23-1" name="rest_code_ee70737218d6447d98162f8d24d90f23-1" href="posts/infinite_fdm/#rest_code_ee70737218d6447d98162f8d24d90f23-1"></a><span class="n">x</span><span class="p">,</span> <span class="n">vals</span><span class="p">,</span> <span class="n">vecs</span> <span class="o">=</span> <span class="n">mapped_FD</span><span class="p">(</span><span class="n">pot</span><span class="p">,</span> <span class="n">fun</span><span class="p">,</span> <span class="n">dxdxi</span><span class="p">,</span> <span class="n">dxdxi2</span><span class="p">,</span> <span class="n">npts</span><span class="o">=</span><span class="mi">201</span><span class="p">)</span>
<a id="rest_code_ee70737218d6447d98162f8d24d90f23-2" name="rest_code_ee70737218d6447d98162f8d24d90f23-2" href="posts/infinite_fdm/#rest_code_ee70737218d6447d98162f8d24d90f23-2"></a><span class="n">vals</span>
</pre></div>
<p>to obtain the following eigenvalues</p>
<pre class="literal-block">array([0.49997815, 1.49979632, 2.49930872, 3.49824697, 4.49627555,
       5.49295665])</pre>
<p>with this plot</p>
<div class="code"><pre class="code ipython3"><a id="rest_code_3fffec4963c2432bb2baf287c926d3e2-1" name="rest_code_3fffec4963c2432bb2baf287c926d3e2-1" href="posts/infinite_fdm/#rest_code_3fffec4963c2432bb2baf287c926d3e2-1"></a><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<a id="rest_code_3fffec4963c2432bb2baf287c926d3e2-2" name="rest_code_3fffec4963c2432bb2baf287c926d3e2-2" href="posts/infinite_fdm/#rest_code_3fffec4963c2432bb2baf287c926d3e2-2"></a><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">anal_vals</span><span class="p">)</span>
<a id="rest_code_3fffec4963c2432bb2baf287c926d3e2-3" name="rest_code_3fffec4963c2432bb2baf287c926d3e2-3" href="posts/infinite_fdm/#rest_code_3fffec4963c2432bb2baf287c926d3e2-3"></a><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">vals</span><span class="p">,</span> <span class="s2">"o"</span><span class="p">)</span>
<a id="rest_code_3fffec4963c2432bb2baf287c926d3e2-4" name="rest_code_3fffec4963c2432bb2baf287c926d3e2-4" href="posts/infinite_fdm/#rest_code_3fffec4963c2432bb2baf287c926d3e2-4"></a><span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s2">"Analytic"</span><span class="p">,</span> <span class="s2">"Finite differences"</span><span class="p">])</span>
<a id="rest_code_3fffec4963c2432bb2baf287c926d3e2-5" name="rest_code_3fffec4963c2432bb2baf287c926d3e2-5" href="posts/infinite_fdm/#rest_code_3fffec4963c2432bb2baf287c926d3e2-5"></a><span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">"$n$"</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<a id="rest_code_3fffec4963c2432bb2baf287c926d3e2-6" name="rest_code_3fffec4963c2432bb2baf287c926d3e2-6" href="posts/infinite_fdm/#rest_code_3fffec4963c2432bb2baf287c926d3e2-6"></a><span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">"$E_n$"</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<a id="rest_code_3fffec4963c2432bb2baf287c926d3e2-7" name="rest_code_3fffec4963c2432bb2baf287c926d3e2-7" href="posts/infinite_fdm/#rest_code_3fffec4963c2432bb2baf287c926d3e2-7"></a><span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">();</span>
</pre></div>
<img alt="Eigenvalues for the second transformation" class="align-center" src="images/infinite_fdm/eigvals_atan.svg" style="width: 600px;"><p>and the following eigenfunctions.</p>
<div class="code"><pre class="code ipython3"><a id="rest_code_3d0bccc339744af78121674b82d8f955-1" name="rest_code_3d0bccc339744af78121674b82d8f955-1" href="posts/infinite_fdm/#rest_code_3d0bccc339744af78121674b82d8f955-1"></a><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<a id="rest_code_3d0bccc339744af78121674b82d8f955-2" name="rest_code_3d0bccc339744af78121674b82d8f955-2" href="posts/infinite_fdm/#rest_code_3d0bccc339744af78121674b82d8f955-2"></a><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">vecs</span><span class="p">[:,</span> <span class="p">:</span><span class="mi">3</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<a id="rest_code_3d0bccc339744af78121674b82d8f955-3" name="rest_code_3d0bccc339744af78121674b82d8f955-3" href="posts/infinite_fdm/#rest_code_3d0bccc339744af78121674b82d8f955-3"></a><span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">"$x$"</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<a id="rest_code_3d0bccc339744af78121674b82d8f955-4" name="rest_code_3d0bccc339744af78121674b82d8f955-4" href="posts/infinite_fdm/#rest_code_3d0bccc339744af78121674b82d8f955-4"></a><span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">"$|\psi|^2$"</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<a id="rest_code_3d0bccc339744af78121674b82d8f955-5" name="rest_code_3d0bccc339744af78121674b82d8f955-5" href="posts/infinite_fdm/#rest_code_3d0bccc339744af78121674b82d8f955-5"></a><span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
<a id="rest_code_3d0bccc339744af78121674b82d8f955-6" name="rest_code_3d0bccc339744af78121674b82d8f955-6" href="posts/infinite_fdm/#rest_code_3d0bccc339744af78121674b82d8f955-6"></a><span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">"$x$"</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<a id="rest_code_3d0bccc339744af78121674b82d8f955-7" name="rest_code_3d0bccc339744af78121674b82d8f955-7" href="posts/infinite_fdm/#rest_code_3d0bccc339744af78121674b82d8f955-7"></a><span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">"$|\psi_n(x)|^2$"</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<a id="rest_code_3d0bccc339744af78121674b82d8f955-8" name="rest_code_3d0bccc339744af78121674b82d8f955-8" href="posts/infinite_fdm/#rest_code_3d0bccc339744af78121674b82d8f955-8"></a><span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">([])</span>
<a id="rest_code_3d0bccc339744af78121674b82d8f955-9" name="rest_code_3d0bccc339744af78121674b82d8f955-9" href="posts/infinite_fdm/#rest_code_3d0bccc339744af78121674b82d8f955-9"></a><span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">();</span>
</pre></div>
<img alt="Eigenfunctions for the second transformation" class="align-center" src="images/infinite_fdm/eigvecs_atan.svg" style="width: 600px;"></section></section><section id="conclusion"><h3>Conclusion</h3>
<p>The method works fine, although the differential equation is more
convoluted due to the change of variable. Although there are more
elegant methods to consider infinite domains, this is simple enough to
be solved in 10 lines of code.</p>
<p>We can see that the mapping <span class="math">\(\xi = \mathrm{atan}(x)\)</span>, covers
better the domain than <span class="math">\(\xi = \tanh(x)\)</span>, where most of the points
are placed in the center of the interval.</p>
<p>Thanks for reading!</p>
<small>
  <i>
    This post was written in the Jupyter notebook. You can
    <a href="downloads/notebooks/finite_diff_map.ipynb">download</a>
    this notebook, or see a static view on
    <a href="http://nbviewer.jupyter.org/url/nicoguaro.github.io/downloads/notebooks/finite_diff_map.ipynb">nbviewer</a>.
  <i>
</i></i></small></section></section>
</div>
    </article><article class="post h-entry post-text"><header><h1 class="post-title p-name"><a href="posts/cyclic_colormaps/" class="u-url">Cyclic colormaps comparison</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn">Nicolás Guarín-Zapata</span></p>
            <p class="dateline"><a href="posts/cyclic_colormaps/" rel="bookmark"><time class="post-date published dt-published" datetime="2018-01-02T18:55:41-05:00" title="2018-01-02 18:55">2018-01-02 18:55</time></a></p>
                <p class="commentline">
    
    <a href="posts/cyclic_colormaps/#disqus_thread" data-disqus-identifier="cache/posts/cyclic_colormaps.html">Comments</a>


        </p>
</div>
    </header><div class="e-content entry-content">
    <p>I started this post looking for a
<a class="reference external" href="https://en.wikipedia.org/wiki/Diffusion_map">diffusion map</a> on Python,
that I didn't find. Then I continued following an
<a class="reference external" href="http://scikit-learn.org/stable/auto_examples/manifold/plot_compare_methods.html#sphx-glr-auto-examples-manifold-plot-compare-methods-py">example</a>
on <a class="reference external" href="https://en.wikipedia.org/wiki/Nonlinear_dimensionality_reduction">manifold learning</a>
by <a class="reference external" href="https://jakevdp.github.io/">Jake Vanderplas</a> on a <a class="reference external" href="https://commons.wikimedia.org/wiki/File:Diffusion_map_of_a_torodial_helix.jpg">different dataset</a>.
It worked nicely,</p>
<img alt="/images/manifold_learning_toroidal_helix.svg" src="images/manifold_learning_toroidal_helix.svg"><p>but the colormap used is <a class="reference external" href="https://matplotlib.org/examples/color/colormaps_reference.html">Spectral</a>,
that is divergent. This made me think about
using a cyclic colormap, and ended up in
<a class="reference external" href="https://stackoverflow.com/q/23712207/3358223">this StackOverflow</a> question.
And I decided to compare some cyclic colormaps.</p>
<p>I picked up colormaps from different sources</p>
<ul class="simple">
<li>
<p><a class="reference external" href="https://matplotlib.org/cmocean/">cmocean</a>:</p>
<ul>
<li><p>phase</p></li>
</ul>
</li>
<li>
<p><a class="reference external" href="http://paraview.org/">Paraview</a>:</p>
<ul>
<li><p>hue_L60</p></li>
<li><p>erdc_iceFire</p></li>
<li><p>nic_Edge</p></li>
</ul>
</li>
<li>
<p><a class="reference external" href="https://github.com/bokeh/colorcet">Colorcet</a>:</p>
<ul>
<li><p>colorwheel</p></li>
<li><p>cyclic_mrybm_35_75_c68</p></li>
<li><p>cyclic_mygbm_30_95_c78</p></li>
</ul>
</li>
</ul>
<p>and, of course, <code class="docutils literal">hsv</code>. You can download the colormaps in text
format from <a class="reference external" href="downloads/cyclic_colormaps.zip">here</a>.</p>
<section id="comparison"><h2>Comparison</h2>
<p>For all the examples below the following imports are done:</p>
<div class="code"><pre class="code python"><a id="rest_code_623f8ee3c048490d8ee13ab11b305f74-1" name="rest_code_623f8ee3c048490d8ee13ab11b305f74-1" href="posts/cyclic_colormaps/#rest_code_623f8ee3c048490d8ee13ab11b305f74-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">__future__</span><span class="w"> </span><span class="kn">import</span> <span class="n">division</span><span class="p">,</span> <span class="n">print_function</span>
<a id="rest_code_623f8ee3c048490d8ee13ab11b305f74-2" name="rest_code_623f8ee3c048490d8ee13ab11b305f74-2" href="posts/cyclic_colormaps/#rest_code_623f8ee3c048490d8ee13ab11b305f74-2"></a><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<a id="rest_code_623f8ee3c048490d8ee13ab11b305f74-3" name="rest_code_623f8ee3c048490d8ee13ab11b305f74-3" href="posts/cyclic_colormaps/#rest_code_623f8ee3c048490d8ee13ab11b305f74-3"></a><span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<a id="rest_code_623f8ee3c048490d8ee13ab11b305f74-4" name="rest_code_623f8ee3c048490d8ee13ab11b305f74-4" href="posts/cyclic_colormaps/#rest_code_623f8ee3c048490d8ee13ab11b305f74-4"></a><span class="kn">from</span><span class="w"> </span><span class="nn">matplotlib.colors</span><span class="w"> </span><span class="kn">import</span> <span class="n">LinearSegmentedColormap</span>
<a id="rest_code_623f8ee3c048490d8ee13ab11b305f74-5" name="rest_code_623f8ee3c048490d8ee13ab11b305f74-5" href="posts/cyclic_colormaps/#rest_code_623f8ee3c048490d8ee13ab11b305f74-5"></a><span class="kn">from</span><span class="w"> </span><span class="nn">colorspacious</span><span class="w"> </span><span class="kn">import</span> <span class="n">cspace_convert</span>
</pre></div>
<section id="color-map-test-image"><h3>Color map test image</h3>
<p>Peter Kovesi proposed a way to compare cyclic colormaps on a
<a class="reference external" href="http://peterkovesi.com/projects/colourmaps/colourmaptestimage.html">paper</a>
on 2015. It consists of a spiral ramp with an undulation. In polar coordinates
it reads</p>
<div class="math">
\begin{equation*}
c = (A \rho^p \sin(n \theta) + \theta)\, \mathrm{mod}\, 2\pi
\end{equation*}
</div>
<p>with <span class="math">\(A\)</span> the amplitude of the oscilation, <span class="math">\(\rho\)</span> the normalized
radius in [0, 1], <span class="math">\(p\)</span> a positive number, and <span class="math">\(n\)</span> the number
of cycles.</p>
<p>And the following function creates the grid in Python</p>
<div class="code"><pre class="code python"><a id="rest_code_15ae5d25e58f422887b03854f5afb486-1" name="rest_code_15ae5d25e58f422887b03854f5afb486-1" href="posts/cyclic_colormaps/#rest_code_15ae5d25e58f422887b03854f5afb486-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">circle_sine_ramp</span><span class="p">(</span><span class="n">r_max</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">r_min</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">amp</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">5</span><span class="p">,</span> <span class="n">cycles</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span>
<a id="rest_code_15ae5d25e58f422887b03854f5afb486-2" name="rest_code_15ae5d25e58f422887b03854f5afb486-2" href="posts/cyclic_colormaps/#rest_code_15ae5d25e58f422887b03854f5afb486-2"></a>                     <span class="n">power</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">nr</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">ntheta</span><span class="o">=</span><span class="mi">1025</span><span class="p">):</span>
<a id="rest_code_15ae5d25e58f422887b03854f5afb486-3" name="rest_code_15ae5d25e58f422887b03854f5afb486-3" href="posts/cyclic_colormaps/#rest_code_15ae5d25e58f422887b03854f5afb486-3"></a><span class="n">r</span><span class="p">,</span> <span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mgrid</span><span class="p">[</span><span class="n">r_min</span><span class="p">:</span><span class="n">r_max</span><span class="p">:</span><span class="n">nr</span><span class="o">*</span><span class="mi">1</span><span class="n">j</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">:</span><span class="n">ntheta</span><span class="o">*</span><span class="mi">1</span><span class="n">j</span><span class="p">]</span>
<a id="rest_code_15ae5d25e58f422887b03854f5afb486-4" name="rest_code_15ae5d25e58f422887b03854f5afb486-4" href="posts/cyclic_colormaps/#rest_code_15ae5d25e58f422887b03854f5afb486-4"></a><span class="n">r_norm</span> <span class="o">=</span> <span class="p">(</span><span class="n">r</span> <span class="o">-</span> <span class="n">r_min</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">r_max</span> <span class="o">-</span> <span class="n">r_min</span><span class="p">)</span>
<a id="rest_code_15ae5d25e58f422887b03854f5afb486-5" name="rest_code_15ae5d25e58f422887b03854f5afb486-5" href="posts/cyclic_colormaps/#rest_code_15ae5d25e58f422887b03854f5afb486-5"></a><span class="n">vals</span> <span class="o">=</span> <span class="n">amp</span> <span class="o">*</span> <span class="n">r_norm</span><span class="o">**</span><span class="n">power</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">cycles</span><span class="o">*</span><span class="n">t</span><span class="p">)</span> <span class="o">+</span> <span class="n">t</span>
<a id="rest_code_15ae5d25e58f422887b03854f5afb486-6" name="rest_code_15ae5d25e58f422887b03854f5afb486-6" href="posts/cyclic_colormaps/#rest_code_15ae5d25e58f422887b03854f5afb486-6"></a><span class="n">vals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mod</span><span class="p">(</span><span class="n">vals</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span>
<a id="rest_code_15ae5d25e58f422887b03854f5afb486-7" name="rest_code_15ae5d25e58f422887b03854f5afb486-7" href="posts/cyclic_colormaps/#rest_code_15ae5d25e58f422887b03854f5afb486-7"></a><span class="k">return</span> <span class="n">t</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">vals</span>
</pre></div>
<p>The following is the result</p>
<img alt="/images/sine_helix_cyclic_cmap.png" src="images/sine_helix_cyclic_cmap.png"></section><section id="colorblindness-test"><h3>Colorblindness test</h3>
<div class="code"><pre class="code python"><a id="rest_code_1bdb57aef4ed4f17aeab500923883587-1" name="rest_code_1bdb57aef4ed4f17aeab500923883587-1" href="posts/cyclic_colormaps/#rest_code_1bdb57aef4ed4f17aeab500923883587-1"></a><span class="n">t</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">vals</span> <span class="o">=</span> <span class="n">circle_sine_ramp</span><span class="p">(</span><span class="n">cycles</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<a id="rest_code_1bdb57aef4ed4f17aeab500923883587-2" name="rest_code_1bdb57aef4ed4f17aeab500923883587-2" href="posts/cyclic_colormaps/#rest_code_1bdb57aef4ed4f17aeab500923883587-2"></a><span class="n">cmaps</span> <span class="o">=</span> <span class="p">[</span><span class="s2">"hsv"</span><span class="p">,</span>
<a id="rest_code_1bdb57aef4ed4f17aeab500923883587-3" name="rest_code_1bdb57aef4ed4f17aeab500923883587-3" href="posts/cyclic_colormaps/#rest_code_1bdb57aef4ed4f17aeab500923883587-3"></a>         <span class="s2">"cmocean_phase"</span><span class="p">,</span>
<a id="rest_code_1bdb57aef4ed4f17aeab500923883587-4" name="rest_code_1bdb57aef4ed4f17aeab500923883587-4" href="posts/cyclic_colormaps/#rest_code_1bdb57aef4ed4f17aeab500923883587-4"></a>         <span class="s2">"hue_L60"</span><span class="p">,</span>
<a id="rest_code_1bdb57aef4ed4f17aeab500923883587-5" name="rest_code_1bdb57aef4ed4f17aeab500923883587-5" href="posts/cyclic_colormaps/#rest_code_1bdb57aef4ed4f17aeab500923883587-5"></a>         <span class="s2">"erdc_iceFire"</span><span class="p">,</span>
<a id="rest_code_1bdb57aef4ed4f17aeab500923883587-6" name="rest_code_1bdb57aef4ed4f17aeab500923883587-6" href="posts/cyclic_colormaps/#rest_code_1bdb57aef4ed4f17aeab500923883587-6"></a>         <span class="s2">"nic_Edge"</span><span class="p">,</span>
<a id="rest_code_1bdb57aef4ed4f17aeab500923883587-7" name="rest_code_1bdb57aef4ed4f17aeab500923883587-7" href="posts/cyclic_colormaps/#rest_code_1bdb57aef4ed4f17aeab500923883587-7"></a>         <span class="s2">"colorwheel"</span><span class="p">,</span>
<a id="rest_code_1bdb57aef4ed4f17aeab500923883587-8" name="rest_code_1bdb57aef4ed4f17aeab500923883587-8" href="posts/cyclic_colormaps/#rest_code_1bdb57aef4ed4f17aeab500923883587-8"></a>         <span class="s2">"cyclic_mrybm"</span><span class="p">,</span>
<a id="rest_code_1bdb57aef4ed4f17aeab500923883587-9" name="rest_code_1bdb57aef4ed4f17aeab500923883587-9" href="posts/cyclic_colormaps/#rest_code_1bdb57aef4ed4f17aeab500923883587-9"></a>         <span class="s2">"cyclic_mygbm"</span><span class="p">]</span>
<a id="rest_code_1bdb57aef4ed4f17aeab500923883587-10" name="rest_code_1bdb57aef4ed4f17aeab500923883587-10" href="posts/cyclic_colormaps/#rest_code_1bdb57aef4ed4f17aeab500923883587-10"></a><span class="n">severity</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">50</span><span class="p">]</span>
<a id="rest_code_1bdb57aef4ed4f17aeab500923883587-11" name="rest_code_1bdb57aef4ed4f17aeab500923883587-11" href="posts/cyclic_colormaps/#rest_code_1bdb57aef4ed4f17aeab500923883587-11"></a><span class="k">for</span> <span class="n">colormap</span> <span class="ow">in</span> <span class="n">cmaps</span><span class="p">:</span>
<a id="rest_code_1bdb57aef4ed4f17aeab500923883587-12" name="rest_code_1bdb57aef4ed4f17aeab500923883587-12" href="posts/cyclic_colormaps/#rest_code_1bdb57aef4ed4f17aeab500923883587-12"></a>    <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="n">colormap</span> <span class="o">+</span> <span class="s2">".txt"</span><span class="p">)</span>
<a id="rest_code_1bdb57aef4ed4f17aeab500923883587-13" name="rest_code_1bdb57aef4ed4f17aeab500923883587-13" href="posts/cyclic_colormaps/#rest_code_1bdb57aef4ed4f17aeab500923883587-13"></a>    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<a id="rest_code_1bdb57aef4ed4f17aeab500923883587-14" name="rest_code_1bdb57aef4ed4f17aeab500923883587-14" href="posts/cyclic_colormaps/#rest_code_1bdb57aef4ed4f17aeab500923883587-14"></a>    <span class="k">for</span> <span class="n">cont</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
<a id="rest_code_1bdb57aef4ed4f17aeab500923883587-15" name="rest_code_1bdb57aef4ed4f17aeab500923883587-15" href="posts/cyclic_colormaps/#rest_code_1bdb57aef4ed4f17aeab500923883587-15"></a>        <span class="n">cvd_space</span> <span class="o">=</span> <span class="p">{</span><span class="s2">"name"</span><span class="p">:</span> <span class="s2">"sRGB1+CVD"</span><span class="p">,</span>
<a id="rest_code_1bdb57aef4ed4f17aeab500923883587-16" name="rest_code_1bdb57aef4ed4f17aeab500923883587-16" href="posts/cyclic_colormaps/#rest_code_1bdb57aef4ed4f17aeab500923883587-16"></a>             <span class="s2">"cvd_type"</span><span class="p">:</span> <span class="n">cvd_type</span><span class="p">[</span><span class="n">cont</span><span class="p">],</span>
<a id="rest_code_1bdb57aef4ed4f17aeab500923883587-17" name="rest_code_1bdb57aef4ed4f17aeab500923883587-17" href="posts/cyclic_colormaps/#rest_code_1bdb57aef4ed4f17aeab500923883587-17"></a>             <span class="s2">"severity"</span><span class="p">:</span> <span class="n">severity</span><span class="p">[</span><span class="n">cont</span><span class="p">]}</span>
<a id="rest_code_1bdb57aef4ed4f17aeab500923883587-18" name="rest_code_1bdb57aef4ed4f17aeab500923883587-18" href="posts/cyclic_colormaps/#rest_code_1bdb57aef4ed4f17aeab500923883587-18"></a>        <span class="n">data2</span> <span class="o">=</span> <span class="n">cspace_convert</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">cvd_space</span><span class="p">,</span> <span class="s2">"sRGB1"</span><span class="p">)</span>
<a id="rest_code_1bdb57aef4ed4f17aeab500923883587-19" name="rest_code_1bdb57aef4ed4f17aeab500923883587-19" href="posts/cyclic_colormaps/#rest_code_1bdb57aef4ed4f17aeab500923883587-19"></a>        <span class="n">data2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">data2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<a id="rest_code_1bdb57aef4ed4f17aeab500923883587-20" name="rest_code_1bdb57aef4ed4f17aeab500923883587-20" href="posts/cyclic_colormaps/#rest_code_1bdb57aef4ed4f17aeab500923883587-20"></a>        <span class="n">cmap</span> <span class="o">=</span> <span class="n">LinearSegmentedColormap</span><span class="o">.</span><span class="n">from_list</span><span class="p">(</span><span class="s1">'my_colormap'</span><span class="p">,</span> <span class="n">data2</span><span class="p">)</span>
<a id="rest_code_1bdb57aef4ed4f17aeab500923883587-21" name="rest_code_1bdb57aef4ed4f17aeab500923883587-21" href="posts/cyclic_colormaps/#rest_code_1bdb57aef4ed4f17aeab500923883587-21"></a>        <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">cont</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="s2">"polar"</span><span class="p">)</span>
<a id="rest_code_1bdb57aef4ed4f17aeab500923883587-22" name="rest_code_1bdb57aef4ed4f17aeab500923883587-22" href="posts/cyclic_colormaps/#rest_code_1bdb57aef4ed4f17aeab500923883587-22"></a>        <span class="n">ax</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">vals</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">)</span>
<a id="rest_code_1bdb57aef4ed4f17aeab500923883587-23" name="rest_code_1bdb57aef4ed4f17aeab500923883587-23" href="posts/cyclic_colormaps/#rest_code_1bdb57aef4ed4f17aeab500923883587-23"></a>        <span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">([])</span>
<a id="rest_code_1bdb57aef4ed4f17aeab500923883587-24" name="rest_code_1bdb57aef4ed4f17aeab500923883587-24" href="posts/cyclic_colormaps/#rest_code_1bdb57aef4ed4f17aeab500923883587-24"></a>        <span class="n">ax</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([])</span>
<a id="rest_code_1bdb57aef4ed4f17aeab500923883587-25" name="rest_code_1bdb57aef4ed4f17aeab500923883587-25" href="posts/cyclic_colormaps/#rest_code_1bdb57aef4ed4f17aeab500923883587-25"></a>    <span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="n">colormap</span><span class="p">)</span>
<a id="rest_code_1bdb57aef4ed4f17aeab500923883587-26" name="rest_code_1bdb57aef4ed4f17aeab500923883587-26" href="posts/cyclic_colormaps/#rest_code_1bdb57aef4ed4f17aeab500923883587-26"></a>    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<a id="rest_code_1bdb57aef4ed4f17aeab500923883587-27" name="rest_code_1bdb57aef4ed4f17aeab500923883587-27" href="posts/cyclic_colormaps/#rest_code_1bdb57aef4ed4f17aeab500923883587-27"></a>    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">colormap</span> <span class="o">+</span> <span class="s2">".png"</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>
</pre></div>
<figure class="align-center"><img alt="/images/hsv_eval.png" src="images/hsv_eval.png"><figcaption><p><code class="docutils literal">hsv</code> colormap comparison for different color vision deficiencies.</p>
</figcaption></figure><figure class="align-center"><img alt="/images/cmocean_phase_eval.png" src="images/cmocean_phase_eval.png"><figcaption><p><code class="docutils literal">Phase</code> colormap comparison for different color vision deficiencies.</p>
</figcaption></figure><figure class="align-center"><img alt="/images/hue_L60_eval.png" src="images/hue_L60_eval.png"><figcaption><p><code class="docutils literal">hue_L60</code> colormap comparison for different color vision deficiencies.</p>
</figcaption></figure><figure class="align-center"><img alt="/images/erdc_iceFire_eval.png" src="images/erdc_iceFire_eval.png"><figcaption><p><code class="docutils literal">erdc_iceFire</code> colormap comparison for different color vision deficiencies.</p>
</figcaption></figure><figure class="align-center"><img alt="/images/nic_Edge_eval.png" src="images/nic_Edge_eval.png"><figcaption><p><code class="docutils literal">nic_Edge</code> colormap comparison for different color vision deficiencies.</p>
</figcaption></figure><figure class="align-center"><img alt="/images/colorwheel_eval.png" src="images/colorwheel_eval.png"><figcaption><p><code class="docutils literal">Colorwheel</code> colormap comparison for different color vision deficiencies.</p>
</figcaption></figure><figure class="align-center"><img alt="/images/cyclic_mrybm_eval.png" src="images/cyclic_mrybm_eval.png"><figcaption><p><code class="docutils literal">Cyclic_mrybm</code> colormap comparison for different color vision deficiencies.</p>
</figcaption></figure><figure class="align-center"><img alt="/images/cyclic_mygbm_eval.png" src="images/cyclic_mygbm_eval.png"><figcaption><p><code class="docutils literal">Cyclic_mygbm</code> colormap comparison for different color vision deficiencies.</p>
</figcaption></figure></section></section><section id="randomly-generated-cyclic-colormaps"><h2>Randomly generated cyclic colormaps</h2>
<p>What if we generate some random colormaps that are cyclic? How would they
look like?</p>
<p>Following are the snippet and resulting colormaps.</p>
<div class="code"><pre class="code python"><a id="rest_code_589e1cb0f559438d88b1d60f8002373c-1" name="rest_code_589e1cb0f559438d88b1d60f8002373c-1" href="posts/cyclic_colormaps/#rest_code_589e1cb0f559438d88b1d60f8002373c-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">__future__</span><span class="w"> </span><span class="kn">import</span> <span class="n">division</span><span class="p">,</span> <span class="n">print_function</span>
<a id="rest_code_589e1cb0f559438d88b1d60f8002373c-2" name="rest_code_589e1cb0f559438d88b1d60f8002373c-2" href="posts/cyclic_colormaps/#rest_code_589e1cb0f559438d88b1d60f8002373c-2"></a><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<a id="rest_code_589e1cb0f559438d88b1d60f8002373c-3" name="rest_code_589e1cb0f559438d88b1d60f8002373c-3" href="posts/cyclic_colormaps/#rest_code_589e1cb0f559438d88b1d60f8002373c-3"></a><span class="kn">from</span><span class="w"> </span><span class="nn">mpl_toolkits.mplot3d</span><span class="w"> </span><span class="kn">import</span> <span class="n">Axes3D</span>
<a id="rest_code_589e1cb0f559438d88b1d60f8002373c-4" name="rest_code_589e1cb0f559438d88b1d60f8002373c-4" href="posts/cyclic_colormaps/#rest_code_589e1cb0f559438d88b1d60f8002373c-4"></a><span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<a id="rest_code_589e1cb0f559438d88b1d60f8002373c-5" name="rest_code_589e1cb0f559438d88b1d60f8002373c-5" href="posts/cyclic_colormaps/#rest_code_589e1cb0f559438d88b1d60f8002373c-5"></a><span class="kn">from</span><span class="w"> </span><span class="nn">matplotlib.colors</span><span class="w"> </span><span class="kn">import</span> <span class="n">LinearSegmentedColormap</span>
<a id="rest_code_589e1cb0f559438d88b1d60f8002373c-6" name="rest_code_589e1cb0f559438d88b1d60f8002373c-6" href="posts/cyclic_colormaps/#rest_code_589e1cb0f559438d88b1d60f8002373c-6"></a>
<a id="rest_code_589e1cb0f559438d88b1d60f8002373c-7" name="rest_code_589e1cb0f559438d88b1d60f8002373c-7" href="posts/cyclic_colormaps/#rest_code_589e1cb0f559438d88b1d60f8002373c-7"></a>
<a id="rest_code_589e1cb0f559438d88b1d60f8002373c-8" name="rest_code_589e1cb0f559438d88b1d60f8002373c-8" href="posts/cyclic_colormaps/#rest_code_589e1cb0f559438d88b1d60f8002373c-8"></a><span class="c1"># Next line to silence pyflakes. This import is needed.</span>
<a id="rest_code_589e1cb0f559438d88b1d60f8002373c-9" name="rest_code_589e1cb0f559438d88b1d60f8002373c-9" href="posts/cyclic_colormaps/#rest_code_589e1cb0f559438d88b1d60f8002373c-9"></a><span class="n">Axes3D</span>
<a id="rest_code_589e1cb0f559438d88b1d60f8002373c-10" name="rest_code_589e1cb0f559438d88b1d60f8002373c-10" href="posts/cyclic_colormaps/#rest_code_589e1cb0f559438d88b1d60f8002373c-10"></a>
<a id="rest_code_589e1cb0f559438d88b1d60f8002373c-11" name="rest_code_589e1cb0f559438d88b1d60f8002373c-11" href="posts/cyclic_colormaps/#rest_code_589e1cb0f559438d88b1d60f8002373c-11"></a><span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="s2">"all"</span><span class="p">)</span>
<a id="rest_code_589e1cb0f559438d88b1d60f8002373c-12" name="rest_code_589e1cb0f559438d88b1d60f8002373c-12" href="posts/cyclic_colormaps/#rest_code_589e1cb0f559438d88b1d60f8002373c-12"></a><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<a id="rest_code_589e1cb0f559438d88b1d60f8002373c-13" name="rest_code_589e1cb0f559438d88b1d60f8002373c-13" href="posts/cyclic_colormaps/#rest_code_589e1cb0f559438d88b1d60f8002373c-13"></a><span class="n">fig2</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<a id="rest_code_589e1cb0f559438d88b1d60f8002373c-14" name="rest_code_589e1cb0f559438d88b1d60f8002373c-14" href="posts/cyclic_colormaps/#rest_code_589e1cb0f559438d88b1d60f8002373c-14"></a><span class="n">nx</span> <span class="o">=</span> <span class="mi">4</span>
<a id="rest_code_589e1cb0f559438d88b1d60f8002373c-15" name="rest_code_589e1cb0f559438d88b1d60f8002373c-15" href="posts/cyclic_colormaps/#rest_code_589e1cb0f559438d88b1d60f8002373c-15"></a><span class="n">ny</span> <span class="o">=</span> <span class="mi">4</span>
<a id="rest_code_589e1cb0f559438d88b1d60f8002373c-16" name="rest_code_589e1cb0f559438d88b1d60f8002373c-16" href="posts/cyclic_colormaps/#rest_code_589e1cb0f559438d88b1d60f8002373c-16"></a><span class="n">azimuths</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">361</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<a id="rest_code_589e1cb0f559438d88b1d60f8002373c-17" name="rest_code_589e1cb0f559438d88b1d60f8002373c-17" href="posts/cyclic_colormaps/#rest_code_589e1cb0f559438d88b1d60f8002373c-17"></a><span class="n">zeniths</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mi">70</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<a id="rest_code_589e1cb0f559438d88b1d60f8002373c-18" name="rest_code_589e1cb0f559438d88b1d60f8002373c-18" href="posts/cyclic_colormaps/#rest_code_589e1cb0f559438d88b1d60f8002373c-18"></a><span class="n">values</span> <span class="o">=</span> <span class="n">azimuths</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">30</span><span class="p">,</span> <span class="mi">361</span><span class="p">))</span>
<a id="rest_code_589e1cb0f559438d88b1d60f8002373c-19" name="rest_code_589e1cb0f559438d88b1d60f8002373c-19" href="posts/cyclic_colormaps/#rest_code_589e1cb0f559438d88b1d60f8002373c-19"></a><span class="k">for</span> <span class="n">cont</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nx</span> <span class="o">*</span> <span class="n">ny</span><span class="p">):</span>
<a id="rest_code_589e1cb0f559438d88b1d60f8002373c-20" name="rest_code_589e1cb0f559438d88b1d60f8002373c-20" href="posts/cyclic_colormaps/#rest_code_589e1cb0f559438d88b1d60f8002373c-20"></a>    <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="n">cont</span><span class="p">)</span>
<a id="rest_code_589e1cb0f559438d88b1d60f8002373c-21" name="rest_code_589e1cb0f559438d88b1d60f8002373c-21" href="posts/cyclic_colormaps/#rest_code_589e1cb0f559438d88b1d60f8002373c-21"></a>    <span class="n">rad</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)</span>
<a id="rest_code_589e1cb0f559438d88b1d60f8002373c-22" name="rest_code_589e1cb0f559438d88b1d60f8002373c-22" href="posts/cyclic_colormaps/#rest_code_589e1cb0f559438d88b1d60f8002373c-22"></a>    <span class="n">center</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="n">rad</span><span class="p">,</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">rad</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<a id="rest_code_589e1cb0f559438d88b1d60f8002373c-23" name="rest_code_589e1cb0f559438d88b1d60f8002373c-23" href="posts/cyclic_colormaps/#rest_code_589e1cb0f559438d88b1d60f8002373c-23"></a>    <span class="n">mat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<a id="rest_code_589e1cb0f559438d88b1d60f8002373c-24" name="rest_code_589e1cb0f559438d88b1d60f8002373c-24" href="posts/cyclic_colormaps/#rest_code_589e1cb0f559438d88b1d60f8002373c-24"></a>    <span class="n">rot_mat</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">qr</span><span class="p">(</span><span class="n">mat</span><span class="p">)</span>
<a id="rest_code_589e1cb0f559438d88b1d60f8002373c-25" name="rest_code_589e1cb0f559438d88b1d60f8002373c-25" href="posts/cyclic_colormaps/#rest_code_589e1cb0f559438d88b1d60f8002373c-25"></a>    <span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mi">256</span><span class="p">)</span>
<a id="rest_code_589e1cb0f559438d88b1d60f8002373c-26" name="rest_code_589e1cb0f559438d88b1d60f8002373c-26" href="posts/cyclic_colormaps/#rest_code_589e1cb0f559438d88b1d60f8002373c-26"></a>    <span class="n">x</span> <span class="o">=</span> <span class="n">rad</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
<a id="rest_code_589e1cb0f559438d88b1d60f8002373c-27" name="rest_code_589e1cb0f559438d88b1d60f8002373c-27" href="posts/cyclic_colormaps/#rest_code_589e1cb0f559438d88b1d60f8002373c-27"></a>    <span class="n">y</span> <span class="o">=</span> <span class="n">rad</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
<a id="rest_code_589e1cb0f559438d88b1d60f8002373c-28" name="rest_code_589e1cb0f559438d88b1d60f8002373c-28" href="posts/cyclic_colormaps/#rest_code_589e1cb0f559438d88b1d60f8002373c-28"></a>    <span class="n">z</span> <span class="o">=</span> <span class="mf">0.0</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
<a id="rest_code_589e1cb0f559438d88b1d60f8002373c-29" name="rest_code_589e1cb0f559438d88b1d60f8002373c-29" href="posts/cyclic_colormaps/#rest_code_589e1cb0f559438d88b1d60f8002373c-29"></a>    <span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">((</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">))</span>
<a id="rest_code_589e1cb0f559438d88b1d60f8002373c-30" name="rest_code_589e1cb0f559438d88b1d60f8002373c-30" href="posts/cyclic_colormaps/#rest_code_589e1cb0f559438d88b1d60f8002373c-30"></a>    <span class="n">X</span> <span class="o">=</span> <span class="n">rot_mat</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">X</span><span class="p">)</span> <span class="o">+</span> <span class="n">center</span>
<a id="rest_code_589e1cb0f559438d88b1d60f8002373c-31" name="rest_code_589e1cb0f559438d88b1d60f8002373c-31" href="posts/cyclic_colormaps/#rest_code_589e1cb0f559438d88b1d60f8002373c-31"></a>
<a id="rest_code_589e1cb0f559438d88b1d60f8002373c-32" name="rest_code_589e1cb0f559438d88b1d60f8002373c-32" href="posts/cyclic_colormaps/#rest_code_589e1cb0f559438d88b1d60f8002373c-32"></a>    <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">ny</span><span class="p">,</span> <span class="n">nx</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">cont</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="s1">'polar'</span><span class="p">)</span>
<a id="rest_code_589e1cb0f559438d88b1d60f8002373c-33" name="rest_code_589e1cb0f559438d88b1d60f8002373c-33" href="posts/cyclic_colormaps/#rest_code_589e1cb0f559438d88b1d60f8002373c-33"></a>    <span class="n">cmap</span> <span class="o">=</span> <span class="n">LinearSegmentedColormap</span><span class="o">.</span><span class="n">from_list</span><span class="p">(</span><span class="s1">'my_colormap'</span><span class="p">,</span> <span class="n">X</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
<a id="rest_code_589e1cb0f559438d88b1d60f8002373c-34" name="rest_code_589e1cb0f559438d88b1d60f8002373c-34" href="posts/cyclic_colormaps/#rest_code_589e1cb0f559438d88b1d60f8002373c-34"></a>    <span class="n">ax</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span><span class="n">azimuths</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mf">180.0</span><span class="p">,</span> <span class="n">zeniths</span><span class="p">,</span> <span class="n">values</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">)</span>
<a id="rest_code_589e1cb0f559438d88b1d60f8002373c-35" name="rest_code_589e1cb0f559438d88b1d60f8002373c-35" href="posts/cyclic_colormaps/#rest_code_589e1cb0f559438d88b1d60f8002373c-35"></a>    <span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">([])</span>
<a id="rest_code_589e1cb0f559438d88b1d60f8002373c-36" name="rest_code_589e1cb0f559438d88b1d60f8002373c-36" href="posts/cyclic_colormaps/#rest_code_589e1cb0f559438d88b1d60f8002373c-36"></a>    <span class="n">ax</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([])</span>
<a id="rest_code_589e1cb0f559438d88b1d60f8002373c-37" name="rest_code_589e1cb0f559438d88b1d60f8002373c-37" href="posts/cyclic_colormaps/#rest_code_589e1cb0f559438d88b1d60f8002373c-37"></a>
<a id="rest_code_589e1cb0f559438d88b1d60f8002373c-38" name="rest_code_589e1cb0f559438d88b1d60f8002373c-38" href="posts/cyclic_colormaps/#rest_code_589e1cb0f559438d88b1d60f8002373c-38"></a>    <span class="n">ax2</span> <span class="o">=</span> <span class="n">fig2</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">ny</span><span class="p">,</span> <span class="n">nx</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">cont</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="s1">'3d'</span><span class="p">)</span>
<a id="rest_code_589e1cb0f559438d88b1d60f8002373c-39" name="rest_code_589e1cb0f559438d88b1d60f8002373c-39" href="posts/cyclic_colormaps/#rest_code_589e1cb0f559438d88b1d60f8002373c-39"></a>    <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:],</span> <span class="n">X</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:],</span> <span class="n">X</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="p">:])</span>
<a id="rest_code_589e1cb0f559438d88b1d60f8002373c-40" name="rest_code_589e1cb0f559438d88b1d60f8002373c-40" href="posts/cyclic_colormaps/#rest_code_589e1cb0f559438d88b1d60f8002373c-40"></a>    <span class="n">ax2</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<a id="rest_code_589e1cb0f559438d88b1d60f8002373c-41" name="rest_code_589e1cb0f559438d88b1d60f8002373c-41" href="posts/cyclic_colormaps/#rest_code_589e1cb0f559438d88b1d60f8002373c-41"></a>    <span class="n">ax2</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<a id="rest_code_589e1cb0f559438d88b1d60f8002373c-42" name="rest_code_589e1cb0f559438d88b1d60f8002373c-42" href="posts/cyclic_colormaps/#rest_code_589e1cb0f559438d88b1d60f8002373c-42"></a>    <span class="n">ax2</span><span class="o">.</span><span class="n">set_zlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<a id="rest_code_589e1cb0f559438d88b1d60f8002373c-43" name="rest_code_589e1cb0f559438d88b1d60f8002373c-43" href="posts/cyclic_colormaps/#rest_code_589e1cb0f559438d88b1d60f8002373c-43"></a>    <span class="n">ax2</span><span class="o">.</span><span class="n">view_init</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="o">-</span><span class="mi">60</span><span class="p">)</span>
<a id="rest_code_589e1cb0f559438d88b1d60f8002373c-44" name="rest_code_589e1cb0f559438d88b1d60f8002373c-44" href="posts/cyclic_colormaps/#rest_code_589e1cb0f559438d88b1d60f8002373c-44"></a>    <span class="n">ax2</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">])</span>
<a id="rest_code_589e1cb0f559438d88b1d60f8002373c-45" name="rest_code_589e1cb0f559438d88b1d60f8002373c-45" href="posts/cyclic_colormaps/#rest_code_589e1cb0f559438d88b1d60f8002373c-45"></a>    <span class="n">ax2</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">])</span>
<a id="rest_code_589e1cb0f559438d88b1d60f8002373c-46" name="rest_code_589e1cb0f559438d88b1d60f8002373c-46" href="posts/cyclic_colormaps/#rest_code_589e1cb0f559438d88b1d60f8002373c-46"></a>    <span class="n">ax2</span><span class="o">.</span><span class="n">set_zticks</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">])</span>
<a id="rest_code_589e1cb0f559438d88b1d60f8002373c-47" name="rest_code_589e1cb0f559438d88b1d60f8002373c-47" href="posts/cyclic_colormaps/#rest_code_589e1cb0f559438d88b1d60f8002373c-47"></a>    <span class="n">ax2</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">([])</span>
<a id="rest_code_589e1cb0f559438d88b1d60f8002373c-48" name="rest_code_589e1cb0f559438d88b1d60f8002373c-48" href="posts/cyclic_colormaps/#rest_code_589e1cb0f559438d88b1d60f8002373c-48"></a>    <span class="n">ax2</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">([])</span>
<a id="rest_code_589e1cb0f559438d88b1d60f8002373c-49" name="rest_code_589e1cb0f559438d88b1d60f8002373c-49" href="posts/cyclic_colormaps/#rest_code_589e1cb0f559438d88b1d60f8002373c-49"></a>    <span class="n">ax2</span><span class="o">.</span><span class="n">set_zticklabels</span><span class="p">([])</span>
<a id="rest_code_589e1cb0f559438d88b1d60f8002373c-50" name="rest_code_589e1cb0f559438d88b1d60f8002373c-50" href="posts/cyclic_colormaps/#rest_code_589e1cb0f559438d88b1d60f8002373c-50"></a>
<a id="rest_code_589e1cb0f559438d88b1d60f8002373c-51" name="rest_code_589e1cb0f559438d88b1d60f8002373c-51" href="posts/cyclic_colormaps/#rest_code_589e1cb0f559438d88b1d60f8002373c-51"></a>
<a id="rest_code_589e1cb0f559438d88b1d60f8002373c-52" name="rest_code_589e1cb0f559438d88b1d60f8002373c-52" href="posts/cyclic_colormaps/#rest_code_589e1cb0f559438d88b1d60f8002373c-52"></a><span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">"random_cmaps.png"</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span> <span class="n">transparent</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="rest_code_589e1cb0f559438d88b1d60f8002373c-53" name="rest_code_589e1cb0f559438d88b1d60f8002373c-53" href="posts/cyclic_colormaps/#rest_code_589e1cb0f559438d88b1d60f8002373c-53"></a><span class="n">fig2</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">"random_cmaps_traj.svg"</span><span class="p">,</span> <span class="n">transparent</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
<figure class="align-center"><img alt="/images/random_cmaps.png" src="images/random_cmaps.png"><figcaption><p>16 randomly generated colormaps.</p>
</figcaption></figure><figure class="align-center"><img alt="/images/random_cmaps_traj.svg" src="images/random_cmaps_traj.svg"><figcaption><p>Trajectories in RGB space for the randomly generated colormaps.</p>
</figcaption></figure><p>A good idea would be to take these colormaps and optimize some perceptual
parameters such as lightness to get some usable ones.</p>
</section><section id="conclusions"><h2>Conclusions</h2>
<p>I probably would use <code class="docutils literal">phase</code>, <code class="docutils literal">colorwheel</code>, or <code class="docutils literal">mrybm</code> in the
future.</p>
<figure class="align-center"><img alt="/images/toroidal_helix_phase.svg" src="images/toroidal_helix_phase.svg"><figcaption><p>Initial image using <code class="docutils literal">phase</code>.</p>
</figcaption></figure><figure class="align-center"><img alt="/images/toroidal_helix_colorwheel.svg" src="images/toroidal_helix_colorwheel.svg"><figcaption><p>Initial image using <code class="docutils literal">colorwheel</code>.</p>
</figcaption></figure><figure class="align-center"><img alt="/images/toroidal_helix_mrybm.svg" src="images/toroidal_helix_mrybm.svg"><figcaption><p>Initial image using <code class="docutils literal">mrybm</code>.</p>
</figcaption></figure></section><section id="references"><h2>References</h2>
<ol class="arabic simple">
<li><p>Peter Kovesi. Good Colour Maps: How to Design Them.
arXiv:1509.03700 [cs.GR] 2015</p></li>
</ol></section>
</div>
    </article><article class="post h-entry post-text"><header><h1 class="post-title p-name"><a href="posts/putnam_prob/" class="u-url">Probability that a random tetrahedron over a sphere contains its center</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn">Nicolás Guarín-Zapata</span></p>
            <p class="dateline"><a href="posts/putnam_prob/" rel="bookmark"><time class="post-date published dt-published" datetime="2017-12-13T15:24:52-05:00" title="2017-12-13 15:24">2017-12-13 15:24</time></a></p>
                <p class="commentline">
    
    <a href="posts/putnam_prob/#disqus_thread" data-disqus-identifier="cache/posts/putnam_prob.html">Comments</a>


        </p>
</div>
    </header><div class="e-content entry-content">
    <p>I got interested in this problem watching the YouTube channel
<a class="reference external" href="https://www.youtube.com/channel/UCYO_jab_esuFRV4b17AJtAw">3Blue1Brown</a>,
by Grant Sanderson, where he explains a way to tackle the problem that
is just … elegant!</p>
<p>I can't emphasize enough how much I like this channel. For example,
his approach to linear algebra in
<a class="reference external" href="https://www.youtube.com/watch?v=kjBOesZCoqc&amp;list=PLZHQObOWTQDPD3MizzM2xVFitgF8hE_ab">Essence of linear algebra</a> is really
good. I mention it, just in case you don't know it.</p>
<section id="the-problem"><h2>The problem</h2>
<p>Let's talk business now. The problem was originally part of the 53rd
<a class="reference external" href="http://kskedlaya.org/putnam-archive/1992.pdf">Putnam competition on 1992</a>
and was stated as</p>
<blockquote>
<p>Four points are chosen at random on the surface of a
sphere.   What is the probability that the center of the
sphere lies inside the tetrahedron whose vertices are at
the four points?  (It is understood that each point is in-
dependently chosen relative to a uniform distribution on
the sphere.)</p>
</blockquote>
<p>As shown in the mentioned video, the probability is <span class="math">\(1/8\)</span>. Let's
come with an algorithm to obtain this result —approximately, at least.</p>
</section><section id="the-proposed-approach"><h2>The proposed approach</h2>
<p>The approach that we are going to use is pretty straightforward. We are
going to obtain a sample of (independent) random sets, with four points
each, and check how many of them satisfy the condition of being inside
the tetrahedron with the points as vertices.</p>
<p>For this approach to work, we need two things:</p>
<ol class="arabic simple">
<li><p>A way to generate random numbers uniformly distributed. This is already
in <code class="docutils literal">numpy.random.uniform</code>, so we don't need to do much about it.</p></li>
<li><p>A way to check if a point is inside a tetrahedron.</p></li>
</ol>
<section id="checking-that-a-point-is-inside-a-tetrahedron"><h3>Checking that a point is inside a tetrahedron</h3>
<p>To find if a point is inside a tetrahedron, we could compute the
<a class="reference external" href="https://en.wikipedia.org/wiki/Barycentric_coordinate_system">barycentric coordinates</a>
for that point and check that all of them are have the same sign. Equivalently,
as proposed <a class="reference external" href="http://steve.hollasch.net/cgindex/geometry/ptintet.html">here</a>,
we can check that the determinants of the matrices</p>
<div class="math">
\begin{equation*}
M_0 =
\begin{bmatrix}
x_0 &amp;y_0 &amp;z_0 &amp;1\\
x_1 &amp;y_1 &amp;z_1 &amp;1\\
x_2 &amp;y_2 &amp;z_2 &amp;1\\
x_3 &amp;y_3 &amp;z_3 &amp;1
\end{bmatrix}\, ,
\end{equation*}
</div>
<div class="math">
\begin{equation*}
M_1 =
\begin{bmatrix}
x &amp;y &amp;z &amp;1\\
x_1 &amp;y_1 &amp;z_1 &amp;1\\
x_2 &amp;y_2 &amp;z_2 &amp;1\\
x_3 &amp;y_3 &amp;z_3 &amp;1
\end{bmatrix}\, ,
\end{equation*}
</div>
<div class="math">
\begin{equation*}
M_2 =
\begin{bmatrix}
x_0 &amp;y_0 &amp;z_0 &amp;1\\
x &amp;y &amp;z &amp;1\\
x_2 &amp;y_2 &amp;z_2 &amp;1\\
x_3 &amp;y_3 &amp;z_3 &amp;1
\end{bmatrix}\, ,
\end{equation*}
</div>
<div class="math">
\begin{equation*}
M_3 =
\begin{bmatrix}
x_0 &amp;y_0 &amp;z_0 &amp;1\\
x_1 &amp;y_1 &amp;z_1 &amp;1\\
x &amp;y &amp;z &amp;1\\
x_3 &amp;y_3 &amp;z_3 &amp;1
\end{bmatrix}\, ,
\end{equation*}
</div>
<div class="math">
\begin{equation*}
M_4 =
\begin{bmatrix}
x_0 &amp;y_0 &amp;z_0 &amp;1\\
x_1 &amp;y_1 &amp;z_1 &amp;1\\
x_2 &amp;y_2 &amp;z_2 &amp;1\\
x &amp;y &amp;z &amp;1
\end{bmatrix}\, ,
\end{equation*}
</div>
<p>have the same sign. In this case, <span class="math">\((x, y, z)\)</span> is the point of interest
and <span class="math">\((x_i, y_i, z_i)\)</span> are the coordinates of each vertex.</p>
</section></section><section id="the-algorithm"><h2>The algorithm</h2>
<p>Below is a Python implementation of the approach discussed before</p>
<div class="code"><pre class="code python"><a id="rest_code_ee7622f7f158452caf1315fc844f21d0-1" name="rest_code_ee7622f7f158452caf1315fc844f21d0-1" href="posts/putnam_prob/#rest_code_ee7622f7f158452caf1315fc844f21d0-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">__future__</span><span class="w"> </span><span class="kn">import</span> <span class="n">division</span><span class="p">,</span> <span class="n">print_function</span>
<a id="rest_code_ee7622f7f158452caf1315fc844f21d0-2" name="rest_code_ee7622f7f158452caf1315fc844f21d0-2" href="posts/putnam_prob/#rest_code_ee7622f7f158452caf1315fc844f21d0-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span><span class="n">random</span><span class="p">,</span> <span class="n">pi</span><span class="p">,</span> <span class="n">cos</span><span class="p">,</span> <span class="n">sin</span><span class="p">,</span> <span class="n">sign</span><span class="p">,</span> <span class="n">hstack</span><span class="p">,</span>
<a id="rest_code_ee7622f7f158452caf1315fc844f21d0-3" name="rest_code_ee7622f7f158452caf1315fc844f21d0-3" href="posts/putnam_prob/#rest_code_ee7622f7f158452caf1315fc844f21d0-3"></a>                   <span class="n">column_stack</span><span class="p">,</span> <span class="n">logspace</span><span class="p">)</span>
<a id="rest_code_ee7622f7f158452caf1315fc844f21d0-4" name="rest_code_ee7622f7f158452caf1315fc844f21d0-4" href="posts/putnam_prob/#rest_code_ee7622f7f158452caf1315fc844f21d0-4"></a><span class="kn">from</span><span class="w"> </span><span class="nn">numpy.linalg</span><span class="w"> </span><span class="kn">import</span> <span class="n">det</span>
<a id="rest_code_ee7622f7f158452caf1315fc844f21d0-5" name="rest_code_ee7622f7f158452caf1315fc844f21d0-5" href="posts/putnam_prob/#rest_code_ee7622f7f158452caf1315fc844f21d0-5"></a><span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<a id="rest_code_ee7622f7f158452caf1315fc844f21d0-6" name="rest_code_ee7622f7f158452caf1315fc844f21d0-6" href="posts/putnam_prob/#rest_code_ee7622f7f158452caf1315fc844f21d0-6"></a>
<a id="rest_code_ee7622f7f158452caf1315fc844f21d0-7" name="rest_code_ee7622f7f158452caf1315fc844f21d0-7" href="posts/putnam_prob/#rest_code_ee7622f7f158452caf1315fc844f21d0-7"></a>
<a id="rest_code_ee7622f7f158452caf1315fc844f21d0-8" name="rest_code_ee7622f7f158452caf1315fc844f21d0-8" href="posts/putnam_prob/#rest_code_ee7622f7f158452caf1315fc844f21d0-8"></a><span class="k">def</span><span class="w"> </span><span class="nf">in_tet</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">pt</span><span class="p">):</span>
<a id="rest_code_ee7622f7f158452caf1315fc844f21d0-9" name="rest_code_ee7622f7f158452caf1315fc844f21d0-9" href="posts/putnam_prob/#rest_code_ee7622f7f158452caf1315fc844f21d0-9"></a><span class="w">    </span><span class="sd">"""</span>
<a id="rest_code_ee7622f7f158452caf1315fc844f21d0-10" name="rest_code_ee7622f7f158452caf1315fc844f21d0-10" href="posts/putnam_prob/#rest_code_ee7622f7f158452caf1315fc844f21d0-10"></a><span class="sd">    Determine if the point pt is inside the</span>
<a id="rest_code_ee7622f7f158452caf1315fc844f21d0-11" name="rest_code_ee7622f7f158452caf1315fc844f21d0-11" href="posts/putnam_prob/#rest_code_ee7622f7f158452caf1315fc844f21d0-11"></a><span class="sd">    tetrahedron with vertices coordinates x, y, z</span>
<a id="rest_code_ee7622f7f158452caf1315fc844f21d0-12" name="rest_code_ee7622f7f158452caf1315fc844f21d0-12" href="posts/putnam_prob/#rest_code_ee7622f7f158452caf1315fc844f21d0-12"></a><span class="sd">    """</span>
<a id="rest_code_ee7622f7f158452caf1315fc844f21d0-13" name="rest_code_ee7622f7f158452caf1315fc844f21d0-13" href="posts/putnam_prob/#rest_code_ee7622f7f158452caf1315fc844f21d0-13"></a>    <span class="n">mat0</span> <span class="o">=</span> <span class="n">column_stack</span><span class="p">((</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]))</span>
<a id="rest_code_ee7622f7f158452caf1315fc844f21d0-14" name="rest_code_ee7622f7f158452caf1315fc844f21d0-14" href="posts/putnam_prob/#rest_code_ee7622f7f158452caf1315fc844f21d0-14"></a>    <span class="n">det0</span> <span class="o">=</span> <span class="n">det</span><span class="p">(</span><span class="n">mat0</span><span class="p">)</span>
<a id="rest_code_ee7622f7f158452caf1315fc844f21d0-15" name="rest_code_ee7622f7f158452caf1315fc844f21d0-15" href="posts/putnam_prob/#rest_code_ee7622f7f158452caf1315fc844f21d0-15"></a>    <span class="k">for</span> <span class="n">cont</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
<a id="rest_code_ee7622f7f158452caf1315fc844f21d0-16" name="rest_code_ee7622f7f158452caf1315fc844f21d0-16" href="posts/putnam_prob/#rest_code_ee7622f7f158452caf1315fc844f21d0-16"></a>        <span class="n">mat</span> <span class="o">=</span> <span class="n">mat0</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<a id="rest_code_ee7622f7f158452caf1315fc844f21d0-17" name="rest_code_ee7622f7f158452caf1315fc844f21d0-17" href="posts/putnam_prob/#rest_code_ee7622f7f158452caf1315fc844f21d0-17"></a>        <span class="n">mat</span><span class="p">[</span><span class="n">cont</span><span class="p">]</span> <span class="o">=</span> <span class="n">hstack</span><span class="p">((</span><span class="n">pt</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<a id="rest_code_ee7622f7f158452caf1315fc844f21d0-18" name="rest_code_ee7622f7f158452caf1315fc844f21d0-18" href="posts/putnam_prob/#rest_code_ee7622f7f158452caf1315fc844f21d0-18"></a>        <span class="k">if</span> <span class="n">sign</span><span class="p">(</span><span class="n">det</span><span class="p">(</span><span class="n">mat</span><span class="p">)</span><span class="o">*</span><span class="n">det0</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
<a id="rest_code_ee7622f7f158452caf1315fc844f21d0-19" name="rest_code_ee7622f7f158452caf1315fc844f21d0-19" href="posts/putnam_prob/#rest_code_ee7622f7f158452caf1315fc844f21d0-19"></a>            <span class="n">inside</span> <span class="o">=</span> <span class="kc">False</span>
<a id="rest_code_ee7622f7f158452caf1315fc844f21d0-20" name="rest_code_ee7622f7f158452caf1315fc844f21d0-20" href="posts/putnam_prob/#rest_code_ee7622f7f158452caf1315fc844f21d0-20"></a>            <span class="k">break</span>
<a id="rest_code_ee7622f7f158452caf1315fc844f21d0-21" name="rest_code_ee7622f7f158452caf1315fc844f21d0-21" href="posts/putnam_prob/#rest_code_ee7622f7f158452caf1315fc844f21d0-21"></a>        <span class="k">else</span><span class="p">:</span>
<a id="rest_code_ee7622f7f158452caf1315fc844f21d0-22" name="rest_code_ee7622f7f158452caf1315fc844f21d0-22" href="posts/putnam_prob/#rest_code_ee7622f7f158452caf1315fc844f21d0-22"></a>            <span class="n">inside</span> <span class="o">=</span> <span class="kc">True</span>
<a id="rest_code_ee7622f7f158452caf1315fc844f21d0-23" name="rest_code_ee7622f7f158452caf1315fc844f21d0-23" href="posts/putnam_prob/#rest_code_ee7622f7f158452caf1315fc844f21d0-23"></a>    <span class="k">return</span> <span class="n">inside</span>
<a id="rest_code_ee7622f7f158452caf1315fc844f21d0-24" name="rest_code_ee7622f7f158452caf1315fc844f21d0-24" href="posts/putnam_prob/#rest_code_ee7622f7f158452caf1315fc844f21d0-24"></a>
<a id="rest_code_ee7622f7f158452caf1315fc844f21d0-25" name="rest_code_ee7622f7f158452caf1315fc844f21d0-25" href="posts/putnam_prob/#rest_code_ee7622f7f158452caf1315fc844f21d0-25"></a>
<a id="rest_code_ee7622f7f158452caf1315fc844f21d0-26" name="rest_code_ee7622f7f158452caf1315fc844f21d0-26" href="posts/putnam_prob/#rest_code_ee7622f7f158452caf1315fc844f21d0-26"></a><span class="c1">#%% Computation</span>
<a id="rest_code_ee7622f7f158452caf1315fc844f21d0-27" name="rest_code_ee7622f7f158452caf1315fc844f21d0-27" href="posts/putnam_prob/#rest_code_ee7622f7f158452caf1315fc844f21d0-27"></a><span class="n">prob</span> <span class="o">=</span> <span class="p">[]</span>
<a id="rest_code_ee7622f7f158452caf1315fc844f21d0-28" name="rest_code_ee7622f7f158452caf1315fc844f21d0-28" href="posts/putnam_prob/#rest_code_ee7622f7f158452caf1315fc844f21d0-28"></a><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<a id="rest_code_ee7622f7f158452caf1315fc844f21d0-29" name="rest_code_ee7622f7f158452caf1315fc844f21d0-29" href="posts/putnam_prob/#rest_code_ee7622f7f158452caf1315fc844f21d0-29"></a><span class="n">N_min</span> <span class="o">=</span> <span class="mi">1</span>
<a id="rest_code_ee7622f7f158452caf1315fc844f21d0-30" name="rest_code_ee7622f7f158452caf1315fc844f21d0-30" href="posts/putnam_prob/#rest_code_ee7622f7f158452caf1315fc844f21d0-30"></a><span class="n">N_max</span> <span class="o">=</span> <span class="mi">5</span>
<a id="rest_code_ee7622f7f158452caf1315fc844f21d0-31" name="rest_code_ee7622f7f158452caf1315fc844f21d0-31" href="posts/putnam_prob/#rest_code_ee7622f7f158452caf1315fc844f21d0-31"></a><span class="n">N_vals</span> <span class="o">=</span> <span class="n">logspace</span><span class="p">(</span><span class="n">N_min</span><span class="p">,</span> <span class="n">N_max</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
<a id="rest_code_ee7622f7f158452caf1315fc844f21d0-32" name="rest_code_ee7622f7f158452caf1315fc844f21d0-32" href="posts/putnam_prob/#rest_code_ee7622f7f158452caf1315fc844f21d0-32"></a><span class="k">for</span> <span class="n">N</span> <span class="ow">in</span> <span class="n">N_vals</span><span class="p">:</span>
<a id="rest_code_ee7622f7f158452caf1315fc844f21d0-33" name="rest_code_ee7622f7f158452caf1315fc844f21d0-33" href="posts/putnam_prob/#rest_code_ee7622f7f158452caf1315fc844f21d0-33"></a>    <span class="n">inside_cont</span> <span class="o">=</span> <span class="mi">0</span>
<a id="rest_code_ee7622f7f158452caf1315fc844f21d0-34" name="rest_code_ee7622f7f158452caf1315fc844f21d0-34" href="posts/putnam_prob/#rest_code_ee7622f7f158452caf1315fc844f21d0-34"></a>    <span class="k">for</span> <span class="n">cont_pts</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
<a id="rest_code_ee7622f7f158452caf1315fc844f21d0-35" name="rest_code_ee7622f7f158452caf1315fc844f21d0-35" href="posts/putnam_prob/#rest_code_ee7622f7f158452caf1315fc844f21d0-35"></a>        <span class="n">phi</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="n">low</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">high</span><span class="o">=</span><span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<a id="rest_code_ee7622f7f158452caf1315fc844f21d0-36" name="rest_code_ee7622f7f158452caf1315fc844f21d0-36" href="posts/putnam_prob/#rest_code_ee7622f7f158452caf1315fc844f21d0-36"></a>        <span class="n">theta</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="n">low</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">high</span><span class="o">=</span><span class="n">pi</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<a id="rest_code_ee7622f7f158452caf1315fc844f21d0-37" name="rest_code_ee7622f7f158452caf1315fc844f21d0-37" href="posts/putnam_prob/#rest_code_ee7622f7f158452caf1315fc844f21d0-37"></a>        <span class="n">x</span> <span class="o">=</span> <span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">phi</span><span class="p">)</span>
<a id="rest_code_ee7622f7f158452caf1315fc844f21d0-38" name="rest_code_ee7622f7f158452caf1315fc844f21d0-38" href="posts/putnam_prob/#rest_code_ee7622f7f158452caf1315fc844f21d0-38"></a>        <span class="n">y</span> <span class="o">=</span> <span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">phi</span><span class="p">)</span>
<a id="rest_code_ee7622f7f158452caf1315fc844f21d0-39" name="rest_code_ee7622f7f158452caf1315fc844f21d0-39" href="posts/putnam_prob/#rest_code_ee7622f7f158452caf1315fc844f21d0-39"></a>        <span class="n">z</span> <span class="o">=</span> <span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>
<a id="rest_code_ee7622f7f158452caf1315fc844f21d0-40" name="rest_code_ee7622f7f158452caf1315fc844f21d0-40" href="posts/putnam_prob/#rest_code_ee7622f7f158452caf1315fc844f21d0-40"></a>        <span class="k">if</span> <span class="n">in_tet</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]):</span>
<a id="rest_code_ee7622f7f158452caf1315fc844f21d0-41" name="rest_code_ee7622f7f158452caf1315fc844f21d0-41" href="posts/putnam_prob/#rest_code_ee7622f7f158452caf1315fc844f21d0-41"></a>            <span class="n">inside_cont</span> <span class="o">+=</span> <span class="mi">1</span>
<a id="rest_code_ee7622f7f158452caf1315fc844f21d0-42" name="rest_code_ee7622f7f158452caf1315fc844f21d0-42" href="posts/putnam_prob/#rest_code_ee7622f7f158452caf1315fc844f21d0-42"></a>
<a id="rest_code_ee7622f7f158452caf1315fc844f21d0-43" name="rest_code_ee7622f7f158452caf1315fc844f21d0-43" href="posts/putnam_prob/#rest_code_ee7622f7f158452caf1315fc844f21d0-43"></a>    <span class="n">prob</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">inside_cont</span><span class="o">/</span><span class="n">N</span><span class="p">)</span>
<a id="rest_code_ee7622f7f158452caf1315fc844f21d0-44" name="rest_code_ee7622f7f158452caf1315fc844f21d0-44" href="posts/putnam_prob/#rest_code_ee7622f7f158452caf1315fc844f21d0-44"></a>
<a id="rest_code_ee7622f7f158452caf1315fc844f21d0-45" name="rest_code_ee7622f7f158452caf1315fc844f21d0-45" href="posts/putnam_prob/#rest_code_ee7622f7f158452caf1315fc844f21d0-45"></a>
<a id="rest_code_ee7622f7f158452caf1315fc844f21d0-46" name="rest_code_ee7622f7f158452caf1315fc844f21d0-46" href="posts/putnam_prob/#rest_code_ee7622f7f158452caf1315fc844f21d0-46"></a><span class="c1">#%% Plotting</span>
<a id="rest_code_ee7622f7f158452caf1315fc844f21d0-47" name="rest_code_ee7622f7f158452caf1315fc844f21d0-47" href="posts/putnam_prob/#rest_code_ee7622f7f158452caf1315fc844f21d0-47"></a><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<a id="rest_code_ee7622f7f158452caf1315fc844f21d0-48" name="rest_code_ee7622f7f158452caf1315fc844f21d0-48" href="posts/putnam_prob/#rest_code_ee7622f7f158452caf1315fc844f21d0-48"></a><span class="n">plt</span><span class="o">.</span><span class="n">hlines</span><span class="p">(</span><span class="mf">0.125</span><span class="p">,</span> <span class="mi">10</span><span class="o">**</span><span class="n">N_min</span><span class="p">,</span> <span class="mi">10</span><span class="o">**</span><span class="n">N_max</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">"#3f3f3f"</span><span class="p">)</span>
<a id="rest_code_ee7622f7f158452caf1315fc844f21d0-49" name="rest_code_ee7622f7f158452caf1315fc844f21d0-49" href="posts/putnam_prob/#rest_code_ee7622f7f158452caf1315fc844f21d0-49"></a><span class="n">plt</span><span class="o">.</span><span class="n">semilogx</span><span class="p">(</span><span class="n">N_vals</span><span class="p">,</span> <span class="n">prob</span><span class="p">,</span> <span class="s2">"o"</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<a id="rest_code_ee7622f7f158452caf1315fc844f21d0-50" name="rest_code_ee7622f7f158452caf1315fc844f21d0-50" href="posts/putnam_prob/#rest_code_ee7622f7f158452caf1315fc844f21d0-50"></a><span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">"Number of trials"</span><span class="p">)</span>
<a id="rest_code_ee7622f7f158452caf1315fc844f21d0-51" name="rest_code_ee7622f7f158452caf1315fc844f21d0-51" href="posts/putnam_prob/#rest_code_ee7622f7f158452caf1315fc844f21d0-51"></a><span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">"Computed probability"</span><span class="p">)</span>
<a id="rest_code_ee7622f7f158452caf1315fc844f21d0-52" name="rest_code_ee7622f7f158452caf1315fc844f21d0-52" href="posts/putnam_prob/#rest_code_ee7622f7f158452caf1315fc844f21d0-52"></a><span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<a id="rest_code_ee7622f7f158452caf1315fc844f21d0-53" name="rest_code_ee7622f7f158452caf1315fc844f21d0-53" href="posts/putnam_prob/#rest_code_ee7622f7f158452caf1315fc844f21d0-53"></a><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
<p>As expected, when the number of samples is sufficiently large, the
estimated probability is close to the theoretical value: 0.125. This
can be seen in the following figure.</p>
<img alt="Computed probability for different sample sizes" class="align-center" src="images/random_tets.svg" style="width: 600px;"></section>
</div>
    </article>
</div>

        <nav class="postindexpager"><ul class="pager">
<li class="previous">
                <a href="." rel="prev">Newer posts</a>
            </li>
            <li class="next">
                <a href="index-4.html" rel="next">Older posts</a>
            </li>
        </ul></nav><script>var disqus_shortname="nicoguaro-github";(function(){var a=document.createElement("script");a.async=true;a.src="https://"+disqus_shortname+".disqus.com/count.js";(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(a)}());</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML" integrity="sha384-3lJUsx1TJHt7BA4udB5KPnDrlkO8T6J6v/op7ui0BbCjvZ9WqV4Xm6DTP6kQ/iBH" crossorigin="anonymous"></script><script type="text/x-mathjax-config">
        MathJax.Hub.Config({tex2jax: {inlineMath: [['$latex ','$'], ['\\(','\\)']]}});
        </script><footer id="footer"><p><a href="https://creativecommons.org/licenses/by/4.0/" rel="nofollow">CC BY 4.0</a> © 2025 <a href="mailto:nicoguarin@gmail.com">Nicolás Guarín-Zapata</a> - Powered by <a href="https://getnikola.com" rel="nofollow">Nikola</a> - <a rel="me" href="https://fosstodon.org/@nicoguaro">Mastodon profile</a></p>
            
        </footer>
</div>
    </div>
    <label for="sidebar-checkbox" class="sidebar-toggle"></label>
    
<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-145359674-1', 'auto');
ga('send', 'pageview');
</script><script src="assets/js/all-nocdn.js"></script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates -->
</body>
</html>
