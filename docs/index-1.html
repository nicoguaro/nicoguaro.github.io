<!DOCTYPE html>
<html prefix="" lang="en">
<head>
<meta charset="utf-8">
<meta name="description" content="Personal blog and website">
<meta name="viewport" content="width=device-width">
<title>Nicolás' blog (old posts, page 1) | Nicolás' blog</title>
<link href="assets/css/all.css" rel="stylesheet" type="text/css">
<link rel="stylesheet" href="//fonts.googleapis.com/css?family=PT+Serif:400,400italic,700%7CPT+Sans:400">
<link rel="alternate" type="application/rss+xml" title="RSS (en)" href="rss.xml">
<link rel="alternate" type="application/rss+xml" title="RSS (es)" href="es/rss.xml">
<link rel="canonical" href="https://nicoguaro.github.io/index-1.html">
<link rel="prev" href="index-2.html" type="text/html">
<!--[if lt IE 9]><script src="assets/js/html5.js"></script><![endif]-->
</head>
<body>
    <a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>
    <!-- Target for toggling the sidebar `.sidebar-checkbox` is for regular
            styles, `#sidebar-checkbox` for behavior. -->
    <input type="checkbox" class="sidebar-checkbox" id="sidebar-checkbox"><!-- Toggleable sidebar --><div class="sidebar" id="sidebar">
        <div class="sidebar-item">
            <p>This is my personal website and blog.</p>
        </div>
        
    <nav id="menu" role="navigation" class="sidebar-nav"><a class="sidebar-nav-item" href="pages/about/">About</a>
        <a class="sidebar-nav-item" href="index.html">Blog</a>
        <a class="sidebar-nav-item" href="pages/preprints-archive/">Preprints</a>
        <a class="sidebar-nav-item" href="pages/links/">Links</a>
        <a class="sidebar-nav-item" href="archive.html">Archive</a>
        <a class="sidebar-nav-item" href="categories/">Tags</a>
        <a class="sidebar-nav-item" href="rss.xml">RSS feed</a>
    
    
    </nav>
</div>

    <!-- Wrap is the content to shift when toggling the sidebar. We wrap the
         content to avoid any CSS collisions with our real content. -->
    <div class="wrap">
      <div class="masthead">
        <div class="container">
          
    <h3 id="brand" class="masthead-title">
      <a href="https://nicoguaro.github.io/" title="Nicolás' blog" rel="home">Nicolás' blog</a>
    </h3>

        </div>
      </div>

      <div class="container content" id="content">
        

<div class="posts">
    <article class="post h-entry post-text"><header><h1 class="post-title p-name"><a href="posts/numerical_challenge/numerical-02/" class="u-url">Numerical methods challenge: Day 2</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn">Nicolás Guarín-Zapata</span></p>
            <p class="dateline"><a href="posts/numerical_challenge/numerical-02/" rel="bookmark"><time class="post-date published dt-published" datetime="2017-10-02T20:47:05-05:00" title="2017-10-02 20:47">2017-10-02 20:47</time></a></p>
                <p class="commentline">
    
    <a href="posts/numerical_challenge/numerical-02/#disqus_thread" data-disqus-identifier="cache/posts/numerical_challenge/numerical-02.html">Comments</a>


        </p>
</div>
    </header><div class="e-content entry-content">
    <p>During October (2017) I will write a program per day for some well-known
numerical methods in both Python and Julia. It is intended to be an exercise
then don't expect the code to be good enough for real use. Also,
I should mention that I have almost no experience with Julia, so it
probably won't be idiomatic Julia but more Python-like Julia.</p>
<section id="regula-falsi"><h2>Regula falsi</h2>
<p>The second method to be considered is the
<a class="reference external" href="https://en.wikipedia.org/wiki/False_position_method">false position method</a>,
or <em>regula falsi</em>. This method is used to solve the equation <span class="math">\(f(x) = 0\)</span>
for <span class="math">\(x\)</span> real, and <span class="math">\(f\)</span> continuous. It starts with an interval
<span class="math">\([a,b]\)</span>, where <span class="math">\(f(a)\)</span> and <span class="math">\(f(b)\)</span> should have opposite signs.
The method is similar to bisection method but instead of halving the original
interval it takes as a new point of the interval the intercept of the line
that connect the function evaluated at the two extreme points. Then, the new
point is computed from</p>
<div class="math">
\begin{equation*}
c = \frac{a f(b) - b f(a)}{f(b) - f(a)}
\end{equation*}
</div>
<p>As in bisection method, we keep the interval where the solution
appears, i.e., the sign of the function changes.</p>
<p>We will use the function <span class="math">\(f(x) = \cos(x) - x\)</span> to test the codes,
and the initial interval is <span class="math">\([0.5, \pi/4]\)</span>.</p>
<p>Following are the codes.</p>
<section id="python"><h3>Python</h3>
<div class="code"><pre class="code python"><a id="rest_code_2080784b8962433e8a6946d2e7945c61-1" name="rest_code_2080784b8962433e8a6946d2e7945c61-1" href="posts/numerical_challenge/numerical-02/#rest_code_2080784b8962433e8a6946d2e7945c61-1"></a><span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">division</span><span class="p">,</span> <span class="n">print_function</span>
<a id="rest_code_2080784b8962433e8a6946d2e7945c61-2" name="rest_code_2080784b8962433e8a6946d2e7945c61-2" href="posts/numerical_challenge/numerical-02/#rest_code_2080784b8962433e8a6946d2e7945c61-2"></a><span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="nb">abs</span><span class="p">,</span> <span class="n">cos</span><span class="p">,</span> <span class="n">pi</span>
<a id="rest_code_2080784b8962433e8a6946d2e7945c61-3" name="rest_code_2080784b8962433e8a6946d2e7945c61-3" href="posts/numerical_challenge/numerical-02/#rest_code_2080784b8962433e8a6946d2e7945c61-3"></a>
<a id="rest_code_2080784b8962433e8a6946d2e7945c61-4" name="rest_code_2080784b8962433e8a6946d2e7945c61-4" href="posts/numerical_challenge/numerical-02/#rest_code_2080784b8962433e8a6946d2e7945c61-4"></a><span class="k">def</span> <span class="nf">regula_falsi</span><span class="p">(</span><span class="n">fun</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">niter</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">ftol</span><span class="o">=</span><span class="mf">1e-12</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<a id="rest_code_2080784b8962433e8a6946d2e7945c61-5" name="rest_code_2080784b8962433e8a6946d2e7945c61-5" href="posts/numerical_challenge/numerical-02/#rest_code_2080784b8962433e8a6946d2e7945c61-5"></a>    <span class="k">if</span> <span class="n">fun</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="o">*</span> <span class="n">fun</span><span class="p">(</span><span class="n">b</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
<a id="rest_code_2080784b8962433e8a6946d2e7945c61-6" name="rest_code_2080784b8962433e8a6946d2e7945c61-6" href="posts/numerical_challenge/numerical-02/#rest_code_2080784b8962433e8a6946d2e7945c61-6"></a>        <span class="n">c</span> <span class="o">=</span> <span class="kc">None</span>
<a id="rest_code_2080784b8962433e8a6946d2e7945c61-7" name="rest_code_2080784b8962433e8a6946d2e7945c61-7" href="posts/numerical_challenge/numerical-02/#rest_code_2080784b8962433e8a6946d2e7945c61-7"></a>        <span class="n">msg</span> <span class="o">=</span> <span class="s2">"The function should have a sign change in the interval."</span>
<a id="rest_code_2080784b8962433e8a6946d2e7945c61-8" name="rest_code_2080784b8962433e8a6946d2e7945c61-8" href="posts/numerical_challenge/numerical-02/#rest_code_2080784b8962433e8a6946d2e7945c61-8"></a>    <span class="k">else</span><span class="p">:</span>
<a id="rest_code_2080784b8962433e8a6946d2e7945c61-9" name="rest_code_2080784b8962433e8a6946d2e7945c61-9" href="posts/numerical_challenge/numerical-02/#rest_code_2080784b8962433e8a6946d2e7945c61-9"></a>        <span class="k">for</span> <span class="n">cont</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">niter</span><span class="p">):</span>
<a id="rest_code_2080784b8962433e8a6946d2e7945c61-10" name="rest_code_2080784b8962433e8a6946d2e7945c61-10" href="posts/numerical_challenge/numerical-02/#rest_code_2080784b8962433e8a6946d2e7945c61-10"></a>            <span class="n">qa</span> <span class="o">=</span> <span class="n">fun</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<a id="rest_code_2080784b8962433e8a6946d2e7945c61-11" name="rest_code_2080784b8962433e8a6946d2e7945c61-11" href="posts/numerical_challenge/numerical-02/#rest_code_2080784b8962433e8a6946d2e7945c61-11"></a>            <span class="n">qb</span> <span class="o">=</span> <span class="n">fun</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
<a id="rest_code_2080784b8962433e8a6946d2e7945c61-12" name="rest_code_2080784b8962433e8a6946d2e7945c61-12" href="posts/numerical_challenge/numerical-02/#rest_code_2080784b8962433e8a6946d2e7945c61-12"></a>            <span class="n">c</span> <span class="o">=</span> <span class="p">(</span><span class="n">a</span><span class="o">*</span><span class="n">qb</span> <span class="o">-</span> <span class="n">b</span><span class="o">*</span><span class="n">qa</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">qb</span> <span class="o">-</span> <span class="n">qa</span><span class="p">)</span>
<a id="rest_code_2080784b8962433e8a6946d2e7945c61-13" name="rest_code_2080784b8962433e8a6946d2e7945c61-13" href="posts/numerical_challenge/numerical-02/#rest_code_2080784b8962433e8a6946d2e7945c61-13"></a>            <span class="n">qc</span> <span class="o">=</span> <span class="n">fun</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
<a id="rest_code_2080784b8962433e8a6946d2e7945c61-14" name="rest_code_2080784b8962433e8a6946d2e7945c61-14" href="posts/numerical_challenge/numerical-02/#rest_code_2080784b8962433e8a6946d2e7945c61-14"></a>            <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
<a id="rest_code_2080784b8962433e8a6946d2e7945c61-15" name="rest_code_2080784b8962433e8a6946d2e7945c61-15" href="posts/numerical_challenge/numerical-02/#rest_code_2080784b8962433e8a6946d2e7945c61-15"></a>                <span class="nb">print</span><span class="p">(</span><span class="s2">"n: </span><span class="si">{}</span><span class="s2">, c: </span><span class="si">{}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">cont</span><span class="p">,</span> <span class="n">c</span><span class="p">))</span>
<a id="rest_code_2080784b8962433e8a6946d2e7945c61-16" name="rest_code_2080784b8962433e8a6946d2e7945c61-16" href="posts/numerical_challenge/numerical-02/#rest_code_2080784b8962433e8a6946d2e7945c61-16"></a>            <span class="n">msg</span> <span class="o">=</span> <span class="s2">"Maximum number of iterations reached."</span>
<a id="rest_code_2080784b8962433e8a6946d2e7945c61-17" name="rest_code_2080784b8962433e8a6946d2e7945c61-17" href="posts/numerical_challenge/numerical-02/#rest_code_2080784b8962433e8a6946d2e7945c61-17"></a>            <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">qc</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">ftol</span><span class="p">:</span>
<a id="rest_code_2080784b8962433e8a6946d2e7945c61-18" name="rest_code_2080784b8962433e8a6946d2e7945c61-18" href="posts/numerical_challenge/numerical-02/#rest_code_2080784b8962433e8a6946d2e7945c61-18"></a>                <span class="n">msg</span> <span class="o">=</span> <span class="s2">"Root found with desired accuracy."</span>
<a id="rest_code_2080784b8962433e8a6946d2e7945c61-19" name="rest_code_2080784b8962433e8a6946d2e7945c61-19" href="posts/numerical_challenge/numerical-02/#rest_code_2080784b8962433e8a6946d2e7945c61-19"></a>                <span class="k">break</span>
<a id="rest_code_2080784b8962433e8a6946d2e7945c61-20" name="rest_code_2080784b8962433e8a6946d2e7945c61-20" href="posts/numerical_challenge/numerical-02/#rest_code_2080784b8962433e8a6946d2e7945c61-20"></a>            <span class="k">elif</span> <span class="n">qa</span> <span class="o">*</span> <span class="n">qc</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
<a id="rest_code_2080784b8962433e8a6946d2e7945c61-21" name="rest_code_2080784b8962433e8a6946d2e7945c61-21" href="posts/numerical_challenge/numerical-02/#rest_code_2080784b8962433e8a6946d2e7945c61-21"></a>                <span class="n">b</span> <span class="o">=</span> <span class="n">c</span>
<a id="rest_code_2080784b8962433e8a6946d2e7945c61-22" name="rest_code_2080784b8962433e8a6946d2e7945c61-22" href="posts/numerical_challenge/numerical-02/#rest_code_2080784b8962433e8a6946d2e7945c61-22"></a>            <span class="k">elif</span> <span class="n">qb</span> <span class="o">*</span> <span class="n">qc</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
<a id="rest_code_2080784b8962433e8a6946d2e7945c61-23" name="rest_code_2080784b8962433e8a6946d2e7945c61-23" href="posts/numerical_challenge/numerical-02/#rest_code_2080784b8962433e8a6946d2e7945c61-23"></a>                <span class="n">a</span> <span class="o">=</span> <span class="n">c</span>
<a id="rest_code_2080784b8962433e8a6946d2e7945c61-24" name="rest_code_2080784b8962433e8a6946d2e7945c61-24" href="posts/numerical_challenge/numerical-02/#rest_code_2080784b8962433e8a6946d2e7945c61-24"></a>    <span class="k">return</span> <span class="n">c</span><span class="p">,</span> <span class="n">msg</span>
<a id="rest_code_2080784b8962433e8a6946d2e7945c61-25" name="rest_code_2080784b8962433e8a6946d2e7945c61-25" href="posts/numerical_challenge/numerical-02/#rest_code_2080784b8962433e8a6946d2e7945c61-25"></a>
<a id="rest_code_2080784b8962433e8a6946d2e7945c61-26" name="rest_code_2080784b8962433e8a6946d2e7945c61-26" href="posts/numerical_challenge/numerical-02/#rest_code_2080784b8962433e8a6946d2e7945c61-26"></a><span class="k">def</span> <span class="nf">fun</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<a id="rest_code_2080784b8962433e8a6946d2e7945c61-27" name="rest_code_2080784b8962433e8a6946d2e7945c61-27" href="posts/numerical_challenge/numerical-02/#rest_code_2080784b8962433e8a6946d2e7945c61-27"></a>    <span class="k">return</span> <span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="n">x</span>
<a id="rest_code_2080784b8962433e8a6946d2e7945c61-28" name="rest_code_2080784b8962433e8a6946d2e7945c61-28" href="posts/numerical_challenge/numerical-02/#rest_code_2080784b8962433e8a6946d2e7945c61-28"></a>
<a id="rest_code_2080784b8962433e8a6946d2e7945c61-29" name="rest_code_2080784b8962433e8a6946d2e7945c61-29" href="posts/numerical_challenge/numerical-02/#rest_code_2080784b8962433e8a6946d2e7945c61-29"></a><span class="nb">print</span><span class="p">(</span><span class="n">regula_falsi</span><span class="p">(</span><span class="n">fun</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.25</span><span class="o">*</span><span class="n">pi</span><span class="p">))</span>
</pre></div>
</section><section id="julia"><h3>Julia</h3>
<div class="code"><pre class="code julia"><a id="rest_code_c80c2098687e4774aabb0f425e20147f-1" name="rest_code_c80c2098687e4774aabb0f425e20147f-1" href="posts/numerical_challenge/numerical-02/#rest_code_c80c2098687e4774aabb0f425e20147f-1"></a><span class="k">function</span><span class="w"> </span><span class="n">regula_falsi</span><span class="p">(</span><span class="n">fun</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="p">,</span><span class="w"> </span><span class="n">niter</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span><span class="w"> </span><span class="n">ftol</span><span class="o">=</span><span class="mf">1e-12</span><span class="p">,</span><span class="w"> </span><span class="n">verbose</span><span class="o">=</span><span class="nb">false</span><span class="p">)</span><span class="w"></span>
<a id="rest_code_c80c2098687e4774aabb0f425e20147f-2" name="rest_code_c80c2098687e4774aabb0f425e20147f-2" href="posts/numerical_challenge/numerical-02/#rest_code_c80c2098687e4774aabb0f425e20147f-2"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">fun</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">fun</span><span class="p">(</span><span class="n">b</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<a id="rest_code_c80c2098687e4774aabb0f425e20147f-3" name="rest_code_c80c2098687e4774aabb0f425e20147f-3" href="posts/numerical_challenge/numerical-02/#rest_code_c80c2098687e4774aabb0f425e20147f-3"></a><span class="w">        </span><span class="n">c</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">nothing</span><span class="w"></span>
<a id="rest_code_c80c2098687e4774aabb0f425e20147f-4" name="rest_code_c80c2098687e4774aabb0f425e20147f-4" href="posts/numerical_challenge/numerical-02/#rest_code_c80c2098687e4774aabb0f425e20147f-4"></a><span class="w">        </span><span class="n">msg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"The function should have a sign change in the interval."</span><span class="w"></span>
<a id="rest_code_c80c2098687e4774aabb0f425e20147f-5" name="rest_code_c80c2098687e4774aabb0f425e20147f-5" href="posts/numerical_challenge/numerical-02/#rest_code_c80c2098687e4774aabb0f425e20147f-5"></a><span class="w">    </span><span class="k">else</span><span class="w"></span>
<a id="rest_code_c80c2098687e4774aabb0f425e20147f-6" name="rest_code_c80c2098687e4774aabb0f425e20147f-6" href="posts/numerical_challenge/numerical-02/#rest_code_c80c2098687e4774aabb0f425e20147f-6"></a><span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="n">cont</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="n">niter</span><span class="w"></span>
<a id="rest_code_c80c2098687e4774aabb0f425e20147f-7" name="rest_code_c80c2098687e4774aabb0f425e20147f-7" href="posts/numerical_challenge/numerical-02/#rest_code_c80c2098687e4774aabb0f425e20147f-7"></a><span class="w">            </span><span class="n">qa</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fun</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="w"></span>
<a id="rest_code_c80c2098687e4774aabb0f425e20147f-8" name="rest_code_c80c2098687e4774aabb0f425e20147f-8" href="posts/numerical_challenge/numerical-02/#rest_code_c80c2098687e4774aabb0f425e20147f-8"></a><span class="w">            </span><span class="n">qb</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fun</span><span class="p">(</span><span class="n">b</span><span class="p">)</span><span class="w"></span>
<a id="rest_code_c80c2098687e4774aabb0f425e20147f-9" name="rest_code_c80c2098687e4774aabb0f425e20147f-9" href="posts/numerical_challenge/numerical-02/#rest_code_c80c2098687e4774aabb0f425e20147f-9"></a><span class="w">            </span><span class="n">c</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">a</span><span class="o">*</span><span class="n">qb</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">b</span><span class="o">*</span><span class="n">qa</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">qb</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">qa</span><span class="p">)</span><span class="w"></span>
<a id="rest_code_c80c2098687e4774aabb0f425e20147f-10" name="rest_code_c80c2098687e4774aabb0f425e20147f-10" href="posts/numerical_challenge/numerical-02/#rest_code_c80c2098687e4774aabb0f425e20147f-10"></a><span class="w">            </span><span class="n">qc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fun</span><span class="p">(</span><span class="n">c</span><span class="p">)</span><span class="w"></span>
<a id="rest_code_c80c2098687e4774aabb0f425e20147f-11" name="rest_code_c80c2098687e4774aabb0f425e20147f-11" href="posts/numerical_challenge/numerical-02/#rest_code_c80c2098687e4774aabb0f425e20147f-11"></a><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="n">verbose</span><span class="w"></span>
<a id="rest_code_c80c2098687e4774aabb0f425e20147f-12" name="rest_code_c80c2098687e4774aabb0f425e20147f-12" href="posts/numerical_challenge/numerical-02/#rest_code_c80c2098687e4774aabb0f425e20147f-12"></a><span class="w">                </span><span class="n">println</span><span class="p">(</span><span class="s">"n: </span><span class="si">$</span><span class="p">(</span><span class="n">cont</span><span class="p">)</span><span class="s">, c: </span><span class="si">$</span><span class="p">(</span><span class="n">c</span><span class="p">)</span><span class="s">"</span><span class="p">)</span><span class="w"></span>
<a id="rest_code_c80c2098687e4774aabb0f425e20147f-13" name="rest_code_c80c2098687e4774aabb0f425e20147f-13" href="posts/numerical_challenge/numerical-02/#rest_code_c80c2098687e4774aabb0f425e20147f-13"></a><span class="w">            </span><span class="k">end</span><span class="w"></span>
<a id="rest_code_c80c2098687e4774aabb0f425e20147f-14" name="rest_code_c80c2098687e4774aabb0f425e20147f-14" href="posts/numerical_challenge/numerical-02/#rest_code_c80c2098687e4774aabb0f425e20147f-14"></a><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="n">abs</span><span class="p">(</span><span class="n">fun</span><span class="p">(</span><span class="n">c</span><span class="p">))</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">ftol</span><span class="w"></span>
<a id="rest_code_c80c2098687e4774aabb0f425e20147f-15" name="rest_code_c80c2098687e4774aabb0f425e20147f-15" href="posts/numerical_challenge/numerical-02/#rest_code_c80c2098687e4774aabb0f425e20147f-15"></a><span class="w">                </span><span class="n">msg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"Root found with desired accuracy."</span><span class="w"></span>
<a id="rest_code_c80c2098687e4774aabb0f425e20147f-16" name="rest_code_c80c2098687e4774aabb0f425e20147f-16" href="posts/numerical_challenge/numerical-02/#rest_code_c80c2098687e4774aabb0f425e20147f-16"></a><span class="w">                </span><span class="k">break</span><span class="w"></span>
<a id="rest_code_c80c2098687e4774aabb0f425e20147f-17" name="rest_code_c80c2098687e4774aabb0f425e20147f-17" href="posts/numerical_challenge/numerical-02/#rest_code_c80c2098687e4774aabb0f425e20147f-17"></a><span class="w">            </span><span class="k">elseif</span><span class="w"> </span><span class="n">qa</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">qc</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<a id="rest_code_c80c2098687e4774aabb0f425e20147f-18" name="rest_code_c80c2098687e4774aabb0f425e20147f-18" href="posts/numerical_challenge/numerical-02/#rest_code_c80c2098687e4774aabb0f425e20147f-18"></a><span class="w">                </span><span class="n">b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">c</span><span class="w"></span>
<a id="rest_code_c80c2098687e4774aabb0f425e20147f-19" name="rest_code_c80c2098687e4774aabb0f425e20147f-19" href="posts/numerical_challenge/numerical-02/#rest_code_c80c2098687e4774aabb0f425e20147f-19"></a><span class="w">            </span><span class="k">elseif</span><span class="w"> </span><span class="n">qb</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">qc</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<a id="rest_code_c80c2098687e4774aabb0f425e20147f-20" name="rest_code_c80c2098687e4774aabb0f425e20147f-20" href="posts/numerical_challenge/numerical-02/#rest_code_c80c2098687e4774aabb0f425e20147f-20"></a><span class="w">                </span><span class="n">a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">c</span><span class="w"></span>
<a id="rest_code_c80c2098687e4774aabb0f425e20147f-21" name="rest_code_c80c2098687e4774aabb0f425e20147f-21" href="posts/numerical_challenge/numerical-02/#rest_code_c80c2098687e4774aabb0f425e20147f-21"></a><span class="w">            </span><span class="k">end</span><span class="w"></span>
<a id="rest_code_c80c2098687e4774aabb0f425e20147f-22" name="rest_code_c80c2098687e4774aabb0f425e20147f-22" href="posts/numerical_challenge/numerical-02/#rest_code_c80c2098687e4774aabb0f425e20147f-22"></a><span class="w">            </span><span class="n">msg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"Maximum number of iterations reached."</span><span class="w"></span>
<a id="rest_code_c80c2098687e4774aabb0f425e20147f-23" name="rest_code_c80c2098687e4774aabb0f425e20147f-23" href="posts/numerical_challenge/numerical-02/#rest_code_c80c2098687e4774aabb0f425e20147f-23"></a><span class="w">        </span><span class="k">end</span><span class="w"></span>
<a id="rest_code_c80c2098687e4774aabb0f425e20147f-24" name="rest_code_c80c2098687e4774aabb0f425e20147f-24" href="posts/numerical_challenge/numerical-02/#rest_code_c80c2098687e4774aabb0f425e20147f-24"></a><span class="w">    </span><span class="k">end</span><span class="w"></span>
<a id="rest_code_c80c2098687e4774aabb0f425e20147f-25" name="rest_code_c80c2098687e4774aabb0f425e20147f-25" href="posts/numerical_challenge/numerical-02/#rest_code_c80c2098687e4774aabb0f425e20147f-25"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">c</span><span class="p">,</span><span class="w"> </span><span class="n">msg</span><span class="w"></span>
<a id="rest_code_c80c2098687e4774aabb0f425e20147f-26" name="rest_code_c80c2098687e4774aabb0f425e20147f-26" href="posts/numerical_challenge/numerical-02/#rest_code_c80c2098687e4774aabb0f425e20147f-26"></a><span class="k">end</span><span class="w"></span>
<a id="rest_code_c80c2098687e4774aabb0f425e20147f-27" name="rest_code_c80c2098687e4774aabb0f425e20147f-27" href="posts/numerical_challenge/numerical-02/#rest_code_c80c2098687e4774aabb0f425e20147f-27"></a>
<a id="rest_code_c80c2098687e4774aabb0f425e20147f-28" name="rest_code_c80c2098687e4774aabb0f425e20147f-28" href="posts/numerical_challenge/numerical-02/#rest_code_c80c2098687e4774aabb0f425e20147f-28"></a><span class="k">function</span><span class="w"> </span><span class="n">fun</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w"></span>
<a id="rest_code_c80c2098687e4774aabb0f425e20147f-29" name="rest_code_c80c2098687e4774aabb0f425e20147f-29" href="posts/numerical_challenge/numerical-02/#rest_code_c80c2098687e4774aabb0f425e20147f-29"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">x</span><span class="w"></span>
<a id="rest_code_c80c2098687e4774aabb0f425e20147f-30" name="rest_code_c80c2098687e4774aabb0f425e20147f-30" href="posts/numerical_challenge/numerical-02/#rest_code_c80c2098687e4774aabb0f425e20147f-30"></a><span class="k">end</span><span class="w"></span>
<a id="rest_code_c80c2098687e4774aabb0f425e20147f-31" name="rest_code_c80c2098687e4774aabb0f425e20147f-31" href="posts/numerical_challenge/numerical-02/#rest_code_c80c2098687e4774aabb0f425e20147f-31"></a>
<a id="rest_code_c80c2098687e4774aabb0f425e20147f-32" name="rest_code_c80c2098687e4774aabb0f425e20147f-32" href="posts/numerical_challenge/numerical-02/#rest_code_c80c2098687e4774aabb0f425e20147f-32"></a><span class="n">println</span><span class="p">(</span><span class="n">regula_falsi</span><span class="p">(</span><span class="n">fun</span><span class="p">,</span><span class="w"> </span><span class="mf">0.5</span><span class="p">,</span><span class="w"> </span><span class="mf">0.25</span><span class="o">*</span><span class="nb">pi</span><span class="p">))</span><span class="w"></span>
</pre></div>
</section><section id="comparison"><h3>Comparison</h3>
<p>Regarding number of lines we have: 29 in Python and 32 in Julia. The comparison
in execution time is done with <code class="docutils literal">%timeit</code> magic command in IPython and
<code class="docutils literal">@benchmark</code> in Julia.</p>
<p>For Python:</p>
<div class="code"><pre class="code IPython"><a id="rest_code_ef3cfd36cafc4a799824c9298faf59e9-1" name="rest_code_ef3cfd36cafc4a799824c9298faf59e9-1" href="posts/numerical_challenge/numerical-02/#rest_code_ef3cfd36cafc4a799824c9298faf59e9-1"></a><span class="o">%</span><span class="k">timeit</span> regula_falsi(fun, 0.5, 0.25*pi)
</pre></div>
<p>with result</p>
<div class="code"><pre class="code IPython"><a id="rest_code_df82c9c2cbc54365ae3114ba61248f2c-1" name="rest_code_df82c9c2cbc54365ae3114ba61248f2c-1" href="posts/numerical_challenge/numerical-02/#rest_code_df82c9c2cbc54365ae3114ba61248f2c-1"></a><span class="mi">10000</span> <span class="n">loops</span><span class="p">,</span> <span class="n">best</span> <span class="n">of</span> <span class="mi">3</span><span class="p">:</span> <span class="mf">35.1</span> <span class="n">µs</span> <span class="n">per</span> <span class="n">loop</span>
</pre></div>
<p>For Julia:</p>
<div class="code"><pre class="code julia"><a id="rest_code_13e525dd85a045e2abe1c39d8767b5f4-1" name="rest_code_13e525dd85a045e2abe1c39d8767b5f4-1" href="posts/numerical_challenge/numerical-02/#rest_code_13e525dd85a045e2abe1c39d8767b5f4-1"></a><span class="nd">@benchmark</span><span class="w"> </span><span class="n">regula_falsi</span><span class="p">(</span><span class="n">fun</span><span class="p">,</span><span class="w"> </span><span class="mf">0.5</span><span class="p">,</span><span class="w"> </span><span class="mf">0.25</span><span class="o">*</span><span class="nb">pi</span><span class="p">)</span><span class="w"></span>
</pre></div>
<p>with result</p>
<div class="code"><pre class="code julia"><a id="rest_code_687458e074424522b6ec8936292beb95-1" name="rest_code_687458e074424522b6ec8936292beb95-1" href="posts/numerical_challenge/numerical-02/#rest_code_687458e074424522b6ec8936292beb95-1"></a><span class="n">BenchmarkTools</span><span class="o">.</span><span class="n">Trial</span><span class="o">:</span><span class="w"></span>
<a id="rest_code_687458e074424522b6ec8936292beb95-2" name="rest_code_687458e074424522b6ec8936292beb95-2" href="posts/numerical_challenge/numerical-02/#rest_code_687458e074424522b6ec8936292beb95-2"></a><span class="w">  </span><span class="n">memory</span><span class="w"> </span><span class="n">estimate</span><span class="o">:</span><span class="w">  </span><span class="mi">48</span><span class="w"> </span><span class="n">bytes</span><span class="w"></span>
<a id="rest_code_687458e074424522b6ec8936292beb95-3" name="rest_code_687458e074424522b6ec8936292beb95-3" href="posts/numerical_challenge/numerical-02/#rest_code_687458e074424522b6ec8936292beb95-3"></a><span class="w">  </span><span class="n">allocs</span><span class="w"> </span><span class="n">estimate</span><span class="o">:</span><span class="w">  </span><span class="mi">2</span><span class="w"></span>
<a id="rest_code_687458e074424522b6ec8936292beb95-4" name="rest_code_687458e074424522b6ec8936292beb95-4" href="posts/numerical_challenge/numerical-02/#rest_code_687458e074424522b6ec8936292beb95-4"></a><span class="w">  </span><span class="o">--------------</span><span class="w"></span>
<a id="rest_code_687458e074424522b6ec8936292beb95-5" name="rest_code_687458e074424522b6ec8936292beb95-5" href="posts/numerical_challenge/numerical-02/#rest_code_687458e074424522b6ec8936292beb95-5"></a><span class="w">  </span><span class="n">minimum</span><span class="w"> </span><span class="n">time</span><span class="o">:</span><span class="w">     </span><span class="mf">449.495</span><span class="w"> </span><span class="n">ns</span><span class="w"> </span><span class="p">(</span><span class="mf">0.00</span><span class="o">%</span><span class="w"> </span><span class="n">GC</span><span class="p">)</span><span class="w"></span>
<a id="rest_code_687458e074424522b6ec8936292beb95-6" name="rest_code_687458e074424522b6ec8936292beb95-6" href="posts/numerical_challenge/numerical-02/#rest_code_687458e074424522b6ec8936292beb95-6"></a><span class="w">  </span><span class="n">median</span><span class="w"> </span><span class="n">time</span><span class="o">:</span><span class="w">      </span><span class="mf">464.371</span><span class="w"> </span><span class="n">ns</span><span class="w"> </span><span class="p">(</span><span class="mf">0.00</span><span class="o">%</span><span class="w"> </span><span class="n">GC</span><span class="p">)</span><span class="w"></span>
<a id="rest_code_687458e074424522b6ec8936292beb95-7" name="rest_code_687458e074424522b6ec8936292beb95-7" href="posts/numerical_challenge/numerical-02/#rest_code_687458e074424522b6ec8936292beb95-7"></a><span class="w">  </span><span class="n">mean</span><span class="w"> </span><span class="n">time</span><span class="o">:</span><span class="w">        </span><span class="mf">493.785</span><span class="w"> </span><span class="n">ns</span><span class="w"> </span><span class="p">(</span><span class="mf">0.52</span><span class="o">%</span><span class="w"> </span><span class="n">GC</span><span class="p">)</span><span class="w"></span>
<a id="rest_code_687458e074424522b6ec8936292beb95-8" name="rest_code_687458e074424522b6ec8936292beb95-8" href="posts/numerical_challenge/numerical-02/#rest_code_687458e074424522b6ec8936292beb95-8"></a><span class="w">  </span><span class="n">maximum</span><span class="w"> </span><span class="n">time</span><span class="o">:</span><span class="w">     </span><span class="mf">9.723</span><span class="w"> </span><span class="n">μs</span><span class="w"> </span><span class="p">(</span><span class="mf">92.54</span><span class="o">%</span><span class="w"> </span><span class="n">GC</span><span class="p">)</span><span class="w"></span>
<a id="rest_code_687458e074424522b6ec8936292beb95-9" name="rest_code_687458e074424522b6ec8936292beb95-9" href="posts/numerical_challenge/numerical-02/#rest_code_687458e074424522b6ec8936292beb95-9"></a><span class="w">  </span><span class="o">--------------</span><span class="w"></span>
<a id="rest_code_687458e074424522b6ec8936292beb95-10" name="rest_code_687458e074424522b6ec8936292beb95-10" href="posts/numerical_challenge/numerical-02/#rest_code_687458e074424522b6ec8936292beb95-10"></a><span class="w">  </span><span class="n">samples</span><span class="o">:</span><span class="w">          </span><span class="mi">10000</span><span class="w"></span>
<a id="rest_code_687458e074424522b6ec8936292beb95-11" name="rest_code_687458e074424522b6ec8936292beb95-11" href="posts/numerical_challenge/numerical-02/#rest_code_687458e074424522b6ec8936292beb95-11"></a><span class="w">  </span><span class="n">evals</span><span class="o">/</span><span class="n">sample</span><span class="o">:</span><span class="w">     </span><span class="mi">198</span><span class="w"></span>
</pre></div>
</section></section>
</div>
    </article><article class="post h-entry post-text"><header><h1 class="post-title p-name"><a href="posts/numerical_challenge/numerical-01/" class="u-url">Numerical methods challenge</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn">Nicolás Guarín-Zapata</span></p>
            <p class="dateline"><a href="posts/numerical_challenge/numerical-01/" rel="bookmark"><time class="post-date published dt-published" datetime="2017-10-01T23:12:04-05:00" title="2017-10-01 23:12">2017-10-01 23:12</time></a></p>
                <p class="commentline">
    
    <a href="posts/numerical_challenge/numerical-01/#disqus_thread" data-disqus-identifier="cache/posts/numerical_challenge/numerical-01.html">Comments</a>


        </p>
</div>
    </header><div class="e-content entry-content">
    <p>For the next month I will write a program per day for some well-known numerical
methods in both Python and Julia. It is intended to be an exercise, then
don't expect the code to be good enough for real use. Also, I should mention
that I have almost no experience with Julia, so it probably won't be
idiomatic Julia but more Python-like Julia.</p>
<section id="day-1-bisection-method"><h2>Day 1: Bisection method</h2>
<p>The first method to be considered is the
<a class="reference external" href="https://en.wikipedia.org/wiki/Bisection_method">bisection method</a>. This
method is used to solve the equation <span class="math">\(f(x) = 0\)</span> for <span class="math">\(x\)</span> real,
and <span class="math">\(f\)</span> continuous. It starts with an interval <span class="math">\([a,b]\)</span>, where
<span class="math">\(f(a)\)</span> and <span class="math">\(f(b)\)</span> should have opposite signs. The method then
proceeds by halving the interval and selecting the one where the solution
appears, i.e., the sign of the function changes.</p>
<p>We will use the function <span class="math">\(f(x) = \cos(x) - x^2\)</span> to test the codes,
and the initial interval is [0, 1].</p>
<p>The following are the codes:</p>
<section id="python"><h3>Python</h3>
<div class="code"><pre class="code python"><a id="rest_code_bba530d4497f4059825466efaa59c429-1" name="rest_code_bba530d4497f4059825466efaa59c429-1" href="posts/numerical_challenge/numerical-01/#rest_code_bba530d4497f4059825466efaa59c429-1"></a><span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">division</span><span class="p">,</span> <span class="n">print_function</span>
<a id="rest_code_bba530d4497f4059825466efaa59c429-2" name="rest_code_bba530d4497f4059825466efaa59c429-2" href="posts/numerical_challenge/numerical-01/#rest_code_bba530d4497f4059825466efaa59c429-2"></a><span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="n">log2</span><span class="p">,</span> <span class="n">ceil</span><span class="p">,</span> <span class="nb">abs</span><span class="p">,</span> <span class="n">cos</span>
<a id="rest_code_bba530d4497f4059825466efaa59c429-3" name="rest_code_bba530d4497f4059825466efaa59c429-3" href="posts/numerical_challenge/numerical-01/#rest_code_bba530d4497f4059825466efaa59c429-3"></a>
<a id="rest_code_bba530d4497f4059825466efaa59c429-4" name="rest_code_bba530d4497f4059825466efaa59c429-4" href="posts/numerical_challenge/numerical-01/#rest_code_bba530d4497f4059825466efaa59c429-4"></a><span class="k">def</span> <span class="nf">bisection</span><span class="p">(</span><span class="n">fun</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">xtol</span><span class="o">=</span><span class="mf">1e-6</span><span class="p">,</span> <span class="n">ftol</span><span class="o">=</span><span class="mf">1e-12</span><span class="p">):</span>
<a id="rest_code_bba530d4497f4059825466efaa59c429-5" name="rest_code_bba530d4497f4059825466efaa59c429-5" href="posts/numerical_challenge/numerical-01/#rest_code_bba530d4497f4059825466efaa59c429-5"></a>    <span class="k">if</span> <span class="n">fun</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="o">*</span> <span class="n">fun</span><span class="p">(</span><span class="n">b</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
<a id="rest_code_bba530d4497f4059825466efaa59c429-6" name="rest_code_bba530d4497f4059825466efaa59c429-6" href="posts/numerical_challenge/numerical-01/#rest_code_bba530d4497f4059825466efaa59c429-6"></a>        <span class="n">c</span> <span class="o">=</span> <span class="kc">None</span>
<a id="rest_code_bba530d4497f4059825466efaa59c429-7" name="rest_code_bba530d4497f4059825466efaa59c429-7" href="posts/numerical_challenge/numerical-01/#rest_code_bba530d4497f4059825466efaa59c429-7"></a>        <span class="n">msg</span> <span class="o">=</span> <span class="s2">"The function should have a sign change in the interval."</span>
<a id="rest_code_bba530d4497f4059825466efaa59c429-8" name="rest_code_bba530d4497f4059825466efaa59c429-8" href="posts/numerical_challenge/numerical-01/#rest_code_bba530d4497f4059825466efaa59c429-8"></a>    <span class="k">else</span><span class="p">:</span>
<a id="rest_code_bba530d4497f4059825466efaa59c429-9" name="rest_code_bba530d4497f4059825466efaa59c429-9" href="posts/numerical_challenge/numerical-01/#rest_code_bba530d4497f4059825466efaa59c429-9"></a>        <span class="n">nmax</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">ceil</span><span class="p">(</span><span class="n">log2</span><span class="p">((</span><span class="n">b</span> <span class="o">-</span> <span class="n">a</span><span class="p">)</span><span class="o">/</span><span class="n">xtol</span><span class="p">)))</span>
<a id="rest_code_bba530d4497f4059825466efaa59c429-10" name="rest_code_bba530d4497f4059825466efaa59c429-10" href="posts/numerical_challenge/numerical-01/#rest_code_bba530d4497f4059825466efaa59c429-10"></a>        <span class="k">for</span> <span class="n">cont</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nmax</span><span class="p">):</span>
<a id="rest_code_bba530d4497f4059825466efaa59c429-11" name="rest_code_bba530d4497f4059825466efaa59c429-11" href="posts/numerical_challenge/numerical-01/#rest_code_bba530d4497f4059825466efaa59c429-11"></a>            <span class="n">c</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="n">a</span> <span class="o">+</span> <span class="n">b</span><span class="p">)</span>
<a id="rest_code_bba530d4497f4059825466efaa59c429-12" name="rest_code_bba530d4497f4059825466efaa59c429-12" href="posts/numerical_challenge/numerical-01/#rest_code_bba530d4497f4059825466efaa59c429-12"></a>            <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">fun</span><span class="p">(</span><span class="n">c</span><span class="p">))</span> <span class="o">&lt;</span> <span class="n">ftol</span><span class="p">:</span>
<a id="rest_code_bba530d4497f4059825466efaa59c429-13" name="rest_code_bba530d4497f4059825466efaa59c429-13" href="posts/numerical_challenge/numerical-01/#rest_code_bba530d4497f4059825466efaa59c429-13"></a>                <span class="n">msg</span> <span class="o">=</span> <span class="s2">"Root found with desired accuracy."</span>
<a id="rest_code_bba530d4497f4059825466efaa59c429-14" name="rest_code_bba530d4497f4059825466efaa59c429-14" href="posts/numerical_challenge/numerical-01/#rest_code_bba530d4497f4059825466efaa59c429-14"></a>                <span class="k">break</span>
<a id="rest_code_bba530d4497f4059825466efaa59c429-15" name="rest_code_bba530d4497f4059825466efaa59c429-15" href="posts/numerical_challenge/numerical-01/#rest_code_bba530d4497f4059825466efaa59c429-15"></a>            <span class="k">elif</span> <span class="n">fun</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="o">*</span> <span class="n">fun</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
<a id="rest_code_bba530d4497f4059825466efaa59c429-16" name="rest_code_bba530d4497f4059825466efaa59c429-16" href="posts/numerical_challenge/numerical-01/#rest_code_bba530d4497f4059825466efaa59c429-16"></a>                <span class="n">b</span> <span class="o">=</span> <span class="n">c</span>
<a id="rest_code_bba530d4497f4059825466efaa59c429-17" name="rest_code_bba530d4497f4059825466efaa59c429-17" href="posts/numerical_challenge/numerical-01/#rest_code_bba530d4497f4059825466efaa59c429-17"></a>            <span class="k">elif</span> <span class="n">fun</span><span class="p">(</span><span class="n">b</span><span class="p">)</span> <span class="o">*</span> <span class="n">fun</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
<a id="rest_code_bba530d4497f4059825466efaa59c429-18" name="rest_code_bba530d4497f4059825466efaa59c429-18" href="posts/numerical_challenge/numerical-01/#rest_code_bba530d4497f4059825466efaa59c429-18"></a>                <span class="n">a</span> <span class="o">=</span> <span class="n">c</span>
<a id="rest_code_bba530d4497f4059825466efaa59c429-19" name="rest_code_bba530d4497f4059825466efaa59c429-19" href="posts/numerical_challenge/numerical-01/#rest_code_bba530d4497f4059825466efaa59c429-19"></a>            <span class="n">msg</span> <span class="o">=</span> <span class="s2">"Maximum number of iterations reached."</span>
<a id="rest_code_bba530d4497f4059825466efaa59c429-20" name="rest_code_bba530d4497f4059825466efaa59c429-20" href="posts/numerical_challenge/numerical-01/#rest_code_bba530d4497f4059825466efaa59c429-20"></a>    <span class="k">return</span> <span class="n">c</span><span class="p">,</span> <span class="n">msg</span>
<a id="rest_code_bba530d4497f4059825466efaa59c429-21" name="rest_code_bba530d4497f4059825466efaa59c429-21" href="posts/numerical_challenge/numerical-01/#rest_code_bba530d4497f4059825466efaa59c429-21"></a>
<a id="rest_code_bba530d4497f4059825466efaa59c429-22" name="rest_code_bba530d4497f4059825466efaa59c429-22" href="posts/numerical_challenge/numerical-01/#rest_code_bba530d4497f4059825466efaa59c429-22"></a><span class="k">def</span> <span class="nf">fun</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<a id="rest_code_bba530d4497f4059825466efaa59c429-23" name="rest_code_bba530d4497f4059825466efaa59c429-23" href="posts/numerical_challenge/numerical-01/#rest_code_bba530d4497f4059825466efaa59c429-23"></a>    <span class="k">return</span> <span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span>
<a id="rest_code_bba530d4497f4059825466efaa59c429-24" name="rest_code_bba530d4497f4059825466efaa59c429-24" href="posts/numerical_challenge/numerical-01/#rest_code_bba530d4497f4059825466efaa59c429-24"></a>
<a id="rest_code_bba530d4497f4059825466efaa59c429-25" name="rest_code_bba530d4497f4059825466efaa59c429-25" href="posts/numerical_challenge/numerical-01/#rest_code_bba530d4497f4059825466efaa59c429-25"></a><span class="nb">print</span><span class="p">(</span><span class="n">bisection</span><span class="p">(</span><span class="n">fun</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">))</span>
</pre></div>
<p>With result</p>
<div class="code"><pre class="code python"><a id="rest_code_ef164da1c4d64445b77e32478f476230-1" name="rest_code_ef164da1c4d64445b77e32478f476230-1" href="posts/numerical_challenge/numerical-01/#rest_code_ef164da1c4d64445b77e32478f476230-1"></a><span class="p">(</span><span class="mf">0.824131965637207</span><span class="p">,</span> <span class="s1">'Maximum number of iterations reached.'</span><span class="p">)</span>
</pre></div>
</section><section id="julia"><h3>Julia</h3>
<div class="code"><pre class="code julia"><a id="rest_code_a19548b5f48c445b92fc98d039adeb83-1" name="rest_code_a19548b5f48c445b92fc98d039adeb83-1" href="posts/numerical_challenge/numerical-01/#rest_code_a19548b5f48c445b92fc98d039adeb83-1"></a><span class="k">function</span><span class="w"> </span><span class="n">bisection</span><span class="p">(</span><span class="n">fun</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="p">,</span><span class="w"> </span><span class="n">xtol</span><span class="o">=</span><span class="mf">1e-6</span><span class="p">,</span><span class="w"> </span><span class="n">ftol</span><span class="o">=</span><span class="mf">1e-12</span><span class="p">)</span><span class="w"></span>
<a id="rest_code_a19548b5f48c445b92fc98d039adeb83-2" name="rest_code_a19548b5f48c445b92fc98d039adeb83-2" href="posts/numerical_challenge/numerical-01/#rest_code_a19548b5f48c445b92fc98d039adeb83-2"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">fun</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">fun</span><span class="p">(</span><span class="n">b</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<a id="rest_code_a19548b5f48c445b92fc98d039adeb83-3" name="rest_code_a19548b5f48c445b92fc98d039adeb83-3" href="posts/numerical_challenge/numerical-01/#rest_code_a19548b5f48c445b92fc98d039adeb83-3"></a><span class="w">        </span><span class="n">c</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">nothing</span><span class="w"></span>
<a id="rest_code_a19548b5f48c445b92fc98d039adeb83-4" name="rest_code_a19548b5f48c445b92fc98d039adeb83-4" href="posts/numerical_challenge/numerical-01/#rest_code_a19548b5f48c445b92fc98d039adeb83-4"></a><span class="w">        </span><span class="n">msg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"The function should have a sign change in the interval."</span><span class="w"></span>
<a id="rest_code_a19548b5f48c445b92fc98d039adeb83-5" name="rest_code_a19548b5f48c445b92fc98d039adeb83-5" href="posts/numerical_challenge/numerical-01/#rest_code_a19548b5f48c445b92fc98d039adeb83-5"></a><span class="w">    </span><span class="k">else</span><span class="w"></span>
<a id="rest_code_a19548b5f48c445b92fc98d039adeb83-6" name="rest_code_a19548b5f48c445b92fc98d039adeb83-6" href="posts/numerical_challenge/numerical-01/#rest_code_a19548b5f48c445b92fc98d039adeb83-6"></a><span class="w">        </span><span class="n">nmax</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ceil</span><span class="p">(</span><span class="n">log2</span><span class="p">((</span><span class="n">b</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">a</span><span class="p">)</span><span class="o">/</span><span class="n">xtol</span><span class="p">))</span><span class="w"></span>
<a id="rest_code_a19548b5f48c445b92fc98d039adeb83-7" name="rest_code_a19548b5f48c445b92fc98d039adeb83-7" href="posts/numerical_challenge/numerical-01/#rest_code_a19548b5f48c445b92fc98d039adeb83-7"></a><span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="n">cont</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="n">nmax</span><span class="w"></span>
<a id="rest_code_a19548b5f48c445b92fc98d039adeb83-8" name="rest_code_a19548b5f48c445b92fc98d039adeb83-8" href="posts/numerical_challenge/numerical-01/#rest_code_a19548b5f48c445b92fc98d039adeb83-8"></a><span class="w">            </span><span class="n">c</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="n">a</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">b</span><span class="p">)</span><span class="w"></span>
<a id="rest_code_a19548b5f48c445b92fc98d039adeb83-9" name="rest_code_a19548b5f48c445b92fc98d039adeb83-9" href="posts/numerical_challenge/numerical-01/#rest_code_a19548b5f48c445b92fc98d039adeb83-9"></a><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="n">abs</span><span class="p">(</span><span class="n">fun</span><span class="p">(</span><span class="n">c</span><span class="p">))</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">ftol</span><span class="w"></span>
<a id="rest_code_a19548b5f48c445b92fc98d039adeb83-10" name="rest_code_a19548b5f48c445b92fc98d039adeb83-10" href="posts/numerical_challenge/numerical-01/#rest_code_a19548b5f48c445b92fc98d039adeb83-10"></a><span class="w">                </span><span class="n">msg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"Root found with desired accuracy."</span><span class="w"></span>
<a id="rest_code_a19548b5f48c445b92fc98d039adeb83-11" name="rest_code_a19548b5f48c445b92fc98d039adeb83-11" href="posts/numerical_challenge/numerical-01/#rest_code_a19548b5f48c445b92fc98d039adeb83-11"></a><span class="w">                </span><span class="k">break</span><span class="w"></span>
<a id="rest_code_a19548b5f48c445b92fc98d039adeb83-12" name="rest_code_a19548b5f48c445b92fc98d039adeb83-12" href="posts/numerical_challenge/numerical-01/#rest_code_a19548b5f48c445b92fc98d039adeb83-12"></a><span class="w">            </span><span class="k">elseif</span><span class="w"> </span><span class="n">fun</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">fun</span><span class="p">(</span><span class="n">c</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<a id="rest_code_a19548b5f48c445b92fc98d039adeb83-13" name="rest_code_a19548b5f48c445b92fc98d039adeb83-13" href="posts/numerical_challenge/numerical-01/#rest_code_a19548b5f48c445b92fc98d039adeb83-13"></a><span class="w">                </span><span class="n">b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">c</span><span class="w"></span>
<a id="rest_code_a19548b5f48c445b92fc98d039adeb83-14" name="rest_code_a19548b5f48c445b92fc98d039adeb83-14" href="posts/numerical_challenge/numerical-01/#rest_code_a19548b5f48c445b92fc98d039adeb83-14"></a><span class="w">            </span><span class="k">elseif</span><span class="w"> </span><span class="n">fun</span><span class="p">(</span><span class="n">b</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">fun</span><span class="p">(</span><span class="n">c</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<a id="rest_code_a19548b5f48c445b92fc98d039adeb83-15" name="rest_code_a19548b5f48c445b92fc98d039adeb83-15" href="posts/numerical_challenge/numerical-01/#rest_code_a19548b5f48c445b92fc98d039adeb83-15"></a><span class="w">                </span><span class="n">a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">c</span><span class="w"></span>
<a id="rest_code_a19548b5f48c445b92fc98d039adeb83-16" name="rest_code_a19548b5f48c445b92fc98d039adeb83-16" href="posts/numerical_challenge/numerical-01/#rest_code_a19548b5f48c445b92fc98d039adeb83-16"></a><span class="w">            </span><span class="k">end</span><span class="w"></span>
<a id="rest_code_a19548b5f48c445b92fc98d039adeb83-17" name="rest_code_a19548b5f48c445b92fc98d039adeb83-17" href="posts/numerical_challenge/numerical-01/#rest_code_a19548b5f48c445b92fc98d039adeb83-17"></a><span class="w">            </span><span class="n">msg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"Maximum number of iterations reached."</span><span class="w"></span>
<a id="rest_code_a19548b5f48c445b92fc98d039adeb83-18" name="rest_code_a19548b5f48c445b92fc98d039adeb83-18" href="posts/numerical_challenge/numerical-01/#rest_code_a19548b5f48c445b92fc98d039adeb83-18"></a><span class="w">        </span><span class="k">end</span><span class="w"></span>
<a id="rest_code_a19548b5f48c445b92fc98d039adeb83-19" name="rest_code_a19548b5f48c445b92fc98d039adeb83-19" href="posts/numerical_challenge/numerical-01/#rest_code_a19548b5f48c445b92fc98d039adeb83-19"></a><span class="w">    </span><span class="k">end</span><span class="w"></span>
<a id="rest_code_a19548b5f48c445b92fc98d039adeb83-20" name="rest_code_a19548b5f48c445b92fc98d039adeb83-20" href="posts/numerical_challenge/numerical-01/#rest_code_a19548b5f48c445b92fc98d039adeb83-20"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">c</span><span class="p">,</span><span class="w"> </span><span class="n">msg</span><span class="w"></span>
<a id="rest_code_a19548b5f48c445b92fc98d039adeb83-21" name="rest_code_a19548b5f48c445b92fc98d039adeb83-21" href="posts/numerical_challenge/numerical-01/#rest_code_a19548b5f48c445b92fc98d039adeb83-21"></a><span class="k">end</span><span class="w"></span>
<a id="rest_code_a19548b5f48c445b92fc98d039adeb83-22" name="rest_code_a19548b5f48c445b92fc98d039adeb83-22" href="posts/numerical_challenge/numerical-01/#rest_code_a19548b5f48c445b92fc98d039adeb83-22"></a>
<a id="rest_code_a19548b5f48c445b92fc98d039adeb83-23" name="rest_code_a19548b5f48c445b92fc98d039adeb83-23" href="posts/numerical_challenge/numerical-01/#rest_code_a19548b5f48c445b92fc98d039adeb83-23"></a><span class="k">function</span><span class="w"> </span><span class="n">fun</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w"></span>
<a id="rest_code_a19548b5f48c445b92fc98d039adeb83-24" name="rest_code_a19548b5f48c445b92fc98d039adeb83-24" href="posts/numerical_challenge/numerical-01/#rest_code_a19548b5f48c445b92fc98d039adeb83-24"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="w"></span>
<a id="rest_code_a19548b5f48c445b92fc98d039adeb83-25" name="rest_code_a19548b5f48c445b92fc98d039adeb83-25" href="posts/numerical_challenge/numerical-01/#rest_code_a19548b5f48c445b92fc98d039adeb83-25"></a><span class="k">end</span><span class="w"></span>
<a id="rest_code_a19548b5f48c445b92fc98d039adeb83-26" name="rest_code_a19548b5f48c445b92fc98d039adeb83-26" href="posts/numerical_challenge/numerical-01/#rest_code_a19548b5f48c445b92fc98d039adeb83-26"></a>
<a id="rest_code_a19548b5f48c445b92fc98d039adeb83-27" name="rest_code_a19548b5f48c445b92fc98d039adeb83-27" href="posts/numerical_challenge/numerical-01/#rest_code_a19548b5f48c445b92fc98d039adeb83-27"></a><span class="n">println</span><span class="p">(</span><span class="n">bisection</span><span class="p">(</span><span class="n">fun</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">1.0</span><span class="p">))</span><span class="w"></span>
</pre></div>
<p>With result</p>
<div class="code"><pre class="code julia"><a id="rest_code_3073618a38a340108bc255f2c6ff2c29-1" name="rest_code_3073618a38a340108bc255f2c6ff2c29-1" href="posts/numerical_challenge/numerical-01/#rest_code_3073618a38a340108bc255f2c6ff2c29-1"></a><span class="p">(</span><span class="mf">0.824131965637207</span><span class="p">,</span><span class="w"> </span><span class="s">"Maximum number of iterations reached."</span><span class="p">)</span><span class="w"></span>
</pre></div>
<p>In this case, both codes are really close to each other. The Python code
has 25 lines, while the Julia one has 27. As expected, the results given by
them are the same.</p>
</section><section id="edit-2017-10-02"><h3>Edit (2017-10-02)</h3>
<p>As suggested by Edward Villegas, I decided to compare execution times.
I used <code class="docutils literal">%timeit</code> for IPython and <code class="docutils literal">@benchmark</code> (from <code class="docutils literal">BenchmarkTools</code>)
for Julia.</p>
<p>In IPython, we have</p>
<div class="code"><pre class="code IPython"><a id="rest_code_4566d22a90604debafdfba62a5409b86-1" name="rest_code_4566d22a90604debafdfba62a5409b86-1" href="posts/numerical_challenge/numerical-01/#rest_code_4566d22a90604debafdfba62a5409b86-1"></a><span class="o">%</span><span class="k">timeit</span> bisection(fun, 0.0, 2.0)
</pre></div>
<p>with result</p>
<div class="code"><pre class="code IPython"><a id="rest_code_dd24cfb8e4dc4d17b053d84eb610266e-1" name="rest_code_dd24cfb8e4dc4d17b053d84eb610266e-1" href="posts/numerical_challenge/numerical-01/#rest_code_dd24cfb8e4dc4d17b053d84eb610266e-1"></a><span class="mi">10000</span> <span class="n">loops</span><span class="p">,</span> <span class="n">best</span> <span class="n">of</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">107</span> <span class="n">µs</span> <span class="n">per</span> <span class="n">loop</span>
</pre></div>
<p>And in Julia, we have</p>
<div class="code"><pre class="code julia"><a id="rest_code_f275307baf5d4025bfdabadeb89fa23f-1" name="rest_code_f275307baf5d4025bfdabadeb89fa23f-1" href="posts/numerical_challenge/numerical-01/#rest_code_f275307baf5d4025bfdabadeb89fa23f-1"></a><span class="nd">@benchmark</span><span class="w"> </span><span class="n">bisection</span><span class="p">(</span><span class="n">fun</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">2.0</span><span class="p">)</span><span class="w"></span>
</pre></div>
<p>with result</p>
<div class="code"><pre class="code julia"><a id="rest_code_7e8ff46f24134c66acbfbe956bd15b12-1" name="rest_code_7e8ff46f24134c66acbfbe956bd15b12-1" href="posts/numerical_challenge/numerical-01/#rest_code_7e8ff46f24134c66acbfbe956bd15b12-1"></a><span class="n">BenchmarkTools</span><span class="o">.</span><span class="n">Trial</span><span class="o">:</span><span class="w"></span>
<a id="rest_code_7e8ff46f24134c66acbfbe956bd15b12-2" name="rest_code_7e8ff46f24134c66acbfbe956bd15b12-2" href="posts/numerical_challenge/numerical-01/#rest_code_7e8ff46f24134c66acbfbe956bd15b12-2"></a><span class="w">  </span><span class="n">memory</span><span class="w"> </span><span class="n">estimate</span><span class="o">:</span><span class="w">  </span><span class="mi">48</span><span class="w"> </span><span class="n">bytes</span><span class="w"></span>
<a id="rest_code_7e8ff46f24134c66acbfbe956bd15b12-3" name="rest_code_7e8ff46f24134c66acbfbe956bd15b12-3" href="posts/numerical_challenge/numerical-01/#rest_code_7e8ff46f24134c66acbfbe956bd15b12-3"></a><span class="w">  </span><span class="n">allocs</span><span class="w"> </span><span class="n">estimate</span><span class="o">:</span><span class="w">  </span><span class="mi">2</span><span class="w"></span>
<a id="rest_code_7e8ff46f24134c66acbfbe956bd15b12-4" name="rest_code_7e8ff46f24134c66acbfbe956bd15b12-4" href="posts/numerical_challenge/numerical-01/#rest_code_7e8ff46f24134c66acbfbe956bd15b12-4"></a><span class="w">  </span><span class="o">--------------</span><span class="w"></span>
<a id="rest_code_7e8ff46f24134c66acbfbe956bd15b12-5" name="rest_code_7e8ff46f24134c66acbfbe956bd15b12-5" href="posts/numerical_challenge/numerical-01/#rest_code_7e8ff46f24134c66acbfbe956bd15b12-5"></a><span class="w">  </span><span class="n">minimum</span><span class="w"> </span><span class="n">time</span><span class="o">:</span><span class="w">     </span><span class="mf">1.505</span><span class="w"> </span><span class="n">μs</span><span class="w"> </span><span class="p">(</span><span class="mf">0.00</span><span class="o">%</span><span class="w"> </span><span class="n">GC</span><span class="p">)</span><span class="w"></span>
<a id="rest_code_7e8ff46f24134c66acbfbe956bd15b12-6" name="rest_code_7e8ff46f24134c66acbfbe956bd15b12-6" href="posts/numerical_challenge/numerical-01/#rest_code_7e8ff46f24134c66acbfbe956bd15b12-6"></a><span class="w">  </span><span class="n">median</span><span class="w"> </span><span class="n">time</span><span class="o">:</span><span class="w">      </span><span class="mf">1.548</span><span class="w"> </span><span class="n">μs</span><span class="w"> </span><span class="p">(</span><span class="mf">0.00</span><span class="o">%</span><span class="w"> </span><span class="n">GC</span><span class="p">)</span><span class="w"></span>
<a id="rest_code_7e8ff46f24134c66acbfbe956bd15b12-7" name="rest_code_7e8ff46f24134c66acbfbe956bd15b12-7" href="posts/numerical_challenge/numerical-01/#rest_code_7e8ff46f24134c66acbfbe956bd15b12-7"></a><span class="w">  </span><span class="n">mean</span><span class="w"> </span><span class="n">time</span><span class="o">:</span><span class="w">        </span><span class="mf">1.604</span><span class="w"> </span><span class="n">μs</span><span class="w"> </span><span class="p">(</span><span class="mf">0.00</span><span class="o">%</span><span class="w"> </span><span class="n">GC</span><span class="p">)</span><span class="w"></span>
<a id="rest_code_7e8ff46f24134c66acbfbe956bd15b12-8" name="rest_code_7e8ff46f24134c66acbfbe956bd15b12-8" href="posts/numerical_challenge/numerical-01/#rest_code_7e8ff46f24134c66acbfbe956bd15b12-8"></a><span class="w">  </span><span class="n">maximum</span><span class="w"> </span><span class="n">time</span><span class="o">:</span><span class="w">     </span><span class="mf">38.425</span><span class="w"> </span><span class="n">μs</span><span class="w"> </span><span class="p">(</span><span class="mf">0.00</span><span class="o">%</span><span class="w"> </span><span class="n">GC</span><span class="p">)</span><span class="w"></span>
<a id="rest_code_7e8ff46f24134c66acbfbe956bd15b12-9" name="rest_code_7e8ff46f24134c66acbfbe956bd15b12-9" href="posts/numerical_challenge/numerical-01/#rest_code_7e8ff46f24134c66acbfbe956bd15b12-9"></a><span class="w">  </span><span class="o">--------------</span><span class="w"></span>
<a id="rest_code_7e8ff46f24134c66acbfbe956bd15b12-10" name="rest_code_7e8ff46f24134c66acbfbe956bd15b12-10" href="posts/numerical_challenge/numerical-01/#rest_code_7e8ff46f24134c66acbfbe956bd15b12-10"></a><span class="w">  </span><span class="n">samples</span><span class="o">:</span><span class="w">          </span><span class="mi">10000</span><span class="w"></span>
<a id="rest_code_7e8ff46f24134c66acbfbe956bd15b12-11" name="rest_code_7e8ff46f24134c66acbfbe956bd15b12-11" href="posts/numerical_challenge/numerical-01/#rest_code_7e8ff46f24134c66acbfbe956bd15b12-11"></a><span class="w">  </span><span class="n">evals</span><span class="o">/</span><span class="n">sample</span><span class="o">:</span><span class="w">     </span><span class="mi">10</span><span class="w"></span>
</pre></div>
<p>And it seems that the Julia version is around 100 times faster than
the Python counterpart.</p>
</section></section>
</div>
    </article><article class="post h-entry post-text"><header><h1 class="post-title p-name"><a href="posts/hermite_ritz_qm/" class="u-url">Solution of the Schrödinger equation using Ritz method</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn">Nicolás Guarín-Zapata</span></p>
            <p class="dateline"><a href="posts/hermite_ritz_qm/" rel="bookmark"><time class="post-date published dt-published" datetime="2017-07-11T19:04:57-05:00" title="2017-07-11 19:04">2017-07-11 19:04</time></a></p>
                <p class="commentline">
    
    <a href="posts/hermite_ritz_qm/#disqus_thread" data-disqus-identifier="cache/posts/hermite_ritz_qm.html">Comments</a>


        </p>
</div>
    </header><div class="e-content entry-content">
    <p>In this post, we describe the solution of the Schrödinger equation
using the Ritz method and
<a class="reference external" href="https://en.wikipedia.org/wiki/Hermite_polynomials#Hermite_functions">Hermite functions</a>
basis. This basis seems to be a good choice for the 1D Schrödinger equation
since its an orthogonal basis over <span class="math">\((-\infty, \infty)\)</span>.</p>
<section id="transforming-the-equation-to-an-algebraic-one"><h2>Transforming the equation to an algebraic one</h2>
<p>We want so solve the time-independent
<a class="reference external" href="https://en.wikipedia.org/wiki/Schr%C3%B6dinger_equation">Schrödinger equation</a></p>
<div class="math">
\begin{equation*}
\left[-\frac{1}{2}\nabla^2 + V(x)\right] \psi = E\psi\, ,
\end{equation*}
</div>
<p>where we are using
<a class="reference external" href="https://en.wikipedia.org/wiki/Natural_units">natural units</a>
since they are a good choice for numeric calculations.</p>
<p>Solving this equation is equivalent to solve the following
variational equation</p>
<div class="math">
\begin{equation*}
\delta \Pi[\psi] = 0\, ,
\end{equation*}
</div>
<p>with</p>
<div class="math">
\begin{equation*}
\Pi[\psi] = \frac{1}{2} \langle \nabla \psi, \nabla\psi\rangle +
              \langle \psi, V(x) \psi\rangle -
               E\langle \psi, \psi\rangle \, ,
\end{equation*}
</div>
<p>being <span class="math">\(\psi\)</span> the wave function, <span class="math">\(V(x)\)</span> the potential and
<span class="math">\(E\)</span> the energy. This variational formulation is equivalent to the
time-independent Schrödinger equation, and <span class="math">\(E\)</span> works as a Lagrange
multiplier to enforce that the probability over the whole domain is 1.</p>
<p>We can expand the wave function in an orthonormal basis, namely</p>
<div class="math">
\begin{equation*}
\psi = \sum_{n=0}^N c_n u_n(x)\, ,
\end{equation*}
</div>
<p>where <span class="math">\(u_n(x) \equiv \mu_n H_n(x) e^{-x^2/2}\)</span> is a normalized
Hermite function, <span class="math">\(\mu_n\)</span> is the inverse of magnitude of the
<span class="math">\(n\)</span>-th Hermite polynomial</p>
<div class="math">
\begin{equation*}
\mu_n = \frac{1}{\sqrt{\pi^{1/2} n! 2^n}}\, ,
\end{equation*}
</div>
<p>and <span class="math">\(c_n\)</span> are the coefficients of the expansion. This
representation is exact in the limit <span class="math">\(N \rightarrow \infty\)</span>.</p>
<p>If we replace the expansion in the functional, we obtain</p>
<div class="math">
\begin{equation*}
\Pi_N = \sum_{m=0}^N\sum_{n=0}^N c_m c_n\left[
          \frac{1}{2} \langle \nabla u_m, \nabla u_n\rangle +
          \langle u_m, V(x) u_n\rangle -
          E^N \delta_{mn}\right]\, .
\end{equation*}
</div>
<p>The integrand of the integral involving the two derivatives reads</p>
<div class="math">
\begin{align*}
u_m' u_n' =&amp; \left[2m \frac{\mu_{m-1}}{\mu_m}u_{m-1} - x u_m\right]
            \left[2n \frac{\mu_{n-1}}{\mu_n}u_{n-1} - x u_n\right]\\
          =&amp; 4mn\frac{\mu_{m-1} \mu_{n-1}}{\mu_m \mu_n} u_{n-1} u_{m-1}
           - 2m\frac{\mu_{m-1}}{\mu_{m}}x u_{m-1} u_n\\
           &amp;- 2n\frac{\mu_{n-1}}{\mu_{n}}x u_{n-1} u_m + x^2 u_m u_n
\end{align*}
</div>
<p>Thus, the kinetic energy term reads</p>
<div class="math">
\begin{align*}
\langle \nabla u_m, \nabla u_n \rangle =&amp;
    4mn\frac{\mu_{m-1} \mu_{n-1}}{\mu_m \mu_n} \langle u_{n-1}, u_{m-1}\rangle
    - 2m\frac{\mu_{m-1}}{\mu_{m}} \langle u_{m-1}, x u_n\rangle\\
    &amp;- 2n\frac{\mu_{n-1}}{\mu_{n}} \langle u_{m}, x u_{n - 1}\rangle
     + \langle u_m, x^2 u_n\rangle\\
    =&amp; 4mn \frac{\mu_{m-1}^2}{\mu_m^2}\delta_{mn} -
      2m \frac{\mu_{m-1}}{\mu_m} \alpha_{m-1, n} -
      2n \frac{\mu_{n-1}}{\mu_n} \alpha_{m, n-1} + \beta_{mn} \, ,
\end{align*}
</div>
<p>with</p>
<div class="math">
\begin{equation*}
\alpha_{m,n} \equiv \langle u_{m}, x u_n\rangle = \begin{cases}
\sqrt{\frac{n + 1}{2}} &amp; m=n +1\\
\sqrt{\frac{n}{2}} &amp; m=n - 1\\
0 &amp; \text{otherwise}\end{cases}\, ,
\end{equation*}
</div>
<p>and</p>
<div class="math">
\begin{equation*}
\beta_{m,n} \equiv \langle u_{m}, x^2 u_n\rangle = \begin{cases}
\frac{\sqrt{n(n-1)}}{2} &amp; m = n - 2\\
\frac{2n + 1}{2} &amp; m = n \\
\frac{\sqrt{(n+1)(n+1)}}{2} &amp; m = n + 2 \\
0 &amp; \text{otherwise}\end{cases}\, .
\end{equation*}
</div>
<p>The functional is rewritten as</p>
<div class="math">
\begin{align*}
\Pi_N =&amp; \sum_{m=0}^N \sum_{n=0}^N c_m c_n
  \left[2mn \frac{\mu^2_{m-1}}{\mu^2_m}\delta_{mn}
  - m\frac{\mu_{m-1}}{\mu_m}\alpha_{m - 1, n}
  - n\frac{\mu_{n-1}}{\mu_n}\delta_{m, n-1} \right.\nonumber \\
  &amp;\left. - \frac{1}{2}\beta_{mn} + \langle u_m, V(x) u_n\rangle
  - E^N \delta_{mn}\right] \, .
\end{align*}
</div>
<p>Taking the variation</p>
<div class="math">
\begin{equation*}
\delta \Pi_N = 0\, ,
\end{equation*}
</div>
<p>that in this case is equivalent to</p>
<div class="math">
\begin{equation*}
\frac{\partial \Pi_N}{\partial c_i} = 0\quad \forall i=0, 1, \cdots N\, ,
\end{equation*}
</div>
<p>yields to</p>
<div class="math">
\begin{equation*}
[H]\lbrace c\rbrace = E^N\lbrace c\rbrace \, ,
\end{equation*}
</div>
<p>where the components of the matrix <span class="math">\([H]\)</span> are given by</p>
<div class="math">
\begin{equation*}
H_{mn} = 2mn \frac{\mu^2_{m-1}}{\mu^2_m}\delta_{mn}
  - m\frac{\mu_{m-1}}{\mu_m}\alpha_{m - 1, n}
  - n\frac{\mu_{n-1}}{\mu_n}\delta_{m, n-1}
  - \frac{1}{2}\beta_{mn} + \langle u_m, V(x) u_n\rangle\, .
\end{equation*}
</div>
<p>The last integral can be computed using
<a class="reference external" href="https://en.wikipedia.org/wiki/Gauss%E2%80%93Hermite_quadrature">Gauss-Hermite quadrature</a>.
And we will need more Gauss points if we want to integrate higher-order
polynomials. This method would work fine for functions that can be
approximated by polynomials.</p>
</section><section id="examples"><h2>Examples</h2>
<p>A Python implementation of this method is presented in
<a class="reference external" href="https://github.com/nicoguaro/FEM_resources/blob/master/quantum_mechanics/hermite_QM.py">this repo</a>.</p>
<p>For all the examples we use the following imports</p>
<div class="code"><pre class="code ipython"><a id="rest_code_1f38234458d642eeb242d0bc072086cc-1" name="rest_code_1f38234458d642eeb242d0bc072086cc-1" href="posts/hermite_ritz_qm/#rest_code_1f38234458d642eeb242d0bc072086cc-1"></a><span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">division</span><span class="p">,</span> <span class="n">print_function</span>
<a id="rest_code_1f38234458d642eeb242d0bc072086cc-2" name="rest_code_1f38234458d642eeb242d0bc072086cc-2" href="posts/hermite_ritz_qm/#rest_code_1f38234458d642eeb242d0bc072086cc-2"></a><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<a id="rest_code_1f38234458d642eeb242d0bc072086cc-3" name="rest_code_1f38234458d642eeb242d0bc072086cc-3" href="posts/hermite_ritz_qm/#rest_code_1f38234458d642eeb242d0bc072086cc-3"></a><span class="kn">from</span> <span class="nn">hermite_QM</span> <span class="kn">import</span> <span class="o">*</span>
</pre></div>
<section id="quantum-harmonic-oscilator-1"><h3><a class="reference external" href="https://en.wikipedia.org/wiki/Quantum_harmonic_oscillator">Quantum harmonic oscilator</a></h3>
<p>In this case the (normalized) potential is given by</p>
<div class="math">
\begin{equation*}
V(x) = \frac{1}{2} x^2
\end{equation*}
</div>
<p>and the exact normalized eigenvalues are given by</p>
<div class="math">
\begin{equation*}
E_n = n + \frac{1}{2}
\end{equation*}
</div>
<p>The following snippet computes the first 10 eigenvalues and plot
the corresponding eigenstates</p>
<div class="code"><pre class="code ipython"><a id="rest_code_7f63a1c37b594523ab589c777bfcb7ea-1" name="rest_code_7f63a1c37b594523ab589c777bfcb7ea-1" href="posts/hermite_ritz_qm/#rest_code_7f63a1c37b594523ab589c777bfcb7ea-1"></a><span class="n">potential</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span>
<a id="rest_code_7f63a1c37b594523ab589c777bfcb7ea-2" name="rest_code_7f63a1c37b594523ab589c777bfcb7ea-2" href="posts/hermite_ritz_qm/#rest_code_7f63a1c37b594523ab589c777bfcb7ea-2"></a><span class="n">vals</span><span class="p">,</span> <span class="n">vecs</span> <span class="o">=</span> <span class="n">eigenstates</span><span class="p">(</span><span class="n">potential</span><span class="p">,</span> <span class="n">nterms</span><span class="o">=</span><span class="mi">11</span><span class="p">,</span> <span class="n">ngpts</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<a id="rest_code_7f63a1c37b594523ab589c777bfcb7ea-3" name="rest_code_7f63a1c37b594523ab589c777bfcb7ea-3" href="posts/hermite_ritz_qm/#rest_code_7f63a1c37b594523ab589c777bfcb7ea-3"></a><span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">vals</span><span class="p">[:</span><span class="mi">10</span><span class="p">],</span> <span class="mi">6</span><span class="p">))</span>
<a id="rest_code_7f63a1c37b594523ab589c777bfcb7ea-4" name="rest_code_7f63a1c37b594523ab589c777bfcb7ea-4" href="posts/hermite_ritz_qm/#rest_code_7f63a1c37b594523ab589c777bfcb7ea-4"></a><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<a id="rest_code_7f63a1c37b594523ab589c777bfcb7ea-5" name="rest_code_7f63a1c37b594523ab589c777bfcb7ea-5" href="posts/hermite_ritz_qm/#rest_code_7f63a1c37b594523ab589c777bfcb7ea-5"></a><span class="n">plot_eigenstates</span><span class="p">(</span><span class="n">vals</span><span class="p">,</span> <span class="n">vecs</span><span class="p">,</span> <span class="n">potential</span><span class="p">);</span>
</pre></div>
<p>with results</p>
<div class="code"><pre class="code text"><a id="rest_code_cb7cbb75185a4090ad3c8732c40bed83-1" name="rest_code_cb7cbb75185a4090ad3c8732c40bed83-1" href="posts/hermite_ritz_qm/#rest_code_cb7cbb75185a4090ad3c8732c40bed83-1"></a>[ 0.5  1.5  2.5  3.5  4.5  5.5  6.5  7.5  8.5  9.5]
</pre></div>
<img alt="/images/hermite_ritz_harmonic.svg" src="images/hermite_ritz_harmonic.svg"></section><section id="absolute-value-potential"><h3>Absolute value potential</h3>
<div class="code"><pre class="code ipython"><a id="rest_code_089ca2c0d7334222bb493c6a9938c9c7-1" name="rest_code_089ca2c0d7334222bb493c6a9938c9c7-1" href="posts/hermite_ritz_qm/#rest_code_089ca2c0d7334222bb493c6a9938c9c7-1"></a><span class="n">potential</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a id="rest_code_089ca2c0d7334222bb493c6a9938c9c7-2" name="rest_code_089ca2c0d7334222bb493c6a9938c9c7-2" href="posts/hermite_ritz_qm/#rest_code_089ca2c0d7334222bb493c6a9938c9c7-2"></a><span class="n">vals</span><span class="p">,</span> <span class="n">vecs</span> <span class="o">=</span> <span class="n">eigenstates</span><span class="p">(</span><span class="n">potential</span><span class="p">)</span>
<a id="rest_code_089ca2c0d7334222bb493c6a9938c9c7-3" name="rest_code_089ca2c0d7334222bb493c6a9938c9c7-3" href="posts/hermite_ritz_qm/#rest_code_089ca2c0d7334222bb493c6a9938c9c7-3"></a><span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">vals</span><span class="p">[:</span><span class="mi">10</span><span class="p">],</span> <span class="mi">6</span><span class="p">))</span>
<a id="rest_code_089ca2c0d7334222bb493c6a9938c9c7-4" name="rest_code_089ca2c0d7334222bb493c6a9938c9c7-4" href="posts/hermite_ritz_qm/#rest_code_089ca2c0d7334222bb493c6a9938c9c7-4"></a><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<a id="rest_code_089ca2c0d7334222bb493c6a9938c9c7-5" name="rest_code_089ca2c0d7334222bb493c6a9938c9c7-5" href="posts/hermite_ritz_qm/#rest_code_089ca2c0d7334222bb493c6a9938c9c7-5"></a><span class="n">plot_eigenstates</span><span class="p">(</span><span class="n">vals</span><span class="p">,</span> <span class="n">vecs</span><span class="p">,</span> <span class="n">potential</span><span class="p">,</span> <span class="n">lims</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">));</span>
</pre></div>
<p>with results</p>
<div class="code"><pre class="code text"><a id="rest_code_3355e1a5ea424deebb2d33958a9f96fa-1" name="rest_code_3355e1a5ea424deebb2d33958a9f96fa-1" href="posts/hermite_ritz_qm/#rest_code_3355e1a5ea424deebb2d33958a9f96fa-1"></a>[ 0.811203  1.855725  2.57894   3.244576  3.826353  4.38189   4.895365
<a id="rest_code_3355e1a5ea424deebb2d33958a9f96fa-2" name="rest_code_3355e1a5ea424deebb2d33958a9f96fa-2" href="posts/hermite_ritz_qm/#rest_code_3355e1a5ea424deebb2d33958a9f96fa-2"></a>  5.396614  5.911591  6.421015]
</pre></div>
<img alt="/images/hermite_ritz_abs.svg" src="images/hermite_ritz_abs.svg"></section><section id="cubic-potential"><h3>Cubic potential</h3>
<div class="code"><pre class="code ipython"><a id="rest_code_74019b22c7f64e59a6820850547f92e4-1" name="rest_code_74019b22c7f64e59a6820850547f92e4-1" href="posts/hermite_ritz_qm/#rest_code_74019b22c7f64e59a6820850547f92e4-1"></a><span class="n">potential</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">x</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span><span class="o">**</span><span class="mi">3</span>
<a id="rest_code_74019b22c7f64e59a6820850547f92e4-2" name="rest_code_74019b22c7f64e59a6820850547f92e4-2" href="posts/hermite_ritz_qm/#rest_code_74019b22c7f64e59a6820850547f92e4-2"></a><span class="n">vals</span><span class="p">,</span> <span class="n">vecs</span> <span class="o">=</span> <span class="n">eigenstates</span><span class="p">(</span><span class="n">potential</span><span class="p">)</span>
<a id="rest_code_74019b22c7f64e59a6820850547f92e4-3" name="rest_code_74019b22c7f64e59a6820850547f92e4-3" href="posts/hermite_ritz_qm/#rest_code_74019b22c7f64e59a6820850547f92e4-3"></a><span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">vals</span><span class="p">[:</span><span class="mi">10</span><span class="p">],</span> <span class="mi">6</span><span class="p">))</span>
<a id="rest_code_74019b22c7f64e59a6820850547f92e4-4" name="rest_code_74019b22c7f64e59a6820850547f92e4-4" href="posts/hermite_ritz_qm/#rest_code_74019b22c7f64e59a6820850547f92e4-4"></a><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<a id="rest_code_74019b22c7f64e59a6820850547f92e4-5" name="rest_code_74019b22c7f64e59a6820850547f92e4-5" href="posts/hermite_ritz_qm/#rest_code_74019b22c7f64e59a6820850547f92e4-5"></a><span class="n">plot_eigenstates</span><span class="p">(</span><span class="n">vals</span><span class="p">,</span> <span class="n">vecs</span><span class="p">,</span> <span class="n">potential</span><span class="p">,</span> <span class="n">lims</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">));</span>
</pre></div>
<p>with results</p>
<div class="code"><pre class="code text"><a id="rest_code_7908c7b6a9f14262bfca83a750db3588-1" name="rest_code_7908c7b6a9f14262bfca83a750db3588-1" href="posts/hermite_ritz_qm/#rest_code_7908c7b6a9f14262bfca83a750db3588-1"></a>[ 0.180588  0.609153  1.124594  1.681002  2.272087  2.889805  3.530901
<a id="rest_code_7908c7b6a9f14262bfca83a750db3588-2" name="rest_code_7908c7b6a9f14262bfca83a750db3588-2" href="posts/hermite_ritz_qm/#rest_code_7908c7b6a9f14262bfca83a750db3588-2"></a>  4.191962  4.871133  5.566413]
</pre></div>
<img alt="/images/hermite_ritz_cubic.svg" src="images/hermite_ritz_cubic.svg"></section><section id="harmonic-with-quartic-perturbation"><h3>Harmonic with quartic perturbation</h3>
<div class="code"><pre class="code ipython"><a id="rest_code_65611d0f0f1e4037a0559b6c3b44f775-1" name="rest_code_65611d0f0f1e4037a0559b6c3b44f775-1" href="posts/hermite_ritz_qm/#rest_code_65611d0f0f1e4037a0559b6c3b44f775-1"></a><span class="n">potential</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mf">0.1</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">4</span>
<a id="rest_code_65611d0f0f1e4037a0559b6c3b44f775-2" name="rest_code_65611d0f0f1e4037a0559b6c3b44f775-2" href="posts/hermite_ritz_qm/#rest_code_65611d0f0f1e4037a0559b6c3b44f775-2"></a><span class="n">vals</span><span class="p">,</span> <span class="n">vecs</span> <span class="o">=</span> <span class="n">eigenstates</span><span class="p">(</span><span class="n">potential</span><span class="p">,</span> <span class="n">nterms</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">ngpts</span><span class="o">=</span><span class="mi">22</span><span class="p">)</span>
<a id="rest_code_65611d0f0f1e4037a0559b6c3b44f775-3" name="rest_code_65611d0f0f1e4037a0559b6c3b44f775-3" href="posts/hermite_ritz_qm/#rest_code_65611d0f0f1e4037a0559b6c3b44f775-3"></a><span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">vals</span><span class="p">[:</span><span class="mi">10</span><span class="p">],</span> <span class="mi">6</span><span class="p">))</span>
<a id="rest_code_65611d0f0f1e4037a0559b6c3b44f775-4" name="rest_code_65611d0f0f1e4037a0559b6c3b44f775-4" href="posts/hermite_ritz_qm/#rest_code_65611d0f0f1e4037a0559b6c3b44f775-4"></a><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<a id="rest_code_65611d0f0f1e4037a0559b6c3b44f775-5" name="rest_code_65611d0f0f1e4037a0559b6c3b44f775-5" href="posts/hermite_ritz_qm/#rest_code_65611d0f0f1e4037a0559b6c3b44f775-5"></a><span class="n">plot_eigenstates</span><span class="p">(</span><span class="n">vals</span><span class="p">,</span> <span class="n">vecs</span><span class="p">,</span> <span class="n">potential</span><span class="p">,</span> <span class="n">lims</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
</pre></div>
<p>with results</p>
<div class="code"><pre class="code text"><a id="rest_code_d5b629af9f7c444eb7c88ab9cf1bd567-1" name="rest_code_d5b629af9f7c444eb7c88ab9cf1bd567-1" href="posts/hermite_ritz_qm/#rest_code_d5b629af9f7c444eb7c88ab9cf1bd567-1"></a>[  0.559146   1.769503   3.138624   4.628884   6.220303   7.899789
<a id="rest_code_d5b629af9f7c444eb7c88ab9cf1bd567-2" name="rest_code_d5b629af9f7c444eb7c88ab9cf1bd567-2" href="posts/hermite_ritz_qm/#rest_code_d5b629af9f7c444eb7c88ab9cf1bd567-2"></a>   9.658703  11.489094  13.38638   15.361055]
</pre></div>
<img alt="/images/hermite_ritz_pert_harm.svg" src="images/hermite_ritz_pert_harm.svg"><p>A Jupyter Notebook with the examples can be found
<a class="reference external" href="https://github.com/nicoguaro/FEM_resources/blob/master/quantum_mechanics/Ritz_Hermite_QM.ipynb">here</a>.</p>
</section></section>
</div>
    </article><article class="post h-entry post-text"><header><h1 class="post-title p-name"><a href="posts/matplotlib_styles/" class="u-url">Using style sheets with matplotlib</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn">Nicolás Guarín-Zapata</span></p>
            <p class="dateline"><a href="posts/matplotlib_styles/" rel="bookmark"><time class="post-date published dt-published" datetime="2017-06-27T17:14:14-05:00" title="2017-06-27 17:14">2017-06-27 17:14</time></a></p>
                <p class="commentline">
    
    <a href="posts/matplotlib_styles/#disqus_thread" data-disqus-identifier="cache/posts/matplotlib_styles.html">Comments</a>


        </p>
</div>
    </header><div class="e-content entry-content">
    <p>We can format plots easily using the <a class="reference external" href="http://matplotlib.org/users/customizing.html">style package</a>
in matplotlib all. The main idea is to create a file with some of the
parameters that want to be defined (that can also be accessed through
<cite>rcParams</cite>).</p>
<p>This post is not a tutorial on how to use those, for that you can check
the <a class="reference external" href="http://matplotlib.org/examples/style_sheets/style_sheets_reference.html">style sheet reference</a>.
Here, I just want to play with some of these parameters to create three
different styles. The first two examples present the style of an (infamous by
some) software, that is probably used for most people as their visualization
platform, while the third one is just a clean style. All the files used here
can be download
<a class="reference external" href="https://github.com/nicoguaro/matplotlib_styles">here</a>.</p>
<p>For all the examples below the following imports are done:</p>
<pre class="code ipython3"><a name="rest_code_d4c1f3df11f64c7ca8ae3ab904dd8f5a-1"></a><span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">division</span><span class="p">,</span> <span class="n">print_function</span>
<a name="rest_code_d4c1f3df11f64c7ca8ae3ab904dd8f5a-2"></a><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<a name="rest_code_d4c1f3df11f64c7ca8ae3ab904dd8f5a-3"></a><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</pre>
<div class="section" id="first-example-ms-2003">
<h2>First example: MS 2003</h2>
<p>In our first example we want to reproduce the style that we used to see
more than a decade ago as default.</p>
<p>The following is the content of the file <a class="reference external" href="https://github.com/nicoguaro/matplotlib_styles/blob/master/styles/MS2003.mplstyle">MS2003.mplstyle</a></p>
<pre class="code python"><a name="rest_code_9765cc47b22d4507af940e93e41ffac8-1"></a><span class="n">font</span><span class="o">.</span><span class="n">family</span> <span class="p">:</span> <span class="n">sans</span><span class="o">-</span><span class="n">serif</span>
<a name="rest_code_9765cc47b22d4507af940e93e41ffac8-2"></a>
<a name="rest_code_9765cc47b22d4507af940e93e41ffac8-3"></a><span class="n">axes</span><span class="o">.</span><span class="n">facecolor</span> <span class="p">:</span> <span class="n">c0c0c0</span>
<a name="rest_code_9765cc47b22d4507af940e93e41ffac8-4"></a><span class="n">axes</span><span class="o">.</span><span class="n">edgecolor</span> <span class="p">:</span> <span class="n">black</span>
<a name="rest_code_9765cc47b22d4507af940e93e41ffac8-5"></a><span class="n">axes</span><span class="o">.</span><span class="n">prop_cycle</span> <span class="p">:</span> <span class="n">cycler</span><span class="p">(</span><span class="s1">'color'</span><span class="p">,[</span><span class="s1">'000080'</span><span class="p">,</span> <span class="s1">'FF00FF'</span><span class="p">,</span> <span class="s1">'FFFF00'</span><span class="p">,</span> <span class="s1">'00FFFF'</span><span class="p">,</span><span class="s1">'800080'</span><span class="p">,</span> <span class="s1">'800000'</span><span class="p">,</span> <span class="s1">'008080'</span><span class="p">,</span> <span class="s1">'0000FF'</span><span class="p">])</span>
<a name="rest_code_9765cc47b22d4507af940e93e41ffac8-6"></a><span class="n">axes</span><span class="o">.</span><span class="n">grid</span> <span class="p">:</span> <span class="kc">True</span>
<a name="rest_code_9765cc47b22d4507af940e93e41ffac8-7"></a>
<a name="rest_code_9765cc47b22d4507af940e93e41ffac8-8"></a><span class="n">axes</span><span class="o">.</span><span class="n">spines</span><span class="o">.</span><span class="n">left</span>   <span class="p">:</span> <span class="kc">True</span>
<a name="rest_code_9765cc47b22d4507af940e93e41ffac8-9"></a><span class="n">axes</span><span class="o">.</span><span class="n">spines</span><span class="o">.</span><span class="n">bottom</span> <span class="p">:</span> <span class="kc">True</span>
<a name="rest_code_9765cc47b22d4507af940e93e41ffac8-10"></a><span class="n">axes</span><span class="o">.</span><span class="n">spines</span><span class="o">.</span><span class="n">top</span>    <span class="p">:</span> <span class="kc">True</span>
<a name="rest_code_9765cc47b22d4507af940e93e41ffac8-11"></a><span class="n">axes</span><span class="o">.</span><span class="n">spines</span><span class="o">.</span><span class="n">right</span>  <span class="p">:</span> <span class="kc">True</span>
<a name="rest_code_9765cc47b22d4507af940e93e41ffac8-12"></a>
<a name="rest_code_9765cc47b22d4507af940e93e41ffac8-13"></a><span class="n">grid</span><span class="o">.</span><span class="n">color</span> <span class="p">:</span> <span class="n">black</span>
<a name="rest_code_9765cc47b22d4507af940e93e41ffac8-14"></a><span class="n">grid</span><span class="o">.</span><span class="n">linestyle</span> <span class="p">:</span> <span class="o">-</span>
<a name="rest_code_9765cc47b22d4507af940e93e41ffac8-15"></a>
<a name="rest_code_9765cc47b22d4507af940e93e41ffac8-16"></a><span class="n">lines</span><span class="o">.</span><span class="n">linewidth</span> <span class="p">:</span> <span class="mi">1</span>
<a name="rest_code_9765cc47b22d4507af940e93e41ffac8-17"></a>
<a name="rest_code_9765cc47b22d4507af940e93e41ffac8-18"></a><span class="n">figure</span><span class="o">.</span><span class="n">figsize</span> <span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">3</span>
<a name="rest_code_9765cc47b22d4507af940e93e41ffac8-19"></a>
<a name="rest_code_9765cc47b22d4507af940e93e41ffac8-20"></a><span class="n">legend</span><span class="o">.</span><span class="n">fancybox</span> <span class="p">:</span> <span class="kc">False</span>
<a name="rest_code_9765cc47b22d4507af940e93e41ffac8-21"></a><span class="n">legend</span><span class="o">.</span><span class="n">frameon</span> <span class="p">:</span> <span class="kc">True</span>
<a name="rest_code_9765cc47b22d4507af940e93e41ffac8-22"></a><span class="n">legend</span><span class="o">.</span><span class="n">facecolor</span> <span class="p">:</span> <span class="n">white</span>
<a name="rest_code_9765cc47b22d4507af940e93e41ffac8-23"></a><span class="n">legend</span><span class="o">.</span><span class="n">edgecolor</span> <span class="p">:</span> <span class="n">black</span>
<a name="rest_code_9765cc47b22d4507af940e93e41ffac8-24"></a><span class="n">legend</span><span class="o">.</span><span class="n">loc</span> <span class="p">:</span> <span class="n">center</span> <span class="n">left</span>
</pre>
<p>The following code use this style</p>
<pre class="code ipython3"><a name="rest_code_5460782538e048dcb9d14a15364748f1-1"></a><span class="n">style</span> <span class="o">=</span> <span class="s2">"MS2003.mplstyle"</span>
<a name="rest_code_5460782538e048dcb9d14a15364748f1-2"></a><span class="k">with</span> <span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">context</span><span class="p">(</span><span class="n">style</span><span class="p">):</span>
<a name="rest_code_5460782538e048dcb9d14a15364748f1-3"></a>    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<a name="rest_code_5460782538e048dcb9d14a15364748f1-4"></a>    <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mf">1e-6</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mf">1e-6</span><span class="p">)</span>
<a name="rest_code_5460782538e048dcb9d14a15364748f1-5"></a>    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<a name="rest_code_5460782538e048dcb9d14a15364748f1-6"></a>    <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>
<a name="rest_code_5460782538e048dcb9d14a15364748f1-7"></a>    <span class="k">for</span> <span class="n">cont</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>
<a name="rest_code_5460782538e048dcb9d14a15364748f1-8"></a>        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="o">/</span><span class="p">(</span><span class="n">cont</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="n">cont</span><span class="p">)</span>
<a name="rest_code_5460782538e048dcb9d14a15364748f1-9"></a>
<a name="rest_code_5460782538e048dcb9d14a15364748f1-10"></a>    <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
<a name="rest_code_5460782538e048dcb9d14a15364748f1-11"></a>    <span class="n">box</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_position</span><span class="p">()</span>
<a name="rest_code_5460782538e048dcb9d14a15364748f1-12"></a>    <span class="n">ax</span><span class="o">.</span><span class="n">set_position</span><span class="p">([</span><span class="n">box</span><span class="o">.</span><span class="n">x0</span><span class="p">,</span> <span class="n">box</span><span class="o">.</span><span class="n">y0</span><span class="p">,</span> <span class="n">box</span><span class="o">.</span><span class="n">width</span> <span class="o">*</span> <span class="mf">0.8</span><span class="p">,</span> <span class="n">box</span><span class="o">.</span><span class="n">height</span><span class="p">])</span>
<a name="rest_code_5460782538e048dcb9d14a15364748f1-13"></a>    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">))</span>
</pre>
<p>and this is the result</p>
<img alt="/images/MS2003_style.svg" src="images/MS2003_style.svg">
</div>
<div class="section" id="second-example-ms-2007">
<h2>Second example: MS 2007</h2>
<p>In the second example we want to reproduce the offspring of the style
in the first example. This is definitely an improvement over the previous
style, but it is <a class="reference external" href="http://analyticsdemystified.com/excel-tips/data-visualization-that-is-color-blind-friendly-excel-2007/">not perfect</a>.</p>
<p>The following is the content of the file <a class="reference external" href="https://github.com/nicoguaro/matplotlib_styles/blob/master/styles/MS2007.mplstyle">MS2007.mplstyle</a></p>
<pre class="code python"><a name="rest_code_efff16b3395e4455941cd571405994e6-1"></a><span class="n">font</span><span class="o">.</span><span class="n">family</span> <span class="p">:</span> <span class="n">sans</span><span class="o">-</span><span class="n">serif</span>
<a name="rest_code_efff16b3395e4455941cd571405994e6-2"></a>
<a name="rest_code_efff16b3395e4455941cd571405994e6-3"></a><span class="n">axes</span><span class="o">.</span><span class="n">facecolor</span> <span class="p">:</span> <span class="n">white</span>
<a name="rest_code_efff16b3395e4455941cd571405994e6-4"></a><span class="n">axes</span><span class="o">.</span><span class="n">edgecolor</span> <span class="p">:</span> <span class="mi">4</span><span class="n">d4d4d</span>
<a name="rest_code_efff16b3395e4455941cd571405994e6-5"></a><span class="n">axes</span><span class="o">.</span><span class="n">prop_cycle</span> <span class="p">:</span> <span class="n">cycler</span><span class="p">(</span><span class="s1">'color'</span><span class="p">,[</span><span class="s1">'4573a7'</span><span class="p">,</span> <span class="s1">'aa4644'</span><span class="p">,</span> <span class="s1">'89a54e'</span><span class="p">,</span> <span class="s1">'71588f'</span><span class="p">,</span><span class="s1">'4298af'</span><span class="p">,</span> <span class="s1">'db843d'</span><span class="p">,</span> <span class="s1">'93a9d0'</span><span class="p">,</span> <span class="s1">'d09392'</span><span class="p">])</span>
<a name="rest_code_efff16b3395e4455941cd571405994e6-6"></a><span class="n">axes</span><span class="o">.</span><span class="n">grid</span> <span class="p">:</span> <span class="kc">True</span>
<a name="rest_code_efff16b3395e4455941cd571405994e6-7"></a><span class="n">axes</span><span class="o">.</span><span class="n">linewidth</span> <span class="p">:</span> <span class="mf">0.5</span>
<a name="rest_code_efff16b3395e4455941cd571405994e6-8"></a>
<a name="rest_code_efff16b3395e4455941cd571405994e6-9"></a><span class="n">axes</span><span class="o">.</span><span class="n">spines</span><span class="o">.</span><span class="n">left</span>   <span class="p">:</span> <span class="kc">True</span>
<a name="rest_code_efff16b3395e4455941cd571405994e6-10"></a><span class="n">axes</span><span class="o">.</span><span class="n">spines</span><span class="o">.</span><span class="n">bottom</span> <span class="p">:</span> <span class="kc">True</span>
<a name="rest_code_efff16b3395e4455941cd571405994e6-11"></a><span class="n">axes</span><span class="o">.</span><span class="n">spines</span><span class="o">.</span><span class="n">top</span>    <span class="p">:</span> <span class="kc">False</span>
<a name="rest_code_efff16b3395e4455941cd571405994e6-12"></a><span class="n">axes</span><span class="o">.</span><span class="n">spines</span><span class="o">.</span><span class="n">right</span>  <span class="p">:</span> <span class="kc">False</span>
<a name="rest_code_efff16b3395e4455941cd571405994e6-13"></a>
<a name="rest_code_efff16b3395e4455941cd571405994e6-14"></a><span class="n">lines</span><span class="o">.</span><span class="n">linewidth</span> <span class="p">:</span> <span class="mi">2</span>
<a name="rest_code_efff16b3395e4455941cd571405994e6-15"></a>
<a name="rest_code_efff16b3395e4455941cd571405994e6-16"></a><span class="n">grid</span><span class="o">.</span><span class="n">color</span> <span class="p">:</span> <span class="mi">4</span><span class="n">d4d4d</span>
<a name="rest_code_efff16b3395e4455941cd571405994e6-17"></a><span class="n">grid</span><span class="o">.</span><span class="n">linestyle</span> <span class="p">:</span> <span class="o">-</span>
<a name="rest_code_efff16b3395e4455941cd571405994e6-18"></a><span class="n">grid</span><span class="o">.</span><span class="n">linewidth</span> <span class="p">:</span> <span class="mf">0.5</span>
<a name="rest_code_efff16b3395e4455941cd571405994e6-19"></a>
<a name="rest_code_efff16b3395e4455941cd571405994e6-20"></a><span class="n">figure</span><span class="o">.</span><span class="n">figsize</span> <span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">3</span>
<a name="rest_code_efff16b3395e4455941cd571405994e6-21"></a>
<a name="rest_code_efff16b3395e4455941cd571405994e6-22"></a><span class="n">legend</span><span class="o">.</span><span class="n">fancybox</span> <span class="p">:</span> <span class="kc">False</span>
<a name="rest_code_efff16b3395e4455941cd571405994e6-23"></a><span class="n">legend</span><span class="o">.</span><span class="n">frameon</span> <span class="p">:</span> <span class="kc">False</span>
<a name="rest_code_efff16b3395e4455941cd571405994e6-24"></a><span class="n">legend</span><span class="o">.</span><span class="n">facecolor</span> <span class="p">:</span> <span class="n">white</span>
<a name="rest_code_efff16b3395e4455941cd571405994e6-25"></a><span class="n">legend</span><span class="o">.</span><span class="n">edgecolor</span> <span class="p">:</span> <span class="mi">4</span><span class="n">d4d4d</span>
<a name="rest_code_efff16b3395e4455941cd571405994e6-26"></a><span class="n">legend</span><span class="o">.</span><span class="n">loc</span> <span class="p">:</span> <span class="n">center</span> <span class="n">left</span>
</pre>
<p>The following code use this style</p>
<pre class="code ipython3"><a name="rest_code_c162e547cb1f4e15b755b11495599163-1"></a><span class="n">style</span> <span class="o">=</span> <span class="s2">"MS2007.mplstyle"</span>
<a name="rest_code_c162e547cb1f4e15b755b11495599163-2"></a><span class="k">with</span> <span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">context</span><span class="p">(</span><span class="n">style</span><span class="p">):</span>
<a name="rest_code_c162e547cb1f4e15b755b11495599163-3"></a>    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<a name="rest_code_c162e547cb1f4e15b755b11495599163-4"></a>    <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mf">1e-6</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mf">1e-6</span><span class="p">)</span>
<a name="rest_code_c162e547cb1f4e15b755b11495599163-5"></a>    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<a name="rest_code_c162e547cb1f4e15b755b11495599163-6"></a>    <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>
<a name="rest_code_c162e547cb1f4e15b755b11495599163-7"></a>    <span class="k">for</span> <span class="n">cont</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>
<a name="rest_code_c162e547cb1f4e15b755b11495599163-8"></a>        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="o">/</span><span class="p">(</span><span class="n">cont</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="n">cont</span><span class="p">)</span>
<a name="rest_code_c162e547cb1f4e15b755b11495599163-9"></a>
<a name="rest_code_c162e547cb1f4e15b755b11495599163-10"></a>    <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
<a name="rest_code_c162e547cb1f4e15b755b11495599163-11"></a>    <span class="n">box</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_position</span><span class="p">()</span>
<a name="rest_code_c162e547cb1f4e15b755b11495599163-12"></a>    <span class="n">ax</span><span class="o">.</span><span class="n">set_position</span><span class="p">([</span><span class="n">box</span><span class="o">.</span><span class="n">x0</span><span class="p">,</span> <span class="n">box</span><span class="o">.</span><span class="n">y0</span><span class="p">,</span> <span class="n">box</span><span class="o">.</span><span class="n">width</span> <span class="o">*</span> <span class="mf">0.8</span><span class="p">,</span> <span class="n">box</span><span class="o">.</span><span class="n">height</span><span class="p">])</span>
<a name="rest_code_c162e547cb1f4e15b755b11495599163-13"></a>    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">))</span>
</pre>
<p>and this is the result</p>
<img alt="/images/MS2007_style.svg" src="images/MS2007_style.svg">
</div>
<div class="section" id="third-example-a-clean-style">
<h2>Third example: a clean style</h2>
<p>The last example is a clean style that uses a color palette taken
from <a class="reference external" href="http://colorbrewer2.org/#type=qualitative&amp;scheme=Set1&amp;n=8">ColorBrewer</a>.</p>
<p>The following is the content of the file <a class="reference external" href="https://github.com/nicoguaro/matplotlib_styles/blob/master/styles/clean.mplstyle">clean_style.mplstyle</a></p>
<pre class="code python"><a name="rest_code_1aef1a55a5cd4ffda4b4d81ed83c0c78-1"></a><span class="n">font</span><span class="o">.</span><span class="n">family</span> <span class="p">:</span> <span class="n">sans</span><span class="o">-</span><span class="n">serif</span>
<a name="rest_code_1aef1a55a5cd4ffda4b4d81ed83c0c78-2"></a>
<a name="rest_code_1aef1a55a5cd4ffda4b4d81ed83c0c78-3"></a><span class="n">axes</span><span class="o">.</span><span class="n">facecolor</span> <span class="p">:</span> <span class="n">white</span>
<a name="rest_code_1aef1a55a5cd4ffda4b4d81ed83c0c78-4"></a><span class="n">axes</span><span class="o">.</span><span class="n">prop_cycle</span> <span class="p">:</span> <span class="n">cycler</span><span class="p">(</span><span class="s1">'color'</span><span class="p">,[</span><span class="s1">'e41a1c'</span><span class="p">,</span> <span class="s1">'377eb8'</span><span class="p">,</span> <span class="s1">'4daf4a'</span><span class="p">,</span> <span class="s1">'984ea3'</span><span class="p">,</span> <span class="s1">'ff7f00'</span><span class="p">,</span> <span class="s1">'ffff33'</span><span class="p">,</span> <span class="s1">'a65628'</span><span class="p">,</span> <span class="s1">'f781bf'</span><span class="p">])</span>
<a name="rest_code_1aef1a55a5cd4ffda4b4d81ed83c0c78-5"></a><span class="n">axes</span><span class="o">.</span><span class="n">linewidth</span> <span class="p">:</span> <span class="mf">0.0</span>
<a name="rest_code_1aef1a55a5cd4ffda4b4d81ed83c0c78-6"></a><span class="n">axes</span><span class="o">.</span><span class="n">grid</span> <span class="p">:</span> <span class="kc">True</span>
<a name="rest_code_1aef1a55a5cd4ffda4b4d81ed83c0c78-7"></a>
<a name="rest_code_1aef1a55a5cd4ffda4b4d81ed83c0c78-8"></a><span class="n">lines</span><span class="o">.</span><span class="n">linewidth</span> <span class="p">:</span> <span class="mf">1.5</span>
<a name="rest_code_1aef1a55a5cd4ffda4b4d81ed83c0c78-9"></a>
<a name="rest_code_1aef1a55a5cd4ffda4b4d81ed83c0c78-10"></a><span class="n">xtick</span><span class="o">.</span><span class="n">direction</span> <span class="p">:</span> <span class="ow">in</span>
<a name="rest_code_1aef1a55a5cd4ffda4b4d81ed83c0c78-11"></a><span class="n">ytick</span><span class="o">.</span><span class="n">direction</span> <span class="p">:</span> <span class="ow">in</span>
<a name="rest_code_1aef1a55a5cd4ffda4b4d81ed83c0c78-12"></a>
<a name="rest_code_1aef1a55a5cd4ffda4b4d81ed83c0c78-13"></a><span class="n">grid</span><span class="o">.</span><span class="n">color</span> <span class="p">:</span> <span class="n">c7dedf</span>
<a name="rest_code_1aef1a55a5cd4ffda4b4d81ed83c0c78-14"></a><span class="n">grid</span><span class="o">.</span><span class="n">linestyle</span> <span class="p">:</span> <span class="o">-</span>
<a name="rest_code_1aef1a55a5cd4ffda4b4d81ed83c0c78-15"></a><span class="n">grid</span><span class="o">.</span><span class="n">linewidth</span> <span class="p">:</span> <span class="mf">0.3</span>
<a name="rest_code_1aef1a55a5cd4ffda4b4d81ed83c0c78-16"></a>
<a name="rest_code_1aef1a55a5cd4ffda4b4d81ed83c0c78-17"></a><span class="n">figure</span><span class="o">.</span><span class="n">figsize</span> <span class="p">:</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">4</span>
<a name="rest_code_1aef1a55a5cd4ffda4b4d81ed83c0c78-18"></a>
<a name="rest_code_1aef1a55a5cd4ffda4b4d81ed83c0c78-19"></a><span class="n">legend</span><span class="o">.</span><span class="n">fancybox</span> <span class="p">:</span> <span class="kc">False</span>
<a name="rest_code_1aef1a55a5cd4ffda4b4d81ed83c0c78-20"></a><span class="n">legend</span><span class="o">.</span><span class="n">frameon</span> <span class="p">:</span> <span class="kc">False</span>
<a name="rest_code_1aef1a55a5cd4ffda4b4d81ed83c0c78-21"></a><span class="n">legend</span><span class="o">.</span><span class="n">loc</span> <span class="p">:</span> <span class="n">best</span>
</pre>
<p>The following code use this style</p>
<pre class="code ipython3"><a name="rest_code_4f478d33b1684efcbe94b77c40f4b3bd-1"></a><span class="n">style</span> <span class="o">=</span> <span class="s2">"clean.mplstyle"</span>
<a name="rest_code_4f478d33b1684efcbe94b77c40f4b3bd-2"></a><span class="k">with</span> <span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">context</span><span class="p">(</span><span class="n">style</span><span class="p">):</span>
<a name="rest_code_4f478d33b1684efcbe94b77c40f4b3bd-3"></a>    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<a name="rest_code_4f478d33b1684efcbe94b77c40f4b3bd-4"></a>    <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mf">1e-6</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mf">1e-6</span><span class="p">)</span>
<a name="rest_code_4f478d33b1684efcbe94b77c40f4b3bd-5"></a>    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<a name="rest_code_4f478d33b1684efcbe94b77c40f4b3bd-6"></a>    <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>
<a name="rest_code_4f478d33b1684efcbe94b77c40f4b3bd-7"></a>    <span class="k">for</span> <span class="n">cont</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>
<a name="rest_code_4f478d33b1684efcbe94b77c40f4b3bd-8"></a>        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="o">/</span><span class="p">(</span><span class="n">cont</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="n">cont</span><span class="p">)</span>
<a name="rest_code_4f478d33b1684efcbe94b77c40f4b3bd-9"></a>
<a name="rest_code_4f478d33b1684efcbe94b77c40f4b3bd-10"></a>    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</pre>
<p>and this is the result</p>
<img alt="/images/clean_style.svg" src="images/clean_style.svg"><p>We can also use files that are stored remotely. For example, in the third
example we could have used the following URL:</p>
<pre class="code python"><a name="rest_code_1e50aa70c6704058a5b2dcdbe6fde774-1"></a><span class="n">style</span> <span class="o">=</span> <span class="s2">"https://raw.githubusercontent.com/nicoguaro/matplotlib_styles/master/styles/clean.mplstyle"</span>
</pre>
</div>
<div class="section" id="resources">
<h2>Resources</h2>
<p>As I mentioned above, the objective of this post was jut to create some
simple-enough style-sheets for matplotlib and see them in action.</p>
<p>This post does not pretend to be a guide for good plots/visualization.
For that matter you better look for some references, for example:</p>
<ul class="simple">
<li><p>Rougier, Nicolas P., Michael Droettboom, and Philip E. Bourne.
<a class="reference external" href="http://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1003833">"Ten simple rules for better figures."</a>
PLoS computational biology 10.9 (2014): e1003833.</p></li>
</ul>
<p>Also, I found really useful the following tools:</p>
<ul class="simple">
<li><p><a class="reference external" href="http://colorbrewer2.org">ColorBrewer2</a> allows to pick colormaps
with different criteria (quantitative/qualitative, printer friendly,
colorblind friendly).</p></li>
<li><p><a class="reference external" href="http://colrd.com">ColRD</a> has plenty of color palettes. It also has the
option to generate palettes from images.</p></li>
<li><p><a class="reference external" href="http://vrl.cs.brown.edu/color">Colorgorical</a> is a tool to
make categorical color palettes for information visualization.</p></li>
</ul>
<p>You can find the snippets present in this post in
<a class="reference external" href="http://nbviewer.jupyter.org/gist/nicoguaro/862ea1015917d99352401433d45684e2/matplotlib_styles.ipynb">this Jupyter notebook</a>.</p>
</div>
    </div>
    </article><article class="post h-entry post-text"><header><h1 class="post-title p-name"><a href="posts/hermite_interp/" class="u-url">Piecewise Hermite interpolation</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn">Nicolás Guarín-Zapata</span></p>
            <p class="dateline"><a href="posts/hermite_interp/" rel="bookmark"><time class="post-date published dt-published" datetime="2017-06-22T16:24:44-05:00" title="2017-06-22 16:24">2017-06-22 16:24</time></a></p>
                <p class="commentline">
    
    <a href="posts/hermite_interp/#disqus_thread" data-disqus-identifier="cache/posts/hermite_interp.html">Comments</a>


        </p>
</div>
    </header><div class="e-content entry-content">
    <p>In this post, we find the Hermite interpolation functions for the
domain [-1, 1]. And then, we use it for a pieciwise interpolation. Notice
that this interpolation has <span class="math">\(C^1\)</span> continuity compared to the
<span class="math">\(C^0\)</span> continuity that is common in Lagrange interpolation.</p>
<p>To compute the polynomials explicitly we use <cite>sympy</cite>.</p>
<div class="code"><pre class="code ipython2"><a id="rest_code_9dfcc2f4b0a846058ecaeefb97d9635e-1" name="rest_code_9dfcc2f4b0a846058ecaeefb97d9635e-1" href="posts/hermite_interp/#rest_code_9dfcc2f4b0a846058ecaeefb97d9635e-1"></a><span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">division</span>
<a id="rest_code_9dfcc2f4b0a846058ecaeefb97d9635e-2" name="rest_code_9dfcc2f4b0a846058ecaeefb97d9635e-2" href="posts/hermite_interp/#rest_code_9dfcc2f4b0a846058ecaeefb97d9635e-2"></a><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<a id="rest_code_9dfcc2f4b0a846058ecaeefb97d9635e-3" name="rest_code_9dfcc2f4b0a846058ecaeefb97d9635e-3" href="posts/hermite_interp/#rest_code_9dfcc2f4b0a846058ecaeefb97d9635e-3"></a><span class="kn">import</span> <span class="nn">sympy</span> <span class="k">as</span> <span class="nn">sym</span>
<a id="rest_code_9dfcc2f4b0a846058ecaeefb97d9635e-4" name="rest_code_9dfcc2f4b0a846058ecaeefb97d9635e-4" href="posts/hermite_interp/#rest_code_9dfcc2f4b0a846058ecaeefb97d9635e-4"></a><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</pre></div>
<p>We want to find a set of basis function that satisfy the following</p>
<div class="math">
\begin{align*}
N_1(x_1) &amp;= 1\\
N_1(x_2) &amp;= 0\\
N_2(x_1) &amp;= 1\\
N_2(x_2) &amp;= 0\\
N'_3(x_1) &amp;= 1\\
N'_3(x_2) &amp;= 0\\
N'_4(x_1) &amp;= 1\\
N'_4(x_2) &amp;= 0
\end{align*}
</div>
<p>These can be written as</p>
<div class="math">
\begin{equation*}
\begin{bmatrix}
1 &amp;x_1 &amp;x_1^2 &amp;x_1^3\\
1 &amp;x_2 &amp;x_2^2 &amp;x_2^3\\
0 &amp;1 &amp;2x_1 &amp;3x_1^2\\
0 &amp;1 &amp;2x_2 &amp;3x_2^2
\end{bmatrix}
\begin{bmatrix}
a_{11} &amp;a_{12} &amp;a_{13} &amp;a_{14}\\
a_{21} &amp;a_{22} &amp;a_{23} &amp;a_{24}\\
a_{31} &amp;a_{32} &amp;a_{33} &amp;a_{34}\\
a_{41} &amp;a_{42} &amp;a_{43} &amp;a_{44}
\end{bmatrix} =
\begin{bmatrix}
1 &amp;0 &amp;0 &amp;0\\
0 &amp;1 &amp;0 &amp;0\\
0 &amp;0 &amp;1 &amp;0\\
0 &amp;0 &amp;0 &amp;1
\end{bmatrix}
\end{equation*}
</div>
<p>The formula for interpolation would be</p>
<div class="math">
\begin{equation*}
f(x) \approx N_1(x) u_1 + N_2(x) u_2 + |J|(N_3(x) u'_3 + N_4(x) u'_4)\quad \forall x\in [a, b]
\end{equation*}
</div>
<p>with <span class="math">\(|J| = (b - a)/2\)</span> the Jacobian determinant of the
transformation.</p>
<div class="code"><pre class="code ipython2"><a id="rest_code_ce9ebd89120c40aea92649ebd174fae3-1" name="rest_code_ce9ebd89120c40aea92649ebd174fae3-1" href="posts/hermite_interp/#rest_code_ce9ebd89120c40aea92649ebd174fae3-1"></a><span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s2">"x1 x2 x"</span><span class="p">)</span>
<a id="rest_code_ce9ebd89120c40aea92649ebd174fae3-2" name="rest_code_ce9ebd89120c40aea92649ebd174fae3-2" href="posts/hermite_interp/#rest_code_ce9ebd89120c40aea92649ebd174fae3-2"></a><span class="n">V</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">Matrix</span><span class="p">([</span>
<a id="rest_code_ce9ebd89120c40aea92649ebd174fae3-3" name="rest_code_ce9ebd89120c40aea92649ebd174fae3-3" href="posts/hermite_interp/#rest_code_ce9ebd89120c40aea92649ebd174fae3-3"></a>    <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">x1</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="n">x1</span><span class="o">**</span><span class="mi">3</span><span class="p">],</span>
<a id="rest_code_ce9ebd89120c40aea92649ebd174fae3-4" name="rest_code_ce9ebd89120c40aea92649ebd174fae3-4" href="posts/hermite_interp/#rest_code_ce9ebd89120c40aea92649ebd174fae3-4"></a>    <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">x2</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="n">x2</span><span class="o">**</span><span class="mi">3</span><span class="p">],</span>
<a id="rest_code_ce9ebd89120c40aea92649ebd174fae3-5" name="rest_code_ce9ebd89120c40aea92649ebd174fae3-5" href="posts/hermite_interp/#rest_code_ce9ebd89120c40aea92649ebd174fae3-5"></a>    <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">x1</span><span class="p">,</span> <span class="mi">3</span><span class="o">*</span><span class="n">x1</span><span class="o">**</span><span class="mi">2</span><span class="p">],</span>
<a id="rest_code_ce9ebd89120c40aea92649ebd174fae3-6" name="rest_code_ce9ebd89120c40aea92649ebd174fae3-6" href="posts/hermite_interp/#rest_code_ce9ebd89120c40aea92649ebd174fae3-6"></a>    <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">x2</span><span class="p">,</span> <span class="mi">3</span><span class="o">*</span><span class="n">x2</span><span class="o">**</span><span class="mi">2</span><span class="p">]])</span>
<a id="rest_code_ce9ebd89120c40aea92649ebd174fae3-7" name="rest_code_ce9ebd89120c40aea92649ebd174fae3-7" href="posts/hermite_interp/#rest_code_ce9ebd89120c40aea92649ebd174fae3-7"></a><span class="n">V</span>
</pre></div>
<div class="math">
\begin{equation*}
\left[\begin{matrix}1 &amp; x_{1} &amp; x_{1}^{2} &amp; x_{1}^{3}\\
1 &amp; x_{2} &amp; x_{2}^{2} &amp; x_{2}^{3}\\
0 &amp; 1 &amp; 2 x_{1} &amp; 3 x_{1}^{2}\\
0 &amp; 1 &amp; 2 x_{2} &amp; 3 x_{2}^{2}\end{matrix}\right]
\end{equation*}
</div>
<p>We can see that the previous matrix is a  confluent Vandermonder matrix <a class="footnote-reference brackets" href="posts/hermite_interp/#footnote-1" id="footnote-reference-1" role="doc-noteref"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></a>.
It is similar to a Vandermonde matrix for the first <span class="math">\(n\)</span> nodes
and the derivatives of each row for the following ones.</p>
<p>The coefficients for our polynomials are given by the inverse of this matrix.</p>
<div class="code"><pre class="code ipython2"><a id="rest_code_799b87631a954fd6a16c8d7dabad5f85-1" name="rest_code_799b87631a954fd6a16c8d7dabad5f85-1" href="posts/hermite_interp/#rest_code_799b87631a954fd6a16c8d7dabad5f85-1"></a><span class="n">sym</span><span class="o">.</span><span class="n">simplify</span><span class="p">(</span><span class="n">V</span><span class="o">.</span><span class="n">inv</span><span class="p">())</span>
</pre></div>
<div class="math">
\begin{equation*}
\left[\begin{matrix}\frac{x_{2}^{2} \left(3 x_{1} - x_{2}\right)}{x_{1}^{3} - 3 x_{1}^{2} x_{2} + 3 x_{1} x_{2}^{2} - x_{2}^{3}} &amp; \frac{x_{1}^{2} \left(x_{1} - 3 x_{2}\right)}{x_{1}^{3} - 3 x_{1}^{2} x_{2} + 3 x_{1} x_{2}^{2} - x_{2}^{3}} &amp; - \frac{x_{1} x_{2}^{2}}{x_{1}^{2} - 2 x_{1} x_{2} + x_{2}^{2}} &amp; - \frac{x_{1}^{2} x_{2}}{x_{1}^{2} - 2 x_{1} x_{2} + x_{2}^{2}}\\- \frac{6 x_{1} x_{2}}{x_{1}^{3} - 3 x_{1}^{2} x_{2} + 3 x_{1} x_{2}^{2} - x_{2}^{3}} &amp; \frac{6 x_{1} x_{2}}{x_{1}^{3} - 3 x_{1}^{2} x_{2} + 3 x_{1} x_{2}^{2} - x_{2}^{3}} &amp; \frac{x_{2} \left(2 x_{1} + x_{2}\right)}{x_{1}^{2} - 2 x_{1} x_{2} + x_{2}^{2}} &amp; \frac{x_{1} \left(x_{1} + 2 x_{2}\right)}{x_{1}^{2} - 2 x_{1} x_{2} + x_{2}^{2}}\\\frac{3 x_{1} + 3 x_{2}}{x_{1}^{3} - 3 x_{1}^{2} x_{2} + 3 x_{1} x_{2}^{2} - x_{2}^{3}} &amp; - \frac{3 x_{1} + 3 x_{2}}{x_{1}^{3} - 3 x_{1}^{2} x_{2} + 3 x_{1} x_{2}^{2} - x_{2}^{3}} &amp; - \frac{x_{1} + 2 x_{2}}{x_{1}^{2} - 2 x_{1} x_{2} + x_{2}^{2}} &amp; - \frac{2 x_{1} + x_{2}}{x_{1}^{2} - 2 x_{1} x_{2} + x_{2}^{2}}\\- \frac{2}{x_{1}^{3} - 3 x_{1}^{2} x_{2} + 3 x_{1} x_{2}^{2} - x_{2}^{3}} &amp; \frac{2}{x_{1}^{3} - 3 x_{1}^{2} x_{2} + 3 x_{1} x_{2}^{2} - x_{2}^{3}} &amp; \frac{1}{x_{1}^{2} - 2 x_{1} x_{2} + x_{2}^{2}} &amp; \frac{1}{x_{1}^{2} - 2 x_{1} x_{2} + x_{2}^{2}}\end{matrix}\right]
\end{equation*}
</div>
<p>And we replace the values for the extreme nodes, -1 and 1.</p>
<div class="code"><pre class="code ipython2"><a id="rest_code_fecdd0a3c57a41769d2e039ecb7e9385-1" name="rest_code_fecdd0a3c57a41769d2e039ecb7e9385-1" href="posts/hermite_interp/#rest_code_fecdd0a3c57a41769d2e039ecb7e9385-1"></a><span class="n">V_inv</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">simplify</span><span class="p">(</span><span class="n">V</span><span class="o">.</span><span class="n">subs</span><span class="p">({</span><span class="n">x1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">x2</span><span class="p">:</span><span class="mi">1</span><span class="p">})</span><span class="o">.</span><span class="n">inv</span><span class="p">())</span>
<a id="rest_code_fecdd0a3c57a41769d2e039ecb7e9385-2" name="rest_code_fecdd0a3c57a41769d2e039ecb7e9385-2" href="posts/hermite_interp/#rest_code_fecdd0a3c57a41769d2e039ecb7e9385-2"></a><span class="n">V_inv</span>
</pre></div>
<div class="math">
\begin{equation*}
\left[\begin{matrix}\frac{1}{2} &amp; \frac{1}{2} &amp; \frac{1}{4} &amp; - \frac{1}{4}\\
- \frac{3}{4} &amp; \frac{3}{4} &amp; - \frac{1}{4} &amp; - \frac{1}{4}\\
0 &amp; 0 &amp; - \frac{1}{4} &amp; \frac{1}{4}\\
\frac{1}{4} &amp; - \frac{1}{4} &amp; \frac{1}{4} &amp; \frac{1}{4}\end{matrix}\right]
\end{equation*}
</div>
<p>The polynomials are the product of the coefficients and the monomials</p>
<div class="code"><pre class="code ipython2"><a id="rest_code_d4d1fbd349544d9aa210715a05cffb6d-1" name="rest_code_d4d1fbd349544d9aa210715a05cffb6d-1" href="posts/hermite_interp/#rest_code_d4d1fbd349544d9aa210715a05cffb6d-1"></a><span class="n">sym</span><span class="o">.</span><span class="n">factor</span><span class="p">(</span><span class="n">V_inv</span><span class="o">.</span><span class="n">T</span> <span class="o">*</span> <span class="n">sym</span><span class="o">.</span><span class="n">Matrix</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="n">x</span><span class="o">**</span><span class="mi">3</span><span class="p">]))</span>
</pre></div>
<div class="math">
\begin{equation*}
\left[\begin{matrix}\frac{1}{4} \left(x - 1\right)^{2} \left(x + 2\right)\\- \frac{1}{4} \left(x - 2\right) \left(x + 1\right)^{2}\\\frac{1}{4} \left(x - 1\right)^{2} \left(x + 1\right)\\\frac{1}{4} \left(x - 1\right) \left(x + 1\right)^{2}\end{matrix}\right]
\end{equation*}
</div>
<p>The interpolation basis would be</p>
<div class="math">
\begin{align*}
N_1 (x) &amp;= \frac{1}{4} (x - 1)^2 (2 + x)\\
N_2 (x) &amp;= \frac{1}{4} (x + 1)^2 (2 - x)\\
N_3 (x) &amp;= \frac{1}{4} (x - 1)^2 (x + 1)\\
N_4 (x) &amp;= \frac{1}{4} (x + 1)^2 (x - 1)\, ,
\end{align*}
</div>
<p>and the following function computes the interpolation for a given
function and derivative</p>
<div class="code"><pre class="code ipython2"><a id="rest_code_59de64f76a44425f897615e2245eb213-1" name="rest_code_59de64f76a44425f897615e2245eb213-1" href="posts/hermite_interp/#rest_code_59de64f76a44425f897615e2245eb213-1"></a><span class="k">def</span> <span class="nf">hermite_interp</span><span class="p">(</span><span class="n">fun</span><span class="p">,</span> <span class="n">grad</span><span class="p">,</span> <span class="n">x0</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">x1</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">npts</span><span class="o">=</span><span class="mi">101</span><span class="p">):</span>
<a id="rest_code_59de64f76a44425f897615e2245eb213-2" name="rest_code_59de64f76a44425f897615e2245eb213-2" href="posts/hermite_interp/#rest_code_59de64f76a44425f897615e2245eb213-2"></a>    <span class="n">jaco</span> <span class="o">=</span> <span class="p">(</span><span class="n">x1</span> <span class="o">-</span> <span class="n">x0</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span>
<a id="rest_code_59de64f76a44425f897615e2245eb213-3" name="rest_code_59de64f76a44425f897615e2245eb213-3" href="posts/hermite_interp/#rest_code_59de64f76a44425f897615e2245eb213-3"></a>    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">npts</span><span class="p">)</span>
<a id="rest_code_59de64f76a44425f897615e2245eb213-4" name="rest_code_59de64f76a44425f897615e2245eb213-4" href="posts/hermite_interp/#rest_code_59de64f76a44425f897615e2245eb213-4"></a>    <span class="n">f1</span> <span class="o">=</span> <span class="n">fun</span><span class="p">(</span><span class="n">x0</span><span class="p">)</span>
<a id="rest_code_59de64f76a44425f897615e2245eb213-5" name="rest_code_59de64f76a44425f897615e2245eb213-5" href="posts/hermite_interp/#rest_code_59de64f76a44425f897615e2245eb213-5"></a>    <span class="n">f2</span> <span class="o">=</span> <span class="n">fun</span><span class="p">(</span><span class="n">x1</span><span class="p">)</span>
<a id="rest_code_59de64f76a44425f897615e2245eb213-6" name="rest_code_59de64f76a44425f897615e2245eb213-6" href="posts/hermite_interp/#rest_code_59de64f76a44425f897615e2245eb213-6"></a>    <span class="n">g1</span> <span class="o">=</span> <span class="n">grad</span><span class="p">(</span><span class="n">x0</span><span class="p">)</span>
<a id="rest_code_59de64f76a44425f897615e2245eb213-7" name="rest_code_59de64f76a44425f897615e2245eb213-7" href="posts/hermite_interp/#rest_code_59de64f76a44425f897615e2245eb213-7"></a>    <span class="n">g2</span> <span class="o">=</span> <span class="n">grad</span><span class="p">(</span><span class="n">x1</span><span class="p">)</span>
<a id="rest_code_59de64f76a44425f897615e2245eb213-8" name="rest_code_59de64f76a44425f897615e2245eb213-8" href="posts/hermite_interp/#rest_code_59de64f76a44425f897615e2245eb213-8"></a>    <span class="n">N1</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="mi">4</span><span class="o">*</span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="mi">2</span> <span class="o">+</span> <span class="n">x</span><span class="p">)</span>
<a id="rest_code_59de64f76a44425f897615e2245eb213-9" name="rest_code_59de64f76a44425f897615e2245eb213-9" href="posts/hermite_interp/#rest_code_59de64f76a44425f897615e2245eb213-9"></a>    <span class="n">N2</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="mi">4</span><span class="o">*</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="mi">2</span> <span class="o">-</span> <span class="n">x</span><span class="p">)</span>
<a id="rest_code_59de64f76a44425f897615e2245eb213-10" name="rest_code_59de64f76a44425f897615e2245eb213-10" href="posts/hermite_interp/#rest_code_59de64f76a44425f897615e2245eb213-10"></a>    <span class="n">N3</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="mi">4</span><span class="o">*</span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<a id="rest_code_59de64f76a44425f897615e2245eb213-11" name="rest_code_59de64f76a44425f897615e2245eb213-11" href="posts/hermite_interp/#rest_code_59de64f76a44425f897615e2245eb213-11"></a>    <span class="n">N4</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="mi">4</span><span class="o">*</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
<a id="rest_code_59de64f76a44425f897615e2245eb213-12" name="rest_code_59de64f76a44425f897615e2245eb213-12" href="posts/hermite_interp/#rest_code_59de64f76a44425f897615e2245eb213-12"></a>    <span class="n">interp</span> <span class="o">=</span> <span class="n">N1</span><span class="o">*</span><span class="n">f1</span> <span class="o">+</span> <span class="n">N2</span><span class="o">*</span><span class="n">f2</span> <span class="o">+</span> <span class="n">jaco</span><span class="o">*</span><span class="p">(</span><span class="n">N3</span><span class="o">*</span><span class="n">g1</span> <span class="o">+</span> <span class="n">N4</span><span class="o">*</span><span class="n">g2</span><span class="p">)</span>
<a id="rest_code_59de64f76a44425f897615e2245eb213-13" name="rest_code_59de64f76a44425f897615e2245eb213-13" href="posts/hermite_interp/#rest_code_59de64f76a44425f897615e2245eb213-13"></a>    <span class="k">return</span> <span class="n">interp</span>
</pre></div>
<p>In this case, we interpolate the <code class="docutils literal">sinc</code> function</p>
<div class="code"><pre class="code ipython2"><a id="rest_code_48e81efdc0074c78810bd2c929c401e5-1" name="rest_code_48e81efdc0074c78810bd2c929c401e5-1" href="posts/hermite_interp/#rest_code_48e81efdc0074c78810bd2c929c401e5-1"></a><span class="k">def</span> <span class="nf">fun</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<a id="rest_code_48e81efdc0074c78810bd2c929c401e5-2" name="rest_code_48e81efdc0074c78810bd2c929c401e5-2" href="posts/hermite_interp/#rest_code_48e81efdc0074c78810bd2c929c401e5-2"></a>    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">x</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">x</span><span class="p">)</span>
<a id="rest_code_48e81efdc0074c78810bd2c929c401e5-3" name="rest_code_48e81efdc0074c78810bd2c929c401e5-3" href="posts/hermite_interp/#rest_code_48e81efdc0074c78810bd2c929c401e5-3"></a>
<a id="rest_code_48e81efdc0074c78810bd2c929c401e5-4" name="rest_code_48e81efdc0074c78810bd2c929c401e5-4" href="posts/hermite_interp/#rest_code_48e81efdc0074c78810bd2c929c401e5-4"></a>
<a id="rest_code_48e81efdc0074c78810bd2c929c401e5-5" name="rest_code_48e81efdc0074c78810bd2c929c401e5-5" href="posts/hermite_interp/#rest_code_48e81efdc0074c78810bd2c929c401e5-5"></a><span class="k">def</span> <span class="nf">grad</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<a id="rest_code_48e81efdc0074c78810bd2c929c401e5-6" name="rest_code_48e81efdc0074c78810bd2c929c401e5-6" href="posts/hermite_interp/#rest_code_48e81efdc0074c78810bd2c929c401e5-6"></a>    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">x</span><span class="p">)</span><span class="o">/</span><span class="n">x</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">x</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
<p>The following snippet compute the interpolation and plot it.</p>
<div class="code"><pre class="code ipython2"><a id="rest_code_f6ddb1aac107473c8bf07f943ff01311-1" name="rest_code_f6ddb1aac107473c8bf07f943ff01311-1" href="posts/hermite_interp/#rest_code_f6ddb1aac107473c8bf07f943ff01311-1"></a><span class="n">a</span> <span class="o">=</span> <span class="mi">2</span>
<a id="rest_code_f6ddb1aac107473c8bf07f943ff01311-2" name="rest_code_f6ddb1aac107473c8bf07f943ff01311-2" href="posts/hermite_interp/#rest_code_f6ddb1aac107473c8bf07f943ff01311-2"></a><span class="n">b</span> <span class="o">=</span> <span class="mi">5</span>
<a id="rest_code_f6ddb1aac107473c8bf07f943ff01311-3" name="rest_code_f6ddb1aac107473c8bf07f943ff01311-3" href="posts/hermite_interp/#rest_code_f6ddb1aac107473c8bf07f943ff01311-3"></a><span class="n">nels</span> <span class="o">=</span> <span class="mi">7</span>
<a id="rest_code_f6ddb1aac107473c8bf07f943ff01311-4" name="rest_code_f6ddb1aac107473c8bf07f943ff01311-4" href="posts/hermite_interp/#rest_code_f6ddb1aac107473c8bf07f943ff01311-4"></a><span class="n">npts</span> <span class="o">=</span> <span class="mi">200</span>
<a id="rest_code_f6ddb1aac107473c8bf07f943ff01311-5" name="rest_code_f6ddb1aac107473c8bf07f943ff01311-5" href="posts/hermite_interp/#rest_code_f6ddb1aac107473c8bf07f943ff01311-5"></a><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">npts</span><span class="p">)</span>
<a id="rest_code_f6ddb1aac107473c8bf07f943ff01311-6" name="rest_code_f6ddb1aac107473c8bf07f943ff01311-6" href="posts/hermite_interp/#rest_code_f6ddb1aac107473c8bf07f943ff01311-6"></a><span class="n">y</span> <span class="o">=</span> <span class="n">fun</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a id="rest_code_f6ddb1aac107473c8bf07f943ff01311-7" name="rest_code_f6ddb1aac107473c8bf07f943ff01311-7" href="posts/hermite_interp/#rest_code_f6ddb1aac107473c8bf07f943ff01311-7"></a><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">"black"</span><span class="p">)</span>
<a id="rest_code_f6ddb1aac107473c8bf07f943ff01311-8" name="rest_code_f6ddb1aac107473c8bf07f943ff01311-8" href="posts/hermite_interp/#rest_code_f6ddb1aac107473c8bf07f943ff01311-8"></a><span class="n">xi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">num</span><span class="o">=</span><span class="n">nels</span><span class="p">,</span> <span class="n">endpoint</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<a id="rest_code_f6ddb1aac107473c8bf07f943ff01311-9" name="rest_code_f6ddb1aac107473c8bf07f943ff01311-9" href="posts/hermite_interp/#rest_code_f6ddb1aac107473c8bf07f943ff01311-9"></a><span class="n">dx</span> <span class="o">=</span> <span class="n">xi</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">xi</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<a id="rest_code_f6ddb1aac107473c8bf07f943ff01311-10" name="rest_code_f6ddb1aac107473c8bf07f943ff01311-10" href="posts/hermite_interp/#rest_code_f6ddb1aac107473c8bf07f943ff01311-10"></a><span class="k">for</span> <span class="n">x0</span> <span class="ow">in</span> <span class="n">xi</span><span class="p">:</span>
<a id="rest_code_f6ddb1aac107473c8bf07f943ff01311-11" name="rest_code_f6ddb1aac107473c8bf07f943ff01311-11" href="posts/hermite_interp/#rest_code_f6ddb1aac107473c8bf07f943ff01311-11"></a>    <span class="n">x1</span> <span class="o">=</span> <span class="n">x0</span> <span class="o">+</span> <span class="n">dx</span>
<a id="rest_code_f6ddb1aac107473c8bf07f943ff01311-12" name="rest_code_f6ddb1aac107473c8bf07f943ff01311-12" href="posts/hermite_interp/#rest_code_f6ddb1aac107473c8bf07f943ff01311-12"></a>    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">npts</span><span class="p">)</span>
<a id="rest_code_f6ddb1aac107473c8bf07f943ff01311-13" name="rest_code_f6ddb1aac107473c8bf07f943ff01311-13" href="posts/hermite_interp/#rest_code_f6ddb1aac107473c8bf07f943ff01311-13"></a>    <span class="n">y</span> <span class="o">=</span> <span class="n">hermite_interp</span><span class="p">(</span><span class="n">fun</span><span class="p">,</span> <span class="n">grad</span><span class="p">,</span> <span class="n">x0</span><span class="o">=</span><span class="n">x0</span><span class="p">,</span> <span class="n">x1</span><span class="o">=</span><span class="n">x1</span><span class="p">,</span> <span class="n">npts</span><span class="o">=</span><span class="n">npts</span><span class="p">)</span>
<a id="rest_code_f6ddb1aac107473c8bf07f943ff01311-14" name="rest_code_f6ddb1aac107473c8bf07f943ff01311-14" href="posts/hermite_interp/#rest_code_f6ddb1aac107473c8bf07f943ff01311-14"></a><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">"dashed"</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">"#4daf4a"</span><span class="p">)</span>
<a id="rest_code_f6ddb1aac107473c8bf07f943ff01311-15" name="rest_code_f6ddb1aac107473c8bf07f943ff01311-15" href="posts/hermite_interp/#rest_code_f6ddb1aac107473c8bf07f943ff01311-15"></a><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]],</span> <span class="p">[</span><span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">y</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]],</span> <span class="n">marker</span><span class="o">=</span><span class="s2">"o"</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">"#4daf4a"</span><span class="p">,</span>
<a id="rest_code_f6ddb1aac107473c8bf07f943ff01311-16" name="rest_code_f6ddb1aac107473c8bf07f943ff01311-16" href="posts/hermite_interp/#rest_code_f6ddb1aac107473c8bf07f943ff01311-16"></a>         <span class="n">linewidth</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<a id="rest_code_f6ddb1aac107473c8bf07f943ff01311-17" name="rest_code_f6ddb1aac107473c8bf07f943ff01311-17" href="posts/hermite_interp/#rest_code_f6ddb1aac107473c8bf07f943ff01311-17"></a><span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">"x"</span><span class="p">)</span>
<a id="rest_code_f6ddb1aac107473c8bf07f943ff01311-18" name="rest_code_f6ddb1aac107473c8bf07f943ff01311-18" href="posts/hermite_interp/#rest_code_f6ddb1aac107473c8bf07f943ff01311-18"></a><span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">"y"</span><span class="p">)</span>
<a id="rest_code_f6ddb1aac107473c8bf07f943ff01311-19" name="rest_code_f6ddb1aac107473c8bf07f943ff01311-19" href="posts/hermite_interp/#rest_code_f6ddb1aac107473c8bf07f943ff01311-19"></a><span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s2">"Exact function"</span><span class="p">,</span> <span class="s2">"Interpolation"</span><span class="p">])</span>
<a id="rest_code_f6ddb1aac107473c8bf07f943ff01311-20" name="rest_code_f6ddb1aac107473c8bf07f943ff01311-20" href="posts/hermite_interp/#rest_code_f6ddb1aac107473c8bf07f943ff01311-20"></a><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
<img alt="/images/sinc_interp.svg" src="images/sinc_interp.svg"><section id="references"><h2>References</h2>
<aside class="footnote brackets" id="footnote-1" role="note"><span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="posts/hermite_interp/#footnote-reference-1">1</a><span class="fn-bracket">]</span></span>
<p>Walter Gautschi (1962). On inverses of Vandermonde
and confluent Vandermonde matrices. Numerische Mathematik, 4
117-123.</p>
</aside></section>
</div>
    </article><article class="post h-entry post-text"><header><h1 class="post-title p-name"><a href="posts/herramientas-investigacion/" class="u-url">(Auxiliary) Tools for research</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn">Nicolás Guarín-Zapata</span></p>
            <p class="dateline"><a href="posts/herramientas-investigacion/" rel="bookmark"><time class="post-date published dt-published" datetime="2014-07-12T04:24:00-05:00" title="2014-07-12 04:24">2014-07-12 04:24</time></a></p>
                <p class="commentline">
    
    <a href="posts/herramientas-investigacion/#disqus_thread" data-disqus-identifier="cache/posts/herramientas-investigacion.html">Comments</a>


        </p>
</div>
    </header><div class="e-content entry-content">
    <p>In this post I want to talk about some tools (or something like that)
that are useful in the day-to-day research, but usually not so popular
for being somewhat <em>tangential</em> to the area specific in which each one works.</p>
<div class="section" id="scripting">
<h2>Scripting</h2>
<p>A <a class="reference external" href="http://en.wikipedia.org/wiki/Scripting_language">script</a> is a
<em>usually</em> simple program that performs a series of tasks.
If there is a task that must be done more than ... five times (the number varies
according to the patience), then I think it's something we can ask the
computer to do for us. In other words: we can automate that work. Some tasks
that can be a good alternative to automate are: rename 100 files,
convert a file from one format to another (e.g. STL to OBJ), read
387 files with information on the climate and graph its evolution
temporary (minimum, maximum and average temperature). These tasks can
be easy to do by hand, but for the amount of work that
they involve are tedious.</p>
<p>The first thing to do is to get a scripting language. Some options are
<a class="reference external" href="https://www.python.org/">Python</a>,
<a class="reference external" href="http://www.gnu.org/software/bash/">Bash</a>,
<a class="reference external" href="http://julialang.org/">Julia</a>,
<a class="reference external" href="http://www.mathworks.com/products/matlab/">Matlab</a>/<a class="reference external" href="http://www.gnu.org/software/octave/">Octave</a>,
<a class="reference external" href="http://www.scilab.org/">Scilab</a>. Allowing myself to follow my bias,
I would recommend to use Python.</p>
</div>
<div class="section" id="graphics-and-schematics">
<h2>Graphics and schematics</h2>
<p>A picture is worth a thousand words, or so the saying goes.
Personally, it seems absolutely true to me and I try to do
<em>scribbles</em> to better understand something or explain it better.
The first thing I would like to mention is the difference between images
bitmap (or raster) and vector images.</p>
<ul class="simple">
<li><p><a class="reference external" href="http://en.wikipedia.org/wiki/Raster_graphics">Bitmap image</a>: it's an image
which is represented by an array (or rectangular grid) of pixels. In other
words, the color information that there are in each point of the image. The
most popular formats store the compressed information. For high contrast
graphics (such as schematics or diagrams) the best format is PNG. If you have
an animation, GIF would be preferable. And in the case of photographs it is
better to use JPG.</p></li>
<li><p><a class="reference external" href="http://en.wikipedia.org/wiki/Vector_graphics">Vector image</a>:
is an image that is made up of geometric entities. In this case, the
stored information is not point-to-point but <em>the construction</em> of
the shapes that constitute it. For this reason, these images don't
<em>pixelate</em> because the information you have is how to build it.
This type of images is the best options for schematics and diagrams,
since the only stored information are the strokes and text added to
them (see Figure 1). The <em>de facto</em> standard for this type
of images is PDF —it is the one I usually include in my documents
\(\LaTeX\), although there is a way to embed SVG in \(\LaTeX\)
But it's something I haven't yet explored. Although PDF is the
<em>standard</em>, the preferred format is <a class="reference external" href="http://en.wikipedia.org/wiki/Scalable_Vector_Graphics">SVG (Scalable Vector
Graphics)</a>
which is a standard across the internet and most
<em>modern</em> browsers allow viewing.</p></li>
</ul>
<p>Recapping, we should use JPG images for photographs and SVG
for schematics/diagrams. Another attribute that may be useful is the
Layer management, SVG allows this ... and for raster formats we have the
option to use TIFF.</p>
<p>Regarding software to generate/edit this type of images I must
say that there are a large number of programs that allow exporting to
these formats: Python/Matplotlib, Matlab, Inkscape, Adobe
Illustrator, GIMP, Photoshop, LibreOffice. If the graph is generated
from a calculation or a data series I use Matplotlib. If
instead, we want to make a schematic or my tool of choice
is <a class="reference external" href="http://www.inkscape.org/">Inkscape.</a> This
program is intended to be a free alternative to programs like Adobe
Illustrator —and it does achieve it. Obviously, you could use
Illustrator or Corel Draw for this task. If the only use would be to make
Technical schematics, I think it would be a waste.</p>
<table>
<colgroup><col style="width: 100%"></colgroup>
<tbody>
<tr>
<td><img alt="/images/sensor_hall.png" src="images/sensor_hall.png"></td>
</tr>
<tr>
<td><p><strong>Figure 1.</strong> Schematic for magnetic field sensing for <a class="reference external" href="http://en.wikipedia.org/wiki/Neodymium_magnet">permanent
magnets</a> using
<a class="reference external" href="http://en.wikipedia.org/wiki/Hall_effect">Hall effect</a>. From
my Engineering Physics <a class="reference external" href="https://goo.gl/G9RRhC">thesis</a> .</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="taking-notes">
<h2>Taking notes</h2>
<p>I suppose that to some it would seem a bit trivial to speak of "notetaking"
and much more coming from someone who didn't have notebooks in
high school, but since I'm a bit stubborn I think I'll still write a
little about this. The first thing I would like to mention is that I remember
people talking to me about this at school, but there was never anything
formal regarding developing these skills. Surfing the web,
there is a lot of information. Even the <a class="reference external" href="http://en.wikipedia.org/wiki/Note-taking">Wikipedia article on
English</a> is interesting.
There is nothing better to write than to have a good pen and paper with a good
grammage, that's why I still use a notebook where I keep track of
what I do in my research and take notes. However, this scheme is quite linear
and leaves out more <em>contemporary</em> options. That is, why settle for a document
in this time of hyper-documents? The advantages of taking notes
digitally jump to the eye, in a hyper-document you can have
links, embed images, video and sound.</p>
<p>Regarding tools, I include a short list here:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://evernote.com/">Evernote</a> is probably the most popular tool
for taking notes. It's cross-platform, Freemium  (free basic and paid
advanced functionality), and has many options. I use it, but not much in my
research.</p></li>
<li><p><a class="reference external" href="http://zim-wiki.org/">Zim</a> it is an offline wiki. Has great
number of options like calendar, equations with <span class="math">\(\LaTeX\)</span>, images ...
anyway. The but that I find is that no I have managed to configure the
equations in Windows (and in my office I must use Windows :-/).</p></li>
<li><p><a class="reference external" href="http://www.docear.org/">Docear</a> this is a tool thought,
mainly, to handle bibliography. However, it allows to take
notes and, in general, handle the information of the investigation. The
more (or less) appealing feature is that it works around
mental maps.</p></li>
<li><p><a class="reference external" href="https://www.zotero.org/">Zotero</a> It is also a tool to handle bibliography,
although it allows to handle some note taking (at least around the
bibliography).</p></li>
<li><p><a class="reference external" href="http://www.mendeley.com/">Mendeley</a> it is very similar to the previous one,
although with more functionalities. The biggest but that I find it
is that in 2013 it was bought by Elsevier.</p></li>
</ul>
<p>Regarding bibliography management I would also like to mention
<a class="reference external" href="http://endnote.com/">EndNote</a> which is the program with the longest
trajectory and <a class="reference external" href="http://jabref.sourceforge.net/">JabRef</a> which is the one
that I have used the longest. Some interesting references
comparing bibliography handlers are::
<a class="reference external" href="https://www.researchgate.net/post/alternative_to_Endnote?_tpcectx=qa_overview_following">[A]</a>
<a class="reference external" href="http://www.docear.org/2013/10/14/what-makes-a-bad-reference-manager/">[B]</a>
<a class="reference external" href="http://www.docear.org/2014/01/15/comprehensive-comparison-of-reference-managers-mendeley-vs-zotero-vs-docear/">[C]</a>.</p>
</div>
<div class="section" id="graphic-reconstruction">
<h2>Graphic reconstruction</h2>
<p>It is common to find information presented in the form of graphics.
It is also common that we want to have the numerical data of these
graphs to be able to compare them with ours. To know if
our measurements/simulations/methods give results similar to others
presented in the literature. We could use powerful image processing software,
or other more modest ones designed specifically for this purpose.</p>
<table>
<colgroup><col style="width: 100%"></colgroup>
<tbody>
<tr>
<td><img alt="/images/pointplot.jpg" src="images/pointplot.jpg"></td>
</tr>
<tr>
<td><p><strong>Figure 2.</strong> Original graphic.</p></td>
</tr>
</tbody>
</table>
<table>
<colgroup><col style="width: 100%"></colgroup>
<tbody>
<tr>
<td><img alt="/images/digitized_pts.png" src="images/digitized_pts.png"></td>
</tr>
<tr>
<td><p><strong>Figure 3.</strong> Graphic processed in Engauge Digitizer. Some points were
selected (automatically) to obtain their coordinates.</p></td>
</tr>
</tbody>
</table>
<ul class="simple">
<li><p><a class="reference external" href="http://extensions.libreoffice.org/extension-center/digitizer-of-xy-chart">Digitizer of XY chart</a>
this is a plugin for Libreoffice/OpenOffice and it exports the result
to the current spreadsheet, it is simple and easy to use.</p></li>
<li><p><a class="reference external" href="http://digitizer.sourceforge.net/">Engauge Digitizer</a>, is the one
I normally use when I need to do this task (see Figures above). It is
open source (and free) and has a fair amount of options
to make the task easier.</p></li>
<li><p><a class="reference external" href="http://plotdigitizer.sourceforge.net/">Plot Digitizer</a> I don't have
a lot of information about this one (since I have never used it), except that
it is written in Java.</p></li>
<li><p><a class="reference external" href="http://imagej.nih.gov/ij/">ImageJ</a> this is a (complete) program for
image processing that is written in Java. I have not used it
for this task on a regular basis, but could be used for it.</p></li>
</ul>
</div>
<div class="section" id="scientific-visualization">
<h2>Scientific visualization</h2>
<p><a class="reference external" href="https://en.wikipedia.org/wiki/Scientific_visualization">Scientific visualization</a>
is in charge of generating graphs that allow visualizing "scientific data"
to facilitate the understanding behind the data. For this work, many of us have
used scripting languages such as Matlab/Octave, Scilab or Python (with
Matplotlib or Mayavi). However, as visualization is about something visual
—what else?—, it is good have a tool that allows you to generate and change
graphics interactively, although we must always automate as much
amount of work possible (laziness has always been one of the largest mobiles of
humanity, you have to accept it).</p>
<ul class="simple">
<li><p><a class="reference external" href="http://code.enthought.com/projects/mayavi/">MayaVi</a>, this is a
program written in Python that uses <a class="reference external" href="http://en.wikipedia.org/wiki/VTK">VTK</a>. It is very versatile and the great
advantage it has is that it can be used within Python
<a class="reference external" href="https://scipy-lectures.github.io/packages/3d_plotting/index.html">scripts</a>.</p></li>
<li><p><a class="reference external" href="http://www.paraview.org/">Paraview</a>, this program is also
based on VTK and allows to parallelize the work (for
multi-core computers and clusters). Below I include a
video generated in Paraview to show its capabilities.</p></li>
<li><p><a class="reference external" href="https://wci.llnl.gov/simulation/computer-codes/visit">Visit</a>,
this program is also VTK based, I have never used it but
I wanted to include it because people say it can be more intuitive than
Paraview.</p></li>
<li><p><a class="reference external" href="http://www.tecplot.com/">Tecplot,</a> this program is very popular
at Purdue. I think it was initially intended for CFD, but it has been
much expanded. Regarding 3D graphics, it does not seem better than
ParaView, however, the 2D graphics capabilities (XY graphics, and
others) make it attractive.</p></li>
<li><p><a class="reference external" href="http://jwork.org/scavis/">Scavis</a>, this is written in Java. I didn't
know it until I started writing this post but it caught my eye and I wante
to put it on the list. Something that cught my attention is that it allows
scripting in several languages: Java, Python, Ruby, BeanShell, and
Matlab/Octave.</p></li>
<li><p><a class="reference external" href="http://www.originlab.com/">Origin</a>, I have never used it but I didn't
want to leave it out because I've always heard great things about it
(probably comparing it with Excel ... but I can't comment).</p></li>
</ul>
<iframe src="https://player.vimeo.com/video/2016815" width="640" height="483" frameborder="0" webkitallowfullscreen mozallowfullscreen allowfullscreen>
</iframe>
<p>
    <ahref>
    Cross fire simulation
    <a href="https://vimeo.com">Vimeo</a>.
</ahref></p>
</div>
<div class="section" id="version-control">
<h2>Version control</h2>
<p><a class="reference external" href="https://en.wikipedia.org/wiki/Version_control">Version control</a> is the
management of changes in documents, source code and other types of
information. This can be done manually, but it is easy to make mistakes
or replace the version of a code easily, and for this it is
advisable to use software that facilitates the work. The idea is to
have a <em>place</em> (repository) where versions and changes are stored, and keep
track of them. In this way you can revert to a previous version of documents
and multiple people can work together. There are two paradigms (or
architectures) for version control: centralized and distributed. In the first
there is a centralized repository where you find all the information. In
distributed architectures each user has a copy of the repository. Personally I
have only used <a class="reference external" href="http://git-scm.com/">Git</a>, which falls under the distributed
category and is one of the most popular version contorl software
at the moment; it is used by companies like Google, Facebook and Netflix.</p>
<p>An example can be seen in this
<a class="reference external" href="https://github.com/bebopsan/SEC-Thesis">repository</a>, with the
undergrad thesis document of Santiago Echeverri, which
I had the opportunity to advise. We edited this document
together while he was in Medellin and I was in
USA. The document was made in the markup language
<span class="math">\(\LaTeX\)</span>.</p>
<p>In addition to having control over the versions and being able to access
previous versions, it is useful to be able to store the information in a
accesible location from anywhere in the world with a connection to
Internet. This can be achieved with your own server, obviously, or
also through an external provider. Two projects that are very
popular for hosting repositories are
(<a class="reference external" href="http://www.infoworld.com/d/application-development/bitbucket-vs-github-which-project-host-has-the-most-227061">comparison between Github and
BitBucket</a>):</p>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/">Github</a> is the most popular at the moment.
It allows to have projects with an unlimited number of collaborators.
To have a private repository it is necessary to pay.</p></li>
<li><p><a class="reference external" href="https://bitbucket.org/">BitBucket</a> has the main advantage that
allows you to have private repositories without the need to pay. It is only
free for projects with 5 or fewer collaborators (or for
<a class="reference external" href="https://bitbucket.org/account/user/nicoguaro/plans/">academic projects</a>).</p></li>
</ul>
</div>
<div class="section" id="suggested-links">
<h2>Suggested links</h2>
<ol class="arabic simple">
<li><p>Software Carpentry. <a class="reference external" href="http://software-carpentry.org/">http://software-carpentry.org/</a></p></li>
<li><p>Python Scientific Lecture Notes. <a class="reference external" href="https://scipy-lectures.github.io/">https://scipy-lectures.github.io/</a></p></li>
</ol>
<p>Surely I left a lot of topics outside as well as tools within a topic. If that's
the case, I would appreciate if you tell me in the comments.</p>
</div>
    </div>
    </article><article class="post h-entry post-text"><header><h1 class="post-title p-name"><a href="posts/la-zorra-y-las-uvas/" class="u-url">La zorra y las uvas</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn">Nicolás Guarín-Zapata</span></p>
            <p class="dateline"><a href="posts/la-zorra-y-las-uvas/" rel="bookmark"><time class="post-date published dt-published" datetime="2014-05-28T23:27:00-05:00" title="2014-05-28 23:27">2014-05-28 23:27</time></a></p>
                <p class="commentline">
    
    <a href="posts/la-zorra-y-las-uvas/#disqus_thread" data-disqus-identifier="cache/posts/la-zorra-y-las-uvas.html">Comments</a>


        </p>
</div>
    </header><div class="e-content entry-content">
    <p>Mirando en internet no encontré una versión en español de la fábula de
Esopo "La zorra y las uvas" que me gustara (o que al menos rimara :P).
De hecho, el artículo de Wikipedia en
<a class="reference external" href="http://es.m.wikipedia.org/wiki/La_zorra_y_las_uvas">español</a> es
bastante más malo que su equivalente en
<a class="reference external" href="http://en.m.wikipedia.org/wiki/The_Fox_and_the_Grapes">inglés</a>.  Por
esto, y por petición de una amiga, hice mi versión con rima asonante. Y
reza así</p>
<p><strong>La Zorra y las uvas</strong></p>
<div class="line-block">
<div class="line">La zorra que con ansias uvas buscaba</div>
<div class="line">no pudo alcanzarlas por lo alto que estaban.</div>
<div class="line">Giró y exclamó, con risa lastimera:</div>
<div class="line">¡Están verdes! No valen mi espera.</div>
</div>
<div class="line-block">
<div class="line"><br></div>
</div>
    </div>
    </article><article class="post h-entry post-text"><header><h1 class="post-title p-name"><a href="posts/notas-tableta/" class="u-url">Note taking with my tablet</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn">Nicolás Guarín-Zapata</span></p>
            <p class="dateline"><a href="posts/notas-tableta/" rel="bookmark"><time class="post-date published dt-published" datetime="2014-05-20T21:23:00-05:00" title="2014-05-20 21:23">2014-05-20 21:23</time></a></p>
                <p class="commentline">
    
    <a href="posts/notas-tableta/#disqus_thread" data-disqus-identifier="cache/posts/notas-tableta.html">Comments</a>


        </p>
</div>
    </header><div class="e-content entry-content">
    <p>Last year baby Jesus gave me a <a class="reference external" href="http://www.samsung.com/us/mobile/galaxy-note/GT-N8013EAVXAR">Samsung Galaxy Note
10.1</a>
(model 2012). This tablet is designed for taking notes, as it brings
an S-Pen (made by Wacom, which I think makes the
<a class="reference external" href="http://www.wacom.com/en/us/business/technology-solutions">technology</a>
for most commercial tablets) and various applications
designed for it. Such as: S Note, PhotoShop Touch, <a class="reference external" href="http://www.crayonphysics.com/">Crayon
Physics</a> (you have to play it is very
fun).</p>
<p>So I decided to make an experiment taking notes in class with my
tablet completely in the two subjects I studied in the spring 2014 term.
In Optimization I used the pencil that came with the
tablet and for Molecular Physics I used a <a class="reference external" href="http://www.wacom.com/en/us/everyday/bamboo-stylus-feel-samsung-galaxy-note">Bamboo
Stylus</a>
which is supposed to be designed specifically for this tablet. I took
notes with the default software (S Note) and converted to PDF
(the notes were made entirely with the software):</p>
<ul class="simple">
<li><p><a class="reference external" href="https://drive.google.com/file/d/0ByfUxGpgeoJ9TExLUkJ5TGVNYzA/edit?usp=sharing">Optimization notes</a></p></li>
<li><p><a class="reference external" href="https://drive.google.com/file/d/0ByfUxGpgeoJ9aEJQejZIYzFHdk0/edit?usp=sharing">Computational (Bio)Molecular Physics notes</a></p></li>
</ul>
<p>Although the touch sensation of the Bamboo Stylus is much more pleasant,
the performance of the S Pen is much better. In both cases, the feeling is
very different from using paper and pencil (pen/fountain pen), largely
because friction is very little in comparison (something that is
better with conductive pencils). The user experience of the
pencil varies greatly from one application to another, resulting in good
expectations. As for taking notes: it is highly recommended to take
short notes (like meetings); not so much for taking long notes (like
class notes), unless you want to have a digital copy
easily.</p>
<div class="section" id="apps">
<h2>Apps</h2>
<p>The technology behind the tablet is the most important part. Simply pu, the pen
has an antenna and the tablet a grid of antennas that are tuned to the same
frequency (<a class="reference external" href="http://en.wikipedia.org/wiki/Wacom#Technology">531 kHz</a>, in
<a class="reference external" href="http://www.androidauthority.com/break-it-down-how-does-the-s-pen-work-154435/">this link</a>
they explain how it works a little better). However, it is also
important to consider the software that is used to take notes:</p>
<p><a class="reference external" href="http://content.samsung.com/us/contents/aboutn/sNoteIntro.do">S
Note</a></p>
<ul class="simple">
<li><p>It is the native app for taking notes.</p></li>
<li><p>It has shape and equations recognition. Equations should be simple,
don't expect to take notes of Quantum Mechanics or Continuum Mechanics
using this tool.</p></li>
<li><p>It allow to insert images and record sound within the app.</p></li>
<li><p>It has "palm rejection".</p></li>
<li><p>The size of the page is not configurable.</p></li>
</ul>
<p><a class="reference external" href="http://papyrusapp.com/">Papyrus</a></p>
<ul class="simple">
<li><p>It has "palm rejection" and allow to setup your finger as eraser
(this can be very useful).</p></li>
<li><p>It allows different page sizes and backgrounds.</p></li>
<li><p>It allows to draw rectangles and ellipses.</p></li>
<li><p>Brushes are very basic.</p></li>
</ul>
<p><a class="reference external" href="http://noteanytime.com/en/">Note Anytime</a></p>
<ul class="simple">
<li><p>It allows to have different page sizes.</p></li>
<li><p>It stores paths as vector graphics and you cand edit them (change color
size or style) later.</p></li>
<li><p>It has several brushes and they are even customizable.</p></li>
<li><p>It can't convert notes to PDF.</p></li>
<li><p>It does not have "palm rejection".</p></li>
</ul>
<p><a class="reference external" href="http://code.google.com/p/android-quill/">Quill</a></p>
<ul class="simple">
<li><p>It is open source, although if you get it through "Google Store" it
has a cost.</p></li>
<li><p>The algorithm for path recognition is better than the others (and
it is adjustable).</p></li>
<li><p>It is still in a preliminary stage.</p></li>
</ul>
<p>Sadly, there isn't a version of <a class="reference external" href="https://www.fiftythree.com/paper.html">Paper</a>
(by FiftyThree) on Android, and, although there is a version of <a class="reference external" href="http://www.wacom.com/en/us/everyday/bamboo-paper">Bamboo
Paper</a> (by Wacom)
for Android it is not compatible with the tablet.</p>
</div>
<div class="section" id="in-conclusion">
<h2>In conclusion</h2>
<p>Replacing "traditional" note taking with "digital" notes
It may be a bit rushed, but it is doable. The application that
comes by default (S Note) allows to do the job "out of the
box", but it could be better. The applications that I find the most
Promising are: Note Anytime and Quill.</p>
</div>
    </div>
    </article><article class="post h-entry post-text"><header><h1 class="post-title p-name"><a href="posts/ar-er-ir/" class="u-url">Palabras terminadas en "ar", "er" o "ir"</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn">Nicolás Guarín-Zapata</span></p>
            <p class="dateline"><a href="posts/ar-er-ir/" rel="bookmark"><time class="post-date published dt-published" datetime="2013-09-04T01:32:00-05:00" title="2013-09-04 01:32">2013-09-04 01:32</time></a></p>
                <p class="commentline">
    
    <a href="posts/ar-er-ir/#disqus_thread" data-disqus-identifier="cache/posts/ar-er-ir.html">Comments</a>


        </p>
</div>
    </header><div class="e-content entry-content">
    <p>Recuerdo cuando estaba en el colegio que en ocasiones mencionaban las
palabras terminadas en "ar", "er" o "ir" —iguales al final de nuestros
verbos en infinitivo—. Eran pocos ejemplos los que mencionaban, así
que algunos años después me dio el arrebato de hacer una lista… y hela aquí:</p>
<table>
<thead><tr>
<th class="head"><p>AR</p></th>
<th class="head"><p>AR</p></th>
<th class="head"><p>AR</p></th>
<th class="head"><p>ER</p></th>
<th class="head"><p>IR</p></th>
</tr></thead>
<tbody>
<tr>
<td><p>agar</p></td>
<td><p>espectacular</p></td>
<td><p>paramilitar</p></td>
<td><p>alfiler</p></td>
<td><p>cachemir</p></td>
</tr>
<tr>
<td><p>ajuar</p></td>
<td><p>estelar</p></td>
<td><p>particular</p></td>
<td><p>alquiler</p></td>
<td><p>casimir</p></td>
</tr>
<tr>
<td><p>alar</p></td>
<td><p>extracurricular</p></td>
<td><p>peculiar</p></td>
<td><p>amater</p></td>
<td><p>elixir</p></td>
</tr>
<tr>
<td><p>albañar</p></td>
<td><p>familiar</p></td>
<td><p>pendular</p></td>
<td><p>anteayer</p></td>
<td><p>emir</p></td>
</tr>
<tr>
<td><p>albar</p></td>
<td><p>fular</p></td>
<td><p>peninsular</p></td>
<td><p>antier</p></td>
<td><p>faquir</p></td>
</tr>
<tr>
<td><p>alfar</p></td>
<td><p>globular</p></td>
<td><p>perpendicular</p></td>
<td><p>atelier</p></td>
<td><p>kefir</p></td>
</tr>
<tr>
<td><p>alizar</p></td>
<td><p>hangar</p></td>
<td><p>pilar</p></td>
<td><p>ayer</p></td>
<td><p>menhir</p></td>
</tr>
<tr>
<td><p>almiar</p></td>
<td><p>hogar</p></td>
<td><p>pinar</p></td>
<td><p>bachiller</p></td>
<td><p>nadir</p></td>
</tr>
<tr>
<td><p>almimbar</p></td>
<td><p>ijar</p></td>
<td><p>planar</p></td>
<td><p>bereber</p></td>
<td><p>porvenir</p></td>
</tr>
<tr>
<td><p>alminar</p></td>
<td><p>impar</p></td>
<td><p>polar</p></td>
<td><p>brigadier</p></td>
<td><p>sir</p></td>
</tr>
<tr>
<td><p>altar</p></td>
<td><p>insular</p></td>
<td><p>policelular</p></td>
<td><p>canciller</p></td>
<td><p>souvenir</p></td>
</tr>
<tr>
<td><p>alveolar</p></td>
<td><p>intercelular</p></td>
<td><p>pulgar</p></td>
<td><p>cualquier</p></td>
<td><p>visir</p></td>
</tr>
<tr>
<td><p>antealtar</p></td>
<td><p>intraocular</p></td>
<td><p>pulmonar</p></td>
<td><p>doquier</p></td>
<td><p>zafir</p></td>
</tr>
<tr>
<td><p>antisolar</p></td>
<td><p>jaguar</p></td>
<td><p>quasar</p></td>
<td><p>dossier</p></td>
<td></td>
</tr>
<tr>
<td><p>ar</p></td>
<td><p>juglar</p></td>
<td><p>radar</p></td>
<td><p>enser</p></td>
<td></td>
</tr>
<tr>
<td><p>auricular</p></td>
<td><p>lagar</p></td>
<td><p>radicular</p></td>
<td><p>ester</p></td>
<td></td>
</tr>
<tr>
<td><p>avatar</p></td>
<td><p>lanar</p></td>
<td><p>rectangular</p></td>
<td><p>menester</p></td>
<td></td>
</tr>
<tr>
<td><p>axilar</p></td>
<td><p>lar</p></td>
<td><p>reticular</p></td>
<td><p>mercader</p></td>
<td></td>
</tr>
<tr>
<td><p>azahar</p></td>
<td><p>limonar</p></td>
<td><p>samovar</p></td>
<td><p>micer</p></td>
<td></td>
</tr>
<tr>
<td><p>azar</p></td>
<td><p>llar</p></td>
<td><p>secular</p></td>
<td><p>neceser</p></td>
<td></td>
</tr>
<tr>
<td><p>bacillar</p></td>
<td><p>lobular</p></td>
<td><p>seglar</p></td>
<td><p>palier</p></td>
<td></td>
</tr>
<tr>
<td><p>bar</p></td>
<td><p>lodazar</p></td>
<td><p>semicircular</p></td>
<td><p>placer</p></td>
<td></td>
</tr>
<tr>
<td><p>bazar</p></td>
<td><p>lugar</p></td>
<td><p>semilunar</p></td>
<td><p>plumier</p></td>
<td></td>
</tr>
<tr>
<td><p>bicelular</p></td>
<td><p>lunar</p></td>
<td><p>similar</p></td>
<td><p>premier</p></td>
<td></td>
</tr>
<tr>
<td><p>bienestar</p></td>
<td><p>malar</p></td>
<td><p>solar</p></td>
<td><p>primer</p></td>
<td></td>
</tr>
<tr>
<td><p>bifilar</p></td>
<td><p>maleolar</p></td>
<td><p>subcelular</p></td>
<td><p>rosicler</p></td>
<td></td>
</tr>
<tr>
<td><p>biliar</p></td>
<td><p>malvar</p></td>
<td><p>supraclavicular</p></td>
<td><p>salmer</p></td>
<td></td>
</tr>
<tr>
<td><p>billar</p></td>
<td><p>mandibular</p></td>
<td><p>supralunar</p></td>
<td><p>somier</p></td>
<td></td>
</tr>
<tr>
<td><p>binocular</p></td>
<td><p>manglar</p></td>
<td><p>telar</p></td>
<td><p>sumiller</p></td>
<td></td>
</tr>
<tr>
<td><p>bipolar</p></td>
<td><p>manillar</p></td>
<td><p>testicular</p></td>
<td><p>taller</p></td>
<td></td>
</tr>
<tr>
<td><p>broncopulmonar</p></td>
<td><p>manjar</p></td>
<td><p>tisular</p></td>
<td><p>tercer</p></td>
<td></td>
</tr>
<tr>
<td><p>bulevar</p></td>
<td><p>mar</p></td>
<td><p>trifilar</p></td>
<td><p>veguer</p></td>
<td></td>
</tr>
<tr>
<td><p>calamar</p></td>
<td><p>maxilar</p></td>
<td><p>trufar</p></td>
<td></td>
<td></td>
</tr>
<tr>
<td><p>calcañar</p></td>
<td><p>melocotonar</p></td>
<td><p>tubular</p></td>
<td></td>
<td></td>
</tr>
<tr>
<td><p>capilar</p></td>
<td><p>melonar</p></td>
<td><p>tular</p></td>
<td></td>
<td></td>
</tr>
<tr>
<td><p>capsular</p></td>
<td><p>membrillar</p></td>
<td><p>ultramar</p></td>
<td></td>
<td></td>
</tr>
<tr>
<td><p>caviar</p></td>
<td><p>miliar</p></td>
<td><p>uvular</p></td>
<td></td>
<td></td>
</tr>
<tr>
<td><p>celular</p></td>
<td><p>militar</p></td>
<td><p>vascular</p></td>
<td></td>
<td></td>
</tr>
<tr>
<td><p>centenar</p></td>
<td><p>millar</p></td>
<td><p>vehicular</p></td>
<td></td>
<td></td>
</tr>
<tr>
<td><p>ciliar</p></td>
<td><p>molar</p></td>
<td><p>vermicular</p></td>
<td></td>
<td></td>
</tr>
<tr>
<td><p>clavicular</p></td>
<td><p>mollar</p></td>
<td><p>vesicular</p></td>
<td></td>
<td></td>
</tr>
<tr>
<td><p>collar</p></td>
<td><p>monocelular</p></td>
<td><p>vulgar</p></td>
<td></td>
<td></td>
</tr>
<tr>
<td><p>consular</p></td>
<td><p>mular</p></td>
<td><p>yugular</p></td>
<td></td>
<td></td>
</tr>
<tr>
<td><p>coplanar</p></td>
<td><p>muscular</p></td>
<td><p>zar</p></td>
<td></td>
<td></td>
</tr>
<tr>
<td><p>corpuscular</p></td>
<td><p>nuclear</p></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td><p>cuadrangular</p></td>
<td><p>ocular</p></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td><p>cular</p></td>
<td><p>olivar</p></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td><p>curricular</p></td>
<td><p>pajar</p></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td><p>dactilar</p></td>
<td><p>paladar</p></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td><p>dinar</p></td>
<td><p>palatar</p></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td><p>dispar</p></td>
<td><p>palomar</p></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td><p>ejemplar</p></td>
<td><p>papilar</p></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td><p>escolar</p></td>
<td><p>par</p></td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<div class="line-block">
<div class="line"><br></div>
</div>
<p>Si tienes alguna sugerencia de palabra que haga falta la puedes dejar en los
comentarios.</p>
<p>Última actualización: Febrero 2, 2022.</p>
<p>Descargar la lista en formato <a class="reference external" href="downloads/ar_er_ir.csv">CSV</a> o en formato
<a class="reference external" href="downloads/ar_er_ir.xls">XLS</a>.</p>
    </div>
    </article><article class="post h-entry post-text"><header><h1 class="post-title p-name"><a href="posts/teletransportacion-star-trek/" class="u-url">About teleportation in Star Trek</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn">Nicolás Guarín-Zapata</span></p>
            <p class="dateline"><a href="posts/teletransportacion-star-trek/" rel="bookmark"><time class="post-date published dt-published" datetime="2013-04-18T03:40:00-05:00" title="2013-04-18 03:40">2013-04-18 03:40</time></a></p>
                <p class="commentline">
    
    <a href="posts/teletransportacion-star-trek/#disqus_thread" data-disqus-identifier="cache/posts/teletransportacion-star-trek.html">Comments</a>


        </p>
</div>
    </header><div class="e-content entry-content">
    <p>A friend once asked me about which of two methods was easier to
teleport people. One consisted of "deconfiguring" and "reconfiguring"
the person (as information, similar to <a class="reference external" href="http://en.wikipedia.org/wiki/Transporter_%28Star_Trek%29">Start Trek</a>
and the other in "creating a shortcut" between two places in space-time to pass
to the person. Obviously, in both cases assuming that such things can be
done.</p>
<p>Regarding the creation of the shortcut in space-time, I think I have not
studied the equations of General Relativity to be able to do the math,
although perhaps in <a class="reference external" href="http://fisicapasion.blogspot.com/">Física Pasión</a>
give us these calculations.</p>
<p>The first of the alternatives consists of, basically, the representation of a
person as information and its "deconfiguration" processing, transmission and
processing of "reconfiguration". Since as humans we are made, mostly,
of water we will assume a person of water for the calculations. We will also take
as reference mass <span class="math">\(70\, \mbox {kg}\)</span>.</p>
<p>Some data that we will use are:</p>
<ul class="simple">
<li><p>The molar mass of water is <span class="math">\(M_{H_2O}=18,01528\ \mbox{g/mol}\)</span>;</p></li>
<li><p>Avogradro number is <span class="math">\(N_A=6,022 \times 10^{23}/\mbox{mol}\)</span>.</p></li>
</ul>
<p>Then, we have that the number of moles in a person is</p>
<div class="math">
\begin{equation*}
m_\text{persona} = \frac{70\ \mbox{kg}\ \mbox{moles}}
    {18,015\times 10^{-3} \text{kg}}
    =3885,7\ \mbox{moles}\, ,
\end{equation*}
</div>
<p>and the number of molecules is</p>
<div class="math">
\begin{equation*}
N_\text{moleculas} = N_A m_\text{persona} = 2,34\times 10^{27}\ \mbox{moleculas}\, .
\end{equation*}
</div>
<p>Water has 12 vibrational and 6 translational modes, and furthermore 40 quantum
electronic numbers. This add up to 58 degrees of freedom for each molecule.
Thus, the total number of degrees of freedom is</p>
<div class="math">
\begin{equation*}
N_{GDL} = 1,36\times 10^{29}\, .
\end{equation*}
</div>
<p>In 2011 there was a <a class="reference external" href="https://goo.gl/YEvzpM">transmission record</a>
of 186 Gb/s, considering this rate the time it would take to transmit
all data (assuming data represented as 32 bits real numbers)
would take <span class="math">\(2,3 \times 10^{16}\ \mbox {s}\)</span> or, equivalently,
<span class="math">\(1.70 \times 10^{10}\)</span> years (the estimated age of the universe is
<span class="math">\(1.37 \times 10^{10}\)</span> years).</p>
<p>If we wanted this to happen really fast, say in 1 millisecond, the transmission
rate should be <span class="math">\(2.3 \times 10^{19}\)</span> faster than the record they reached
at CERN… something that is inconceivable for us today.</p>
    </div>
    </article>
</div>

        <nav class="postindexpager"><ul class="pager">
<li class="previous">
                <a href="index-2.html" rel="prev">Newer posts</a>
            </li>
        </ul></nav><script>var disqus_shortname="nicoguaro-github";(function(){var a=document.createElement("script");a.async=true;a.src="https://"+disqus_shortname+".disqus.com/count.js";(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(a)}());</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML" integrity="sha384-3lJUsx1TJHt7BA4udB5KPnDrlkO8T6J6v/op7ui0BbCjvZ9WqV4Xm6DTP6kQ/iBH" crossorigin="anonymous"></script><script type="text/x-mathjax-config">
        MathJax.Hub.Config({tex2jax: {inlineMath: [['$latex ','$'], ['\\(','\\)']]}});
        </script><footer id="footer"><p><a href="https://creativecommons.org/licenses/by/4.0/" rel="nofollow">CC BY 4.0</a> © 2022 <a href="mailto:nicoguarin@gmail.com">Nicolás Guarín-Zapata</a>- Powered by <a href="https://getnikola.com" rel="nofollow">Nikola</a></p>
            
        </footer>
</div>
    </div>
    <label for="sidebar-checkbox" class="sidebar-toggle"></label>
    
<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-145359674-1', 'auto');
ga('send', 'pageview');
</script><script src="assets/js/all-nocdn.js"></script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates -->
</body>
</html>
