<!DOCTYPE html>
<html prefix="" lang="en">
<head>
<meta charset="utf-8">
<meta name="description" content="Personal blog and website">
<meta name="viewport" content="width=device-width">
<title>Nicolás' blog | Nicolás' blog</title>
<link href="assets/css/all.css" rel="stylesheet" type="text/css">
<link rel="stylesheet" href="//fonts.googleapis.com/css?family=PT+Serif:400,400italic,700%7CPT+Sans:400">
<link rel="alternate" type="application/rss+xml" title="RSS (en)" href="rss.xml">
<link rel="alternate" type="application/rss+xml" title="RSS (es)" href="es/rss.xml">
<link rel="canonical" href="https://nicoguaro.github.io/">
<link rel="next" href="index-5.html" type="text/html">
<!--[if lt IE 9]><script src="assets/js/html5.js"></script><![endif]--><link rel="prefetch" href="posts/tech_writing_math/" type="text/html">
</head>
<body>
    <a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>
    <!-- Target for toggling the sidebar `.sidebar-checkbox` is for regular
            styles, `#sidebar-checkbox` for behavior. -->
    <input type="checkbox" class="sidebar-checkbox" id="sidebar-checkbox"><!-- Toggleable sidebar --><div class="sidebar" id="sidebar">
        <div class="sidebar-item">
            <p>A reserved <a href="https://getnikola.com" target="_blank">Nikola</a> theme that places the utmost gravity on content with a hidden drawer. Made by <a href="https://twitter.com/mdo" target="_blank">@mdo</a> for Jekyll,
            ported to Nikola by <a href="https://twitter.com/ralsina" target="_blank">@ralsina</a>.</p>
        </div>
        
    <nav id="menu" role="navigation" class="sidebar-nav"><a class="sidebar-nav-item" href="pages/about/">About</a>
        <a class="sidebar-nav-item" href="#">Blog</a>
        <a class="sidebar-nav-item" href="pages/preprints-archive/">Preprints</a>
        <a class="sidebar-nav-item" href="pages/links/">Links</a>
        <a class="sidebar-nav-item" href="archive.html">Archive</a>
        <a class="sidebar-nav-item" href="categories/">Tags</a>
        <a class="sidebar-nav-item" href="rss.xml">RSS feed</a>
    
    
    </nav>
</div>

    <!-- Wrap is the content to shift when toggling the sidebar. We wrap the
         content to avoid any CSS collisions with our real content. -->
    <div class="wrap">
      <div class="masthead">
        <div class="container">
          
    <h3 id="brand" class="masthead-title">
      <a href="https://nicoguaro.github.io/" title="Nicolás' blog" rel="home">Nicolás' blog</a>
    </h3>

        </div>
      </div>

      <div class="container content" id="content">
        

<div class="posts">
    <article class="post h-entry post-text"><header><h1 class="post-title p-name"><a href="posts/tech_writing_math/" class="u-url">Technical writing: using math</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn">Nicolás Guarín-Zapata</span></p>
            <p class="dateline"><a href="posts/tech_writing_math/" rel="bookmark"><time class="post-date published dt-published" datetime="2020-08-02T18:00:00-05:00" title="2020-08-02 18:00">2020-08-02 18:00</time></a></p>
                <p class="commentline">
        
    <a href="posts/tech_writing_math/#disqus_thread" data-disqus-identifier="cache/posts/tech_writing_math.html">Comments</a>


        </p>
</div>
    </header><div class="e-content entry-content">
    <div>
<p>In a <a class="reference external" href="posts/tech_writing">previous post</a> I mentioned some general aspects of
technical writing. In this one, I would like to talk about including
mathematical expressions in technical documents.</p>
<p>There are two main ways to include math in your documents:</p>
<ul class="simple">
<li><p>using text; and</p></li>
<li><p>using a graphic interface.</p></li>
</ul>
<p>Using a graphic interface, such as the equation editor in
LibreOffice Writer or MS Word, or
<a class="reference external" href="http://www.dessci.com/en/products/mathtype/">MathType</a> is convenient.
You don't need to memorize anything and you can look at your expressions
while creating them. Nevertheless, it can be slow compared to using text
input — once you are comfortable with the syntax.</p>
<p>There are two main flavors of equations used over the internet:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://en.wikipedia.org/wiki/MathML">MathML</a> is a
<a class="reference external" href="https://en.wikipedia.org/wiki/World_Wide_Web_Consortium">W3C standard</a>
for equations and it is included in HTML5, so it would work in all
modern browsers. The problem with it is that it is not designed to be
written by hand. So one can use it if have some automatic way of generating
the code.</p></li>
<li><p><a class="reference external" href="https://www.overleaf.com/learn/latex/Mathematical_expressions">LaTeX</a>
is my suggested way to write equations. The learning curve might be a
little bit steep at the beginning but it pays off.</p></li>
</ul>
<p>One tool that helps with equations is <a class="reference external" href="https://mathpix.com/">MathPix Snip</a>
that automatically generates LaTeX or MathML code from an image, even a
handwritten one. Another tool that is really useful is
<a class="reference external" href="http://detexify.kirelabs.org/classify.html">Detexify</a> that let you
draw a symbol and gives you the LaTeX syntax for it.</p>
<p>In the remaining of the posts I will show my suggestions for working
with equations in LibreOffice and MS Word. If you are using LaTeX or
MarkDown/ReStructuredText for your documents you are already using
LaTeX for your equations.</p>
<div class="section" id="libreoffice">
<h2>LibreOffice</h2>
<p>LibreOffice has its own math editor with its own syntax and it works
fine for small expressions, but it gets complicated for large equations or
long algebraic manipulations. For LibreOffice I would suggest to use
<a class="reference external" href="http://roland65.free.fr/texmaths/install.html">TexMaths</a>, it is simple to
use and works for the word processor (Writer) and presentations (Impress).
I suppose it also works for spreadsheets (Calc), but I don't remember
using equations in one.</p>
</div>
<div class="section" id="ms-office">
<h2>MS Office</h2>
<p>MS Office has its own math editor as well, it works fine and is easy to use.
Nevertheless, the same problem appears when you want long expressions.
One option is to directly use
<a class="reference external" href="https://docs.microsoft.com/en-us/archive/blogs/murrays/latex-math-in-office">LaTeX in Office</a>
but I prefer to use <a class="reference external" href="http://www.jonathanleroux.org/software/iguanatex/download.html">IguanaTex</a>.
It is a complement that allows to input equations similarly to TexMaths in
LibreOffice.</p>
<p>You could also directly paste MathML equations into MS Word (&gt;2013 and Windows).</p>
</div>
<div class="section" id="use-a-sympy">
<h2>Use a SymPy</h2>
<p>Indepent of the tool that you use to write your documents I strongly suggest
to use a <a class="reference external" href="https://en.wikipedia.org/wiki/Computer_algebra_system">CAS</a>
(Computer Algebra System), such as Mathematica or SymPy. These programs
have automatic generation of LaTeX and MathML from expression and that can
ease the process a lot.</p>
<p>Let's check an example. Suppose that we have the function</p>
<div class="math">
\begin{equation*}
f(x) = \exp(-x^2) \sin(3*x)
\end{equation*}
</div>
<p>and we want to compute its second derivative</p>
<div class="math">
\begin{equation*}
f''(x) = \left(- 12 x \cos{\left(3 x \right)} + 2 \left(2 x^{2} - 1\right) \sin{\left(3 x \right)} - 9 \sin{\left(3 x \right)}\right) e^{- x^{2}}
\end{equation*}
</div>
<p>The following code gives us the LaTex code</p>
<pre class="code python"><a name="rest_code_5b9b3b26a6bf474592a035111b0921a0-1"></a><span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="o">*</span>
<a name="rest_code_5b9b3b26a6bf474592a035111b0921a0-2"></a><span class="n">init_session</span><span class="p">()</span>
<a name="rest_code_5b9b3b26a6bf474592a035111b0921a0-3"></a><span class="n">f</span> <span class="o">=</span> <span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="p">)</span>
<a name="rest_code_5b9b3b26a6bf474592a035111b0921a0-4"></a><span class="n">fxx</span> <span class="o">=</span> <span class="n">diff</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<a name="rest_code_5b9b3b26a6bf474592a035111b0921a0-5"></a><span class="nb">print</span><span class="p">(</span><span class="n">latex</span><span class="p">(</span><span class="n">fxx</span><span class="p">))</span>
</pre>
<p>that is</p>
<pre class="code latex"><a name="rest_code_a04bb05aa97e4c75895084c622c13d6f-1"></a><span class="k">\left</span>(- 12 x <span class="k">\cos</span><span class="nb">{</span><span class="k">\left</span>(3 x <span class="k">\right</span>)<span class="nb">}</span> + 2 <span class="k">\left</span>(2 x<span class="nb">^{</span>2<span class="nb">}</span> - 1<span class="k">\right</span>) <span class="k">\sin</span><span class="nb">{</span><span class="k">\left</span>(3 x <span class="k">\right</span>)<span class="nb">}</span> - 9 <span class="k">\sin</span><span class="nb">{</span><span class="k">\left</span>(3 x <span class="k">\right</span>)<span class="nb">}</span><span class="k">\right</span>) e<span class="nb">^{</span>- x<span class="nb">^{</span>2<span class="nb">}}</span>
</pre>
<p>That corresponds to the code that I used above to render the equation</p>
<p>If, we wanted the MathML code of that expression we could use
the following snippet</p>
<pre class="code python"><a name="rest_code_c472f6ce0e8342c583f9240bfc1b7acc-1"></a><span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="o">*</span>
<a name="rest_code_c472f6ce0e8342c583f9240bfc1b7acc-2"></a><span class="n">init_session</span><span class="p">()</span>
<a name="rest_code_c472f6ce0e8342c583f9240bfc1b7acc-3"></a><span class="n">f</span> <span class="o">=</span> <span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="p">)</span>
<a name="rest_code_c472f6ce0e8342c583f9240bfc1b7acc-4"></a><span class="n">fxx</span> <span class="o">=</span> <span class="n">diff</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<a name="rest_code_c472f6ce0e8342c583f9240bfc1b7acc-5"></a><span class="nb">print</span><span class="p">(</span><span class="n">mathml</span><span class="p">(</span><span class="n">fxx</span><span class="p">,</span> <span class="n">printer</span><span class="o">=</span><span class="s2">"presentation"</span><span class="p">))</span>
</pre>
<p>notice the extra argument <code class="docutils literal"><span class="pre">printer="presentation"</span></code>. If we want to add
this to MS Word, for example, we could add the output (that I will not
show because is really long) inside the following</p>
<pre class="code xml"><a name="rest_code_eda8bbe97ce944539a81231cd343a5b8-1"></a><span class="nt">&lt;math</span> <span class="na">xmlns =</span> <span class="s">"http://www.w3.org/1998/Math/MathML"</span><span class="nt">&gt;</span>
<a name="rest_code_eda8bbe97ce944539a81231cd343a5b8-2"></a><span class="nt">&lt;/math&gt;</span>
</pre>
<p>When using Jupyter Notebook this can be done graphically with a
right click over the expression. Then, the following menu is
shown</p>
<img alt="/images/jupyter_export_eqs.png" src="images/jupyter_export_eqs.png">
</div>
<div class="section" id="references">
<h2>References</h2>
<ol class="arabic simple">
<li><p>“How to Insert Equations in Microsoft Word.” WikiHow,
<a class="reference external" href="https://www.wikihow.com/Insert-Equations-in-Microsoft-Word">https://www.wikihow.com/Insert-Equations-in-Microsoft-Word</a>.
Accessed 3 Aug. 2020.</p></li>
<li><p>“Copy MathML into Word to Use as Equation.” Stack Overflow,
<a class="reference external" href="https://stackoverflow.com/questions/25430775/copy-mathml-into-word-to-use-as-equation">https://stackoverflow.com/questions/25430775/copy-mathml-into-word-to-use-as-equation</a>.
Accessed 3 Aug. 2020.</p></li>
<li><p>“Python - Output Sympy Equation to Word Using Mathml.” Stack Overflow,
<a class="reference external" href="https://stackoverflow.com/questions/40921128/output-sympy-equation-to-word-using-mathml">https://stackoverflow.com/questions/40921128/output-sympy-equation-to-word-using-mathml</a>.
Accessed 3 Aug. 2020.</p></li>
<li><p>OERPUB (2016), “Mathconverter”, <a class="reference external" href="https://github.com/oerpub/mathconverter">https://github.com/oerpub/mathconverter</a>,
Accesed 3 Aug. 2020.</p></li>
</ol>
</div>
</div>
    </div>
    </article><article class="post h-entry post-text"><header><h1 class="post-title p-name"><a href="posts/download_stream/" class="u-url">Downloading videos from MS Stream</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn">Nicolás Guarín-Zapata</span></p>
            <p class="dateline"><a href="posts/download_stream/" rel="bookmark"><time class="post-date published dt-published" datetime="2020-06-12T15:31:22-05:00" title="2020-06-12 15:31">2020-06-12 15:31</time></a></p>
                <p class="commentline">
        
    <a href="posts/download_stream/#disqus_thread" data-disqus-identifier="cache/posts/download_stream.html">Comments</a>


        </p>
</div>
    </header><div class="e-content entry-content">
    <div>
<p>This week a student asked me about downloading the videos from one of the
courses from MS Stream. The problem is that if you are not a proprietary
of the video you cannot download it. So, I will show you an option to
download videos without being a proprietary of them.</p>
<p><strong>Disclaimer:</strong> It might be a good idea if you ask your organization about
the copyright of the videos.</p>
<div class="section" id="prerequisites">
<h2>Prerequisites</h2>
<p>You will need the following:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://git-scm.com/downloads">git</a>;</p></li>
<li><p><a class="reference external" href="https://www.ffmpeg.org/download.html">ffmpeg</a>; and</p></li>
<li><p><a class="reference external" href="https://nodejs.org/en/download/">Node.js</a>.</p></li>
</ul>
</div>
<div class="section" id="destreamer-installation">
<h2>
<code class="docutils literal">destreamer</code> installation</h2>
<p>After getting the prerequisites you can download
<a class="reference external" href="https://github.com/snobu/destreamer">destreamer</a> using</p>
<pre class="code bash"><a name="rest_code_c8b37c61b8ea43afae7909d8037c3978-1"></a>$ git clone https://github.com/snobu/destreamer
<a name="rest_code_c8b37c61b8ea43afae7909d8037c3978-2"></a>$ <span class="nb">cd</span> destreamer
<a name="rest_code_c8b37c61b8ea43afae7909d8037c3978-3"></a>$ npm install
<a name="rest_code_c8b37c61b8ea43afae7909d8037c3978-4"></a>$ npm run build
</pre>
<p>in a terminal.</p>
<p>If you do not want to play with
<a class="reference external" href="https://en.wikipedia.org/wiki/Environment_variable">environment variables</a>,
I suggest that you just add <code class="docutils literal">ffmpeg</code> to the same folder as <code class="docutils literal">destreamer</code>.</p>
</div>
<div class="section" id="downloading">
<h2>Downloading</h2>
<p>After that, you need to navigate to the folder where you downloaded
<code class="docutils literal">destreamer</code> and</p>
<pre class="code bash"><a name="rest_code_2a825c7ad8e74187bb7d9bce84a19ae9-1"></a>$ ./destreamer.sh -i <span class="s2">"https://web.microsoftstream.com/video/VIDEO_ID"</span>
</pre>
<p>in Mac or Linux,</p>
<pre class="code bash"><a name="rest_code_7513208a26ee4b8587efe71fc4e7c17c-1"></a>$ destreamer.cmd -i <span class="s2">"https://web.microsoftstream.com/video/VIDEO_ID"</span>
</pre>
<p>in the command prompt in Windows, and</p>
<pre class="code bash"><a name="rest_code_c0ca588272544cc2a45dc0b574b9706f-1"></a>$ destreamer.ps1 -i <span class="s2">"https://web.microsoftstream.com/video/VIDEO_ID"</span>
</pre>
<p>in PowerShell.``VIDEO_ID`` refers to the identifier in MS Stream.</p>
<p>If you want to download several files (like a complete course), you
can create a file with the URLs and use</p>
<pre class="code bash"><a name="rest_code_6ac5f8411f454aaab9a974bb928757ed-1"></a>$ destreamer.cmd -f filename.txt
</pre>
</div>
</div>
    </div>
    </article><article class="post h-entry post-text"><header><h1 class="post-title p-name"><a href="posts/marking-tetrahedron/" class="u-url">Randomized Marking of a Tetrahedron</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn">Nicolás Guarín-Zapata</span></p>
            <p class="dateline"><a href="posts/marking-tetrahedron/" rel="bookmark"><time class="post-date published dt-published" datetime="2020-06-05T22:58:32-05:00" title="2020-06-05 22:58">2020-06-05 22:58</time></a></p>
                <p class="commentline">
        
    <a href="posts/marking-tetrahedron/#disqus_thread" data-disqus-identifier="cache/posts/marking-tetrahedron.html">Comments</a>


        </p>
</div>
    </header><div class="e-content entry-content">
    <div>
<p>Yesterday (June 4, 2020), Christian Howard posted on
<a class="reference external" href="https://twitter.com/choward1491/status/1268736220055699457">Twitter</a>
the following question</p>
<blockquote>
<p>You are given a tetrahedron τ. For each triangular facet of τ,
we uniformly at random mark one of their edges. What is the
probability that there exists an edge of τ that is marked twice?</p>
</blockquote>
<p>I thought about a little bit but I couldn't find how to count
properly. Then, a number popped up in my mind out of the blue:
<span class="math">\(2/3\)</span>, but I don't know why. So, I decided to run a
simulation to check this number.</p>
<p>The right answer is <span class="math">\(51/81\)</span> that is approximately 63%. This
calculation is well explained in
<a class="reference external" href="https://medium.com/@choward1491/randomized-marking-of-a-tetrahedron-f978593f43d2">Christian's blog</a>
and with some cool drawings (and memes).</p>
<div class="section" id="the-algorithm">
<h2>The algorithm</h2>
<p>The algorithm is quite simple. I number the edges in each face following
a counter-clockwise orientation:</p>
<ul class="simple">
<li><p><strong>face 0</strong>: edge 0, edge 1, edge 2</p></li>
<li><p><strong>face 1</strong>: edge 0, edge 3, edge 4</p></li>
<li><p><strong>face 2</strong>: edge 1, edge 5, edge 3</p></li>
<li><p><strong>face 3</strong>: edge 2, edge 4, edge 5</p></li>
</ul>
<p>Then, I take each face and pick a random number from <span class="math">\((0, 1, 2)\)</span> and
mark the corresponding edge, and move to the following face. I repeat
this process several times and I count the favorable cases and divide
them by the number of trials to get an estimate of the probability.</p>
<p>Following is a Python code that follows this idea.</p>
<pre class="code python"><a name="rest_code_b274c9bf311f497982915bdbcc72bd3d-1"></a><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<a name="rest_code_b274c9bf311f497982915bdbcc72bd3d-2"></a><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<a name="rest_code_b274c9bf311f497982915bdbcc72bd3d-3"></a>
<a name="rest_code_b274c9bf311f497982915bdbcc72bd3d-4"></a><span class="n">faces</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
<a name="rest_code_b274c9bf311f497982915bdbcc72bd3d-5"></a>        <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
<a name="rest_code_b274c9bf311f497982915bdbcc72bd3d-6"></a>        <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
<a name="rest_code_b274c9bf311f497982915bdbcc72bd3d-7"></a>        <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
<a name="rest_code_b274c9bf311f497982915bdbcc72bd3d-8"></a>        <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]])</span>
<a name="rest_code_b274c9bf311f497982915bdbcc72bd3d-9"></a>
<a name="rest_code_b274c9bf311f497982915bdbcc72bd3d-10"></a>
<a name="rest_code_b274c9bf311f497982915bdbcc72bd3d-11"></a><span class="k">def</span> <span class="nf">mark_edges</span><span class="p">():</span>
<a name="rest_code_b274c9bf311f497982915bdbcc72bd3d-12"></a>    <span class="n">marked_edges</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">6</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
<a name="rest_code_b274c9bf311f497982915bdbcc72bd3d-13"></a>    <span class="k">for</span> <span class="n">face</span> <span class="ow">in</span> <span class="n">faces</span><span class="p">:</span>
<a name="rest_code_b274c9bf311f497982915bdbcc72bd3d-14"></a>        <span class="n">num</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<a name="rest_code_b274c9bf311f497982915bdbcc72bd3d-15"></a>        <span class="n">edge</span> <span class="o">=</span> <span class="n">face</span><span class="p">[</span><span class="n">num</span><span class="p">]</span>
<a name="rest_code_b274c9bf311f497982915bdbcc72bd3d-16"></a>        <span class="n">marked_edges</span><span class="p">[</span><span class="n">edge</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
<a name="rest_code_b274c9bf311f497982915bdbcc72bd3d-17"></a>    <span class="k">return</span> <span class="n">marked_edges</span>
<a name="rest_code_b274c9bf311f497982915bdbcc72bd3d-18"></a>
<a name="rest_code_b274c9bf311f497982915bdbcc72bd3d-19"></a>
<a name="rest_code_b274c9bf311f497982915bdbcc72bd3d-20"></a><span class="k">def</span> <span class="nf">comp_probs</span><span class="p">(</span><span class="n">N_min</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">N_max</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">ntrials</span><span class="o">=</span><span class="mi">100</span><span class="p">):</span>
<a name="rest_code_b274c9bf311f497982915bdbcc72bd3d-21"></a>    <span class="n">prob</span> <span class="o">=</span> <span class="p">[]</span>
<a name="rest_code_b274c9bf311f497982915bdbcc72bd3d-22"></a>    <span class="n">N_vals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="n">N_min</span><span class="p">,</span> <span class="n">N_max</span><span class="p">,</span> <span class="n">ntrials</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
<a name="rest_code_b274c9bf311f497982915bdbcc72bd3d-23"></a>    <span class="k">for</span> <span class="n">N</span> <span class="ow">in</span> <span class="n">N_vals</span><span class="p">:</span>
<a name="rest_code_b274c9bf311f497982915bdbcc72bd3d-24"></a>        <span class="n">cont_marked</span> <span class="o">=</span> <span class="mi">0</span>
<a name="rest_code_b274c9bf311f497982915bdbcc72bd3d-25"></a>        <span class="k">for</span> <span class="n">cont</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
<a name="rest_code_b274c9bf311f497982915bdbcc72bd3d-26"></a>            <span class="n">marked</span> <span class="o">=</span> <span class="n">mark_edges</span><span class="p">()</span>
<a name="rest_code_b274c9bf311f497982915bdbcc72bd3d-27"></a>            <span class="k">if</span> <span class="mi">2</span> <span class="ow">in</span> <span class="n">marked</span><span class="p">:</span>
<a name="rest_code_b274c9bf311f497982915bdbcc72bd3d-28"></a>                <span class="n">cont_marked</span> <span class="o">+=</span> <span class="mi">1</span>
<a name="rest_code_b274c9bf311f497982915bdbcc72bd3d-29"></a>        <span class="n">prob</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cont_marked</span><span class="o">/</span><span class="n">N</span><span class="p">)</span>
<a name="rest_code_b274c9bf311f497982915bdbcc72bd3d-30"></a>    <span class="k">return</span> <span class="n">N_vals</span><span class="p">,</span> <span class="n">prob</span>
<a name="rest_code_b274c9bf311f497982915bdbcc72bd3d-31"></a>
<a name="rest_code_b274c9bf311f497982915bdbcc72bd3d-32"></a>
<a name="rest_code_b274c9bf311f497982915bdbcc72bd3d-33"></a><span class="c1">#%% Computation</span>
<a name="rest_code_b274c9bf311f497982915bdbcc72bd3d-34"></a><span class="n">N_min</span> <span class="o">=</span> <span class="mi">1</span>
<a name="rest_code_b274c9bf311f497982915bdbcc72bd3d-35"></a><span class="n">N_max</span> <span class="o">=</span> <span class="mi">5</span>
<a name="rest_code_b274c9bf311f497982915bdbcc72bd3d-36"></a><span class="n">ntrials</span> <span class="o">=</span> <span class="mi">100</span>
<a name="rest_code_b274c9bf311f497982915bdbcc72bd3d-37"></a><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<a name="rest_code_b274c9bf311f497982915bdbcc72bd3d-38"></a><span class="n">N_vals</span><span class="p">,</span> <span class="n">prob</span> <span class="o">=</span> <span class="n">comp_probs</span><span class="p">(</span><span class="n">N_min</span><span class="p">,</span> <span class="n">N_max</span><span class="p">,</span> <span class="n">ntrials</span><span class="p">)</span>
<a name="rest_code_b274c9bf311f497982915bdbcc72bd3d-39"></a>
<a name="rest_code_b274c9bf311f497982915bdbcc72bd3d-40"></a><span class="c1">#%% Plotting</span>
<a name="rest_code_b274c9bf311f497982915bdbcc72bd3d-41"></a><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<a name="rest_code_b274c9bf311f497982915bdbcc72bd3d-42"></a><span class="n">plt</span><span class="o">.</span><span class="n">hlines</span><span class="p">(</span><span class="mf">0.63</span><span class="p">,</span> <span class="mi">10</span><span class="o">**</span><span class="n">N_min</span><span class="p">,</span> <span class="mi">10</span><span class="o">**</span><span class="n">N_max</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">"#3f3f3f"</span><span class="p">)</span>
<a name="rest_code_b274c9bf311f497982915bdbcc72bd3d-43"></a><span class="n">plt</span><span class="o">.</span><span class="n">semilogx</span><span class="p">(</span><span class="n">N_vals</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">prob</span><span class="p">),</span> <span class="s2">"o"</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<a name="rest_code_b274c9bf311f497982915bdbcc72bd3d-44"></a><span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">"Number of trials"</span><span class="p">)</span>
<a name="rest_code_b274c9bf311f497982915bdbcc72bd3d-45"></a><span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">"Estimated probability"</span><span class="p">)</span>
<a name="rest_code_b274c9bf311f497982915bdbcc72bd3d-46"></a><span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">"prob_tet.svg"</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s2">"tight"</span><span class="p">)</span>
<a name="rest_code_b274c9bf311f497982915bdbcc72bd3d-47"></a><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre>
<p>And we can see the following evolution for different number of trials.</p>
<img alt="Estimated probabilities for different sample sizes." class="align-center" src="images/marked_tets.svg" style="width: 600px;">
</div>
</div>
    </div>
    </article><article class="post h-entry post-text"><header><h1 class="post-title p-name"><a href="posts/tech_writing/" class="u-url">Technical writing</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn">Nicolás Guarín-Zapata</span></p>
            <p class="dateline"><a href="posts/tech_writing/" rel="bookmark"><time class="post-date published dt-published" datetime="2020-05-28T15:53:40-05:00" title="2020-05-28 15:53">2020-05-28 15:53</time></a></p>
                <p class="commentline">
        
    <a href="posts/tech_writing/#disqus_thread" data-disqus-identifier="cache/posts/tech_writing.html">Comments</a>


        </p>
</div>
    </header><div class="e-content entry-content">
    <div>
<p>This is the first post about technical writing <a class="footnote-reference brackets" href="posts/tech_writing/#id2" id="id1">*</a> from a series that
I will be creating during the course of this year. Technical writing is
something that most of us have to deal with in different contexts. For
example, in college coursework, research publications, software documentation.
The main idea of the series is to mention some of the tricks that I have
learned over the years and some tools that might come in handy.</p>
<p>Future posts will (probably) be about:</p>
<ul class="simple">
<li><p><a class="reference external" href="posts/tech_writing_math">Using equations</a>;</p></li>
<li><p>Using figures;</p></li>
<li><p>Using tables; and</p></li>
<li><p>Managing bibliographic references.</p></li>
</ul>
<div class="section" id="the-current-post">
<h2>The current post</h2>
<p>As mentioned above, technical writing is something that a lot of persons
have to deal with. This is a skill that is sometimes overlooked,
but it should not. According to the
<a class="reference external" href="https://www.bls.gov/ooh/media-and-communication/technical-writers.htm">U.S. Bureau of Labor Statistics</a></p>
<blockquote>
<p>Technical writers prepare instruction manuals, how-to guides,
journal articles, and other supporting documents to communicate complex and
technical information more easily.</p>
</blockquote>
<p>And it is a desired skill in the workplace. Its demand is expected to grow
around 10% in the current decade.</p>
<div class="section" id="typography">
<h3>Typography</h3>
<p>The first thing that I should mention is that writing documents is
typography. "Putting documents" together is typography because
we are <em>designing with text</em> (Butterick, 2019). So, we should consider
ourselves typographers since we are constantly designing documents.</p>
<p>I would suggest taking a look at "Butterick's Practical Typography"
since it is a really good book about it and it reads smoothly. I will
mention some important points here according to Butterick's
"Typography in ten minutes":</p>
<ol class="arabic">
<li><p>The most important typographic selection is on the body text.
This is due to the fact that it is most of the document.</p></li>
<li><p>Choose a point size between 10-12 points for printed documents
and 15-25 pixels for digital documents.</p></li>
<li><p>Line spacing should be between 120-145 % of the point size.</p></li>
<li>
<p>Line length should be between 45-90 characters. This is roughly
2 or 3 small caps alphabets:</p>
<p>abcdefghijklmnopqrstuvwxyzabcdefghijklmnopqrstuvwxyzabcd</p>
</li>
<li><p>Mind the selection of your font. Try to avoid default fonts such as
Arial, Calibri or Times New Roman.</p></li>
</ol>
</div>
<div class="section" id="editors">
<h3>Editors</h3>
<p>Another point that I want to touch in this post is about editors. The first
question that arises is "what editor should I use?". The short answer is:
<strong>use whatever your peers are using</strong>. That's my best advice; that way you
have people to discuss with you about your doubts.</p>
<p>The long answer … is that each editor has its weak and strong points. I
have written scientific papers in LaTeX, LibreOffice Writer and MS Word;
all of them look professional. So, in the end, you can write your
documents in several ways and achieve a similar result. I prefer to use
LaTeX for long documents since it is centered in the structure of the
document instead of the appearance and this is the way one should manage
a long document like a dissertation, in my opinion.</p>
<p>If you just want me to pick one editor and suggest it to you, I would
say that you should ride with <a class="reference external" href="https://www.libreoffice.org/">LibreOffice</a>.
A good reference for it is "Designing with LibreOffice". Once you learn
how to use styles you will ask how have you been writing documents all
this time.</p>
<p>There are two main flavors for editors that I am going to discuss:
WYSIWYG (What You See Is What You Get) and markup-based editors.</p>
<ul>
<li>
<p>WYSIWYG. This category is the one that most people is familiar with.
Two examples are:</p>
<ul class="simple">
<li><p>LibreOffice writer; and</p></li>
<li><p>Microsoft Word.</p></li>
</ul>
</li>
<li>
<p>Markup-based editors rely on marks on the "text" to differentiate
sections and styles. In this case, your text looks like code, as seen
in the following image</p>
<img alt="/images/rst_code.png" src="images/rst_code.png"><p>Some examples are:</p>
<ul class="simple">
<li><p>LaTeX;</p></li>
<li><p><a class="reference external" href="https://www.markdownguide.org/getting-started">Markdown</a>; and</p></li>
<li><p><a class="reference external" href="https://docutils.sourceforge.io/rst.html">reStructuredtext</a>.</p></li>
</ul>
</li>
</ul>
<p>Independently of what your main editor is I suggest that you use
<a class="reference external" href="https://pandoc.org/">Pandoc</a>. It allows you to convert between several
formats, making the process a little bit easier. There is even an editor
based completely on it named <a class="reference external" href="https://panwriter.com/">Panwriter</a>.</p>
</div>
<div class="section" id="references">
<h3>References</h3>
<ol class="arabic simple">
<li><p>Matthew Butterick (2019). <a class="reference external" href="https://practicaltypography.com/">Butterick's Practical Typography</a>.
Second edition, Matthew Butterick.</p></li>
<li><p>Wikibooks contributors. (2020). <a class="reference external" href="https://en.wikibooks.org/wiki/LaTeX">LaTeX</a>.
Wikibooks, The Free Textbook Project.</p></li>
<li><p>Bruce Byfield (2016). <a class="reference external" href="https://designingwithlibreoffice.com/">Designing with LibreOffice</a>.
Friends of OpenDocument, Inc.</p></li>
<li><p>Deville, S. (2015).
<a class="reference external" href="https://sylvaindeville.net/2015/07/17/writing-academic-papers-in-plain-text-with-markdown-and-jupyter-notebook/">Writing academic papers in plain text with Markdown and Jupyter notebook</a>.
Sylvain Deville.</p></li>
</ol>
<dl class="footnote brackets">
<dt class="label" id="id2"><span class="brackets"><a class="fn-backref" href="posts/tech_writing/#id1">*</a></span></dt>
<dd>
<p>This post is (somewhat) related to a
<a class="reference external" href="posts/herramientas-investigacion/">previous post</a>
where I discussed research tools that most of us need but are not
commonly taught in a formal fashion.</p>
</dd>
</dl>
</div>
</div>
</div>
    </div>
    </article><article class="post h-entry post-text"><header><h1 class="post-title p-name"><a href="posts/ortografia_jupyter/" class="u-url">Revisión ortográfica en Jupyter Notebook</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn">Nicolás Guarín-Zapata</span></p>
            <p class="dateline"><a href="posts/ortografia_jupyter/" rel="bookmark"><time class="post-date published dt-published" datetime="2019-08-20T14:45:41-05:00" title="2019-08-20 14:45">2019-08-20 14:45</time></a></p>
                <p class="commentline">
        
    <a href="posts/ortografia_jupyter/#disqus_thread" data-disqus-identifier="cache/posts/ortografia_jupyter.html">Comments</a>


        </p>
</div>
    </header><div class="e-content entry-content">
    <div>
<p>El objetivo de esta publicación es mostrar cómo tener revisión automática
de ortografía en Jupyter Notebook <a class="footnote-reference brackets" href="posts/ortografia_jupyter/#id2" id="id1">*</a> para español, como se muestra a
continuación.</p>
<img alt="Ejemplo de corrección ortográfica en Jupyter Notebook." class="align-center" src="images/ortografia_jupyter/ejemplo_ortografia.png" style="width: 600px;"><p>Existen <a class="reference external" href="https://stackoverflow.com/q/39324039/3358223">varias formas</a> de
realizar esto. Sin embargo, la forma más fácil es a través del complemento
(<em>nbextension</em>) <a class="reference external" href="posts/ortografia_jupyter/&lt;https:/jupyter-contrib-nbextensions.readthedocs.io/en/latest/nbextensions/spellchecker/README.html">Spellchecker</a>.</p>
<div class="section" id="paso-a-paso">
<h2>Paso a paso</h2>
<p>Los pasos a seguir son los siguientes:</p>
<ol class="arabic simple">
<li><p>Instalar Jupyter notebook extensions (<a class="reference external" href="https://github.com/ipython-contrib/jupyter_contrib_nbextensions">nbextensions</a>). Este incluye
<a class="reference external" href="posts/ortografia_jupyter/&lt;https:/jupyter-contrib-nbextensions.readthedocs.io/en/latest/nbextensions/spellchecker/README.html">Spellchecker</a>.</p></li>
<li><p>Ubicar los diccionarios en la carpeta donde está el complemento. Los
diccionarios deben usar la codificación UTF-8.</p></li>
<li><p>Configurar la ruta de los diccionarios. Esta puede ser una URL o
una ruta relativa respecto a la carpeta en donde se encuentra el complemento.</p></li>
</ol>
<p>A continuación describiremos en detalle cada paso.</p>
<div class="section" id="paso-1-instalacion-de-nbextensions">
<h3>Paso 1: Instalación de nbextensions</h3>
<p>Existe una lista de complementos que agregan algunas funcionalidades
comúnmente usadas a Jupyter notebook.</p>
<p>Escriba lo siguiente en una terminal, para instalarlo usando PIP.</p>
<pre class="code bash"><a name="rest_code_7dc72b42981440ab87728fcf2da08f17-1"></a>pip install jupyter_contrib_nbextensions
</pre>
<p>Sin embargo, si se está usando Anaconda el <strong>método recomendado</strong> es usar
<code class="docutils literal">conda</code>, como se muestra a continuación.</p>
<pre class="code bash"><a name="rest_code_26e0b3c5920847989483161dd91d8d83-1"></a>conda install -c conda-forge jupyter_contrib_nbextensions
</pre>
<p>Esto debe instalar los complementos y también la
<a class="reference external" href="https://github.com/Jupyter-contrib/jupyter_nbextensions_configurator">interfaz de configuración</a>.
En el menú principal de Jupyter notebook aparecerá una nueva pestaña
nombrada <em>Nbextensions</em> en donde se pueden elegir los complementos a usar.
La apariencia es la siguiente.</p>
<img alt="Interfaz gráfica para los complementos de Jupyter." class="align-center" src="images/ortografia_jupyter/interfaz_nbextensions.png" style="width: 600px;"><p>Algunos complementos recomendados son:</p>
<ul class="simple">
<li><p><strong>Collapsible Headings:</strong> que permite ocultar secciones de los documentos.</p></li>
<li><p><strong>RISE:</strong> que convierte los notebooks en presentaciones.</p></li>
</ul>
</div>
<div class="section" id="paso-2-diccionarios-para-espanol">
<h3>Paso 2: Diccionarios para español</h3>
<p>La documentación de <a class="reference external" href="posts/ortografia_jupyter/&lt;https:/jupyter-contrib-nbextensions.readthedocs.io/en/latest/nbextensions/spellchecker/README.html">Spellchecker</a> sugiere usar un script de Python para
descargar diccionarios del proyecto <a class="reference external" href="https://chromium.googlesource.com/chromium/deps/hunspell_dictionaries/+/master">Chromium</a>.
Sin embargo, estos tienen como codificación ISO-8859-1 (occidente) y falla
para caracteres con tildes o virgulillas. Para que no haya problemas el
diccionario debe tener codificación <a class="reference external" href="https://en.wikipedia.org/wiki/UTF-8">UTF-8</a>.
Pueden descargarse en <a class="reference external" href="downloads/dict_es_ES.zip">este enlace</a>.</p>
<p>Una vez que se tienen los diccionarios se deben ubicar en la ruta del
complemento. En mi computador esta sería</p>
<pre class="code text"><a name="rest_code_c4fa579a3e9644f18bf50f4fd4d578a4-1"></a>~/.local/share/jupyter/nbextensions/spellchecker/
</pre>
<p>y dentro de esta los ubicaremos en</p>
<pre class="code text"><a name="rest_code_44221d0abaa140d4876c971b165d563f-1"></a>~/.local/share/jupyter/nbextensions/spellchecker/typo/dictionaries
</pre>
<p>Esta ubicación es arbitraria, lo importante es que necesitamos conocer
la ruta relativa al complemento.</p>
</div>
<div class="section" id="paso-3-configuracion-complementos">
<h3>Paso 3: Configuración complementos</h3>
<p>Ahora, en la pestaña <em>Nbextensions</em> seleccionamos el complemento y llenamos
los campos con la información de nuestro diccionario:</p>
<ul class="simple">
<li><p>language code to use with typo.js: <code class="docutils literal">es_ES</code></p></li>
<li><p>url for the dictionary .dic file to use: <code class="docutils literal">./typo/dictionaries/es_ES.dic</code></p></li>
<li><p>url for the dictionary .aff file to use: <code class="docutils literal">./typo/dictionaries/es_ES.aff</code></p></li>
</ul>
<p>Esto se muestra a continuación.</p>
<img alt="Configuración con archivos locales." class="align-center" src="images/ortografia_jupyter/config_local.png" style="width: 600px;"><p>Otra opción es usar la URL para los archivos. En <a class="reference external" href="https://github.com/wooorm/dictionaries">https://github.com/wooorm/dictionaries</a>
están disponibles los diccionarios del proyecto <a class="reference external" href="https://hunspell.github.io/">hunspell</a>
en UTF-8. En este caso, la configuración sería:</p>
<ul class="simple">
<li><p>language code to use with typo.js: <code class="docutils literal">es_ES</code></p></li>
<li><p>url for the dictionary .dic file to use: <code class="docutils literal"><span class="pre">https://raw.githubusercontent.com/wooorm/dictionaries/master/dictionaries/es/index.dic</span></code></p></li>
<li><p>url for the dictionary .aff file to use: <code class="docutils literal"><span class="pre">https://raw.githubusercontent.com/wooorm/dictionaries/master/dictionaries/es/index.aff</span></code></p></li>
</ul>
<p>Y se muestra a continuación.</p>
<img alt="Configuración con archivos remotos." class="align-center" src="images/ortografia_jupyter/config_url.png" style="width: 600px;"><dl class="footnote brackets">
<dt class="label" id="id2"><span class="brackets"><a class="fn-backref" href="posts/ortografia_jupyter/#id1">*</a></span></dt>
<dd>
<p>Dado el público objetivo de esta publicación está hecha en español y
no en inglés como se acostumbra en este blog.</p>
</dd>
</dl>
</div>
</div>
</div>
    </div>
    </article><article class="post h-entry post-text"><header><h1 class="post-title p-name"><a href="posts/graph_makeover/" class="u-url">#SWDchallenge: Graph makeover</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn">Nicolás Guarín-Zapata</span></p>
            <p class="dateline"><a href="posts/graph_makeover/" rel="bookmark"><time class="post-date published dt-published" datetime="2018-07-12T18:32:40-05:00" title="2018-07-12 18:32">2018-07-12 18:32</time></a></p>
                <p class="commentline">
        
    <a href="posts/graph_makeover/#disqus_thread" data-disqus-identifier="cache/posts/graph_makeover.html">Comments</a>


        </p>
</div>
    </header><div class="e-content entry-content">
    <div>
<p>At <a class="reference external" href="http://www.storytellingwithdata.com/">storytelling with data</a>, they run
a monthly challenge on data visualization named
<a class="reference external" href="http://www.storytellingwithdata.com/swdchallenge/">#SWDchallenge</a>. The main
idea of the challenges is to test data visualization and
storytelling skills.</p>
<p>Each month the challenge has a different topic. This
<a class="reference external" href="http://www.storytellingwithdata.com/blog/2018/7/1/swdchallenge-your-choice-makeover">month</a>
the challenge was to improve an existing graph. I decided to take a previous
graph of mine that was published on a
<a class="reference external" href="https://www.sciencedirect.com/science/article/pii/S1742706115002172">paper</a>
that was published on 2015.</p>
<div class="section" id="the-original">
<h2>The "original"</h2>
<p>The following is the graph that we are going to start with.</p>
<img alt="Original plot" class="align-center" src="images/graph_makeover/energy_vs_D_orig.svg" style="width: 600px;"><p>This is not the exact same graph that was presented in the article on 2015, but
it serves the purpose of the challenge. The data can be downloaded from
<a class="reference external" href="downloads/Energy_vs_D.csv">here</a>. This graph present the fraction of energy (<span class="math">\(\eta\)</span>) transmitted for helical composites
with different geometrical parameters. The parameters varied were:</p>
<ul class="simple">
<li><p>Pitch angle <span class="math">\(\alpha\)</span>: the angle between consecutive layers;</p></li>
<li><p>Composite thickness <span class="math">\(D\)</span>, that is normalized to the wavelength <span class="math">\(\lambda\)</span>; and</p></li>
<li><p>Number of layers <span class="math">\(N\)</span> in each cell of the composite.</p></li>
</ul>
<p>The following schematic illustrate these parameters.</p>
<img alt="Composites" class="align-center" src="images/graph_makeover/coordinates_and_cells.png" style="width: 600px;"><p>I would not say that the graph is awful, and, in comparison to what you would
find in most scientific literature it is even good. But … in the land of the
blind, the one-eyed is king. So, let's enumerate what are the <em>sins</em> of the
plot and see if we can correct them:</p>
<ul class="simple">
<li><p>It has two x axes.</p></li>
<li><p>The legend is enclosed in a box that seems unnecessary.</p></li>
<li><p>Right and top spines are not contributing to the plot.</p></li>
<li><p>Annotations are stealing protagonism from the data.</p></li>
<li><p>It looks clutterd with lines and markers.</p></li>
<li><p>It is a <a class="reference external" href="http://www.storytellingwithdata.com/blog/2013/03/avoiding-spaghetti-graph">spaghetti graph</a>.</p></li>
</ul>
<p>The following snippet generates this graph.</p>
<pre class="code python"><a name="rest_code_08f01e33968d4830a8deb45c8e004294-1"></a><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<a name="rest_code_08f01e33968d4830a8deb45c8e004294-2"></a><span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<a name="rest_code_08f01e33968d4830a8deb45c8e004294-3"></a><span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">rcParams</span>
<a name="rest_code_08f01e33968d4830a8deb45c8e004294-4"></a>
<a name="rest_code_08f01e33968d4830a8deb45c8e004294-5"></a><span class="n">rcParams</span><span class="p">[</span><span class="s1">'font.family'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'serif'</span>
<a name="rest_code_08f01e33968d4830a8deb45c8e004294-6"></a><span class="n">rcParams</span><span class="p">[</span><span class="s1">'font.size'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">16</span>
<a name="rest_code_08f01e33968d4830a8deb45c8e004294-7"></a><span class="n">rcParams</span><span class="p">[</span><span class="s1">'legend.fontsize'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">15</span>
<a name="rest_code_08f01e33968d4830a8deb45c8e004294-8"></a><span class="n">rcParams</span><span class="p">[</span><span class="s1">'mathtext.fontset'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'cm'</span>
<a name="rest_code_08f01e33968d4830a8deb45c8e004294-9"></a>
<a name="rest_code_08f01e33968d4830a8deb45c8e004294-10"></a><span class="n">markers</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'o'</span><span class="p">,</span> <span class="s1">'^'</span><span class="p">,</span> <span class="s1">'v'</span><span class="p">,</span> <span class="s1">'s'</span><span class="p">,</span> <span class="s1">'&lt;'</span><span class="p">,</span> <span class="s1">'&gt;'</span><span class="p">,</span> <span class="s1">'d'</span><span class="p">,</span> <span class="s1">'*'</span><span class="p">,</span> <span class="s1">'x'</span><span class="p">,</span> <span class="s1">'D'</span><span class="p">,</span> <span class="s1">'+'</span><span class="p">,</span> <span class="s1">'H'</span><span class="p">]</span>
<a name="rest_code_08f01e33968d4830a8deb45c8e004294-11"></a><span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="s2">"Energy_vs_D.csv"</span><span class="p">,</span> <span class="n">skiprows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s2">","</span><span class="p">)</span>
<a name="rest_code_08f01e33968d4830a8deb45c8e004294-12"></a><span class="n">labels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="s2">"Energy_vs_D.csv"</span><span class="p">,</span> <span class="n">skiprows</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s2">","</span><span class="p">,</span>
<a name="rest_code_08f01e33968d4830a8deb45c8e004294-13"></a>                    <span class="n">usecols</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">9</span><span class="p">))</span>
<a name="rest_code_08f01e33968d4830a8deb45c8e004294-14"></a><span class="n">labels</span> <span class="o">=</span> <span class="n">labels</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:]</span>
<a name="rest_code_08f01e33968d4830a8deb45c8e004294-15"></a>
<a name="rest_code_08f01e33968d4830a8deb45c8e004294-16"></a><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<a name="rest_code_08f01e33968d4830a8deb45c8e004294-17"></a><span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>
<a name="rest_code_08f01e33968d4830a8deb45c8e004294-18"></a><span class="k">for</span> <span class="n">cont</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">8</span><span class="p">):</span>
<a name="rest_code_08f01e33968d4830a8deb45c8e004294-19"></a>    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">data</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">data</span><span class="p">[:,</span> <span class="n">cont</span> <span class="o">+</span> <span class="mi">1</span><span class="p">],</span> <span class="n">marker</span><span class="o">=</span><span class="n">markers</span><span class="p">[</span><span class="n">cont</span><span class="p">],</span>
<a name="rest_code_08f01e33968d4830a8deb45c8e004294-20"></a>             <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s2">"$D/\lambda=</span><span class="si">{:.3g}</span><span class="s2">$"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">labels</span><span class="p">[</span><span class="n">cont</span><span class="p">]))</span>
<a name="rest_code_08f01e33968d4830a8deb45c8e004294-21"></a>
<a name="rest_code_08f01e33968d4830a8deb45c8e004294-22"></a><span class="c1"># First x-axis</span>
<a name="rest_code_08f01e33968d4830a8deb45c8e004294-23"></a><span class="n">xticks</span><span class="p">,</span> <span class="n">xlabels</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">()</span>
<a name="rest_code_08f01e33968d4830a8deb45c8e004294-24"></a><span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">"Number of layers - $N$"</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<a name="rest_code_08f01e33968d4830a8deb45c8e004294-25"></a><span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">"Fraction of Energy - $\eta$"</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<a name="rest_code_08f01e33968d4830a8deb45c8e004294-26"></a><span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">'center left'</span><span class="p">,</span> <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">))</span>
<a name="rest_code_08f01e33968d4830a8deb45c8e004294-27"></a>
<a name="rest_code_08f01e33968d4830a8deb45c8e004294-28"></a><span class="c1"># Second x-axis</span>
<a name="rest_code_08f01e33968d4830a8deb45c8e004294-29"></a><span class="n">ax2</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">twiny</span><span class="p">()</span>
<a name="rest_code_08f01e33968d4830a8deb45c8e004294-30"></a><span class="n">ax2</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">xticks</span><span class="p">[</span><span class="mi">2</span><span class="p">:])</span>
<a name="rest_code_08f01e33968d4830a8deb45c8e004294-31"></a><span class="n">ax2</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="mf">180.</span><span class="o">/</span><span class="n">xticks</span><span class="p">[</span><span class="mi">2</span><span class="p">:])</span>
<a name="rest_code_08f01e33968d4830a8deb45c8e004294-32"></a><span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">"Angle - $\alpha\ (^\circ)$"</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<a name="rest_code_08f01e33968d4830a8deb45c8e004294-33"></a>
<a name="rest_code_08f01e33968d4830a8deb45c8e004294-34"></a><span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<a name="rest_code_08f01e33968d4830a8deb45c8e004294-35"></a><span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">"energy_vs_D_orig.svg"</span><span class="p">)</span>
<a name="rest_code_08f01e33968d4830a8deb45c8e004294-36"></a><span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">"energy_vs_D_orig.png"</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>
</pre>
</div>
<div class="section" id="corrections">
<h2>Corrections</h2>
<p>I will vindicate the graph one <em>sin</em> at a time, let's see how it turns out.</p>
<div class="section" id="it-has-two-x-axes">
<h3>It has two x axes</h3>
<p>I, originally, added two axes to show both the number of layers
and the angle between them at the same time. The general recommendation is
to avoid this, so let's get rid of the top one.</p>
<img alt="First iteration" class="align-center" src="images/graph_makeover/energy_vs_D_1.svg" style="width: 600px;">
</div>
<div class="section" id="legend-in-a-box">
<h3>Legend in a box</h3>
<p>Pretty straightforward …</p>
<img alt="Second iteration" class="align-center" src="images/graph_makeover/energy_vs_D_2.svg" style="width: 600px;">
</div>
<div class="section" id="right-and-top-spines">
<h3>Right and top spines</h3>
<p>Let's remove them</p>
<img alt="Third iteration" class="align-center" src="images/graph_makeover/energy_vs_D_3.svg" style="width: 600px;">
</div>
<div class="section" id="annotations-are-stealing-protagonism">
<h3>Annotations are stealing protagonism</h3>
<p>Let's move all the annotations to the background by changing the color
to a lighter gray.</p>
<img alt="Fourth iteration" class="align-center" src="images/graph_makeover/energy_vs_D_4.svg" style="width: 600px;">
</div>
<div class="section" id="clutterd-with-lines-and-markers">
<h3>Clutterd with lines and markers</h3>
<p>Let's just keep the lines.</p>
<img alt="Fifth iteration" class="align-center" src="images/graph_makeover/energy_vs_D_5.svg" style="width: 600px;"><p>And increase the linewidth.</p>
<img alt="Sixth iteration" class="align-center" src="images/graph_makeover/energy_vs_D_6.svg" style="width: 600px;">
</div>
<div class="section" id="it-is-a-spaghetti-graph">
<h3>It is a spaghetti graph</h3>
<p>I think that a good option for this graph would be to highlight
one line at a time. Doing this, we end up with.</p>
<img alt="Seventh iteration" class="align-center" src="images/graph_makeover/energy_vs_D_7.svg" style="width: 600px;"><p>The following snippet generates this version.</p>
<pre class="code python"><a name="rest_code_599cc731356a4865836ae77d1e6b70cb-1"></a><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<a name="rest_code_599cc731356a4865836ae77d1e6b70cb-2"></a><span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<a name="rest_code_599cc731356a4865836ae77d1e6b70cb-3"></a><span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">rcParams</span>
<a name="rest_code_599cc731356a4865836ae77d1e6b70cb-4"></a>
<a name="rest_code_599cc731356a4865836ae77d1e6b70cb-5"></a><span class="c1"># Plots setup</span>
<a name="rest_code_599cc731356a4865836ae77d1e6b70cb-6"></a><span class="n">gray</span> <span class="o">=</span> <span class="s1">'#757575'</span>
<a name="rest_code_599cc731356a4865836ae77d1e6b70cb-7"></a><span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s2">"mathtext.fontset"</span><span class="p">]</span> <span class="o">=</span> <span class="s2">"cm"</span>
<a name="rest_code_599cc731356a4865836ae77d1e6b70cb-8"></a><span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s2">"text.color"</span><span class="p">]</span> <span class="o">=</span> <span class="n">gray</span>
<a name="rest_code_599cc731356a4865836ae77d1e6b70cb-9"></a><span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s2">"xtick.color"</span><span class="p">]</span> <span class="o">=</span> <span class="n">gray</span>
<a name="rest_code_599cc731356a4865836ae77d1e6b70cb-10"></a><span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s2">"ytick.color"</span><span class="p">]</span> <span class="o">=</span> <span class="n">gray</span>
<a name="rest_code_599cc731356a4865836ae77d1e6b70cb-11"></a><span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s2">"axes.labelcolor"</span><span class="p">]</span> <span class="o">=</span> <span class="n">gray</span>
<a name="rest_code_599cc731356a4865836ae77d1e6b70cb-12"></a><span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s2">"axes.edgecolor"</span><span class="p">]</span> <span class="o">=</span> <span class="n">gray</span>
<a name="rest_code_599cc731356a4865836ae77d1e6b70cb-13"></a><span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s2">"axes.spines.right"</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
<a name="rest_code_599cc731356a4865836ae77d1e6b70cb-14"></a><span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s2">"axes.spines.top"</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
<a name="rest_code_599cc731356a4865836ae77d1e6b70cb-15"></a><span class="n">rcParams</span><span class="p">[</span><span class="s1">'font.family'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'serif'</span>
<a name="rest_code_599cc731356a4865836ae77d1e6b70cb-16"></a><span class="n">rcParams</span><span class="p">[</span><span class="s1">'mathtext.fontset'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'cm'</span>
<a name="rest_code_599cc731356a4865836ae77d1e6b70cb-17"></a>
<a name="rest_code_599cc731356a4865836ae77d1e6b70cb-18"></a>
<a name="rest_code_599cc731356a4865836ae77d1e6b70cb-19"></a>
<a name="rest_code_599cc731356a4865836ae77d1e6b70cb-20"></a><span class="k">def</span> <span class="nf">line_plots</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">highlight_line</span><span class="p">,</span> <span class="n">title</span><span class="p">):</span>
<a name="rest_code_599cc731356a4865836ae77d1e6b70cb-21"></a>    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
<a name="rest_code_599cc731356a4865836ae77d1e6b70cb-22"></a>    <span class="k">for</span> <span class="n">cont</span><span class="p">,</span> <span class="n">datum</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">data</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">:]</span><span class="o">.</span><span class="n">T</span><span class="p">):</span>
<a name="rest_code_599cc731356a4865836ae77d1e6b70cb-23"></a>        <span class="k">if</span> <span class="n">cont</span> <span class="o">==</span> <span class="n">highlight_line</span><span class="p">:</span>
<a name="rest_code_599cc731356a4865836ae77d1e6b70cb-24"></a>            <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">data</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">datum</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">"#984ea3"</span><span class="p">,</span>
<a name="rest_code_599cc731356a4865836ae77d1e6b70cb-25"></a>                     <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<a name="rest_code_599cc731356a4865836ae77d1e6b70cb-26"></a>        <span class="k">else</span><span class="p">:</span>
<a name="rest_code_599cc731356a4865836ae77d1e6b70cb-27"></a>            <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">data</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">datum</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">gray</span><span class="p">,</span>
<a name="rest_code_599cc731356a4865836ae77d1e6b70cb-28"></a>                     <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<a name="rest_code_599cc731356a4865836ae77d1e6b70cb-29"></a>
<a name="rest_code_599cc731356a4865836ae77d1e6b70cb-30"></a>
<a name="rest_code_599cc731356a4865836ae77d1e6b70cb-31"></a><span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="s2">"Energy_vs_D.csv"</span><span class="p">,</span> <span class="n">skiprows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s2">","</span><span class="p">)</span>
<a name="rest_code_599cc731356a4865836ae77d1e6b70cb-32"></a><span class="n">labels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="s2">"Energy_vs_D.csv"</span><span class="p">,</span> <span class="n">skiprows</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s2">","</span><span class="p">,</span>
<a name="rest_code_599cc731356a4865836ae77d1e6b70cb-33"></a>                    <span class="n">usecols</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">9</span><span class="p">))</span>
<a name="rest_code_599cc731356a4865836ae77d1e6b70cb-34"></a><span class="n">labels</span> <span class="o">=</span> <span class="n">labels</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:]</span>
<a name="rest_code_599cc731356a4865836ae77d1e6b70cb-35"></a>
<a name="rest_code_599cc731356a4865836ae77d1e6b70cb-36"></a><span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="s2">"all"</span><span class="p">)</span>
<a name="rest_code_599cc731356a4865836ae77d1e6b70cb-37"></a><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<a name="rest_code_599cc731356a4865836ae77d1e6b70cb-38"></a><span class="k">for</span> <span class="n">cont</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">8</span><span class="p">):</span>
<a name="rest_code_599cc731356a4865836ae77d1e6b70cb-39"></a>    <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">cont</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<a name="rest_code_599cc731356a4865836ae77d1e6b70cb-40"></a>    <span class="n">title</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">"$D/\lambda=</span><span class="si">{:.3g}</span><span class="s2">$"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">labels</span><span class="p">[</span><span class="n">cont</span><span class="p">])</span>
<a name="rest_code_599cc731356a4865836ae77d1e6b70cb-41"></a>    <span class="n">line_plots</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">cont</span><span class="p">,</span> <span class="n">title</span><span class="p">)</span>
<a name="rest_code_599cc731356a4865836ae77d1e6b70cb-42"></a>    <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mf">0.4</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>
<a name="rest_code_599cc731356a4865836ae77d1e6b70cb-43"></a>    <span class="k">if</span> <span class="n">cont</span> <span class="o">&lt;</span> <span class="mi">4</span><span class="p">:</span>
<a name="rest_code_599cc731356a4865836ae77d1e6b70cb-44"></a>        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">""</span><span class="p">)</span>
<a name="rest_code_599cc731356a4865836ae77d1e6b70cb-45"></a>        <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_ticks</span><span class="p">([])</span>
<a name="rest_code_599cc731356a4865836ae77d1e6b70cb-46"></a>        <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s2">"bottom"</span><span class="p">]</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="s2">"none"</span><span class="p">)</span>
<a name="rest_code_599cc731356a4865836ae77d1e6b70cb-47"></a>    <span class="k">else</span><span class="p">:</span>
<a name="rest_code_599cc731356a4865836ae77d1e6b70cb-48"></a>        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">"Number of layers - $N$"</span><span class="p">)</span>
<a name="rest_code_599cc731356a4865836ae77d1e6b70cb-49"></a>    <span class="k">if</span> <span class="n">cont</span> <span class="o">%</span> <span class="mi">4</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
<a name="rest_code_599cc731356a4865836ae77d1e6b70cb-50"></a>        <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_ticks</span><span class="p">([])</span>
<a name="rest_code_599cc731356a4865836ae77d1e6b70cb-51"></a>        <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s2">"left"</span><span class="p">]</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="s2">"none"</span><span class="p">)</span>
<a name="rest_code_599cc731356a4865836ae77d1e6b70cb-52"></a>    <span class="k">else</span><span class="p">:</span>
<a name="rest_code_599cc731356a4865836ae77d1e6b70cb-53"></a>        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">"Fraction of Energy - $\eta$"</span><span class="p">)</span>
<a name="rest_code_599cc731356a4865836ae77d1e6b70cb-54"></a>
<a name="rest_code_599cc731356a4865836ae77d1e6b70cb-55"></a>
<a name="rest_code_599cc731356a4865836ae77d1e6b70cb-56"></a><span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<a name="rest_code_599cc731356a4865836ae77d1e6b70cb-57"></a><span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">"energy_vs_D_7.svg"</span><span class="p">)</span>
<a name="rest_code_599cc731356a4865836ae77d1e6b70cb-58"></a><span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">"energy_vs_D_7.png"</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>
</pre>
</div>
</div>
<div class="section" id="final-tweaks">
<h2>Final tweaks</h2>
<p>Using Inkscape I added some final details to get the following version.</p>
<img alt="Final" class="align-center" src="images/graph_makeover/energy_vs_D_final.svg" style="width: 600px;">
</div>
<div class="section" id="further-reading">
<h2>Further reading</h2>
<ul class="simple">
<li><p>Knaflic, Cole Nussbaumer. <a class="reference external" href="http://www.storytellingwithdata.com/book/">Storytelling with data: A data visualization guide for business professionals</a>.
John Wiley &amp; Sons, 2015.</p></li>
<li><p>Nicolás Guarín-Zapata et al. <a class="reference external" href="https://www.sciencedirect.com/science/article/pii/S1742706115002172">"Shear wave filtering in naturally-occurring Bouligand structures."</a>
Acta biomaterialia 23 (2015): 11-20. Preprint: <a class="reference external" href="https://arxiv.org/pdf/1505.04203.pdf">https://arxiv.org/pdf/1505.04203.pdf</a></p></li>
</ul>
</div>
</div>
    </div>
    </article><article class="post h-entry post-text"><header><h1 class="post-title p-name"><a href="posts/isometric_inkscape2/" class="u-url">Isometric graphics in Inkscape: Part 2</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn">Nicolás Guarín-Zapata</span></p>
            <p class="dateline"><a href="posts/isometric_inkscape2/" rel="bookmark"><time class="post-date published dt-published" datetime="2018-05-30T12:40:57-05:00" title="2018-05-30 12:40">2018-05-30 12:40</time></a></p>
                <p class="commentline">
        
    <a href="posts/isometric_inkscape2/#disqus_thread" data-disqus-identifier="cache/posts/isometric_inkscape2.html">Comments</a>


        </p>
</div>
    </header><div class="e-content entry-content">
    <div>
<p><a class="reference external" href="posts/isometric_inkscape">Last week</a>  I posted a quick guide on isometric
drawing using <a class="reference external" href="https://inkscape.org/en/">Inkscape</a>. In that post, I
showed how to obtain images that are projected to the faces of an
isometric box.</p>
<p>After my post, I was asked by <a class="reference external" href="https://twitter.com/parresianz">Biswajit Banerjee</a>
on <a class="reference external" href="https://twitter.com/parresianz/status/999787980658126848">Twitter</a> if
I could repeat the process with a more complex example, and he suggested
the following schematic</p>
<img alt="Computing the moment of force in a beam" class="align-center" src="https://upload.wikimedia.org/wikipedia/commons/thumb/6/69/Beam_moment_plain.svg/512px-Beam_moment_plain.svg.png"><p>which, I guess, was created in Inkscape using the "Create 3D Box" option.</p>
<p>In this post, I will:</p>
<ol class="arabic simple">
<li><p>Use the same approach from last week to recreate this schematic</p></li>
<li><p>Suggest my preferred approach for drawing this schematic</p></li>
</ol>
<div class="section" id="first-approach">
<h2>First approach</h2>
<p>I will repeat the cheatsheet from last week. Keep in mind that Inkscape
treats clockwise rotation as positive. Opposite to common notation in
mathematics.</p>
<img alt="Cheatsheet for isometric schematics in Inkscape" class="align-center" src="images/isometric_inkscape/isometric_instructions.svg" style="width: 500px;"><p>Then, to create a box with desired dimensions we first create each rectangle
with the right dimensiones (in parallel projections). In the following
example we used faces with aspect ratios 3:2, 2:1 and 4:3. The box at the right
is the figure obtained after applying the transformations described in
the previous schematic.</p>
<img alt="Orthogonal views and final isometric figure" class="align-center" src="images/isometric_inkscape/isometric_ex2.svg" style="width: 500px;"><p>We can now proceed, to recreate the desired figure. I don't know the
exact dimensions of the box; my guess is that the cross-section was
a square and the aspect ratio was 5:1. After applying the transformations
to each rectangle we obtain the following (adding some tweaks here and there).</p>
<img alt="Recreated figure using the described approach" class="align-center" src="images/isometric_inkscape/isometric_beam.svg" style="width: 500px;">
</div>
<div class="section" id="second-approach">
<h2>Second approach</h2>
<p>For this type of schematic, I would prefer to create an axonometric grid
(<code class="docutils literal">File &gt; Document Properties &gt; Grids</code>). After adding the grid to our
canvas it is pretty straightforward to draw the figures in isometric
view. The canvas should look similar to the following image.</p>
<img alt="Second approach: using an axonometric grid" class="align-center" src="images/isometric_inkscape/screenshot_inkscape.png" style="width: 500px;"><p>We can then draw each face using the grid. If we want to be more precise
we can activate <code class="docutils literal">Snap to Cusp Nodes</code>. The following animation shows
the step by step construction.</p>
<img alt="Step by step construction of the isometric" class="align-center" src="images/isometric_inkscape/isometric_construction.gif" style="width: 500px;"><p>And we obtain the final image.</p>
<img alt="Recreated figure using the second approach" class="align-center" src="images/isometric_inkscape/isometric_beam2.svg" style="width: 500px;">
</div>
<div class="section" id="conclusion">
<h2>Conclusion</h2>
<p>As I mentioned, Inkscape can be used for drawing simple figures in isometric
projection. Nevertheless, I strongly suggest to use a CAD like
<a class="reference external" href="https://freecadweb.org/">FreeCAD</a> for more complicated geometries.</p>
</div>
</div>
    </div>
    </article><article class="post h-entry post-text"><header><h1 class="post-title p-name"><a href="posts/isometric_inkscape/" class="u-url">Isometric graphics in Inkscape</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn">Nicolás Guarín-Zapata</span></p>
            <p class="dateline"><a href="posts/isometric_inkscape/" rel="bookmark"><time class="post-date published dt-published" datetime="2018-05-24T15:42:02-05:00" title="2018-05-24 15:42">2018-05-24 15:42</time></a></p>
                <p class="commentline">
        
    <a href="posts/isometric_inkscape/#disqus_thread" data-disqus-identifier="cache/posts/isometric_inkscape.html">Comments</a>


        </p>
</div>
    </header><div class="e-content entry-content">
    <div>
<p>Sometimes I find myself in need of making a schematic using an
<a class="reference external" href="https://en.wikipedia.org/wiki/Isometric_projection">isometric projection</a>.
When the schematic is complicated the best shot is to use some
CAD like <a class="reference external" href="https://freecadweb.org/">FreeCAD</a>, but sometimes it's just
needed in simple diagrams. Another situation where this is a common needed
is in <a class="reference external" href="https://en.wikipedia.org/wiki/Isometric_graphics_in_video_games_and_pixel_art">video games</a>,
where <a class="reference external" href="https://youtu.be/toWMFcWB4HA">"isometric art"</a> and
<a class="reference external" href="https://en.wikipedia.org/wiki/Pixel_art">pixel art</a> are pretty common.</p>
<p>What we want is depicted in the following figure.</p>
<img alt="Views names in third angle representation" class="align-center" src="images/isometric_inkscape/isometric_example.svg" style="width: 400px;"><p>That is, we want to start with some information that is drawn, or
written in the case of the example, and we want to obtain how would it
been seen on one of the faces of an isometric box.</p>
<p>Following, I will describe briefly the transformations involved in this process.
If you are just interested in the recipe for doing this in Inkscape, skip to
the end of this post.</p>
<div class="section" id="transformations-involved">
<h2>Transformations involved</h2>
<p>Since we are working on a computer screen, we are talking of 2 dimensions.
Hence, all transformations are represented by 2×2 matrices. In the particular
example of interest in this post we need the following transformations:</p>
<ol class="arabic simple">
<li><p>Vertical scaling</p></li>
<li><p>Horizontal skew</p></li>
<li><p>Rotation</p></li>
</ol>
<p>Following are the transformation matrices.</p>
<div class="section" id="scaling-in-the-vertical-direction">
<h3>Scaling in the vertical direction</h3>
<p>The matrix is given by</p>
<div class="math">
\begin{equation*}
M_\text{scaling} = \begin{bmatrix} 1 &amp;0\\ 0 &amp;a\end{bmatrix}\, ,
\end{equation*}
</div>
<p>where <span class="math">\(a\)</span> is the scaling factor.</p>
</div>
<div class="section" id="horizontal-skew">
<h3>Horizontal skew</h3>
<p>The matrix is given by</p>
<div class="math">
\begin{equation*}
M_\text{skew} = \begin{bmatrix} 1 &amp;\tan a\\ 0 &amp;1\end{bmatrix}\, ,
\end{equation*}
</div>
<p>where <span class="math">\(a\)</span> is the skewing angle.</p>
</div>
<div class="section" id="rotation">
<h3>Rotation</h3>
<p>The matrix is given by</p>
<div class="math">
\begin{equation*}
M_\text{rotation} = \begin{bmatrix} \cos a &amp;-\sin a\\ \sin a &amp;\cos a\end{bmatrix}\, ,
\end{equation*}
</div>
<p>where <span class="math">\(a\)</span> is the rotation angle.</p>
</div>
<div class="section" id="complete-transformation">
<h3>Complete transformation</h3>
<p>The complete transformation is given by</p>
<div class="math">
\begin{equation*}
M_\text{complete} = M_\text{rotation} M_\text{skew} M_\text{scaling}\, ,
\end{equation*}
</div>
<p>particularly,</p>
<div class="math">
\begin{align*}
&amp;M_\text{side} =
  \frac{1}{2}\begin{bmatrix} \sqrt{3} &amp; 0\\ -1 &amp;2\end{bmatrix}\approx
  \begin{bmatrix} 0.866 &amp; 0.000\\ -0.500 &amp;1.000\end{bmatrix}\, , \\
&amp;M_\text{front} = \frac{1}{2}\begin{bmatrix} \sqrt{3} &amp; 0\\ 1 &amp;2\end{bmatrix}\approx
  \begin{bmatrix} 0.866 &amp; 0.000\\ 0.500 &amp;1.000\end{bmatrix}\, , \\
&amp;M_\text{plant} = \frac{1}{2}\begin{bmatrix} \sqrt{3} &amp; -\sqrt{3}\\ -1 &amp;1\end{bmatrix}\approx
  \begin{bmatrix} 0.866 &amp; -0.866\\ 0.500 &amp;0.500\end{bmatrix}\, .
\end{align*}
</div>
<p>The values seem a bit arbitrary, but they can be obtained from the
<a class="reference external" href="https://en.wikipedia.org/wiki/Isometric_projection#Mathematics">isometric projection</a>
itself. But that explanation would be a bit too long for this post.</p>
</div>
<div class="section" id="tranformation-in-inkscape">
<h3>Tranformation in Inkscape</h3>
<p>We already have the transformation matrices and we can use them in Inkscape.
But first, we need to understand how it works. Inkscape uses
<a class="reference external" href="https://en.wikipedia.org/wiki/Scalable_Vector_Graphics">SVG</a>, the web
standard for vector graphics. <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/SVG/Attribute/transform">Transformations</a> in SVG are done using the following
matrix</p>
<div class="math">
\begin{equation*}
\begin{bmatrix} a &amp;c &amp;e\\ b &amp;d &amp;f\\ 0 &amp;0 &amp;1\end{bmatrix}\, ,
\end{equation*}
</div>
<p>that uses <a class="reference external" href="https://en.wikipedia.org/wiki/Homogeneous_coordinates">homogeneous coordinates</a>. So, one can just press <code class="docutils literal">Shift + Ctrl + M</code>
and type the components of the matrices obtained above for
<span class="math">\(a\)</span>, <span class="math">\(b\)</span>, <span class="math">\(c\)</span>, and <span class="math">\(d\)</span>; leaving
<span class="math">\(e\)</span> and <span class="math">\(f\)</span> as zero.</p>
<p>My preferred method, though, is to apply each transformation after the
other in the <cite>Transform</cite> dialog (<code class="docutils literal">Shift + Ctrl + M</code>). And, this is the
method presented in the cheatsheet at the bottom of this post.</p>
</div>
</div>
<div class="section" id="tl-dr">
<h2>TL;DR</h2>
<p>If you are just interested in the transformations needed in Inkscape
you can check the cheatsheet below. It uses third-angle as presented
below.</p>
<img alt="Views names in third angle representation" class="align-center" src="images/isometric_inkscape/third_angle.svg" style="width: 400px;"><div class="section" id="cheatsheet">
<h3>Cheatsheet</h3>
<p>Keep in mind that Inkscape treats clockwise rotation as positive. Opposite
to common notation in mathematics.</p>
<img alt="Cheatsheet for isometric schematics in Inkscape" class="align-center" src="images/isometric_inkscape/isometric_instructions.svg" style="width: 500px;">
</div>
</div>
</div>
    </div>
    </article><article class="post h-entry post-text"><header><h1 class="post-title p-name"><a href="posts/infinite_fdm/" class="u-url">Finite differences in infinite domains</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn">Nicolás Guarín-Zapata</span></p>
            <p class="dateline"><a href="posts/infinite_fdm/" rel="bookmark"><time class="post-date published dt-published" datetime="2018-05-17T15:57:00-05:00" title="2018-05-17 15:57">2018-05-17 15:57</time></a></p>
                <p class="commentline">
        
    <a href="posts/infinite_fdm/#disqus_thread" data-disqus-identifier="cache/posts/infinite_fdm.html">Comments</a>


        </p>
</div>
    </header><div class="e-content entry-content">
    <div class="section" id="finite-differences-in-infinite-domains">
<h2>Finite differences in infinite domains</h2>
<p>Because of my friend, <a class="reference external" href="http://cosmoscalibur.com/">Edward Villegas</a>, I
ended up thinking about using a change of variables when solving an
eigenvalue problem with finite difference.</p>
<div class="section" id="the-problem">
<h3>The problem</h3>
<p>Let's say that we want to solve a differential equation over an infinite
domain. A common case is to solve the <a class="reference external" href="https://en.wikipedia.org/wiki/Schr%C3%B6dinger_equation#Time-independent_equation">Time independent Schrödinger
equation</a>
subject to a potential <span class="math">\(V(x)\)</span>. For example</p>
<div class="math">
\begin{equation*}
-\frac{1}{2}\frac{\mathrm{d}^2}{\mathrm{d}x^2}\psi(x) + V(x) \psi(x) = E\psi(x),\quad \forall x\in (-\infty, \infty),
\end{equation*}
</div>
<p>where we want to find the pairs of eigenvalues/eigenfunctions
<span class="math">\((E_n, \psi_n(x))\)</span>.</p>
<p>What I normally do when using <a class="reference external" href="https://en.wikipedia.org/wiki/Finite_difference_method">finite
differences</a>
is to regularly divide the domain. Where I take a <em>large enough</em> domain,
so the solution have decayed close to zero. What I do in this post is to
make a change of variable to render the interval finite first and then
regularly divide the transformed domain in finite intervals.</p>
</div>
<div class="section" id="my-usual-approach">
<h3>My usual approach</h3>
<p>My usual approach is to approach the second derivative with a <a class="reference external" href="https://en.wikipedia.org/wiki/Finite_difference_coefficient">centered
difference</a>
for the point <span class="math">\(x_i\)</span> like this</p>
<div class="math">
\begin{equation*}
\frac{\mathrm{d}^2 f(x)}{\mathrm{d}x^2} \approx \frac{f(x + \Delta x) - 2 f(x_i) + f(x - \Delta x)}{\Delta x^2}\, ,
\end{equation*}
</div>
<p>with <span class="math">\(\Delta x\)</span> the separation between points.</p>
<p>We can solve this in Python with the following snippet:</p>
<pre class="code ipython3"><a name="rest_code_1aa2bf1e813643849c6e42d440e287b4-1"></a><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<a name="rest_code_1aa2bf1e813643849c6e42d440e287b4-2"></a><span class="kn">from</span> <span class="nn">scipy.sparse</span> <span class="kn">import</span> <span class="n">diags</span>
<a name="rest_code_1aa2bf1e813643849c6e42d440e287b4-3"></a><span class="kn">from</span> <span class="nn">scipy.sparse.linalg</span> <span class="kn">import</span> <span class="n">eigs</span>
<a name="rest_code_1aa2bf1e813643849c6e42d440e287b4-4"></a>
<a name="rest_code_1aa2bf1e813643849c6e42d440e287b4-5"></a>
<a name="rest_code_1aa2bf1e813643849c6e42d440e287b4-6"></a><span class="k">def</span> <span class="nf">regular_FD</span><span class="p">(</span><span class="n">pot</span><span class="p">,</span> <span class="n">npts</span><span class="o">=</span><span class="mi">101</span><span class="p">,</span> <span class="n">x_max</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">nvals</span><span class="o">=</span><span class="mi">6</span><span class="p">):</span>
<a name="rest_code_1aa2bf1e813643849c6e42d440e287b4-7"></a>    <span class="sd">"""</span>
<a name="rest_code_1aa2bf1e813643849c6e42d440e287b4-8"></a><span class="sd">    Find eigenvalues/eigenfunctions for Schrodinger</span>
<a name="rest_code_1aa2bf1e813643849c6e42d440e287b4-9"></a><span class="sd">    equation for the given potential `pot` using</span>
<a name="rest_code_1aa2bf1e813643849c6e42d440e287b4-10"></a><span class="sd">    finite differences</span>
<a name="rest_code_1aa2bf1e813643849c6e42d440e287b4-11"></a><span class="sd">    """</span>
<a name="rest_code_1aa2bf1e813643849c6e42d440e287b4-12"></a>    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="n">x_max</span><span class="p">,</span> <span class="n">x_max</span><span class="p">,</span> <span class="n">npts</span><span class="p">)</span>
<a name="rest_code_1aa2bf1e813643849c6e42d440e287b4-13"></a>    <span class="n">dx</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<a name="rest_code_1aa2bf1e813643849c6e42d440e287b4-14"></a>    <span class="n">D2</span> <span class="o">=</span> <span class="n">diags</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="n">npts</span><span class="p">,</span> <span class="n">npts</span><span class="p">))</span><span class="o">/</span><span class="n">dx</span><span class="o">**</span><span class="mi">2</span>
<a name="rest_code_1aa2bf1e813643849c6e42d440e287b4-15"></a>    <span class="n">V</span> <span class="o">=</span> <span class="n">diags</span><span class="p">(</span><span class="n">pot</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<a name="rest_code_1aa2bf1e813643849c6e42d440e287b4-16"></a>    <span class="n">H</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.5</span><span class="o">*</span><span class="n">D2</span> <span class="o">+</span> <span class="n">V</span>
<a name="rest_code_1aa2bf1e813643849c6e42d440e287b4-17"></a>    <span class="n">vals</span><span class="p">,</span> <span class="n">vecs</span> <span class="o">=</span> <span class="n">eigs</span><span class="p">(</span><span class="n">H</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="n">nvals</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s2">"SM"</span><span class="p">)</span>
<a name="rest_code_1aa2bf1e813643849c6e42d440e287b4-18"></a>    <span class="k">return</span> <span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">vals</span><span class="p">),</span> <span class="n">vecs</span>
</pre>
<p>Let's setup the plotting details.</p>
<pre class="code ipython3"><a name="rest_code_5f19244104684ef194bcdc74983ecf99-1"></a><span class="c1"># Jupyter notebook plotting setup &amp; imports</span>
<a name="rest_code_5f19244104684ef194bcdc74983ecf99-2"></a><span class="o">%</span><span class="k">matplotlib</span> notebook
<a name="rest_code_5f19244104684ef194bcdc74983ecf99-3"></a><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<a name="rest_code_5f19244104684ef194bcdc74983ecf99-4"></a>
<a name="rest_code_5f19244104684ef194bcdc74983ecf99-5"></a><span class="n">gray</span> <span class="o">=</span> <span class="s1">'#757575'</span>
<a name="rest_code_5f19244104684ef194bcdc74983ecf99-6"></a><span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s2">"figure.figsize"</span><span class="p">]</span> <span class="o">=</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">4</span>
<a name="rest_code_5f19244104684ef194bcdc74983ecf99-7"></a><span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s2">"mathtext.fontset"</span><span class="p">]</span> <span class="o">=</span> <span class="s2">"cm"</span>
<a name="rest_code_5f19244104684ef194bcdc74983ecf99-8"></a><span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s2">"text.color"</span><span class="p">]</span> <span class="o">=</span> <span class="n">gray</span>
<a name="rest_code_5f19244104684ef194bcdc74983ecf99-9"></a><span class="n">fontsize</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s2">"font.size"</span><span class="p">]</span> <span class="o">=</span> <span class="mi">12</span>
<a name="rest_code_5f19244104684ef194bcdc74983ecf99-10"></a><span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s2">"xtick.color"</span><span class="p">]</span> <span class="o">=</span> <span class="n">gray</span>
<a name="rest_code_5f19244104684ef194bcdc74983ecf99-11"></a><span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s2">"ytick.color"</span><span class="p">]</span> <span class="o">=</span> <span class="n">gray</span>
<a name="rest_code_5f19244104684ef194bcdc74983ecf99-12"></a><span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s2">"axes.labelcolor"</span><span class="p">]</span> <span class="o">=</span> <span class="n">gray</span>
<a name="rest_code_5f19244104684ef194bcdc74983ecf99-13"></a><span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s2">"axes.edgecolor"</span><span class="p">]</span> <span class="o">=</span> <span class="n">gray</span>
<a name="rest_code_5f19244104684ef194bcdc74983ecf99-14"></a><span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s2">"axes.spines.right"</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
<a name="rest_code_5f19244104684ef194bcdc74983ecf99-15"></a><span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s2">"axes.spines.top"</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
</pre>
<p>Let's consider the <a class="reference external" href="https://en.wikipedia.org/wiki/Quantum_harmonic_oscillator">Quantum harmonic
oscillator</a>,
that has as eigenvalues</p>
<div class="math">
\begin{equation*}
E_n = n + \frac{1}{2},\quad \forall n = 0, 1, 2 \cdots
\end{equation*}
</div>
<p>Using the finite difference method we have values that are really close
to the analytic ones.</p>
<pre class="code ipython3"><a name="rest_code_849da6e0e40340aabd2db25d23be5616-1"></a><span class="n">x</span><span class="p">,</span> <span class="n">vals</span><span class="p">,</span> <span class="n">vecs</span> <span class="o">=</span> <span class="n">regular_FD</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="n">npts</span><span class="o">=</span><span class="mi">201</span><span class="p">)</span>
<a name="rest_code_849da6e0e40340aabd2db25d23be5616-2"></a><span class="n">vals</span>
</pre>
<p>with output</p>
<pre class="literal-block">array([0.4996873 , 1.49843574, 2.49593063, 3.49216962, 4.48715031,
       5.4808703 ])</pre>
<p>With the analytic ones</p>
<pre class="code text"><a name="rest_code_97d7f225892344b28d9808da98ef85a2-1"></a>[0.5, 1.5, 2.5, 3.5, 4.5, 5.5])
</pre>
<p>If we plot these two, we obtain the following.</p>
<pre class="code ipython3"><a name="rest_code_d185113b3b084681a00606c517b50803-1"></a><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<a name="rest_code_d185113b3b084681a00606c517b50803-2"></a><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">anal_vals</span><span class="p">)</span>
<a name="rest_code_d185113b3b084681a00606c517b50803-3"></a><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">vals</span><span class="p">,</span> <span class="s2">"o"</span><span class="p">)</span>
<a name="rest_code_d185113b3b084681a00606c517b50803-4"></a><span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">"$n$"</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<a name="rest_code_d185113b3b084681a00606c517b50803-5"></a><span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">"$E_n$"</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<a name="rest_code_d185113b3b084681a00606c517b50803-6"></a><span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s2">"Analytic"</span><span class="p">,</span> <span class="s2">"Finite differences"</span><span class="p">])</span>
<a name="rest_code_d185113b3b084681a00606c517b50803-7"></a><span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">();</span>
</pre>
<img alt="Eigenvalues for the regular finite difference" class="align-center" src="images/infinite_fdm/eigvals_regular.svg" style="width: 600px;"><p>Let's see the eigenfunctions.</p>
<pre class="code ipython3"><a name="rest_code_ac3a56e01e754030adc3c377d40880b0-1"></a><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<a name="rest_code_ac3a56e01e754030adc3c377d40880b0-2"></a><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">vecs</span><span class="p">[:,</span> <span class="p">:</span><span class="mi">3</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<a name="rest_code_ac3a56e01e754030adc3c377d40880b0-3"></a><span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
<a name="rest_code_ac3a56e01e754030adc3c377d40880b0-4"></a><span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">"$x$"</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<a name="rest_code_ac3a56e01e754030adc3c377d40880b0-5"></a><span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">"$|\psi_n(x)|^2$"</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<a name="rest_code_ac3a56e01e754030adc3c377d40880b0-6"></a><span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">([])</span>
<a name="rest_code_ac3a56e01e754030adc3c377d40880b0-7"></a><span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">();</span>
</pre>
<img alt="Eigenfunctions for the regular finite difference" class="align-center" src="images/infinite_fdm/eigvecs_regular.svg" style="width: 600px;"><p>One inconvenient with this method is the redundant sampling towards the
extreme of the intervals, while under sample the middle part.</p>
</div>
<div class="section" id="changing-the-domain">
<h3>Changing the domain</h3>
<p>Let's now consider the case where we transform the infinite domain to a
finite one with a change of variable</p>
<div class="math">
\begin{equation*}
\xi = \xi(x)
\end{equation*}
</div>
<p>with <span class="math">\(\xi \in (-1, 1)\)</span>. Two options for this transformation are:</p>
<ul class="simple">
<li><p><span class="math">\(\xi = \tanh x\)</span>; and</p></li>
<li><p><span class="math">\(\xi = \frac{2}{\pi} \arctan x\)</span>.</p></li>
</ul>
<p>Making this change of variable the equation we need to solve the
following equation</p>
<div class="math">
\begin{equation*}
-\frac{1}{2}\left(\frac{\mathrm{d}\xi}{\mathrm{d}x}\right)^2\frac{\mathrm{d}^2}{\mathrm{d}\xi^2}\psi(\xi) - \frac{1}{2}\frac{\mathrm{d}^2\xi}{\mathrm{d}x^2}\frac{\mathrm{d}}{\mathrm{d}\xi}\psi(\xi) + V(\xi) \psi(\xi) = E\psi(\xi)
\end{equation*}
</div>
<p>The following snippet solve the eigenproblem for the mapped domain:</p>
<pre class="code ipython3"><a name="rest_code_abf94754126f45ebb8bba6c10e844a41-1"></a><span class="k">def</span> <span class="nf">mapped_FD</span><span class="p">(</span><span class="n">pot</span><span class="p">,</span> <span class="n">fun</span><span class="p">,</span> <span class="n">dxdxi</span><span class="p">,</span> <span class="n">dxdxi2</span><span class="p">,</span> <span class="n">npts</span><span class="o">=</span><span class="mi">101</span><span class="p">,</span> <span class="n">nvals</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">xi_tol</span><span class="o">=</span><span class="mf">1e-6</span><span class="p">):</span>
<a name="rest_code_abf94754126f45ebb8bba6c10e844a41-2"></a>    <span class="sd">"""</span>
<a name="rest_code_abf94754126f45ebb8bba6c10e844a41-3"></a><span class="sd">    Find eigenvalues/eigenfunctions for Schrodinger</span>
<a name="rest_code_abf94754126f45ebb8bba6c10e844a41-4"></a><span class="sd">    equation for the given potential `pot` using</span>
<a name="rest_code_abf94754126f45ebb8bba6c10e844a41-5"></a><span class="sd">    finite differences over a mapped domain on (-1, 1)</span>
<a name="rest_code_abf94754126f45ebb8bba6c10e844a41-6"></a><span class="sd">    """</span>
<a name="rest_code_abf94754126f45ebb8bba6c10e844a41-7"></a>    <span class="n">xi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span> <span class="o">+</span> <span class="n">xi_tol</span><span class="p">,</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">xi_tol</span><span class="p">,</span> <span class="n">npts</span><span class="p">)</span>
<a name="rest_code_abf94754126f45ebb8bba6c10e844a41-8"></a>    <span class="n">x</span> <span class="o">=</span> <span class="n">fun</span><span class="p">(</span><span class="n">xi</span><span class="p">)</span>
<a name="rest_code_abf94754126f45ebb8bba6c10e844a41-9"></a>    <span class="n">dxi</span> <span class="o">=</span> <span class="n">xi</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">xi</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<a name="rest_code_abf94754126f45ebb8bba6c10e844a41-10"></a>    <span class="n">D2</span> <span class="o">=</span> <span class="n">diags</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="n">npts</span><span class="p">,</span> <span class="n">npts</span><span class="p">))</span><span class="o">/</span><span class="n">dxi</span><span class="o">**</span><span class="mi">2</span>
<a name="rest_code_abf94754126f45ebb8bba6c10e844a41-11"></a>    <span class="n">D1</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">diags</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="n">npts</span><span class="p">,</span> <span class="n">npts</span><span class="p">))</span><span class="o">/</span><span class="n">dxi</span>
<a name="rest_code_abf94754126f45ebb8bba6c10e844a41-12"></a>    <span class="n">V</span> <span class="o">=</span> <span class="n">diags</span><span class="p">(</span><span class="n">pot</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<a name="rest_code_abf94754126f45ebb8bba6c10e844a41-13"></a>    <span class="n">fac1</span> <span class="o">=</span> <span class="n">diags</span><span class="p">(</span><span class="n">dxdxi</span><span class="p">(</span><span class="n">xi</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<a name="rest_code_abf94754126f45ebb8bba6c10e844a41-14"></a>    <span class="n">fac2</span> <span class="o">=</span> <span class="n">diags</span><span class="p">(</span><span class="n">dxdxi2</span><span class="p">(</span><span class="n">xi</span><span class="p">))</span>
<a name="rest_code_abf94754126f45ebb8bba6c10e844a41-15"></a>    <span class="n">H</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.5</span><span class="o">*</span><span class="n">fac1</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">D2</span><span class="p">)</span> <span class="o">-</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">fac2</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">D1</span><span class="p">)</span> <span class="o">+</span> <span class="n">V</span>
<a name="rest_code_abf94754126f45ebb8bba6c10e844a41-16"></a>    <span class="n">vals</span><span class="p">,</span> <span class="n">vecs</span> <span class="o">=</span> <span class="n">eigs</span><span class="p">(</span><span class="n">H</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="n">nvals</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s2">"SM"</span><span class="p">)</span>
<a name="rest_code_abf94754126f45ebb8bba6c10e844a41-17"></a>    <span class="k">return</span> <span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">vals</span><span class="p">),</span> <span class="n">vecs</span>
</pre>
<div class="section" id="first-transformation-xi-tanh-x">
<h4>First transformation: <span class="math">\(\xi = \tanh(x)\)</span>
</h4>
<p>Let's consider first the transformation</p>
<div class="math">
\begin{equation*}
\xi = \tanh(x)\, .
\end{equation*}
</div>
<p>In this case</p>
<div class="math">
\begin{equation*}
\frac{\mathrm{d}\xi}{\mathrm{d}x} = 1 - \tanh^2(x) = 1 - \xi^2\, ,
\end{equation*}
</div>
<p>and</p>
<div class="math">
\begin{equation*}
\frac{\mathrm{d}^2\xi}{\mathrm{d}x^2} = -2\tanh(x)[1 - \tanh^2(x)] = -2\xi[1 - \xi^2]\, .
\end{equation*}
</div>
<p>We need to define the functions</p>
<pre class="code ipython3"><a name="rest_code_674482edcc5a489d87cab1546cb59f96-1"></a><span class="n">pot</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span>
<a name="rest_code_674482edcc5a489d87cab1546cb59f96-2"></a><span class="n">fun</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">xi</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">arctanh</span><span class="p">(</span><span class="n">xi</span><span class="p">)</span>
<a name="rest_code_674482edcc5a489d87cab1546cb59f96-3"></a><span class="n">dxdxi</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">xi</span><span class="p">:</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">xi</span><span class="o">**</span><span class="mi">2</span>
<a name="rest_code_674482edcc5a489d87cab1546cb59f96-4"></a><span class="n">dxdxi2</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">xi</span><span class="p">:</span> <span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">xi</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">xi</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
</pre>
<p>and run the function</p>
<pre class="code ipython3"><a name="rest_code_6f1fb71679344547a503853778f5005f-1"></a><span class="n">x</span><span class="p">,</span> <span class="n">vals</span><span class="p">,</span> <span class="n">vecs</span> <span class="o">=</span> <span class="n">mapped_FD</span><span class="p">(</span><span class="n">pot</span><span class="p">,</span> <span class="n">fun</span><span class="p">,</span> <span class="n">dxdxi</span><span class="p">,</span> <span class="n">dxdxi2</span><span class="p">,</span> <span class="n">npts</span><span class="o">=</span><span class="mi">201</span><span class="p">)</span>
<a name="rest_code_6f1fb71679344547a503853778f5005f-2"></a><span class="n">vals</span>
</pre>
<p>And we obtain the following</p>
<pre class="literal-block">array([0.49989989, 1.4984226 , 2.49003572, 3.46934257, 4.46935021,
       5.59552989])</pre>
<p>If we compare with the analytic values we get the following.</p>
<pre class="code ipython3"><a name="rest_code_747ea01c69d34bf3a05a9188e4ddc7e4-1"></a><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<a name="rest_code_747ea01c69d34bf3a05a9188e4ddc7e4-2"></a><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">anal_vals</span><span class="p">)</span>
<a name="rest_code_747ea01c69d34bf3a05a9188e4ddc7e4-3"></a><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">vals</span><span class="p">,</span> <span class="s2">"o"</span><span class="p">)</span>
<a name="rest_code_747ea01c69d34bf3a05a9188e4ddc7e4-4"></a><span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s2">"Analytic"</span><span class="p">,</span> <span class="s2">"Finite differences"</span><span class="p">])</span>
<a name="rest_code_747ea01c69d34bf3a05a9188e4ddc7e4-5"></a><span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">"$n$"</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<a name="rest_code_747ea01c69d34bf3a05a9188e4ddc7e4-6"></a><span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">"$E_n$"</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<a name="rest_code_747ea01c69d34bf3a05a9188e4ddc7e4-7"></a><span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">();</span>
</pre>
<img alt="Eigenvalues for the first transformation" class="align-center" src="images/infinite_fdm/eigvals_tanh.svg" style="width: 600px;"><p>And the following are the eigenfunctions.</p>
<pre class="code ipython3"><a name="rest_code_e988e87eba6f406cb144148def94dee5-1"></a><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<a name="rest_code_e988e87eba6f406cb144148def94dee5-2"></a><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">vecs</span><span class="p">[:,</span> <span class="p">:</span><span class="mi">3</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<a name="rest_code_e988e87eba6f406cb144148def94dee5-3"></a><span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
<a name="rest_code_e988e87eba6f406cb144148def94dee5-4"></a><span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">"$x$"</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<a name="rest_code_e988e87eba6f406cb144148def94dee5-5"></a><span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">"$|\psi_n(x)|^2$"</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<a name="rest_code_e988e87eba6f406cb144148def94dee5-6"></a><span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">([])</span>
<a name="rest_code_e988e87eba6f406cb144148def94dee5-7"></a><span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">();</span>
</pre>
<img alt="Eigenfunctions for the first transformation" class="align-center" src="images/infinite_fdm/eigvecs_tanh.svg" style="width: 600px;">
</div>
<div class="section" id="second-transformation-xi-frac-2-pi-mathrm-atan-x">
<h4>Second transformation: <span class="math">\(\xi = \frac{2}{\pi}\mathrm{atan}(x)\)</span>
</h4>
<p>Let's consider first the transformation</p>
<div class="math">
\begin{equation*}
\xi = \frac{2}{\pi}\mathrm{atan}(x)\, .
\end{equation*}
</div>
<p>In this case</p>
<div class="math">
\begin{equation*}
\frac{\mathrm{d}\xi}{\mathrm{d}x} = \frac{2}{\pi(1 + x^2)} = \frac{2 \cos^2\xi}{\pi} \, ,
\end{equation*}
</div>
<p>and</p>
<div class="math">
\begin{equation*}
\frac{\mathrm{d}^2\xi}{\mathrm{d}x^2} = -\frac{4x}{\pi(1 + x^2)^2} = -\frac{4 \cos^4\xi \tan \xi}{\pi}\, .
\end{equation*}
</div>
<p>Once, again, we define the functions.</p>
<pre class="code ipython3"><a name="rest_code_cf933645f6d046e5938f91d79c4028ee-1"></a><span class="n">pot</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span>
<a name="rest_code_cf933645f6d046e5938f91d79c4028ee-2"></a><span class="n">fun</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">xi</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">tan</span><span class="p">(</span><span class="mf">0.5</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">xi</span><span class="p">)</span>
<a name="rest_code_cf933645f6d046e5938f91d79c4028ee-3"></a><span class="n">dxdxi</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">xi</span><span class="p">:</span> <span class="mi">2</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mf">0.5</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">xi</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>
<a name="rest_code_cf933645f6d046e5938f91d79c4028ee-4"></a><span class="n">dxdxi2</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">xi</span><span class="p">:</span> <span class="o">-</span><span class="mi">4</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mf">0.5</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">xi</span><span class="p">)</span><span class="o">**</span><span class="mi">4</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">tan</span><span class="p">(</span><span class="mf">0.5</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">xi</span><span class="p">)</span>
</pre>
<p>and run the function</p>
<pre class="code ipython3"><a name="rest_code_7cab2e5cd4334eb386b92c069fb402e0-1"></a><span class="n">x</span><span class="p">,</span> <span class="n">vals</span><span class="p">,</span> <span class="n">vecs</span> <span class="o">=</span> <span class="n">mapped_FD</span><span class="p">(</span><span class="n">pot</span><span class="p">,</span> <span class="n">fun</span><span class="p">,</span> <span class="n">dxdxi</span><span class="p">,</span> <span class="n">dxdxi2</span><span class="p">,</span> <span class="n">npts</span><span class="o">=</span><span class="mi">201</span><span class="p">)</span>
<a name="rest_code_7cab2e5cd4334eb386b92c069fb402e0-2"></a><span class="n">vals</span>
</pre>
<p>to obtain the following eigenvalues</p>
<pre class="literal-block">array([0.49997815, 1.49979632, 2.49930872, 3.49824697, 4.49627555,
       5.49295665])</pre>
<p>with this plot</p>
<pre class="code ipython3"><a name="rest_code_08e107bd696a47d5b2ac73d652456dde-1"></a><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<a name="rest_code_08e107bd696a47d5b2ac73d652456dde-2"></a><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">anal_vals</span><span class="p">)</span>
<a name="rest_code_08e107bd696a47d5b2ac73d652456dde-3"></a><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">vals</span><span class="p">,</span> <span class="s2">"o"</span><span class="p">)</span>
<a name="rest_code_08e107bd696a47d5b2ac73d652456dde-4"></a><span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s2">"Analytic"</span><span class="p">,</span> <span class="s2">"Finite differences"</span><span class="p">])</span>
<a name="rest_code_08e107bd696a47d5b2ac73d652456dde-5"></a><span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">"$n$"</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<a name="rest_code_08e107bd696a47d5b2ac73d652456dde-6"></a><span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">"$E_n$"</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<a name="rest_code_08e107bd696a47d5b2ac73d652456dde-7"></a><span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">();</span>
</pre>
<img alt="Eigenvalues for the second transformation" class="align-center" src="images/infinite_fdm/eigvals_atan.svg" style="width: 600px;"><p>and the following eigenfunctions.</p>
<pre class="code ipython3"><a name="rest_code_c6a575fdbdc448f3b00edcb04b3d940d-1"></a><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<a name="rest_code_c6a575fdbdc448f3b00edcb04b3d940d-2"></a><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">vecs</span><span class="p">[:,</span> <span class="p">:</span><span class="mi">3</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<a name="rest_code_c6a575fdbdc448f3b00edcb04b3d940d-3"></a><span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">"$x$"</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<a name="rest_code_c6a575fdbdc448f3b00edcb04b3d940d-4"></a><span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">"$|\psi|^2$"</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<a name="rest_code_c6a575fdbdc448f3b00edcb04b3d940d-5"></a><span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
<a name="rest_code_c6a575fdbdc448f3b00edcb04b3d940d-6"></a><span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">"$x$"</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<a name="rest_code_c6a575fdbdc448f3b00edcb04b3d940d-7"></a><span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">"$|\psi_n(x)|^2$"</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<a name="rest_code_c6a575fdbdc448f3b00edcb04b3d940d-8"></a><span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">([])</span>
<a name="rest_code_c6a575fdbdc448f3b00edcb04b3d940d-9"></a><span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">();</span>
</pre>
<img alt="Eigenfunctions for the second transformation" class="align-center" src="images/infinite_fdm/eigvecs_atan.svg" style="width: 600px;">
</div>
</div>
<div class="section" id="conclusion">
<h3>Conclusion</h3>
<p>The method works fine, although the differential equation is more
convoluted due to the change of variable. Although there are more
elegant methods to consider infinite domains, this is simple enough to
be solved in 10 lines of code.</p>
<p>We can see that the mapping <span class="math">\(\xi = \mathrm{atan}(x)\)</span>, covers
better the domain than <span class="math">\(\xi = \tanh(x)\)</span>, where most of the points
are placed in the center of the interval.</p>
<p>Thanks for reading!</p>
<small>
  <i>
    This post was written in the Jupyter notebook. You can
    <a href="downloads/notebooks/finite_diff_map.ipynb">download</a>
    this notebook, or see a static view on
    <a href="http://nbviewer.jupyter.org/url/nicoguaro.github.io/downloads/notebooks/finite_diff_map.ipynb">nbviewer</a>.
  <i>
</i></i></small>
</div>
</div>
    </div>
    </article><article class="post h-entry post-text"><header><h1 class="post-title p-name"><a href="posts/cyclic_colormaps/" class="u-url">Cyclic colormaps comparison</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn">Nicolás Guarín-Zapata</span></p>
            <p class="dateline"><a href="posts/cyclic_colormaps/" rel="bookmark"><time class="post-date published dt-published" datetime="2018-01-02T18:55:41-05:00" title="2018-01-02 18:55">2018-01-02 18:55</time></a></p>
                <p class="commentline">
        
    <a href="posts/cyclic_colormaps/#disqus_thread" data-disqus-identifier="cache/posts/cyclic_colormaps.html">Comments</a>


        </p>
</div>
    </header><div class="e-content entry-content">
    <div>
<p>I started this post looking for a
<a class="reference external" href="https://en.wikipedia.org/wiki/Diffusion_map">diffusion map</a> on Python,
that I didn't find. Then I continued following an
<a class="reference external" href="http://scikit-learn.org/stable/auto_examples/manifold/plot_compare_methods.html#sphx-glr-auto-examples-manifold-plot-compare-methods-py">example</a>
on <a class="reference external" href="https://en.wikipedia.org/wiki/Nonlinear_dimensionality_reduction">manifold learning</a>
by <a class="reference external" href="https://jakevdp.github.io/">Jake Vanderplas</a> on a <a class="reference external" href="https://commons.wikimedia.org/wiki/File:Diffusion_map_of_a_torodial_helix.jpg">different dataset</a>.
It worked nicely,</p>
<img alt="/images/manifold_learning_toroidal_helix.svg" src="images/manifold_learning_toroidal_helix.svg"><p>but the colormap used is <a class="reference external" href="https://matplotlib.org/examples/color/colormaps_reference.html">Spectral</a>, that is divergent. This made me think about
using a cyclic colormap, and ended up in
<a class="reference external" href="https://stackoverflow.com/q/23712207/3358223">this StackOverflow</a> question.
And I decided to compare some cyclic colormaps.</p>
<p>I picked up colormaps from different sources</p>
<ul class="simple">
<li>
<p><a class="reference external" href="https://matplotlib.org/cmocean/">cmocean</a>:</p>
<ul>
<li><p>phase</p></li>
</ul>
</li>
<li>
<p><a class="reference external" href="http://paraview.org/">Paraview</a>:</p>
<ul>
<li><p>hue_L60</p></li>
<li><p>erdc_iceFire</p></li>
<li><p>nic_Edge</p></li>
</ul>
</li>
<li>
<p><a class="reference external" href="https://github.com/bokeh/colorcet">Colorcet</a>:</p>
<ul>
<li><p>colorwheel</p></li>
<li><p>cyclic_mrybm_35_75_c68</p></li>
<li><p>cyclic_mygbm_30_95_c78</p></li>
</ul>
</li>
</ul>
<p>and, of course, <code class="docutils literal">hsv</code>. You can download the colormaps in text
format from <a class="reference external" href="downloads/cyclic_colormaps.zip">here</a>.</p>
<div class="section" id="comparison">
<h2>Comparison</h2>
<p>For all the examples below the following imports are done:</p>
<pre class="code python"><a name="rest_code_5c8a3f30a96e40bbadaf804f2c30b162-1"></a><span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">division</span><span class="p">,</span> <span class="n">print_function</span>
<a name="rest_code_5c8a3f30a96e40bbadaf804f2c30b162-2"></a><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<a name="rest_code_5c8a3f30a96e40bbadaf804f2c30b162-3"></a><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<a name="rest_code_5c8a3f30a96e40bbadaf804f2c30b162-4"></a><span class="kn">from</span> <span class="nn">matplotlib.colors</span> <span class="kn">import</span> <span class="n">LinearSegmentedColormap</span>
<a name="rest_code_5c8a3f30a96e40bbadaf804f2c30b162-5"></a><span class="kn">from</span> <span class="nn">colorspacious</span> <span class="kn">import</span> <span class="n">cspace_convert</span>
</pre>
<div class="section" id="color-map-test-image">
<h3>Color map test image</h3>
<p>Peter Kovesi proposed a way to compare cyclic colormaps on a
<a class="reference external" href="http://peterkovesi.com/projects/colourmaps/colourmaptestimage.html">paper</a>
on 2015. It consists of a spiral ramp with an undulation. In polar coordinates
it reads</p>
<div class="math">
\begin{equation*}
c = (A \rho^p \sin(n \theta) + \theta)\, \mathrm{mod}\, 2\pi
\end{equation*}
</div>
<p>with <span class="math">\(A\)</span> the amplitude of the oscilation, <span class="math">\(\rho\)</span> the normalized
radius in [0, 1], <span class="math">\(p\)</span> a positive number, and <span class="math">\(n\)</span> the number
of cycles.</p>
<p>And the following function creates the grid in Python</p>
<pre class="code python"><a name="rest_code_a851a372826749afb5dc91257f8cddb2-1"></a><span class="k">def</span> <span class="nf">circle_sine_ramp</span><span class="p">(</span><span class="n">r_max</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">r_min</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">amp</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">5</span><span class="p">,</span> <span class="n">cycles</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span>
<a name="rest_code_a851a372826749afb5dc91257f8cddb2-2"></a>                     <span class="n">power</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">nr</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">ntheta</span><span class="o">=</span><span class="mi">1025</span><span class="p">):</span>
<a name="rest_code_a851a372826749afb5dc91257f8cddb2-3"></a><span class="n">r</span><span class="p">,</span> <span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mgrid</span><span class="p">[</span><span class="n">r_min</span><span class="p">:</span><span class="n">r_max</span><span class="p">:</span><span class="n">nr</span><span class="o">*</span><span class="mi">1</span><span class="n">j</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">:</span><span class="n">ntheta</span><span class="o">*</span><span class="mi">1</span><span class="n">j</span><span class="p">]</span>
<a name="rest_code_a851a372826749afb5dc91257f8cddb2-4"></a><span class="n">r_norm</span> <span class="o">=</span> <span class="p">(</span><span class="n">r</span> <span class="o">-</span> <span class="n">r_min</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">r_max</span> <span class="o">-</span> <span class="n">r_min</span><span class="p">)</span>
<a name="rest_code_a851a372826749afb5dc91257f8cddb2-5"></a><span class="n">vals</span> <span class="o">=</span> <span class="n">amp</span> <span class="o">*</span> <span class="n">r_norm</span><span class="o">**</span><span class="n">power</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">cycles</span><span class="o">*</span><span class="n">t</span><span class="p">)</span> <span class="o">+</span> <span class="n">t</span>
<a name="rest_code_a851a372826749afb5dc91257f8cddb2-6"></a><span class="n">vals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mod</span><span class="p">(</span><span class="n">vals</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span>
<a name="rest_code_a851a372826749afb5dc91257f8cddb2-7"></a><span class="k">return</span> <span class="n">t</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">vals</span>
</pre>
<p>The following is the result</p>
<img alt="/images/sine_helix_cyclic_cmap.png" src="images/sine_helix_cyclic_cmap.png">
</div>
<div class="section" id="colorblindness-test">
<h3>Colorblindness test</h3>
<pre class="code python"><a name="rest_code_3825b24f6b02447d86b59d209735c79e-1"></a><span class="n">t</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">vals</span> <span class="o">=</span> <span class="n">circle_sine_ramp</span><span class="p">(</span><span class="n">cycles</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<a name="rest_code_3825b24f6b02447d86b59d209735c79e-2"></a><span class="n">cmaps</span> <span class="o">=</span> <span class="p">[</span><span class="s2">"hsv"</span><span class="p">,</span>
<a name="rest_code_3825b24f6b02447d86b59d209735c79e-3"></a>         <span class="s2">"cmocean_phase"</span><span class="p">,</span>
<a name="rest_code_3825b24f6b02447d86b59d209735c79e-4"></a>         <span class="s2">"hue_L60"</span><span class="p">,</span>
<a name="rest_code_3825b24f6b02447d86b59d209735c79e-5"></a>         <span class="s2">"erdc_iceFire"</span><span class="p">,</span>
<a name="rest_code_3825b24f6b02447d86b59d209735c79e-6"></a>         <span class="s2">"nic_Edge"</span><span class="p">,</span>
<a name="rest_code_3825b24f6b02447d86b59d209735c79e-7"></a>         <span class="s2">"colorwheel"</span><span class="p">,</span>
<a name="rest_code_3825b24f6b02447d86b59d209735c79e-8"></a>         <span class="s2">"cyclic_mrybm"</span><span class="p">,</span>
<a name="rest_code_3825b24f6b02447d86b59d209735c79e-9"></a>         <span class="s2">"cyclic_mygbm"</span><span class="p">]</span>
<a name="rest_code_3825b24f6b02447d86b59d209735c79e-10"></a><span class="n">severity</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">50</span><span class="p">]</span>
<a name="rest_code_3825b24f6b02447d86b59d209735c79e-11"></a><span class="k">for</span> <span class="n">colormap</span> <span class="ow">in</span> <span class="n">cmaps</span><span class="p">:</span>
<a name="rest_code_3825b24f6b02447d86b59d209735c79e-12"></a>    <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="n">colormap</span> <span class="o">+</span> <span class="s2">".txt"</span><span class="p">)</span>
<a name="rest_code_3825b24f6b02447d86b59d209735c79e-13"></a>    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<a name="rest_code_3825b24f6b02447d86b59d209735c79e-14"></a>    <span class="k">for</span> <span class="n">cont</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
<a name="rest_code_3825b24f6b02447d86b59d209735c79e-15"></a>        <span class="n">cvd_space</span> <span class="o">=</span> <span class="p">{</span><span class="s2">"name"</span><span class="p">:</span> <span class="s2">"sRGB1+CVD"</span><span class="p">,</span>
<a name="rest_code_3825b24f6b02447d86b59d209735c79e-16"></a>             <span class="s2">"cvd_type"</span><span class="p">:</span> <span class="n">cvd_type</span><span class="p">[</span><span class="n">cont</span><span class="p">],</span>
<a name="rest_code_3825b24f6b02447d86b59d209735c79e-17"></a>             <span class="s2">"severity"</span><span class="p">:</span> <span class="n">severity</span><span class="p">[</span><span class="n">cont</span><span class="p">]}</span>
<a name="rest_code_3825b24f6b02447d86b59d209735c79e-18"></a>        <span class="n">data2</span> <span class="o">=</span> <span class="n">cspace_convert</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">cvd_space</span><span class="p">,</span> <span class="s2">"sRGB1"</span><span class="p">)</span>
<a name="rest_code_3825b24f6b02447d86b59d209735c79e-19"></a>        <span class="n">data2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">data2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<a name="rest_code_3825b24f6b02447d86b59d209735c79e-20"></a>        <span class="n">cmap</span> <span class="o">=</span> <span class="n">LinearSegmentedColormap</span><span class="o">.</span><span class="n">from_list</span><span class="p">(</span><span class="s1">'my_colormap'</span><span class="p">,</span> <span class="n">data2</span><span class="p">)</span>
<a name="rest_code_3825b24f6b02447d86b59d209735c79e-21"></a>        <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">cont</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="s2">"polar"</span><span class="p">)</span>
<a name="rest_code_3825b24f6b02447d86b59d209735c79e-22"></a>        <span class="n">ax</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">vals</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">)</span>
<a name="rest_code_3825b24f6b02447d86b59d209735c79e-23"></a>        <span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">([])</span>
<a name="rest_code_3825b24f6b02447d86b59d209735c79e-24"></a>        <span class="n">ax</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([])</span>
<a name="rest_code_3825b24f6b02447d86b59d209735c79e-25"></a>    <span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="n">colormap</span><span class="p">)</span>
<a name="rest_code_3825b24f6b02447d86b59d209735c79e-26"></a>    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<a name="rest_code_3825b24f6b02447d86b59d209735c79e-27"></a>    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">colormap</span> <span class="o">+</span> <span class="s2">".png"</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>
</pre>
<div class="figure align-center">
<img alt="/images/hsv_eval.png" src="images/hsv_eval.png"><p class="caption"><code class="docutils literal">hsv</code> colormap comparison for different color vision deficiencies.</p>
</div>
<div class="figure align-center">
<img alt="/images/cmocean_phase_eval.png" src="images/cmocean_phase_eval.png"><p class="caption"><code class="docutils literal">Phase</code> colormap comparison for different color vision deficiencies.</p>
</div>
<div class="figure align-center">
<img alt="/images/hue_L60_eval.png" src="images/hue_L60_eval.png"><p class="caption"><code class="docutils literal">hue_L60</code> colormap comparison for different color vision deficiencies.</p>
</div>
<div class="figure align-center">
<img alt="/images/erdc_iceFire_eval.png" src="images/erdc_iceFire_eval.png"><p class="caption"><code class="docutils literal">erdc_iceFire</code> colormap comparison for different color vision deficiencies.</p>
</div>
<div class="figure align-center">
<img alt="/images/nic_Edge_eval.png" src="images/nic_Edge_eval.png"><p class="caption"><code class="docutils literal">nic_Edge</code> colormap comparison for different color vision deficiencies.</p>
</div>
<div class="figure align-center">
<img alt="/images/colorwheel_eval.png" src="images/colorwheel_eval.png"><p class="caption"><code class="docutils literal">Colorwheel</code> colormap comparison for different color vision deficiencies.</p>
</div>
<div class="figure align-center">
<img alt="/images/cyclic_mrybm_eval.png" src="images/cyclic_mrybm_eval.png"><p class="caption"><code class="docutils literal">Cyclic_mrybm</code> colormap comparison for different color vision deficiencies.</p>
</div>
<div class="figure align-center">
<img alt="/images/cyclic_mygbm_eval.png" src="images/cyclic_mygbm_eval.png"><p class="caption"><code class="docutils literal">Cyclic_mygbm</code> colormap comparison for different color vision deficiencies.</p>
</div>
</div>
</div>
<div class="section" id="randomly-generated-cyclic-colormaps">
<h2>Randomly generated cyclic colormaps</h2>
<p>What if we generate some random colormaps that are cyclic? How would they
look like?</p>
<p>Following are the snippet and resulting colormaps.</p>
<pre class="code python"><a name="rest_code_5423af3dbea44b6ebd812df9f316a78f-1"></a><span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">division</span><span class="p">,</span> <span class="n">print_function</span>
<a name="rest_code_5423af3dbea44b6ebd812df9f316a78f-2"></a><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<a name="rest_code_5423af3dbea44b6ebd812df9f316a78f-3"></a><span class="kn">from</span> <span class="nn">mpl_toolkits.mplot3d</span> <span class="kn">import</span> <span class="n">Axes3D</span>
<a name="rest_code_5423af3dbea44b6ebd812df9f316a78f-4"></a><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<a name="rest_code_5423af3dbea44b6ebd812df9f316a78f-5"></a><span class="kn">from</span> <span class="nn">matplotlib.colors</span> <span class="kn">import</span> <span class="n">LinearSegmentedColormap</span>
<a name="rest_code_5423af3dbea44b6ebd812df9f316a78f-6"></a>
<a name="rest_code_5423af3dbea44b6ebd812df9f316a78f-7"></a>
<a name="rest_code_5423af3dbea44b6ebd812df9f316a78f-8"></a><span class="c1"># Next line to silence pyflakes. This import is needed.</span>
<a name="rest_code_5423af3dbea44b6ebd812df9f316a78f-9"></a><span class="n">Axes3D</span>
<a name="rest_code_5423af3dbea44b6ebd812df9f316a78f-10"></a>
<a name="rest_code_5423af3dbea44b6ebd812df9f316a78f-11"></a><span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="s2">"all"</span><span class="p">)</span>
<a name="rest_code_5423af3dbea44b6ebd812df9f316a78f-12"></a><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<a name="rest_code_5423af3dbea44b6ebd812df9f316a78f-13"></a><span class="n">fig2</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<a name="rest_code_5423af3dbea44b6ebd812df9f316a78f-14"></a><span class="n">nx</span> <span class="o">=</span> <span class="mi">4</span>
<a name="rest_code_5423af3dbea44b6ebd812df9f316a78f-15"></a><span class="n">ny</span> <span class="o">=</span> <span class="mi">4</span>
<a name="rest_code_5423af3dbea44b6ebd812df9f316a78f-16"></a><span class="n">azimuths</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">361</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<a name="rest_code_5423af3dbea44b6ebd812df9f316a78f-17"></a><span class="n">zeniths</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mi">70</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<a name="rest_code_5423af3dbea44b6ebd812df9f316a78f-18"></a><span class="n">values</span> <span class="o">=</span> <span class="n">azimuths</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">30</span><span class="p">,</span> <span class="mi">361</span><span class="p">))</span>
<a name="rest_code_5423af3dbea44b6ebd812df9f316a78f-19"></a><span class="k">for</span> <span class="n">cont</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nx</span> <span class="o">*</span> <span class="n">ny</span><span class="p">):</span>
<a name="rest_code_5423af3dbea44b6ebd812df9f316a78f-20"></a>    <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="n">cont</span><span class="p">)</span>
<a name="rest_code_5423af3dbea44b6ebd812df9f316a78f-21"></a>    <span class="n">rad</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)</span>
<a name="rest_code_5423af3dbea44b6ebd812df9f316a78f-22"></a>    <span class="n">center</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="n">rad</span><span class="p">,</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">rad</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<a name="rest_code_5423af3dbea44b6ebd812df9f316a78f-23"></a>    <span class="n">mat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<a name="rest_code_5423af3dbea44b6ebd812df9f316a78f-24"></a>    <span class="n">rot_mat</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">qr</span><span class="p">(</span><span class="n">mat</span><span class="p">)</span>
<a name="rest_code_5423af3dbea44b6ebd812df9f316a78f-25"></a>    <span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mi">256</span><span class="p">)</span>
<a name="rest_code_5423af3dbea44b6ebd812df9f316a78f-26"></a>    <span class="n">x</span> <span class="o">=</span> <span class="n">rad</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
<a name="rest_code_5423af3dbea44b6ebd812df9f316a78f-27"></a>    <span class="n">y</span> <span class="o">=</span> <span class="n">rad</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
<a name="rest_code_5423af3dbea44b6ebd812df9f316a78f-28"></a>    <span class="n">z</span> <span class="o">=</span> <span class="mf">0.0</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
<a name="rest_code_5423af3dbea44b6ebd812df9f316a78f-29"></a>    <span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">((</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">))</span>
<a name="rest_code_5423af3dbea44b6ebd812df9f316a78f-30"></a>    <span class="n">X</span> <span class="o">=</span> <span class="n">rot_mat</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">X</span><span class="p">)</span> <span class="o">+</span> <span class="n">center</span>
<a name="rest_code_5423af3dbea44b6ebd812df9f316a78f-31"></a>
<a name="rest_code_5423af3dbea44b6ebd812df9f316a78f-32"></a>    <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">ny</span><span class="p">,</span> <span class="n">nx</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">cont</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="s1">'polar'</span><span class="p">)</span>
<a name="rest_code_5423af3dbea44b6ebd812df9f316a78f-33"></a>    <span class="n">cmap</span> <span class="o">=</span> <span class="n">LinearSegmentedColormap</span><span class="o">.</span><span class="n">from_list</span><span class="p">(</span><span class="s1">'my_colormap'</span><span class="p">,</span> <span class="n">X</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
<a name="rest_code_5423af3dbea44b6ebd812df9f316a78f-34"></a>    <span class="n">ax</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span><span class="n">azimuths</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mf">180.0</span><span class="p">,</span> <span class="n">zeniths</span><span class="p">,</span> <span class="n">values</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">)</span>
<a name="rest_code_5423af3dbea44b6ebd812df9f316a78f-35"></a>    <span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">([])</span>
<a name="rest_code_5423af3dbea44b6ebd812df9f316a78f-36"></a>    <span class="n">ax</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([])</span>
<a name="rest_code_5423af3dbea44b6ebd812df9f316a78f-37"></a>
<a name="rest_code_5423af3dbea44b6ebd812df9f316a78f-38"></a>    <span class="n">ax2</span> <span class="o">=</span> <span class="n">fig2</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">ny</span><span class="p">,</span> <span class="n">nx</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">cont</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="s1">'3d'</span><span class="p">)</span>
<a name="rest_code_5423af3dbea44b6ebd812df9f316a78f-39"></a>    <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:],</span> <span class="n">X</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:],</span> <span class="n">X</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="p">:])</span>
<a name="rest_code_5423af3dbea44b6ebd812df9f316a78f-40"></a>    <span class="n">ax2</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<a name="rest_code_5423af3dbea44b6ebd812df9f316a78f-41"></a>    <span class="n">ax2</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<a name="rest_code_5423af3dbea44b6ebd812df9f316a78f-42"></a>    <span class="n">ax2</span><span class="o">.</span><span class="n">set_zlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<a name="rest_code_5423af3dbea44b6ebd812df9f316a78f-43"></a>    <span class="n">ax2</span><span class="o">.</span><span class="n">view_init</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="o">-</span><span class="mi">60</span><span class="p">)</span>
<a name="rest_code_5423af3dbea44b6ebd812df9f316a78f-44"></a>    <span class="n">ax2</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">])</span>
<a name="rest_code_5423af3dbea44b6ebd812df9f316a78f-45"></a>    <span class="n">ax2</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">])</span>
<a name="rest_code_5423af3dbea44b6ebd812df9f316a78f-46"></a>    <span class="n">ax2</span><span class="o">.</span><span class="n">set_zticks</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">])</span>
<a name="rest_code_5423af3dbea44b6ebd812df9f316a78f-47"></a>    <span class="n">ax2</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">([])</span>
<a name="rest_code_5423af3dbea44b6ebd812df9f316a78f-48"></a>    <span class="n">ax2</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">([])</span>
<a name="rest_code_5423af3dbea44b6ebd812df9f316a78f-49"></a>    <span class="n">ax2</span><span class="o">.</span><span class="n">set_zticklabels</span><span class="p">([])</span>
<a name="rest_code_5423af3dbea44b6ebd812df9f316a78f-50"></a>
<a name="rest_code_5423af3dbea44b6ebd812df9f316a78f-51"></a>
<a name="rest_code_5423af3dbea44b6ebd812df9f316a78f-52"></a><span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">"random_cmaps.png"</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span> <span class="n">transparent</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a name="rest_code_5423af3dbea44b6ebd812df9f316a78f-53"></a><span class="n">fig2</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">"random_cmaps_traj.svg"</span><span class="p">,</span> <span class="n">transparent</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre>
<div class="figure align-center">
<img alt="/images/random_cmaps.png" src="images/random_cmaps.png"><p class="caption">16 randomly generated colormaps.</p>
</div>
<div class="figure align-center">
<img alt="/images/random_cmaps_traj.svg" src="images/random_cmaps_traj.svg"><p class="caption">Trajectories in RGB space for the randomly generated colormaps.</p>
</div>
<p>A good idea would be to take these colormaps and optimize some perceptual
parameters such as lightness to get some usable ones.</p>
</div>
<div class="section" id="conclusions">
<h2>Conclusions</h2>
<p>I probably would use <code class="docutils literal">phase</code>, <code class="docutils literal">colorwheel</code>, or <code class="docutils literal">mrybm</code> in the
future.</p>
<div class="figure align-center">
<img alt="/images/toroidal_helix_phase.svg" src="images/toroidal_helix_phase.svg"><p class="caption">Initial image using <code class="docutils literal">phase</code>.</p>
</div>
<div class="figure align-center">
<img alt="/images/toroidal_helix_colorwheel.svg" src="images/toroidal_helix_colorwheel.svg"><p class="caption">Initial image using <code class="docutils literal">colorwheel</code>.</p>
</div>
<div class="figure align-center">
<img alt="/images/toroidal_helix_mrybm.svg" src="images/toroidal_helix_mrybm.svg"><p class="caption">Initial image using <code class="docutils literal">mrybm</code>.</p>
</div>
</div>
<div class="section" id="references">
<h2>References</h2>
<ol class="arabic simple">
<li><p>Peter Kovesi. Good Colour Maps: How to Design Them.
arXiv:1509.03700 [cs.GR] 2015</p></li>
</ol>
</div>
</div>
    </div>
    </article>
</div>

        <nav class="postindexpager"><ul class="pager">
<li class="next">
                <a href="index-5.html" rel="next">Older posts</a>
            </li>
        </ul></nav><script>var disqus_shortname="nicoguaro-github";(function(){var a=document.createElement("script");a.async=true;a.src="https://"+disqus_shortname+".disqus.com/count.js";(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(a)}());</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML" integrity="sha384-3lJUsx1TJHt7BA4udB5KPnDrlkO8T6J6v/op7ui0BbCjvZ9WqV4Xm6DTP6kQ/iBH" crossorigin="anonymous"></script><script type="text/x-mathjax-config">
        MathJax.Hub.Config({tex2jax: {inlineMath: [['$latex ','$'], ['\\(','\\)']]}});
        </script><footer id="footer"><p>Contents © 2021 <a href="mailto:nicoguarin@gmail.com">Nicolás Guarín-Zapata</a> - Powered by <a href="https://getnikola.com" rel="nofollow">Nikola</a> 
<a rel="license" href="http://creativecommons.org/licenses/by/4.0/">
<img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by/4.0/88x31.png"></a></p>
            
        </footer>
</div>
    </div>
    <label for="sidebar-checkbox" class="sidebar-toggle"></label>
    
<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-145359674-1', 'auto');
ga('send', 'pageview');
</script><script src="assets/js/all-nocdn.js"></script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates -->
</body>
</html>
