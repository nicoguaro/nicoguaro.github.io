<!DOCTYPE html>
<html prefix="" lang="es">
<head>
<meta charset="utf-8">
<meta name="description" content="Blog y sitio web personales">
<meta name="viewport" content="width=device-width">
<title>Nicolás' blog | Nicolás' blog</title>
<link href="../assets/css/all.css" rel="stylesheet" type="text/css">
<link rel="stylesheet" href="//fonts.googleapis.com/css?family=PT+Serif:400,400italic,700|PT+Sans:400">
<link rel="alternate" type="application/rss+xml" title="RSS (en)" href="../rss.xml">
<link rel="alternate" type="application/rss+xml" title="RSS (es)" href="rss.xml">
<link rel="canonical" href="https://nicoguaro.github.io/es/">
<link rel="next" href="index-5.html" type="text/html">
<!--[if lt IE 9]><script src="../assets/js/html5.js"></script><![endif]-->
</head>
<body>
    <a href="#content" class="sr-only sr-only-focusable">Ir al contenido principal</a>
    <!-- Target for toggling the sidebar `.sidebar-checkbox` is for regular
            styles, `#sidebar-checkbox` for behavior. -->
    <input type="checkbox" class="sidebar-checkbox" id="sidebar-checkbox"><!-- Toggleable sidebar --><div class="sidebar" id="sidebar">
        <div class="sidebar-item">
            <p>A reserved <a href="https://getnikola.com" target="_blank">Nikola</a> theme that places the utmost gravity on content with a hidden drawer. Made by <a href="https://twitter.com/mdo" target="_blank">@mdo</a> for Jekyll,
            ported to Nikola by <a href="https://twitter.com/ralsina" target="_blank">@ralsina</a>.</p>
        </div>
        
    <nav id="menu" role="navigation" class="sidebar-nav"><a class="sidebar-nav-item" href="../pages/about/">About</a>
        <a class="sidebar-nav-item" href="../index.html">Blog</a>
        <a class="sidebar-nav-item" href="../pages/preprints-archive/">Preprints</a>
        <a class="sidebar-nav-item" href="../pages/links/">Links</a>
        <a class="sidebar-nav-item" href="../archive.html">Archives</a>
        <a class="sidebar-nav-item" href="../categories/">Tags</a>
        <a class="sidebar-nav-item" href="../rss.xml">RSS feed</a>
    
    
    </nav>
</div>

    <!-- Wrap is the content to shift when toggling the sidebar. We wrap the
         content to avoid any CSS collisions with our real content. -->
    <div class="wrap">
      <div class="masthead">
        <div class="container">
          
    <h3 id="brand" class="masthead-title">
      <a href="https://nicoguaro.github.io/es/" title="Nicolás' blog" rel="home">Nicolás' blog</a>
    </h3>

        </div>
      </div>

      <div class="container content" id="content">
        

<div class="posts">
    <article class="post h-entry post-text"><header><h1 class="post-title p-name"><a href="posts/duplicating-hankel-plot-from-as/" class="u-url">Duplicando un gráfico de la función Hankel de Abramowitz y Stegun</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn">Nicolás Guarín-Zapata</span></p>
            <p class="dateline"><a href="posts/duplicating-hankel-plot-from-as/" rel="bookmark"><time class="post-date published dt-published" datetime="2025-04-15T15:28:45-05:00" title="2025-04-15 15:28">2025-04-15 15:28</time></a></p>
                <p class="commentline">
    
    <a href="posts/duplicating-hankel-plot-from-as/#disqus_thread" data-disqus-identifier="cache/posts/duplicating-hankel-plot-from-as.html">Comentarios</a>


        </p>
</div>
    </header><div class="e-content entry-content">
    <p>Recientemente, tuve una discusión en clase sobre las soluciones de ecuaciones
diferenciales parciales y cómo la visualización jugó un papel importante mucho
antes de que las computadoras digitales fueran omnipresentes. También hablamos
sobre el <a class="reference external" href="https://es.wikipedia.org/wiki/Abramowitz_y_Stegun">Manual de Funciones Matemáticas</a>
o <em>Abramowitz y Stegun</em> <a class="brackets" href="posts/duplicating-hankel-plot-from-as/#f1" id="footnote-reference-1" role="doc-noteref"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></a>, como se le conoce comúnmente.</p>
<p>Afortunadamente, John D. Cook replicó el siguiente gráfico de Abramowitz y
Stegun en su <a class="reference external" href="https://www.johndcook.com/blog/2025/01/22/duplicating-hankel-plot-from-as/">blog</a>
utilizando Mathematica. Aunque esta figura fue publicada originalmente en <a class="brackets" href="posts/duplicating-hankel-plot-from-as/#f2" id="footnote-reference-2" role="doc-noteref"><span class="fn-bracket">[</span>2<span class="fn-bracket">]</span></a>.</p>
<img alt="Gráficos de contorno para el módulo y la fase de la función de Hankel sobre el plano complejo." class="align-center" src="../images/A&amp;S/abramowitz_stegun-hankel.png" style="width: 800px;"><p>Entonces, intenté replicar esta figura usando <a class="reference external" href="https://matplotlib.org/">Matplotlib</a>.
El siguiente gráfico es el resultado de usar la función <code class="docutils literal">contour</code> en el módulo
y la fase de la función de Hankel.</p>
<img alt="Gráficos de contorno para el módulo y la fase de la función de Hankel sobre el plano complejo." class="align-center" src="../images/A&amp;S/abramowitz_stegun-hankel-0.svg" style="width: 800px;"><p>Esto se obtuvo con el siguiente código.</p>
<div class="code"><pre class="code python"><a id="rest_code_6d3e5b48d3c3457598f508917938e8f6-1" name="rest_code_6d3e5b48d3c3457598f508917938e8f6-1" href="posts/duplicating-hankel-plot-from-as/#rest_code_6d3e5b48d3c3457598f508917938e8f6-1"></a><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<a id="rest_code_6d3e5b48d3c3457598f508917938e8f6-2" name="rest_code_6d3e5b48d3c3457598f508917938e8f6-2" href="posts/duplicating-hankel-plot-from-as/#rest_code_6d3e5b48d3c3457598f508917938e8f6-2"></a><span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<a id="rest_code_6d3e5b48d3c3457598f508917938e8f6-3" name="rest_code_6d3e5b48d3c3457598f508917938e8f6-3" href="posts/duplicating-hankel-plot-from-as/#rest_code_6d3e5b48d3c3457598f508917938e8f6-3"></a><span class="kn">from</span><span class="w"> </span><span class="nn">scipy.special</span><span class="w"> </span><span class="kn">import</span> <span class="n">hankel1</span>
<a id="rest_code_6d3e5b48d3c3457598f508917938e8f6-4" name="rest_code_6d3e5b48d3c3457598f508917938e8f6-4" href="posts/duplicating-hankel-plot-from-as/#rest_code_6d3e5b48d3c3457598f508917938e8f6-4"></a>
<a id="rest_code_6d3e5b48d3c3457598f508917938e8f6-5" name="rest_code_6d3e5b48d3c3457598f508917938e8f6-5" href="posts/duplicating-hankel-plot-from-as/#rest_code_6d3e5b48d3c3457598f508917938e8f6-5"></a><span class="n">y</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mgrid</span><span class="p">[</span><span class="o">-</span><span class="mf">1.5</span><span class="p">:</span><span class="mf">1.5</span><span class="p">:</span><span class="mi">2500</span><span class="n">j</span><span class="p">,</span> <span class="o">-</span><span class="mi">4</span><span class="p">:</span><span class="mi">2</span><span class="p">:</span><span class="mi">5000</span><span class="n">j</span><span class="p">]</span>
<a id="rest_code_6d3e5b48d3c3457598f508917938e8f6-6" name="rest_code_6d3e5b48d3c3457598f508917938e8f6-6" href="posts/duplicating-hankel-plot-from-as/#rest_code_6d3e5b48d3c3457598f508917938e8f6-6"></a><span class="n">z</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="n">j</span><span class="o">*</span><span class="n">y</span>
<a id="rest_code_6d3e5b48d3c3457598f508917938e8f6-7" name="rest_code_6d3e5b48d3c3457598f508917938e8f6-7" href="posts/duplicating-hankel-plot-from-as/#rest_code_6d3e5b48d3c3457598f508917938e8f6-7"></a><span class="n">H</span> <span class="o">=</span> <span class="n">hankel1</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">z</span><span class="p">)</span>
<a id="rest_code_6d3e5b48d3c3457598f508917938e8f6-8" name="rest_code_6d3e5b48d3c3457598f508917938e8f6-8" href="posts/duplicating-hankel-plot-from-as/#rest_code_6d3e5b48d3c3457598f508917938e8f6-8"></a><span class="n">abs_H</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">H</span><span class="p">)</span>
<a id="rest_code_6d3e5b48d3c3457598f508917938e8f6-9" name="rest_code_6d3e5b48d3c3457598f508917938e8f6-9" href="posts/duplicating-hankel-plot-from-as/#rest_code_6d3e5b48d3c3457598f508917938e8f6-9"></a><span class="n">arg_H</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">rad2deg</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">angle</span><span class="p">(</span><span class="n">H</span><span class="p">))</span>
<a id="rest_code_6d3e5b48d3c3457598f508917938e8f6-10" name="rest_code_6d3e5b48d3c3457598f508917938e8f6-10" href="posts/duplicating-hankel-plot-from-as/#rest_code_6d3e5b48d3c3457598f508917938e8f6-10"></a>
<a id="rest_code_6d3e5b48d3c3457598f508917938e8f6-11" name="rest_code_6d3e5b48d3c3457598f508917938e8f6-11" href="posts/duplicating-hankel-plot-from-as/#rest_code_6d3e5b48d3c3457598f508917938e8f6-11"></a><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<a id="rest_code_6d3e5b48d3c3457598f508917938e8f6-12" name="rest_code_6d3e5b48d3c3457598f508917938e8f6-12" href="posts/duplicating-hankel-plot-from-as/#rest_code_6d3e5b48d3c3457598f508917938e8f6-12"></a>
<a id="rest_code_6d3e5b48d3c3457598f508917938e8f6-13" name="rest_code_6d3e5b48d3c3457598f508917938e8f6-13" href="posts/duplicating-hankel-plot-from-as/#rest_code_6d3e5b48d3c3457598f508917938e8f6-13"></a><span class="n">plt</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">abs_H</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="s2">"black"</span><span class="p">)</span>
<a id="rest_code_6d3e5b48d3c3457598f508917938e8f6-14" name="rest_code_6d3e5b48d3c3457598f508917938e8f6-14" href="posts/duplicating-hankel-plot-from-as/#rest_code_6d3e5b48d3c3457598f508917938e8f6-14"></a><span class="n">plt</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">arg_H</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="s2">"#757575"</span><span class="p">)</span>
<a id="rest_code_6d3e5b48d3c3457598f508917938e8f6-15" name="rest_code_6d3e5b48d3c3457598f508917938e8f6-15" href="posts/duplicating-hankel-plot-from-as/#rest_code_6d3e5b48d3c3457598f508917938e8f6-15"></a>
<a id="rest_code_6d3e5b48d3c3457598f508917938e8f6-16" name="rest_code_6d3e5b48d3c3457598f508917938e8f6-16" href="posts/duplicating-hankel-plot-from-as/#rest_code_6d3e5b48d3c3457598f508917938e8f6-16"></a>
<a id="rest_code_6d3e5b48d3c3457598f508917938e8f6-17" name="rest_code_6d3e5b48d3c3457598f508917938e8f6-17" href="posts/duplicating-hankel-plot-from-as/#rest_code_6d3e5b48d3c3457598f508917938e8f6-17"></a><span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">))</span>
<a id="rest_code_6d3e5b48d3c3457598f508917938e8f6-18" name="rest_code_6d3e5b48d3c3457598f508917938e8f6-18" href="posts/duplicating-hankel-plot-from-as/#rest_code_6d3e5b48d3c3457598f508917938e8f6-18"></a><span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mf">1.5</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">))</span>
<a id="rest_code_6d3e5b48d3c3457598f508917938e8f6-19" name="rest_code_6d3e5b48d3c3457598f508917938e8f6-19" href="posts/duplicating-hankel-plot-from-as/#rest_code_6d3e5b48d3c3457598f508917938e8f6-19"></a>
<a id="rest_code_6d3e5b48d3c3457598f508917938e8f6-20" name="rest_code_6d3e5b48d3c3457598f508917938e8f6-20" href="posts/duplicating-hankel-plot-from-as/#rest_code_6d3e5b48d3c3457598f508917938e8f6-20"></a><span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">"Real axis"</span><span class="p">)</span>
<a id="rest_code_6d3e5b48d3c3457598f508917938e8f6-21" name="rest_code_6d3e5b48d3c3457598f508917938e8f6-21" href="posts/duplicating-hankel-plot-from-as/#rest_code_6d3e5b48d3c3457598f508917938e8f6-21"></a><span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">"Imaginary axis"</span><span class="p">)</span>
<a id="rest_code_6d3e5b48d3c3457598f508917938e8f6-22" name="rest_code_6d3e5b48d3c3457598f508917938e8f6-22" href="posts/duplicating-hankel-plot-from-as/#rest_code_6d3e5b48d3c3457598f508917938e8f6-22"></a>
<a id="rest_code_6d3e5b48d3c3457598f508917938e8f6-23" name="rest_code_6d3e5b48d3c3457598f508917938e8f6-23" href="posts/duplicating-hankel-plot-from-as/#rest_code_6d3e5b48d3c3457598f508917938e8f6-23"></a><span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="s2">"True"</span><span class="p">)</span>
<a id="rest_code_6d3e5b48d3c3457598f508917938e8f6-24" name="rest_code_6d3e5b48d3c3457598f508917938e8f6-24" href="posts/duplicating-hankel-plot-from-as/#rest_code_6d3e5b48d3c3457598f508917938e8f6-24"></a><span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">"image"</span><span class="p">)</span>
<a id="rest_code_6d3e5b48d3c3457598f508917938e8f6-25" name="rest_code_6d3e5b48d3c3457598f508917938e8f6-25" href="posts/duplicating-hankel-plot-from-as/#rest_code_6d3e5b48d3c3457598f508917938e8f6-25"></a><span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">"abramowitz_stegun-hankel-0.svg"</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s2">"tight"</span><span class="p">)</span>
<a id="rest_code_6d3e5b48d3c3457598f508917938e8f6-26" name="rest_code_6d3e5b48d3c3457598f508917938e8f6-26" href="posts/duplicating-hankel-plot-from-as/#rest_code_6d3e5b48d3c3457598f508917938e8f6-26"></a><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
<div class="line-block">
<div class="line"><br></div>
</div>
<p>Existen algunos problemas con el salto a través de la parte negativa de la
línea real. Podemos aplicar una máscara con el siguiente código:</p>
<div class="code"><pre class="code python"><a id="rest_code_fb583c3be2904ae99c75c47fc33299c7-1" name="rest_code_fb583c3be2904ae99c75c47fc33299c7-1" href="posts/duplicating-hankel-plot-from-as/#rest_code_fb583c3be2904ae99c75c47fc33299c7-1"></a><span class="n">abs_H</span><span class="p">[(</span><span class="n">x</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="o">*</span>  <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">0.01</span><span class="p">)]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
</pre></div>
<p>Además, tenemos algunos problemas alrededor de ±180° que corresponden al mismo
valor de fase, pero el <a class="reference external" href="https://en.wikipedia.org/wiki/Marching_squares">algoritmo de contorno</a>
falla—quizás exista una variante de los <em>marching square</em> que permita
trabajar con datos periódicos—. Para solucionar este problema, apliqué el
siguiente truco:</p>
<div class="code"><pre class="code python"><a id="rest_code_e369df7edffc491fa60c676d8c0364d7-1" name="rest_code_e369df7edffc491fa60c676d8c0364d7-1" href="posts/duplicating-hankel-plot-from-as/#rest_code_e369df7edffc491fa60c676d8c0364d7-1"></a><span class="n">arg_H</span><span class="p">[</span><span class="n">arg_H</span> <span class="o">&lt;</span> <span class="o">-</span><span class="mi">179</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">360</span>
<a id="rest_code_e369df7edffc491fa60c676d8c0364d7-2" name="rest_code_e369df7edffc491fa60c676d8c0364d7-2" href="posts/duplicating-hankel-plot-from-as/#rest_code_e369df7edffc491fa60c676d8c0364d7-2"></a><span class="n">arg_H</span><span class="p">[</span><span class="n">arg_H</span> <span class="o">&lt;</span> <span class="o">-</span><span class="mi">178</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
</pre></div>
<p>Y obtenemos la siguiente figura.</p>
<img alt="Gráficos de contorno para el módulo y la fase de la función de Hankel sobre el plano complejo." class="align-center" src="../images/A&amp;S/abramowitz_stegun-hankel-plain.svg" style="width: 800px;"><p>Nos faltan las etiquetas que muestran el valor de algunas curvas de nivel.
Si lo hacemos automáticamente, obtenemos la siguiente figura.</p>
<img alt="Gráficos de contorno para el módulo y la fase de la función de Hankel sobre el plano complejo." class="align-center" src="../images/A&amp;S/abramowitz_stegun-hankel-auto.svg" style="width: 800px;"><p>Para obtener una figura más cercana a la original, Matplotlib tiene un
<a class="reference external" href="https://matplotlib.org/stable/api/contour_api.html#matplotlib.contour.ContourLabeler.clabel">parámetro opcional</a>
llamado <code class="docutils literal">manual</code> que permite al usuario colocar las
etiquetas de los contornos manualmente.</p>
<p>La siguiente figura se acerca más al original.</p>
<img alt="Gráficos de contorno para el módulo y la fase de la función de Hankel sobre el plano complejo." class="align-center" src="../images/A&amp;S/abramowitz_stegun-hankel-manual.svg" style="width: 800px;"><p>El siguiente bloque de código permite obtener la versión final. Puedes
descargarlo <a class="reference external" href="../downloads/hankel_plot.py">aquí</a></p>
<div class="code"><pre class="code python"><a id="rest_code_d2a4bc595ce848ffbb91a01407370f87-1" name="rest_code_d2a4bc595ce848ffbb91a01407370f87-1" href="posts/duplicating-hankel-plot-from-as/#rest_code_d2a4bc595ce848ffbb91a01407370f87-1"></a><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<a id="rest_code_d2a4bc595ce848ffbb91a01407370f87-2" name="rest_code_d2a4bc595ce848ffbb91a01407370f87-2" href="posts/duplicating-hankel-plot-from-as/#rest_code_d2a4bc595ce848ffbb91a01407370f87-2"></a><span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<a id="rest_code_d2a4bc595ce848ffbb91a01407370f87-3" name="rest_code_d2a4bc595ce848ffbb91a01407370f87-3" href="posts/duplicating-hankel-plot-from-as/#rest_code_d2a4bc595ce848ffbb91a01407370f87-3"></a><span class="kn">from</span><span class="w"> </span><span class="nn">scipy.special</span><span class="w"> </span><span class="kn">import</span> <span class="n">hankel1</span>
<a id="rest_code_d2a4bc595ce848ffbb91a01407370f87-4" name="rest_code_d2a4bc595ce848ffbb91a01407370f87-4" href="posts/duplicating-hankel-plot-from-as/#rest_code_d2a4bc595ce848ffbb91a01407370f87-4"></a>
<a id="rest_code_d2a4bc595ce848ffbb91a01407370f87-5" name="rest_code_d2a4bc595ce848ffbb91a01407370f87-5" href="posts/duplicating-hankel-plot-from-as/#rest_code_d2a4bc595ce848ffbb91a01407370f87-5"></a>
<a id="rest_code_d2a4bc595ce848ffbb91a01407370f87-6" name="rest_code_d2a4bc595ce848ffbb91a01407370f87-6" href="posts/duplicating-hankel-plot-from-as/#rest_code_d2a4bc595ce848ffbb91a01407370f87-6"></a><span class="c1">#%% Data</span>
<a id="rest_code_d2a4bc595ce848ffbb91a01407370f87-7" name="rest_code_d2a4bc595ce848ffbb91a01407370f87-7" href="posts/duplicating-hankel-plot-from-as/#rest_code_d2a4bc595ce848ffbb91a01407370f87-7"></a><span class="n">y</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mgrid</span><span class="p">[</span><span class="o">-</span><span class="mf">1.5</span><span class="p">:</span><span class="mf">1.5</span><span class="p">:</span><span class="mi">2500</span><span class="n">j</span><span class="p">,</span> <span class="o">-</span><span class="mi">4</span><span class="p">:</span><span class="mi">2</span><span class="p">:</span><span class="mi">5000</span><span class="n">j</span><span class="p">]</span>
<a id="rest_code_d2a4bc595ce848ffbb91a01407370f87-8" name="rest_code_d2a4bc595ce848ffbb91a01407370f87-8" href="posts/duplicating-hankel-plot-from-as/#rest_code_d2a4bc595ce848ffbb91a01407370f87-8"></a><span class="n">z</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="n">j</span><span class="o">*</span><span class="n">y</span>
<a id="rest_code_d2a4bc595ce848ffbb91a01407370f87-9" name="rest_code_d2a4bc595ce848ffbb91a01407370f87-9" href="posts/duplicating-hankel-plot-from-as/#rest_code_d2a4bc595ce848ffbb91a01407370f87-9"></a><span class="n">H</span> <span class="o">=</span> <span class="n">hankel1</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">z</span><span class="p">)</span>
<a id="rest_code_d2a4bc595ce848ffbb91a01407370f87-10" name="rest_code_d2a4bc595ce848ffbb91a01407370f87-10" href="posts/duplicating-hankel-plot-from-as/#rest_code_d2a4bc595ce848ffbb91a01407370f87-10"></a>
<a id="rest_code_d2a4bc595ce848ffbb91a01407370f87-11" name="rest_code_d2a4bc595ce848ffbb91a01407370f87-11" href="posts/duplicating-hankel-plot-from-as/#rest_code_d2a4bc595ce848ffbb91a01407370f87-11"></a><span class="n">abs_H</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">H</span><span class="p">)</span>
<a id="rest_code_d2a4bc595ce848ffbb91a01407370f87-12" name="rest_code_d2a4bc595ce848ffbb91a01407370f87-12" href="posts/duplicating-hankel-plot-from-as/#rest_code_d2a4bc595ce848ffbb91a01407370f87-12"></a><span class="n">abs_H</span><span class="p">[(</span><span class="n">x</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="o">*</span>  <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">0.01</span><span class="p">)]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
<a id="rest_code_d2a4bc595ce848ffbb91a01407370f87-13" name="rest_code_d2a4bc595ce848ffbb91a01407370f87-13" href="posts/duplicating-hankel-plot-from-as/#rest_code_d2a4bc595ce848ffbb91a01407370f87-13"></a><span class="n">levels_abs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">3.3</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">)</span>
<a id="rest_code_d2a4bc595ce848ffbb91a01407370f87-14" name="rest_code_d2a4bc595ce848ffbb91a01407370f87-14" href="posts/duplicating-hankel-plot-from-as/#rest_code_d2a4bc595ce848ffbb91a01407370f87-14"></a>
<a id="rest_code_d2a4bc595ce848ffbb91a01407370f87-15" name="rest_code_d2a4bc595ce848ffbb91a01407370f87-15" href="posts/duplicating-hankel-plot-from-as/#rest_code_d2a4bc595ce848ffbb91a01407370f87-15"></a>
<a id="rest_code_d2a4bc595ce848ffbb91a01407370f87-16" name="rest_code_d2a4bc595ce848ffbb91a01407370f87-16" href="posts/duplicating-hankel-plot-from-as/#rest_code_d2a4bc595ce848ffbb91a01407370f87-16"></a><span class="n">arg_H</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">rad2deg</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">angle</span><span class="p">(</span><span class="n">H</span><span class="p">))</span>
<a id="rest_code_d2a4bc595ce848ffbb91a01407370f87-17" name="rest_code_d2a4bc595ce848ffbb91a01407370f87-17" href="posts/duplicating-hankel-plot-from-as/#rest_code_d2a4bc595ce848ffbb91a01407370f87-17"></a><span class="n">arg_H</span><span class="p">[(</span><span class="n">x</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="o">*</span>  <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">0.01</span><span class="p">)]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
<a id="rest_code_d2a4bc595ce848ffbb91a01407370f87-18" name="rest_code_d2a4bc595ce848ffbb91a01407370f87-18" href="posts/duplicating-hankel-plot-from-as/#rest_code_d2a4bc595ce848ffbb91a01407370f87-18"></a><span class="n">arg_H</span><span class="p">[</span><span class="n">arg_H</span> <span class="o">&lt;</span> <span class="o">-</span><span class="mi">179</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">360</span>
<a id="rest_code_d2a4bc595ce848ffbb91a01407370f87-19" name="rest_code_d2a4bc595ce848ffbb91a01407370f87-19" href="posts/duplicating-hankel-plot-from-as/#rest_code_d2a4bc595ce848ffbb91a01407370f87-19"></a><span class="n">arg_H</span><span class="p">[</span><span class="n">arg_H</span> <span class="o">&lt;</span> <span class="o">-</span><span class="mi">178</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
<a id="rest_code_d2a4bc595ce848ffbb91a01407370f87-20" name="rest_code_d2a4bc595ce848ffbb91a01407370f87-20" href="posts/duplicating-hankel-plot-from-as/#rest_code_d2a4bc595ce848ffbb91a01407370f87-20"></a><span class="n">levels_arg</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">165</span><span class="p">,</span> <span class="mi">181</span><span class="p">,</span> <span class="mi">15</span><span class="p">)</span>
<a id="rest_code_d2a4bc595ce848ffbb91a01407370f87-21" name="rest_code_d2a4bc595ce848ffbb91a01407370f87-21" href="posts/duplicating-hankel-plot-from-as/#rest_code_d2a4bc595ce848ffbb91a01407370f87-21"></a>
<a id="rest_code_d2a4bc595ce848ffbb91a01407370f87-22" name="rest_code_d2a4bc595ce848ffbb91a01407370f87-22" href="posts/duplicating-hankel-plot-from-as/#rest_code_d2a4bc595ce848ffbb91a01407370f87-22"></a>
<a id="rest_code_d2a4bc595ce848ffbb91a01407370f87-23" name="rest_code_d2a4bc595ce848ffbb91a01407370f87-23" href="posts/duplicating-hankel-plot-from-as/#rest_code_d2a4bc595ce848ffbb91a01407370f87-23"></a><span class="c1">#%% Plots setup</span>
<a id="rest_code_d2a4bc595ce848ffbb91a01407370f87-24" name="rest_code_d2a4bc595ce848ffbb91a01407370f87-24" href="posts/duplicating-hankel-plot-from-as/#rest_code_d2a4bc595ce848ffbb91a01407370f87-24"></a><span class="n">labels</span> <span class="o">=</span> <span class="kc">True</span>
<a id="rest_code_d2a4bc595ce848ffbb91a01407370f87-25" name="rest_code_d2a4bc595ce848ffbb91a01407370f87-25" href="posts/duplicating-hankel-plot-from-as/#rest_code_d2a4bc595ce848ffbb91a01407370f87-25"></a><span class="n">manual_labels</span> <span class="o">=</span> <span class="kc">True</span>
<a id="rest_code_d2a4bc595ce848ffbb91a01407370f87-26" name="rest_code_d2a4bc595ce848ffbb91a01407370f87-26" href="posts/duplicating-hankel-plot-from-as/#rest_code_d2a4bc595ce848ffbb91a01407370f87-26"></a>
<a id="rest_code_d2a4bc595ce848ffbb91a01407370f87-27" name="rest_code_d2a4bc595ce848ffbb91a01407370f87-27" href="posts/duplicating-hankel-plot-from-as/#rest_code_d2a4bc595ce848ffbb91a01407370f87-27"></a>
<a id="rest_code_d2a4bc595ce848ffbb91a01407370f87-28" name="rest_code_d2a4bc595ce848ffbb91a01407370f87-28" href="posts/duplicating-hankel-plot-from-as/#rest_code_d2a4bc595ce848ffbb91a01407370f87-28"></a><span class="c1">#%% Ploting</span>
<a id="rest_code_d2a4bc595ce848ffbb91a01407370f87-29" name="rest_code_d2a4bc595ce848ffbb91a01407370f87-29" href="posts/duplicating-hankel-plot-from-as/#rest_code_d2a4bc595ce848ffbb91a01407370f87-29"></a><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<a id="rest_code_d2a4bc595ce848ffbb91a01407370f87-30" name="rest_code_d2a4bc595ce848ffbb91a01407370f87-30" href="posts/duplicating-hankel-plot-from-as/#rest_code_d2a4bc595ce848ffbb91a01407370f87-30"></a>
<a id="rest_code_d2a4bc595ce848ffbb91a01407370f87-31" name="rest_code_d2a4bc595ce848ffbb91a01407370f87-31" href="posts/duplicating-hankel-plot-from-as/#rest_code_d2a4bc595ce848ffbb91a01407370f87-31"></a><span class="c1"># Jump line</span>
<a id="rest_code_d2a4bc595ce848ffbb91a01407370f87-32" name="rest_code_d2a4bc595ce848ffbb91a01407370f87-32" href="posts/duplicating-hankel-plot-from-as/#rest_code_d2a4bc595ce848ffbb91a01407370f87-32"></a><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s2">"black"</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<a id="rest_code_d2a4bc595ce848ffbb91a01407370f87-33" name="rest_code_d2a4bc595ce848ffbb91a01407370f87-33" href="posts/duplicating-hankel-plot-from-as/#rest_code_d2a4bc595ce848ffbb91a01407370f87-33"></a>
<a id="rest_code_d2a4bc595ce848ffbb91a01407370f87-34" name="rest_code_d2a4bc595ce848ffbb91a01407370f87-34" href="posts/duplicating-hankel-plot-from-as/#rest_code_d2a4bc595ce848ffbb91a01407370f87-34"></a><span class="c1"># Contours</span>
<a id="rest_code_d2a4bc595ce848ffbb91a01407370f87-35" name="rest_code_d2a4bc595ce848ffbb91a01407370f87-35" href="posts/duplicating-hankel-plot-from-as/#rest_code_d2a4bc595ce848ffbb91a01407370f87-35"></a><span class="n">abs_contours</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">abs_H</span><span class="p">,</span> <span class="n">levels_abs</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="s2">"black"</span><span class="p">,</span>
<a id="rest_code_d2a4bc595ce848ffbb91a01407370f87-36" name="rest_code_d2a4bc595ce848ffbb91a01407370f87-36" href="posts/duplicating-hankel-plot-from-as/#rest_code_d2a4bc595ce848ffbb91a01407370f87-36"></a>                            <span class="n">linestyles</span><span class="o">=</span><span class="s2">"solid"</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<a id="rest_code_d2a4bc595ce848ffbb91a01407370f87-37" name="rest_code_d2a4bc595ce848ffbb91a01407370f87-37" href="posts/duplicating-hankel-plot-from-as/#rest_code_d2a4bc595ce848ffbb91a01407370f87-37"></a><span class="n">arg_contours</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">arg_H</span><span class="p">,</span> <span class="n">levels_arg</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="s2">"#757575"</span><span class="p">,</span>
<a id="rest_code_d2a4bc595ce848ffbb91a01407370f87-38" name="rest_code_d2a4bc595ce848ffbb91a01407370f87-38" href="posts/duplicating-hankel-plot-from-as/#rest_code_d2a4bc595ce848ffbb91a01407370f87-38"></a>                            <span class="n">linestyles</span><span class="o">=</span><span class="s2">"solid"</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>
<a id="rest_code_d2a4bc595ce848ffbb91a01407370f87-39" name="rest_code_d2a4bc595ce848ffbb91a01407370f87-39" href="posts/duplicating-hankel-plot-from-as/#rest_code_d2a4bc595ce848ffbb91a01407370f87-39"></a>
<a id="rest_code_d2a4bc595ce848ffbb91a01407370f87-40" name="rest_code_d2a4bc595ce848ffbb91a01407370f87-40" href="posts/duplicating-hankel-plot-from-as/#rest_code_d2a4bc595ce848ffbb91a01407370f87-40"></a><span class="c1"># Figure details</span>
<a id="rest_code_d2a4bc595ce848ffbb91a01407370f87-41" name="rest_code_d2a4bc595ce848ffbb91a01407370f87-41" href="posts/duplicating-hankel-plot-from-as/#rest_code_d2a4bc595ce848ffbb91a01407370f87-41"></a><span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">))</span>
<a id="rest_code_d2a4bc595ce848ffbb91a01407370f87-42" name="rest_code_d2a4bc595ce848ffbb91a01407370f87-42" href="posts/duplicating-hankel-plot-from-as/#rest_code_d2a4bc595ce848ffbb91a01407370f87-42"></a><span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mf">1.5</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">))</span>
<a id="rest_code_d2a4bc595ce848ffbb91a01407370f87-43" name="rest_code_d2a4bc595ce848ffbb91a01407370f87-43" href="posts/duplicating-hankel-plot-from-as/#rest_code_d2a4bc595ce848ffbb91a01407370f87-43"></a>
<a id="rest_code_d2a4bc595ce848ffbb91a01407370f87-44" name="rest_code_d2a4bc595ce848ffbb91a01407370f87-44" href="posts/duplicating-hankel-plot-from-as/#rest_code_d2a4bc595ce848ffbb91a01407370f87-44"></a><span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">"Real axis"</span><span class="p">)</span>
<a id="rest_code_d2a4bc595ce848ffbb91a01407370f87-45" name="rest_code_d2a4bc595ce848ffbb91a01407370f87-45" href="posts/duplicating-hankel-plot-from-as/#rest_code_d2a4bc595ce848ffbb91a01407370f87-45"></a><span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">"Imaginary axis"</span><span class="p">)</span>
<a id="rest_code_d2a4bc595ce848ffbb91a01407370f87-46" name="rest_code_d2a4bc595ce848ffbb91a01407370f87-46" href="posts/duplicating-hankel-plot-from-as/#rest_code_d2a4bc595ce848ffbb91a01407370f87-46"></a>
<a id="rest_code_d2a4bc595ce848ffbb91a01407370f87-47" name="rest_code_d2a4bc595ce848ffbb91a01407370f87-47" href="posts/duplicating-hankel-plot-from-as/#rest_code_d2a4bc595ce848ffbb91a01407370f87-47"></a><span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="s2">"True"</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">"#BDBDBD"</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<a id="rest_code_d2a4bc595ce848ffbb91a01407370f87-48" name="rest_code_d2a4bc595ce848ffbb91a01407370f87-48" href="posts/duplicating-hankel-plot-from-as/#rest_code_d2a4bc595ce848ffbb91a01407370f87-48"></a><span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">"image"</span><span class="p">)</span>
<a id="rest_code_d2a4bc595ce848ffbb91a01407370f87-49" name="rest_code_d2a4bc595ce848ffbb91a01407370f87-49" href="posts/duplicating-hankel-plot-from-as/#rest_code_d2a4bc595ce848ffbb91a01407370f87-49"></a>
<a id="rest_code_d2a4bc595ce848ffbb91a01407370f87-50" name="rest_code_d2a4bc595ce848ffbb91a01407370f87-50" href="posts/duplicating-hankel-plot-from-as/#rest_code_d2a4bc595ce848ffbb91a01407370f87-50"></a><span class="c1"># Labels</span>
<a id="rest_code_d2a4bc595ce848ffbb91a01407370f87-51" name="rest_code_d2a4bc595ce848ffbb91a01407370f87-51" href="posts/duplicating-hankel-plot-from-as/#rest_code_d2a4bc595ce848ffbb91a01407370f87-51"></a><span class="k">if</span> <span class="n">labels</span><span class="p">:</span>
<a id="rest_code_d2a4bc595ce848ffbb91a01407370f87-52" name="rest_code_d2a4bc595ce848ffbb91a01407370f87-52" href="posts/duplicating-hankel-plot-from-as/#rest_code_d2a4bc595ce848ffbb91a01407370f87-52"></a>    <span class="n">ax</span><span class="o">.</span><span class="n">clabel</span><span class="p">(</span><span class="n">abs_contours</span><span class="p">,</span> <span class="n">levels_abs</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s2">"</span><span class="si">%.1f</span><span class="s2">"</span><span class="p">,</span>
<a id="rest_code_d2a4bc595ce848ffbb91a01407370f87-53" name="rest_code_d2a4bc595ce848ffbb91a01407370f87-53" href="posts/duplicating-hankel-plot-from-as/#rest_code_d2a4bc595ce848ffbb91a01407370f87-53"></a>            <span class="n">use_clabeltext</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">manual</span><span class="o">=</span><span class="n">manual_labels</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<a id="rest_code_d2a4bc595ce848ffbb91a01407370f87-54" name="rest_code_d2a4bc595ce848ffbb91a01407370f87-54" href="posts/duplicating-hankel-plot-from-as/#rest_code_d2a4bc595ce848ffbb91a01407370f87-54"></a>    <span class="n">ax</span><span class="o">.</span><span class="n">clabel</span><span class="p">(</span><span class="n">arg_contours</span><span class="p">,</span> <span class="n">levels_arg</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s2">"</span><span class="si">%d</span><span class="s2">°"</span><span class="p">,</span>
<a id="rest_code_d2a4bc595ce848ffbb91a01407370f87-55" name="rest_code_d2a4bc595ce848ffbb91a01407370f87-55" href="posts/duplicating-hankel-plot-from-as/#rest_code_d2a4bc595ce848ffbb91a01407370f87-55"></a>            <span class="n">colors</span><span class="o">=</span><span class="s2">"#757575"</span><span class="p">,</span>
<a id="rest_code_d2a4bc595ce848ffbb91a01407370f87-56" name="rest_code_d2a4bc595ce848ffbb91a01407370f87-56" href="posts/duplicating-hankel-plot-from-as/#rest_code_d2a4bc595ce848ffbb91a01407370f87-56"></a>            <span class="n">use_clabeltext</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">manual</span><span class="o">=</span><span class="n">manual_labels</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>
<a id="rest_code_d2a4bc595ce848ffbb91a01407370f87-57" name="rest_code_d2a4bc595ce848ffbb91a01407370f87-57" href="posts/duplicating-hankel-plot-from-as/#rest_code_d2a4bc595ce848ffbb91a01407370f87-57"></a>
<a id="rest_code_d2a4bc595ce848ffbb91a01407370f87-58" name="rest_code_d2a4bc595ce848ffbb91a01407370f87-58" href="posts/duplicating-hankel-plot-from-as/#rest_code_d2a4bc595ce848ffbb91a01407370f87-58"></a><span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">"abramowitz_stegun-hankel-manual.svg"</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s2">"tight"</span><span class="p">)</span>
<a id="rest_code_d2a4bc595ce848ffbb91a01407370f87-59" name="rest_code_d2a4bc595ce848ffbb91a01407370f87-59" href="posts/duplicating-hankel-plot-from-as/#rest_code_d2a4bc595ce848ffbb91a01407370f87-59"></a><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
<div class="line-block">
<div class="line"><br></div>
</div>
<aside class="footnote-list brackets"><aside class="footnote brackets" id="f1" role="doc-footnote"><span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="posts/duplicating-hankel-plot-from-as/#footnote-reference-1">1</a><span class="fn-bracket">]</span></span>
<p>El sucesor de este libro es la <a class="reference external" href="https://dlmf.nist.gov/">Biblioteca Digital de Funciones Matemáticas</a>.</p>
</aside><aside class="footnote brackets" id="f2" role="doc-footnote"><span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="posts/duplicating-hankel-plot-from-as/#footnote-reference-2">2</a><span class="fn-bracket">]</span></span>
<p>Jahnke, Eugen, Fritz Emde, y Friedrich Lösch (1960).
"Tables of higher functions." McGraw-Hill.
Archivo: <a class="reference external" href="https://archive.org/details/isbn_9780070322455">https://archive.org/details/isbn_9780070322455</a></p>
</aside></aside><div class="line-block">
<div class="line"><br></div>
</div>
    </div>
    </article><article class="post h-entry post-text"><header><h1 class="post-title p-name"><a href="posts/latex_vscode_wind/" class="u-url">Usando MixTex con LaTeX Workshop en Windows</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn">Nicolás Guarín-Zapata</span></p>
            <p class="dateline"><a href="posts/latex_vscode_wind/" rel="bookmark"><time class="post-date published dt-published" datetime="2022-09-23T12:00:00-05:00" title="2022-09-23 12:00">2022-09-23 12:00</time></a></p>
                <p class="commentline">
    
    <a href="posts/latex_vscode_wind/#disqus_thread" data-disqus-identifier="cache/posts/latex_vscode_win.html">Comentarios</a>


        </p>
</div>
    </header><div class="e-content entry-content">
    <p>Este es un post para mencionar cómo configurar Visual Studio Code
para LaTeX—a través de la extensión <a class="reference external" href="https://marketplace.visualstudio.com/items?itemName=James-Yu.latex-workshop">LaTeX Workshop</a>—.</p>
<p>En el pasado, he utilizado varios editores de texto y para LaTeX. Hace un par
de años sustituí <a class="reference external" href="https://www.texstudio.org/">TeXstudio</a> por VS Code, y creo
que funciona muy bien. <a class="reference external" href="https://code.visualstudio.com/">Visual Studio Code</a>
es uno de los <a class="reference external" href="https://insights.stackoverflow.com/survey/2019#development-environments-and-tools">IDE más usados ahora mismo</a>.
Una ventaja de usar VS Code para escribir tus documentos es que puedes
configurarlo para adaptarse a tu flujo de trabajo y utilizarlo para varios
lenguajes/propósitos. También es multiplataforma, no tendrás que preocuparte
por tener diferentes flujos de trabajo en Linux o Windows.</p>
<p>Necesitas seguir estos pasos para hacerlo funcionar:</p>
<ul class="simple">
<li><p>Instala Perl. Puedes utilizar <a class="reference external" href="https://strawberryperl.com/">Strawberry Perl</a>
en Windows.</p></li>
<li><p>Si no tienes privilegios de administrador puedes instalar la versión <a class="reference external" href="https://strawberryperl.com/releases.html">portable</a> y añadir la ruta al ejecutable
a la variable de entorno PATH.</p></li>
<li><p>Instala MikTeX. El creador de LaTeX Workshop sugiere usar TeX Live en su lugar
porque ya viene con Perl y podrías saltarte un paso de esta lista.
Las desventajas de usar TeX Live en lugar de MikTeX son más
(vea <a class="reference external" href="https://tex.stackexchange.com/questions/20036/what-are-the-advantages-of-tex-live-over-miktex">aquí</a>).</p></li>
<li><p>Instala <a class="reference external" href="https://marketplace.visualstudio.com/items?itemName=James-Yu.latex-workshop">LaTeX Workshop</a>.</p></li>
</ul>
<section id="referencias"><h2>Referencias</h2>
<ol class="arabic simple">
<li><p>Cangemi, Denis. “The Reasons Why You Must Use Visual Studio Code.” Medium,
13 de agosto de 2020, <a class="reference external" href="https://blog.devgenius.io/the-reasons-why-you-must-use-visual-studio-code-b522f946a849">https://blog.devgenius.io/the-reasons-why-you-must-use-visual-studio-code-b522f946a849</a>.</p></li>
<li><p>Wright, Joseph. “TeX on Windows: TeX Live versus MiKTeX Revisited.” Some TeX
Developments, 18 de diciembre de 2016, <a class="reference external" href="https://www.texdev.net/2016/12/18/tex-on-windows-tex-live-versus-miktex-revisited/">https://www.texdev.net/2016/12/18/tex-on-windows-tex-live-versus-miktex-revisited/</a>.</p></li>
</ol>
<div class="line-block">
<div class="line"><br></div>
</div>
</section>
</div>
    </article><article class="post h-entry post-text"><header><h1 class="post-title p-name"><a href="posts/tech_writing/tech_writing_figs/" class="u-url">Escritura técnica: usando figuras</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn">Nicolás Guarín-Zapata</span></p>
            <p class="dateline"><a href="posts/tech_writing/tech_writing_figs/" rel="bookmark"><time class="post-date published dt-published" datetime="2021-11-03T12:53:40-05:00" title="2021-11-03 12:53">2021-11-03 12:53</time></a></p>
                <p class="commentline">
    
    <a href="posts/tech_writing/tech_writing_figs/#disqus_thread" data-disqus-identifier="cache/posts/tech_writing/tech_writing_figs.html">Comentarios</a>


        </p>
</div>
    </header><div class="e-content entry-content">
    <p>En una <a class="reference external" href="posts/tech_writing/tech_writing">publicación anterior</a> mencioné algunos aspectos
generales de la escritura técnica. En este me gustaría hablar sobre la
inclusión de figuras en documentos técnicos.</p>
<section id="formatos-de-graficos"><h2>Formatos de gráficos</h2>
<p>Primero, debo mencionar que hay dos tipos principales de gráficos, a saber:</p>
<ul class="simple">
<li><p>gráficos vectoriales; y</p></li>
<li><p>gráficos de mapa de bits.</p></li>
</ul>
<p>Sirven para diferentes propósitos y deberíamos usarlos teniendo esto en cuenta.
Por ejemplo, para diagramas o esquemas es mejor utilizar formatos vectoriales,
en general. Por otro lado, los formatos ráster son más adecuados para imágenes
como fotografías o ilustraciones.</p>
<section id="graficos-vectoriales"><h3>Gráficos vectoriales</h3>
<p>Una <a class="reference external" href="http://en.wikipedia.org/wiki/Vector_graphics">imagen vectorial</a> es una
imagen que está conformada por entidades geométricas. En este caso, la
información almacenada no es punto a punto sino <em>la construcción</em> de las formas
que la conforman. Por esta razón, estas imágenes no se <em>pixelan</em> ya que que la
información con la que se cuenta es de cómo se construye. Este tipo de imágenes
es la mejor opción para esquemas y diagramas, ya que sólo se almacenaría la
información de trazos y texto. El estándar <em>de facto</em> para este tipo de imágenes
es PDF—este es el tipo que uso en mis documentos de \(\LaTeX\)—. Aunque PDF
es el <em>estándar</em>, mi formato preferido es <a class="reference external" href="http://en.wikipedia.org/wiki/Scalable_Vector_Graphics">SVG (Scalable Vector Graphics)</a> que es un estándar
a través de internet y que se puede renderizar en la mayoría de navegadores
<em>modernos</em>.</p>
</section><section id="graficos-raster"><h3>Gráficos ráster</h3>
<p>Una <a class="reference external" href="http://en.wikipedia.org/wiki/Raster_graphics">imagen ráster</a> es una
imagen que está representada por un arreglo (o rejilla rectangular) de píxeles.
En otras palabras, la información del color que hay en cada uno de los puntos
de la imagen. Los formatos más populares almacenan la información de forma
comprimida. Para gráficos de alto contraste (como esquemas o diagramas) el mejor
formato es PNG. Si se tienen animaciones, sería preferible usar GIF. Y en el
caso de fotografías es mejor usar JPG.</p>
</section><section id="resumen-para-los-formatos"><h3>Resumen para los formatos</h3>
<p>Resumiendo, deberíamos usar imágenes JPG (solo) para fotografías y SVG para
esquemas/diagramas. Otro atributo que puede resultar útil es la gestión de
capas. Tener varias capas brinda la opción de apilar diferentes tipos de
información por separado. Por ejemplo, puede tener el fondo, la imagen y las
anotaciones en diferentes capas. De esta forma se puede modificar sólo la parte
de la figura de interés. Se puede automatizar la traducción de las anotaciones
de esta manera sin muchos problemas. Los formatos como SVG permiten tener
varias capas. En el caso de los formatos ráster, tenemos la opción de utilizar
TIFF.</p>
<p>En cuanto al software para generar/editar este tipo de imágenes debo decir
que existe una gran cantidad de programas que permiten exportar a estos
formatos: Python/Matplotlib, Matlab, Inkscape, Adobe Illustrator, GIMP,
Photoshop, LibreOffice. Si el gráfico se genera a partir de un cálculo o una
serie de datos, uso Matplotlib. Si, en cambio, queremos hacer un esquema, mi
herramienta de elección es <a class="reference external" href="http://www.inkscape.org/">Inkscape</a>. Este programa
está destinado a ser una alternativa gratuita a programas como Adobe
Illustrator, y lo logra. Obviamente, se puede usar Illustrator o Corel Draw para
esto. Si el único uso es hacer esquemas técnicos, creo que sería un desperdicio.</p>
</section></section><section id="disenando-figuras-para-documentos"><h2>Diseñando figuras para documentos</h2>
<p>Mi sugerencia es partir del tamaño nominal de la figura del documento. Para la
mayoría de nuestros documentos, las cifras seguirán siendo digitales y esto
puede parecer contradictorio. Sin embargo, encuentro este enfoque mucho más
fácil. Una de las razones es que todavía incrustamos nuestra figura en un
documento con un tamaño nominal. Además, a la hora de pensar en el tamaño de
la fuente es habitual que tengamos como referencia el texto impreso. Además de
eso, debemos considerar que el ojo humano tiene un límite de resolución, por lo
que no podemos simplemente reducir nuestras figuras.</p>
<p>Además, no existe la resolución de una imagen digital. La resolución se refiere
a una densidad de píxeles por unidad de longitud. Esto tiene sentido al imprimir
imágenes, pero no en el caso digital. Sin embargo, las figuras tienen un tamaño
nominal y, por lo tanto, una resolución nominal. Es decir, el número de píxeles
en una dirección dividido por su tamaño nominal. Es una buena idea considerar
una resolución mínima de 150 ppp (puntos por pulgada). Por ejemplo, una imagen
de 6 × 3 pulgadas. Esta imagen tendría un tamaño de (a 150 ppp) de
900 px × 450 px.</p>
<p>El siguiente código de Python crea una figura de tamaño 6 in × 3 in, y grafica
la función \(f(x) = \sin(x^2)\) y la guarda como una imagen de tamaño
900 in × 450 in.</p>
<div class="code"><pre class="code python"><a id="rest_code_fb3a25e7992547b58f3fa8e7cbd8dd39-1" name="rest_code_fb3a25e7992547b58f3fa8e7cbd8dd39-1" href="posts/tech_writing/tech_writing_figs/#rest_code_fb3a25e7992547b58f3fa8e7cbd8dd39-1"></a><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<a id="rest_code_fb3a25e7992547b58f3fa8e7cbd8dd39-2" name="rest_code_fb3a25e7992547b58f3fa8e7cbd8dd39-2" href="posts/tech_writing/tech_writing_figs/#rest_code_fb3a25e7992547b58f3fa8e7cbd8dd39-2"></a><span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<a id="rest_code_fb3a25e7992547b58f3fa8e7cbd8dd39-3" name="rest_code_fb3a25e7992547b58f3fa8e7cbd8dd39-3" href="posts/tech_writing/tech_writing_figs/#rest_code_fb3a25e7992547b58f3fa8e7cbd8dd39-3"></a><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mi">500</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<a id="rest_code_fb3a25e7992547b58f3fa8e7cbd8dd39-4" name="rest_code_fb3a25e7992547b58f3fa8e7cbd8dd39-4" href="posts/tech_writing/tech_writing_figs/#rest_code_fb3a25e7992547b58f3fa8e7cbd8dd39-4"></a><span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<a id="rest_code_fb3a25e7992547b58f3fa8e7cbd8dd39-5" name="rest_code_fb3a25e7992547b58f3fa8e7cbd8dd39-5" href="posts/tech_writing/tech_writing_figs/#rest_code_fb3a25e7992547b58f3fa8e7cbd8dd39-5"></a><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<a id="rest_code_fb3a25e7992547b58f3fa8e7cbd8dd39-6" name="rest_code_fb3a25e7992547b58f3fa8e7cbd8dd39-6" href="posts/tech_writing/tech_writing_figs/#rest_code_fb3a25e7992547b58f3fa8e7cbd8dd39-6"></a><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<a id="rest_code_fb3a25e7992547b58f3fa8e7cbd8dd39-7" name="rest_code_fb3a25e7992547b58f3fa8e7cbd8dd39-7" href="posts/tech_writing/tech_writing_figs/#rest_code_fb3a25e7992547b58f3fa8e7cbd8dd39-7"></a><span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">"x"</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<a id="rest_code_fb3a25e7992547b58f3fa8e7cbd8dd39-8" name="rest_code_fb3a25e7992547b58f3fa8e7cbd8dd39-8" href="posts/tech_writing/tech_writing_figs/#rest_code_fb3a25e7992547b58f3fa8e7cbd8dd39-8"></a><span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">"y"</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<a id="rest_code_fb3a25e7992547b58f3fa8e7cbd8dd39-9" name="rest_code_fb3a25e7992547b58f3fa8e7cbd8dd39-9" href="posts/tech_writing/tech_writing_figs/#rest_code_fb3a25e7992547b58f3fa8e7cbd8dd39-9"></a><span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">"fig_ex_python.png"</span><span class="p">,</span> <span class="n">dpi</span><span class="p">)</span>
</pre></div>
<div class="line-block">
<div class="line"><br></div>
</div>
<p>Y el siguiente código de Matlab.</p>
<div class="code"><pre class="code matlab"><a id="rest_code_74984efe659741608f1fdabd91e0ffc2-1" name="rest_code_74984efe659741608f1fdabd91e0ffc2-1" href="posts/tech_writing/tech_writing_figs/#rest_code_74984efe659741608f1fdabd91e0ffc2-1"></a><span class="n">fig</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">figure</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
<a id="rest_code_74984efe659741608f1fdabd91e0ffc2-2" name="rest_code_74984efe659741608f1fdabd91e0ffc2-2" href="posts/tech_writing/tech_writing_figs/#rest_code_74984efe659741608f1fdabd91e0ffc2-2"></a><span class="n">fig</span><span class="p">.</span><span class="n">Units</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s">'inches'</span><span class="p">;</span>
<a id="rest_code_74984efe659741608f1fdabd91e0ffc2-3" name="rest_code_74984efe659741608f1fdabd91e0ffc2-3" href="posts/tech_writing/tech_writing_figs/#rest_code_74984efe659741608f1fdabd91e0ffc2-3"></a><span class="n">fig</span><span class="p">.</span><span class="n">Position</span><span class="p">(</span><span class="mi">3</span><span class="p">:</span><span class="mi">4</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w">  </span><span class="p">[</span><span class="mi">6</span><span class="w"> </span><span class="mi">4</span><span class="p">];</span>
<a id="rest_code_74984efe659741608f1fdabd91e0ffc2-4" name="rest_code_74984efe659741608f1fdabd91e0ffc2-4" href="posts/tech_writing/tech_writing_figs/#rest_code_74984efe659741608f1fdabd91e0ffc2-4"></a><span class="n">x</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="o">*</span><span class="nb">pi</span><span class="p">,</span><span class="w"> </span><span class="mi">500</span><span class="p">);</span>
<a id="rest_code_74984efe659741608f1fdabd91e0ffc2-5" name="rest_code_74984efe659741608f1fdabd91e0ffc2-5" href="posts/tech_writing/tech_writing_figs/#rest_code_74984efe659741608f1fdabd91e0ffc2-5"></a><span class="n">y</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">sin</span><span class="p">(</span><span class="n">x</span><span class="o">.^</span><span class="mi">2</span><span class="p">);</span>
<a id="rest_code_74984efe659741608f1fdabd91e0ffc2-6" name="rest_code_74984efe659741608f1fdabd91e0ffc2-6" href="posts/tech_writing/tech_writing_figs/#rest_code_74984efe659741608f1fdabd91e0ffc2-6"></a><span class="nb">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="s">'LineWidth'</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">);</span>
<a id="rest_code_74984efe659741608f1fdabd91e0ffc2-7" name="rest_code_74984efe659741608f1fdabd91e0ffc2-7" href="posts/tech_writing/tech_writing_figs/#rest_code_74984efe659741608f1fdabd91e0ffc2-7"></a><span class="nb">xlabel</span><span class="p">(</span><span class="s">'x'</span><span class="p">,</span><span class="w"> </span><span class="s">'FontSize'</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="p">)</span>
<a id="rest_code_74984efe659741608f1fdabd91e0ffc2-8" name="rest_code_74984efe659741608f1fdabd91e0ffc2-8" href="posts/tech_writing/tech_writing_figs/#rest_code_74984efe659741608f1fdabd91e0ffc2-8"></a><span class="nb">ylabel</span><span class="p">(</span><span class="s">'y'</span><span class="p">,</span><span class="w"> </span><span class="s">'FontSize'</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="p">)</span>
<a id="rest_code_74984efe659741608f1fdabd91e0ffc2-9" name="rest_code_74984efe659741608f1fdabd91e0ffc2-9" href="posts/tech_writing/tech_writing_figs/#rest_code_74984efe659741608f1fdabd91e0ffc2-9"></a><span class="nb">set</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span><span class="w"> </span><span class="s">'PaperSize'</span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="mi">6</span><span class="p">,</span><span class="mi">4</span><span class="p">]);</span>
<a id="rest_code_74984efe659741608f1fdabd91e0ffc2-10" name="rest_code_74984efe659741608f1fdabd91e0ffc2-10" href="posts/tech_writing/tech_writing_figs/#rest_code_74984efe659741608f1fdabd91e0ffc2-10"></a><span class="nb">print</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span><span class="s">'fig_ex_matlab'</span><span class="p">,</span><span class="w"> </span><span class="s">'-dpng'</span><span class="p">,</span><span class="w"> </span><span class="s">'-r150'</span><span class="p">);</span>
</pre></div>
<div class="line-block">
<div class="line"><br></div>
</div>
<p>A continuación resumo algunos tamaños para artículos, pósters y diapositivas.</p>
<section id="articulos"><h3>Artículos</h3>
<p>Para un artículo es común usar tamaño carta que es 8.5 in × 11 in
(215.9 mm × 279.4 mm). Otro formato común es A4 que es 210 mm × 297 mm
(8.27 in × 11.7 in).</p>
<p>Una guía para tamaños comunes es la siguiente:</p>
<ul class="simple">
<li><p>ancho de 1.0 columna: 90 mm (3.5 in);</p></li>
<li><p>ancho de 1.5 columna: 140 mm (5.5 in);</p></li>
<li><p>ancho de 2.0 columna: 190 mm (6.5 in);</p></li>
</ul>
<p>y se muestra en la siguiente imagen.</p>
<img alt="Anchos de figuras comparados con papel tamaño carta." class="align-center" src="../images/tech_writing/sizes.png" style="width: 400px;"><p>Si consideramos una <em>resolución</em> de 300 ppi, tenemos los siguientes números de
píxeles horizontalmente</p>
<ul class="simple">
<li><p>ancho de 1.0 columna: 1050 píxeles;</p></li>
<li><p>ancho de 1.5 columna: 1650 píxeles; y</p></li>
<li><p>ancho de 2.0 columna: 1950 píxeles.</p></li>
</ul>
<p>Tenga en cuenta que un monitor HD tiene 1920 píxeles en la dirección horizontal.
Esto significa que se necesita un monitor HD para ser capaz de ver tanto
píxeles.</p>
<p>Respecto al tamaño del texto, es común tener tamaños entre 8 y 12 pts para
figuras.</p>
</section><section id="posters"><h3>Pósters</h3>
<p>En el caso de papel tamaño A0 (841 mm × 1189 mm, 33 in × 47 in) los tamaños
serían algo como:</p>
<ul class="simple">
<li><p>ancho de 1.0 columna: 360 mm (14 in);</p></li>
<li><p>ancho de 1.5 columna: 560 mm (22 in); y</p></li>
<li><p>ancho de 2.0 columna: 760 mm (26 in).</p></li>
</ul>
<p>Tenga en cuenta que un póster puede que no encaje tan bien en el formato
de dos columans. Sin embargo, creo que la referencia sigue siendo útil.</p>
<p>Respecto al tamaño dl texto en pósters es una buena idea mantenerlo por encima
de 24 pts (ver referencia 3).</p>
</section><section id="diapositivas"><h3>Diapositivas</h3>
<p>En el caso de diapositivas hay dos relaciones de aspecto comunes 16:9 y 4:3.
Además, diferentes programas usan diferentes tamaños nominales. La siguiente
tabla muestra los tamaños nomiales para LibreOffice Impress y MS Power Point.</p>
<table>
<thead><tr>
<th class="head"></th>
<th class="head"><p>16:9</p></th>
<th class="head"><p>4:3</p></th>
</tr></thead>
<tbody>
<tr>
<td><p>LibreOffice Impress</p></td>
<td><p>11.02 in × 6.20 in</p></td>
<td><p>11.02 in × 8.00 in</p></td>
</tr>
<tr>
<td><p>MS Power Point</p></td>
<td><p>13.32 in × 7.50 in</p></td>
<td><p>10.00 in × 7.50 in</p></td>
</tr>
</tbody>
</table></section><section id="referencias"><h3>Referencias</h3>
<ol class="arabic simple">
<li><p>Matthew Butterick (2019). <a class="reference external" href="https://practicaltypography.com/">Butterick's Practical Typography</a>.
Segunda edición, Matthew Butterick.</p></li>
<li><p>Rougier, Nicolas P., Michael Droettboom, y Philip E. Bourne (2014).
“Ten Simple Rules for Better Figures.” PLOS Computational Biology 10(9):e1003833.
DOI: 10.1371/journal.pcbi.1003833.</p></li>
<li><p>Erren, Thomas C., y Philip E. Bourne. 2007.
“Ten Simple Rules for a Good Poster Presentation.”
PLOS Computational Biology 3(5):e102. DOI: 10.1371/journal.pcbi.0030102</p></li>
<li><p>Elsevier. (n.d.). "Artwork Overview." Fecha de acceso: Noviembre 1, 2021,
de <a class="reference external" href="https://www.elsevier.com/authors/policies-and-guidelines/artwork-and-media-instructions/artwork-overview">https://www.elsevier.com/authors/policies-and-guidelines/artwork-and-media-instructions/artwork-overview</a></p></li>
<li><p>Elsevier. (n.d.). "Artwork sizing." Fecha de acceso: Noviembre 1, 2021,
de <a class="reference external" href="https://www.elsevier.com/authors/policies-and-guidelines/artwork-and-media-instructions/artwork-sizing">https://www.elsevier.com/authors/policies-and-guidelines/artwork-and-media-instructions/artwork-sizing</a></p></li>
<li><p>Journal of applied physics (n.d.). "Preparing Your Manuscript: Authors
Instruction." Fecha de acceso: Noviembre 1, 2021, de <a class="reference external" href="https://aip.scitation.org/jap/authors/manuscript">https://aip.scitation.org/jap/authors/manuscript</a></p></li>
</ol>
<div class="line-block">
<div class="line"><br></div>
</div>
</section></section>
</div>
    </article><article class="post h-entry post-text"><header><h1 class="post-title p-name"><a href="posts/chicharron/" class="u-url">¿Cuánto chicharrón puede comprar Jeff Bezos?</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn">Sebastián Tobón</span></p>
            <p class="dateline"><a href="posts/chicharron/" rel="bookmark"><time class="post-date published dt-published" datetime="2021-09-30T10:42:44-05:00" title="2021-09-30 10:42">2021-09-30 10:42</time></a></p>
                <p class="commentline">
    
    <a href="posts/chicharron/#disqus_thread" data-disqus-identifier="cache/posts/chicharron.html">Comentarios</a>


        </p>
</div>
    </header><div class="e-content entry-content">
    <p>Este es un cálculo que hizo Sebastián Tobón cuando estaba cursando
Métodos Numéricos para Ecuaciones en Derivadas Parciales (en 2020). El
propósito era incentivar realizar cuentas rápidas (cuentas de servilleta)
y que tuvieran el tamaño de algunos números (por ejemplo, 10¹²) en su
cabeza. Esta fue la pregunta que hice:</p>
<blockquote>
<p>¿Cuánto chicharrón puede comprar Jeff Bezos?</p>
</blockquote>
<p>A continuación está su respuesta.</p>
<section id="respuesta-de-sebastian"><h2>Respuesta de Sebastián</h2>
<p>Supongamos que un cerdo promedio pesa 80 kg. Si su tejido muscular constituye
de un 35 % a 40 % de su peso corporal, se pueden sacar 30 kg de carne.</p>
<p>Jeff Bezos tiene un patrimonio neto igual a</p>
<div class="math">
\begin{equation*}
JB = 115.7 \times 10^9 \text{ USD}\, .
\end{equation*}
</div>
<p>El precio de 100 g de chicharrón era</p>
<div class="math">
\begin{equation*}
7000\text{ COP}\, \frac{1\text{ USD}}{3539.13\text{ COP}} = 1.978\text{ USD}\, .
\end{equation*}
</div>
<p>Por tanto, Jeff Bezos puede comprar</p>
<div class="math">
\begin{equation*}
\frac{115.7\times 10^9\text{ USD}}{\frac{1.978\text{ USD}}{100\text{ g}}}
= 5.85\times 10^{12}\text{ g de chicharrón.}
\end{equation*}
</div>
<p>El total de cerdos en el mundo es 1×10⁹ cabezas. Esto equivale
a un total de chicharrón</p>
<div class="math">
\begin{equation*}
1\times 10^9 \text{ cabezas} \times \frac{30\text{ kg}}{1\text{ cabeza}}
= 3\times 10^{13} \text{ g de chicharrón.}
\end{equation*}
</div>
<p>Para poder comprar todo el chicharrón del mundo debe aumentar su patrimonio
neto en 5.13 veces el valor actual.</p>
<p>Los cerdos más caros del mundo cuestan alrededor de 1000 USD, luego</p>
<div class="math">
\begin{equation*}
\frac{1000\text{ USD}}{\text{cabeza}}\times 10^9\text{ cabezas}
= 10^{12}\text{ USD}\, .
\end{equation*}
</div>
<p>Por otra parte, puede comprar 5.85 veces la cantidad de cerdos a nivel global—
siendo estos de los más caros del mercado—. Por lo tanto</p>
<blockquote>
<p>le sale más rentable comprar todos los cerdos del mundo.</p>
</blockquote>
<div class="line-block">
<div class="line"><br></div>
</div>
</section>
</div>
    </article><article class="post h-entry post-text"><header><h1 class="post-title p-name"><a href="posts/wolfram_jupyter/" class="u-url">Usando el lenguaje de Wolfram en Jupyter: Alternativa gratuita a Mathematica</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn">Nicolás Guarín-Zapata</span></p>
            <p class="dateline"><a href="posts/wolfram_jupyter/" rel="bookmark"><time class="post-date published dt-published" datetime="2021-03-30T19:50:09-05:00" title="2021-03-30 19:50">2021-03-30 19:50</time></a></p>
                <p class="commentline">
    
    <a href="posts/wolfram_jupyter/#disqus_thread" data-disqus-identifier="cache/posts/wolfram_jupyter.html">Comentarios</a>


        </p>
</div>
    </header><div class="e-content entry-content">
    <p>En esta publicación voy a describir cómo agregar Wolfram Language a
Jupyter. Esto proporciona una alternativa gratuita a Mathematica con,
prácticamente, la misma sintaxis. El uso de Wolfram Engine es gratuito en un
ambiente que no sea de producción como se describe en su sitio web:</p>
<blockquote>
<p>Wolfram Engine es gratuito para desarrolladores está disponible para
desarrollo de software en aplicaciones que no son de producción.</p>
<p>Puede utilizar este producto para:</p>
<ul class="simple">
<li><p>desarrollar un producto para usted o su empresa</p></li>
<li><p>realizar proyectos personales en casa, en la escuela, en el trabajo</p></li>
<li><p>explorar Wolfram Language para futuros proyectos de producción</p></li>
</ul>
</blockquote>
<section id="instalacion"><h2>Instalación</h2>
<p>Para instalar debes seguir los siguientes pasos:</p>
<ul>
<li><p><a class="reference external" href="https://www.wolfram.com/engine">Descargar Wolfram Engine</a>.</p></li>
<li><p>Crear una cuenta de Wolfram, si no tienes una.</p></li>
<li><p>Ejecutar el instalador.</p></li>
<li>
<p>Digitar lo siguiente en la terminal.</p>
<div class="code"><pre class="code text"><a id="rest_code_cc62ecd51787438792da98bc7d4456e3-1" name="rest_code_cc62ecd51787438792da98bc7d4456e3-1" href="posts/wolfram_jupyter/#rest_code_cc62ecd51787438792da98bc7d4456e3-1"></a>wolframscript
</pre></div>
</li>
</ul>
<p>y te debería preguntar por tu correo y contraseña.</p>
<p>Luego deberías estar en una terminal y ver lo siguiente</p>
<div class="code"><pre class="code text"><a id="rest_code_128dc6923759476bbbfa96312e6d1f4e-1" name="rest_code_128dc6923759476bbbfa96312e6d1f4e-1" href="posts/wolfram_jupyter/#rest_code_128dc6923759476bbbfa96312e6d1f4e-1"></a>Wolfram Engine activated. See https://www.wolfram.com/wolframscript/ for more information.
<a id="rest_code_128dc6923759476bbbfa96312e6d1f4e-2" name="rest_code_128dc6923759476bbbfa96312e6d1f4e-2" href="posts/wolfram_jupyter/#rest_code_128dc6923759476bbbfa96312e6d1f4e-2"></a>Wolfram Language 12.2.0 Engine for Linux x86 (64-bit)
<a id="rest_code_128dc6923759476bbbfa96312e6d1f4e-3" name="rest_code_128dc6923759476bbbfa96312e6d1f4e-3" href="posts/wolfram_jupyter/#rest_code_128dc6923759476bbbfa96312e6d1f4e-3"></a>Copyright 1988-2021 Wolfram Research, Inc.
</pre></div>
<div class="line-block">
<div class="line"><br></div>
</div>
<p>Y podemos probar que está funcionando</p>
<div class="code"><pre class="code mathematica"><a id="rest_code_f7130e0679fe4e31be94158156264ffc-1" name="rest_code_f7130e0679fe4e31be94158156264ffc-1" href="posts/wolfram_jupyter/#rest_code_f7130e0679fe4e31be94158156264ffc-1"></a><span class="n">In</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">:=</span><span class="w"> </span><span class="err">$</span><span class="n">Version</span>
<a id="rest_code_f7130e0679fe4e31be94158156264ffc-2" name="rest_code_f7130e0679fe4e31be94158156264ffc-2" href="posts/wolfram_jupyter/#rest_code_f7130e0679fe4e31be94158156264ffc-2"></a>
<a id="rest_code_f7130e0679fe4e31be94158156264ffc-3" name="rest_code_f7130e0679fe4e31be94158156264ffc-3" href="posts/wolfram_jupyter/#rest_code_f7130e0679fe4e31be94158156264ffc-3"></a><span class="n">Out</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="w"> </span><span class="mf">12.2.0</span><span class="w"> </span><span class="n">for</span><span class="w"> </span><span class="n">Linux</span><span class="w"> </span><span class="n">x86</span><span class="w"> </span><span class="p">(</span><span class="mi">64</span><span class="o">-</span><span class="n">bit</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="n">January</span><span class="w"> </span><span class="mi">7</span><span class="p">,</span><span class="w"> </span><span class="mi">2021</span><span class="p">)</span>
<a id="rest_code_f7130e0679fe4e31be94158156264ffc-4" name="rest_code_f7130e0679fe4e31be94158156264ffc-4" href="posts/wolfram_jupyter/#rest_code_f7130e0679fe4e31be94158156264ffc-4"></a>
<a id="rest_code_f7130e0679fe4e31be94158156264ffc-5" name="rest_code_f7130e0679fe4e31be94158156264ffc-5" href="posts/wolfram_jupyter/#rest_code_f7130e0679fe4e31be94158156264ffc-5"></a><span class="n">In</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">:=</span><span class="w"> </span><span class="n">Integrate</span><span class="p">[</span><span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="p">),</span><span class="w"> </span><span class="n">x</span><span class="p">]</span>
<a id="rest_code_f7130e0679fe4e31be94158156264ffc-6" name="rest_code_f7130e0679fe4e31be94158156264ffc-6" href="posts/wolfram_jupyter/#rest_code_f7130e0679fe4e31be94158156264ffc-6"></a>
<a id="rest_code_f7130e0679fe4e31be94158156264ffc-7" name="rest_code_f7130e0679fe4e31be94158156264ffc-7" href="posts/wolfram_jupyter/#rest_code_f7130e0679fe4e31be94158156264ffc-7"></a><span class="n">Out</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">=</span><span class="w"> </span><span class="n">ArcTan</span><span class="p">[</span><span class="n">x</span><span class="p">]</span>
</pre></div>
<div class="line-block">
<div class="line"><br></div>
</div>
<p>Ahora debemos instalar
<a class="reference external" href="https://github.com/WolframResearch/WolframLanguageForJupyter.git">WolframLanguageForJupyter</a>.
Para esto debemos digitar lo siguiente en una terminal</p>
<div class="code"><pre class="code bash"><a id="rest_code_d3dc12451e2e42a38c392b65fc18a141-1" name="rest_code_d3dc12451e2e42a38c392b65fc18a141-1" href="posts/wolfram_jupyter/#rest_code_d3dc12451e2e42a38c392b65fc18a141-1"></a>git<span class="w"> </span>clone<span class="w"> </span>https://github.com/WolframResearch/WolframLanguageForJupyter.git
<a id="rest_code_d3dc12451e2e42a38c392b65fc18a141-2" name="rest_code_d3dc12451e2e42a38c392b65fc18a141-2" href="posts/wolfram_jupyter/#rest_code_d3dc12451e2e42a38c392b65fc18a141-2"></a>
<a id="rest_code_d3dc12451e2e42a38c392b65fc18a141-3" name="rest_code_d3dc12451e2e42a38c392b65fc18a141-3" href="posts/wolfram_jupyter/#rest_code_d3dc12451e2e42a38c392b65fc18a141-3"></a><span class="nb">cd</span><span class="w"> </span>WolframLanguageForJupyter/
<a id="rest_code_d3dc12451e2e42a38c392b65fc18a141-4" name="rest_code_d3dc12451e2e42a38c392b65fc18a141-4" href="posts/wolfram_jupyter/#rest_code_d3dc12451e2e42a38c392b65fc18a141-4"></a>
<a id="rest_code_d3dc12451e2e42a38c392b65fc18a141-5" name="rest_code_d3dc12451e2e42a38c392b65fc18a141-5" href="posts/wolfram_jupyter/#rest_code_d3dc12451e2e42a38c392b65fc18a141-5"></a>./configure-jupyter.wls<span class="w"> </span>add
</pre></div>
<div class="line-block">
<div class="line"><br></div>
</div>
<p>Para probar que está instalado podemos digitar lo siguiente</p>
<div class="code"><pre class="code bash"><a id="rest_code_350d2031df4d455facac9bd6e3e5252f-1" name="rest_code_350d2031df4d455facac9bd6e3e5252f-1" href="posts/wolfram_jupyter/#rest_code_350d2031df4d455facac9bd6e3e5252f-1"></a>jupyter<span class="w"> </span>kernelspec<span class="w"> </span>list
</pre></div>
<p>y debería tener una salida similar a la siguiente</p>
<div class="code"><pre class="code bash"><a id="rest_code_2d4a485f4f8241c9b64c155d0dfb3bfd-1" name="rest_code_2d4a485f4f8241c9b64c155d0dfb3bfd-1" href="posts/wolfram_jupyter/#rest_code_2d4a485f4f8241c9b64c155d0dfb3bfd-1"></a>wolframlanguage12.<span class="w">   </span>/home/nicoguaro/.local/share/jupyter/kernels/wolframlanguage12.2
</pre></div>
<div class="line-block">
<div class="line"><br></div>
</div>
<p>O también podemos intentar con</p>
<div class="code"><pre class="code bash"><a id="rest_code_61d08d3d87ac4558b1545f29c6e7ac29-1" name="rest_code_61d08d3d87ac4558b1545f29c6e7ac29-1" href="posts/wolfram_jupyter/#rest_code_61d08d3d87ac4558b1545f29c6e7ac29-1"></a>jupyter<span class="w"> </span>notebook
</pre></div>
<p>y ver lo siguiente en el menú de kernel.</p>
<img alt="Menú de kernels luego de instalar  WolframLanguageForJupyter." class="align-center" src="../images/wolfram_menu.png" style="width: 400px;"><div class="line-block">
<div class="line"><br></div>
</div>
</section><section id="prueba"><h2>Prueba</h2>
<p>Probé algunas de las capacidades y puedes descargar el
<a class="reference external" href="../downloads/notebooks/wolfram_notebook.ipynb">notebook</a> o
ver una versión estática
<a class="reference external" href="http://nbviewer.jupyter.org/url/nicoguaro.github.io/downloads/notebooks/wolfram_notebook.ipynb">aquí</a>.</p>
<p>Calculemos la integral</p>
<div class="math">
\begin{equation*}
\int \frac{1}{1 + x^3}\mathrm{d}x\, .
\end{equation*}
</div>
<div class="code"><pre class="code text"><a id="rest_code_7e1970b6c69c4b269db96765b107910c-1" name="rest_code_7e1970b6c69c4b269db96765b107910c-1" href="posts/wolfram_jupyter/#rest_code_7e1970b6c69c4b269db96765b107910c-1"></a>sol:= Integrate[1/(1 + x^3), x]
<a id="rest_code_7e1970b6c69c4b269db96765b107910c-2" name="rest_code_7e1970b6c69c4b269db96765b107910c-2" href="posts/wolfram_jupyter/#rest_code_7e1970b6c69c4b269db96765b107910c-2"></a>TeXForm[sol]
</pre></div>
<div class="math">
\begin{equation*}
-\frac{1}{6} \log \left(x^2-x+1\right)+\frac{1}{3} \log (x+1)+\frac{\tan^{-1}\left(\frac{2 x-1}{\sqrt{3}}\right)}{\sqrt{3}}
\end{equation*}
</div>
<div class="line-block">
<div class="line"><br></div>
</div>
<p>Y realicemos un gráfico 3D.</p>
<div class="code"><pre class="code text"><a id="rest_code_eda63bff0fd441a38aabc2aebe0f6c78-1" name="rest_code_eda63bff0fd441a38aabc2aebe0f6c78-1" href="posts/wolfram_jupyter/#rest_code_eda63bff0fd441a38aabc2aebe0f6c78-1"></a>fun:= Sin[Sqrt[x^2 + y^2]]/Sqrt[x^2 + y^2]
<a id="rest_code_eda63bff0fd441a38aabc2aebe0f6c78-2" name="rest_code_eda63bff0fd441a38aabc2aebe0f6c78-2" href="posts/wolfram_jupyter/#rest_code_eda63bff0fd441a38aabc2aebe0f6c78-2"></a>Plot3D[fun, {x, -5*Pi, 5*Pi}, {y, -5*Pi, 5*Pi},
<a id="rest_code_eda63bff0fd441a38aabc2aebe0f6c78-3" name="rest_code_eda63bff0fd441a38aabc2aebe0f6c78-3" href="posts/wolfram_jupyter/#rest_code_eda63bff0fd441a38aabc2aebe0f6c78-3"></a>    PlotPoints -&gt; 100, BoxRatios -&gt; {1, 1, 0.2},
<a id="rest_code_eda63bff0fd441a38aabc2aebe0f6c78-4" name="rest_code_eda63bff0fd441a38aabc2aebe0f6c78-4" href="posts/wolfram_jupyter/#rest_code_eda63bff0fd441a38aabc2aebe0f6c78-4"></a>    PlotRange -&gt; All]
</pre></div>
<img alt="Gráfico 3D en el notebook." class="align-center" src="../images/wolfram_plot.png" style="width: 600px;"><div class="line-block">
<div class="line"><br></div>
</div>
<p>En este caso no tenemos gráficos interactivos. Esto no está implementado aún,
pero si estás interesado puede ver el
<a class="reference external" href="https://github.com/WolframResearch/WolframLanguageForJupyter/issues/76">issue</a>
sobre esto en GitHub.</p>
</section>
</div>
    </article><article class="post h-entry post-text"><header><h1 class="post-title p-name"><a href="posts/bem_corrected/" class="u-url">Regresando al Método de elementos de frontera</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn">Nicolás Guarín-Zapata</span></p>
            <p class="dateline"><a href="posts/bem_corrected/" rel="bookmark"><time class="post-date published dt-published" datetime="2021-02-22T10:00:00-05:00" title="2021-02-22 10:00">2021-02-22 10:00</time></a></p>
                <p class="commentline">
    
    <a href="posts/bem_corrected/#disqus_thread" data-disqus-identifier="cache/posts/bem_corrected.html">Comentarios</a>


        </p>
</div>
    </header><div class="e-content entry-content">
    <p>Durante octubre (2017) estuve escribiendo un programa por día para algunos
métodos numéricos famosos en Python y Julia. Esto estaba pensado como
un ejercicio para aprender Julia. Puedne ver un  <a class="reference external" href="posts/numerical_summary">resumen aquí</a>.
Tuve éxito en 30 de los retos, exceptuando por el BEM
(<a class="reference external" href="https://en.wikipedia.org/wiki/Boundary_element_method">Método de elementos de frontera, en inglés</a>),
donde no pude encontrar que hice mal ese día. La publicación original está
<a class="reference external" href="posts/numerical-26">aquí</a>.</p>
<p>Thomas Klimpel encontró el error y me escribió un email describiendo lo
que estaba mal. Entonces, estoy creando esta publicación con la implementación
correcta del BEM.</p>
<section id="el-metodo-de-elementos-de-frontera"><h2>El Método de Elementos de Frontera</h2>
<p>Queremos rsolver la ecuación</p>
<div class="math">
\begin{equation*}
\nabla^2 u = -f(x, y)\quad \forall (x, y) \in \Omega\, ,
\end{equation*}
</div>
<p>con</p>
<div class="math">
\begin{equation*}
u(x) = g(x, y), \quad \forall (x, y)\in \partial \Omega \, .
\end{equation*}
</div>
<p>Para este método, necesitamos usar la representación integral de la ecuación,
que, en este caso, es</p>
<div class="math">
\begin{equation*}
u(\boldsymbol{\xi})  = \int_{S} [u(\mathbf{x}) F(\mathbf{x}, \boldsymbol{\xi})
    - q(\mathbf{x})G(\mathbf{x}, \boldsymbol{\xi})]\mathrm{d}S(\mathbf{x})
    + \int_{V} f(\mathbf{x}) G(\mathbf{x}, \boldsymbol{\xi}) \mathrm{d}V(\mathbf{x})
\end{equation*}
</div>
<p>con</p>
<div class="math">
\begin{equation*}
G(\mathbf{x}, \boldsymbol{\xi})= -\frac{1}{2\pi}\ln|\mathbf{x} - \xi|
\end{equation*}
</div>
<p>y</p>
<div class="math">
\begin{equation*}
F(\mathbf{x}, \boldsymbol{\xi}) =
  -\frac{1}{2\pi |\mathbf{x} - \boldsymbol{\xi}|^2}
  (\mathbf{x} - \boldsymbol{\xi})\cdot\hat{\mathbf{n}}
\end{equation*}
</div>
<p>Entonces, podemos formar un sistema de ecuaciones</p>
<div class="math">
\begin{equation*}
[G]\{q\} = [F]\{u\}\, ,
\end{equation*}
</div>
<p>que obtenemos discretizando la frontera. Si tomamos variables constantes en
la discretización, las integrales se pueden calcular analíticamente</p>
<div class="math">
\begin{equation*}
G_{nm} = -\frac{1}{2\pi}\left[r \sin\theta\left(\ln|r| - 1\right)
         + \theta r\cos\theta\right]^{\theta_B, r_B}_{\theta_A, r_A}
\end{equation*}
</div>
<p>y</p>
<div class="math">
\begin{equation*}
F_{nm} = \left[\frac{\theta}{2\pi}\right]^{\theta_B}_{\theta_A}
\end{equation*}
</div>
<p>para puntos <span class="math">\(n\)</span> y <span class="math">\(m\)</span> en diferentos elementos, y los subíndices
<span class="math">\(A, B\)</span> se refieren a los puntos finales del elemento de evaluación.
Debemos tener cuidado al evaluar esta expresión ya que <span class="math">\(r_A\)</span> y <span class="math">\(r_B\)</span>
pueden ser (casi) cero y hacer que <em>explote</em>. Además, aquí es donde estaba el
problema principal ya que olvidé calcular los ángulos para elements que están,
en general, no alineados con los ejes vertical u horizontal.</p>
<p>Para los términos en la diagonal las integrales se evalúan como</p>
<div class="math">
\begin{equation*}
G_{nn} = -\frac{L}{2\pi}\left(\ln\left\vert\frac{L}{2}\right\vert - 1\right)
\end{equation*}
</div>
<p>y</p>
<div class="math">
\begin{equation*}
F_{nn} = - \frac{1}{2}
\end{equation*}
</div>
<p>con <span class="math">\(L\)</span> el tamaño del elemento.</p>
<p>A continuación está el código. Tengan en cuenta que este código funciona para
problemas puramente de Dirichlet. Para problemas mixtos Dirichlet-Neumann,
las matrices de influencia deben reordenarse para separar las incógnitas de
las variables conocidas en lados opuestos de la ecuación.</p>
<p>Pueden descargar los archivos para este  <a class="reference external" href="../downloads/bem.zip">proyecto aquí</a>.
Se incluye un archivo YML para crear un ambiente de conda con la lista de
dependencias. Por ejemplo, se usa la versión 3.0 de
<a class="reference external" href="https://github.com/nschloe/meshio">Meshio</a>.</p>
<div class="code"><pre class="code python"><a id="rest_code_4f02b851ecb14bcf912f3c8161f703f0-1" name="rest_code_4f02b851ecb14bcf912f3c8161f703f0-1" href="posts/bem_corrected/#rest_code_4f02b851ecb14bcf912f3c8161f703f0-1"></a><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<a id="rest_code_4f02b851ecb14bcf912f3c8161f703f0-2" name="rest_code_4f02b851ecb14bcf912f3c8161f703f0-2" href="posts/bem_corrected/#rest_code_4f02b851ecb14bcf912f3c8161f703f0-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="kn">import</span> <span class="n">log</span><span class="p">,</span> <span class="n">arctan2</span><span class="p">,</span> <span class="n">pi</span><span class="p">,</span> <span class="n">mean</span><span class="p">,</span> <span class="n">arctan</span>
<a id="rest_code_4f02b851ecb14bcf912f3c8161f703f0-3" name="rest_code_4f02b851ecb14bcf912f3c8161f703f0-3" href="posts/bem_corrected/#rest_code_4f02b851ecb14bcf912f3c8161f703f0-3"></a><span class="kn">from</span><span class="w"> </span><span class="nn">numpy.linalg</span><span class="w"> </span><span class="kn">import</span> <span class="n">norm</span><span class="p">,</span> <span class="n">solve</span>
<a id="rest_code_4f02b851ecb14bcf912f3c8161f703f0-4" name="rest_code_4f02b851ecb14bcf912f3c8161f703f0-4" href="posts/bem_corrected/#rest_code_4f02b851ecb14bcf912f3c8161f703f0-4"></a><span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<a id="rest_code_4f02b851ecb14bcf912f3c8161f703f0-5" name="rest_code_4f02b851ecb14bcf912f3c8161f703f0-5" href="posts/bem_corrected/#rest_code_4f02b851ecb14bcf912f3c8161f703f0-5"></a><span class="kn">from</span><span class="w"> </span><span class="nn">mpl_toolkits.mplot3d</span><span class="w"> </span><span class="kn">import</span> <span class="n">Axes3D</span>
<a id="rest_code_4f02b851ecb14bcf912f3c8161f703f0-6" name="rest_code_4f02b851ecb14bcf912f3c8161f703f0-6" href="posts/bem_corrected/#rest_code_4f02b851ecb14bcf912f3c8161f703f0-6"></a><span class="kn">import</span><span class="w"> </span><span class="nn">meshio</span>
<a id="rest_code_4f02b851ecb14bcf912f3c8161f703f0-7" name="rest_code_4f02b851ecb14bcf912f3c8161f703f0-7" href="posts/bem_corrected/#rest_code_4f02b851ecb14bcf912f3c8161f703f0-7"></a>
<a id="rest_code_4f02b851ecb14bcf912f3c8161f703f0-8" name="rest_code_4f02b851ecb14bcf912f3c8161f703f0-8" href="posts/bem_corrected/#rest_code_4f02b851ecb14bcf912f3c8161f703f0-8"></a>
<a id="rest_code_4f02b851ecb14bcf912f3c8161f703f0-9" name="rest_code_4f02b851ecb14bcf912f3c8161f703f0-9" href="posts/bem_corrected/#rest_code_4f02b851ecb14bcf912f3c8161f703f0-9"></a>  <span class="k">def</span><span class="w"> </span><span class="nf">assem</span><span class="p">(</span><span class="n">coords</span><span class="p">,</span> <span class="n">elems</span><span class="p">):</span>
<a id="rest_code_4f02b851ecb14bcf912f3c8161f703f0-10" name="rest_code_4f02b851ecb14bcf912f3c8161f703f0-10" href="posts/bem_corrected/#rest_code_4f02b851ecb14bcf912f3c8161f703f0-10"></a><span class="w">      </span><span class="sd">"""Assembly matrices for the BEM problem</span>
<a id="rest_code_4f02b851ecb14bcf912f3c8161f703f0-11" name="rest_code_4f02b851ecb14bcf912f3c8161f703f0-11" href="posts/bem_corrected/#rest_code_4f02b851ecb14bcf912f3c8161f703f0-11"></a>
<a id="rest_code_4f02b851ecb14bcf912f3c8161f703f0-12" name="rest_code_4f02b851ecb14bcf912f3c8161f703f0-12" href="posts/bem_corrected/#rest_code_4f02b851ecb14bcf912f3c8161f703f0-12"></a><span class="sd">      Parameters</span>
<a id="rest_code_4f02b851ecb14bcf912f3c8161f703f0-13" name="rest_code_4f02b851ecb14bcf912f3c8161f703f0-13" href="posts/bem_corrected/#rest_code_4f02b851ecb14bcf912f3c8161f703f0-13"></a><span class="sd">      ----------</span>
<a id="rest_code_4f02b851ecb14bcf912f3c8161f703f0-14" name="rest_code_4f02b851ecb14bcf912f3c8161f703f0-14" href="posts/bem_corrected/#rest_code_4f02b851ecb14bcf912f3c8161f703f0-14"></a><span class="sd">      coords : ndarray, float</span>
<a id="rest_code_4f02b851ecb14bcf912f3c8161f703f0-15" name="rest_code_4f02b851ecb14bcf912f3c8161f703f0-15" href="posts/bem_corrected/#rest_code_4f02b851ecb14bcf912f3c8161f703f0-15"></a><span class="sd">          Coordinates for the nodes.</span>
<a id="rest_code_4f02b851ecb14bcf912f3c8161f703f0-16" name="rest_code_4f02b851ecb14bcf912f3c8161f703f0-16" href="posts/bem_corrected/#rest_code_4f02b851ecb14bcf912f3c8161f703f0-16"></a><span class="sd">      elems : ndarray, int</span>
<a id="rest_code_4f02b851ecb14bcf912f3c8161f703f0-17" name="rest_code_4f02b851ecb14bcf912f3c8161f703f0-17" href="posts/bem_corrected/#rest_code_4f02b851ecb14bcf912f3c8161f703f0-17"></a><span class="sd">          Connectivity for the elements.</span>
<a id="rest_code_4f02b851ecb14bcf912f3c8161f703f0-18" name="rest_code_4f02b851ecb14bcf912f3c8161f703f0-18" href="posts/bem_corrected/#rest_code_4f02b851ecb14bcf912f3c8161f703f0-18"></a>
<a id="rest_code_4f02b851ecb14bcf912f3c8161f703f0-19" name="rest_code_4f02b851ecb14bcf912f3c8161f703f0-19" href="posts/bem_corrected/#rest_code_4f02b851ecb14bcf912f3c8161f703f0-19"></a><span class="sd">      Returns</span>
<a id="rest_code_4f02b851ecb14bcf912f3c8161f703f0-20" name="rest_code_4f02b851ecb14bcf912f3c8161f703f0-20" href="posts/bem_corrected/#rest_code_4f02b851ecb14bcf912f3c8161f703f0-20"></a><span class="sd">      -------</span>
<a id="rest_code_4f02b851ecb14bcf912f3c8161f703f0-21" name="rest_code_4f02b851ecb14bcf912f3c8161f703f0-21" href="posts/bem_corrected/#rest_code_4f02b851ecb14bcf912f3c8161f703f0-21"></a><span class="sd">      Gmat : ndarray, float</span>
<a id="rest_code_4f02b851ecb14bcf912f3c8161f703f0-22" name="rest_code_4f02b851ecb14bcf912f3c8161f703f0-22" href="posts/bem_corrected/#rest_code_4f02b851ecb14bcf912f3c8161f703f0-22"></a><span class="sd">          Influence matrix for the flow.</span>
<a id="rest_code_4f02b851ecb14bcf912f3c8161f703f0-23" name="rest_code_4f02b851ecb14bcf912f3c8161f703f0-23" href="posts/bem_corrected/#rest_code_4f02b851ecb14bcf912f3c8161f703f0-23"></a><span class="sd">      Fmat : ndarray, float</span>
<a id="rest_code_4f02b851ecb14bcf912f3c8161f703f0-24" name="rest_code_4f02b851ecb14bcf912f3c8161f703f0-24" href="posts/bem_corrected/#rest_code_4f02b851ecb14bcf912f3c8161f703f0-24"></a><span class="sd">          Influence matrix for primary variable.</span>
<a id="rest_code_4f02b851ecb14bcf912f3c8161f703f0-25" name="rest_code_4f02b851ecb14bcf912f3c8161f703f0-25" href="posts/bem_corrected/#rest_code_4f02b851ecb14bcf912f3c8161f703f0-25"></a><span class="sd">      """</span>
<a id="rest_code_4f02b851ecb14bcf912f3c8161f703f0-26" name="rest_code_4f02b851ecb14bcf912f3c8161f703f0-26" href="posts/bem_corrected/#rest_code_4f02b851ecb14bcf912f3c8161f703f0-26"></a>      <span class="n">nelems</span> <span class="o">=</span> <span class="n">elems</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<a id="rest_code_4f02b851ecb14bcf912f3c8161f703f0-27" name="rest_code_4f02b851ecb14bcf912f3c8161f703f0-27" href="posts/bem_corrected/#rest_code_4f02b851ecb14bcf912f3c8161f703f0-27"></a>      <span class="n">Gmat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nelems</span><span class="p">,</span> <span class="n">nelems</span><span class="p">))</span>
<a id="rest_code_4f02b851ecb14bcf912f3c8161f703f0-28" name="rest_code_4f02b851ecb14bcf912f3c8161f703f0-28" href="posts/bem_corrected/#rest_code_4f02b851ecb14bcf912f3c8161f703f0-28"></a>      <span class="n">Fmat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nelems</span><span class="p">,</span> <span class="n">nelems</span><span class="p">))</span>
<a id="rest_code_4f02b851ecb14bcf912f3c8161f703f0-29" name="rest_code_4f02b851ecb14bcf912f3c8161f703f0-29" href="posts/bem_corrected/#rest_code_4f02b851ecb14bcf912f3c8161f703f0-29"></a>      <span class="k">for</span> <span class="n">ev_cont</span><span class="p">,</span> <span class="n">elem1</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">elems</span><span class="p">):</span>
<a id="rest_code_4f02b851ecb14bcf912f3c8161f703f0-30" name="rest_code_4f02b851ecb14bcf912f3c8161f703f0-30" href="posts/bem_corrected/#rest_code_4f02b851ecb14bcf912f3c8161f703f0-30"></a>          <span class="k">for</span> <span class="n">col_cont</span><span class="p">,</span> <span class="n">elem2</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">elems</span><span class="p">):</span>
<a id="rest_code_4f02b851ecb14bcf912f3c8161f703f0-31" name="rest_code_4f02b851ecb14bcf912f3c8161f703f0-31" href="posts/bem_corrected/#rest_code_4f02b851ecb14bcf912f3c8161f703f0-31"></a>              <span class="n">pt_col</span> <span class="o">=</span> <span class="n">mean</span><span class="p">(</span><span class="n">coords</span><span class="p">[</span><span class="n">elem2</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<a id="rest_code_4f02b851ecb14bcf912f3c8161f703f0-32" name="rest_code_4f02b851ecb14bcf912f3c8161f703f0-32" href="posts/bem_corrected/#rest_code_4f02b851ecb14bcf912f3c8161f703f0-32"></a>              <span class="k">if</span> <span class="n">ev_cont</span> <span class="o">==</span> <span class="n">col_cont</span><span class="p">:</span>
<a id="rest_code_4f02b851ecb14bcf912f3c8161f703f0-33" name="rest_code_4f02b851ecb14bcf912f3c8161f703f0-33" href="posts/bem_corrected/#rest_code_4f02b851ecb14bcf912f3c8161f703f0-33"></a>                  <span class="n">L</span> <span class="o">=</span> <span class="n">norm</span><span class="p">(</span><span class="n">coords</span><span class="p">[</span><span class="n">elem1</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="o">-</span> <span class="n">coords</span><span class="p">[</span><span class="n">elem1</span><span class="p">[</span><span class="mi">0</span><span class="p">]])</span>
<a id="rest_code_4f02b851ecb14bcf912f3c8161f703f0-34" name="rest_code_4f02b851ecb14bcf912f3c8161f703f0-34" href="posts/bem_corrected/#rest_code_4f02b851ecb14bcf912f3c8161f703f0-34"></a>                  <span class="n">Gmat</span><span class="p">[</span><span class="n">ev_cont</span><span class="p">,</span> <span class="n">ev_cont</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span> <span class="n">L</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">log</span><span class="p">(</span><span class="n">L</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
<a id="rest_code_4f02b851ecb14bcf912f3c8161f703f0-35" name="rest_code_4f02b851ecb14bcf912f3c8161f703f0-35" href="posts/bem_corrected/#rest_code_4f02b851ecb14bcf912f3c8161f703f0-35"></a>                  <span class="n">Fmat</span><span class="p">[</span><span class="n">ev_cont</span><span class="p">,</span> <span class="n">ev_cont</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span> <span class="mf">0.5</span>
<a id="rest_code_4f02b851ecb14bcf912f3c8161f703f0-36" name="rest_code_4f02b851ecb14bcf912f3c8161f703f0-36" href="posts/bem_corrected/#rest_code_4f02b851ecb14bcf912f3c8161f703f0-36"></a>              <span class="k">else</span><span class="p">:</span>
<a id="rest_code_4f02b851ecb14bcf912f3c8161f703f0-37" name="rest_code_4f02b851ecb14bcf912f3c8161f703f0-37" href="posts/bem_corrected/#rest_code_4f02b851ecb14bcf912f3c8161f703f0-37"></a>                  <span class="n">Gij</span><span class="p">,</span> <span class="n">Fij</span> <span class="o">=</span> <span class="n">influence_coeff</span><span class="p">(</span><span class="n">elem1</span><span class="p">,</span> <span class="n">coords</span><span class="p">,</span> <span class="n">pt_col</span><span class="p">)</span>
<a id="rest_code_4f02b851ecb14bcf912f3c8161f703f0-38" name="rest_code_4f02b851ecb14bcf912f3c8161f703f0-38" href="posts/bem_corrected/#rest_code_4f02b851ecb14bcf912f3c8161f703f0-38"></a>                  <span class="n">Gmat</span><span class="p">[</span><span class="n">ev_cont</span><span class="p">,</span> <span class="n">col_cont</span><span class="p">]</span> <span class="o">=</span> <span class="n">Gij</span>
<a id="rest_code_4f02b851ecb14bcf912f3c8161f703f0-39" name="rest_code_4f02b851ecb14bcf912f3c8161f703f0-39" href="posts/bem_corrected/#rest_code_4f02b851ecb14bcf912f3c8161f703f0-39"></a>                  <span class="n">Fmat</span><span class="p">[</span><span class="n">ev_cont</span><span class="p">,</span> <span class="n">col_cont</span><span class="p">]</span> <span class="o">=</span> <span class="n">Fij</span>
<a id="rest_code_4f02b851ecb14bcf912f3c8161f703f0-40" name="rest_code_4f02b851ecb14bcf912f3c8161f703f0-40" href="posts/bem_corrected/#rest_code_4f02b851ecb14bcf912f3c8161f703f0-40"></a>      <span class="k">return</span> <span class="n">Gmat</span><span class="p">,</span> <span class="n">Fmat</span>
<a id="rest_code_4f02b851ecb14bcf912f3c8161f703f0-41" name="rest_code_4f02b851ecb14bcf912f3c8161f703f0-41" href="posts/bem_corrected/#rest_code_4f02b851ecb14bcf912f3c8161f703f0-41"></a>
<a id="rest_code_4f02b851ecb14bcf912f3c8161f703f0-42" name="rest_code_4f02b851ecb14bcf912f3c8161f703f0-42" href="posts/bem_corrected/#rest_code_4f02b851ecb14bcf912f3c8161f703f0-42"></a>
<a id="rest_code_4f02b851ecb14bcf912f3c8161f703f0-43" name="rest_code_4f02b851ecb14bcf912f3c8161f703f0-43" href="posts/bem_corrected/#rest_code_4f02b851ecb14bcf912f3c8161f703f0-43"></a>  <span class="k">def</span><span class="w"> </span><span class="nf">influence_coeff</span><span class="p">(</span><span class="n">elem</span><span class="p">,</span> <span class="n">coords</span><span class="p">,</span> <span class="n">pt_col</span><span class="p">):</span>
<a id="rest_code_4f02b851ecb14bcf912f3c8161f703f0-44" name="rest_code_4f02b851ecb14bcf912f3c8161f703f0-44" href="posts/bem_corrected/#rest_code_4f02b851ecb14bcf912f3c8161f703f0-44"></a><span class="w">      </span><span class="sd">"""Compute influence coefficients</span>
<a id="rest_code_4f02b851ecb14bcf912f3c8161f703f0-45" name="rest_code_4f02b851ecb14bcf912f3c8161f703f0-45" href="posts/bem_corrected/#rest_code_4f02b851ecb14bcf912f3c8161f703f0-45"></a>
<a id="rest_code_4f02b851ecb14bcf912f3c8161f703f0-46" name="rest_code_4f02b851ecb14bcf912f3c8161f703f0-46" href="posts/bem_corrected/#rest_code_4f02b851ecb14bcf912f3c8161f703f0-46"></a><span class="sd">      Parameters</span>
<a id="rest_code_4f02b851ecb14bcf912f3c8161f703f0-47" name="rest_code_4f02b851ecb14bcf912f3c8161f703f0-47" href="posts/bem_corrected/#rest_code_4f02b851ecb14bcf912f3c8161f703f0-47"></a><span class="sd">      ----------</span>
<a id="rest_code_4f02b851ecb14bcf912f3c8161f703f0-48" name="rest_code_4f02b851ecb14bcf912f3c8161f703f0-48" href="posts/bem_corrected/#rest_code_4f02b851ecb14bcf912f3c8161f703f0-48"></a><span class="sd">      elems : ndarray, int</span>
<a id="rest_code_4f02b851ecb14bcf912f3c8161f703f0-49" name="rest_code_4f02b851ecb14bcf912f3c8161f703f0-49" href="posts/bem_corrected/#rest_code_4f02b851ecb14bcf912f3c8161f703f0-49"></a><span class="sd">          Connectivity for the elements.</span>
<a id="rest_code_4f02b851ecb14bcf912f3c8161f703f0-50" name="rest_code_4f02b851ecb14bcf912f3c8161f703f0-50" href="posts/bem_corrected/#rest_code_4f02b851ecb14bcf912f3c8161f703f0-50"></a><span class="sd">      coords : ndarray, float</span>
<a id="rest_code_4f02b851ecb14bcf912f3c8161f703f0-51" name="rest_code_4f02b851ecb14bcf912f3c8161f703f0-51" href="posts/bem_corrected/#rest_code_4f02b851ecb14bcf912f3c8161f703f0-51"></a><span class="sd">          Coordinates for the nodes.</span>
<a id="rest_code_4f02b851ecb14bcf912f3c8161f703f0-52" name="rest_code_4f02b851ecb14bcf912f3c8161f703f0-52" href="posts/bem_corrected/#rest_code_4f02b851ecb14bcf912f3c8161f703f0-52"></a><span class="sd">      pt_col : ndarray</span>
<a id="rest_code_4f02b851ecb14bcf912f3c8161f703f0-53" name="rest_code_4f02b851ecb14bcf912f3c8161f703f0-53" href="posts/bem_corrected/#rest_code_4f02b851ecb14bcf912f3c8161f703f0-53"></a><span class="sd">          Coordinates of the colocation point.</span>
<a id="rest_code_4f02b851ecb14bcf912f3c8161f703f0-54" name="rest_code_4f02b851ecb14bcf912f3c8161f703f0-54" href="posts/bem_corrected/#rest_code_4f02b851ecb14bcf912f3c8161f703f0-54"></a>
<a id="rest_code_4f02b851ecb14bcf912f3c8161f703f0-55" name="rest_code_4f02b851ecb14bcf912f3c8161f703f0-55" href="posts/bem_corrected/#rest_code_4f02b851ecb14bcf912f3c8161f703f0-55"></a><span class="sd">      Returns</span>
<a id="rest_code_4f02b851ecb14bcf912f3c8161f703f0-56" name="rest_code_4f02b851ecb14bcf912f3c8161f703f0-56" href="posts/bem_corrected/#rest_code_4f02b851ecb14bcf912f3c8161f703f0-56"></a><span class="sd">      -------</span>
<a id="rest_code_4f02b851ecb14bcf912f3c8161f703f0-57" name="rest_code_4f02b851ecb14bcf912f3c8161f703f0-57" href="posts/bem_corrected/#rest_code_4f02b851ecb14bcf912f3c8161f703f0-57"></a><span class="sd">      G_coeff : float</span>
<a id="rest_code_4f02b851ecb14bcf912f3c8161f703f0-58" name="rest_code_4f02b851ecb14bcf912f3c8161f703f0-58" href="posts/bem_corrected/#rest_code_4f02b851ecb14bcf912f3c8161f703f0-58"></a><span class="sd">          Influence coefficient for flows.</span>
<a id="rest_code_4f02b851ecb14bcf912f3c8161f703f0-59" name="rest_code_4f02b851ecb14bcf912f3c8161f703f0-59" href="posts/bem_corrected/#rest_code_4f02b851ecb14bcf912f3c8161f703f0-59"></a><span class="sd">      F_coeff : float</span>
<a id="rest_code_4f02b851ecb14bcf912f3c8161f703f0-60" name="rest_code_4f02b851ecb14bcf912f3c8161f703f0-60" href="posts/bem_corrected/#rest_code_4f02b851ecb14bcf912f3c8161f703f0-60"></a><span class="sd">          Influence coefficient for primary variable.</span>
<a id="rest_code_4f02b851ecb14bcf912f3c8161f703f0-61" name="rest_code_4f02b851ecb14bcf912f3c8161f703f0-61" href="posts/bem_corrected/#rest_code_4f02b851ecb14bcf912f3c8161f703f0-61"></a><span class="sd">      """</span>
<a id="rest_code_4f02b851ecb14bcf912f3c8161f703f0-62" name="rest_code_4f02b851ecb14bcf912f3c8161f703f0-62" href="posts/bem_corrected/#rest_code_4f02b851ecb14bcf912f3c8161f703f0-62"></a>      <span class="n">dcos</span> <span class="o">=</span> <span class="n">coords</span><span class="p">[</span><span class="n">elem</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="o">-</span> <span class="n">coords</span><span class="p">[</span><span class="n">elem</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
<a id="rest_code_4f02b851ecb14bcf912f3c8161f703f0-63" name="rest_code_4f02b851ecb14bcf912f3c8161f703f0-63" href="posts/bem_corrected/#rest_code_4f02b851ecb14bcf912f3c8161f703f0-63"></a>      <span class="n">dcos</span> <span class="o">=</span> <span class="n">dcos</span> <span class="o">/</span> <span class="n">norm</span><span class="p">(</span><span class="n">dcos</span><span class="p">)</span>
<a id="rest_code_4f02b851ecb14bcf912f3c8161f703f0-64" name="rest_code_4f02b851ecb14bcf912f3c8161f703f0-64" href="posts/bem_corrected/#rest_code_4f02b851ecb14bcf912f3c8161f703f0-64"></a>      <span class="n">rotmat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="n">dcos</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="o">-</span><span class="n">dcos</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span>
<a id="rest_code_4f02b851ecb14bcf912f3c8161f703f0-65" name="rest_code_4f02b851ecb14bcf912f3c8161f703f0-65" href="posts/bem_corrected/#rest_code_4f02b851ecb14bcf912f3c8161f703f0-65"></a>                      <span class="p">[</span><span class="n">dcos</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">dcos</span><span class="p">[</span><span class="mi">1</span><span class="p">]]])</span>
<a id="rest_code_4f02b851ecb14bcf912f3c8161f703f0-66" name="rest_code_4f02b851ecb14bcf912f3c8161f703f0-66" href="posts/bem_corrected/#rest_code_4f02b851ecb14bcf912f3c8161f703f0-66"></a>      <span class="n">r_A</span> <span class="o">=</span> <span class="n">rotmat</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">coords</span><span class="p">[</span><span class="n">elem</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">-</span> <span class="n">pt_col</span><span class="p">)</span>
<a id="rest_code_4f02b851ecb14bcf912f3c8161f703f0-67" name="rest_code_4f02b851ecb14bcf912f3c8161f703f0-67" href="posts/bem_corrected/#rest_code_4f02b851ecb14bcf912f3c8161f703f0-67"></a>      <span class="n">r_B</span> <span class="o">=</span> <span class="n">rotmat</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">coords</span><span class="p">[</span><span class="n">elem</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="o">-</span> <span class="n">pt_col</span><span class="p">)</span>
<a id="rest_code_4f02b851ecb14bcf912f3c8161f703f0-68" name="rest_code_4f02b851ecb14bcf912f3c8161f703f0-68" href="posts/bem_corrected/#rest_code_4f02b851ecb14bcf912f3c8161f703f0-68"></a>      <span class="n">theta_A</span> <span class="o">=</span> <span class="n">arctan2</span><span class="p">(</span><span class="n">r_A</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">r_A</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<a id="rest_code_4f02b851ecb14bcf912f3c8161f703f0-69" name="rest_code_4f02b851ecb14bcf912f3c8161f703f0-69" href="posts/bem_corrected/#rest_code_4f02b851ecb14bcf912f3c8161f703f0-69"></a>      <span class="n">theta_B</span> <span class="o">=</span> <span class="n">arctan2</span><span class="p">(</span><span class="n">r_B</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">r_B</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<a id="rest_code_4f02b851ecb14bcf912f3c8161f703f0-70" name="rest_code_4f02b851ecb14bcf912f3c8161f703f0-70" href="posts/bem_corrected/#rest_code_4f02b851ecb14bcf912f3c8161f703f0-70"></a>      <span class="k">if</span> <span class="n">norm</span><span class="p">(</span><span class="n">r_A</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mf">1e-6</span><span class="p">:</span>
<a id="rest_code_4f02b851ecb14bcf912f3c8161f703f0-71" name="rest_code_4f02b851ecb14bcf912f3c8161f703f0-71" href="posts/bem_corrected/#rest_code_4f02b851ecb14bcf912f3c8161f703f0-71"></a>          <span class="n">G_coeff</span> <span class="o">=</span> <span class="n">r_B</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">log</span><span class="p">(</span><span class="n">norm</span><span class="p">(</span><span class="n">r_B</span><span class="p">))</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">theta_B</span><span class="o">*</span><span class="n">r_B</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<a id="rest_code_4f02b851ecb14bcf912f3c8161f703f0-72" name="rest_code_4f02b851ecb14bcf912f3c8161f703f0-72" href="posts/bem_corrected/#rest_code_4f02b851ecb14bcf912f3c8161f703f0-72"></a>      <span class="k">elif</span> <span class="n">norm</span><span class="p">(</span><span class="n">r_B</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mf">1e-6</span><span class="p">:</span>
<a id="rest_code_4f02b851ecb14bcf912f3c8161f703f0-73" name="rest_code_4f02b851ecb14bcf912f3c8161f703f0-73" href="posts/bem_corrected/#rest_code_4f02b851ecb14bcf912f3c8161f703f0-73"></a>          <span class="n">G_coeff</span> <span class="o">=</span> <span class="o">-</span><span class="p">(</span><span class="n">r_A</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">log</span><span class="p">(</span><span class="n">norm</span><span class="p">(</span><span class="n">r_A</span><span class="p">))</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">theta_A</span><span class="o">*</span><span class="n">r_A</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<a id="rest_code_4f02b851ecb14bcf912f3c8161f703f0-74" name="rest_code_4f02b851ecb14bcf912f3c8161f703f0-74" href="posts/bem_corrected/#rest_code_4f02b851ecb14bcf912f3c8161f703f0-74"></a>      <span class="k">else</span><span class="p">:</span>
<a id="rest_code_4f02b851ecb14bcf912f3c8161f703f0-75" name="rest_code_4f02b851ecb14bcf912f3c8161f703f0-75" href="posts/bem_corrected/#rest_code_4f02b851ecb14bcf912f3c8161f703f0-75"></a>          <span class="n">G_coeff</span> <span class="o">=</span> <span class="n">r_B</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">log</span><span class="p">(</span><span class="n">norm</span><span class="p">(</span><span class="n">r_B</span><span class="p">))</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">theta_B</span><span class="o">*</span><span class="n">r_B</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span>\
<a id="rest_code_4f02b851ecb14bcf912f3c8161f703f0-76" name="rest_code_4f02b851ecb14bcf912f3c8161f703f0-76" href="posts/bem_corrected/#rest_code_4f02b851ecb14bcf912f3c8161f703f0-76"></a>                  <span class="p">(</span><span class="n">r_A</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">log</span><span class="p">(</span><span class="n">norm</span><span class="p">(</span><span class="n">r_A</span><span class="p">))</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">theta_A</span><span class="o">*</span><span class="n">r_A</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<a id="rest_code_4f02b851ecb14bcf912f3c8161f703f0-77" name="rest_code_4f02b851ecb14bcf912f3c8161f703f0-77" href="posts/bem_corrected/#rest_code_4f02b851ecb14bcf912f3c8161f703f0-77"></a>      <span class="n">F_coeff</span> <span class="o">=</span> <span class="n">theta_B</span> <span class="o">-</span> <span class="n">theta_A</span>
<a id="rest_code_4f02b851ecb14bcf912f3c8161f703f0-78" name="rest_code_4f02b851ecb14bcf912f3c8161f703f0-78" href="posts/bem_corrected/#rest_code_4f02b851ecb14bcf912f3c8161f703f0-78"></a>      <span class="k">return</span> <span class="o">-</span><span class="n">G_coeff</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="p">),</span> <span class="n">F_coeff</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="p">)</span>
<a id="rest_code_4f02b851ecb14bcf912f3c8161f703f0-79" name="rest_code_4f02b851ecb14bcf912f3c8161f703f0-79" href="posts/bem_corrected/#rest_code_4f02b851ecb14bcf912f3c8161f703f0-79"></a>
<a id="rest_code_4f02b851ecb14bcf912f3c8161f703f0-80" name="rest_code_4f02b851ecb14bcf912f3c8161f703f0-80" href="posts/bem_corrected/#rest_code_4f02b851ecb14bcf912f3c8161f703f0-80"></a>
<a id="rest_code_4f02b851ecb14bcf912f3c8161f703f0-81" name="rest_code_4f02b851ecb14bcf912f3c8161f703f0-81" href="posts/bem_corrected/#rest_code_4f02b851ecb14bcf912f3c8161f703f0-81"></a>  <span class="k">def</span><span class="w"> </span><span class="nf">eval_sol</span><span class="p">(</span><span class="n">ev_coords</span><span class="p">,</span> <span class="n">coords</span><span class="p">,</span> <span class="n">elems</span><span class="p">,</span> <span class="n">u_boundary</span><span class="p">,</span> <span class="n">q_boundary</span><span class="p">):</span>
<a id="rest_code_4f02b851ecb14bcf912f3c8161f703f0-82" name="rest_code_4f02b851ecb14bcf912f3c8161f703f0-82" href="posts/bem_corrected/#rest_code_4f02b851ecb14bcf912f3c8161f703f0-82"></a><span class="w">      </span><span class="sd">"""Evaluate the solution in a set of points</span>
<a id="rest_code_4f02b851ecb14bcf912f3c8161f703f0-83" name="rest_code_4f02b851ecb14bcf912f3c8161f703f0-83" href="posts/bem_corrected/#rest_code_4f02b851ecb14bcf912f3c8161f703f0-83"></a>
<a id="rest_code_4f02b851ecb14bcf912f3c8161f703f0-84" name="rest_code_4f02b851ecb14bcf912f3c8161f703f0-84" href="posts/bem_corrected/#rest_code_4f02b851ecb14bcf912f3c8161f703f0-84"></a><span class="sd">      Parameters</span>
<a id="rest_code_4f02b851ecb14bcf912f3c8161f703f0-85" name="rest_code_4f02b851ecb14bcf912f3c8161f703f0-85" href="posts/bem_corrected/#rest_code_4f02b851ecb14bcf912f3c8161f703f0-85"></a><span class="sd">      ----------</span>
<a id="rest_code_4f02b851ecb14bcf912f3c8161f703f0-86" name="rest_code_4f02b851ecb14bcf912f3c8161f703f0-86" href="posts/bem_corrected/#rest_code_4f02b851ecb14bcf912f3c8161f703f0-86"></a><span class="sd">      ev_coords : ndarray, float</span>
<a id="rest_code_4f02b851ecb14bcf912f3c8161f703f0-87" name="rest_code_4f02b851ecb14bcf912f3c8161f703f0-87" href="posts/bem_corrected/#rest_code_4f02b851ecb14bcf912f3c8161f703f0-87"></a><span class="sd">          Coordinates of the evaluation points.</span>
<a id="rest_code_4f02b851ecb14bcf912f3c8161f703f0-88" name="rest_code_4f02b851ecb14bcf912f3c8161f703f0-88" href="posts/bem_corrected/#rest_code_4f02b851ecb14bcf912f3c8161f703f0-88"></a><span class="sd">      coords : ndarray, float</span>
<a id="rest_code_4f02b851ecb14bcf912f3c8161f703f0-89" name="rest_code_4f02b851ecb14bcf912f3c8161f703f0-89" href="posts/bem_corrected/#rest_code_4f02b851ecb14bcf912f3c8161f703f0-89"></a><span class="sd">          Coordinates for the nodes.</span>
<a id="rest_code_4f02b851ecb14bcf912f3c8161f703f0-90" name="rest_code_4f02b851ecb14bcf912f3c8161f703f0-90" href="posts/bem_corrected/#rest_code_4f02b851ecb14bcf912f3c8161f703f0-90"></a><span class="sd">      elems : ndarray, int</span>
<a id="rest_code_4f02b851ecb14bcf912f3c8161f703f0-91" name="rest_code_4f02b851ecb14bcf912f3c8161f703f0-91" href="posts/bem_corrected/#rest_code_4f02b851ecb14bcf912f3c8161f703f0-91"></a><span class="sd">          Connectivity for the elements.</span>
<a id="rest_code_4f02b851ecb14bcf912f3c8161f703f0-92" name="rest_code_4f02b851ecb14bcf912f3c8161f703f0-92" href="posts/bem_corrected/#rest_code_4f02b851ecb14bcf912f3c8161f703f0-92"></a><span class="sd">      u_boundary : ndarray, float</span>
<a id="rest_code_4f02b851ecb14bcf912f3c8161f703f0-93" name="rest_code_4f02b851ecb14bcf912f3c8161f703f0-93" href="posts/bem_corrected/#rest_code_4f02b851ecb14bcf912f3c8161f703f0-93"></a><span class="sd">          Primary variable in the nodes.</span>
<a id="rest_code_4f02b851ecb14bcf912f3c8161f703f0-94" name="rest_code_4f02b851ecb14bcf912f3c8161f703f0-94" href="posts/bem_corrected/#rest_code_4f02b851ecb14bcf912f3c8161f703f0-94"></a><span class="sd">      q_boundary : [type]</span>
<a id="rest_code_4f02b851ecb14bcf912f3c8161f703f0-95" name="rest_code_4f02b851ecb14bcf912f3c8161f703f0-95" href="posts/bem_corrected/#rest_code_4f02b851ecb14bcf912f3c8161f703f0-95"></a><span class="sd">          Flows in the nodes.</span>
<a id="rest_code_4f02b851ecb14bcf912f3c8161f703f0-96" name="rest_code_4f02b851ecb14bcf912f3c8161f703f0-96" href="posts/bem_corrected/#rest_code_4f02b851ecb14bcf912f3c8161f703f0-96"></a>
<a id="rest_code_4f02b851ecb14bcf912f3c8161f703f0-97" name="rest_code_4f02b851ecb14bcf912f3c8161f703f0-97" href="posts/bem_corrected/#rest_code_4f02b851ecb14bcf912f3c8161f703f0-97"></a><span class="sd">      Returns</span>
<a id="rest_code_4f02b851ecb14bcf912f3c8161f703f0-98" name="rest_code_4f02b851ecb14bcf912f3c8161f703f0-98" href="posts/bem_corrected/#rest_code_4f02b851ecb14bcf912f3c8161f703f0-98"></a><span class="sd">      -------</span>
<a id="rest_code_4f02b851ecb14bcf912f3c8161f703f0-99" name="rest_code_4f02b851ecb14bcf912f3c8161f703f0-99" href="posts/bem_corrected/#rest_code_4f02b851ecb14bcf912f3c8161f703f0-99"></a><span class="sd">      solution : ndarray, float</span>
<a id="rest_code_4f02b851ecb14bcf912f3c8161f703f0-100" name="rest_code_4f02b851ecb14bcf912f3c8161f703f0-100" href="posts/bem_corrected/#rest_code_4f02b851ecb14bcf912f3c8161f703f0-100"></a><span class="sd">          Solution evaluated in the given points.</span>
<a id="rest_code_4f02b851ecb14bcf912f3c8161f703f0-101" name="rest_code_4f02b851ecb14bcf912f3c8161f703f0-101" href="posts/bem_corrected/#rest_code_4f02b851ecb14bcf912f3c8161f703f0-101"></a><span class="sd">      """</span>
<a id="rest_code_4f02b851ecb14bcf912f3c8161f703f0-102" name="rest_code_4f02b851ecb14bcf912f3c8161f703f0-102" href="posts/bem_corrected/#rest_code_4f02b851ecb14bcf912f3c8161f703f0-102"></a>      <span class="n">npts</span> <span class="o">=</span> <span class="n">ev_coords</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<a id="rest_code_4f02b851ecb14bcf912f3c8161f703f0-103" name="rest_code_4f02b851ecb14bcf912f3c8161f703f0-103" href="posts/bem_corrected/#rest_code_4f02b851ecb14bcf912f3c8161f703f0-103"></a>      <span class="n">solution</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">npts</span><span class="p">)</span>
<a id="rest_code_4f02b851ecb14bcf912f3c8161f703f0-104" name="rest_code_4f02b851ecb14bcf912f3c8161f703f0-104" href="posts/bem_corrected/#rest_code_4f02b851ecb14bcf912f3c8161f703f0-104"></a>      <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">npts</span><span class="p">):</span>
<a id="rest_code_4f02b851ecb14bcf912f3c8161f703f0-105" name="rest_code_4f02b851ecb14bcf912f3c8161f703f0-105" href="posts/bem_corrected/#rest_code_4f02b851ecb14bcf912f3c8161f703f0-105"></a>          <span class="k">for</span> <span class="n">ev_cont</span><span class="p">,</span> <span class="n">elem</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">elems</span><span class="p">):</span>
<a id="rest_code_4f02b851ecb14bcf912f3c8161f703f0-106" name="rest_code_4f02b851ecb14bcf912f3c8161f703f0-106" href="posts/bem_corrected/#rest_code_4f02b851ecb14bcf912f3c8161f703f0-106"></a>              <span class="n">pt_col</span> <span class="o">=</span> <span class="n">ev_coords</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
<a id="rest_code_4f02b851ecb14bcf912f3c8161f703f0-107" name="rest_code_4f02b851ecb14bcf912f3c8161f703f0-107" href="posts/bem_corrected/#rest_code_4f02b851ecb14bcf912f3c8161f703f0-107"></a>              <span class="n">G</span><span class="p">,</span> <span class="n">F</span> <span class="o">=</span> <span class="n">influence_coeff</span><span class="p">(</span><span class="n">elem</span><span class="p">,</span> <span class="n">coords</span><span class="p">,</span> <span class="n">pt_col</span><span class="p">)</span>
<a id="rest_code_4f02b851ecb14bcf912f3c8161f703f0-108" name="rest_code_4f02b851ecb14bcf912f3c8161f703f0-108" href="posts/bem_corrected/#rest_code_4f02b851ecb14bcf912f3c8161f703f0-108"></a>              <span class="n">solution</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">+=</span> <span class="n">u_boundary</span><span class="p">[</span><span class="n">ev_cont</span><span class="p">]</span><span class="o">*</span><span class="n">F</span> <span class="o">-</span> <span class="n">q_boundary</span><span class="p">[</span><span class="n">ev_cont</span><span class="p">]</span><span class="o">*</span><span class="n">G</span>
<a id="rest_code_4f02b851ecb14bcf912f3c8161f703f0-109" name="rest_code_4f02b851ecb14bcf912f3c8161f703f0-109" href="posts/bem_corrected/#rest_code_4f02b851ecb14bcf912f3c8161f703f0-109"></a>      <span class="k">return</span> <span class="n">solution</span>
<a id="rest_code_4f02b851ecb14bcf912f3c8161f703f0-110" name="rest_code_4f02b851ecb14bcf912f3c8161f703f0-110" href="posts/bem_corrected/#rest_code_4f02b851ecb14bcf912f3c8161f703f0-110"></a>
<a id="rest_code_4f02b851ecb14bcf912f3c8161f703f0-111" name="rest_code_4f02b851ecb14bcf912f3c8161f703f0-111" href="posts/bem_corrected/#rest_code_4f02b851ecb14bcf912f3c8161f703f0-111"></a>
<a id="rest_code_4f02b851ecb14bcf912f3c8161f703f0-112" name="rest_code_4f02b851ecb14bcf912f3c8161f703f0-112" href="posts/bem_corrected/#rest_code_4f02b851ecb14bcf912f3c8161f703f0-112"></a><span class="c1">#%% Simulation</span>
<a id="rest_code_4f02b851ecb14bcf912f3c8161f703f0-113" name="rest_code_4f02b851ecb14bcf912f3c8161f703f0-113" href="posts/bem_corrected/#rest_code_4f02b851ecb14bcf912f3c8161f703f0-113"></a><span class="n">mesh</span> <span class="o">=</span> <span class="n">meshio</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s2">"disk.msh"</span><span class="p">)</span>
<a id="rest_code_4f02b851ecb14bcf912f3c8161f703f0-114" name="rest_code_4f02b851ecb14bcf912f3c8161f703f0-114" href="posts/bem_corrected/#rest_code_4f02b851ecb14bcf912f3c8161f703f0-114"></a><span class="n">elems</span> <span class="o">=</span> <span class="n">mesh</span><span class="o">.</span><span class="n">cells</span><span class="p">[</span><span class="s2">"line"</span><span class="p">]</span>
<a id="rest_code_4f02b851ecb14bcf912f3c8161f703f0-115" name="rest_code_4f02b851ecb14bcf912f3c8161f703f0-115" href="posts/bem_corrected/#rest_code_4f02b851ecb14bcf912f3c8161f703f0-115"></a><span class="n">bound_nodes</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">elems</span><span class="o">.</span><span class="n">flatten</span><span class="p">()))</span>
<a id="rest_code_4f02b851ecb14bcf912f3c8161f703f0-116" name="rest_code_4f02b851ecb14bcf912f3c8161f703f0-116" href="posts/bem_corrected/#rest_code_4f02b851ecb14bcf912f3c8161f703f0-116"></a><span class="n">coords</span> <span class="o">=</span> <span class="n">mesh</span><span class="o">.</span><span class="n">points</span><span class="p">[</span><span class="n">bound_nodes</span><span class="p">,</span> <span class="p">:</span><span class="mi">2</span><span class="p">]</span>
<a id="rest_code_4f02b851ecb14bcf912f3c8161f703f0-117" name="rest_code_4f02b851ecb14bcf912f3c8161f703f0-117" href="posts/bem_corrected/#rest_code_4f02b851ecb14bcf912f3c8161f703f0-117"></a><span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">coords</span><span class="o">.</span><span class="n">T</span>
<a id="rest_code_4f02b851ecb14bcf912f3c8161f703f0-118" name="rest_code_4f02b851ecb14bcf912f3c8161f703f0-118" href="posts/bem_corrected/#rest_code_4f02b851ecb14bcf912f3c8161f703f0-118"></a><span class="n">x_m</span><span class="p">,</span> <span class="n">y_m</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="n">coords</span><span class="p">[</span><span class="n">elems</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]]</span> <span class="o">+</span> <span class="n">coords</span><span class="p">[</span><span class="n">elems</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]])</span><span class="o">.</span><span class="n">T</span>
<a id="rest_code_4f02b851ecb14bcf912f3c8161f703f0-119" name="rest_code_4f02b851ecb14bcf912f3c8161f703f0-119" href="posts/bem_corrected/#rest_code_4f02b851ecb14bcf912f3c8161f703f0-119"></a><span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arctan2</span><span class="p">(</span><span class="n">y_m</span><span class="p">,</span> <span class="n">x_m</span><span class="p">)</span>
<a id="rest_code_4f02b851ecb14bcf912f3c8161f703f0-120" name="rest_code_4f02b851ecb14bcf912f3c8161f703f0-120" href="posts/bem_corrected/#rest_code_4f02b851ecb14bcf912f3c8161f703f0-120"></a><span class="n">u_boundary</span> <span class="o">=</span> <span class="mi">3</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mi">6</span><span class="o">*</span><span class="n">theta</span><span class="p">)</span>
<a id="rest_code_4f02b851ecb14bcf912f3c8161f703f0-121" name="rest_code_4f02b851ecb14bcf912f3c8161f703f0-121" href="posts/bem_corrected/#rest_code_4f02b851ecb14bcf912f3c8161f703f0-121"></a>
<a id="rest_code_4f02b851ecb14bcf912f3c8161f703f0-122" name="rest_code_4f02b851ecb14bcf912f3c8161f703f0-122" href="posts/bem_corrected/#rest_code_4f02b851ecb14bcf912f3c8161f703f0-122"></a>
<a id="rest_code_4f02b851ecb14bcf912f3c8161f703f0-123" name="rest_code_4f02b851ecb14bcf912f3c8161f703f0-123" href="posts/bem_corrected/#rest_code_4f02b851ecb14bcf912f3c8161f703f0-123"></a><span class="c1">#%% Assembly</span>
<a id="rest_code_4f02b851ecb14bcf912f3c8161f703f0-124" name="rest_code_4f02b851ecb14bcf912f3c8161f703f0-124" href="posts/bem_corrected/#rest_code_4f02b851ecb14bcf912f3c8161f703f0-124"></a><span class="n">Gmat</span><span class="p">,</span> <span class="n">Fmat</span> <span class="o">=</span> <span class="n">assem</span><span class="p">(</span><span class="n">coords</span><span class="p">,</span> <span class="n">elems</span><span class="p">)</span>
<a id="rest_code_4f02b851ecb14bcf912f3c8161f703f0-125" name="rest_code_4f02b851ecb14bcf912f3c8161f703f0-125" href="posts/bem_corrected/#rest_code_4f02b851ecb14bcf912f3c8161f703f0-125"></a>
<a id="rest_code_4f02b851ecb14bcf912f3c8161f703f0-126" name="rest_code_4f02b851ecb14bcf912f3c8161f703f0-126" href="posts/bem_corrected/#rest_code_4f02b851ecb14bcf912f3c8161f703f0-126"></a><span class="c1">#%% Solution</span>
<a id="rest_code_4f02b851ecb14bcf912f3c8161f703f0-127" name="rest_code_4f02b851ecb14bcf912f3c8161f703f0-127" href="posts/bem_corrected/#rest_code_4f02b851ecb14bcf912f3c8161f703f0-127"></a><span class="n">q_boundary</span> <span class="o">=</span> <span class="n">solve</span><span class="p">(</span><span class="n">Gmat</span><span class="p">,</span> <span class="n">Fmat</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">u_boundary</span><span class="p">))</span>
<a id="rest_code_4f02b851ecb14bcf912f3c8161f703f0-128" name="rest_code_4f02b851ecb14bcf912f3c8161f703f0-128" href="posts/bem_corrected/#rest_code_4f02b851ecb14bcf912f3c8161f703f0-128"></a>
<a id="rest_code_4f02b851ecb14bcf912f3c8161f703f0-129" name="rest_code_4f02b851ecb14bcf912f3c8161f703f0-129" href="posts/bem_corrected/#rest_code_4f02b851ecb14bcf912f3c8161f703f0-129"></a><span class="c1">#%% Evaluation</span>
<a id="rest_code_4f02b851ecb14bcf912f3c8161f703f0-130" name="rest_code_4f02b851ecb14bcf912f3c8161f703f0-130" href="posts/bem_corrected/#rest_code_4f02b851ecb14bcf912f3c8161f703f0-130"></a><span class="n">ev_coords</span> <span class="o">=</span>  <span class="n">mesh</span><span class="o">.</span><span class="n">points</span><span class="p">[:,</span> <span class="p">:</span><span class="mi">2</span><span class="p">]</span>
<a id="rest_code_4f02b851ecb14bcf912f3c8161f703f0-131" name="rest_code_4f02b851ecb14bcf912f3c8161f703f0-131" href="posts/bem_corrected/#rest_code_4f02b851ecb14bcf912f3c8161f703f0-131"></a><span class="n">ev_x</span><span class="p">,</span> <span class="n">ev_y</span> <span class="o">=</span> <span class="n">ev_coords</span><span class="o">.</span><span class="n">T</span>
<a id="rest_code_4f02b851ecb14bcf912f3c8161f703f0-132" name="rest_code_4f02b851ecb14bcf912f3c8161f703f0-132" href="posts/bem_corrected/#rest_code_4f02b851ecb14bcf912f3c8161f703f0-132"></a><span class="n">solution</span> <span class="o">=</span> <span class="n">eval_sol</span><span class="p">(</span><span class="n">ev_coords</span><span class="p">,</span> <span class="n">coords</span><span class="p">,</span> <span class="n">elems</span><span class="p">,</span> <span class="n">u_boundary</span><span class="p">,</span> <span class="n">q_boundary</span><span class="p">)</span>
<a id="rest_code_4f02b851ecb14bcf912f3c8161f703f0-133" name="rest_code_4f02b851ecb14bcf912f3c8161f703f0-133" href="posts/bem_corrected/#rest_code_4f02b851ecb14bcf912f3c8161f703f0-133"></a>
<a id="rest_code_4f02b851ecb14bcf912f3c8161f703f0-134" name="rest_code_4f02b851ecb14bcf912f3c8161f703f0-134" href="posts/bem_corrected/#rest_code_4f02b851ecb14bcf912f3c8161f703f0-134"></a><span class="c1">#%% Visualization</span>
<a id="rest_code_4f02b851ecb14bcf912f3c8161f703f0-135" name="rest_code_4f02b851ecb14bcf912f3c8161f703f0-135" href="posts/bem_corrected/#rest_code_4f02b851ecb14bcf912f3c8161f703f0-135"></a><span class="n">tris</span> <span class="o">=</span> <span class="n">mesh</span><span class="o">.</span><span class="n">cells</span><span class="p">[</span><span class="s2">"triangle"</span><span class="p">]</span>
<a id="rest_code_4f02b851ecb14bcf912f3c8161f703f0-136" name="rest_code_4f02b851ecb14bcf912f3c8161f703f0-136" href="posts/bem_corrected/#rest_code_4f02b851ecb14bcf912f3c8161f703f0-136"></a><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<a id="rest_code_4f02b851ecb14bcf912f3c8161f703f0-137" name="rest_code_4f02b851ecb14bcf912f3c8161f703f0-137" href="posts/bem_corrected/#rest_code_4f02b851ecb14bcf912f3c8161f703f0-137"></a><span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="s1">'3d'</span><span class="p">)</span>
<a id="rest_code_4f02b851ecb14bcf912f3c8161f703f0-138" name="rest_code_4f02b851ecb14bcf912f3c8161f703f0-138" href="posts/bem_corrected/#rest_code_4f02b851ecb14bcf912f3c8161f703f0-138"></a><span class="n">ax</span><span class="o">.</span><span class="n">plot_trisurf</span><span class="p">(</span><span class="n">ev_x</span><span class="p">,</span> <span class="n">ev_y</span><span class="p">,</span> <span class="n">solution</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">"RdYlBu"</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span>
<a id="rest_code_4f02b851ecb14bcf912f3c8161f703f0-139" name="rest_code_4f02b851ecb14bcf912f3c8161f703f0-139" href="posts/bem_corrected/#rest_code_4f02b851ecb14bcf912f3c8161f703f0-139"></a>                <span class="n">edgecolor</span><span class="o">=</span><span class="s2">"#3c3c3c"</span><span class="p">)</span>
<a id="rest_code_4f02b851ecb14bcf912f3c8161f703f0-140" name="rest_code_4f02b851ecb14bcf912f3c8161f703f0-140" href="posts/bem_corrected/#rest_code_4f02b851ecb14bcf912f3c8161f703f0-140"></a><span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">([])</span>
<a id="rest_code_4f02b851ecb14bcf912f3c8161f703f0-141" name="rest_code_4f02b851ecb14bcf912f3c8161f703f0-141" href="posts/bem_corrected/#rest_code_4f02b851ecb14bcf912f3c8161f703f0-141"></a><span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">([])</span>
<a id="rest_code_4f02b851ecb14bcf912f3c8161f703f0-142" name="rest_code_4f02b851ecb14bcf912f3c8161f703f0-142" href="posts/bem_corrected/#rest_code_4f02b851ecb14bcf912f3c8161f703f0-142"></a><span class="n">ax</span><span class="o">.</span><span class="n">set_zticks</span><span class="p">([])</span>
<a id="rest_code_4f02b851ecb14bcf912f3c8161f703f0-143" name="rest_code_4f02b851ecb14bcf912f3c8161f703f0-143" href="posts/bem_corrected/#rest_code_4f02b851ecb14bcf912f3c8161f703f0-143"></a><span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">"bem_solution.png"</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s2">"tight"</span><span class="p">,</span> <span class="n">transparent</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<a id="rest_code_4f02b851ecb14bcf912f3c8161f703f0-144" name="rest_code_4f02b851ecb14bcf912f3c8161f703f0-144" href="posts/bem_corrected/#rest_code_4f02b851ecb14bcf912f3c8161f703f0-144"></a>            <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>
</pre></div>
<p>En este caso obtenemos el siguiente resultado.</p>
<img alt="Solución de la ecuación diferencial usando BEM." class="align-center" src="../images/bem_solution.png" style="width: 600px;"></section>
</div>
    </article><article class="post h-entry post-text"><header><h1 class="post-title p-name"><a href="posts/download_stream/" class="u-url">Descargar videos de MS Stream</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn">Nicolás Guarín-Zapata</span></p>
            <p class="dateline"><a href="posts/download_stream/" rel="bookmark"><time class="post-date published dt-published" datetime="2020-06-12T15:31:22-05:00" title="2020-06-12 15:31">2020-06-12 15:31</time></a></p>
                <p class="commentline">
    
    <a href="posts/download_stream/#disqus_thread" data-disqus-identifier="cache/posts/download_stream.html">Comentarios</a>


        </p>
</div>
    </header><div class="e-content entry-content">
    <p>Esta semana un estudiante me preguntó acerca de descargar los videos de uno
de los cursos de MS Stream. El problema es que si no eres propietario
del video no puedes descargarlo. Entonces, voy a mostrar una opción para
descargar videos sin ser propietario de los mismos.</p>
<p><strong>Descargo de responsabilidad:</strong> puede ser una buena idea preguntar a tu
organización sobre los derechos de autor de los videos.</p>
<section id="prerrequisitos"><h2>Prerrequisitos</h2>
<p>Vas a necesitar lo siguiente:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://git-scm.com/downloads">git</a>;</p></li>
<li><p><a class="reference external" href="https://www.ffmpeg.org/download.html">ffmpeg</a>; and</p></li>
<li><p><a class="reference external" href="https://nodejs.org/en/download/">Node.js</a>.</p></li>
</ul></section><section id="instalacion-de-destreamer"><h2>Instalación de <code class="docutils literal">destreamer</code>
</h2>
<p>Después de obtener los requisitos previos, puedes descargar
<a class="reference external" href="https://github.com/snobu/destreamer">destreamer</a> usando</p>
<div class="code"><pre class="code bash"><a id="rest_code_14077fc68f6e4207a6832d9adf236a47-1" name="rest_code_14077fc68f6e4207a6832d9adf236a47-1" href="posts/download_stream/#rest_code_14077fc68f6e4207a6832d9adf236a47-1"></a>$<span class="w"> </span>git<span class="w"> </span>clone<span class="w"> </span>https://github.com/snobu/destreamer
<a id="rest_code_14077fc68f6e4207a6832d9adf236a47-2" name="rest_code_14077fc68f6e4207a6832d9adf236a47-2" href="posts/download_stream/#rest_code_14077fc68f6e4207a6832d9adf236a47-2"></a>$<span class="w"> </span><span class="nb">cd</span><span class="w"> </span>destreamer
<a id="rest_code_14077fc68f6e4207a6832d9adf236a47-3" name="rest_code_14077fc68f6e4207a6832d9adf236a47-3" href="posts/download_stream/#rest_code_14077fc68f6e4207a6832d9adf236a47-3"></a>$<span class="w"> </span>npm<span class="w"> </span>install
<a id="rest_code_14077fc68f6e4207a6832d9adf236a47-4" name="rest_code_14077fc68f6e4207a6832d9adf236a47-4" href="posts/download_stream/#rest_code_14077fc68f6e4207a6832d9adf236a47-4"></a>$<span class="w"> </span>npm<span class="w"> </span>run<span class="w"> </span>build
</pre></div>
<p>en una terminal.</p>
<p>Si no se quiere jugar con
<a class="reference external" href="https://en.wikipedia.org/wiki/Environment_variable">variables de entorno</a>,
sugiero agregar <code class="docutils literal">ffmpeg</code> a la misma carpeta en donde se encuentra
<code class="docutils literal">destreamer</code>.</p>
</section><section id="descarga"><h2>Descarga</h2>
<p>Después de eso, debe navegar a la carpeta donde descargaste <code class="docutils literal">destreamer</code> y</p>
<div class="code"><pre class="code bash"><a id="rest_code_4befed4c4e054beb8ff0e3cf97c8a74f-1" name="rest_code_4befed4c4e054beb8ff0e3cf97c8a74f-1" href="posts/download_stream/#rest_code_4befed4c4e054beb8ff0e3cf97c8a74f-1"></a>$<span class="w"> </span>./destreamer.sh<span class="w"> </span>-i<span class="w"> </span><span class="s2">"https://web.microsoftstream.com/video/VIDEO_ID"</span>
</pre></div>
<p>en Mac o Linux,</p>
<div class="code"><pre class="code bash"><a id="rest_code_a4003f5f4a5a4860a4de90285e88c1a4-1" name="rest_code_a4003f5f4a5a4860a4de90285e88c1a4-1" href="posts/download_stream/#rest_code_a4003f5f4a5a4860a4de90285e88c1a4-1"></a>$<span class="w"> </span>destreamer.cmd<span class="w"> </span>-i<span class="w"> </span><span class="s2">"https://web.microsoftstream.com/video/VIDEO_ID"</span>
</pre></div>
<p>en el <em>command prompt</em> en Windows, y</p>
<div class="code"><pre class="code bash"><a id="rest_code_d869eea6308f4a988ba08f8c0ec8139c-1" name="rest_code_d869eea6308f4a988ba08f8c0ec8139c-1" href="posts/download_stream/#rest_code_d869eea6308f4a988ba08f8c0ec8139c-1"></a>$<span class="w"> </span>destreamer.ps1<span class="w"> </span>-i<span class="w"> </span><span class="s2">"https://web.microsoftstream.com/video/VIDEO_ID"</span>
</pre></div>
<p>en PowerShell. <code class="docutils literal">VIDEO_ID</code> se refiere al identificador del video
en MS Stream.</p>
<p>Si deseas descargar varios archivos (como un curso completo),
puedes crear un archivo con las URL y usar</p>
<div class="code"><pre class="code bash"><a id="rest_code_c017624f54054d1aaedef66f1c048b85-1" name="rest_code_c017624f54054d1aaedef66f1c048b85-1" href="posts/download_stream/#rest_code_c017624f54054d1aaedef66f1c048b85-1"></a>$<span class="w"> </span>destreamer.cmd<span class="w"> </span>-f<span class="w"> </span>filename.txt
</pre></div>
</section>
</div>
    </article><article class="post h-entry post-text"><header><h1 class="post-title p-name"><a href="posts/marking-tetrahedron/" class="u-url">Marcado Aleatorio de un Tetraedro</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn">Nicolás Guarín-Zapata</span></p>
            <p class="dateline"><a href="posts/marking-tetrahedron/" rel="bookmark"><time class="post-date published dt-published" datetime="2020-06-05T22:58:32-05:00" title="2020-06-05 22:58">2020-06-05 22:58</time></a></p>
                <p class="commentline">
    
    <a href="posts/marking-tetrahedron/#disqus_thread" data-disqus-identifier="cache/posts/marking-tetrahedron.html">Comentarios</a>


        </p>
</div>
    </header><div class="e-content entry-content">
    <p>El día de ayer (junio 4 de 2020), Christian Howard publicó en
<a class="reference external" href="https://twitter.com/choward1491/status/1268736220055699457">Twitter</a>
la siguiente pregunta</p>
<blockquote>
<p>Dado un tetraedro τ. Para cada cara triangular de τ,
marcamos al azar uniformemente uno de sus aristas. ¿Cuál es el
probabilidad de que exista una arista de τ que se marca dos veces?</p>
</blockquote>
<p>Pensé un poco pero no pude encontrar la manera apropiada de
hacer e conteo. Entonces, se me ocurrió un número de la nada:
<span class="math">\(2/3\)</span>, pero no sé por qué. Así que decidí correr una
simulación para verificar este número.</p>
<p>La respuesta correcta es <span class="math">\(51/81\)</span>, aproximadamente 63%. este
cálculo está bien explicado en el
<a class="reference external" href="https://medium.com/@choward1491/randomized-marking-of-a-tetrahedron-f978593f43d2">blog de Christian</a>
con algunos gráficos interesantes (y memes).</p>
<section id="el-algoritmo"><h2>El algoritmo</h2>
<p>El algoritmo es bastante simple. Se enumeran las aristas de cada
cara siguiendo una orientación antihooraria:</p>
<ul class="simple">
<li><p><strong>cara 0</strong>: arista 0, arista 1, arista 2</p></li>
<li><p><strong>cara 1</strong>: arista 0, arista 3, arista 4</p></li>
<li><p><strong>cara 2</strong>: arista 1, arista 5, arista 3</p></li>
<li><p><strong>cara 3</strong>: arista 2, arista 4, arista 5</p></li>
</ul>
<p>Luego, se toma cada cara y se elige un número al azar
entre <span class="math">\((0, 1, 2)\)</span> se marca la arista correspondiente,
y se procede a la siguiente cara. Se repite este proceso muchas
veces y se cuentan los casos favorables y se dividen por el
número total de intentos para obtener un estimado de la
probabilidad.</p>
<p>A continuación se muestra un código de Python con esta idea.</p>
<div class="code"><pre class="code python"><a id="rest_code_75f2f6b45d464731834a81b8aada1891-1" name="rest_code_75f2f6b45d464731834a81b8aada1891-1" href="posts/marking-tetrahedron/#rest_code_75f2f6b45d464731834a81b8aada1891-1"></a><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<a id="rest_code_75f2f6b45d464731834a81b8aada1891-2" name="rest_code_75f2f6b45d464731834a81b8aada1891-2" href="posts/marking-tetrahedron/#rest_code_75f2f6b45d464731834a81b8aada1891-2"></a><span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<a id="rest_code_75f2f6b45d464731834a81b8aada1891-3" name="rest_code_75f2f6b45d464731834a81b8aada1891-3" href="posts/marking-tetrahedron/#rest_code_75f2f6b45d464731834a81b8aada1891-3"></a>
<a id="rest_code_75f2f6b45d464731834a81b8aada1891-4" name="rest_code_75f2f6b45d464731834a81b8aada1891-4" href="posts/marking-tetrahedron/#rest_code_75f2f6b45d464731834a81b8aada1891-4"></a><span class="n">faces</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
<a id="rest_code_75f2f6b45d464731834a81b8aada1891-5" name="rest_code_75f2f6b45d464731834a81b8aada1891-5" href="posts/marking-tetrahedron/#rest_code_75f2f6b45d464731834a81b8aada1891-5"></a>        <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
<a id="rest_code_75f2f6b45d464731834a81b8aada1891-6" name="rest_code_75f2f6b45d464731834a81b8aada1891-6" href="posts/marking-tetrahedron/#rest_code_75f2f6b45d464731834a81b8aada1891-6"></a>        <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
<a id="rest_code_75f2f6b45d464731834a81b8aada1891-7" name="rest_code_75f2f6b45d464731834a81b8aada1891-7" href="posts/marking-tetrahedron/#rest_code_75f2f6b45d464731834a81b8aada1891-7"></a>        <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
<a id="rest_code_75f2f6b45d464731834a81b8aada1891-8" name="rest_code_75f2f6b45d464731834a81b8aada1891-8" href="posts/marking-tetrahedron/#rest_code_75f2f6b45d464731834a81b8aada1891-8"></a>        <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]])</span>
<a id="rest_code_75f2f6b45d464731834a81b8aada1891-9" name="rest_code_75f2f6b45d464731834a81b8aada1891-9" href="posts/marking-tetrahedron/#rest_code_75f2f6b45d464731834a81b8aada1891-9"></a>
<a id="rest_code_75f2f6b45d464731834a81b8aada1891-10" name="rest_code_75f2f6b45d464731834a81b8aada1891-10" href="posts/marking-tetrahedron/#rest_code_75f2f6b45d464731834a81b8aada1891-10"></a>
<a id="rest_code_75f2f6b45d464731834a81b8aada1891-11" name="rest_code_75f2f6b45d464731834a81b8aada1891-11" href="posts/marking-tetrahedron/#rest_code_75f2f6b45d464731834a81b8aada1891-11"></a><span class="k">def</span><span class="w"> </span><span class="nf">mark_edges</span><span class="p">():</span>
<a id="rest_code_75f2f6b45d464731834a81b8aada1891-12" name="rest_code_75f2f6b45d464731834a81b8aada1891-12" href="posts/marking-tetrahedron/#rest_code_75f2f6b45d464731834a81b8aada1891-12"></a>    <span class="n">marked_edges</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">6</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
<a id="rest_code_75f2f6b45d464731834a81b8aada1891-13" name="rest_code_75f2f6b45d464731834a81b8aada1891-13" href="posts/marking-tetrahedron/#rest_code_75f2f6b45d464731834a81b8aada1891-13"></a>    <span class="k">for</span> <span class="n">face</span> <span class="ow">in</span> <span class="n">faces</span><span class="p">:</span>
<a id="rest_code_75f2f6b45d464731834a81b8aada1891-14" name="rest_code_75f2f6b45d464731834a81b8aada1891-14" href="posts/marking-tetrahedron/#rest_code_75f2f6b45d464731834a81b8aada1891-14"></a>        <span class="n">num</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<a id="rest_code_75f2f6b45d464731834a81b8aada1891-15" name="rest_code_75f2f6b45d464731834a81b8aada1891-15" href="posts/marking-tetrahedron/#rest_code_75f2f6b45d464731834a81b8aada1891-15"></a>        <span class="n">edge</span> <span class="o">=</span> <span class="n">face</span><span class="p">[</span><span class="n">num</span><span class="p">]</span>
<a id="rest_code_75f2f6b45d464731834a81b8aada1891-16" name="rest_code_75f2f6b45d464731834a81b8aada1891-16" href="posts/marking-tetrahedron/#rest_code_75f2f6b45d464731834a81b8aada1891-16"></a>        <span class="n">marked_edges</span><span class="p">[</span><span class="n">edge</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
<a id="rest_code_75f2f6b45d464731834a81b8aada1891-17" name="rest_code_75f2f6b45d464731834a81b8aada1891-17" href="posts/marking-tetrahedron/#rest_code_75f2f6b45d464731834a81b8aada1891-17"></a>    <span class="k">return</span> <span class="n">marked_edges</span>
<a id="rest_code_75f2f6b45d464731834a81b8aada1891-18" name="rest_code_75f2f6b45d464731834a81b8aada1891-18" href="posts/marking-tetrahedron/#rest_code_75f2f6b45d464731834a81b8aada1891-18"></a>
<a id="rest_code_75f2f6b45d464731834a81b8aada1891-19" name="rest_code_75f2f6b45d464731834a81b8aada1891-19" href="posts/marking-tetrahedron/#rest_code_75f2f6b45d464731834a81b8aada1891-19"></a>
<a id="rest_code_75f2f6b45d464731834a81b8aada1891-20" name="rest_code_75f2f6b45d464731834a81b8aada1891-20" href="posts/marking-tetrahedron/#rest_code_75f2f6b45d464731834a81b8aada1891-20"></a><span class="k">def</span><span class="w"> </span><span class="nf">comp_probs</span><span class="p">(</span><span class="n">N_min</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">N_max</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">ntrials</span><span class="o">=</span><span class="mi">100</span><span class="p">):</span>
<a id="rest_code_75f2f6b45d464731834a81b8aada1891-21" name="rest_code_75f2f6b45d464731834a81b8aada1891-21" href="posts/marking-tetrahedron/#rest_code_75f2f6b45d464731834a81b8aada1891-21"></a>    <span class="n">prob</span> <span class="o">=</span> <span class="p">[]</span>
<a id="rest_code_75f2f6b45d464731834a81b8aada1891-22" name="rest_code_75f2f6b45d464731834a81b8aada1891-22" href="posts/marking-tetrahedron/#rest_code_75f2f6b45d464731834a81b8aada1891-22"></a>    <span class="n">N_vals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="n">N_min</span><span class="p">,</span> <span class="n">N_max</span><span class="p">,</span> <span class="n">ntrials</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
<a id="rest_code_75f2f6b45d464731834a81b8aada1891-23" name="rest_code_75f2f6b45d464731834a81b8aada1891-23" href="posts/marking-tetrahedron/#rest_code_75f2f6b45d464731834a81b8aada1891-23"></a>    <span class="k">for</span> <span class="n">N</span> <span class="ow">in</span> <span class="n">N_vals</span><span class="p">:</span>
<a id="rest_code_75f2f6b45d464731834a81b8aada1891-24" name="rest_code_75f2f6b45d464731834a81b8aada1891-24" href="posts/marking-tetrahedron/#rest_code_75f2f6b45d464731834a81b8aada1891-24"></a>        <span class="n">cont_marked</span> <span class="o">=</span> <span class="mi">0</span>
<a id="rest_code_75f2f6b45d464731834a81b8aada1891-25" name="rest_code_75f2f6b45d464731834a81b8aada1891-25" href="posts/marking-tetrahedron/#rest_code_75f2f6b45d464731834a81b8aada1891-25"></a>        <span class="k">for</span> <span class="n">cont</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
<a id="rest_code_75f2f6b45d464731834a81b8aada1891-26" name="rest_code_75f2f6b45d464731834a81b8aada1891-26" href="posts/marking-tetrahedron/#rest_code_75f2f6b45d464731834a81b8aada1891-26"></a>            <span class="n">marked</span> <span class="o">=</span> <span class="n">mark_edges</span><span class="p">()</span>
<a id="rest_code_75f2f6b45d464731834a81b8aada1891-27" name="rest_code_75f2f6b45d464731834a81b8aada1891-27" href="posts/marking-tetrahedron/#rest_code_75f2f6b45d464731834a81b8aada1891-27"></a>            <span class="k">if</span> <span class="mi">2</span> <span class="ow">in</span> <span class="n">marked</span><span class="p">:</span>
<a id="rest_code_75f2f6b45d464731834a81b8aada1891-28" name="rest_code_75f2f6b45d464731834a81b8aada1891-28" href="posts/marking-tetrahedron/#rest_code_75f2f6b45d464731834a81b8aada1891-28"></a>                <span class="n">cont_marked</span> <span class="o">+=</span> <span class="mi">1</span>
<a id="rest_code_75f2f6b45d464731834a81b8aada1891-29" name="rest_code_75f2f6b45d464731834a81b8aada1891-29" href="posts/marking-tetrahedron/#rest_code_75f2f6b45d464731834a81b8aada1891-29"></a>        <span class="n">prob</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cont_marked</span><span class="o">/</span><span class="n">N</span><span class="p">)</span>
<a id="rest_code_75f2f6b45d464731834a81b8aada1891-30" name="rest_code_75f2f6b45d464731834a81b8aada1891-30" href="posts/marking-tetrahedron/#rest_code_75f2f6b45d464731834a81b8aada1891-30"></a>    <span class="k">return</span> <span class="n">N_vals</span><span class="p">,</span> <span class="n">prob</span>
<a id="rest_code_75f2f6b45d464731834a81b8aada1891-31" name="rest_code_75f2f6b45d464731834a81b8aada1891-31" href="posts/marking-tetrahedron/#rest_code_75f2f6b45d464731834a81b8aada1891-31"></a>
<a id="rest_code_75f2f6b45d464731834a81b8aada1891-32" name="rest_code_75f2f6b45d464731834a81b8aada1891-32" href="posts/marking-tetrahedron/#rest_code_75f2f6b45d464731834a81b8aada1891-32"></a>
<a id="rest_code_75f2f6b45d464731834a81b8aada1891-33" name="rest_code_75f2f6b45d464731834a81b8aada1891-33" href="posts/marking-tetrahedron/#rest_code_75f2f6b45d464731834a81b8aada1891-33"></a><span class="c1">#%% Cálculos</span>
<a id="rest_code_75f2f6b45d464731834a81b8aada1891-34" name="rest_code_75f2f6b45d464731834a81b8aada1891-34" href="posts/marking-tetrahedron/#rest_code_75f2f6b45d464731834a81b8aada1891-34"></a><span class="n">N_min</span> <span class="o">=</span> <span class="mi">1</span>
<a id="rest_code_75f2f6b45d464731834a81b8aada1891-35" name="rest_code_75f2f6b45d464731834a81b8aada1891-35" href="posts/marking-tetrahedron/#rest_code_75f2f6b45d464731834a81b8aada1891-35"></a><span class="n">N_max</span> <span class="o">=</span> <span class="mi">5</span>
<a id="rest_code_75f2f6b45d464731834a81b8aada1891-36" name="rest_code_75f2f6b45d464731834a81b8aada1891-36" href="posts/marking-tetrahedron/#rest_code_75f2f6b45d464731834a81b8aada1891-36"></a><span class="n">ntrials</span> <span class="o">=</span> <span class="mi">100</span>
<a id="rest_code_75f2f6b45d464731834a81b8aada1891-37" name="rest_code_75f2f6b45d464731834a81b8aada1891-37" href="posts/marking-tetrahedron/#rest_code_75f2f6b45d464731834a81b8aada1891-37"></a><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<a id="rest_code_75f2f6b45d464731834a81b8aada1891-38" name="rest_code_75f2f6b45d464731834a81b8aada1891-38" href="posts/marking-tetrahedron/#rest_code_75f2f6b45d464731834a81b8aada1891-38"></a><span class="n">N_vals</span><span class="p">,</span> <span class="n">prob</span> <span class="o">=</span> <span class="n">comp_probs</span><span class="p">(</span><span class="n">N_min</span><span class="p">,</span> <span class="n">N_max</span><span class="p">,</span> <span class="n">ntrials</span><span class="p">)</span>
<a id="rest_code_75f2f6b45d464731834a81b8aada1891-39" name="rest_code_75f2f6b45d464731834a81b8aada1891-39" href="posts/marking-tetrahedron/#rest_code_75f2f6b45d464731834a81b8aada1891-39"></a>
<a id="rest_code_75f2f6b45d464731834a81b8aada1891-40" name="rest_code_75f2f6b45d464731834a81b8aada1891-40" href="posts/marking-tetrahedron/#rest_code_75f2f6b45d464731834a81b8aada1891-40"></a><span class="c1">#%% Gráficos</span>
<a id="rest_code_75f2f6b45d464731834a81b8aada1891-41" name="rest_code_75f2f6b45d464731834a81b8aada1891-41" href="posts/marking-tetrahedron/#rest_code_75f2f6b45d464731834a81b8aada1891-41"></a><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<a id="rest_code_75f2f6b45d464731834a81b8aada1891-42" name="rest_code_75f2f6b45d464731834a81b8aada1891-42" href="posts/marking-tetrahedron/#rest_code_75f2f6b45d464731834a81b8aada1891-42"></a><span class="n">plt</span><span class="o">.</span><span class="n">hlines</span><span class="p">(</span><span class="mf">0.63</span><span class="p">,</span> <span class="mi">10</span><span class="o">**</span><span class="n">N_min</span><span class="p">,</span> <span class="mi">10</span><span class="o">**</span><span class="n">N_max</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">"#3f3f3f"</span><span class="p">)</span>
<a id="rest_code_75f2f6b45d464731834a81b8aada1891-43" name="rest_code_75f2f6b45d464731834a81b8aada1891-43" href="posts/marking-tetrahedron/#rest_code_75f2f6b45d464731834a81b8aada1891-43"></a><span class="n">plt</span><span class="o">.</span><span class="n">semilogx</span><span class="p">(</span><span class="n">N_vals</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">prob</span><span class="p">),</span> <span class="s2">"o"</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<a id="rest_code_75f2f6b45d464731834a81b8aada1891-44" name="rest_code_75f2f6b45d464731834a81b8aada1891-44" href="posts/marking-tetrahedron/#rest_code_75f2f6b45d464731834a81b8aada1891-44"></a><span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">"Number of trials"</span><span class="p">)</span>
<a id="rest_code_75f2f6b45d464731834a81b8aada1891-45" name="rest_code_75f2f6b45d464731834a81b8aada1891-45" href="posts/marking-tetrahedron/#rest_code_75f2f6b45d464731834a81b8aada1891-45"></a><span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">"Estimated probability"</span><span class="p">)</span>
<a id="rest_code_75f2f6b45d464731834a81b8aada1891-46" name="rest_code_75f2f6b45d464731834a81b8aada1891-46" href="posts/marking-tetrahedron/#rest_code_75f2f6b45d464731834a81b8aada1891-46"></a><span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">"prob_tet.svg"</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s2">"tight"</span><span class="p">)</span>
<a id="rest_code_75f2f6b45d464731834a81b8aada1891-47" name="rest_code_75f2f6b45d464731834a81b8aada1891-47" href="posts/marking-tetrahedron/#rest_code_75f2f6b45d464731834a81b8aada1891-47"></a><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
<p>Y podemos ver la evolución del estimado para diferente número
de intentos.</p>
<img alt="Probabilidad estimada para diferente número de intentos." class="align-center" src="../images/marked_tets.svg" style="width: 600px;"></section>
</div>
    </article><article class="post h-entry post-text"><header><h1 class="post-title p-name"><a href="posts/tech_writing/tech_writing/" class="u-url">Escritura técnica</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn">Nicolás Guarín-Zapata</span></p>
            <p class="dateline"><a href="posts/tech_writing/tech_writing/" rel="bookmark"><time class="post-date published dt-published" datetime="2020-05-28T15:53:40-05:00" title="2020-05-28 15:53">2020-05-28 15:53</time></a></p>
                <p class="commentline">
    
    <a href="posts/tech_writing/tech_writing/#disqus_thread" data-disqus-identifier="cache/posts/tech_writing/tech_writing.html">Comentarios</a>


        </p>
</div>
    </header><div class="e-content entry-content">
    <p>Esta es la primera publicación sobre redacción técnica <a class="brackets" href="posts/tech_writing/tech_writing/#footnote-1" id="footnote-reference-1" role="doc-noteref"><span class="fn-bracket">[</span>*<span class="fn-bracket">]</span></a> de una serie que
crearé poco a poco. La escritura técnica es algo con lo
que la mayoría de nosotros tenemos que lidiar en diferentes contextos. Por
ejemplo, en cursos universitarios, publicaciones de investigación,
documentación de software. La idea principal de la serie es mencionar algunos
de los trucos que he aprendido a lo largo de los años y algunas herramientas
que pueden ser útiles.</p>
<p>Las publicaciones futuras serán (probablemente) sobre:</p>
<ul class="simple">
<li><p><a class="reference external" href="posts/tech_writing/tech_writing_math">Uso de ecuaciones</a>;</p></li>
<li><p><a class="reference external" href="posts/tech_writing/tech_writing_figs">Uso de figuras</a>;</p></li>
<li><p>Uso de tablas; y</p></li>
<li><p>Gestión de referencias bibliográficas.</p></li>
</ul>
<section id="esta-publicacion"><h2>Esta publicación</h2>
<p>Como se mencionó anteriormente, la escritura técnica es algo con lo que muchas
personas tienen que lidiar. Esta es una habilidad que a veces se pasa por alto,
pero no debería. De acuerdo con la
<a class="reference external" href="https://www.bls.gov/ooh/media-and-communication/technical-writers.htm">U.S. Bureau of Labor Statistics</a></p>
<blockquote>
<p>Los redactores técnicos preparan manuales, guías prácticas,
artículos de revistas y otros documentos de respaldo para comunicar
información compleja y técnica con mayor facilidad.</p>
</blockquote>
<p>Y es una habilidad deseada en el lugar de trabajo. Se espera que su demanda crezca
alrededor del 10% en la década actual.</p>
<section id="tipografia"><h3>Tipografía</h3>
<p>Lo primero que debo mencionar es que escribir documentos es
tipografía ya que estamos <em>diseñando con texto</em> (Butterick, 2019). Por lo tanto,
deberíamos considerarnos tipógrafos, ya que constantemente diseñamos documentos.</p>
<p>Sugeriría echar un vistazo a "Butterick's Practical Typography"
ya que es un libro muy bueno sobre el tema y es fácil de leer. Voy a
mencionar algunos puntos importantes de acuerdo con la sección
"Tipografía en diez minutos":</p>
<ol class="arabic">
<li><p>La selección tipográfica más importante está en el cuerpo del texto.
Esto se debe al hecho de que es la mayor parte del documento.</p></li>
<li><p>Elija un tamaño de texto entre 10-12 puntos para documentos impresos
y 15-25 píxeles para documentos digitales.</p></li>
<li><p>El espacio entre líneas debe estar entre 120-145% del tamaño de la letra.</p></li>
<li>
<p>La longitud de la línea debe tener entre 45 y 90 caracteres. Esto es
aproximadamente 2 o 3 alfabetos en minúsculas:</p>
<p>abcdefghijklmnñopqrstuvwxyzabcdefghijklmnñopqrstuvwxyzabcd</p>
</li>
<li><p>Cuidado con la selección de su fuente. Intente evitar las fuentes
predeterminadas como Arial, Calibri o Times New Roman.</p></li>
</ol></section><section id="editores"><h3>Editores</h3>
<p>Otro punto que quiero tocar en esta publicación es el de los editores. La
primera pregunta que surge es "¿qué editor debo usar?". La respuesta corta es:
<strong>usa lo que tus colegas estén usando</strong>. Ese es mi mejor consejo; de esa
manera tienes personas con quienes hablar sobre tus dudas.</p>
<p>La respuesta larga ... es que cada editor tiene sus puntos débiles y fuertes.
Yo he escrito artículos científicos en LaTeX, LibreOffice Writer y MS Word;
todos se ven profesionales. Entonces, al final, puedes escribir tu
documentos de varias maneras y lograr un resultado similar. Yo prefiero usar
LaTeX para documentos largos, ya que se centra en la estructura del
documento en lugar de la apariencia y esta es la forma en que uno debe
administrar un documento largo como una disertación, en mi opinión.</p>
<p>Si solo quieres que elija un editor y te lo sugiera, diría que
<a class="reference external" href="https://www.libreoffice.org/">LibreOffice</a>. Una buena referencia es
"Designing with LibreOffice". Una vez que aprendas cómo usar estilos, preguntarás
cómo has estado escribiendo todos los documentos hasta ahora.</p>
<p>Hay dos grupos de editores que voy a discutir:
WYSIWYG (siglas en inglés para "Lo que ves es lo que obtienes") y
editores basados en marcado.</p>
<ul>
<li>
<p>WYSIWYG. Esta categoría es la que la mayoría de la gente conoce.
Dos ejemplos son:</p>
<ul class="simple">
<li><p>LibreOffice Writer; y</p></li>
<li><p>Microsoft Word.</p></li>
</ul>
</li>
<li>
<p>Los editores basados en marcado dependen de las marcas en el "texto" para
diferenciar secciones y estilos. En este caso, su texto parece código,
como se ve en la siguiente imagen</p>
<img alt="/images/rst_code.png" src="../images/rst_code.png"><p>Algunos ejemplos son:</p>
<ul class="simple">
<li><p>LaTeX;</p></li>
<li><p><a class="reference external" href="https://www.markdownguide.org/getting-started">Markdown</a>; y</p></li>
<li><p><a class="reference external" href="https://docutils.sourceforge.io/rst.html">reStructuredtext</a>.</p></li>
</ul>
</li>
</ul>
<p>Independientemente de cuál sea tu editor principal, sugiero utilizar
<a class="reference external" href="https://pandoc.org/">Pandoc</a>. Te permite convertir entre varios
formatos, haciendo el proceso un poco más fácil. Incluso hay un editor
basado completamente en él llamado <a class="reference external" href="https://panwriter.com/">Panwriter</a>.</p>
</section><section id="references"><h3>References</h3>
<ol class="arabic simple">
<li><p>Matthew Butterick (2019). <a class="reference external" href="https://practicaltypography.com/">Butterick's Practical Typography</a>.
Segunda edición, Matthew Butterick.</p></li>
<li><p>Wikibooks contributors. (2020). <a class="reference external" href="https://en.wikibooks.org/wiki/LaTeX">LaTeX</a>.
Wikibooks, The Free Textbook Project.</p></li>
<li><p>Bruce Byfield (2016). <a class="reference external" href="https://designingwithlibreoffice.com/">Designing with LibreOffice</a>.
Friends of OpenDocument, Inc.</p></li>
<li><p>Deville, S. (2015). <a class="reference external" href="https://sylvaindeville.net/2015/07/17/writing-academic-papers-in-plain-text-with-markdown-and-jupyter-notebook/">Writing academic papers in plain text with Markdown and Jupyter notebook</a>.
Sylvain Deville.</p></li>
<li><p>Eric Holscher (2016). <a class="reference external" href="https://www.ericholscher.com/blog/2016/jul/1/sphinx-and-rtd-for-writers/">An introduction to Sphinx and Read the Docs for Technical Writers</a>.</p></li>
</ol>
<aside class="footnote-list brackets"><aside class="footnote brackets" id="footnote-1" role="doc-footnote"><span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="posts/tech_writing/tech_writing/#footnote-reference-1">*</a><span class="fn-bracket">]</span></span>
<p>Esta publicación está (algo) relacionada con una
<a class="reference external" href="posts/tech_writing/herramientas-investigacion/">publicación anterior</a>
donde discutí sobre algunas herramientas de investigación que la mayoría
de nosotros necesitamos pero que comúnmente no se enseñan de manera formal.</p>
</aside></aside></section></section>
</div>
    </article><article class="post h-entry post-text"><header><h1 class="post-title p-name"><a href="posts/tech_writing/tech_writing_math/" class="u-url">Escritura técnica: usando matemáticas</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn">Nicolás Guarín-Zapata</span></p>
            <p class="dateline"><a href="posts/tech_writing/tech_writing_math/" rel="bookmark"><time class="post-date published dt-published" datetime="2020-05-28T15:53:40-05:00" title="2020-05-28 15:53">2020-05-28 15:53</time></a></p>
                <p class="commentline">
    
    <a href="posts/tech_writing/tech_writing_math/#disqus_thread" data-disqus-identifier="cache/posts/tech_writing/tech_writing_math.html">Comentarios</a>


        </p>
</div>
    </header><div class="e-content entry-content">
    <p>En una <a class="reference external" href="posts/tech_writing/tech_writing">publicación anterior</a> mencioné algunos aspectos
generales de la escritura técnica. En este me gustaría hablar sobre la
inclusión de expresiones matemáticas en documentos técnicos.</p>
<p>Hay dos formas principales de incluir matemáticas en documentos:</p>
<ul class="simple">
<li><p>utilizando texto; y</p></li>
<li><p>utilizando una interfaz gráfica.</p></li>
</ul>
<p>Usar una interfaz gráfica, como el editor de ecuaciones en LibreOffice Writer o
MS Word, o <a class="reference external" href="http://www.dessci.com/en/products/mathtype/">MathType</a> es
conveniente. No es necesario memorizar nada y se pueden mirar las expresiones
mientras se crean. Sin embargo, puede ser algo lento en comparación con el uso
de entrada de texto —una vez que se está cómodo con la sintaxis—.</p>
<p>Hay dos tipos de ecuaciones utilizadas en Internet:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://en.wikipedia.org/wiki/MathML">MathML</a> es un
<a class="reference external" href="https://en.wikipedia.org/wiki/World_Wide_Web_Consortium">estándar W3C</a>
para ecuaciones y está incluido en HTML5, por lo que funcionaría en todos los
navegadores modernos. El problema con este es que no está diseñado para ser
escrito a mano. Por tanto, uno puede usarlo si tiene alguna forma automática
de generar el código.</p></li>
<li><p><a class="reference external" href="https://www.overleaf.com/learn/latex/Mathematical_expressions">LaTeX</a>
es mi forma sugerida de escribir ecuaciones. La curva de aprendizaje podría
ser un un poco empinada al principio pero vale la pena.</p></li>
</ul>
<p>Una herramienta que ayuda con las ecuaciones es
<a class="reference external" href="https://mathpix.com/">MathPix Snip</a> que genera automáticamente código
LaTeX o MathML a partir de una imagen, incluso una escrita a mano. Otra
herramienta que es realmente útil es
<a class="reference external" href="http://detexify.kirelabs.org/classify.html">Detexify</a> que permite
dibujar un símbolo y proporciona la sintaxis de LaTeX de este.</p>
<p>En el resto de la publicación mostraré mis sugerencias para trabajar
con ecuaciones en LibreOffice y MS Word. Si estás utilizando LaTeX o
MarkDown/ReStructuredText para tus documentos ya estás utilizando
LaTeX para tus ecuaciones.</p>
<section id="libreoffice"><h2>LibreOffice</h2>
<p>LibreOffice tiene su propio editor de ecuaciones con su propia sintaxis y
funciona bien para expresiones pequeñas, pero se complica para ecuaciones
grandes o largas manipulaciones algebraicas. Para LibreOffice sugeriría usar
<a class="reference external" href="http://roland65.free.fr/texmaths/install.html">TexMaths</a>, es fácil de
usar y funciona para el procesador de textos (Writer) y presentaciones (Impress).
Supongo que también funciona para hojas de cálculo (Calc), pero no recuerdo
haber usado ecuaciones en una.</p>
</section><section id="ms-office"><h2>MS Office</h2>
<p>MS Office también tiene su propio editor de ecuaciones, funciona bien y es
fácil de usar. Sin embargo, el mismo problema aparece cuando quieres expresiones
largas. Una opción es usar directamente
<a class="reference external" href="https://docs.microsoft.com/en-us/archive/blogs/murrays/latex-math-in-office">LaTeX en Office</a>
pero prefiero usar
<a class="reference external" href="http://www.jonathanleroux.org/software/iguanatex/download.html">IguanaTex</a>.
Es un complemento que permite ingresar ecuaciones de forma similar a TexMaths en
LibreOffice.</p>
<p>También puede pegar directamente las ecuaciones MathML en MS Word (&gt;2013 y Windows).</p>
</section><section id="usa-sympy"><h2>Usa SymPy</h2>
<p>Independientemente de la herramienta que use para escribir sus documentos,
sugiero usar un <a class="reference external" href="https://es.wikipedia.org/wiki/Sistema_algebraico_computacional">CAS</a>
(del inglés Computer Algebra System), como Mathematica o SymPy. Estos programas
permiten la generación automática de LaTeX y MathML a partir de expresiones y
esto facilita mucho el proceso.</p>
<p>Veamos un ejemplo. Supongamos que tenemos la función</p>
<div class="math">
\begin{equation*}
f(x) = \exp(-x^2) \sin(3*x)
\end{equation*}
</div>
<p>y queremos calcular su segunda derivada</p>
<div class="math">
\begin{equation*}
f''(x) = \left(- 12 x \cos{\left(3 x \right)} + 2 \left(2 x^{2} - 1\right) \sin{\left(3 x \right)} - 9 \sin{\left(3 x \right)}\right) e^{- x^{2}}
\end{equation*}
</div>
<p>El siguiente bloque de código nos da el código LaTex</p>
<div class="code"><pre class="code python"><a id="rest_code_8c02941051a44ccea1e09b569a175e3c-1" name="rest_code_8c02941051a44ccea1e09b569a175e3c-1" href="posts/tech_writing/tech_writing_math/#rest_code_8c02941051a44ccea1e09b569a175e3c-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">sympy</span><span class="w"> </span><span class="kn">import</span> <span class="o">*</span>
<a id="rest_code_8c02941051a44ccea1e09b569a175e3c-2" name="rest_code_8c02941051a44ccea1e09b569a175e3c-2" href="posts/tech_writing/tech_writing_math/#rest_code_8c02941051a44ccea1e09b569a175e3c-2"></a><span class="n">init_session</span><span class="p">()</span>
<a id="rest_code_8c02941051a44ccea1e09b569a175e3c-3" name="rest_code_8c02941051a44ccea1e09b569a175e3c-3" href="posts/tech_writing/tech_writing_math/#rest_code_8c02941051a44ccea1e09b569a175e3c-3"></a><span class="n">f</span> <span class="o">=</span> <span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="p">)</span>
<a id="rest_code_8c02941051a44ccea1e09b569a175e3c-4" name="rest_code_8c02941051a44ccea1e09b569a175e3c-4" href="posts/tech_writing/tech_writing_math/#rest_code_8c02941051a44ccea1e09b569a175e3c-4"></a><span class="n">fxx</span> <span class="o">=</span> <span class="n">diff</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<a id="rest_code_8c02941051a44ccea1e09b569a175e3c-5" name="rest_code_8c02941051a44ccea1e09b569a175e3c-5" href="posts/tech_writing/tech_writing_math/#rest_code_8c02941051a44ccea1e09b569a175e3c-5"></a><span class="nb">print</span><span class="p">(</span><span class="n">latex</span><span class="p">(</span><span class="n">fxx</span><span class="p">))</span>
</pre></div>
<p>que es</p>
<div class="code"><pre class="code latex"><a id="rest_code_386b90f3e239410a8f3ca993c4f7d1b8-1" name="rest_code_386b90f3e239410a8f3ca993c4f7d1b8-1" href="posts/tech_writing/tech_writing_math/#rest_code_386b90f3e239410a8f3ca993c4f7d1b8-1"></a><span class="k">\left</span>(- 12 x <span class="k">\cos</span><span class="nb">{</span><span class="k">\left</span>(3 x <span class="k">\right</span>)<span class="nb">}</span> + 2 <span class="k">\left</span>(2 x<span class="nb">^{</span>2<span class="nb">}</span> - 1<span class="k">\right</span>) <span class="k">\sin</span><span class="nb">{</span><span class="k">\left</span>(3 x <span class="k">\right</span>)<span class="nb">}</span> - 9 <span class="k">\sin</span><span class="nb">{</span><span class="k">\left</span>(3 x <span class="k">\right</span>)<span class="nb">}</span><span class="k">\right</span>) e<span class="nb">^{</span>- x<span class="nb">^{</span>2<span class="nb">}}</span>
</pre></div>
<p>Este corresponde con el código que usé arriba para representar la ecuación.</p>
<p>Si quisiéramos el código MathML de esa expresión podríamos usar
el siguiente fragmento de código</p>
<div class="code"><pre class="code python"><a id="rest_code_44f460ec2d0e4d48984d08220cea402a-1" name="rest_code_44f460ec2d0e4d48984d08220cea402a-1" href="posts/tech_writing/tech_writing_math/#rest_code_44f460ec2d0e4d48984d08220cea402a-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">sympy</span><span class="w"> </span><span class="kn">import</span> <span class="o">*</span>
<a id="rest_code_44f460ec2d0e4d48984d08220cea402a-2" name="rest_code_44f460ec2d0e4d48984d08220cea402a-2" href="posts/tech_writing/tech_writing_math/#rest_code_44f460ec2d0e4d48984d08220cea402a-2"></a><span class="n">init_session</span><span class="p">()</span>
<a id="rest_code_44f460ec2d0e4d48984d08220cea402a-3" name="rest_code_44f460ec2d0e4d48984d08220cea402a-3" href="posts/tech_writing/tech_writing_math/#rest_code_44f460ec2d0e4d48984d08220cea402a-3"></a><span class="n">f</span> <span class="o">=</span> <span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="p">)</span>
<a id="rest_code_44f460ec2d0e4d48984d08220cea402a-4" name="rest_code_44f460ec2d0e4d48984d08220cea402a-4" href="posts/tech_writing/tech_writing_math/#rest_code_44f460ec2d0e4d48984d08220cea402a-4"></a><span class="n">fxx</span> <span class="o">=</span> <span class="n">diff</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<a id="rest_code_44f460ec2d0e4d48984d08220cea402a-5" name="rest_code_44f460ec2d0e4d48984d08220cea402a-5" href="posts/tech_writing/tech_writing_math/#rest_code_44f460ec2d0e4d48984d08220cea402a-5"></a><span class="nb">print</span><span class="p">(</span><span class="n">mathml</span><span class="p">(</span><span class="n">fxx</span><span class="p">,</span> <span class="n">printer</span><span class="o">=</span><span class="s2">"presentation"</span><span class="p">))</span>
</pre></div>
<p>observe el argumento opcional <code class="docutils literal">printer = "presentation"</code>. Si queremos agregar
esto a MS Word, por ejemplo, podríamos agregar la salida (que no voy a
mostrar porque es realmente larga) dentro del siguiente código</p>
<div class="code"><pre class="code xml"><a id="rest_code_92f20d54166f42d18c13eccffeffd419-1" name="rest_code_92f20d54166f42d18c13eccffeffd419-1" href="posts/tech_writing/tech_writing_math/#rest_code_92f20d54166f42d18c13eccffeffd419-1"></a><span class="nt">&lt;math</span><span class="w"> </span><span class="na">xmlns =</span><span class="w"> </span><span class="s">"http://www.w3.org/1998/Math/MathML"</span><span class="nt">&gt;</span>
<a id="rest_code_92f20d54166f42d18c13eccffeffd419-2" name="rest_code_92f20d54166f42d18c13eccffeffd419-2" href="posts/tech_writing/tech_writing_math/#rest_code_92f20d54166f42d18c13eccffeffd419-2"></a><span class="nt">&lt;/math&gt;</span>
</pre></div>
<p>Cuando se usa Jupyter Notebook, esto se puede hacer gráficamente con un
clic derecho sobre la expresión. Y se muestra el siguiente menú.</p>
<img alt="/images/jupyter_export_eqs.png" src="../images/jupyter_export_eqs.png"></section><section id="referencias"><h2>Referencias</h2>
<ol class="arabic simple">
<li><p>“How to Insert Equations in Microsoft Word.” WikiHow,
<a class="reference external" href="https://www.wikihow.com/Insert-Equations-in-Microsoft-Word">https://www.wikihow.com/Insert-Equations-in-Microsoft-Word</a>.
Fecha de acceso: Agosto 3, 2020.</p></li>
<li><p>“Copy MathML into Word to Use as Equation.” Stack Overflow,
<a class="reference external" href="https://stackoverflow.com/questions/25430775/copy-mathml-into-word-to-use-as-equation">https://stackoverflow.com/questions/25430775/copy-mathml-into-word-to-use-as-equation</a>.
Fecha de acceso: Agosto 3, 2020.</p></li>
<li><p>“Python - Output Sympy Equation to Word Using Mathml.” Stack Overflow,
<a class="reference external" href="https://stackoverflow.com/questions/40921128/output-sympy-equation-to-word-using-mathml">https://stackoverflow.com/questions/40921128/output-sympy-equation-to-word-using-mathml</a>.
Fecha de acceso: Agosto 3, 2020.</p></li>
<li><p>OERPUB (2016), “Mathconverter”, <a class="reference external" href="https://github.com/oerpub/mathconverter">https://github.com/oerpub/mathconverter</a>,
Fecha de acceso: Agosto 3, 2020.</p></li>
</ol></section>
</div>
    </article>
</div>

        <nav class="postindexpager"><ul class="pager">
<li class="next">
                <a href="index-5.html" rel="next">Publicaciones anteriores</a>
            </li>
        </ul></nav><script>var disqus_shortname="nicoguaro-github";(function(){var a=document.createElement("script");a.async=true;a.src="https://"+disqus_shortname+".disqus.com/count.js";(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(a)}());</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML" integrity="sha384-3lJUsx1TJHt7BA4udB5KPnDrlkO8T6J6v/op7ui0BbCjvZ9WqV4Xm6DTP6kQ/iBH" crossorigin="anonymous"></script><script type="text/x-mathjax-config">
        MathJax.Hub.Config({tex2jax: {inlineMath: [['$latex ','$'], ['\\(','\\)']]}});
        </script><footer id="footer"><p><a href="https://creativecommons.org/licenses/by/4.0/" rel="nofollow">CC BY 4.0</a> © 2025 <a href="mailto:nicoguarin@gmail.com">Nicolás Guarín-Zapata</a> - Powered by <a href="https://getnikola.com" rel="nofollow">Nikola</a> - <a rel="me" href="https://fosstodon.org/@nicoguaro">Mastodon profile</a></p>
            
        </footer>
</div>
    </div>
    <label for="sidebar-checkbox" class="sidebar-toggle"></label>
    
<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-145359674-1', 'auto');
ga('send', 'pageview');
</script><script src="../assets/js/all-nocdn.js"></script><!-- fancy dates --><script>
    moment.locale("es");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates -->
</body>
</html>
