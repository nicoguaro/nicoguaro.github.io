<!DOCTYPE html>
<html prefix="" lang="es">
<head>
<meta charset="utf-8">
<meta name="description" content="Blog y sitio web personales">
<meta name="viewport" content="width=device-width">
<title>Nicolás' blog (publicaciones antiguas, página 5) | Nicolás' blog</title>
<link href="../assets/css/all.css" rel="stylesheet" type="text/css">
<link rel="stylesheet" href="//fonts.googleapis.com/css?family=PT+Serif:400,400italic,700%7CPT+Sans:400">
<link rel="alternate" type="application/rss+xml" title="RSS (en)" href="../rss.xml">
<link rel="alternate" type="application/rss+xml" title="RSS (es)" href="rss.xml">
<link rel="canonical" href="https://nicoguaro.github.io/es/index-5.html">
<link rel="prev" href="." type="text/html">
<link rel="next" href="index-4.html" type="text/html">
<!--[if lt IE 9]><script src="../assets/js/html5.js"></script><![endif]-->
</head>
<body>
    <a href="#content" class="sr-only sr-only-focusable">Ir al contenido principal</a>
    <!-- Target for toggling the sidebar `.sidebar-checkbox` is for regular
            styles, `#sidebar-checkbox` for behavior. -->
    <input type="checkbox" class="sidebar-checkbox" id="sidebar-checkbox"><!-- Toggleable sidebar --><div class="sidebar" id="sidebar">
        <div class="sidebar-item">
            <p>A reserved <a href="https://getnikola.com" target="_blank">Nikola</a> theme that places the utmost gravity on content with a hidden drawer. Made by <a href="https://twitter.com/mdo" target="_blank">@mdo</a> for Jekyll,
            ported to Nikola by <a href="https://twitter.com/ralsina" target="_blank">@ralsina</a>.</p>
        </div>
        
    <nav id="menu" role="navigation" class="sidebar-nav"><a class="sidebar-nav-item" href="../pages/about/">About</a>
        <a class="sidebar-nav-item" href="../index.html">Blog</a>
        <a class="sidebar-nav-item" href="../pages/preprints-archive/">Preprints</a>
        <a class="sidebar-nav-item" href="../pages/links/">Links</a>
        <a class="sidebar-nav-item" href="../archive.html">Archive</a>
        <a class="sidebar-nav-item" href="../categories/">Tags</a>
        <a class="sidebar-nav-item" href="../rss.xml">RSS feed</a>
    
    
    </nav>
</div>

    <!-- Wrap is the content to shift when toggling the sidebar. We wrap the
         content to avoid any CSS collisions with our real content. -->
    <div class="wrap">
      <div class="masthead">
        <div class="container">
          
    <h3 id="brand" class="masthead-title">
      <a href="https://nicoguaro.github.io/es/" title="Nicolás' blog" rel="home">Nicolás' blog</a>
    </h3>

        </div>
      </div>

      <div class="container content" id="content">
        

<div class="posts">
    <article class="post h-entry post-text"><header><h1 class="post-title p-name"><a href="posts/infinite_fdm/" class="u-url">Diferencias finitas en dominios infinitos</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn">Nicolás Guarín-Zapata</span></p>
            <p class="dateline"><a href="posts/infinite_fdm/" rel="bookmark"><time class="post-date published dt-published" datetime="2018-05-17T15:57:00-05:00" title="2018-05-17 15:57">2018-05-17 15:57</time></a></p>
                <p class="commentline">
        
    <a href="posts/infinite_fdm/#disqus_thread" data-disqus-identifier="cache/posts/infinite_fdm.html">Comentarios</a>


        </p>
</div>
    </header><div class="e-content entry-content">
    <div class="section" id="diferencias-finitas-en-dominios-infinitos">
<h2>Diferencias finitas en dominios infinitos</h2>
<p>Gracias a mi amigo, <a class="reference external" href="http://cosmoscalibur.com/">Edward Villegas</a>,
terminé pensando acerca del uso de cambio de variables en la solución
de problemas de valores propios con diferencias finitas.</p>
<div class="section" id="el-problema">
<h3>El problema</h3>
<p>Digamos que queremos resolver una ecuación diferencias sobre un dominio
infinito. Un caso común es la solución de la  <a class="reference external" href="https://en.wikipedia.org/wiki/Schr%C3%B6dinger_equation#Time-independent_equation">ecuación de Schrödinger
independiente del tiempo</a>
sujeta a un potencial <span class="math">\(V(x)\)</span>. Por ejemplo</p>
<div class="math">
\begin{equation*}
-\frac{1}{2}\frac{\mathrm{d}^2}{\mathrm{d}x^2}\psi(x) + V(x) \psi(x) = E\psi(x),\quad \forall x\in (-\infty, \infty),
\end{equation*}
</div>
<p>en donde queremos encontrar las parejas de valores/funciones propias
<span class="math">\((E_n, \psi_n(x))\)</span>.</p>
<p>Lo que normalmente hago cuando uso <a class="reference external" href="https://en.wikipedia.org/wiki/Finite_difference_method">diferencias
finitas</a>
es dividir el dominio regularmente. Donde tomo un dominio lo <em>suficientemente
grande</em>, para que la solución haya decaído a cero. Lo que hago en esta
publicación es usar un cambio de variable para convertir el intervalo
a uno finito y luego dividir el dominio transformado regularmente
en intervalos finitos.</p>
</div>
<div class="section" id="mi-enfoque-usual">
<h3>Mi enfoque usual</h3>
<p>Mi enfoque usual es aproximar la segunda derivada con una <a class="reference external" href="https://en.wikipedia.org/wiki/Finite_difference_coefficient">diferencia
centrada</a>
para el punto <span class="math">\(x_i\)</span>, de la siguiente manera</p>
<div class="math">
\begin{equation*}
\frac{\mathrm{d}^2 f(x)}{\mathrm{d}x^2} \approx \frac{f(x + \Delta x) - 2 f(x_i) + f(x - \Delta x)}{\Delta x^2}\, ,
\end{equation*}
</div>
<p>con <span class="math">\(\Delta x\)</span> la separación entre puntos consecutivos.</p>
<p>Podemos solucionar este problem en Python con el siguiente bloque
de código:</p>
<pre class="code python"><a name="rest_code_3b1c67982a1f425c812c2abb70970f28-1"></a><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<a name="rest_code_3b1c67982a1f425c812c2abb70970f28-2"></a><span class="kn">from</span> <span class="nn">scipy.sparse</span> <span class="kn">import</span> <span class="n">diags</span>
<a name="rest_code_3b1c67982a1f425c812c2abb70970f28-3"></a><span class="kn">from</span> <span class="nn">scipy.sparse.linalg</span> <span class="kn">import</span> <span class="n">eigs</span>
<a name="rest_code_3b1c67982a1f425c812c2abb70970f28-4"></a>
<a name="rest_code_3b1c67982a1f425c812c2abb70970f28-5"></a>
<a name="rest_code_3b1c67982a1f425c812c2abb70970f28-6"></a><span class="k">def</span> <span class="nf">regular_FD</span><span class="p">(</span><span class="n">pot</span><span class="p">,</span> <span class="n">npts</span><span class="o">=</span><span class="mi">101</span><span class="p">,</span> <span class="n">x_max</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">nvals</span><span class="o">=</span><span class="mi">6</span><span class="p">):</span>
<a name="rest_code_3b1c67982a1f425c812c2abb70970f28-7"></a>    <span class="sd">"""</span>
<a name="rest_code_3b1c67982a1f425c812c2abb70970f28-8"></a><span class="sd">    Find eigenvalues/eigenfunctions for Schrodinger</span>
<a name="rest_code_3b1c67982a1f425c812c2abb70970f28-9"></a><span class="sd">    equation for the given potential `pot` using</span>
<a name="rest_code_3b1c67982a1f425c812c2abb70970f28-10"></a><span class="sd">    finite differences</span>
<a name="rest_code_3b1c67982a1f425c812c2abb70970f28-11"></a><span class="sd">    """</span>
<a name="rest_code_3b1c67982a1f425c812c2abb70970f28-12"></a>    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="n">x_max</span><span class="p">,</span> <span class="n">x_max</span><span class="p">,</span> <span class="n">npts</span><span class="p">)</span>
<a name="rest_code_3b1c67982a1f425c812c2abb70970f28-13"></a>    <span class="n">dx</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<a name="rest_code_3b1c67982a1f425c812c2abb70970f28-14"></a>    <span class="n">D2</span> <span class="o">=</span> <span class="n">diags</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="n">npts</span><span class="p">,</span> <span class="n">npts</span><span class="p">))</span><span class="o">/</span><span class="n">dx</span><span class="o">**</span><span class="mi">2</span>
<a name="rest_code_3b1c67982a1f425c812c2abb70970f28-15"></a>    <span class="n">V</span> <span class="o">=</span> <span class="n">diags</span><span class="p">(</span><span class="n">pot</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<a name="rest_code_3b1c67982a1f425c812c2abb70970f28-16"></a>    <span class="n">H</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.5</span><span class="o">*</span><span class="n">D2</span> <span class="o">+</span> <span class="n">V</span>
<a name="rest_code_3b1c67982a1f425c812c2abb70970f28-17"></a>    <span class="n">vals</span><span class="p">,</span> <span class="n">vecs</span> <span class="o">=</span> <span class="n">eigs</span><span class="p">(</span><span class="n">H</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="n">nvals</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s2">"SM"</span><span class="p">)</span>
<a name="rest_code_3b1c67982a1f425c812c2abb70970f28-18"></a>    <span class="k">return</span> <span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">vals</span><span class="p">),</span> <span class="n">vecs</span>
</pre>
<p>Configuremos los gráficos con el siguiente bloque de código.</p>
<pre class="code python"><a name="rest_code_ec8c2f1758d94048abbe6db2ee93d4b8-1"></a><span class="c1"># Jupyter notebook plotting setup &amp; imports</span>
<a name="rest_code_ec8c2f1758d94048abbe6db2ee93d4b8-2"></a><span class="o">%</span><span class="n">matplotlib</span> <span class="n">notebook</span>
<a name="rest_code_ec8c2f1758d94048abbe6db2ee93d4b8-3"></a><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<a name="rest_code_ec8c2f1758d94048abbe6db2ee93d4b8-4"></a>
<a name="rest_code_ec8c2f1758d94048abbe6db2ee93d4b8-5"></a><span class="n">gray</span> <span class="o">=</span> <span class="s1">'#757575'</span>
<a name="rest_code_ec8c2f1758d94048abbe6db2ee93d4b8-6"></a><span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s2">"figure.figsize"</span><span class="p">]</span> <span class="o">=</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">4</span>
<a name="rest_code_ec8c2f1758d94048abbe6db2ee93d4b8-7"></a><span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s2">"mathtext.fontset"</span><span class="p">]</span> <span class="o">=</span> <span class="s2">"cm"</span>
<a name="rest_code_ec8c2f1758d94048abbe6db2ee93d4b8-8"></a><span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s2">"text.color"</span><span class="p">]</span> <span class="o">=</span> <span class="n">gray</span>
<a name="rest_code_ec8c2f1758d94048abbe6db2ee93d4b8-9"></a><span class="n">fontsize</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s2">"font.size"</span><span class="p">]</span> <span class="o">=</span> <span class="mi">12</span>
<a name="rest_code_ec8c2f1758d94048abbe6db2ee93d4b8-10"></a><span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s2">"xtick.color"</span><span class="p">]</span> <span class="o">=</span> <span class="n">gray</span>
<a name="rest_code_ec8c2f1758d94048abbe6db2ee93d4b8-11"></a><span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s2">"ytick.color"</span><span class="p">]</span> <span class="o">=</span> <span class="n">gray</span>
<a name="rest_code_ec8c2f1758d94048abbe6db2ee93d4b8-12"></a><span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s2">"axes.labelcolor"</span><span class="p">]</span> <span class="o">=</span> <span class="n">gray</span>
<a name="rest_code_ec8c2f1758d94048abbe6db2ee93d4b8-13"></a><span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s2">"axes.edgecolor"</span><span class="p">]</span> <span class="o">=</span> <span class="n">gray</span>
<a name="rest_code_ec8c2f1758d94048abbe6db2ee93d4b8-14"></a><span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s2">"axes.spines.right"</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
<a name="rest_code_ec8c2f1758d94048abbe6db2ee93d4b8-15"></a><span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s2">"axes.spines.top"</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
</pre>
<p>Consideremos el <a class="reference external" href="https://en.wikipedia.org/wiki/Quantum_harmonic_oscillator">oscilador armónico
cuántico</a>,
que tiene como valores propios</p>
<div class="math">
\begin{equation*}
E_n = n + \frac{1}{2},\quad \forall n = 0, 1, 2 \cdots
\end{equation*}
</div>
<p>Usando el método de diferencias finitas obtenemos valores que están
muy cerca de los analíticos.</p>
<pre class="code python"><a name="rest_code_93bdc8007c2b4df7864d9f1c339267f4-1"></a><span class="n">x</span><span class="p">,</span> <span class="n">vals</span><span class="p">,</span> <span class="n">vecs</span> <span class="o">=</span> <span class="n">regular_FD</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="n">npts</span><span class="o">=</span><span class="mi">201</span><span class="p">)</span>
<a name="rest_code_93bdc8007c2b4df7864d9f1c339267f4-2"></a><span class="n">vals</span>
</pre>
<p>Con respuesta</p>
<pre class="code python"><a name="rest_code_013414f4046f4bd6815ab52bce328555-1"></a><span class="n">array</span><span class="p">([</span><span class="mf">0.4996873</span> <span class="p">,</span> <span class="mf">1.49843574</span><span class="p">,</span> <span class="mf">2.49593063</span><span class="p">,</span> <span class="mf">3.49216962</span><span class="p">,</span> <span class="mf">4.48715031</span><span class="p">,</span>
<a name="rest_code_013414f4046f4bd6815ab52bce328555-2"></a>       <span class="mf">5.4808703</span> <span class="p">])</span>
</pre>
<p>Los valores analíticos son los siguientes</p>
<pre class="code text"><a name="rest_code_2f19d3bf5ba54e66ad67af394cad5296-1"></a>[0.5, 1.5, 2.5, 3.5, 4.5, 5.5])
</pre>
<p>Si graficamos estos dos conjuntos, obtenemos lo siguiente.</p>
<pre class="code python"><a name="rest_code_19a4ea728cd6469285d095f69038a284-1"></a><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<a name="rest_code_19a4ea728cd6469285d095f69038a284-2"></a><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">anal_vals</span><span class="p">)</span>
<a name="rest_code_19a4ea728cd6469285d095f69038a284-3"></a><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">vals</span><span class="p">,</span> <span class="s2">"o"</span><span class="p">)</span>
<a name="rest_code_19a4ea728cd6469285d095f69038a284-4"></a><span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">"$n$"</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<a name="rest_code_19a4ea728cd6469285d095f69038a284-5"></a><span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">"$E_n$"</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<a name="rest_code_19a4ea728cd6469285d095f69038a284-6"></a><span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s2">"Analytic"</span><span class="p">,</span> <span class="s2">"Finite differences"</span><span class="p">])</span>
<a name="rest_code_19a4ea728cd6469285d095f69038a284-7"></a><span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">();</span>
</pre>
<img alt="Valores propios para la diferencia finita regular." class="align-center" src="../images/infinite_fdm/eigvals_regular.svg" style="width: 600px;"><p>Veamos las funciones propias</p>
<pre class="code python"><a name="rest_code_3aaecb1348cc4fa0976f00c181e3b480-1"></a><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<a name="rest_code_3aaecb1348cc4fa0976f00c181e3b480-2"></a><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">vecs</span><span class="p">[:,</span> <span class="p">:</span><span class="mi">3</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<a name="rest_code_3aaecb1348cc4fa0976f00c181e3b480-3"></a><span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
<a name="rest_code_3aaecb1348cc4fa0976f00c181e3b480-4"></a><span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">"$x$"</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<a name="rest_code_3aaecb1348cc4fa0976f00c181e3b480-5"></a><span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">"$|\psi_n(x)|^2$"</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<a name="rest_code_3aaecb1348cc4fa0976f00c181e3b480-6"></a><span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">([])</span>
<a name="rest_code_3aaecb1348cc4fa0976f00c181e3b480-7"></a><span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">();</span>
</pre>
<img alt="Funciones propias para la diferencia finita regular." class="align-center" src="../images/infinite_fdm/eigvecs_regular.svg" style="width: 600px;"><p>Un inconveniente con este método es el muestreo redundante hacia los extremos
del intervalo mientras submuestreamos el centro.</p>
</div>
<div class="section" id="transformando-el-dominio">
<h3>Transformando el dominio</h3>
<p>Ahora, consideremos el caso en el que transormamos el dominio infinito a uno
finito usando un cambio de variable</p>
<div class="math">
\begin{equation*}
\xi = \xi(x)
\end{equation*}
</div>
<p>con <span class="math">\(\xi \in (-1, 1)\)</span>. Dos opciones para esta transformación son:</p>
<ul class="simple">
<li><p><span class="math">\(\xi = \tanh x\)</span>; y</p></li>
<li><p><span class="math">\(\xi = \frac{2}{\pi} \arctan x\)</span>.</p></li>
</ul>
<p>Haciendo este cambio de variable la ecuación, debemos resolver
la siguiente ecuación</p>
<div class="math">
\begin{equation*}
-\frac{1}{2}\left(\frac{\mathrm{d}\xi}{\mathrm{d}x}\right)^2\frac{\mathrm{d}^2}{\mathrm{d}\xi^2}\psi(\xi) - \frac{1}{2}\frac{\mathrm{d}^2\xi}{\mathrm{d}x^2}\frac{\mathrm{d}}{\mathrm{d}\xi}\psi(\xi) + V(\xi) \psi(\xi) = E\psi(\xi)
\end{equation*}
</div>
<p>El siguiente bloque de código resuelve el problema de valores propios
en el dominio transformado:</p>
<pre class="code python"><a name="rest_code_63dec579e2394d27b6ce2e1389c32f1a-1"></a><span class="k">def</span> <span class="nf">mapped_FD</span><span class="p">(</span><span class="n">pot</span><span class="p">,</span> <span class="n">fun</span><span class="p">,</span> <span class="n">dxdxi</span><span class="p">,</span> <span class="n">dxdxi2</span><span class="p">,</span> <span class="n">npts</span><span class="o">=</span><span class="mi">101</span><span class="p">,</span> <span class="n">nvals</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">xi_tol</span><span class="o">=</span><span class="mf">1e-6</span><span class="p">):</span>
<a name="rest_code_63dec579e2394d27b6ce2e1389c32f1a-2"></a>    <span class="sd">"""</span>
<a name="rest_code_63dec579e2394d27b6ce2e1389c32f1a-3"></a><span class="sd">    Find eigenvalues/eigenfunctions for Schrodinger</span>
<a name="rest_code_63dec579e2394d27b6ce2e1389c32f1a-4"></a><span class="sd">    equation for the given potential `pot` using</span>
<a name="rest_code_63dec579e2394d27b6ce2e1389c32f1a-5"></a><span class="sd">    finite differences over a mapped domain on (-1, 1)</span>
<a name="rest_code_63dec579e2394d27b6ce2e1389c32f1a-6"></a><span class="sd">    """</span>
<a name="rest_code_63dec579e2394d27b6ce2e1389c32f1a-7"></a>    <span class="n">xi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span> <span class="o">+</span> <span class="n">xi_tol</span><span class="p">,</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">xi_tol</span><span class="p">,</span> <span class="n">npts</span><span class="p">)</span>
<a name="rest_code_63dec579e2394d27b6ce2e1389c32f1a-8"></a>    <span class="n">x</span> <span class="o">=</span> <span class="n">fun</span><span class="p">(</span><span class="n">xi</span><span class="p">)</span>
<a name="rest_code_63dec579e2394d27b6ce2e1389c32f1a-9"></a>    <span class="n">dxi</span> <span class="o">=</span> <span class="n">xi</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">xi</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<a name="rest_code_63dec579e2394d27b6ce2e1389c32f1a-10"></a>    <span class="n">D2</span> <span class="o">=</span> <span class="n">diags</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="n">npts</span><span class="p">,</span> <span class="n">npts</span><span class="p">))</span><span class="o">/</span><span class="n">dxi</span><span class="o">**</span><span class="mi">2</span>
<a name="rest_code_63dec579e2394d27b6ce2e1389c32f1a-11"></a>    <span class="n">D1</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">diags</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="n">npts</span><span class="p">,</span> <span class="n">npts</span><span class="p">))</span><span class="o">/</span><span class="n">dxi</span>
<a name="rest_code_63dec579e2394d27b6ce2e1389c32f1a-12"></a>    <span class="n">V</span> <span class="o">=</span> <span class="n">diags</span><span class="p">(</span><span class="n">pot</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<a name="rest_code_63dec579e2394d27b6ce2e1389c32f1a-13"></a>    <span class="n">fac1</span> <span class="o">=</span> <span class="n">diags</span><span class="p">(</span><span class="n">dxdxi</span><span class="p">(</span><span class="n">xi</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<a name="rest_code_63dec579e2394d27b6ce2e1389c32f1a-14"></a>    <span class="n">fac2</span> <span class="o">=</span> <span class="n">diags</span><span class="p">(</span><span class="n">dxdxi2</span><span class="p">(</span><span class="n">xi</span><span class="p">))</span>
<a name="rest_code_63dec579e2394d27b6ce2e1389c32f1a-15"></a>    <span class="n">H</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.5</span><span class="o">*</span><span class="n">fac1</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">D2</span><span class="p">)</span> <span class="o">-</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">fac2</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">D1</span><span class="p">)</span> <span class="o">+</span> <span class="n">V</span>
<a name="rest_code_63dec579e2394d27b6ce2e1389c32f1a-16"></a>    <span class="n">vals</span><span class="p">,</span> <span class="n">vecs</span> <span class="o">=</span> <span class="n">eigs</span><span class="p">(</span><span class="n">H</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="n">nvals</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s2">"SM"</span><span class="p">)</span>
<a name="rest_code_63dec579e2394d27b6ce2e1389c32f1a-17"></a>    <span class="k">return</span> <span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">vals</span><span class="p">),</span> <span class="n">vecs</span>
</pre>
<div class="section" id="primera-transformacion-xi-tanh-x">
<h4>Primera transformación: <span class="math">\(\xi = \tanh(x)\)</span>
</h4>
<p>Consideremos la primera transformación</p>
<div class="math">
\begin{equation*}
\xi = \tanh(x)\, .
\end{equation*}
</div>
<p>En este caso,</p>
<div class="math">
\begin{equation*}
\frac{\mathrm{d}\xi}{\mathrm{d}x} = 1 - \tanh^2(x) = 1 - \xi^2\, ,
\end{equation*}
</div>
<p>y</p>
<div class="math">
\begin{equation*}
\frac{\mathrm{d}^2\xi}{\mathrm{d}x^2} = -2\tanh(x)[1 - \tanh^2(x)] = -2\xi[1 - \xi^2]\, .
\end{equation*}
</div>
<p>Necesitamos definir las funciones</p>
<pre class="code python"><a name="rest_code_1dfe39bb168f46b18b8362a1dcf76714-1"></a><span class="n">pot</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span>
<a name="rest_code_1dfe39bb168f46b18b8362a1dcf76714-2"></a><span class="n">fun</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">xi</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">arctanh</span><span class="p">(</span><span class="n">xi</span><span class="p">)</span>
<a name="rest_code_1dfe39bb168f46b18b8362a1dcf76714-3"></a><span class="n">dxdxi</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">xi</span><span class="p">:</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">xi</span><span class="o">**</span><span class="mi">2</span>
<a name="rest_code_1dfe39bb168f46b18b8362a1dcf76714-4"></a><span class="n">dxdxi2</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">xi</span><span class="p">:</span> <span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">xi</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">xi</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
</pre>
<p>y correr</p>
<pre class="code python"><a name="rest_code_1e24544fe7754b2487672311f46dc25a-1"></a><span class="n">x</span><span class="p">,</span> <span class="n">vals</span><span class="p">,</span> <span class="n">vecs</span> <span class="o">=</span> <span class="n">mapped_FD</span><span class="p">(</span><span class="n">pot</span><span class="p">,</span> <span class="n">fun</span><span class="p">,</span> <span class="n">dxdxi</span><span class="p">,</span> <span class="n">dxdxi2</span><span class="p">,</span> <span class="n">npts</span><span class="o">=</span><span class="mi">201</span><span class="p">)</span>
<a name="rest_code_1e24544fe7754b2487672311f46dc25a-2"></a><span class="n">vals</span>
</pre>
<p>Y obtenemos los siguientes valores propios</p>
<pre class="code python"><a name="rest_code_35f1fe6e4e86480b99c272c06c92becb-1"></a><span class="n">array</span><span class="p">([</span><span class="mf">0.49989989</span><span class="p">,</span> <span class="mf">1.4984226</span> <span class="p">,</span> <span class="mf">2.49003572</span><span class="p">,</span> <span class="mf">3.46934257</span><span class="p">,</span> <span class="mf">4.46935021</span><span class="p">,</span>
<a name="rest_code_35f1fe6e4e86480b99c272c06c92becb-2"></a>       <span class="mf">5.59552989</span><span class="p">])</span>
</pre>
<p>Si los comparamos con los valores analítivos obtenemos lo siguiente.</p>
<pre class="code python"><a name="rest_code_cfeb9bd47f6c48228460584e38e04af5-1"></a><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<a name="rest_code_cfeb9bd47f6c48228460584e38e04af5-2"></a><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">anal_vals</span><span class="p">)</span>
<a name="rest_code_cfeb9bd47f6c48228460584e38e04af5-3"></a><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">vals</span><span class="p">,</span> <span class="s2">"o"</span><span class="p">)</span>
<a name="rest_code_cfeb9bd47f6c48228460584e38e04af5-4"></a><span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s2">"Analytic"</span><span class="p">,</span> <span class="s2">"Finite differences"</span><span class="p">])</span>
<a name="rest_code_cfeb9bd47f6c48228460584e38e04af5-5"></a><span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">"$n$"</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<a name="rest_code_cfeb9bd47f6c48228460584e38e04af5-6"></a><span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">"$E_n$"</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<a name="rest_code_cfeb9bd47f6c48228460584e38e04af5-7"></a><span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">();</span>
</pre>
<img alt="Valores propios para la primera transormación." class="align-center" src="../images/infinite_fdm/eigvals_tanh.svg" style="width: 600px;"><p>Y las siguientes funciones propias.</p>
<pre class="code python"><a name="rest_code_27de76f59087480b9ef23f2d39cf15bf-1"></a><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<a name="rest_code_27de76f59087480b9ef23f2d39cf15bf-2"></a><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">vecs</span><span class="p">[:,</span> <span class="p">:</span><span class="mi">3</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<a name="rest_code_27de76f59087480b9ef23f2d39cf15bf-3"></a><span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
<a name="rest_code_27de76f59087480b9ef23f2d39cf15bf-4"></a><span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">"$x$"</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<a name="rest_code_27de76f59087480b9ef23f2d39cf15bf-5"></a><span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">"$|\psi_n(x)|^2$"</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<a name="rest_code_27de76f59087480b9ef23f2d39cf15bf-6"></a><span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">([])</span>
<a name="rest_code_27de76f59087480b9ef23f2d39cf15bf-7"></a><span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">();</span>
</pre>
<img alt="Funciones propias para la primera transformación." class="align-center" src="../images/infinite_fdm/eigvecs_tanh.svg" style="width: 600px;">
</div>
<div class="section" id="segunda-transformacion-xi-frac-2-pi-mathrm-atan-x">
<h4>Segunda transformación: <span class="math">\(\xi = \frac{2}{\pi}\mathrm{atan}(x)\)</span>
</h4>
<p>Consideremos ahora la segunda transformación</p>
<div class="math">
\begin{equation*}
\xi = \frac{2}{\pi}\mathrm{atan}(x)\, .
\end{equation*}
</div>
<p>En este caso,</p>
<div class="math">
\begin{equation*}
\frac{\mathrm{d}\xi}{\mathrm{d}x} = \frac{2}{\pi(1 + x^2)} = \frac{2 \cos^2\xi}{\pi} \, ,
\end{equation*}
</div>
<p>y</p>
<div class="math">
\begin{equation*}
\frac{\mathrm{d}^2\xi}{\mathrm{d}x^2} = -\frac{4x}{\pi(1 + x^2)^2} = -\frac{4 \cos^4\xi \tan \xi}{\pi}\, .
\end{equation*}
</div>
<p>Una vez más, definimos las funciones</p>
<pre class="code python"><a name="rest_code_7cf6177fd003418b850e17a1c7ee435a-1"></a><span class="n">pot</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span>
<a name="rest_code_7cf6177fd003418b850e17a1c7ee435a-2"></a><span class="n">fun</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">xi</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">tan</span><span class="p">(</span><span class="mf">0.5</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">xi</span><span class="p">)</span>
<a name="rest_code_7cf6177fd003418b850e17a1c7ee435a-3"></a><span class="n">dxdxi</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">xi</span><span class="p">:</span> <span class="mi">2</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mf">0.5</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">xi</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>
<a name="rest_code_7cf6177fd003418b850e17a1c7ee435a-4"></a><span class="n">dxdxi2</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">xi</span><span class="p">:</span> <span class="o">-</span><span class="mi">4</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mf">0.5</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">xi</span><span class="p">)</span><span class="o">**</span><span class="mi">4</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">tan</span><span class="p">(</span><span class="mf">0.5</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">xi</span><span class="p">)</span>
</pre>
<p>y ejecutamos</p>
<pre class="code python"><a name="rest_code_8122cc3327bd4a33a3365e314df6f579-1"></a><span class="n">x</span><span class="p">,</span> <span class="n">vals</span><span class="p">,</span> <span class="n">vecs</span> <span class="o">=</span> <span class="n">mapped_FD</span><span class="p">(</span><span class="n">pot</span><span class="p">,</span> <span class="n">fun</span><span class="p">,</span> <span class="n">dxdxi</span><span class="p">,</span> <span class="n">dxdxi2</span><span class="p">,</span> <span class="n">npts</span><span class="o">=</span><span class="mi">201</span><span class="p">)</span>
<a name="rest_code_8122cc3327bd4a33a3365e314df6f579-2"></a><span class="n">vals</span>
</pre>
<p>para obtener los siguientes valores propios</p>
<pre class="code python"><a name="rest_code_3d073f47a2f9479c9a1fa0dc0fafd204-1"></a><span class="n">array</span><span class="p">([</span><span class="mf">0.49997815</span><span class="p">,</span> <span class="mf">1.49979632</span><span class="p">,</span> <span class="mf">2.49930872</span><span class="p">,</span> <span class="mf">3.49824697</span><span class="p">,</span> <span class="mf">4.49627555</span><span class="p">,</span>
<a name="rest_code_3d073f47a2f9479c9a1fa0dc0fafd204-2"></a>       <span class="mf">5.49295665</span><span class="p">])</span>
</pre>
<p>con la siguiente gráfica</p>
<pre class="code python"><a name="rest_code_60cc8244ec644bfaba9f81ecf9108340-1"></a><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<a name="rest_code_60cc8244ec644bfaba9f81ecf9108340-2"></a><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">anal_vals</span><span class="p">)</span>
<a name="rest_code_60cc8244ec644bfaba9f81ecf9108340-3"></a><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">vals</span><span class="p">,</span> <span class="s2">"o"</span><span class="p">)</span>
<a name="rest_code_60cc8244ec644bfaba9f81ecf9108340-4"></a><span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s2">"Analytic"</span><span class="p">,</span> <span class="s2">"Finite differences"</span><span class="p">])</span>
<a name="rest_code_60cc8244ec644bfaba9f81ecf9108340-5"></a><span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">"$n$"</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<a name="rest_code_60cc8244ec644bfaba9f81ecf9108340-6"></a><span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">"$E_n$"</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<a name="rest_code_60cc8244ec644bfaba9f81ecf9108340-7"></a><span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">();</span>
</pre>
<img alt="Valores propios para la segunda transformación." class="align-center" src="../images/infinite_fdm/eigvals_atan.svg" style="width: 600px;"><p>y las siguientes funciones propias.</p>
<pre class="code python"><a name="rest_code_7598f0f3f2b24dd7ba138904645ce1cb-1"></a><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<a name="rest_code_7598f0f3f2b24dd7ba138904645ce1cb-2"></a><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">vecs</span><span class="p">[:,</span> <span class="p">:</span><span class="mi">3</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<a name="rest_code_7598f0f3f2b24dd7ba138904645ce1cb-3"></a><span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">"$x$"</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<a name="rest_code_7598f0f3f2b24dd7ba138904645ce1cb-4"></a><span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">"$|\psi|^2$"</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<a name="rest_code_7598f0f3f2b24dd7ba138904645ce1cb-5"></a><span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
<a name="rest_code_7598f0f3f2b24dd7ba138904645ce1cb-6"></a><span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">"$x$"</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<a name="rest_code_7598f0f3f2b24dd7ba138904645ce1cb-7"></a><span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">"$|\psi_n(x)|^2$"</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<a name="rest_code_7598f0f3f2b24dd7ba138904645ce1cb-8"></a><span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">([])</span>
<a name="rest_code_7598f0f3f2b24dd7ba138904645ce1cb-9"></a><span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">();</span>
</pre>
<img alt="Funciones propias para la segunda transformación." class="align-center" src="../images/infinite_fdm/eigvecs_atan.svg" style="width: 600px;">
</div>
</div>
<div class="section" id="conclusion">
<h3>Conclusión</h3>
<p>El método funciona bien, aunque la ecuación diferencial es más
complicada por el cambio de variable. Aunque existen métodos más
elegantes para considerar dominiso infinitos, este es lo suficientemente
simple para hacerse en 10 líneas de código.</p>
<p>Podemos ver que la transforamción <span class="math">\(\xi = \mathrm{atan}(x)\)</span>, cubre
mejor el dominio que <span class="math">\(\xi = \tanh(x)\)</span>, donde la mayoría de los puntos
están ubicados en el centro del intervalo.</p>
<p>¡Gracias por leer!</p>
<small>
  <i>
    Esta publicación se escribió en el Jupyter notebook. Puedes
    <a href="downloads/notebooks/finite_diff_map.ipynb">descargar</a>
    este notebook, o ver una versión estática en
    <a href="http://nbviewer.jupyter.org/url/nicoguaro.github.io/downloads/notebooks/finite_diff_map.ipynb">nbviewer</a>.
  <i>
</i></i></small>
</div>
</div>
    </div>
    </article><article class="post h-entry post-text"><header><h1 class="post-title p-name"><a href="posts/cyclic_colormaps/" class="u-url">Comparación de mapas de colores cíclicos</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn">Nicolás Guarín-Zapata</span></p>
            <p class="dateline"><a href="posts/cyclic_colormaps/" rel="bookmark"><time class="post-date published dt-published" datetime="2018-01-02T18:55:41-05:00" title="2018-01-02 18:55">2018-01-02 18:55</time></a></p>
                <p class="commentline">
        
    <a href="posts/cyclic_colormaps/#disqus_thread" data-disqus-identifier="cache/posts/cyclic_colormaps.html">Comentarios</a>


        </p>
</div>
    </header><div class="e-content entry-content">
    <div>
<p>Empecé esta publicación buscando implementaciones de
<a class="reference external" href="https://en.wikipedia.org/wiki/Diffusion_map">mapas de difusión</a>
en Python, que no pude encontrar. Me puse entonces a seguir un
<a class="reference external" href="http://scikit-learn.org/stable/auto_examples/manifold/plot_compare_methods.html#sphx-glr-auto-examples-manifold-plot-compare-methods-py">ejemplo</a>
sobre <a class="reference external" href="https://en.wikipedia.org/wiki/Nonlinear_dimensionality_reduction">aprendizaje de variedades</a>
de <a class="reference external" href="https://jakevdp.github.io/">Jake Vanderplas</a> en un <a class="reference external" href="https://commons.wikimedia.org/wiki/File:Diffusion_map_of_a_torodial_helix.jpg">conjunto de datos diferente</a>.
Y funcionó bien</p>
<img alt="/images/manifold_learning_toroidal_helix.svg" src="../images/manifold_learning_toroidal_helix.svg"><p>pero el mapa de color es <a class="reference external" href="https://matplotlib.org/examples/color/colormaps_reference.html">"Spectral"</a>,
que es divergente. Esto me puso a pensar acerca de usar un mapa de
colores cícliclo, y terminé en esta pregunta de
<a class="reference external" href="https://stackoverflow.com/q/23712207/3358223">StackOverflow</a>.
Y decidí comparar algunos mapas de colores cíclicos.</p>
<p>Elegí mapas de colores de diferentes fuentes</p>
<ul class="simple">
<li>
<p><a class="reference external" href="https://matplotlib.org/cmocean/">cmocean</a>:</p>
<ul>
<li><p>phase</p></li>
</ul>
</li>
<li>
<p><a class="reference external" href="http://paraview.org/">Paraview</a>:</p>
<ul>
<li><p>hue_L60</p></li>
<li><p>erdc_iceFire</p></li>
<li><p>nic_Edge</p></li>
</ul>
</li>
<li>
<p><a class="reference external" href="https://github.com/bokeh/colorcet">Colorcet</a>:</p>
<ul>
<li><p>colorwheel</p></li>
<li><p>cyclic_mrybm_35_75_c68</p></li>
<li><p>cyclic_mygbm_30_95_c78</p></li>
</ul>
</li>
</ul>
<p>y, obviamente, <code class="docutils literal">hsv</code>. Los mapas de colores en formato de texto
plano se pueden descargar <a class="reference external" href="../downloads/cyclic_colormaps.zip">aquí</a>.</p>
<div class="section" id="comparacion">
<h2>Comparación</h2>
<p>Para todos los ejemplos se importaron los siguientes módulos:</p>
<pre class="code python"><a name="rest_code_33c1a3abd74f43ef888cced59e30ff34-1"></a><span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">division</span><span class="p">,</span> <span class="n">print_function</span>
<a name="rest_code_33c1a3abd74f43ef888cced59e30ff34-2"></a><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<a name="rest_code_33c1a3abd74f43ef888cced59e30ff34-3"></a><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<a name="rest_code_33c1a3abd74f43ef888cced59e30ff34-4"></a><span class="kn">from</span> <span class="nn">matplotlib.colors</span> <span class="kn">import</span> <span class="n">LinearSegmentedColormap</span>
<a name="rest_code_33c1a3abd74f43ef888cced59e30ff34-5"></a><span class="kn">from</span> <span class="nn">colorspacious</span> <span class="kn">import</span> <span class="n">cspace_convert</span>
</pre>
<div class="section" id="imagen-de-prueba">
<h3>Imagen de prueba</h3>
<p>Peter Kovesi propuso una manera de comparar mapas de colores
cíclicos en un
<a class="reference external" href="http://peterkovesi.com/projects/colourmaps/colourmaptestimage.html">artículo</a>
en 2015. Consta de una rampa en espiral con ondulaciones. En
coordenadas polares es</p>
<div class="math">
\begin{equation*}
c = (A \rho^p \sin(n \theta) + \theta)\, \mathrm{mod}\, 2\pi
\end{equation*}
</div>
<p>con <span class="math">\(A\)</span> la amplitud de la oscilación, <span class="math">\(\rho\)</span>
el radio normalizado en [0, 1], <span class="math">\(p\)</span> un número positivo,
y <span class="math">\(n\)</span> el número de ciclos.</p>
<p>Y la siguiente función crea la rejilla en Python.</p>
<pre class="code python"><a name="rest_code_6589702a3bae4e81b8d8c41d59a6310c-1"></a><span class="k">def</span> <span class="nf">circle_sine_ramp</span><span class="p">(</span><span class="n">r_max</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">r_min</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">amp</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">5</span><span class="p">,</span> <span class="n">cycles</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span>
<a name="rest_code_6589702a3bae4e81b8d8c41d59a6310c-2"></a>                     <span class="n">power</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">nr</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">ntheta</span><span class="o">=</span><span class="mi">1025</span><span class="p">):</span>
<a name="rest_code_6589702a3bae4e81b8d8c41d59a6310c-3"></a><span class="n">r</span><span class="p">,</span> <span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mgrid</span><span class="p">[</span><span class="n">r_min</span><span class="p">:</span><span class="n">r_max</span><span class="p">:</span><span class="n">nr</span><span class="o">*</span><span class="mi">1</span><span class="n">j</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">:</span><span class="n">ntheta</span><span class="o">*</span><span class="mi">1</span><span class="n">j</span><span class="p">]</span>
<a name="rest_code_6589702a3bae4e81b8d8c41d59a6310c-4"></a><span class="n">r_norm</span> <span class="o">=</span> <span class="p">(</span><span class="n">r</span> <span class="o">-</span> <span class="n">r_min</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">r_max</span> <span class="o">-</span> <span class="n">r_min</span><span class="p">)</span>
<a name="rest_code_6589702a3bae4e81b8d8c41d59a6310c-5"></a><span class="n">vals</span> <span class="o">=</span> <span class="n">amp</span> <span class="o">*</span> <span class="n">r_norm</span><span class="o">**</span><span class="n">power</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">cycles</span><span class="o">*</span><span class="n">t</span><span class="p">)</span> <span class="o">+</span> <span class="n">t</span>
<a name="rest_code_6589702a3bae4e81b8d8c41d59a6310c-6"></a><span class="n">vals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mod</span><span class="p">(</span><span class="n">vals</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span>
<a name="rest_code_6589702a3bae4e81b8d8c41d59a6310c-7"></a><span class="k">return</span> <span class="n">t</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">vals</span>
</pre>
<p>El resultado es el siguiente</p>
<img alt="/images/sine_helix_cyclic_cmap.png" src="../images/sine_helix_cyclic_cmap.png">
</div>
<div class="section" id="prueba-para-daltonismo">
<h3>Prueba para daltonismo</h3>
<pre class="code python"><a name="rest_code_277a32fd99914932bd2562a842b7075f-1"></a><span class="n">t</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">vals</span> <span class="o">=</span> <span class="n">circle_sine_ramp</span><span class="p">(</span><span class="n">cycles</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<a name="rest_code_277a32fd99914932bd2562a842b7075f-2"></a><span class="n">cmaps</span> <span class="o">=</span> <span class="p">[</span><span class="s2">"hsv"</span><span class="p">,</span>
<a name="rest_code_277a32fd99914932bd2562a842b7075f-3"></a>         <span class="s2">"cmocean_phase"</span><span class="p">,</span>
<a name="rest_code_277a32fd99914932bd2562a842b7075f-4"></a>         <span class="s2">"hue_L60"</span><span class="p">,</span>
<a name="rest_code_277a32fd99914932bd2562a842b7075f-5"></a>         <span class="s2">"erdc_iceFire"</span><span class="p">,</span>
<a name="rest_code_277a32fd99914932bd2562a842b7075f-6"></a>         <span class="s2">"nic_Edge"</span><span class="p">,</span>
<a name="rest_code_277a32fd99914932bd2562a842b7075f-7"></a>         <span class="s2">"colorwheel"</span><span class="p">,</span>
<a name="rest_code_277a32fd99914932bd2562a842b7075f-8"></a>         <span class="s2">"cyclic_mrybm"</span><span class="p">,</span>
<a name="rest_code_277a32fd99914932bd2562a842b7075f-9"></a>         <span class="s2">"cyclic_mygbm"</span><span class="p">]</span>
<a name="rest_code_277a32fd99914932bd2562a842b7075f-10"></a><span class="n">severity</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">50</span><span class="p">]</span>
<a name="rest_code_277a32fd99914932bd2562a842b7075f-11"></a><span class="k">for</span> <span class="n">colormap</span> <span class="ow">in</span> <span class="n">cmaps</span><span class="p">:</span>
<a name="rest_code_277a32fd99914932bd2562a842b7075f-12"></a>    <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="n">colormap</span> <span class="o">+</span> <span class="s2">".txt"</span><span class="p">)</span>
<a name="rest_code_277a32fd99914932bd2562a842b7075f-13"></a>    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<a name="rest_code_277a32fd99914932bd2562a842b7075f-14"></a>    <span class="k">for</span> <span class="n">cont</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
<a name="rest_code_277a32fd99914932bd2562a842b7075f-15"></a>        <span class="n">cvd_space</span> <span class="o">=</span> <span class="p">{</span><span class="s2">"name"</span><span class="p">:</span> <span class="s2">"sRGB1+CVD"</span><span class="p">,</span>
<a name="rest_code_277a32fd99914932bd2562a842b7075f-16"></a>             <span class="s2">"cvd_type"</span><span class="p">:</span> <span class="n">cvd_type</span><span class="p">[</span><span class="n">cont</span><span class="p">],</span>
<a name="rest_code_277a32fd99914932bd2562a842b7075f-17"></a>             <span class="s2">"severity"</span><span class="p">:</span> <span class="n">severity</span><span class="p">[</span><span class="n">cont</span><span class="p">]}</span>
<a name="rest_code_277a32fd99914932bd2562a842b7075f-18"></a>        <span class="n">data2</span> <span class="o">=</span> <span class="n">cspace_convert</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">cvd_space</span><span class="p">,</span> <span class="s2">"sRGB1"</span><span class="p">)</span>
<a name="rest_code_277a32fd99914932bd2562a842b7075f-19"></a>        <span class="n">data2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">data2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<a name="rest_code_277a32fd99914932bd2562a842b7075f-20"></a>        <span class="n">cmap</span> <span class="o">=</span> <span class="n">LinearSegmentedColormap</span><span class="o">.</span><span class="n">from_list</span><span class="p">(</span><span class="s1">'my_colormap'</span><span class="p">,</span> <span class="n">data2</span><span class="p">)</span>
<a name="rest_code_277a32fd99914932bd2562a842b7075f-21"></a>        <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">cont</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="s2">"polar"</span><span class="p">)</span>
<a name="rest_code_277a32fd99914932bd2562a842b7075f-22"></a>        <span class="n">ax</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">vals</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">)</span>
<a name="rest_code_277a32fd99914932bd2562a842b7075f-23"></a>        <span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">([])</span>
<a name="rest_code_277a32fd99914932bd2562a842b7075f-24"></a>        <span class="n">ax</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([])</span>
<a name="rest_code_277a32fd99914932bd2562a842b7075f-25"></a>    <span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="n">colormap</span><span class="p">)</span>
<a name="rest_code_277a32fd99914932bd2562a842b7075f-26"></a>    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<a name="rest_code_277a32fd99914932bd2562a842b7075f-27"></a>    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">colormap</span> <span class="o">+</span> <span class="s2">".png"</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>
</pre>
<div class="figure align-center">
<img alt="/images/hsv_eval.png" src="../images/hsv_eval.png"><p class="caption">Comparación de <code class="docutils literal">hsv</code> para diferentes deficiencias visuales
del color.</p>
</div>
<div class="figure align-center">
<img alt="/images/cmocean_phase_eval.png" src="../images/cmocean_phase_eval.png"><p class="caption">Comparación de <code class="docutils literal">Phase</code> para diferentes deficiencias visuales
del color.</p>
</div>
<div class="figure align-center">
<img alt="/images/hue_L60_eval.png" src="../images/hue_L60_eval.png"><p class="caption">Comparación de <code class="docutils literal">hue_L60</code> para diferentes deficiencias visuales
del color.</p>
</div>
<div class="figure align-center">
<img alt="/images/erdc_iceFire_eval.png" src="../images/erdc_iceFire_eval.png"><p class="caption">Comparación de <code class="docutils literal">erdc_iceFire</code> para diferentes deficiencias visuales
del color.</p>
</div>
<div class="figure align-center">
<img alt="/images/nic_Edge_eval.png" src="../images/nic_Edge_eval.png"><p class="caption">Comparación de <code class="docutils literal">nic_Edge</code> para diferentes deficiencias visuales
del color.</p>
</div>
<div class="figure align-center">
<img alt="/images/colorwheel_eval.png" src="../images/colorwheel_eval.png"><p class="caption">Comparación de <code class="docutils literal">Colorwheel</code> para diferentes deficiencias visuales
del color.</p>
</div>
<div class="figure align-center">
<img alt="/images/cyclic_mrybm_eval.png" src="../images/cyclic_mrybm_eval.png"><p class="caption">Comparación de <code class="docutils literal">Cyclic_mrybm</code> para diferentes deficiencias visuales
del color.</p>
</div>
<div class="figure align-center">
<img alt="/images/cyclic_mygbm_eval.png" src="../images/cyclic_mygbm_eval.png"><p class="caption">Comparación de <code class="docutils literal">Cyclic_mygbm</code> para diferentes deficiencias visuales
del color.</p>
</div>
</div>
</div>
<div class="section" id="mapas-de-colores-ciclicos-generados-aleatoriamente">
<h2>Mapas de colores cíclicos generados aleatoriamente</h2>
<p>¿Qué pasa si generamos mapas de colores cíclicos aleatoriamente?
¿Cómo lucirían?</p>
<p>A continuación están las piezas de código y mapas de colores
resultantes.</p>
<pre class="code python"><a name="rest_code_5892f51906b943ea8dc4c25f0173608b-1"></a><span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">division</span><span class="p">,</span> <span class="n">print_function</span>
<a name="rest_code_5892f51906b943ea8dc4c25f0173608b-2"></a><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<a name="rest_code_5892f51906b943ea8dc4c25f0173608b-3"></a><span class="kn">from</span> <span class="nn">mpl_toolkits.mplot3d</span> <span class="kn">import</span> <span class="n">Axes3D</span>
<a name="rest_code_5892f51906b943ea8dc4c25f0173608b-4"></a><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<a name="rest_code_5892f51906b943ea8dc4c25f0173608b-5"></a><span class="kn">from</span> <span class="nn">matplotlib.colors</span> <span class="kn">import</span> <span class="n">LinearSegmentedColormap</span>
<a name="rest_code_5892f51906b943ea8dc4c25f0173608b-6"></a>
<a name="rest_code_5892f51906b943ea8dc4c25f0173608b-7"></a>
<a name="rest_code_5892f51906b943ea8dc4c25f0173608b-8"></a><span class="c1"># Next line to silence pyflakes. This import is needed.</span>
<a name="rest_code_5892f51906b943ea8dc4c25f0173608b-9"></a><span class="n">Axes3D</span>
<a name="rest_code_5892f51906b943ea8dc4c25f0173608b-10"></a>
<a name="rest_code_5892f51906b943ea8dc4c25f0173608b-11"></a><span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="s2">"all"</span><span class="p">)</span>
<a name="rest_code_5892f51906b943ea8dc4c25f0173608b-12"></a><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<a name="rest_code_5892f51906b943ea8dc4c25f0173608b-13"></a><span class="n">fig2</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<a name="rest_code_5892f51906b943ea8dc4c25f0173608b-14"></a><span class="n">nx</span> <span class="o">=</span> <span class="mi">4</span>
<a name="rest_code_5892f51906b943ea8dc4c25f0173608b-15"></a><span class="n">ny</span> <span class="o">=</span> <span class="mi">4</span>
<a name="rest_code_5892f51906b943ea8dc4c25f0173608b-16"></a><span class="n">azimuths</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">361</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<a name="rest_code_5892f51906b943ea8dc4c25f0173608b-17"></a><span class="n">zeniths</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mi">70</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<a name="rest_code_5892f51906b943ea8dc4c25f0173608b-18"></a><span class="n">values</span> <span class="o">=</span> <span class="n">azimuths</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">30</span><span class="p">,</span> <span class="mi">361</span><span class="p">))</span>
<a name="rest_code_5892f51906b943ea8dc4c25f0173608b-19"></a><span class="k">for</span> <span class="n">cont</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nx</span> <span class="o">*</span> <span class="n">ny</span><span class="p">):</span>
<a name="rest_code_5892f51906b943ea8dc4c25f0173608b-20"></a>    <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="n">cont</span><span class="p">)</span>
<a name="rest_code_5892f51906b943ea8dc4c25f0173608b-21"></a>    <span class="n">rad</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)</span>
<a name="rest_code_5892f51906b943ea8dc4c25f0173608b-22"></a>    <span class="n">center</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="n">rad</span><span class="p">,</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">rad</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<a name="rest_code_5892f51906b943ea8dc4c25f0173608b-23"></a>    <span class="n">mat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<a name="rest_code_5892f51906b943ea8dc4c25f0173608b-24"></a>    <span class="n">rot_mat</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">qr</span><span class="p">(</span><span class="n">mat</span><span class="p">)</span>
<a name="rest_code_5892f51906b943ea8dc4c25f0173608b-25"></a>    <span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mi">256</span><span class="p">)</span>
<a name="rest_code_5892f51906b943ea8dc4c25f0173608b-26"></a>    <span class="n">x</span> <span class="o">=</span> <span class="n">rad</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
<a name="rest_code_5892f51906b943ea8dc4c25f0173608b-27"></a>    <span class="n">y</span> <span class="o">=</span> <span class="n">rad</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
<a name="rest_code_5892f51906b943ea8dc4c25f0173608b-28"></a>    <span class="n">z</span> <span class="o">=</span> <span class="mf">0.0</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
<a name="rest_code_5892f51906b943ea8dc4c25f0173608b-29"></a>    <span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">((</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">))</span>
<a name="rest_code_5892f51906b943ea8dc4c25f0173608b-30"></a>    <span class="n">X</span> <span class="o">=</span> <span class="n">rot_mat</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">X</span><span class="p">)</span> <span class="o">+</span> <span class="n">center</span>
<a name="rest_code_5892f51906b943ea8dc4c25f0173608b-31"></a>
<a name="rest_code_5892f51906b943ea8dc4c25f0173608b-32"></a>    <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">ny</span><span class="p">,</span> <span class="n">nx</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">cont</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="s1">'polar'</span><span class="p">)</span>
<a name="rest_code_5892f51906b943ea8dc4c25f0173608b-33"></a>    <span class="n">cmap</span> <span class="o">=</span> <span class="n">LinearSegmentedColormap</span><span class="o">.</span><span class="n">from_list</span><span class="p">(</span><span class="s1">'my_colormap'</span><span class="p">,</span> <span class="n">X</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
<a name="rest_code_5892f51906b943ea8dc4c25f0173608b-34"></a>    <span class="n">ax</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span><span class="n">azimuths</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mf">180.0</span><span class="p">,</span> <span class="n">zeniths</span><span class="p">,</span> <span class="n">values</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">)</span>
<a name="rest_code_5892f51906b943ea8dc4c25f0173608b-35"></a>    <span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">([])</span>
<a name="rest_code_5892f51906b943ea8dc4c25f0173608b-36"></a>    <span class="n">ax</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([])</span>
<a name="rest_code_5892f51906b943ea8dc4c25f0173608b-37"></a>
<a name="rest_code_5892f51906b943ea8dc4c25f0173608b-38"></a>    <span class="n">ax2</span> <span class="o">=</span> <span class="n">fig2</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">ny</span><span class="p">,</span> <span class="n">nx</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">cont</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="s1">'3d'</span><span class="p">)</span>
<a name="rest_code_5892f51906b943ea8dc4c25f0173608b-39"></a>    <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:],</span> <span class="n">X</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:],</span> <span class="n">X</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="p">:])</span>
<a name="rest_code_5892f51906b943ea8dc4c25f0173608b-40"></a>    <span class="n">ax2</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<a name="rest_code_5892f51906b943ea8dc4c25f0173608b-41"></a>    <span class="n">ax2</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<a name="rest_code_5892f51906b943ea8dc4c25f0173608b-42"></a>    <span class="n">ax2</span><span class="o">.</span><span class="n">set_zlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<a name="rest_code_5892f51906b943ea8dc4c25f0173608b-43"></a>    <span class="n">ax2</span><span class="o">.</span><span class="n">view_init</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="o">-</span><span class="mi">60</span><span class="p">)</span>
<a name="rest_code_5892f51906b943ea8dc4c25f0173608b-44"></a>    <span class="n">ax2</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">])</span>
<a name="rest_code_5892f51906b943ea8dc4c25f0173608b-45"></a>    <span class="n">ax2</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">])</span>
<a name="rest_code_5892f51906b943ea8dc4c25f0173608b-46"></a>    <span class="n">ax2</span><span class="o">.</span><span class="n">set_zticks</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">])</span>
<a name="rest_code_5892f51906b943ea8dc4c25f0173608b-47"></a>    <span class="n">ax2</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">([])</span>
<a name="rest_code_5892f51906b943ea8dc4c25f0173608b-48"></a>    <span class="n">ax2</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">([])</span>
<a name="rest_code_5892f51906b943ea8dc4c25f0173608b-49"></a>    <span class="n">ax2</span><span class="o">.</span><span class="n">set_zticklabels</span><span class="p">([])</span>
<a name="rest_code_5892f51906b943ea8dc4c25f0173608b-50"></a>
<a name="rest_code_5892f51906b943ea8dc4c25f0173608b-51"></a>
<a name="rest_code_5892f51906b943ea8dc4c25f0173608b-52"></a><span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">"random_cmaps.png"</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span> <span class="n">transparent</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a name="rest_code_5892f51906b943ea8dc4c25f0173608b-53"></a><span class="n">fig2</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">"random_cmaps_traj.svg"</span><span class="p">,</span> <span class="n">transparent</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre>
<div class="figure align-center">
<img alt="/images/random_cmaps.png" src="../images/random_cmaps.png"><p class="caption">16 mapas de colores generados aleatoriamente.</p>
</div>
<div class="figure align-center">
<img alt="/images/random_cmaps_traj.svg" src="../images/random_cmaps_traj.svg"><p class="caption">Trayectorias en espacio RGB para los mapas de colores generados
aleatoriamente.</p>
</div>
<p>Una idea interesante sería tomar estos mapas de colores y optimizar
algunos parámetros perceptuales como luminosidad para obtener
mapas de colores útiles.</p>
</div>
<div class="section" id="conclusiones">
<h2>Conclusiones</h2>
<p>Probablemente, yo usaría <code class="docutils literal">phase</code>, <code class="docutils literal">colorwheel</code>, o <code class="docutils literal">mrybm</code> en
el futuro.</p>
<div class="figure align-center">
<img alt="/images/toroidal_helix_phase.svg" src="../images/toroidal_helix_phase.svg"><p class="caption">Imagen inicial usando <code class="docutils literal">phase</code>.</p>
</div>
<div class="figure align-center">
<img alt="/images/toroidal_helix_colorwheel.svg" src="../images/toroidal_helix_colorwheel.svg"><p class="caption">Imagen inicial usando <code class="docutils literal">colorwheel</code>.</p>
</div>
<div class="figure align-center">
<img alt="/images/toroidal_helix_mrybm.svg" src="../images/toroidal_helix_mrybm.svg"><p class="caption">Imagen inicial usando <code class="docutils literal">mrybm</code>.</p>
</div>
</div>
<div class="section" id="referencias">
<h2>Referencias</h2>
<ol class="arabic simple">
<li><p>Peter Kovesi. Good Colour Maps: How to Design Them.
arXiv:1509.03700 [cs.GR] 2015</p></li>
</ol>
</div>
</div>
    </div>
    </article><article class="post h-entry post-text"><header><h1 class="post-title p-name"><a href="posts/putnam_prob/" class="u-url">Probabilidad de que un tetraedro en una esfera contenga su centro</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn">Nicolás Guarín-Zapata</span></p>
            <p class="dateline"><a href="posts/putnam_prob/" rel="bookmark"><time class="post-date published dt-published" datetime="2017-12-13T15:24:52-05:00" title="2017-12-13 15:24">2017-12-13 15:24</time></a></p>
                <p class="commentline">
        
    <a href="posts/putnam_prob/#disqus_thread" data-disqus-identifier="cache/posts/putnam_prob.html">Comentarios</a>


        </p>
</div>
    </header><div class="e-content entry-content">
    <div>
<p>Me interesé en este problema viendo el canal de YouTube
<a class="reference external" href="https://www.youtube.com/channel/UCYO_jab_esuFRV4b17AJtAw">3Blue1Brown</a>,
de Grant Sanderson, donde explica una forma de abordar el problema que
es simplemente ... elegante.</p>
<p>Este canal me gusta mucho. Por ejemplo, su acercamiento al álgebra
lineal en
<a class="reference external" href="https://www.youtube.com/watch?v=kjBOesZCoqc&amp;list=PLZHQObOWTQDPD3MizzM2xVFitgF8hE_ab">La esencia del álgebra lineal</a>
es realmente bueno.</p>
<div class="section" id="el-problema">
<h2>El problema</h2>
<p>Entremeos en materia. El problema fue originalmente parte de la 53
<a class="reference external" href="http://kskedlaya.org/putnam-archive/1992.pdf">Competencia de Putnam en 1992</a>.
El problema está planteado de la siguiente manera.</p>
<blockquote>
<p>Se eligen cuatro puntos al azar en la superficie de un
esfera. ¿Cuál es la probabilidad de que el centro de la
la esfera se encuentra dentro del tetraedro cuyos vértices están en
los cuatro puntos? (Se entiende que cada punto es
elegido de forma dependiente en relación con una distribución
uniforme en la esfera.)</p>
</blockquote>
<p>Como se muestra en el video mencionado, la probabilidad es
<span class="math">\(1/8\)</span>. Vamos a escribir un algoritmo para obtener este resultado,
aproximadamente, al menos.</p>
</div>
<div class="section" id="el-enfoque-propuesto">
<h2>El enfoque propuesto.</h2>
<p>El enfoque que vamos a utilizar es bastante sencillo. Vamps a obtener
una muestra de conjuntos aleatorios (independientes), con cuatro puntos
cada uno, y vamos a verificar cuántos satisfacen la condición de estar
adentro del tetraedro con los puntos como vértices.</p>
<p>Para que este enfoque funcione, necesitamos dos cosas:</p>
<ol class="arabic simple">
<li><p>Una forma de generar números aleatorios distribuidos uniformemente.
Esto ya lo tenemos en <code class="docutils literal">numpy.random.uniform</code>, por lo que no
necesitamos hacer mucho al respecto.</p></li>
<li><p>Una forma de verificar si un punto está dentro de un tetraedro.</p></li>
</ol>
<div class="section" id="verificar-que-un-punto-esta-dentro-de-un-tetraedro">
<h3>Verificar que un punto está dentro de un tetraedro</h3>
<p>Para encontrar si un punto está dentro de un tetraedro, podríamos calcular
sus <a class="reference external" href="https://en.wikipedia.org/wiki/Barycentric_coordinate_system">coordenadas barcéntricas</a>
y verificar que todas tienen el mismo signo. Equivalentemente,
como se propone <a class="reference external" href="http://steve.hollasch.net/cgindex/geometry/ptintet.html">aquí</a>,
podemos comprobar que los determinantes de las matrices</p>
<div class="math">
\begin{equation*}
M_0 =
\begin{bmatrix}
x_0 &amp;y_0 &amp;z_0 &amp;1\\
x_1 &amp;y_1 &amp;z_1 &amp;1\\
x_2 &amp;y_2 &amp;z_2 &amp;1\\
x_3 &amp;y_3 &amp;z_3 &amp;1
\end{bmatrix}\, ,
\end{equation*}
</div>
<div class="math">
\begin{equation*}
M_1 =
\begin{bmatrix}
x &amp;y &amp;z &amp;1\\
x_1 &amp;y_1 &amp;z_1 &amp;1\\
x_2 &amp;y_2 &amp;z_2 &amp;1\\
x_3 &amp;y_3 &amp;z_3 &amp;1
\end{bmatrix}\, ,
\end{equation*}
</div>
<div class="math">
\begin{equation*}
M_2 =
\begin{bmatrix}
x_0 &amp;y_0 &amp;z_0 &amp;1\\
x &amp;y &amp; &amp;1\\
x_2 &amp;y_2 &amp;z_2 &amp;1\\
x_3 &amp;y_3 &amp;z_3 &amp;1
\end{bmatrix}\, ,
\end{equation*}
</div>
<div class="math">
\begin{equation*}
M_3 =
\begin{bmatrix}
x_0 &amp;y_0 &amp;z_0 &amp;1\\
x_1 &amp;y_1 &amp;z_1 &amp;1\\
x &amp;y &amp;z &amp;1\\
x_3 &amp;y_3 &amp;z_3 &amp;1
\end{bmatrix}\, ,
\end{equation*}
</div>
<div class="math">
\begin{equation*}
M_4 =
\begin{bmatrix}
x_0 &amp;y_0 &amp;z_0 &amp;1\\
x_1 &amp;y_1 &amp;z_1 &amp;1\\
x_2 &amp;y_2 &amp;z_2 &amp;1\\
x &amp;y &amp;z &amp;1
\end{bmatrix}\, ,
\end{equation*}
</div>
<p>tienen el mismo signo. En este caso, <span class="math">\((x, y, z)\)</span> es el punto de
interés y <span class="math">\((x_i, y_i, z_i)\)</span> son las coordenadas de cada vértice.</p>
</div>
</div>
<div class="section" id="el-algoritmo">
<h2>El algoritmo</h2>
<p>A continuación se muestra una implementación de Python del enfoque
discutido anteriormente</p>
<pre class="code python"><a name="rest_code_66f4769cf85d4e1ebe82718c25c11116-1"></a><span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">division</span><span class="p">,</span> <span class="n">print_function</span>
<a name="rest_code_66f4769cf85d4e1ebe82718c25c11116-2"></a><span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="p">(</span><span class="n">random</span><span class="p">,</span> <span class="n">pi</span><span class="p">,</span> <span class="n">cos</span><span class="p">,</span> <span class="n">sin</span><span class="p">,</span> <span class="n">sign</span><span class="p">,</span> <span class="n">hstack</span><span class="p">,</span>
<a name="rest_code_66f4769cf85d4e1ebe82718c25c11116-3"></a>                   <span class="n">column_stack</span><span class="p">,</span> <span class="n">logspace</span><span class="p">)</span>
<a name="rest_code_66f4769cf85d4e1ebe82718c25c11116-4"></a><span class="kn">from</span> <span class="nn">numpy.linalg</span> <span class="kn">import</span> <span class="n">det</span>
<a name="rest_code_66f4769cf85d4e1ebe82718c25c11116-5"></a><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<a name="rest_code_66f4769cf85d4e1ebe82718c25c11116-6"></a>
<a name="rest_code_66f4769cf85d4e1ebe82718c25c11116-7"></a>
<a name="rest_code_66f4769cf85d4e1ebe82718c25c11116-8"></a><span class="k">def</span> <span class="nf">in_tet</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">pt</span><span class="p">):</span>
<a name="rest_code_66f4769cf85d4e1ebe82718c25c11116-9"></a>    <span class="sd">"""</span>
<a name="rest_code_66f4769cf85d4e1ebe82718c25c11116-10"></a><span class="sd">    Determina si un punto pt está al interior de</span>
<a name="rest_code_66f4769cf85d4e1ebe82718c25c11116-11"></a><span class="sd">    un tetraedro con vértices x, y, z</span>
<a name="rest_code_66f4769cf85d4e1ebe82718c25c11116-12"></a><span class="sd">    """</span>
<a name="rest_code_66f4769cf85d4e1ebe82718c25c11116-13"></a>    <span class="n">mat0</span> <span class="o">=</span> <span class="n">column_stack</span><span class="p">((</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]))</span>
<a name="rest_code_66f4769cf85d4e1ebe82718c25c11116-14"></a>    <span class="n">det0</span> <span class="o">=</span> <span class="n">det</span><span class="p">(</span><span class="n">mat0</span><span class="p">)</span>
<a name="rest_code_66f4769cf85d4e1ebe82718c25c11116-15"></a>    <span class="k">for</span> <span class="n">cont</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
<a name="rest_code_66f4769cf85d4e1ebe82718c25c11116-16"></a>        <span class="n">mat</span> <span class="o">=</span> <span class="n">mat0</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<a name="rest_code_66f4769cf85d4e1ebe82718c25c11116-17"></a>        <span class="n">mat</span><span class="p">[</span><span class="n">cont</span><span class="p">]</span> <span class="o">=</span> <span class="n">hstack</span><span class="p">((</span><span class="n">pt</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<a name="rest_code_66f4769cf85d4e1ebe82718c25c11116-18"></a>        <span class="k">if</span> <span class="n">sign</span><span class="p">(</span><span class="n">det</span><span class="p">(</span><span class="n">mat</span><span class="p">)</span><span class="o">*</span><span class="n">det0</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
<a name="rest_code_66f4769cf85d4e1ebe82718c25c11116-19"></a>            <span class="n">inside</span> <span class="o">=</span> <span class="kc">False</span>
<a name="rest_code_66f4769cf85d4e1ebe82718c25c11116-20"></a>            <span class="k">break</span>
<a name="rest_code_66f4769cf85d4e1ebe82718c25c11116-21"></a>        <span class="k">else</span><span class="p">:</span>
<a name="rest_code_66f4769cf85d4e1ebe82718c25c11116-22"></a>            <span class="n">inside</span> <span class="o">=</span> <span class="kc">True</span>
<a name="rest_code_66f4769cf85d4e1ebe82718c25c11116-23"></a>    <span class="k">return</span> <span class="n">inside</span>
<a name="rest_code_66f4769cf85d4e1ebe82718c25c11116-24"></a>
<a name="rest_code_66f4769cf85d4e1ebe82718c25c11116-25"></a>
<a name="rest_code_66f4769cf85d4e1ebe82718c25c11116-26"></a><span class="c1">#%% Cálculo</span>
<a name="rest_code_66f4769cf85d4e1ebe82718c25c11116-27"></a><span class="n">prob</span> <span class="o">=</span> <span class="p">[]</span>
<a name="rest_code_66f4769cf85d4e1ebe82718c25c11116-28"></a><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<a name="rest_code_66f4769cf85d4e1ebe82718c25c11116-29"></a><span class="n">N_min</span> <span class="o">=</span> <span class="mi">1</span>
<a name="rest_code_66f4769cf85d4e1ebe82718c25c11116-30"></a><span class="n">N_max</span> <span class="o">=</span> <span class="mi">5</span>
<a name="rest_code_66f4769cf85d4e1ebe82718c25c11116-31"></a><span class="n">N_vals</span> <span class="o">=</span> <span class="n">logspace</span><span class="p">(</span><span class="n">N_min</span><span class="p">,</span> <span class="n">N_max</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
<a name="rest_code_66f4769cf85d4e1ebe82718c25c11116-32"></a><span class="k">for</span> <span class="n">N</span> <span class="ow">in</span> <span class="n">N_vals</span><span class="p">:</span>
<a name="rest_code_66f4769cf85d4e1ebe82718c25c11116-33"></a>    <span class="n">inside_cont</span> <span class="o">=</span> <span class="mi">0</span>
<a name="rest_code_66f4769cf85d4e1ebe82718c25c11116-34"></a>    <span class="k">for</span> <span class="n">cont_pts</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
<a name="rest_code_66f4769cf85d4e1ebe82718c25c11116-35"></a>        <span class="n">phi</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="n">low</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">high</span><span class="o">=</span><span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<a name="rest_code_66f4769cf85d4e1ebe82718c25c11116-36"></a>        <span class="n">theta</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="n">low</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">high</span><span class="o">=</span><span class="n">pi</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<a name="rest_code_66f4769cf85d4e1ebe82718c25c11116-37"></a>        <span class="n">x</span> <span class="o">=</span> <span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">phi</span><span class="p">)</span>
<a name="rest_code_66f4769cf85d4e1ebe82718c25c11116-38"></a>        <span class="n">y</span> <span class="o">=</span> <span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">phi</span><span class="p">)</span>
<a name="rest_code_66f4769cf85d4e1ebe82718c25c11116-39"></a>        <span class="n">z</span> <span class="o">=</span> <span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>
<a name="rest_code_66f4769cf85d4e1ebe82718c25c11116-40"></a>        <span class="k">if</span> <span class="n">in_tet</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]):</span>
<a name="rest_code_66f4769cf85d4e1ebe82718c25c11116-41"></a>            <span class="n">inside_cont</span> <span class="o">+=</span> <span class="mi">1</span>
<a name="rest_code_66f4769cf85d4e1ebe82718c25c11116-42"></a>
<a name="rest_code_66f4769cf85d4e1ebe82718c25c11116-43"></a>    <span class="n">prob</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">inside_cont</span><span class="o">/</span><span class="n">N</span><span class="p">)</span>
<a name="rest_code_66f4769cf85d4e1ebe82718c25c11116-44"></a>
<a name="rest_code_66f4769cf85d4e1ebe82718c25c11116-45"></a>
<a name="rest_code_66f4769cf85d4e1ebe82718c25c11116-46"></a><span class="c1">#%% Graficación</span>
<a name="rest_code_66f4769cf85d4e1ebe82718c25c11116-47"></a><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<a name="rest_code_66f4769cf85d4e1ebe82718c25c11116-48"></a><span class="n">plt</span><span class="o">.</span><span class="n">hlines</span><span class="p">(</span><span class="mf">0.125</span><span class="p">,</span> <span class="mi">10</span><span class="o">**</span><span class="n">N_min</span><span class="p">,</span> <span class="mi">10</span><span class="o">**</span><span class="n">N_max</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">"#3f3f3f"</span><span class="p">)</span>
<a name="rest_code_66f4769cf85d4e1ebe82718c25c11116-49"></a><span class="n">plt</span><span class="o">.</span><span class="n">semilogx</span><span class="p">(</span><span class="n">N_vals</span><span class="p">,</span> <span class="n">prob</span><span class="p">,</span> <span class="s2">"o"</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<a name="rest_code_66f4769cf85d4e1ebe82718c25c11116-50"></a><span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">"Number of trials"</span><span class="p">)</span>
<a name="rest_code_66f4769cf85d4e1ebe82718c25c11116-51"></a><span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">"Computed probability"</span><span class="p">)</span>
<a name="rest_code_66f4769cf85d4e1ebe82718c25c11116-52"></a><span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<a name="rest_code_66f4769cf85d4e1ebe82718c25c11116-53"></a><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre>
<p>Como se esperaba, cuando el número de muestras es suficientemente grande,
la probabilidad estimada es cercana al valor teórico: 0,125. Esto
se puede ver en la siguiente figura.</p>
<img alt="Probabilidad estimada para diferentes tamaños de muestras." class="align-center" src="../images/random_tets.svg" style="width: 600px;">
</div>
</div>
    </div>
    </article>
</div>

        <nav class="postindexpager"><ul class="pager">
<li class="previous">
                <a href="." rel="prev">Publicaciones posteriores</a>
            </li>
            <li class="next">
                <a href="index-4.html" rel="next">Publicaciones anteriores</a>
            </li>
        </ul></nav><script>var disqus_shortname="nicoguaro-github";(function(){var a=document.createElement("script");a.async=true;a.src="https://"+disqus_shortname+".disqus.com/count.js";(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(a)}());</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML" integrity="sha384-3lJUsx1TJHt7BA4udB5KPnDrlkO8T6J6v/op7ui0BbCjvZ9WqV4Xm6DTP6kQ/iBH" crossorigin="anonymous"></script><script type="text/x-mathjax-config">
        MathJax.Hub.Config({tex2jax: {inlineMath: [['$latex ','$'], ['\\(','\\)']]}});
        </script><footer id="footer"><p>Contents © 2021 <a href="mailto:nicoguarin@gmail.com">Nicolás Guarín-Zapata</a> - Powered by <a href="https://getnikola.com" rel="nofollow">Nikola</a> 
<a rel="license" href="http://creativecommons.org/licenses/by/4.0/">
<img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by/4.0/88x31.png"></a></p>
            
        </footer>
</div>
    </div>
    <label for="sidebar-checkbox" class="sidebar-toggle"></label>
    
<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-145359674-1', 'auto');
ga('send', 'pageview');
</script><script src="../assets/js/all-nocdn.js"></script><!-- fancy dates --><script>
    moment.locale("es");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates -->
</body>
</html>
