<!DOCTYPE html>
<html prefix="" lang="es">
<head>
<meta charset="utf-8">
<meta name="description" content="Blog y sitio web personales">
<meta name="viewport" content="width=device-width">
<title>Nicolás' blog (publicaciones antiguas, página 1) | Nicolás' blog</title>
<link href="../assets/css/all.css" rel="stylesheet" type="text/css">
<link rel="stylesheet" href="//fonts.googleapis.com/css?family=PT+Serif:400,400italic,700%7CPT+Sans:400">
<link rel="alternate" type="application/rss+xml" title="RSS (en)" href="../rss.xml">
<link rel="alternate" type="application/rss+xml" title="RSS (es)" href="rss.xml">
<link rel="canonical" href="https://nicoguaro.github.io/es/index-1.html">
<link rel="prev" href="index-2.html" type="text/html">
<!--[if lt IE 9]><script src="../assets/js/html5.js"></script><![endif]-->
</head>
<body>
    <a href="#content" class="sr-only sr-only-focusable">Ir al contenido principal</a>
    <!-- Target for toggling the sidebar `.sidebar-checkbox` is for regular
            styles, `#sidebar-checkbox` for behavior. -->
    <input type="checkbox" class="sidebar-checkbox" id="sidebar-checkbox"><!-- Toggleable sidebar --><div class="sidebar" id="sidebar">
        <div class="sidebar-item">
            <p>This is my personal website and blog.</p>
        </div>
        
    <nav id="menu" role="navigation" class="sidebar-nav"><a class="sidebar-nav-item" href="../pages/about/">About</a>
        <a class="sidebar-nav-item" href="../index.html">Blog</a>
        <a class="sidebar-nav-item" href="../pages/preprints-archive/">Preprints</a>
        <a class="sidebar-nav-item" href="../pages/links/">Links</a>
        <a class="sidebar-nav-item" href="../archive.html">Archive</a>
        <a class="sidebar-nav-item" href="../categories/">Tags</a>
        <a class="sidebar-nav-item" href="../rss.xml">RSS feed</a>
    
    
    </nav>
</div>

    <!-- Wrap is the content to shift when toggling the sidebar. We wrap the
         content to avoid any CSS collisions with our real content. -->
    <div class="wrap">
      <div class="masthead">
        <div class="container">
          
    <h3 id="brand" class="masthead-title">
      <a href="https://nicoguaro.github.io/es/" title="Nicolás' blog" rel="home">Nicolás' blog</a>
    </h3>

        </div>
      </div>

      <div class="container content" id="content">
        

<div class="posts">
    <article class="post h-entry post-text"><header><h1 class="post-title p-name"><a href="posts/numerical_challenge/numerical-02/" class="u-url">Reto de métodos numéricos: Día 2</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn">Nicolás Guarín-Zapata</span></p>
            <p class="dateline"><a href="posts/numerical_challenge/numerical-02/" rel="bookmark"><time class="post-date published dt-published" datetime="2017-10-02T20:47:05-05:00" title="2017-10-02 20:47">2017-10-02 20:47</time></a></p>
                <p class="commentline">
    
    <a href="posts/numerical_challenge/numerical-02/#disqus_thread" data-disqus-identifier="cache/posts/numerical_challenge/numerical-02.html">Comentarios</a>


        </p>
</div>
    </header><div class="e-content entry-content">
    <p>Durante octubre (2017) estaré escribiendo un programa por día para algunos
métodos numéricos famosos en Python y Julia. Esto está pensado como
un ejercicio, no esperen que el código sea lo suficientemente bueno para
usarse en la "vida real". Además, también debo mencionar que casi que no
tengo experiencia con Julia, así que probablemente no escriba un Julia
idiomático y se parezca más a Python.</p>
<section id="regula-falsi"><h2>Regula falsi</h2>
<p>El segundo método a considerar es el <a class="reference external" href="https://en.wikipedia.org/wiki/False_position_method">método de posición falsa</a>,
o <em>regula falsi</em>. Este método se utiliza para resolver la ecuación
<span class="math">\(f(x) = 0\)</span> para <span class="math">\(x\)</span> real, y <span class="math">\(f\)</span> continua. Se comienza con
un intervalo <span class="math">\([a, b]\)</span>, donde <span class="math">\(f (a)\)</span> y  <span class="math">\(f (b)\)</span> deben
tener signos opuestos. El método es similar al método de bisección pero en
lugar de dividir a la mitad el original intervalo toma como nuevo punto del
intervalo la intersección de la línea
que conecta la función evaluada en los dos puntos extremos. Entonces, el nuevo
el punto se calcula a partir de</p>
<div class="math">
\begin{equation*}
c = \frac{a f(b) - b f(a)}{f(b) - f(a)}
\end{equation*}
</div>
<p>Como en el método de bisección, mantenemos el intervalo donde la solución
aparece, es decir, donde cambia el signo de la función.</p>
<p>Usaremos la función <span class="math">\(f(x) = \cos(x) - x\)</span> para probar los códigos,
y como intervalo inicial <span class="math">\([0.5, \pi/4]\)</span>.</p>
<p>A continuación se presentan los códigos.</p>
<section id="python"><h3>Python</h3>
<div class="code"><pre class="code python"><a id="rest_code_9e8c56bf0a6a4c9d95fd9852050ba36e-1" name="rest_code_9e8c56bf0a6a4c9d95fd9852050ba36e-1" href="posts/numerical_challenge/numerical-02/#rest_code_9e8c56bf0a6a4c9d95fd9852050ba36e-1"></a><span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">division</span><span class="p">,</span> <span class="n">print_function</span>
<a id="rest_code_9e8c56bf0a6a4c9d95fd9852050ba36e-2" name="rest_code_9e8c56bf0a6a4c9d95fd9852050ba36e-2" href="posts/numerical_challenge/numerical-02/#rest_code_9e8c56bf0a6a4c9d95fd9852050ba36e-2"></a><span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="nb">abs</span><span class="p">,</span> <span class="n">cos</span><span class="p">,</span> <span class="n">pi</span>
<a id="rest_code_9e8c56bf0a6a4c9d95fd9852050ba36e-3" name="rest_code_9e8c56bf0a6a4c9d95fd9852050ba36e-3" href="posts/numerical_challenge/numerical-02/#rest_code_9e8c56bf0a6a4c9d95fd9852050ba36e-3"></a>
<a id="rest_code_9e8c56bf0a6a4c9d95fd9852050ba36e-4" name="rest_code_9e8c56bf0a6a4c9d95fd9852050ba36e-4" href="posts/numerical_challenge/numerical-02/#rest_code_9e8c56bf0a6a4c9d95fd9852050ba36e-4"></a><span class="k">def</span> <span class="nf">regula_falsi</span><span class="p">(</span><span class="n">fun</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">niter</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">ftol</span><span class="o">=</span><span class="mf">1e-12</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<a id="rest_code_9e8c56bf0a6a4c9d95fd9852050ba36e-5" name="rest_code_9e8c56bf0a6a4c9d95fd9852050ba36e-5" href="posts/numerical_challenge/numerical-02/#rest_code_9e8c56bf0a6a4c9d95fd9852050ba36e-5"></a>    <span class="k">if</span> <span class="n">fun</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="o">*</span> <span class="n">fun</span><span class="p">(</span><span class="n">b</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
<a id="rest_code_9e8c56bf0a6a4c9d95fd9852050ba36e-6" name="rest_code_9e8c56bf0a6a4c9d95fd9852050ba36e-6" href="posts/numerical_challenge/numerical-02/#rest_code_9e8c56bf0a6a4c9d95fd9852050ba36e-6"></a>        <span class="n">c</span> <span class="o">=</span> <span class="kc">None</span>
<a id="rest_code_9e8c56bf0a6a4c9d95fd9852050ba36e-7" name="rest_code_9e8c56bf0a6a4c9d95fd9852050ba36e-7" href="posts/numerical_challenge/numerical-02/#rest_code_9e8c56bf0a6a4c9d95fd9852050ba36e-7"></a>        <span class="n">msg</span> <span class="o">=</span> <span class="s2">"The function should have a sign change in the interval."</span>
<a id="rest_code_9e8c56bf0a6a4c9d95fd9852050ba36e-8" name="rest_code_9e8c56bf0a6a4c9d95fd9852050ba36e-8" href="posts/numerical_challenge/numerical-02/#rest_code_9e8c56bf0a6a4c9d95fd9852050ba36e-8"></a>    <span class="k">else</span><span class="p">:</span>
<a id="rest_code_9e8c56bf0a6a4c9d95fd9852050ba36e-9" name="rest_code_9e8c56bf0a6a4c9d95fd9852050ba36e-9" href="posts/numerical_challenge/numerical-02/#rest_code_9e8c56bf0a6a4c9d95fd9852050ba36e-9"></a>        <span class="k">for</span> <span class="n">cont</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">niter</span><span class="p">):</span>
<a id="rest_code_9e8c56bf0a6a4c9d95fd9852050ba36e-10" name="rest_code_9e8c56bf0a6a4c9d95fd9852050ba36e-10" href="posts/numerical_challenge/numerical-02/#rest_code_9e8c56bf0a6a4c9d95fd9852050ba36e-10"></a>            <span class="n">qa</span> <span class="o">=</span> <span class="n">fun</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<a id="rest_code_9e8c56bf0a6a4c9d95fd9852050ba36e-11" name="rest_code_9e8c56bf0a6a4c9d95fd9852050ba36e-11" href="posts/numerical_challenge/numerical-02/#rest_code_9e8c56bf0a6a4c9d95fd9852050ba36e-11"></a>            <span class="n">qb</span> <span class="o">=</span> <span class="n">fun</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
<a id="rest_code_9e8c56bf0a6a4c9d95fd9852050ba36e-12" name="rest_code_9e8c56bf0a6a4c9d95fd9852050ba36e-12" href="posts/numerical_challenge/numerical-02/#rest_code_9e8c56bf0a6a4c9d95fd9852050ba36e-12"></a>            <span class="n">c</span> <span class="o">=</span> <span class="p">(</span><span class="n">a</span><span class="o">*</span><span class="n">qb</span> <span class="o">-</span> <span class="n">b</span><span class="o">*</span><span class="n">qa</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">qb</span> <span class="o">-</span> <span class="n">qa</span><span class="p">)</span>
<a id="rest_code_9e8c56bf0a6a4c9d95fd9852050ba36e-13" name="rest_code_9e8c56bf0a6a4c9d95fd9852050ba36e-13" href="posts/numerical_challenge/numerical-02/#rest_code_9e8c56bf0a6a4c9d95fd9852050ba36e-13"></a>            <span class="n">qc</span> <span class="o">=</span> <span class="n">fun</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
<a id="rest_code_9e8c56bf0a6a4c9d95fd9852050ba36e-14" name="rest_code_9e8c56bf0a6a4c9d95fd9852050ba36e-14" href="posts/numerical_challenge/numerical-02/#rest_code_9e8c56bf0a6a4c9d95fd9852050ba36e-14"></a>            <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
<a id="rest_code_9e8c56bf0a6a4c9d95fd9852050ba36e-15" name="rest_code_9e8c56bf0a6a4c9d95fd9852050ba36e-15" href="posts/numerical_challenge/numerical-02/#rest_code_9e8c56bf0a6a4c9d95fd9852050ba36e-15"></a>                <span class="nb">print</span><span class="p">(</span><span class="s2">"n: </span><span class="si">{}</span><span class="s2">, c: </span><span class="si">{}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">cont</span><span class="p">,</span> <span class="n">c</span><span class="p">))</span>
<a id="rest_code_9e8c56bf0a6a4c9d95fd9852050ba36e-16" name="rest_code_9e8c56bf0a6a4c9d95fd9852050ba36e-16" href="posts/numerical_challenge/numerical-02/#rest_code_9e8c56bf0a6a4c9d95fd9852050ba36e-16"></a>            <span class="n">msg</span> <span class="o">=</span> <span class="s2">"Maximum number of iterations reached."</span>
<a id="rest_code_9e8c56bf0a6a4c9d95fd9852050ba36e-17" name="rest_code_9e8c56bf0a6a4c9d95fd9852050ba36e-17" href="posts/numerical_challenge/numerical-02/#rest_code_9e8c56bf0a6a4c9d95fd9852050ba36e-17"></a>            <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">qc</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">ftol</span><span class="p">:</span>
<a id="rest_code_9e8c56bf0a6a4c9d95fd9852050ba36e-18" name="rest_code_9e8c56bf0a6a4c9d95fd9852050ba36e-18" href="posts/numerical_challenge/numerical-02/#rest_code_9e8c56bf0a6a4c9d95fd9852050ba36e-18"></a>                <span class="n">msg</span> <span class="o">=</span> <span class="s2">"Root found with desired accuracy."</span>
<a id="rest_code_9e8c56bf0a6a4c9d95fd9852050ba36e-19" name="rest_code_9e8c56bf0a6a4c9d95fd9852050ba36e-19" href="posts/numerical_challenge/numerical-02/#rest_code_9e8c56bf0a6a4c9d95fd9852050ba36e-19"></a>                <span class="k">break</span>
<a id="rest_code_9e8c56bf0a6a4c9d95fd9852050ba36e-20" name="rest_code_9e8c56bf0a6a4c9d95fd9852050ba36e-20" href="posts/numerical_challenge/numerical-02/#rest_code_9e8c56bf0a6a4c9d95fd9852050ba36e-20"></a>            <span class="k">elif</span> <span class="n">qa</span> <span class="o">*</span> <span class="n">qc</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
<a id="rest_code_9e8c56bf0a6a4c9d95fd9852050ba36e-21" name="rest_code_9e8c56bf0a6a4c9d95fd9852050ba36e-21" href="posts/numerical_challenge/numerical-02/#rest_code_9e8c56bf0a6a4c9d95fd9852050ba36e-21"></a>                <span class="n">b</span> <span class="o">=</span> <span class="n">c</span>
<a id="rest_code_9e8c56bf0a6a4c9d95fd9852050ba36e-22" name="rest_code_9e8c56bf0a6a4c9d95fd9852050ba36e-22" href="posts/numerical_challenge/numerical-02/#rest_code_9e8c56bf0a6a4c9d95fd9852050ba36e-22"></a>            <span class="k">elif</span> <span class="n">qb</span> <span class="o">*</span> <span class="n">qc</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
<a id="rest_code_9e8c56bf0a6a4c9d95fd9852050ba36e-23" name="rest_code_9e8c56bf0a6a4c9d95fd9852050ba36e-23" href="posts/numerical_challenge/numerical-02/#rest_code_9e8c56bf0a6a4c9d95fd9852050ba36e-23"></a>                <span class="n">a</span> <span class="o">=</span> <span class="n">c</span>
<a id="rest_code_9e8c56bf0a6a4c9d95fd9852050ba36e-24" name="rest_code_9e8c56bf0a6a4c9d95fd9852050ba36e-24" href="posts/numerical_challenge/numerical-02/#rest_code_9e8c56bf0a6a4c9d95fd9852050ba36e-24"></a>    <span class="k">return</span> <span class="n">c</span><span class="p">,</span> <span class="n">msg</span>
<a id="rest_code_9e8c56bf0a6a4c9d95fd9852050ba36e-25" name="rest_code_9e8c56bf0a6a4c9d95fd9852050ba36e-25" href="posts/numerical_challenge/numerical-02/#rest_code_9e8c56bf0a6a4c9d95fd9852050ba36e-25"></a>
<a id="rest_code_9e8c56bf0a6a4c9d95fd9852050ba36e-26" name="rest_code_9e8c56bf0a6a4c9d95fd9852050ba36e-26" href="posts/numerical_challenge/numerical-02/#rest_code_9e8c56bf0a6a4c9d95fd9852050ba36e-26"></a><span class="k">def</span> <span class="nf">fun</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<a id="rest_code_9e8c56bf0a6a4c9d95fd9852050ba36e-27" name="rest_code_9e8c56bf0a6a4c9d95fd9852050ba36e-27" href="posts/numerical_challenge/numerical-02/#rest_code_9e8c56bf0a6a4c9d95fd9852050ba36e-27"></a>    <span class="k">return</span> <span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="n">x</span>
<a id="rest_code_9e8c56bf0a6a4c9d95fd9852050ba36e-28" name="rest_code_9e8c56bf0a6a4c9d95fd9852050ba36e-28" href="posts/numerical_challenge/numerical-02/#rest_code_9e8c56bf0a6a4c9d95fd9852050ba36e-28"></a>
<a id="rest_code_9e8c56bf0a6a4c9d95fd9852050ba36e-29" name="rest_code_9e8c56bf0a6a4c9d95fd9852050ba36e-29" href="posts/numerical_challenge/numerical-02/#rest_code_9e8c56bf0a6a4c9d95fd9852050ba36e-29"></a><span class="nb">print</span><span class="p">(</span><span class="n">regula_falsi</span><span class="p">(</span><span class="n">fun</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.25</span><span class="o">*</span><span class="n">pi</span><span class="p">))</span>
</pre></div>
</section><section id="julia"><h3>Julia</h3>
<div class="code"><pre class="code julia"><a id="rest_code_15b23674dd394fd7b442ef4b9f2bfa67-1" name="rest_code_15b23674dd394fd7b442ef4b9f2bfa67-1" href="posts/numerical_challenge/numerical-02/#rest_code_15b23674dd394fd7b442ef4b9f2bfa67-1"></a><span class="k">function</span><span class="w"> </span><span class="n">regula_falsi</span><span class="p">(</span><span class="n">fun</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="p">,</span><span class="w"> </span><span class="n">niter</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span><span class="w"> </span><span class="n">ftol</span><span class="o">=</span><span class="mf">1e-12</span><span class="p">,</span><span class="w"> </span><span class="n">verbose</span><span class="o">=</span><span class="nb">false</span><span class="p">)</span><span class="w"></span>
<a id="rest_code_15b23674dd394fd7b442ef4b9f2bfa67-2" name="rest_code_15b23674dd394fd7b442ef4b9f2bfa67-2" href="posts/numerical_challenge/numerical-02/#rest_code_15b23674dd394fd7b442ef4b9f2bfa67-2"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">fun</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">fun</span><span class="p">(</span><span class="n">b</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<a id="rest_code_15b23674dd394fd7b442ef4b9f2bfa67-3" name="rest_code_15b23674dd394fd7b442ef4b9f2bfa67-3" href="posts/numerical_challenge/numerical-02/#rest_code_15b23674dd394fd7b442ef4b9f2bfa67-3"></a><span class="w">        </span><span class="n">c</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">nothing</span><span class="w"></span>
<a id="rest_code_15b23674dd394fd7b442ef4b9f2bfa67-4" name="rest_code_15b23674dd394fd7b442ef4b9f2bfa67-4" href="posts/numerical_challenge/numerical-02/#rest_code_15b23674dd394fd7b442ef4b9f2bfa67-4"></a><span class="w">        </span><span class="n">msg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"The function should have a sign change in the interval."</span><span class="w"></span>
<a id="rest_code_15b23674dd394fd7b442ef4b9f2bfa67-5" name="rest_code_15b23674dd394fd7b442ef4b9f2bfa67-5" href="posts/numerical_challenge/numerical-02/#rest_code_15b23674dd394fd7b442ef4b9f2bfa67-5"></a><span class="w">    </span><span class="k">else</span><span class="w"></span>
<a id="rest_code_15b23674dd394fd7b442ef4b9f2bfa67-6" name="rest_code_15b23674dd394fd7b442ef4b9f2bfa67-6" href="posts/numerical_challenge/numerical-02/#rest_code_15b23674dd394fd7b442ef4b9f2bfa67-6"></a><span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="n">cont</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="n">niter</span><span class="w"></span>
<a id="rest_code_15b23674dd394fd7b442ef4b9f2bfa67-7" name="rest_code_15b23674dd394fd7b442ef4b9f2bfa67-7" href="posts/numerical_challenge/numerical-02/#rest_code_15b23674dd394fd7b442ef4b9f2bfa67-7"></a><span class="w">            </span><span class="n">qa</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fun</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="w"></span>
<a id="rest_code_15b23674dd394fd7b442ef4b9f2bfa67-8" name="rest_code_15b23674dd394fd7b442ef4b9f2bfa67-8" href="posts/numerical_challenge/numerical-02/#rest_code_15b23674dd394fd7b442ef4b9f2bfa67-8"></a><span class="w">            </span><span class="n">qb</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fun</span><span class="p">(</span><span class="n">b</span><span class="p">)</span><span class="w"></span>
<a id="rest_code_15b23674dd394fd7b442ef4b9f2bfa67-9" name="rest_code_15b23674dd394fd7b442ef4b9f2bfa67-9" href="posts/numerical_challenge/numerical-02/#rest_code_15b23674dd394fd7b442ef4b9f2bfa67-9"></a><span class="w">            </span><span class="n">c</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">a</span><span class="o">*</span><span class="n">qb</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">b</span><span class="o">*</span><span class="n">qa</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">qb</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">qa</span><span class="p">)</span><span class="w"></span>
<a id="rest_code_15b23674dd394fd7b442ef4b9f2bfa67-10" name="rest_code_15b23674dd394fd7b442ef4b9f2bfa67-10" href="posts/numerical_challenge/numerical-02/#rest_code_15b23674dd394fd7b442ef4b9f2bfa67-10"></a><span class="w">            </span><span class="n">qc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fun</span><span class="p">(</span><span class="n">c</span><span class="p">)</span><span class="w"></span>
<a id="rest_code_15b23674dd394fd7b442ef4b9f2bfa67-11" name="rest_code_15b23674dd394fd7b442ef4b9f2bfa67-11" href="posts/numerical_challenge/numerical-02/#rest_code_15b23674dd394fd7b442ef4b9f2bfa67-11"></a><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="n">verbose</span><span class="w"></span>
<a id="rest_code_15b23674dd394fd7b442ef4b9f2bfa67-12" name="rest_code_15b23674dd394fd7b442ef4b9f2bfa67-12" href="posts/numerical_challenge/numerical-02/#rest_code_15b23674dd394fd7b442ef4b9f2bfa67-12"></a><span class="w">                </span><span class="n">println</span><span class="p">(</span><span class="s">"n: </span><span class="si">$</span><span class="p">(</span><span class="n">cont</span><span class="p">)</span><span class="s">, c: </span><span class="si">$</span><span class="p">(</span><span class="n">c</span><span class="p">)</span><span class="s">"</span><span class="p">)</span><span class="w"></span>
<a id="rest_code_15b23674dd394fd7b442ef4b9f2bfa67-13" name="rest_code_15b23674dd394fd7b442ef4b9f2bfa67-13" href="posts/numerical_challenge/numerical-02/#rest_code_15b23674dd394fd7b442ef4b9f2bfa67-13"></a><span class="w">            </span><span class="k">end</span><span class="w"></span>
<a id="rest_code_15b23674dd394fd7b442ef4b9f2bfa67-14" name="rest_code_15b23674dd394fd7b442ef4b9f2bfa67-14" href="posts/numerical_challenge/numerical-02/#rest_code_15b23674dd394fd7b442ef4b9f2bfa67-14"></a><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="n">abs</span><span class="p">(</span><span class="n">fun</span><span class="p">(</span><span class="n">c</span><span class="p">))</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">ftol</span><span class="w"></span>
<a id="rest_code_15b23674dd394fd7b442ef4b9f2bfa67-15" name="rest_code_15b23674dd394fd7b442ef4b9f2bfa67-15" href="posts/numerical_challenge/numerical-02/#rest_code_15b23674dd394fd7b442ef4b9f2bfa67-15"></a><span class="w">                </span><span class="n">msg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"Root found with desired accuracy."</span><span class="w"></span>
<a id="rest_code_15b23674dd394fd7b442ef4b9f2bfa67-16" name="rest_code_15b23674dd394fd7b442ef4b9f2bfa67-16" href="posts/numerical_challenge/numerical-02/#rest_code_15b23674dd394fd7b442ef4b9f2bfa67-16"></a><span class="w">                </span><span class="k">break</span><span class="w"></span>
<a id="rest_code_15b23674dd394fd7b442ef4b9f2bfa67-17" name="rest_code_15b23674dd394fd7b442ef4b9f2bfa67-17" href="posts/numerical_challenge/numerical-02/#rest_code_15b23674dd394fd7b442ef4b9f2bfa67-17"></a><span class="w">            </span><span class="k">elseif</span><span class="w"> </span><span class="n">qa</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">qc</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<a id="rest_code_15b23674dd394fd7b442ef4b9f2bfa67-18" name="rest_code_15b23674dd394fd7b442ef4b9f2bfa67-18" href="posts/numerical_challenge/numerical-02/#rest_code_15b23674dd394fd7b442ef4b9f2bfa67-18"></a><span class="w">                </span><span class="n">b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">c</span><span class="w"></span>
<a id="rest_code_15b23674dd394fd7b442ef4b9f2bfa67-19" name="rest_code_15b23674dd394fd7b442ef4b9f2bfa67-19" href="posts/numerical_challenge/numerical-02/#rest_code_15b23674dd394fd7b442ef4b9f2bfa67-19"></a><span class="w">            </span><span class="k">elseif</span><span class="w"> </span><span class="n">qb</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">qc</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<a id="rest_code_15b23674dd394fd7b442ef4b9f2bfa67-20" name="rest_code_15b23674dd394fd7b442ef4b9f2bfa67-20" href="posts/numerical_challenge/numerical-02/#rest_code_15b23674dd394fd7b442ef4b9f2bfa67-20"></a><span class="w">                </span><span class="n">a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">c</span><span class="w"></span>
<a id="rest_code_15b23674dd394fd7b442ef4b9f2bfa67-21" name="rest_code_15b23674dd394fd7b442ef4b9f2bfa67-21" href="posts/numerical_challenge/numerical-02/#rest_code_15b23674dd394fd7b442ef4b9f2bfa67-21"></a><span class="w">            </span><span class="k">end</span><span class="w"></span>
<a id="rest_code_15b23674dd394fd7b442ef4b9f2bfa67-22" name="rest_code_15b23674dd394fd7b442ef4b9f2bfa67-22" href="posts/numerical_challenge/numerical-02/#rest_code_15b23674dd394fd7b442ef4b9f2bfa67-22"></a><span class="w">            </span><span class="n">msg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"Maximum number of iterations reached."</span><span class="w"></span>
<a id="rest_code_15b23674dd394fd7b442ef4b9f2bfa67-23" name="rest_code_15b23674dd394fd7b442ef4b9f2bfa67-23" href="posts/numerical_challenge/numerical-02/#rest_code_15b23674dd394fd7b442ef4b9f2bfa67-23"></a><span class="w">        </span><span class="k">end</span><span class="w"></span>
<a id="rest_code_15b23674dd394fd7b442ef4b9f2bfa67-24" name="rest_code_15b23674dd394fd7b442ef4b9f2bfa67-24" href="posts/numerical_challenge/numerical-02/#rest_code_15b23674dd394fd7b442ef4b9f2bfa67-24"></a><span class="w">    </span><span class="k">end</span><span class="w"></span>
<a id="rest_code_15b23674dd394fd7b442ef4b9f2bfa67-25" name="rest_code_15b23674dd394fd7b442ef4b9f2bfa67-25" href="posts/numerical_challenge/numerical-02/#rest_code_15b23674dd394fd7b442ef4b9f2bfa67-25"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">c</span><span class="p">,</span><span class="w"> </span><span class="n">msg</span><span class="w"></span>
<a id="rest_code_15b23674dd394fd7b442ef4b9f2bfa67-26" name="rest_code_15b23674dd394fd7b442ef4b9f2bfa67-26" href="posts/numerical_challenge/numerical-02/#rest_code_15b23674dd394fd7b442ef4b9f2bfa67-26"></a><span class="k">end</span><span class="w"></span>
<a id="rest_code_15b23674dd394fd7b442ef4b9f2bfa67-27" name="rest_code_15b23674dd394fd7b442ef4b9f2bfa67-27" href="posts/numerical_challenge/numerical-02/#rest_code_15b23674dd394fd7b442ef4b9f2bfa67-27"></a>
<a id="rest_code_15b23674dd394fd7b442ef4b9f2bfa67-28" name="rest_code_15b23674dd394fd7b442ef4b9f2bfa67-28" href="posts/numerical_challenge/numerical-02/#rest_code_15b23674dd394fd7b442ef4b9f2bfa67-28"></a><span class="k">function</span><span class="w"> </span><span class="n">fun</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w"></span>
<a id="rest_code_15b23674dd394fd7b442ef4b9f2bfa67-29" name="rest_code_15b23674dd394fd7b442ef4b9f2bfa67-29" href="posts/numerical_challenge/numerical-02/#rest_code_15b23674dd394fd7b442ef4b9f2bfa67-29"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">x</span><span class="w"></span>
<a id="rest_code_15b23674dd394fd7b442ef4b9f2bfa67-30" name="rest_code_15b23674dd394fd7b442ef4b9f2bfa67-30" href="posts/numerical_challenge/numerical-02/#rest_code_15b23674dd394fd7b442ef4b9f2bfa67-30"></a><span class="k">end</span><span class="w"></span>
<a id="rest_code_15b23674dd394fd7b442ef4b9f2bfa67-31" name="rest_code_15b23674dd394fd7b442ef4b9f2bfa67-31" href="posts/numerical_challenge/numerical-02/#rest_code_15b23674dd394fd7b442ef4b9f2bfa67-31"></a>
<a id="rest_code_15b23674dd394fd7b442ef4b9f2bfa67-32" name="rest_code_15b23674dd394fd7b442ef4b9f2bfa67-32" href="posts/numerical_challenge/numerical-02/#rest_code_15b23674dd394fd7b442ef4b9f2bfa67-32"></a><span class="n">println</span><span class="p">(</span><span class="n">regula_falsi</span><span class="p">(</span><span class="n">fun</span><span class="p">,</span><span class="w"> </span><span class="mf">0.5</span><span class="p">,</span><span class="w"> </span><span class="mf">0.25</span><span class="o">*</span><span class="nb">pi</span><span class="p">))</span><span class="w"></span>
</pre></div>
</section><section id="comparacion"><h3>Comparación</h3>
<p>Respecto al número de líneas de código tenemos: 29 en Python y 32 en Julia.
La comparación en tiempo de ejecución se realiza con el comando mágico
de IPython <code class="docutils literal">%timeit</code> y con <code class="docutils literal">@benchmark</code> en Julia.</p>
<p>Para Python:</p>
<div class="code"><pre class="code IPython"><a id="rest_code_bf198f3e844843348395bdd7e147fa34-1" name="rest_code_bf198f3e844843348395bdd7e147fa34-1" href="posts/numerical_challenge/numerical-02/#rest_code_bf198f3e844843348395bdd7e147fa34-1"></a><span class="o">%</span><span class="k">timeit</span> regula_falsi(fun, 0.5, 0.25*pi)
</pre></div>
<p>con resultado</p>
<div class="code"><pre class="code IPython"><a id="rest_code_360eedb037d94c568c5aadf0e56ad3f5-1" name="rest_code_360eedb037d94c568c5aadf0e56ad3f5-1" href="posts/numerical_challenge/numerical-02/#rest_code_360eedb037d94c568c5aadf0e56ad3f5-1"></a><span class="mi">10000</span> <span class="n">loops</span><span class="p">,</span> <span class="n">best</span> <span class="n">of</span> <span class="mi">3</span><span class="p">:</span> <span class="mf">35.1</span> <span class="n">µs</span> <span class="n">per</span> <span class="n">loop</span>
</pre></div>
<p>Para Julia:</p>
<div class="code"><pre class="code julia"><a id="rest_code_722326f305644fcabf889ccea20f5478-1" name="rest_code_722326f305644fcabf889ccea20f5478-1" href="posts/numerical_challenge/numerical-02/#rest_code_722326f305644fcabf889ccea20f5478-1"></a><span class="nd">@benchmark</span><span class="w"> </span><span class="n">regula_falsi</span><span class="p">(</span><span class="n">fun</span><span class="p">,</span><span class="w"> </span><span class="mf">0.5</span><span class="p">,</span><span class="w"> </span><span class="mf">0.25</span><span class="o">*</span><span class="nb">pi</span><span class="p">)</span><span class="w"></span>
</pre></div>
<p>con resultado</p>
<div class="code"><pre class="code julia"><a id="rest_code_f05e0f000a0c4a048766fe7d32327dff-1" name="rest_code_f05e0f000a0c4a048766fe7d32327dff-1" href="posts/numerical_challenge/numerical-02/#rest_code_f05e0f000a0c4a048766fe7d32327dff-1"></a><span class="n">BenchmarkTools</span><span class="o">.</span><span class="n">Trial</span><span class="o">:</span><span class="w"></span>
<a id="rest_code_f05e0f000a0c4a048766fe7d32327dff-2" name="rest_code_f05e0f000a0c4a048766fe7d32327dff-2" href="posts/numerical_challenge/numerical-02/#rest_code_f05e0f000a0c4a048766fe7d32327dff-2"></a><span class="w">  </span><span class="n">memory</span><span class="w"> </span><span class="n">estimate</span><span class="o">:</span><span class="w">  </span><span class="mi">48</span><span class="w"> </span><span class="n">bytes</span><span class="w"></span>
<a id="rest_code_f05e0f000a0c4a048766fe7d32327dff-3" name="rest_code_f05e0f000a0c4a048766fe7d32327dff-3" href="posts/numerical_challenge/numerical-02/#rest_code_f05e0f000a0c4a048766fe7d32327dff-3"></a><span class="w">  </span><span class="n">allocs</span><span class="w"> </span><span class="n">estimate</span><span class="o">:</span><span class="w">  </span><span class="mi">2</span><span class="w"></span>
<a id="rest_code_f05e0f000a0c4a048766fe7d32327dff-4" name="rest_code_f05e0f000a0c4a048766fe7d32327dff-4" href="posts/numerical_challenge/numerical-02/#rest_code_f05e0f000a0c4a048766fe7d32327dff-4"></a><span class="w">  </span><span class="o">--------------</span><span class="w"></span>
<a id="rest_code_f05e0f000a0c4a048766fe7d32327dff-5" name="rest_code_f05e0f000a0c4a048766fe7d32327dff-5" href="posts/numerical_challenge/numerical-02/#rest_code_f05e0f000a0c4a048766fe7d32327dff-5"></a><span class="w">  </span><span class="n">minimum</span><span class="w"> </span><span class="n">time</span><span class="o">:</span><span class="w">     </span><span class="mf">449.495</span><span class="w"> </span><span class="n">ns</span><span class="w"> </span><span class="p">(</span><span class="mf">0.00</span><span class="o">%</span><span class="w"> </span><span class="n">GC</span><span class="p">)</span><span class="w"></span>
<a id="rest_code_f05e0f000a0c4a048766fe7d32327dff-6" name="rest_code_f05e0f000a0c4a048766fe7d32327dff-6" href="posts/numerical_challenge/numerical-02/#rest_code_f05e0f000a0c4a048766fe7d32327dff-6"></a><span class="w">  </span><span class="n">median</span><span class="w"> </span><span class="n">time</span><span class="o">:</span><span class="w">      </span><span class="mf">464.371</span><span class="w"> </span><span class="n">ns</span><span class="w"> </span><span class="p">(</span><span class="mf">0.00</span><span class="o">%</span><span class="w"> </span><span class="n">GC</span><span class="p">)</span><span class="w"></span>
<a id="rest_code_f05e0f000a0c4a048766fe7d32327dff-7" name="rest_code_f05e0f000a0c4a048766fe7d32327dff-7" href="posts/numerical_challenge/numerical-02/#rest_code_f05e0f000a0c4a048766fe7d32327dff-7"></a><span class="w">  </span><span class="n">mean</span><span class="w"> </span><span class="n">time</span><span class="o">:</span><span class="w">        </span><span class="mf">493.785</span><span class="w"> </span><span class="n">ns</span><span class="w"> </span><span class="p">(</span><span class="mf">0.52</span><span class="o">%</span><span class="w"> </span><span class="n">GC</span><span class="p">)</span><span class="w"></span>
<a id="rest_code_f05e0f000a0c4a048766fe7d32327dff-8" name="rest_code_f05e0f000a0c4a048766fe7d32327dff-8" href="posts/numerical_challenge/numerical-02/#rest_code_f05e0f000a0c4a048766fe7d32327dff-8"></a><span class="w">  </span><span class="n">maximum</span><span class="w"> </span><span class="n">time</span><span class="o">:</span><span class="w">     </span><span class="mf">9.723</span><span class="w"> </span><span class="n">μs</span><span class="w"> </span><span class="p">(</span><span class="mf">92.54</span><span class="o">%</span><span class="w"> </span><span class="n">GC</span><span class="p">)</span><span class="w"></span>
<a id="rest_code_f05e0f000a0c4a048766fe7d32327dff-9" name="rest_code_f05e0f000a0c4a048766fe7d32327dff-9" href="posts/numerical_challenge/numerical-02/#rest_code_f05e0f000a0c4a048766fe7d32327dff-9"></a><span class="w">  </span><span class="o">--------------</span><span class="w"></span>
<a id="rest_code_f05e0f000a0c4a048766fe7d32327dff-10" name="rest_code_f05e0f000a0c4a048766fe7d32327dff-10" href="posts/numerical_challenge/numerical-02/#rest_code_f05e0f000a0c4a048766fe7d32327dff-10"></a><span class="w">  </span><span class="n">samples</span><span class="o">:</span><span class="w">          </span><span class="mi">10000</span><span class="w"></span>
<a id="rest_code_f05e0f000a0c4a048766fe7d32327dff-11" name="rest_code_f05e0f000a0c4a048766fe7d32327dff-11" href="posts/numerical_challenge/numerical-02/#rest_code_f05e0f000a0c4a048766fe7d32327dff-11"></a><span class="w">  </span><span class="n">evals</span><span class="o">/</span><span class="n">sample</span><span class="o">:</span><span class="w">     </span><span class="mi">198</span><span class="w"></span>
</pre></div>
</section></section>
</div>
    </article><article class="post h-entry post-text"><header><h1 class="post-title p-name"><a href="posts/numerical_challenge/numerical-01/" class="u-url">Reto de métodos numéricos</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn">Nicolás Guarín-Zapata</span></p>
            <p class="dateline"><a href="posts/numerical_challenge/numerical-01/" rel="bookmark"><time class="post-date published dt-published" datetime="2017-10-01T23:12:04-05:00" title="2017-10-01 23:12">2017-10-01 23:12</time></a></p>
                <p class="commentline">
    
    <a href="posts/numerical_challenge/numerical-01/#disqus_thread" data-disqus-identifier="cache/posts/numerical_challenge/numerical-01.html">Comentarios</a>


        </p>
</div>
    </header><div class="e-content entry-content">
    <p>Por el próximo mes estaré escribiendo un programa por día para algunos métodos
numéricos conocidos en Python y Julia. Está destinado a ser un ejercicio,
entonces no espere que el código sea lo suficientemente bueno para un uso real.
Además, debo mencionar que casi no tengo experiencia con Julia, por lo que
probablemente no será Julia idiomático sino Julia más parecido a Python.</p>
<section id="dia-1-metodo-de-biseccion"><h2>Día 1: Método de bisección</h2>
<p>El primer método a considerar es el
<a class="reference external" href="https://en.wikipedia.org/wiki/Bisection_method">método de bisección</a>.
Este método se usa para resolver la ecuación <span class="math">\(f(x) = 0\)</span> para
<span class="math">\(x\)</span> real, y <span class="math">\(f\)</span> continua. Se empieza con un intervalo <span class="math">\([a,b]\)</span>,
donde <span class="math">\(f(a)\)</span> y <span class="math">\(f(b)\)</span> deben tener signos opuestos. El método procede
partiendo a la mitad el intervalo y seleccionando el subintervalo en donde
aparece la solución, es decir, el signo de la función cambia.</p>
<p>Usaremos la función <span class="math">\(f(x) = \cos(x) - x^2\)</span> para probar los códigos,
y el intervalo inicial es [0, 1].</p>
<p>A continuación están los códigos:</p>
<section id="python"><h3>Python</h3>
<div class="code"><pre class="code python"><a id="rest_code_ee254717bca842bcaa1e47ea0a8e0991-1" name="rest_code_ee254717bca842bcaa1e47ea0a8e0991-1" href="posts/numerical_challenge/numerical-01/#rest_code_ee254717bca842bcaa1e47ea0a8e0991-1"></a><span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">division</span><span class="p">,</span> <span class="n">print_function</span>
<a id="rest_code_ee254717bca842bcaa1e47ea0a8e0991-2" name="rest_code_ee254717bca842bcaa1e47ea0a8e0991-2" href="posts/numerical_challenge/numerical-01/#rest_code_ee254717bca842bcaa1e47ea0a8e0991-2"></a><span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="n">log2</span><span class="p">,</span> <span class="n">ceil</span><span class="p">,</span> <span class="nb">abs</span><span class="p">,</span> <span class="n">cos</span>
<a id="rest_code_ee254717bca842bcaa1e47ea0a8e0991-3" name="rest_code_ee254717bca842bcaa1e47ea0a8e0991-3" href="posts/numerical_challenge/numerical-01/#rest_code_ee254717bca842bcaa1e47ea0a8e0991-3"></a>
<a id="rest_code_ee254717bca842bcaa1e47ea0a8e0991-4" name="rest_code_ee254717bca842bcaa1e47ea0a8e0991-4" href="posts/numerical_challenge/numerical-01/#rest_code_ee254717bca842bcaa1e47ea0a8e0991-4"></a><span class="k">def</span> <span class="nf">bisection</span><span class="p">(</span><span class="n">fun</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">xtol</span><span class="o">=</span><span class="mf">1e-6</span><span class="p">,</span> <span class="n">ftol</span><span class="o">=</span><span class="mf">1e-12</span><span class="p">):</span>
<a id="rest_code_ee254717bca842bcaa1e47ea0a8e0991-5" name="rest_code_ee254717bca842bcaa1e47ea0a8e0991-5" href="posts/numerical_challenge/numerical-01/#rest_code_ee254717bca842bcaa1e47ea0a8e0991-5"></a>    <span class="k">if</span> <span class="n">fun</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="o">*</span> <span class="n">fun</span><span class="p">(</span><span class="n">b</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
<a id="rest_code_ee254717bca842bcaa1e47ea0a8e0991-6" name="rest_code_ee254717bca842bcaa1e47ea0a8e0991-6" href="posts/numerical_challenge/numerical-01/#rest_code_ee254717bca842bcaa1e47ea0a8e0991-6"></a>        <span class="n">c</span> <span class="o">=</span> <span class="kc">None</span>
<a id="rest_code_ee254717bca842bcaa1e47ea0a8e0991-7" name="rest_code_ee254717bca842bcaa1e47ea0a8e0991-7" href="posts/numerical_challenge/numerical-01/#rest_code_ee254717bca842bcaa1e47ea0a8e0991-7"></a>        <span class="n">msg</span> <span class="o">=</span> <span class="s2">"The function should have a sign change in the interval."</span>
<a id="rest_code_ee254717bca842bcaa1e47ea0a8e0991-8" name="rest_code_ee254717bca842bcaa1e47ea0a8e0991-8" href="posts/numerical_challenge/numerical-01/#rest_code_ee254717bca842bcaa1e47ea0a8e0991-8"></a>    <span class="k">else</span><span class="p">:</span>
<a id="rest_code_ee254717bca842bcaa1e47ea0a8e0991-9" name="rest_code_ee254717bca842bcaa1e47ea0a8e0991-9" href="posts/numerical_challenge/numerical-01/#rest_code_ee254717bca842bcaa1e47ea0a8e0991-9"></a>        <span class="n">nmax</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">ceil</span><span class="p">(</span><span class="n">log2</span><span class="p">((</span><span class="n">b</span> <span class="o">-</span> <span class="n">a</span><span class="p">)</span><span class="o">/</span><span class="n">xtol</span><span class="p">)))</span>
<a id="rest_code_ee254717bca842bcaa1e47ea0a8e0991-10" name="rest_code_ee254717bca842bcaa1e47ea0a8e0991-10" href="posts/numerical_challenge/numerical-01/#rest_code_ee254717bca842bcaa1e47ea0a8e0991-10"></a>        <span class="k">for</span> <span class="n">cont</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nmax</span><span class="p">):</span>
<a id="rest_code_ee254717bca842bcaa1e47ea0a8e0991-11" name="rest_code_ee254717bca842bcaa1e47ea0a8e0991-11" href="posts/numerical_challenge/numerical-01/#rest_code_ee254717bca842bcaa1e47ea0a8e0991-11"></a>            <span class="n">c</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="n">a</span> <span class="o">+</span> <span class="n">b</span><span class="p">)</span>
<a id="rest_code_ee254717bca842bcaa1e47ea0a8e0991-12" name="rest_code_ee254717bca842bcaa1e47ea0a8e0991-12" href="posts/numerical_challenge/numerical-01/#rest_code_ee254717bca842bcaa1e47ea0a8e0991-12"></a>            <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">fun</span><span class="p">(</span><span class="n">c</span><span class="p">))</span> <span class="o">&lt;</span> <span class="n">ftol</span><span class="p">:</span>
<a id="rest_code_ee254717bca842bcaa1e47ea0a8e0991-13" name="rest_code_ee254717bca842bcaa1e47ea0a8e0991-13" href="posts/numerical_challenge/numerical-01/#rest_code_ee254717bca842bcaa1e47ea0a8e0991-13"></a>                <span class="n">msg</span> <span class="o">=</span> <span class="s2">"Root found with desired accuracy."</span>
<a id="rest_code_ee254717bca842bcaa1e47ea0a8e0991-14" name="rest_code_ee254717bca842bcaa1e47ea0a8e0991-14" href="posts/numerical_challenge/numerical-01/#rest_code_ee254717bca842bcaa1e47ea0a8e0991-14"></a>                <span class="k">break</span>
<a id="rest_code_ee254717bca842bcaa1e47ea0a8e0991-15" name="rest_code_ee254717bca842bcaa1e47ea0a8e0991-15" href="posts/numerical_challenge/numerical-01/#rest_code_ee254717bca842bcaa1e47ea0a8e0991-15"></a>            <span class="k">elif</span> <span class="n">fun</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="o">*</span> <span class="n">fun</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
<a id="rest_code_ee254717bca842bcaa1e47ea0a8e0991-16" name="rest_code_ee254717bca842bcaa1e47ea0a8e0991-16" href="posts/numerical_challenge/numerical-01/#rest_code_ee254717bca842bcaa1e47ea0a8e0991-16"></a>                <span class="n">b</span> <span class="o">=</span> <span class="n">c</span>
<a id="rest_code_ee254717bca842bcaa1e47ea0a8e0991-17" name="rest_code_ee254717bca842bcaa1e47ea0a8e0991-17" href="posts/numerical_challenge/numerical-01/#rest_code_ee254717bca842bcaa1e47ea0a8e0991-17"></a>            <span class="k">elif</span> <span class="n">fun</span><span class="p">(</span><span class="n">b</span><span class="p">)</span> <span class="o">*</span> <span class="n">fun</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
<a id="rest_code_ee254717bca842bcaa1e47ea0a8e0991-18" name="rest_code_ee254717bca842bcaa1e47ea0a8e0991-18" href="posts/numerical_challenge/numerical-01/#rest_code_ee254717bca842bcaa1e47ea0a8e0991-18"></a>                <span class="n">a</span> <span class="o">=</span> <span class="n">c</span>
<a id="rest_code_ee254717bca842bcaa1e47ea0a8e0991-19" name="rest_code_ee254717bca842bcaa1e47ea0a8e0991-19" href="posts/numerical_challenge/numerical-01/#rest_code_ee254717bca842bcaa1e47ea0a8e0991-19"></a>            <span class="n">msg</span> <span class="o">=</span> <span class="s2">"Maximum number of iterations reached."</span>
<a id="rest_code_ee254717bca842bcaa1e47ea0a8e0991-20" name="rest_code_ee254717bca842bcaa1e47ea0a8e0991-20" href="posts/numerical_challenge/numerical-01/#rest_code_ee254717bca842bcaa1e47ea0a8e0991-20"></a>    <span class="k">return</span> <span class="n">c</span><span class="p">,</span> <span class="n">msg</span>
<a id="rest_code_ee254717bca842bcaa1e47ea0a8e0991-21" name="rest_code_ee254717bca842bcaa1e47ea0a8e0991-21" href="posts/numerical_challenge/numerical-01/#rest_code_ee254717bca842bcaa1e47ea0a8e0991-21"></a>
<a id="rest_code_ee254717bca842bcaa1e47ea0a8e0991-22" name="rest_code_ee254717bca842bcaa1e47ea0a8e0991-22" href="posts/numerical_challenge/numerical-01/#rest_code_ee254717bca842bcaa1e47ea0a8e0991-22"></a><span class="k">def</span> <span class="nf">fun</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<a id="rest_code_ee254717bca842bcaa1e47ea0a8e0991-23" name="rest_code_ee254717bca842bcaa1e47ea0a8e0991-23" href="posts/numerical_challenge/numerical-01/#rest_code_ee254717bca842bcaa1e47ea0a8e0991-23"></a>    <span class="k">return</span> <span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span>
<a id="rest_code_ee254717bca842bcaa1e47ea0a8e0991-24" name="rest_code_ee254717bca842bcaa1e47ea0a8e0991-24" href="posts/numerical_challenge/numerical-01/#rest_code_ee254717bca842bcaa1e47ea0a8e0991-24"></a>
<a id="rest_code_ee254717bca842bcaa1e47ea0a8e0991-25" name="rest_code_ee254717bca842bcaa1e47ea0a8e0991-25" href="posts/numerical_challenge/numerical-01/#rest_code_ee254717bca842bcaa1e47ea0a8e0991-25"></a><span class="nb">print</span><span class="p">(</span><span class="n">bisection</span><span class="p">(</span><span class="n">fun</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">))</span>
</pre></div>
<p>Con resultado</p>
<div class="code"><pre class="code python"><a id="rest_code_4ac1fbe785d34b71b0d31b66dc7e4231-1" name="rest_code_4ac1fbe785d34b71b0d31b66dc7e4231-1" href="posts/numerical_challenge/numerical-01/#rest_code_4ac1fbe785d34b71b0d31b66dc7e4231-1"></a><span class="p">(</span><span class="mf">0.824131965637207</span><span class="p">,</span> <span class="s1">'Maximum number of iterations reached.'</span><span class="p">)</span>
</pre></div>
</section><section id="julia"><h3>Julia</h3>
<div class="code"><pre class="code julia"><a id="rest_code_ac33f450be83475599cb0851bf826d65-1" name="rest_code_ac33f450be83475599cb0851bf826d65-1" href="posts/numerical_challenge/numerical-01/#rest_code_ac33f450be83475599cb0851bf826d65-1"></a><span class="k">function</span><span class="w"> </span><span class="n">bisection</span><span class="p">(</span><span class="n">fun</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="p">,</span><span class="w"> </span><span class="n">xtol</span><span class="o">=</span><span class="mf">1e-6</span><span class="p">,</span><span class="w"> </span><span class="n">ftol</span><span class="o">=</span><span class="mf">1e-12</span><span class="p">)</span><span class="w"></span>
<a id="rest_code_ac33f450be83475599cb0851bf826d65-2" name="rest_code_ac33f450be83475599cb0851bf826d65-2" href="posts/numerical_challenge/numerical-01/#rest_code_ac33f450be83475599cb0851bf826d65-2"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">fun</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">fun</span><span class="p">(</span><span class="n">b</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<a id="rest_code_ac33f450be83475599cb0851bf826d65-3" name="rest_code_ac33f450be83475599cb0851bf826d65-3" href="posts/numerical_challenge/numerical-01/#rest_code_ac33f450be83475599cb0851bf826d65-3"></a><span class="w">        </span><span class="n">c</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">nothing</span><span class="w"></span>
<a id="rest_code_ac33f450be83475599cb0851bf826d65-4" name="rest_code_ac33f450be83475599cb0851bf826d65-4" href="posts/numerical_challenge/numerical-01/#rest_code_ac33f450be83475599cb0851bf826d65-4"></a><span class="w">        </span><span class="n">msg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"The function should have a sign change in the interval."</span><span class="w"></span>
<a id="rest_code_ac33f450be83475599cb0851bf826d65-5" name="rest_code_ac33f450be83475599cb0851bf826d65-5" href="posts/numerical_challenge/numerical-01/#rest_code_ac33f450be83475599cb0851bf826d65-5"></a><span class="w">    </span><span class="k">else</span><span class="w"></span>
<a id="rest_code_ac33f450be83475599cb0851bf826d65-6" name="rest_code_ac33f450be83475599cb0851bf826d65-6" href="posts/numerical_challenge/numerical-01/#rest_code_ac33f450be83475599cb0851bf826d65-6"></a><span class="w">        </span><span class="n">nmax</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ceil</span><span class="p">(</span><span class="n">log2</span><span class="p">((</span><span class="n">b</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">a</span><span class="p">)</span><span class="o">/</span><span class="n">xtol</span><span class="p">))</span><span class="w"></span>
<a id="rest_code_ac33f450be83475599cb0851bf826d65-7" name="rest_code_ac33f450be83475599cb0851bf826d65-7" href="posts/numerical_challenge/numerical-01/#rest_code_ac33f450be83475599cb0851bf826d65-7"></a><span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="n">cont</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="n">nmax</span><span class="w"></span>
<a id="rest_code_ac33f450be83475599cb0851bf826d65-8" name="rest_code_ac33f450be83475599cb0851bf826d65-8" href="posts/numerical_challenge/numerical-01/#rest_code_ac33f450be83475599cb0851bf826d65-8"></a><span class="w">            </span><span class="n">c</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="n">a</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">b</span><span class="p">)</span><span class="w"></span>
<a id="rest_code_ac33f450be83475599cb0851bf826d65-9" name="rest_code_ac33f450be83475599cb0851bf826d65-9" href="posts/numerical_challenge/numerical-01/#rest_code_ac33f450be83475599cb0851bf826d65-9"></a><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="n">abs</span><span class="p">(</span><span class="n">fun</span><span class="p">(</span><span class="n">c</span><span class="p">))</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">ftol</span><span class="w"></span>
<a id="rest_code_ac33f450be83475599cb0851bf826d65-10" name="rest_code_ac33f450be83475599cb0851bf826d65-10" href="posts/numerical_challenge/numerical-01/#rest_code_ac33f450be83475599cb0851bf826d65-10"></a><span class="w">                </span><span class="n">msg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"Root found with desired accuracy."</span><span class="w"></span>
<a id="rest_code_ac33f450be83475599cb0851bf826d65-11" name="rest_code_ac33f450be83475599cb0851bf826d65-11" href="posts/numerical_challenge/numerical-01/#rest_code_ac33f450be83475599cb0851bf826d65-11"></a><span class="w">                </span><span class="k">break</span><span class="w"></span>
<a id="rest_code_ac33f450be83475599cb0851bf826d65-12" name="rest_code_ac33f450be83475599cb0851bf826d65-12" href="posts/numerical_challenge/numerical-01/#rest_code_ac33f450be83475599cb0851bf826d65-12"></a><span class="w">            </span><span class="k">elseif</span><span class="w"> </span><span class="n">fun</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">fun</span><span class="p">(</span><span class="n">c</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<a id="rest_code_ac33f450be83475599cb0851bf826d65-13" name="rest_code_ac33f450be83475599cb0851bf826d65-13" href="posts/numerical_challenge/numerical-01/#rest_code_ac33f450be83475599cb0851bf826d65-13"></a><span class="w">                </span><span class="n">b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">c</span><span class="w"></span>
<a id="rest_code_ac33f450be83475599cb0851bf826d65-14" name="rest_code_ac33f450be83475599cb0851bf826d65-14" href="posts/numerical_challenge/numerical-01/#rest_code_ac33f450be83475599cb0851bf826d65-14"></a><span class="w">            </span><span class="k">elseif</span><span class="w"> </span><span class="n">fun</span><span class="p">(</span><span class="n">b</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">fun</span><span class="p">(</span><span class="n">c</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<a id="rest_code_ac33f450be83475599cb0851bf826d65-15" name="rest_code_ac33f450be83475599cb0851bf826d65-15" href="posts/numerical_challenge/numerical-01/#rest_code_ac33f450be83475599cb0851bf826d65-15"></a><span class="w">                </span><span class="n">a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">c</span><span class="w"></span>
<a id="rest_code_ac33f450be83475599cb0851bf826d65-16" name="rest_code_ac33f450be83475599cb0851bf826d65-16" href="posts/numerical_challenge/numerical-01/#rest_code_ac33f450be83475599cb0851bf826d65-16"></a><span class="w">            </span><span class="k">end</span><span class="w"></span>
<a id="rest_code_ac33f450be83475599cb0851bf826d65-17" name="rest_code_ac33f450be83475599cb0851bf826d65-17" href="posts/numerical_challenge/numerical-01/#rest_code_ac33f450be83475599cb0851bf826d65-17"></a><span class="w">            </span><span class="n">msg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"Maximum number of iterations reached."</span><span class="w"></span>
<a id="rest_code_ac33f450be83475599cb0851bf826d65-18" name="rest_code_ac33f450be83475599cb0851bf826d65-18" href="posts/numerical_challenge/numerical-01/#rest_code_ac33f450be83475599cb0851bf826d65-18"></a><span class="w">        </span><span class="k">end</span><span class="w"></span>
<a id="rest_code_ac33f450be83475599cb0851bf826d65-19" name="rest_code_ac33f450be83475599cb0851bf826d65-19" href="posts/numerical_challenge/numerical-01/#rest_code_ac33f450be83475599cb0851bf826d65-19"></a><span class="w">    </span><span class="k">end</span><span class="w"></span>
<a id="rest_code_ac33f450be83475599cb0851bf826d65-20" name="rest_code_ac33f450be83475599cb0851bf826d65-20" href="posts/numerical_challenge/numerical-01/#rest_code_ac33f450be83475599cb0851bf826d65-20"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">c</span><span class="p">,</span><span class="w"> </span><span class="n">msg</span><span class="w"></span>
<a id="rest_code_ac33f450be83475599cb0851bf826d65-21" name="rest_code_ac33f450be83475599cb0851bf826d65-21" href="posts/numerical_challenge/numerical-01/#rest_code_ac33f450be83475599cb0851bf826d65-21"></a><span class="k">end</span><span class="w"></span>
<a id="rest_code_ac33f450be83475599cb0851bf826d65-22" name="rest_code_ac33f450be83475599cb0851bf826d65-22" href="posts/numerical_challenge/numerical-01/#rest_code_ac33f450be83475599cb0851bf826d65-22"></a>
<a id="rest_code_ac33f450be83475599cb0851bf826d65-23" name="rest_code_ac33f450be83475599cb0851bf826d65-23" href="posts/numerical_challenge/numerical-01/#rest_code_ac33f450be83475599cb0851bf826d65-23"></a><span class="k">function</span><span class="w"> </span><span class="n">fun</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w"></span>
<a id="rest_code_ac33f450be83475599cb0851bf826d65-24" name="rest_code_ac33f450be83475599cb0851bf826d65-24" href="posts/numerical_challenge/numerical-01/#rest_code_ac33f450be83475599cb0851bf826d65-24"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="w"></span>
<a id="rest_code_ac33f450be83475599cb0851bf826d65-25" name="rest_code_ac33f450be83475599cb0851bf826d65-25" href="posts/numerical_challenge/numerical-01/#rest_code_ac33f450be83475599cb0851bf826d65-25"></a><span class="k">end</span><span class="w"></span>
<a id="rest_code_ac33f450be83475599cb0851bf826d65-26" name="rest_code_ac33f450be83475599cb0851bf826d65-26" href="posts/numerical_challenge/numerical-01/#rest_code_ac33f450be83475599cb0851bf826d65-26"></a>
<a id="rest_code_ac33f450be83475599cb0851bf826d65-27" name="rest_code_ac33f450be83475599cb0851bf826d65-27" href="posts/numerical_challenge/numerical-01/#rest_code_ac33f450be83475599cb0851bf826d65-27"></a><span class="n">println</span><span class="p">(</span><span class="n">bisection</span><span class="p">(</span><span class="n">fun</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">1.0</span><span class="p">))</span><span class="w"></span>
</pre></div>
<p>Con resultado</p>
<div class="code"><pre class="code julia"><a id="rest_code_36ccf78c5d004278bca34370a266dd0b-1" name="rest_code_36ccf78c5d004278bca34370a266dd0b-1" href="posts/numerical_challenge/numerical-01/#rest_code_36ccf78c5d004278bca34370a266dd0b-1"></a><span class="p">(</span><span class="mf">0.824131965637207</span><span class="p">,</span><span class="w"> </span><span class="s">"Maximum number of iterations reached."</span><span class="p">)</span><span class="w"></span>
</pre></div>
<p>En este caso, ambos códigos están bastante cerca. El código de Python tiene
25 líneas, mientras que el de Julia 27. Como se esperaba, los resultados
son iguales.</p>
</section><section id="edicion-2017-10-02"><h3>Edición (2017-10-02)</h3>
<p>Como sugirió Edward Villegas, decidí comparar los tiempos de ejecución.
Usé  <code class="docutils literal">%timeit</code> para IPython y <code class="docutils literal">@benchmark</code> (de <code class="docutils literal">BenchmarkTools</code>)
para Julia.</p>
<p>En IPython, tenemos</p>
<div class="code"><pre class="code IPython"><a id="rest_code_f75666c40f4d4d868c30fed867327f88-1" name="rest_code_f75666c40f4d4d868c30fed867327f88-1" href="posts/numerical_challenge/numerical-01/#rest_code_f75666c40f4d4d868c30fed867327f88-1"></a><span class="o">%</span><span class="k">timeit</span> bisection(fun, 0.0, 2.0)
</pre></div>
<p>con resultado</p>
<div class="code"><pre class="code IPython"><a id="rest_code_6976d474adb64378b6820ee5995ca483-1" name="rest_code_6976d474adb64378b6820ee5995ca483-1" href="posts/numerical_challenge/numerical-01/#rest_code_6976d474adb64378b6820ee5995ca483-1"></a><span class="mi">10000</span> <span class="n">loops</span><span class="p">,</span> <span class="n">best</span> <span class="n">of</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">107</span> <span class="n">µs</span> <span class="n">per</span> <span class="n">loop</span>
</pre></div>
<p>Y en Julia, tenemos</p>
<div class="code"><pre class="code julia"><a id="rest_code_20972af0298a4e3e86f5727ad99c9fd5-1" name="rest_code_20972af0298a4e3e86f5727ad99c9fd5-1" href="posts/numerical_challenge/numerical-01/#rest_code_20972af0298a4e3e86f5727ad99c9fd5-1"></a><span class="nd">@benchmark</span><span class="w"> </span><span class="n">bisection</span><span class="p">(</span><span class="n">fun</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">2.0</span><span class="p">)</span><span class="w"></span>
</pre></div>
<p>con resultado</p>
<div class="code"><pre class="code julia"><a id="rest_code_1df7458ca47b48678ea216e0decf1cee-1" name="rest_code_1df7458ca47b48678ea216e0decf1cee-1" href="posts/numerical_challenge/numerical-01/#rest_code_1df7458ca47b48678ea216e0decf1cee-1"></a><span class="n">BenchmarkTools</span><span class="o">.</span><span class="n">Trial</span><span class="o">:</span><span class="w"></span>
<a id="rest_code_1df7458ca47b48678ea216e0decf1cee-2" name="rest_code_1df7458ca47b48678ea216e0decf1cee-2" href="posts/numerical_challenge/numerical-01/#rest_code_1df7458ca47b48678ea216e0decf1cee-2"></a><span class="w">  </span><span class="n">memory</span><span class="w"> </span><span class="n">estimate</span><span class="o">:</span><span class="w">  </span><span class="mi">48</span><span class="w"> </span><span class="n">bytes</span><span class="w"></span>
<a id="rest_code_1df7458ca47b48678ea216e0decf1cee-3" name="rest_code_1df7458ca47b48678ea216e0decf1cee-3" href="posts/numerical_challenge/numerical-01/#rest_code_1df7458ca47b48678ea216e0decf1cee-3"></a><span class="w">  </span><span class="n">allocs</span><span class="w"> </span><span class="n">estimate</span><span class="o">:</span><span class="w">  </span><span class="mi">2</span><span class="w"></span>
<a id="rest_code_1df7458ca47b48678ea216e0decf1cee-4" name="rest_code_1df7458ca47b48678ea216e0decf1cee-4" href="posts/numerical_challenge/numerical-01/#rest_code_1df7458ca47b48678ea216e0decf1cee-4"></a><span class="w">  </span><span class="o">--------------</span><span class="w"></span>
<a id="rest_code_1df7458ca47b48678ea216e0decf1cee-5" name="rest_code_1df7458ca47b48678ea216e0decf1cee-5" href="posts/numerical_challenge/numerical-01/#rest_code_1df7458ca47b48678ea216e0decf1cee-5"></a><span class="w">  </span><span class="n">minimum</span><span class="w"> </span><span class="n">time</span><span class="o">:</span><span class="w">     </span><span class="mf">1.505</span><span class="w"> </span><span class="n">μs</span><span class="w"> </span><span class="p">(</span><span class="mf">0.00</span><span class="o">%</span><span class="w"> </span><span class="n">GC</span><span class="p">)</span><span class="w"></span>
<a id="rest_code_1df7458ca47b48678ea216e0decf1cee-6" name="rest_code_1df7458ca47b48678ea216e0decf1cee-6" href="posts/numerical_challenge/numerical-01/#rest_code_1df7458ca47b48678ea216e0decf1cee-6"></a><span class="w">  </span><span class="n">median</span><span class="w"> </span><span class="n">time</span><span class="o">:</span><span class="w">      </span><span class="mf">1.548</span><span class="w"> </span><span class="n">μs</span><span class="w"> </span><span class="p">(</span><span class="mf">0.00</span><span class="o">%</span><span class="w"> </span><span class="n">GC</span><span class="p">)</span><span class="w"></span>
<a id="rest_code_1df7458ca47b48678ea216e0decf1cee-7" name="rest_code_1df7458ca47b48678ea216e0decf1cee-7" href="posts/numerical_challenge/numerical-01/#rest_code_1df7458ca47b48678ea216e0decf1cee-7"></a><span class="w">  </span><span class="n">mean</span><span class="w"> </span><span class="n">time</span><span class="o">:</span><span class="w">        </span><span class="mf">1.604</span><span class="w"> </span><span class="n">μs</span><span class="w"> </span><span class="p">(</span><span class="mf">0.00</span><span class="o">%</span><span class="w"> </span><span class="n">GC</span><span class="p">)</span><span class="w"></span>
<a id="rest_code_1df7458ca47b48678ea216e0decf1cee-8" name="rest_code_1df7458ca47b48678ea216e0decf1cee-8" href="posts/numerical_challenge/numerical-01/#rest_code_1df7458ca47b48678ea216e0decf1cee-8"></a><span class="w">  </span><span class="n">maximum</span><span class="w"> </span><span class="n">time</span><span class="o">:</span><span class="w">     </span><span class="mf">38.425</span><span class="w"> </span><span class="n">μs</span><span class="w"> </span><span class="p">(</span><span class="mf">0.00</span><span class="o">%</span><span class="w"> </span><span class="n">GC</span><span class="p">)</span><span class="w"></span>
<a id="rest_code_1df7458ca47b48678ea216e0decf1cee-9" name="rest_code_1df7458ca47b48678ea216e0decf1cee-9" href="posts/numerical_challenge/numerical-01/#rest_code_1df7458ca47b48678ea216e0decf1cee-9"></a><span class="w">  </span><span class="o">--------------</span><span class="w"></span>
<a id="rest_code_1df7458ca47b48678ea216e0decf1cee-10" name="rest_code_1df7458ca47b48678ea216e0decf1cee-10" href="posts/numerical_challenge/numerical-01/#rest_code_1df7458ca47b48678ea216e0decf1cee-10"></a><span class="w">  </span><span class="n">samples</span><span class="o">:</span><span class="w">          </span><span class="mi">10000</span><span class="w"></span>
<a id="rest_code_1df7458ca47b48678ea216e0decf1cee-11" name="rest_code_1df7458ca47b48678ea216e0decf1cee-11" href="posts/numerical_challenge/numerical-01/#rest_code_1df7458ca47b48678ea216e0decf1cee-11"></a><span class="w">  </span><span class="n">evals</span><span class="o">/</span><span class="n">sample</span><span class="o">:</span><span class="w">     </span><span class="mi">10</span><span class="w"></span>
</pre></div>
<p>Parece que la versión de Julia es alrededor de 100 veces más rápida que
su equivalente en Python.</p>
</section></section>
</div>
    </article><article class="post h-entry post-text"><header><h1 class="post-title p-name"><a href="posts/hermite_ritz_qm/" class="u-url">Solución de la ecuación de Schrödinger usando el método de Ritz</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn">Nicolás Guarín-Zapata</span></p>
            <p class="dateline"><a href="posts/hermite_ritz_qm/" rel="bookmark"><time class="post-date published dt-published" datetime="2017-07-11T19:04:57-05:00" title="2017-07-11 19:04">2017-07-11 19:04</time></a></p>
                <p class="commentline">
    
    <a href="posts/hermite_ritz_qm/#disqus_thread" data-disqus-identifier="cache/posts/hermite_ritz_qm.html">Comentarios</a>


        </p>
</div>
    </header><div class="e-content entry-content">
    <p>En esta publicación describimos la solcuión de la ecuación de Schrödinger
usando el método de Ritz y base de
<a class="reference external" href="https://en.wikipedia.org/wiki/Hermite_polynomials#Hermite_functions">funciones de</a>
Esta base parece ser una buena elección para la ecuación de Schrödinger
ya que es una base ortogonal sobre <span class="math">\((-\infty, \infty)\)</span>.</p>
<section id="transformando-la-ecuacion-en-una-algebraica"><h2>Transformando la ecuación en una algebraica</h2>
<p>Queremos resolver la
<a class="reference external" href="https://en.wikipedia.org/wiki/Schr%C3%B6dinger_equation">ecuación de Schrödinger</a>
independiente del tiempo</p>
<div class="math">
\begin{equation*}
\left[-\frac{1}{2}\nabla^2 + V(x)\right] \psi = E\psi\, ,
\end{equation*}
</div>
<p>donde estamos usando
<a class="reference external" href="https://en.wikipedia.org/wiki/Natural_units">unidades naturales</a>
ya que son una buena elección para cálculos numéricos.</p>
<p>Resolver esta ecuación es equivalente a resolver la siguiente
ecuación variacional</p>
<div class="math">
\begin{equation*}
\delta \Pi[\psi] = 0\, ,
\end{equation*}
</div>
<p>con</p>
<div class="math">
\begin{equation*}
\Pi[\psi] = \frac{1}{2} \langle \nabla \psi, \nabla\psi\rangle +
              \langle \psi, V(x) \psi\rangle -
               E\langle \psi, \psi\rangle \, ,
\end{equation*}
</div>
<p>con <span class="math">\(\psi\)</span> la función de onda, <span class="math">\(V(x)\)</span> el potencial y
<span class="math">\(E\)</span> la energía. Esta formulación variacional es equivalente a la
ecuación de Schrödinger independiente del tiempo, y <span class="math">\(E\)</span>
funciona como un multiplicador de Lagrange que garantiza que la
probabilidad sobre todo el dominio sea 1.</p>
<p>Podemos expandir la función de onda en la base ortogonal</p>
<div class="math">
\begin{equation*}
\psi = \sum_{n=0}^N c_n u_n(x)\, ,
\end{equation*}
</div>
<p>donde <span class="math">\(u_n(x) \equiv \mu_n H_n(x) e^{-x^2/2}\)</span> es una función de
Hermite normalizada, <span class="math">\(\mu_n\)</span> es el inverso de la magnitud del
<span class="math">\(n\)</span>-ésimo polinomio de Hermite</p>
<div class="math">
\begin{equation*}
\mu_n = \frac{1}{\sqrt{\pi^{1/2} n! 2^n}}\, ,
\end{equation*}
</div>
<p>y <span class="math">\(c_n\)</span> son los coeficientes de la expansión. Esta representación
es exacta en el límite <span class="math">\(N \rightarrow \infty\)</span>.</p>
<p>Si remplazamos la expansión en el funcional, obtenemos</p>
<div class="math">
\begin{equation*}
\Pi_N = \sum_{m=0}^N\sum_{n=0}^N c_m c_n\left[
          \frac{1}{2} \langle \nabla u_m, \nabla u_n\rangle +
          \langle u_m, V(x) u_n\rangle -
          E^N \delta_{mn}\right]\, .
\end{equation*}
</div>
<p>El integrando que involucra las dos derivadas sería</p>
<div class="math">
\begin{align*}
u_m' u_n' =&amp; \left[2m \frac{\mu_{m-1}}{\mu_m}u_{m-1} - x u_m\right]
            \left[2n \frac{\mu_{n-1}}{\mu_n}u_{n-1} - x u_n\right]\\
          =&amp; 4mn\frac{\mu_{m-1} \mu_{n-1}}{\mu_m \mu_n} u_{n-1} u_{m-1}
           - 2m\frac{\mu_{m-1}}{\mu_{m}}x u_{m-1} u_n\\
           &amp;- 2n\frac{\mu_{n-1}}{\mu_{n}}x u_{n-1} u_m + x^2 u_m u_n
\end{align*}
</div>
<p>Entonces, el término de la energía cinética sería</p>
<div class="math">
\begin{align*}
\langle \nabla u_m, \nabla u_n \rangle =&amp;
    4mn\frac{\mu_{m-1} \mu_{n-1}}{\mu_m \mu_n} \langle u_{n-1}, u_{m-1}\rangle
    - 2m\frac{\mu_{m-1}}{\mu_{m}} \langle u_{m-1}, x u_n\rangle\\
    &amp;- 2n\frac{\mu_{n-1}}{\mu_{n}} \langle u_{m}, x u_{n - 1}\rangle
     + \langle u_m, x^2 u_n\rangle\\
    =&amp; 4mn \frac{\mu_{m-1}^2}{\mu_m^2}\delta_{mn} -
      2m \frac{\mu_{m-1}}{\mu_m} \alpha_{m-1, n} -
      2n \frac{\mu_{n-1}}{\mu_n} \alpha_{m, n-1} + \beta_{mn} \, ,
\end{align*}
</div>
<p>con</p>
<div class="math">
\begin{equation*}
\alpha_{m,n} \equiv \langle u_{m}, x u_n\rangle = \begin{cases}
\sqrt{\frac{n + 1}{2}} &amp; m=n +1\\
\sqrt{\frac{n}{2}} &amp; m=n - 1\\
0 &amp; \text{otherwise}\end{cases}\, ,
\end{equation*}
</div>
<p>y</p>
<div class="math">
\begin{equation*}
\beta_{m,n} \equiv \langle u_{m}, x^2 u_n\rangle = \begin{cases}
\frac{\sqrt{n(n-1)}}{2} &amp; m = n - 2\\
\frac{2n + 1}{2} &amp; m = n \\
\frac{\sqrt{(n+1)(n+1)}}{2} &amp; m = n + 2 \\
0 &amp; \text{otherwise}\end{cases}\, .
\end{equation*}
</div>
<p>El funcional se reescribe como</p>
<div class="math">
\begin{align*}
\Pi_N =&amp; \sum_{m=0}^N \sum_{n=0}^N c_m c_n
  \left[2mn \frac{\mu^2_{m-1}}{\mu^2_m}\delta_{mn}
  - m\frac{\mu_{m-1}}{\mu_m}\alpha_{m - 1, n}
  - n\frac{\mu_{n-1}}{\mu_n}\delta_{m, n-1} \right.\nonumber \\
  &amp;\left. - \frac{1}{2}\beta_{mn} + \langle u_m, V(x) u_n\rangle
  - E^N \delta_{mn}\right] \, .
\end{align*}
</div>
<p>Tomando la variación</p>
<div class="math">
\begin{equation*}
\delta \Pi_N = 0\, ,
\end{equation*}
</div>
<p>que en este caso es equivalente a</p>
<div class="math">
\begin{equation*}
\frac{\partial \Pi_N}{\partial c_i} = 0\quad \forall i=0, 1, \cdots N\, ,
\end{equation*}
</div>
<p>lleva a</p>
<div class="math">
\begin{equation*}
[H]\lbrace c\rbrace = E^N\lbrace c\rbrace \, ,
\end{equation*}
</div>
<p>donde las componentes de la matriz <span class="math">\([H]\)</span> están dadas por</p>
<div class="math">
\begin{equation*}
H_{mn} = 2mn \frac{\mu^2_{m-1}}{\mu^2_m}\delta_{mn}
  - m\frac{\mu_{m-1}}{\mu_m}\alpha_{m - 1, n}
  - n\frac{\mu_{n-1}}{\mu_n}\delta_{m, n-1}
  - \frac{1}{2}\beta_{mn} + \langle u_m, V(x) u_n\rangle\, .
\end{equation*}
</div>
<p>La última integral se puede calcular usando la
<a class="reference external" href="https://en.wikipedia.org/wiki/Gauss%E2%80%93Hermite_quadrature">cuadratura de Gauss-Hermite</a>.
Y necesitaremos más puntos de Gauss si queremos integrar polinomios
de orden alto. Este método funciona bien para funciones que pueden
ser aproximadas por polinomios.</p>
</section><section id="ejemplos"><h2>Ejemplos</h2>
<p>Una implementación en Python de este método se puede encontrar en
<a class="reference external" href="https://github.com/nicoguaro/FEM_resources/blob/master/quantum_mechanics/hermite_QM.py">este repo</a>.</p>
<p>Para todos los ejemplos usamos las siguientes importaciones</p>
<div class="code"><pre class="code ipython"><a id="rest_code_7084eb4bde024ccc907b90379f4dd333-1" name="rest_code_7084eb4bde024ccc907b90379f4dd333-1" href="posts/hermite_ritz_qm/#rest_code_7084eb4bde024ccc907b90379f4dd333-1"></a><span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">division</span><span class="p">,</span> <span class="n">print_function</span>
<a id="rest_code_7084eb4bde024ccc907b90379f4dd333-2" name="rest_code_7084eb4bde024ccc907b90379f4dd333-2" href="posts/hermite_ritz_qm/#rest_code_7084eb4bde024ccc907b90379f4dd333-2"></a><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<a id="rest_code_7084eb4bde024ccc907b90379f4dd333-3" name="rest_code_7084eb4bde024ccc907b90379f4dd333-3" href="posts/hermite_ritz_qm/#rest_code_7084eb4bde024ccc907b90379f4dd333-3"></a><span class="kn">from</span> <span class="nn">hermite_QM</span> <span class="kn">import</span> <span class="o">*</span>
</pre></div>
<section id="oscilador-armonico-cuantico-1"><h3><a class="reference external" href="https://en.wikipedia.org/wiki/Quantum_harmonic_oscillator">Oscilador armónico cuántico</a></h3>
<p>En este caso el potencial (normalizado) está dado por</p>
<div class="math">
\begin{equation*}
V(x) = \frac{1}{2} x^2
\end{equation*}
</div>
<p>y los valores propios exactos normalizados son</p>
<div class="math">
\begin{equation*}
E_n = n + \frac{1}{2}
\end{equation*}
</div>
<p>El siguiente bloque de código calcula los primeros 10 valores propios
y grafica los estados propios correspondientes</p>
<div class="code"><pre class="code ipython"><a id="rest_code_203c42c62ed34fbdb4ec61b10923abda-1" name="rest_code_203c42c62ed34fbdb4ec61b10923abda-1" href="posts/hermite_ritz_qm/#rest_code_203c42c62ed34fbdb4ec61b10923abda-1"></a><span class="n">potential</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span>
<a id="rest_code_203c42c62ed34fbdb4ec61b10923abda-2" name="rest_code_203c42c62ed34fbdb4ec61b10923abda-2" href="posts/hermite_ritz_qm/#rest_code_203c42c62ed34fbdb4ec61b10923abda-2"></a><span class="n">vals</span><span class="p">,</span> <span class="n">vecs</span> <span class="o">=</span> <span class="n">eigenstates</span><span class="p">(</span><span class="n">potential</span><span class="p">,</span> <span class="n">nterms</span><span class="o">=</span><span class="mi">11</span><span class="p">,</span> <span class="n">ngpts</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<a id="rest_code_203c42c62ed34fbdb4ec61b10923abda-3" name="rest_code_203c42c62ed34fbdb4ec61b10923abda-3" href="posts/hermite_ritz_qm/#rest_code_203c42c62ed34fbdb4ec61b10923abda-3"></a><span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">vals</span><span class="p">[:</span><span class="mi">10</span><span class="p">],</span> <span class="mi">6</span><span class="p">))</span>
<a id="rest_code_203c42c62ed34fbdb4ec61b10923abda-4" name="rest_code_203c42c62ed34fbdb4ec61b10923abda-4" href="posts/hermite_ritz_qm/#rest_code_203c42c62ed34fbdb4ec61b10923abda-4"></a><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<a id="rest_code_203c42c62ed34fbdb4ec61b10923abda-5" name="rest_code_203c42c62ed34fbdb4ec61b10923abda-5" href="posts/hermite_ritz_qm/#rest_code_203c42c62ed34fbdb4ec61b10923abda-5"></a><span class="n">plot_eigenstates</span><span class="p">(</span><span class="n">vals</span><span class="p">,</span> <span class="n">vecs</span><span class="p">,</span> <span class="n">potential</span><span class="p">);</span>
</pre></div>
<p>con resultados</p>
<div class="code"><pre class="code text"><a id="rest_code_deba8c6f58234e5d8b7008e92ea918c1-1" name="rest_code_deba8c6f58234e5d8b7008e92ea918c1-1" href="posts/hermite_ritz_qm/#rest_code_deba8c6f58234e5d8b7008e92ea918c1-1"></a>[ 0.5  1.5  2.5  3.5  4.5  5.5  6.5  7.5  8.5  9.5]
</pre></div>
<img alt="/images/hermite_ritz_harmonic.svg" src="../images/hermite_ritz_harmonic.svg"></section><section id="potencial-de-valor-absoluto"><h3>Potencial de valor absoluto</h3>
<div class="code"><pre class="code ipython"><a id="rest_code_5e315a7bfedc4b6680e07403280d3fed-1" name="rest_code_5e315a7bfedc4b6680e07403280d3fed-1" href="posts/hermite_ritz_qm/#rest_code_5e315a7bfedc4b6680e07403280d3fed-1"></a><span class="n">potential</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a id="rest_code_5e315a7bfedc4b6680e07403280d3fed-2" name="rest_code_5e315a7bfedc4b6680e07403280d3fed-2" href="posts/hermite_ritz_qm/#rest_code_5e315a7bfedc4b6680e07403280d3fed-2"></a><span class="n">vals</span><span class="p">,</span> <span class="n">vecs</span> <span class="o">=</span> <span class="n">eigenstates</span><span class="p">(</span><span class="n">potential</span><span class="p">)</span>
<a id="rest_code_5e315a7bfedc4b6680e07403280d3fed-3" name="rest_code_5e315a7bfedc4b6680e07403280d3fed-3" href="posts/hermite_ritz_qm/#rest_code_5e315a7bfedc4b6680e07403280d3fed-3"></a><span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">vals</span><span class="p">[:</span><span class="mi">10</span><span class="p">],</span> <span class="mi">6</span><span class="p">))</span>
<a id="rest_code_5e315a7bfedc4b6680e07403280d3fed-4" name="rest_code_5e315a7bfedc4b6680e07403280d3fed-4" href="posts/hermite_ritz_qm/#rest_code_5e315a7bfedc4b6680e07403280d3fed-4"></a><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<a id="rest_code_5e315a7bfedc4b6680e07403280d3fed-5" name="rest_code_5e315a7bfedc4b6680e07403280d3fed-5" href="posts/hermite_ritz_qm/#rest_code_5e315a7bfedc4b6680e07403280d3fed-5"></a><span class="n">plot_eigenstates</span><span class="p">(</span><span class="n">vals</span><span class="p">,</span> <span class="n">vecs</span><span class="p">,</span> <span class="n">potential</span><span class="p">,</span> <span class="n">lims</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">));</span>
</pre></div>
<p>con resultados</p>
<div class="code"><pre class="code text"><a id="rest_code_a63b9014ee2d45afb9db895f5c22b1b7-1" name="rest_code_a63b9014ee2d45afb9db895f5c22b1b7-1" href="posts/hermite_ritz_qm/#rest_code_a63b9014ee2d45afb9db895f5c22b1b7-1"></a>[ 0.811203  1.855725  2.57894   3.244576  3.826353  4.38189   4.895365
<a id="rest_code_a63b9014ee2d45afb9db895f5c22b1b7-2" name="rest_code_a63b9014ee2d45afb9db895f5c22b1b7-2" href="posts/hermite_ritz_qm/#rest_code_a63b9014ee2d45afb9db895f5c22b1b7-2"></a>  5.396614  5.911591  6.421015]
</pre></div>
<img alt="/images/hermite_ritz_abs.svg" src="../images/hermite_ritz_abs.svg"></section><section id="potencial-cubico"><h3>Potencial cúbico</h3>
<div class="code"><pre class="code ipython"><a id="rest_code_345385cc137a4dfb9dbf91633988b55e-1" name="rest_code_345385cc137a4dfb9dbf91633988b55e-1" href="posts/hermite_ritz_qm/#rest_code_345385cc137a4dfb9dbf91633988b55e-1"></a><span class="n">potential</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">x</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span><span class="o">**</span><span class="mi">3</span>
<a id="rest_code_345385cc137a4dfb9dbf91633988b55e-2" name="rest_code_345385cc137a4dfb9dbf91633988b55e-2" href="posts/hermite_ritz_qm/#rest_code_345385cc137a4dfb9dbf91633988b55e-2"></a><span class="n">vals</span><span class="p">,</span> <span class="n">vecs</span> <span class="o">=</span> <span class="n">eigenstates</span><span class="p">(</span><span class="n">potential</span><span class="p">)</span>
<a id="rest_code_345385cc137a4dfb9dbf91633988b55e-3" name="rest_code_345385cc137a4dfb9dbf91633988b55e-3" href="posts/hermite_ritz_qm/#rest_code_345385cc137a4dfb9dbf91633988b55e-3"></a><span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">vals</span><span class="p">[:</span><span class="mi">10</span><span class="p">],</span> <span class="mi">6</span><span class="p">))</span>
<a id="rest_code_345385cc137a4dfb9dbf91633988b55e-4" name="rest_code_345385cc137a4dfb9dbf91633988b55e-4" href="posts/hermite_ritz_qm/#rest_code_345385cc137a4dfb9dbf91633988b55e-4"></a><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<a id="rest_code_345385cc137a4dfb9dbf91633988b55e-5" name="rest_code_345385cc137a4dfb9dbf91633988b55e-5" href="posts/hermite_ritz_qm/#rest_code_345385cc137a4dfb9dbf91633988b55e-5"></a><span class="n">plot_eigenstates</span><span class="p">(</span><span class="n">vals</span><span class="p">,</span> <span class="n">vecs</span><span class="p">,</span> <span class="n">potential</span><span class="p">,</span> <span class="n">lims</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">));</span>
</pre></div>
<p>con resultados</p>
<div class="code"><pre class="code text"><a id="rest_code_e12e45f63b314b57b1ca5ba528b5fa00-1" name="rest_code_e12e45f63b314b57b1ca5ba528b5fa00-1" href="posts/hermite_ritz_qm/#rest_code_e12e45f63b314b57b1ca5ba528b5fa00-1"></a>[ 0.180588  0.609153  1.124594  1.681002  2.272087  2.889805  3.530901
<a id="rest_code_e12e45f63b314b57b1ca5ba528b5fa00-2" name="rest_code_e12e45f63b314b57b1ca5ba528b5fa00-2" href="posts/hermite_ritz_qm/#rest_code_e12e45f63b314b57b1ca5ba528b5fa00-2"></a>  4.191962  4.871133  5.566413]
</pre></div>
<img alt="/images/hermite_ritz_cubic.svg" src="../images/hermite_ritz_cubic.svg"></section><section id="oscilador-armonico-con-perturbacion-cuartica"><h3>Oscilador armónico con perturbación cuártica</h3>
<div class="code"><pre class="code ipython"><a id="rest_code_1fca57adb1b5402da6885df286296cc1-1" name="rest_code_1fca57adb1b5402da6885df286296cc1-1" href="posts/hermite_ritz_qm/#rest_code_1fca57adb1b5402da6885df286296cc1-1"></a><span class="n">potential</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mf">0.1</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">4</span>
<a id="rest_code_1fca57adb1b5402da6885df286296cc1-2" name="rest_code_1fca57adb1b5402da6885df286296cc1-2" href="posts/hermite_ritz_qm/#rest_code_1fca57adb1b5402da6885df286296cc1-2"></a><span class="n">vals</span><span class="p">,</span> <span class="n">vecs</span> <span class="o">=</span> <span class="n">eigenstates</span><span class="p">(</span><span class="n">potential</span><span class="p">,</span> <span class="n">nterms</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">ngpts</span><span class="o">=</span><span class="mi">22</span><span class="p">)</span>
<a id="rest_code_1fca57adb1b5402da6885df286296cc1-3" name="rest_code_1fca57adb1b5402da6885df286296cc1-3" href="posts/hermite_ritz_qm/#rest_code_1fca57adb1b5402da6885df286296cc1-3"></a><span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">vals</span><span class="p">[:</span><span class="mi">10</span><span class="p">],</span> <span class="mi">6</span><span class="p">))</span>
<a id="rest_code_1fca57adb1b5402da6885df286296cc1-4" name="rest_code_1fca57adb1b5402da6885df286296cc1-4" href="posts/hermite_ritz_qm/#rest_code_1fca57adb1b5402da6885df286296cc1-4"></a><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<a id="rest_code_1fca57adb1b5402da6885df286296cc1-5" name="rest_code_1fca57adb1b5402da6885df286296cc1-5" href="posts/hermite_ritz_qm/#rest_code_1fca57adb1b5402da6885df286296cc1-5"></a><span class="n">plot_eigenstates</span><span class="p">(</span><span class="n">vals</span><span class="p">,</span> <span class="n">vecs</span><span class="p">,</span> <span class="n">potential</span><span class="p">,</span> <span class="n">lims</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
</pre></div>
<p>con resultados</p>
<div class="code"><pre class="code text"><a id="rest_code_3d2f1306129048c2b1c907f2d3122664-1" name="rest_code_3d2f1306129048c2b1c907f2d3122664-1" href="posts/hermite_ritz_qm/#rest_code_3d2f1306129048c2b1c907f2d3122664-1"></a>[  0.559146   1.769503   3.138624   4.628884   6.220303   7.899789
<a id="rest_code_3d2f1306129048c2b1c907f2d3122664-2" name="rest_code_3d2f1306129048c2b1c907f2d3122664-2" href="posts/hermite_ritz_qm/#rest_code_3d2f1306129048c2b1c907f2d3122664-2"></a>   9.658703  11.489094  13.38638   15.361055]
</pre></div>
<img alt="/images/hermite_ritz_pert_harm.svg" src="../images/hermite_ritz_pert_harm.svg"><p>Un notebook de Jupyter con los ejemplos se puede encontrar
<a class="reference external" href="https://github.com/nicoguaro/FEM_resources/blob/master/quantum_mechanics/Ritz_Hermite_QM.ipynb">acá</a>.</p>
</section></section>
</div>
    </article><article class="post h-entry post-text"><header><h1 class="post-title p-name"><a href="posts/matplotlib_styles/" class="u-url">Usando estilos predefinidos en matplotlib</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn">Nicolás Guarín-Zapata</span></p>
            <p class="dateline"><a href="posts/matplotlib_styles/" rel="bookmark"><time class="post-date published dt-published" datetime="2017-06-27T17:14:14-05:00" title="2017-06-27 17:14">2017-06-27 17:14</time></a></p>
                <p class="commentline">
    
    <a href="posts/matplotlib_styles/#disqus_thread" data-disqus-identifier="cache/posts/matplotlib_styles.html">Comentarios</a>


        </p>
</div>
    </header><div class="e-content entry-content">
    <p>Podemos dar formato a los gráficos de forma simple usando el
<a class="reference external" href="http://matplotlib.org/users/customizing.html">paquete de estilo</a>
en matplotlib. La idea principal es craar un archivo con algunos
parámetros predefinidos (esto también puede hacerse a través de
<cite>rcParams</cite>).</p>
<p>Esta publicación no es un tutorial en cómo usar estos archivos, para
estos puedes mirar la página
<a class="reference external" href="http://matplotlib.org/examples/style_sheets/style_sheets_reference.html">style sheet reference</a>.
Acá, quiere jugar un poco con algunos de los parámetors para crear tres
estilos diferentes. Los primeros dos tienen el estilo de un software
(infame para algunos), que es usado por la mayoría de personas como
su plataforma de visualización, el terecero es un estilo limpio. Todos
los archivos usados se pueden descargar
<a class="reference external" href="https://github.com/nicoguaro/matplotlib_styles">aquí</a>.</p>
<p>Para todos los ejemplos se realizan las siguientes importaciones:</p>
<div class="code"><pre class="code python"><a id="rest_code_b1f6c980546c4af0ae764264cfeae3a9-1" name="rest_code_b1f6c980546c4af0ae764264cfeae3a9-1" href="posts/matplotlib_styles/#rest_code_b1f6c980546c4af0ae764264cfeae3a9-1"></a><span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">division</span><span class="p">,</span> <span class="n">print_function</span>
<a id="rest_code_b1f6c980546c4af0ae764264cfeae3a9-2" name="rest_code_b1f6c980546c4af0ae764264cfeae3a9-2" href="posts/matplotlib_styles/#rest_code_b1f6c980546c4af0ae764264cfeae3a9-2"></a><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<a id="rest_code_b1f6c980546c4af0ae764264cfeae3a9-3" name="rest_code_b1f6c980546c4af0ae764264cfeae3a9-3" href="posts/matplotlib_styles/#rest_code_b1f6c980546c4af0ae764264cfeae3a9-3"></a><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</pre></div>
<section id="primer-ejemplo-ms-2003"><h2>Primer ejemplo: MS 2003</h2>
<p>En nuestro primer ejemplo queremos reproducir el estilo que solíamos
ver como la opción por defecto hace más de una década.</p>
<p>Este es el contenido del archivo
<a class="reference external" href="https://github.com/nicoguaro/matplotlib_styles/blob/master/styles/MS2003.mplstyle">MS2003.mplstyle</a></p>
<div class="code"><pre class="code python"><a id="rest_code_6b64f77b43ac40a2891dd19685f5dfd8-1" name="rest_code_6b64f77b43ac40a2891dd19685f5dfd8-1" href="posts/matplotlib_styles/#rest_code_6b64f77b43ac40a2891dd19685f5dfd8-1"></a><span class="n">font</span><span class="o">.</span><span class="n">family</span> <span class="p">:</span> <span class="n">sans</span><span class="o">-</span><span class="n">serif</span>
<a id="rest_code_6b64f77b43ac40a2891dd19685f5dfd8-2" name="rest_code_6b64f77b43ac40a2891dd19685f5dfd8-2" href="posts/matplotlib_styles/#rest_code_6b64f77b43ac40a2891dd19685f5dfd8-2"></a>
<a id="rest_code_6b64f77b43ac40a2891dd19685f5dfd8-3" name="rest_code_6b64f77b43ac40a2891dd19685f5dfd8-3" href="posts/matplotlib_styles/#rest_code_6b64f77b43ac40a2891dd19685f5dfd8-3"></a><span class="n">axes</span><span class="o">.</span><span class="n">facecolor</span> <span class="p">:</span> <span class="n">c0c0c0</span>
<a id="rest_code_6b64f77b43ac40a2891dd19685f5dfd8-4" name="rest_code_6b64f77b43ac40a2891dd19685f5dfd8-4" href="posts/matplotlib_styles/#rest_code_6b64f77b43ac40a2891dd19685f5dfd8-4"></a><span class="n">axes</span><span class="o">.</span><span class="n">edgecolor</span> <span class="p">:</span> <span class="n">black</span>
<a id="rest_code_6b64f77b43ac40a2891dd19685f5dfd8-5" name="rest_code_6b64f77b43ac40a2891dd19685f5dfd8-5" href="posts/matplotlib_styles/#rest_code_6b64f77b43ac40a2891dd19685f5dfd8-5"></a><span class="n">axes</span><span class="o">.</span><span class="n">prop_cycle</span> <span class="p">:</span> <span class="n">cycler</span><span class="p">(</span><span class="s1">'color'</span><span class="p">,[</span><span class="s1">'000080'</span><span class="p">,</span> <span class="s1">'FF00FF'</span><span class="p">,</span> <span class="s1">'FFFF00'</span><span class="p">,</span> <span class="s1">'00FFFF'</span><span class="p">,</span><span class="s1">'800080'</span><span class="p">,</span> <span class="s1">'800000'</span><span class="p">,</span> <span class="s1">'008080'</span><span class="p">,</span> <span class="s1">'0000FF'</span><span class="p">])</span>
<a id="rest_code_6b64f77b43ac40a2891dd19685f5dfd8-6" name="rest_code_6b64f77b43ac40a2891dd19685f5dfd8-6" href="posts/matplotlib_styles/#rest_code_6b64f77b43ac40a2891dd19685f5dfd8-6"></a><span class="n">axes</span><span class="o">.</span><span class="n">grid</span> <span class="p">:</span> <span class="kc">True</span>
<a id="rest_code_6b64f77b43ac40a2891dd19685f5dfd8-7" name="rest_code_6b64f77b43ac40a2891dd19685f5dfd8-7" href="posts/matplotlib_styles/#rest_code_6b64f77b43ac40a2891dd19685f5dfd8-7"></a>
<a id="rest_code_6b64f77b43ac40a2891dd19685f5dfd8-8" name="rest_code_6b64f77b43ac40a2891dd19685f5dfd8-8" href="posts/matplotlib_styles/#rest_code_6b64f77b43ac40a2891dd19685f5dfd8-8"></a><span class="n">axes</span><span class="o">.</span><span class="n">spines</span><span class="o">.</span><span class="n">left</span>   <span class="p">:</span> <span class="kc">True</span>
<a id="rest_code_6b64f77b43ac40a2891dd19685f5dfd8-9" name="rest_code_6b64f77b43ac40a2891dd19685f5dfd8-9" href="posts/matplotlib_styles/#rest_code_6b64f77b43ac40a2891dd19685f5dfd8-9"></a><span class="n">axes</span><span class="o">.</span><span class="n">spines</span><span class="o">.</span><span class="n">bottom</span> <span class="p">:</span> <span class="kc">True</span>
<a id="rest_code_6b64f77b43ac40a2891dd19685f5dfd8-10" name="rest_code_6b64f77b43ac40a2891dd19685f5dfd8-10" href="posts/matplotlib_styles/#rest_code_6b64f77b43ac40a2891dd19685f5dfd8-10"></a><span class="n">axes</span><span class="o">.</span><span class="n">spines</span><span class="o">.</span><span class="n">top</span>    <span class="p">:</span> <span class="kc">True</span>
<a id="rest_code_6b64f77b43ac40a2891dd19685f5dfd8-11" name="rest_code_6b64f77b43ac40a2891dd19685f5dfd8-11" href="posts/matplotlib_styles/#rest_code_6b64f77b43ac40a2891dd19685f5dfd8-11"></a><span class="n">axes</span><span class="o">.</span><span class="n">spines</span><span class="o">.</span><span class="n">right</span>  <span class="p">:</span> <span class="kc">True</span>
<a id="rest_code_6b64f77b43ac40a2891dd19685f5dfd8-12" name="rest_code_6b64f77b43ac40a2891dd19685f5dfd8-12" href="posts/matplotlib_styles/#rest_code_6b64f77b43ac40a2891dd19685f5dfd8-12"></a>
<a id="rest_code_6b64f77b43ac40a2891dd19685f5dfd8-13" name="rest_code_6b64f77b43ac40a2891dd19685f5dfd8-13" href="posts/matplotlib_styles/#rest_code_6b64f77b43ac40a2891dd19685f5dfd8-13"></a><span class="n">grid</span><span class="o">.</span><span class="n">color</span> <span class="p">:</span> <span class="n">black</span>
<a id="rest_code_6b64f77b43ac40a2891dd19685f5dfd8-14" name="rest_code_6b64f77b43ac40a2891dd19685f5dfd8-14" href="posts/matplotlib_styles/#rest_code_6b64f77b43ac40a2891dd19685f5dfd8-14"></a><span class="n">grid</span><span class="o">.</span><span class="n">linestyle</span> <span class="p">:</span> <span class="o">-</span>
<a id="rest_code_6b64f77b43ac40a2891dd19685f5dfd8-15" name="rest_code_6b64f77b43ac40a2891dd19685f5dfd8-15" href="posts/matplotlib_styles/#rest_code_6b64f77b43ac40a2891dd19685f5dfd8-15"></a>
<a id="rest_code_6b64f77b43ac40a2891dd19685f5dfd8-16" name="rest_code_6b64f77b43ac40a2891dd19685f5dfd8-16" href="posts/matplotlib_styles/#rest_code_6b64f77b43ac40a2891dd19685f5dfd8-16"></a><span class="n">lines</span><span class="o">.</span><span class="n">linewidth</span> <span class="p">:</span> <span class="mi">1</span>
<a id="rest_code_6b64f77b43ac40a2891dd19685f5dfd8-17" name="rest_code_6b64f77b43ac40a2891dd19685f5dfd8-17" href="posts/matplotlib_styles/#rest_code_6b64f77b43ac40a2891dd19685f5dfd8-17"></a>
<a id="rest_code_6b64f77b43ac40a2891dd19685f5dfd8-18" name="rest_code_6b64f77b43ac40a2891dd19685f5dfd8-18" href="posts/matplotlib_styles/#rest_code_6b64f77b43ac40a2891dd19685f5dfd8-18"></a><span class="n">figure</span><span class="o">.</span><span class="n">figsize</span> <span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">3</span>
<a id="rest_code_6b64f77b43ac40a2891dd19685f5dfd8-19" name="rest_code_6b64f77b43ac40a2891dd19685f5dfd8-19" href="posts/matplotlib_styles/#rest_code_6b64f77b43ac40a2891dd19685f5dfd8-19"></a>
<a id="rest_code_6b64f77b43ac40a2891dd19685f5dfd8-20" name="rest_code_6b64f77b43ac40a2891dd19685f5dfd8-20" href="posts/matplotlib_styles/#rest_code_6b64f77b43ac40a2891dd19685f5dfd8-20"></a><span class="n">legend</span><span class="o">.</span><span class="n">fancybox</span> <span class="p">:</span> <span class="kc">False</span>
<a id="rest_code_6b64f77b43ac40a2891dd19685f5dfd8-21" name="rest_code_6b64f77b43ac40a2891dd19685f5dfd8-21" href="posts/matplotlib_styles/#rest_code_6b64f77b43ac40a2891dd19685f5dfd8-21"></a><span class="n">legend</span><span class="o">.</span><span class="n">frameon</span> <span class="p">:</span> <span class="kc">True</span>
<a id="rest_code_6b64f77b43ac40a2891dd19685f5dfd8-22" name="rest_code_6b64f77b43ac40a2891dd19685f5dfd8-22" href="posts/matplotlib_styles/#rest_code_6b64f77b43ac40a2891dd19685f5dfd8-22"></a><span class="n">legend</span><span class="o">.</span><span class="n">facecolor</span> <span class="p">:</span> <span class="n">white</span>
<a id="rest_code_6b64f77b43ac40a2891dd19685f5dfd8-23" name="rest_code_6b64f77b43ac40a2891dd19685f5dfd8-23" href="posts/matplotlib_styles/#rest_code_6b64f77b43ac40a2891dd19685f5dfd8-23"></a><span class="n">legend</span><span class="o">.</span><span class="n">edgecolor</span> <span class="p">:</span> <span class="n">black</span>
<a id="rest_code_6b64f77b43ac40a2891dd19685f5dfd8-24" name="rest_code_6b64f77b43ac40a2891dd19685f5dfd8-24" href="posts/matplotlib_styles/#rest_code_6b64f77b43ac40a2891dd19685f5dfd8-24"></a><span class="n">legend</span><span class="o">.</span><span class="n">loc</span> <span class="p">:</span> <span class="n">center</span> <span class="n">left</span>
</pre></div>
<p>El siguiente bloque de código usa este estilo</p>
<div class="code"><pre class="code python"><a id="rest_code_55fb602ed7da4fa3b6ef3cf0c24928ec-1" name="rest_code_55fb602ed7da4fa3b6ef3cf0c24928ec-1" href="posts/matplotlib_styles/#rest_code_55fb602ed7da4fa3b6ef3cf0c24928ec-1"></a><span class="n">style</span> <span class="o">=</span> <span class="s2">"MS2003.mplstyle"</span>
<a id="rest_code_55fb602ed7da4fa3b6ef3cf0c24928ec-2" name="rest_code_55fb602ed7da4fa3b6ef3cf0c24928ec-2" href="posts/matplotlib_styles/#rest_code_55fb602ed7da4fa3b6ef3cf0c24928ec-2"></a><span class="k">with</span> <span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">context</span><span class="p">(</span><span class="n">style</span><span class="p">):</span>
<a id="rest_code_55fb602ed7da4fa3b6ef3cf0c24928ec-3" name="rest_code_55fb602ed7da4fa3b6ef3cf0c24928ec-3" href="posts/matplotlib_styles/#rest_code_55fb602ed7da4fa3b6ef3cf0c24928ec-3"></a>    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<a id="rest_code_55fb602ed7da4fa3b6ef3cf0c24928ec-4" name="rest_code_55fb602ed7da4fa3b6ef3cf0c24928ec-4" href="posts/matplotlib_styles/#rest_code_55fb602ed7da4fa3b6ef3cf0c24928ec-4"></a>    <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mf">1e-6</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mf">1e-6</span><span class="p">)</span>
<a id="rest_code_55fb602ed7da4fa3b6ef3cf0c24928ec-5" name="rest_code_55fb602ed7da4fa3b6ef3cf0c24928ec-5" href="posts/matplotlib_styles/#rest_code_55fb602ed7da4fa3b6ef3cf0c24928ec-5"></a>    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<a id="rest_code_55fb602ed7da4fa3b6ef3cf0c24928ec-6" name="rest_code_55fb602ed7da4fa3b6ef3cf0c24928ec-6" href="posts/matplotlib_styles/#rest_code_55fb602ed7da4fa3b6ef3cf0c24928ec-6"></a>    <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>
<a id="rest_code_55fb602ed7da4fa3b6ef3cf0c24928ec-7" name="rest_code_55fb602ed7da4fa3b6ef3cf0c24928ec-7" href="posts/matplotlib_styles/#rest_code_55fb602ed7da4fa3b6ef3cf0c24928ec-7"></a>    <span class="k">for</span> <span class="n">cont</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>
<a id="rest_code_55fb602ed7da4fa3b6ef3cf0c24928ec-8" name="rest_code_55fb602ed7da4fa3b6ef3cf0c24928ec-8" href="posts/matplotlib_styles/#rest_code_55fb602ed7da4fa3b6ef3cf0c24928ec-8"></a>        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="o">/</span><span class="p">(</span><span class="n">cont</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="n">cont</span><span class="p">)</span>
<a id="rest_code_55fb602ed7da4fa3b6ef3cf0c24928ec-9" name="rest_code_55fb602ed7da4fa3b6ef3cf0c24928ec-9" href="posts/matplotlib_styles/#rest_code_55fb602ed7da4fa3b6ef3cf0c24928ec-9"></a>
<a id="rest_code_55fb602ed7da4fa3b6ef3cf0c24928ec-10" name="rest_code_55fb602ed7da4fa3b6ef3cf0c24928ec-10" href="posts/matplotlib_styles/#rest_code_55fb602ed7da4fa3b6ef3cf0c24928ec-10"></a>    <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
<a id="rest_code_55fb602ed7da4fa3b6ef3cf0c24928ec-11" name="rest_code_55fb602ed7da4fa3b6ef3cf0c24928ec-11" href="posts/matplotlib_styles/#rest_code_55fb602ed7da4fa3b6ef3cf0c24928ec-11"></a>    <span class="n">box</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_position</span><span class="p">()</span>
<a id="rest_code_55fb602ed7da4fa3b6ef3cf0c24928ec-12" name="rest_code_55fb602ed7da4fa3b6ef3cf0c24928ec-12" href="posts/matplotlib_styles/#rest_code_55fb602ed7da4fa3b6ef3cf0c24928ec-12"></a>    <span class="n">ax</span><span class="o">.</span><span class="n">set_position</span><span class="p">([</span><span class="n">box</span><span class="o">.</span><span class="n">x0</span><span class="p">,</span> <span class="n">box</span><span class="o">.</span><span class="n">y0</span><span class="p">,</span> <span class="n">box</span><span class="o">.</span><span class="n">width</span> <span class="o">*</span> <span class="mf">0.8</span><span class="p">,</span> <span class="n">box</span><span class="o">.</span><span class="n">height</span><span class="p">])</span>
<a id="rest_code_55fb602ed7da4fa3b6ef3cf0c24928ec-13" name="rest_code_55fb602ed7da4fa3b6ef3cf0c24928ec-13" href="posts/matplotlib_styles/#rest_code_55fb602ed7da4fa3b6ef3cf0c24928ec-13"></a>    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">))</span>
</pre></div>
<p>y este es el resultado</p>
<img alt="/images/MS2003_style.svg" src="../images/MS2003_style.svg"></section><section id="segundo-ejemplo-ms-2007"><h2>Segundo ejemplo: MS 2007</h2>
<p>En el segundo ejemplo queremos reproducir la prole del primer estilo
en este ejemplo. Este estilo es una mejora respecto al anterior,
pero <a class="reference external" href="http://analyticsdemystified.com/excel-tips/data-visualization-that-is-color-blind-friendly-excel-2007/">no es perfecto</a>.</p>
<p>El siguiente es el contenido del archivo
<a class="reference external" href="https://github.com/nicoguaro/matplotlib_styles/blob/master/styles/MS2007.mplstyle">MS2007.mplstyle</a></p>
<div class="code"><pre class="code python"><a id="rest_code_7b465ed20fcb4037b19476505280f48f-1" name="rest_code_7b465ed20fcb4037b19476505280f48f-1" href="posts/matplotlib_styles/#rest_code_7b465ed20fcb4037b19476505280f48f-1"></a><span class="n">font</span><span class="o">.</span><span class="n">family</span> <span class="p">:</span> <span class="n">sans</span><span class="o">-</span><span class="n">serif</span>
<a id="rest_code_7b465ed20fcb4037b19476505280f48f-2" name="rest_code_7b465ed20fcb4037b19476505280f48f-2" href="posts/matplotlib_styles/#rest_code_7b465ed20fcb4037b19476505280f48f-2"></a>
<a id="rest_code_7b465ed20fcb4037b19476505280f48f-3" name="rest_code_7b465ed20fcb4037b19476505280f48f-3" href="posts/matplotlib_styles/#rest_code_7b465ed20fcb4037b19476505280f48f-3"></a><span class="n">axes</span><span class="o">.</span><span class="n">facecolor</span> <span class="p">:</span> <span class="n">white</span>
<a id="rest_code_7b465ed20fcb4037b19476505280f48f-4" name="rest_code_7b465ed20fcb4037b19476505280f48f-4" href="posts/matplotlib_styles/#rest_code_7b465ed20fcb4037b19476505280f48f-4"></a><span class="n">axes</span><span class="o">.</span><span class="n">edgecolor</span> <span class="p">:</span> <span class="mi">4</span><span class="n">d4d4d</span>
<a id="rest_code_7b465ed20fcb4037b19476505280f48f-5" name="rest_code_7b465ed20fcb4037b19476505280f48f-5" href="posts/matplotlib_styles/#rest_code_7b465ed20fcb4037b19476505280f48f-5"></a><span class="n">axes</span><span class="o">.</span><span class="n">prop_cycle</span> <span class="p">:</span> <span class="n">cycler</span><span class="p">(</span><span class="s1">'color'</span><span class="p">,[</span><span class="s1">'4573a7'</span><span class="p">,</span> <span class="s1">'aa4644'</span><span class="p">,</span> <span class="s1">'89a54e'</span><span class="p">,</span> <span class="s1">'71588f'</span><span class="p">,</span><span class="s1">'4298af'</span><span class="p">,</span> <span class="s1">'db843d'</span><span class="p">,</span> <span class="s1">'93a9d0'</span><span class="p">,</span> <span class="s1">'d09392'</span><span class="p">])</span>
<a id="rest_code_7b465ed20fcb4037b19476505280f48f-6" name="rest_code_7b465ed20fcb4037b19476505280f48f-6" href="posts/matplotlib_styles/#rest_code_7b465ed20fcb4037b19476505280f48f-6"></a><span class="n">axes</span><span class="o">.</span><span class="n">grid</span> <span class="p">:</span> <span class="kc">True</span>
<a id="rest_code_7b465ed20fcb4037b19476505280f48f-7" name="rest_code_7b465ed20fcb4037b19476505280f48f-7" href="posts/matplotlib_styles/#rest_code_7b465ed20fcb4037b19476505280f48f-7"></a><span class="n">axes</span><span class="o">.</span><span class="n">linewidth</span> <span class="p">:</span> <span class="mf">0.5</span>
<a id="rest_code_7b465ed20fcb4037b19476505280f48f-8" name="rest_code_7b465ed20fcb4037b19476505280f48f-8" href="posts/matplotlib_styles/#rest_code_7b465ed20fcb4037b19476505280f48f-8"></a>
<a id="rest_code_7b465ed20fcb4037b19476505280f48f-9" name="rest_code_7b465ed20fcb4037b19476505280f48f-9" href="posts/matplotlib_styles/#rest_code_7b465ed20fcb4037b19476505280f48f-9"></a><span class="n">axes</span><span class="o">.</span><span class="n">spines</span><span class="o">.</span><span class="n">left</span>   <span class="p">:</span> <span class="kc">True</span>
<a id="rest_code_7b465ed20fcb4037b19476505280f48f-10" name="rest_code_7b465ed20fcb4037b19476505280f48f-10" href="posts/matplotlib_styles/#rest_code_7b465ed20fcb4037b19476505280f48f-10"></a><span class="n">axes</span><span class="o">.</span><span class="n">spines</span><span class="o">.</span><span class="n">bottom</span> <span class="p">:</span> <span class="kc">True</span>
<a id="rest_code_7b465ed20fcb4037b19476505280f48f-11" name="rest_code_7b465ed20fcb4037b19476505280f48f-11" href="posts/matplotlib_styles/#rest_code_7b465ed20fcb4037b19476505280f48f-11"></a><span class="n">axes</span><span class="o">.</span><span class="n">spines</span><span class="o">.</span><span class="n">top</span>    <span class="p">:</span> <span class="kc">False</span>
<a id="rest_code_7b465ed20fcb4037b19476505280f48f-12" name="rest_code_7b465ed20fcb4037b19476505280f48f-12" href="posts/matplotlib_styles/#rest_code_7b465ed20fcb4037b19476505280f48f-12"></a><span class="n">axes</span><span class="o">.</span><span class="n">spines</span><span class="o">.</span><span class="n">right</span>  <span class="p">:</span> <span class="kc">False</span>
<a id="rest_code_7b465ed20fcb4037b19476505280f48f-13" name="rest_code_7b465ed20fcb4037b19476505280f48f-13" href="posts/matplotlib_styles/#rest_code_7b465ed20fcb4037b19476505280f48f-13"></a>
<a id="rest_code_7b465ed20fcb4037b19476505280f48f-14" name="rest_code_7b465ed20fcb4037b19476505280f48f-14" href="posts/matplotlib_styles/#rest_code_7b465ed20fcb4037b19476505280f48f-14"></a><span class="n">lines</span><span class="o">.</span><span class="n">linewidth</span> <span class="p">:</span> <span class="mi">2</span>
<a id="rest_code_7b465ed20fcb4037b19476505280f48f-15" name="rest_code_7b465ed20fcb4037b19476505280f48f-15" href="posts/matplotlib_styles/#rest_code_7b465ed20fcb4037b19476505280f48f-15"></a>
<a id="rest_code_7b465ed20fcb4037b19476505280f48f-16" name="rest_code_7b465ed20fcb4037b19476505280f48f-16" href="posts/matplotlib_styles/#rest_code_7b465ed20fcb4037b19476505280f48f-16"></a><span class="n">grid</span><span class="o">.</span><span class="n">color</span> <span class="p">:</span> <span class="mi">4</span><span class="n">d4d4d</span>
<a id="rest_code_7b465ed20fcb4037b19476505280f48f-17" name="rest_code_7b465ed20fcb4037b19476505280f48f-17" href="posts/matplotlib_styles/#rest_code_7b465ed20fcb4037b19476505280f48f-17"></a><span class="n">grid</span><span class="o">.</span><span class="n">linestyle</span> <span class="p">:</span> <span class="o">-</span>
<a id="rest_code_7b465ed20fcb4037b19476505280f48f-18" name="rest_code_7b465ed20fcb4037b19476505280f48f-18" href="posts/matplotlib_styles/#rest_code_7b465ed20fcb4037b19476505280f48f-18"></a><span class="n">grid</span><span class="o">.</span><span class="n">linewidth</span> <span class="p">:</span> <span class="mf">0.5</span>
<a id="rest_code_7b465ed20fcb4037b19476505280f48f-19" name="rest_code_7b465ed20fcb4037b19476505280f48f-19" href="posts/matplotlib_styles/#rest_code_7b465ed20fcb4037b19476505280f48f-19"></a>
<a id="rest_code_7b465ed20fcb4037b19476505280f48f-20" name="rest_code_7b465ed20fcb4037b19476505280f48f-20" href="posts/matplotlib_styles/#rest_code_7b465ed20fcb4037b19476505280f48f-20"></a><span class="n">figure</span><span class="o">.</span><span class="n">figsize</span> <span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">3</span>
<a id="rest_code_7b465ed20fcb4037b19476505280f48f-21" name="rest_code_7b465ed20fcb4037b19476505280f48f-21" href="posts/matplotlib_styles/#rest_code_7b465ed20fcb4037b19476505280f48f-21"></a>
<a id="rest_code_7b465ed20fcb4037b19476505280f48f-22" name="rest_code_7b465ed20fcb4037b19476505280f48f-22" href="posts/matplotlib_styles/#rest_code_7b465ed20fcb4037b19476505280f48f-22"></a><span class="n">legend</span><span class="o">.</span><span class="n">fancybox</span> <span class="p">:</span> <span class="kc">False</span>
<a id="rest_code_7b465ed20fcb4037b19476505280f48f-23" name="rest_code_7b465ed20fcb4037b19476505280f48f-23" href="posts/matplotlib_styles/#rest_code_7b465ed20fcb4037b19476505280f48f-23"></a><span class="n">legend</span><span class="o">.</span><span class="n">frameon</span> <span class="p">:</span> <span class="kc">False</span>
<a id="rest_code_7b465ed20fcb4037b19476505280f48f-24" name="rest_code_7b465ed20fcb4037b19476505280f48f-24" href="posts/matplotlib_styles/#rest_code_7b465ed20fcb4037b19476505280f48f-24"></a><span class="n">legend</span><span class="o">.</span><span class="n">facecolor</span> <span class="p">:</span> <span class="n">white</span>
<a id="rest_code_7b465ed20fcb4037b19476505280f48f-25" name="rest_code_7b465ed20fcb4037b19476505280f48f-25" href="posts/matplotlib_styles/#rest_code_7b465ed20fcb4037b19476505280f48f-25"></a><span class="n">legend</span><span class="o">.</span><span class="n">edgecolor</span> <span class="p">:</span> <span class="mi">4</span><span class="n">d4d4d</span>
<a id="rest_code_7b465ed20fcb4037b19476505280f48f-26" name="rest_code_7b465ed20fcb4037b19476505280f48f-26" href="posts/matplotlib_styles/#rest_code_7b465ed20fcb4037b19476505280f48f-26"></a><span class="n">legend</span><span class="o">.</span><span class="n">loc</span> <span class="p">:</span> <span class="n">center</span> <span class="n">left</span>
</pre></div>
<p>El siguiente código usa este estilo</p>
<div class="code"><pre class="code python"><a id="rest_code_d1eee94cefb84a06aacc197088e96ff4-1" name="rest_code_d1eee94cefb84a06aacc197088e96ff4-1" href="posts/matplotlib_styles/#rest_code_d1eee94cefb84a06aacc197088e96ff4-1"></a><span class="n">style</span> <span class="o">=</span> <span class="s2">"MS2007.mplstyle"</span>
<a id="rest_code_d1eee94cefb84a06aacc197088e96ff4-2" name="rest_code_d1eee94cefb84a06aacc197088e96ff4-2" href="posts/matplotlib_styles/#rest_code_d1eee94cefb84a06aacc197088e96ff4-2"></a><span class="k">with</span> <span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">context</span><span class="p">(</span><span class="n">style</span><span class="p">):</span>
<a id="rest_code_d1eee94cefb84a06aacc197088e96ff4-3" name="rest_code_d1eee94cefb84a06aacc197088e96ff4-3" href="posts/matplotlib_styles/#rest_code_d1eee94cefb84a06aacc197088e96ff4-3"></a>    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<a id="rest_code_d1eee94cefb84a06aacc197088e96ff4-4" name="rest_code_d1eee94cefb84a06aacc197088e96ff4-4" href="posts/matplotlib_styles/#rest_code_d1eee94cefb84a06aacc197088e96ff4-4"></a>    <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mf">1e-6</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mf">1e-6</span><span class="p">)</span>
<a id="rest_code_d1eee94cefb84a06aacc197088e96ff4-5" name="rest_code_d1eee94cefb84a06aacc197088e96ff4-5" href="posts/matplotlib_styles/#rest_code_d1eee94cefb84a06aacc197088e96ff4-5"></a>    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<a id="rest_code_d1eee94cefb84a06aacc197088e96ff4-6" name="rest_code_d1eee94cefb84a06aacc197088e96ff4-6" href="posts/matplotlib_styles/#rest_code_d1eee94cefb84a06aacc197088e96ff4-6"></a>    <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>
<a id="rest_code_d1eee94cefb84a06aacc197088e96ff4-7" name="rest_code_d1eee94cefb84a06aacc197088e96ff4-7" href="posts/matplotlib_styles/#rest_code_d1eee94cefb84a06aacc197088e96ff4-7"></a>    <span class="k">for</span> <span class="n">cont</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>
<a id="rest_code_d1eee94cefb84a06aacc197088e96ff4-8" name="rest_code_d1eee94cefb84a06aacc197088e96ff4-8" href="posts/matplotlib_styles/#rest_code_d1eee94cefb84a06aacc197088e96ff4-8"></a>        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="o">/</span><span class="p">(</span><span class="n">cont</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="n">cont</span><span class="p">)</span>
<a id="rest_code_d1eee94cefb84a06aacc197088e96ff4-9" name="rest_code_d1eee94cefb84a06aacc197088e96ff4-9" href="posts/matplotlib_styles/#rest_code_d1eee94cefb84a06aacc197088e96ff4-9"></a>
<a id="rest_code_d1eee94cefb84a06aacc197088e96ff4-10" name="rest_code_d1eee94cefb84a06aacc197088e96ff4-10" href="posts/matplotlib_styles/#rest_code_d1eee94cefb84a06aacc197088e96ff4-10"></a>    <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
<a id="rest_code_d1eee94cefb84a06aacc197088e96ff4-11" name="rest_code_d1eee94cefb84a06aacc197088e96ff4-11" href="posts/matplotlib_styles/#rest_code_d1eee94cefb84a06aacc197088e96ff4-11"></a>    <span class="n">box</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_position</span><span class="p">()</span>
<a id="rest_code_d1eee94cefb84a06aacc197088e96ff4-12" name="rest_code_d1eee94cefb84a06aacc197088e96ff4-12" href="posts/matplotlib_styles/#rest_code_d1eee94cefb84a06aacc197088e96ff4-12"></a>    <span class="n">ax</span><span class="o">.</span><span class="n">set_position</span><span class="p">([</span><span class="n">box</span><span class="o">.</span><span class="n">x0</span><span class="p">,</span> <span class="n">box</span><span class="o">.</span><span class="n">y0</span><span class="p">,</span> <span class="n">box</span><span class="o">.</span><span class="n">width</span> <span class="o">*</span> <span class="mf">0.8</span><span class="p">,</span> <span class="n">box</span><span class="o">.</span><span class="n">height</span><span class="p">])</span>
<a id="rest_code_d1eee94cefb84a06aacc197088e96ff4-13" name="rest_code_d1eee94cefb84a06aacc197088e96ff4-13" href="posts/matplotlib_styles/#rest_code_d1eee94cefb84a06aacc197088e96ff4-13"></a>    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">))</span>
</pre></div>
<p>y este es el resultado</p>
<img alt="/images/MS2007_style.svg" src="../images/MS2007_style.svg"></section><section id="tercer-ejemplo-un-estilo-limpio"><h2>Tercer ejemplo: un estilo limpio</h2>
<p>El último ejemplo es un estilo limpio que usa una paleta de colores
tomada de
<a class="reference external" href="http://colorbrewer2.org/#type=qualitative&amp;scheme=Set1&amp;n=8">ColorBrewer</a>.</p>
<p>Este es el contenido del archivo
<a class="reference external" href="https://github.com/nicoguaro/matplotlib_styles/blob/master/styles/clean.mplstyle">clean_style.mplstyle</a></p>
<div class="code"><pre class="code python"><a id="rest_code_f3afafe863434359bc259f6e6567d7d2-1" name="rest_code_f3afafe863434359bc259f6e6567d7d2-1" href="posts/matplotlib_styles/#rest_code_f3afafe863434359bc259f6e6567d7d2-1"></a><span class="n">font</span><span class="o">.</span><span class="n">family</span> <span class="p">:</span> <span class="n">sans</span><span class="o">-</span><span class="n">serif</span>
<a id="rest_code_f3afafe863434359bc259f6e6567d7d2-2" name="rest_code_f3afafe863434359bc259f6e6567d7d2-2" href="posts/matplotlib_styles/#rest_code_f3afafe863434359bc259f6e6567d7d2-2"></a>
<a id="rest_code_f3afafe863434359bc259f6e6567d7d2-3" name="rest_code_f3afafe863434359bc259f6e6567d7d2-3" href="posts/matplotlib_styles/#rest_code_f3afafe863434359bc259f6e6567d7d2-3"></a><span class="n">axes</span><span class="o">.</span><span class="n">facecolor</span> <span class="p">:</span> <span class="n">white</span>
<a id="rest_code_f3afafe863434359bc259f6e6567d7d2-4" name="rest_code_f3afafe863434359bc259f6e6567d7d2-4" href="posts/matplotlib_styles/#rest_code_f3afafe863434359bc259f6e6567d7d2-4"></a><span class="n">axes</span><span class="o">.</span><span class="n">prop_cycle</span> <span class="p">:</span> <span class="n">cycler</span><span class="p">(</span><span class="s1">'color'</span><span class="p">,[</span><span class="s1">'e41a1c'</span><span class="p">,</span> <span class="s1">'377eb8'</span><span class="p">,</span> <span class="s1">'4daf4a'</span><span class="p">,</span> <span class="s1">'984ea3'</span><span class="p">,</span> <span class="s1">'ff7f00'</span><span class="p">,</span> <span class="s1">'ffff33'</span><span class="p">,</span> <span class="s1">'a65628'</span><span class="p">,</span> <span class="s1">'f781bf'</span><span class="p">])</span>
<a id="rest_code_f3afafe863434359bc259f6e6567d7d2-5" name="rest_code_f3afafe863434359bc259f6e6567d7d2-5" href="posts/matplotlib_styles/#rest_code_f3afafe863434359bc259f6e6567d7d2-5"></a><span class="n">axes</span><span class="o">.</span><span class="n">linewidth</span> <span class="p">:</span> <span class="mf">0.0</span>
<a id="rest_code_f3afafe863434359bc259f6e6567d7d2-6" name="rest_code_f3afafe863434359bc259f6e6567d7d2-6" href="posts/matplotlib_styles/#rest_code_f3afafe863434359bc259f6e6567d7d2-6"></a><span class="n">axes</span><span class="o">.</span><span class="n">grid</span> <span class="p">:</span> <span class="kc">True</span>
<a id="rest_code_f3afafe863434359bc259f6e6567d7d2-7" name="rest_code_f3afafe863434359bc259f6e6567d7d2-7" href="posts/matplotlib_styles/#rest_code_f3afafe863434359bc259f6e6567d7d2-7"></a>
<a id="rest_code_f3afafe863434359bc259f6e6567d7d2-8" name="rest_code_f3afafe863434359bc259f6e6567d7d2-8" href="posts/matplotlib_styles/#rest_code_f3afafe863434359bc259f6e6567d7d2-8"></a><span class="n">lines</span><span class="o">.</span><span class="n">linewidth</span> <span class="p">:</span> <span class="mf">1.5</span>
<a id="rest_code_f3afafe863434359bc259f6e6567d7d2-9" name="rest_code_f3afafe863434359bc259f6e6567d7d2-9" href="posts/matplotlib_styles/#rest_code_f3afafe863434359bc259f6e6567d7d2-9"></a>
<a id="rest_code_f3afafe863434359bc259f6e6567d7d2-10" name="rest_code_f3afafe863434359bc259f6e6567d7d2-10" href="posts/matplotlib_styles/#rest_code_f3afafe863434359bc259f6e6567d7d2-10"></a><span class="n">xtick</span><span class="o">.</span><span class="n">direction</span> <span class="p">:</span> <span class="ow">in</span>
<a id="rest_code_f3afafe863434359bc259f6e6567d7d2-11" name="rest_code_f3afafe863434359bc259f6e6567d7d2-11" href="posts/matplotlib_styles/#rest_code_f3afafe863434359bc259f6e6567d7d2-11"></a><span class="n">ytick</span><span class="o">.</span><span class="n">direction</span> <span class="p">:</span> <span class="ow">in</span>
<a id="rest_code_f3afafe863434359bc259f6e6567d7d2-12" name="rest_code_f3afafe863434359bc259f6e6567d7d2-12" href="posts/matplotlib_styles/#rest_code_f3afafe863434359bc259f6e6567d7d2-12"></a>
<a id="rest_code_f3afafe863434359bc259f6e6567d7d2-13" name="rest_code_f3afafe863434359bc259f6e6567d7d2-13" href="posts/matplotlib_styles/#rest_code_f3afafe863434359bc259f6e6567d7d2-13"></a><span class="n">grid</span><span class="o">.</span><span class="n">color</span> <span class="p">:</span> <span class="n">c7dedf</span>
<a id="rest_code_f3afafe863434359bc259f6e6567d7d2-14" name="rest_code_f3afafe863434359bc259f6e6567d7d2-14" href="posts/matplotlib_styles/#rest_code_f3afafe863434359bc259f6e6567d7d2-14"></a><span class="n">grid</span><span class="o">.</span><span class="n">linestyle</span> <span class="p">:</span> <span class="o">-</span>
<a id="rest_code_f3afafe863434359bc259f6e6567d7d2-15" name="rest_code_f3afafe863434359bc259f6e6567d7d2-15" href="posts/matplotlib_styles/#rest_code_f3afafe863434359bc259f6e6567d7d2-15"></a><span class="n">grid</span><span class="o">.</span><span class="n">linewidth</span> <span class="p">:</span> <span class="mf">0.3</span>
<a id="rest_code_f3afafe863434359bc259f6e6567d7d2-16" name="rest_code_f3afafe863434359bc259f6e6567d7d2-16" href="posts/matplotlib_styles/#rest_code_f3afafe863434359bc259f6e6567d7d2-16"></a>
<a id="rest_code_f3afafe863434359bc259f6e6567d7d2-17" name="rest_code_f3afafe863434359bc259f6e6567d7d2-17" href="posts/matplotlib_styles/#rest_code_f3afafe863434359bc259f6e6567d7d2-17"></a><span class="n">figure</span><span class="o">.</span><span class="n">figsize</span> <span class="p">:</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">4</span>
<a id="rest_code_f3afafe863434359bc259f6e6567d7d2-18" name="rest_code_f3afafe863434359bc259f6e6567d7d2-18" href="posts/matplotlib_styles/#rest_code_f3afafe863434359bc259f6e6567d7d2-18"></a>
<a id="rest_code_f3afafe863434359bc259f6e6567d7d2-19" name="rest_code_f3afafe863434359bc259f6e6567d7d2-19" href="posts/matplotlib_styles/#rest_code_f3afafe863434359bc259f6e6567d7d2-19"></a><span class="n">legend</span><span class="o">.</span><span class="n">fancybox</span> <span class="p">:</span> <span class="kc">False</span>
<a id="rest_code_f3afafe863434359bc259f6e6567d7d2-20" name="rest_code_f3afafe863434359bc259f6e6567d7d2-20" href="posts/matplotlib_styles/#rest_code_f3afafe863434359bc259f6e6567d7d2-20"></a><span class="n">legend</span><span class="o">.</span><span class="n">frameon</span> <span class="p">:</span> <span class="kc">False</span>
<a id="rest_code_f3afafe863434359bc259f6e6567d7d2-21" name="rest_code_f3afafe863434359bc259f6e6567d7d2-21" href="posts/matplotlib_styles/#rest_code_f3afafe863434359bc259f6e6567d7d2-21"></a><span class="n">legend</span><span class="o">.</span><span class="n">loc</span> <span class="p">:</span> <span class="n">best</span>
</pre></div>
<p>El siguiente código usa este estilo</p>
<div class="code"><pre class="code python"><a id="rest_code_d450d2b324f0443d98e9c798a59c1d15-1" name="rest_code_d450d2b324f0443d98e9c798a59c1d15-1" href="posts/matplotlib_styles/#rest_code_d450d2b324f0443d98e9c798a59c1d15-1"></a><span class="n">style</span> <span class="o">=</span> <span class="s2">"clean.mplstyle"</span>
<a id="rest_code_d450d2b324f0443d98e9c798a59c1d15-2" name="rest_code_d450d2b324f0443d98e9c798a59c1d15-2" href="posts/matplotlib_styles/#rest_code_d450d2b324f0443d98e9c798a59c1d15-2"></a><span class="k">with</span> <span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">context</span><span class="p">(</span><span class="n">style</span><span class="p">):</span>
<a id="rest_code_d450d2b324f0443d98e9c798a59c1d15-3" name="rest_code_d450d2b324f0443d98e9c798a59c1d15-3" href="posts/matplotlib_styles/#rest_code_d450d2b324f0443d98e9c798a59c1d15-3"></a>    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<a id="rest_code_d450d2b324f0443d98e9c798a59c1d15-4" name="rest_code_d450d2b324f0443d98e9c798a59c1d15-4" href="posts/matplotlib_styles/#rest_code_d450d2b324f0443d98e9c798a59c1d15-4"></a>    <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mf">1e-6</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mf">1e-6</span><span class="p">)</span>
<a id="rest_code_d450d2b324f0443d98e9c798a59c1d15-5" name="rest_code_d450d2b324f0443d98e9c798a59c1d15-5" href="posts/matplotlib_styles/#rest_code_d450d2b324f0443d98e9c798a59c1d15-5"></a>    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<a id="rest_code_d450d2b324f0443d98e9c798a59c1d15-6" name="rest_code_d450d2b324f0443d98e9c798a59c1d15-6" href="posts/matplotlib_styles/#rest_code_d450d2b324f0443d98e9c798a59c1d15-6"></a>    <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>
<a id="rest_code_d450d2b324f0443d98e9c798a59c1d15-7" name="rest_code_d450d2b324f0443d98e9c798a59c1d15-7" href="posts/matplotlib_styles/#rest_code_d450d2b324f0443d98e9c798a59c1d15-7"></a>    <span class="k">for</span> <span class="n">cont</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>
<a id="rest_code_d450d2b324f0443d98e9c798a59c1d15-8" name="rest_code_d450d2b324f0443d98e9c798a59c1d15-8" href="posts/matplotlib_styles/#rest_code_d450d2b324f0443d98e9c798a59c1d15-8"></a>        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="o">/</span><span class="p">(</span><span class="n">cont</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="n">cont</span><span class="p">)</span>
<a id="rest_code_d450d2b324f0443d98e9c798a59c1d15-9" name="rest_code_d450d2b324f0443d98e9c798a59c1d15-9" href="posts/matplotlib_styles/#rest_code_d450d2b324f0443d98e9c798a59c1d15-9"></a>
<a id="rest_code_d450d2b324f0443d98e9c798a59c1d15-10" name="rest_code_d450d2b324f0443d98e9c798a59c1d15-10" href="posts/matplotlib_styles/#rest_code_d450d2b324f0443d98e9c798a59c1d15-10"></a>    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</pre></div>
<p>y este es el resultado</p>
<img alt="/images/clean_style.svg" src="../images/clean_style.svg"><p>También podemos usar archivos que están almacenado remotamente. Por ejemplo,
podríamos usar la siguiente URL:</p>
<div class="code"><pre class="code python"><a id="rest_code_c4cf839990eb4ccba1b3929e1faeaa9d-1" name="rest_code_c4cf839990eb4ccba1b3929e1faeaa9d-1" href="posts/matplotlib_styles/#rest_code_c4cf839990eb4ccba1b3929e1faeaa9d-1"></a><span class="n">style</span> <span class="o">=</span> <span class="s2">"https://raw.githubusercontent.com/nicoguaro/matplotlib_styles/master/styles/clean.mplstyle"</span>
</pre></div>
</section><section id="recursos"><h2>Recursos</h2>
<p>Como mencioné anteriormente, el objetivo de esta publicación era crear
algunos archivos de estilo simples para matplotlib y verlos en acción.</p>
<p>Esta publicación no permite ser una guía para buenos gráficos/visualizaciones.
Para este propósito sugiero mirar la siguiente referencia:</p>
<ul class="simple">
<li><p>Rougier, Nicolas P., Michael Droettboom, and Philip E. Bourne.
<a class="reference external" href="http://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1003833">"Ten simple rules for better figures."</a>
PLoS computational biology 10.9 (2014): e1003833.</p></li>
</ul>
<p>Además, encuentro muy útiles las siguientes herramientas:</p>
<ul class="simple">
<li><p><a class="reference external" href="http://colorbrewer2.org">ColorBrewer2</a> permite elegir mapas de colores
con diferentes criterios (cuantitativo/cualitativo, apto para impresión,
apto para daltónicos).</p></li>
<li><p><a class="reference external" href="http://colrd.com">ColRD</a> tiene muchas paletas de colores. También
permite generar paletas a partir de imágenes.</p></li>
<li><p><a class="reference external" href="http://vrl.cs.brown.edu/color">Colorgorical</a> es una herramienta
para crear paletas de colores categóricas (cualitativas) para visualización
de información.</p></li>
</ul>
<p>Puedes encontrar el código de esta publicación en
<a class="reference external" href="http://nbviewer.jupyter.org/gist/nicoguaro/862ea1015917d99352401433d45684e2/matplotlib_styles.ipynb">esteJupyter notebook</a>.</p>
</section>
</div>
    </article><article class="post h-entry post-text"><header><h1 class="post-title p-name"><a href="posts/hermite_interp/" class="u-url">Interpolación de Hermite a trozos</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn">Nicolás Guarín-Zapata</span></p>
            <p class="dateline"><a href="posts/hermite_interp/" rel="bookmark"><time class="post-date published dt-published" datetime="2017-06-22T16:24:44-05:00" title="2017-06-22 16:24">2017-06-22 16:24</time></a></p>
                <p class="commentline">
    
    <a href="posts/hermite_interp/#disqus_thread" data-disqus-identifier="cache/posts/hermite_interp.html">Comentarios</a>


        </p>
</div>
    </header><div class="e-content entry-content">
    <p>En esta entrada encontramos las funciones de interpolación de Hermite
para el dominio [-1, 1]. Luego, las usamos para una interpolación a
trozos. Observe que esta interpolación tiene continuidad  <span class="math">\(C^1\)</span>
y no <span class="math">\(C^0\)</span> como en la interpolación de Lagrange.</p>
<p>Para calcular los polinomios explícitamente podemos usar <cite>sympy</cite>.</p>
<div class="code"><pre class="code ipython2"><a id="rest_code_1d003f4d397e4845a00eb53e2abd2767-1" name="rest_code_1d003f4d397e4845a00eb53e2abd2767-1" href="posts/hermite_interp/#rest_code_1d003f4d397e4845a00eb53e2abd2767-1"></a><span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">division</span>
<a id="rest_code_1d003f4d397e4845a00eb53e2abd2767-2" name="rest_code_1d003f4d397e4845a00eb53e2abd2767-2" href="posts/hermite_interp/#rest_code_1d003f4d397e4845a00eb53e2abd2767-2"></a><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<a id="rest_code_1d003f4d397e4845a00eb53e2abd2767-3" name="rest_code_1d003f4d397e4845a00eb53e2abd2767-3" href="posts/hermite_interp/#rest_code_1d003f4d397e4845a00eb53e2abd2767-3"></a><span class="kn">import</span> <span class="nn">sympy</span> <span class="k">as</span> <span class="nn">sym</span>
<a id="rest_code_1d003f4d397e4845a00eb53e2abd2767-4" name="rest_code_1d003f4d397e4845a00eb53e2abd2767-4" href="posts/hermite_interp/#rest_code_1d003f4d397e4845a00eb53e2abd2767-4"></a><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</pre></div>
<p>Queremos encontrar una base con funciones que sastisfagan</p>
<div class="math">
\begin{align*}
N_1(x_1) &amp;= 1\\
N_1(x_2) &amp;= 0\\
N_2(x_1) &amp;= 1\\
N_2(x_2) &amp;= 0\\
N'_3(x_1) &amp;= 1\\
N'_3(x_2) &amp;= 0\\
N'_4(x_1) &amp;= 1\\
N'_4(x_2) &amp;= 0
\end{align*}
</div>
<p>Esto puede escribirse como</p>
<div class="math">
\begin{equation*}
\begin{bmatrix}
1 &amp;x_1 &amp;x_1^2 &amp;x_1^3\\
1 &amp;x_2 &amp;x_2^2 &amp;x_2^3\\
0 &amp;1 &amp;2x_1 &amp;3x_1^2\\
0 &amp;1 &amp;2x_2 &amp;3x_2^2
\end{bmatrix}
\begin{bmatrix}
a_{11} &amp;a_{12} &amp;a_{13} &amp;a_{14}\\
a_{21} &amp;a_{22} &amp;a_{23} &amp;a_{24}\\
a_{31} &amp;a_{32} &amp;a_{33} &amp;a_{34}\\
a_{41} &amp;a_{42} &amp;a_{43} &amp;a_{44}
\end{bmatrix} =
\begin{bmatrix}
1 &amp;0 &amp;0 &amp;0\\
0 &amp;1 &amp;0 &amp;0\\
0 &amp;0 &amp;1 &amp;0\\
0 &amp;0 &amp;0 &amp;1
\end{bmatrix}
\end{equation*}
</div>
<p>La fórmula para la interpolación sería</p>
<div class="math">
\begin{equation*}
f(x) \approx N_1(x) u_1 + N_2(x) u_2 + |J|(N_3(x) u'_3 + N_4(x) u'_4)\quad \forall x\in [a, b]
\end{equation*}
</div>
<p>con <span class="math">\(|J| = (b - a)/2\)</span> el determinante jacobiano de la transformación.</p>
<div class="code"><pre class="code ipython2"><a id="rest_code_afb475397e614dfda59d8b22ab2e2933-1" name="rest_code_afb475397e614dfda59d8b22ab2e2933-1" href="posts/hermite_interp/#rest_code_afb475397e614dfda59d8b22ab2e2933-1"></a><span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s2">"x1 x2 x"</span><span class="p">)</span>
<a id="rest_code_afb475397e614dfda59d8b22ab2e2933-2" name="rest_code_afb475397e614dfda59d8b22ab2e2933-2" href="posts/hermite_interp/#rest_code_afb475397e614dfda59d8b22ab2e2933-2"></a><span class="n">V</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">Matrix</span><span class="p">([</span>
<a id="rest_code_afb475397e614dfda59d8b22ab2e2933-3" name="rest_code_afb475397e614dfda59d8b22ab2e2933-3" href="posts/hermite_interp/#rest_code_afb475397e614dfda59d8b22ab2e2933-3"></a>    <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">x1</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="n">x1</span><span class="o">**</span><span class="mi">3</span><span class="p">],</span>
<a id="rest_code_afb475397e614dfda59d8b22ab2e2933-4" name="rest_code_afb475397e614dfda59d8b22ab2e2933-4" href="posts/hermite_interp/#rest_code_afb475397e614dfda59d8b22ab2e2933-4"></a>    <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">x2</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="n">x2</span><span class="o">**</span><span class="mi">3</span><span class="p">],</span>
<a id="rest_code_afb475397e614dfda59d8b22ab2e2933-5" name="rest_code_afb475397e614dfda59d8b22ab2e2933-5" href="posts/hermite_interp/#rest_code_afb475397e614dfda59d8b22ab2e2933-5"></a>    <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">x1</span><span class="p">,</span> <span class="mi">3</span><span class="o">*</span><span class="n">x1</span><span class="o">**</span><span class="mi">2</span><span class="p">],</span>
<a id="rest_code_afb475397e614dfda59d8b22ab2e2933-6" name="rest_code_afb475397e614dfda59d8b22ab2e2933-6" href="posts/hermite_interp/#rest_code_afb475397e614dfda59d8b22ab2e2933-6"></a>    <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">x2</span><span class="p">,</span> <span class="mi">3</span><span class="o">*</span><span class="n">x2</span><span class="o">**</span><span class="mi">2</span><span class="p">]])</span>
<a id="rest_code_afb475397e614dfda59d8b22ab2e2933-7" name="rest_code_afb475397e614dfda59d8b22ab2e2933-7" href="posts/hermite_interp/#rest_code_afb475397e614dfda59d8b22ab2e2933-7"></a><span class="n">V</span>
</pre></div>
<div class="math">
\begin{equation*}
\left[\begin{matrix}1 &amp; x_{1} &amp; x_{1}^{2} &amp; x_{1}^{3}\\
1 &amp; x_{2} &amp; x_{2}^{2} &amp; x_{2}^{3}\\
0 &amp; 1 &amp; 2 x_{1} &amp; 3 x_{1}^{2}\\
0 &amp; 1 &amp; 2 x_{2} &amp; 3 x_{2}^{2}\end{matrix}\right]
\end{equation*}
</div>
<p>Podemos ver que la matriz anterios e una matriz de Vandermonde confluente <a class="footnote-reference brackets" href="posts/hermite_interp/#footnote-1" id="footnote-reference-1" role="doc-noteref"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></a>.
Es imilar a una matriz de Vandermonde para los primeros <span class="math">\(n\)</span> nodos
y las derivadas de cada columna para los siguientes.</p>
<p>Los coeficientes de nuestros polinomios están dados por la inversa de esta
matriz.</p>
<div class="code"><pre class="code ipython2"><a id="rest_code_46b88e0965504112bfef694638c7752d-1" name="rest_code_46b88e0965504112bfef694638c7752d-1" href="posts/hermite_interp/#rest_code_46b88e0965504112bfef694638c7752d-1"></a><span class="n">sym</span><span class="o">.</span><span class="n">simplify</span><span class="p">(</span><span class="n">V</span><span class="o">.</span><span class="n">inv</span><span class="p">())</span>
</pre></div>
<div class="math">
\begin{equation*}
\left[\begin{matrix}\frac{x_{2}^{2} \left(3 x_{1} - x_{2}\right)}{x_{1}^{3} - 3 x_{1}^{2} x_{2} + 3 x_{1} x_{2}^{2} - x_{2}^{3}} &amp; \frac{x_{1}^{2} \left(x_{1} - 3 x_{2}\right)}{x_{1}^{3} - 3 x_{1}^{2} x_{2} + 3 x_{1} x_{2}^{2} - x_{2}^{3}} &amp; - \frac{x_{1} x_{2}^{2}}{x_{1}^{2} - 2 x_{1} x_{2} + x_{2}^{2}} &amp; - \frac{x_{1}^{2} x_{2}}{x_{1}^{2} - 2 x_{1} x_{2} + x_{2}^{2}}\\- \frac{6 x_{1} x_{2}}{x_{1}^{3} - 3 x_{1}^{2} x_{2} + 3 x_{1} x_{2}^{2} - x_{2}^{3}} &amp; \frac{6 x_{1} x_{2}}{x_{1}^{3} - 3 x_{1}^{2} x_{2} + 3 x_{1} x_{2}^{2} - x_{2}^{3}} &amp; \frac{x_{2} \left(2 x_{1} + x_{2}\right)}{x_{1}^{2} - 2 x_{1} x_{2} + x_{2}^{2}} &amp; \frac{x_{1} \left(x_{1} + 2 x_{2}\right)}{x_{1}^{2} - 2 x_{1} x_{2} + x_{2}^{2}}\\\frac{3 x_{1} + 3 x_{2}}{x_{1}^{3} - 3 x_{1}^{2} x_{2} + 3 x_{1} x_{2}^{2} - x_{2}^{3}} &amp; - \frac{3 x_{1} + 3 x_{2}}{x_{1}^{3} - 3 x_{1}^{2} x_{2} + 3 x_{1} x_{2}^{2} - x_{2}^{3}} &amp; - \frac{x_{1} + 2 x_{2}}{x_{1}^{2} - 2 x_{1} x_{2} + x_{2}^{2}} &amp; - \frac{2 x_{1} + x_{2}}{x_{1}^{2} - 2 x_{1} x_{2} + x_{2}^{2}}\\- \frac{2}{x_{1}^{3} - 3 x_{1}^{2} x_{2} + 3 x_{1} x_{2}^{2} - x_{2}^{3}} &amp; \frac{2}{x_{1}^{3} - 3 x_{1}^{2} x_{2} + 3 x_{1} x_{2}^{2} - x_{2}^{3}} &amp; \frac{1}{x_{1}^{2} - 2 x_{1} x_{2} + x_{2}^{2}} &amp; \frac{1}{x_{1}^{2} - 2 x_{1} x_{2} + x_{2}^{2}}\end{matrix}\right]
\end{equation*}
</div>
<p>Y remplazamos los valores para los nodos extremos, -1 y 1.</p>
<div class="code"><pre class="code ipython2"><a id="rest_code_aff504d0d8f4433297e3e792af1ea490-1" name="rest_code_aff504d0d8f4433297e3e792af1ea490-1" href="posts/hermite_interp/#rest_code_aff504d0d8f4433297e3e792af1ea490-1"></a><span class="n">V_inv</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">simplify</span><span class="p">(</span><span class="n">V</span><span class="o">.</span><span class="n">subs</span><span class="p">({</span><span class="n">x1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">x2</span><span class="p">:</span><span class="mi">1</span><span class="p">})</span><span class="o">.</span><span class="n">inv</span><span class="p">())</span>
<a id="rest_code_aff504d0d8f4433297e3e792af1ea490-2" name="rest_code_aff504d0d8f4433297e3e792af1ea490-2" href="posts/hermite_interp/#rest_code_aff504d0d8f4433297e3e792af1ea490-2"></a><span class="n">V_inv</span>
</pre></div>
<div class="math">
\begin{equation*}
\left[\begin{matrix}\frac{1}{2} &amp; \frac{1}{2} &amp; \frac{1}{4} &amp; - \frac{1}{4}\\
- \frac{3}{4} &amp; \frac{3}{4} &amp; - \frac{1}{4} &amp; - \frac{1}{4}\\
0 &amp; 0 &amp; - \frac{1}{4} &amp; \frac{1}{4}\\
\frac{1}{4} &amp; - \frac{1}{4} &amp; \frac{1}{4} &amp; \frac{1}{4}\end{matrix}\right]
\end{equation*}
</div>
<p>Los polinomios son el producto de los coeficientes y los monomios</p>
<div class="code"><pre class="code ipython2"><a id="rest_code_7c4cb8cf34b142869c762e2f078fe836-1" name="rest_code_7c4cb8cf34b142869c762e2f078fe836-1" href="posts/hermite_interp/#rest_code_7c4cb8cf34b142869c762e2f078fe836-1"></a><span class="n">sym</span><span class="o">.</span><span class="n">factor</span><span class="p">(</span><span class="n">V_inv</span><span class="o">.</span><span class="n">T</span> <span class="o">*</span> <span class="n">sym</span><span class="o">.</span><span class="n">Matrix</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="n">x</span><span class="o">**</span><span class="mi">3</span><span class="p">]))</span>
</pre></div>
<div class="math">
\begin{equation*}
\left[\begin{matrix}\frac{1}{4} \left(x - 1\right)^{2} \left(x + 2\right)\\- \frac{1}{4} \left(x - 2\right) \left(x + 1\right)^{2}\\\frac{1}{4} \left(x - 1\right)^{2} \left(x + 1\right)\\\frac{1}{4} \left(x - 1\right) \left(x + 1\right)^{2}\end{matrix}\right]
\end{equation*}
</div>
<p>La base interpolante sería</p>
<div class="math">
\begin{align*}
N_1 (x) &amp;= \frac{1}{4} (x - 1)^2 (2 + x)\\
N_2 (x) &amp;= \frac{1}{4} (x + 1)^2 (2 - x)\\
N_3 (x) &amp;= \frac{1}{4} (x - 1)^2 (x + 1)\\
N_4 (x) &amp;= \frac{1}{4} (x + 1)^2 (x - 1)\, ,
\end{align*}
</div>
<p>y la siguiente función calcula la interpolación para una función y
derivada dadas</p>
<div class="code"><pre class="code ipython2"><a id="rest_code_0f6874821713420aa7b8e114495c6ae4-1" name="rest_code_0f6874821713420aa7b8e114495c6ae4-1" href="posts/hermite_interp/#rest_code_0f6874821713420aa7b8e114495c6ae4-1"></a><span class="k">def</span> <span class="nf">hermite_interp</span><span class="p">(</span><span class="n">fun</span><span class="p">,</span> <span class="n">grad</span><span class="p">,</span> <span class="n">x0</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">x1</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">npts</span><span class="o">=</span><span class="mi">101</span><span class="p">):</span>
<a id="rest_code_0f6874821713420aa7b8e114495c6ae4-2" name="rest_code_0f6874821713420aa7b8e114495c6ae4-2" href="posts/hermite_interp/#rest_code_0f6874821713420aa7b8e114495c6ae4-2"></a>    <span class="n">jaco</span> <span class="o">=</span> <span class="p">(</span><span class="n">x1</span> <span class="o">-</span> <span class="n">x0</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span>
<a id="rest_code_0f6874821713420aa7b8e114495c6ae4-3" name="rest_code_0f6874821713420aa7b8e114495c6ae4-3" href="posts/hermite_interp/#rest_code_0f6874821713420aa7b8e114495c6ae4-3"></a>    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">npts</span><span class="p">)</span>
<a id="rest_code_0f6874821713420aa7b8e114495c6ae4-4" name="rest_code_0f6874821713420aa7b8e114495c6ae4-4" href="posts/hermite_interp/#rest_code_0f6874821713420aa7b8e114495c6ae4-4"></a>    <span class="n">f1</span> <span class="o">=</span> <span class="n">fun</span><span class="p">(</span><span class="n">x0</span><span class="p">)</span>
<a id="rest_code_0f6874821713420aa7b8e114495c6ae4-5" name="rest_code_0f6874821713420aa7b8e114495c6ae4-5" href="posts/hermite_interp/#rest_code_0f6874821713420aa7b8e114495c6ae4-5"></a>    <span class="n">f2</span> <span class="o">=</span> <span class="n">fun</span><span class="p">(</span><span class="n">x1</span><span class="p">)</span>
<a id="rest_code_0f6874821713420aa7b8e114495c6ae4-6" name="rest_code_0f6874821713420aa7b8e114495c6ae4-6" href="posts/hermite_interp/#rest_code_0f6874821713420aa7b8e114495c6ae4-6"></a>    <span class="n">g1</span> <span class="o">=</span> <span class="n">grad</span><span class="p">(</span><span class="n">x0</span><span class="p">)</span>
<a id="rest_code_0f6874821713420aa7b8e114495c6ae4-7" name="rest_code_0f6874821713420aa7b8e114495c6ae4-7" href="posts/hermite_interp/#rest_code_0f6874821713420aa7b8e114495c6ae4-7"></a>    <span class="n">g2</span> <span class="o">=</span> <span class="n">grad</span><span class="p">(</span><span class="n">x1</span><span class="p">)</span>
<a id="rest_code_0f6874821713420aa7b8e114495c6ae4-8" name="rest_code_0f6874821713420aa7b8e114495c6ae4-8" href="posts/hermite_interp/#rest_code_0f6874821713420aa7b8e114495c6ae4-8"></a>    <span class="n">N1</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="mi">4</span><span class="o">*</span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="mi">2</span> <span class="o">+</span> <span class="n">x</span><span class="p">)</span>
<a id="rest_code_0f6874821713420aa7b8e114495c6ae4-9" name="rest_code_0f6874821713420aa7b8e114495c6ae4-9" href="posts/hermite_interp/#rest_code_0f6874821713420aa7b8e114495c6ae4-9"></a>    <span class="n">N2</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="mi">4</span><span class="o">*</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="mi">2</span> <span class="o">-</span> <span class="n">x</span><span class="p">)</span>
<a id="rest_code_0f6874821713420aa7b8e114495c6ae4-10" name="rest_code_0f6874821713420aa7b8e114495c6ae4-10" href="posts/hermite_interp/#rest_code_0f6874821713420aa7b8e114495c6ae4-10"></a>    <span class="n">N3</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="mi">4</span><span class="o">*</span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<a id="rest_code_0f6874821713420aa7b8e114495c6ae4-11" name="rest_code_0f6874821713420aa7b8e114495c6ae4-11" href="posts/hermite_interp/#rest_code_0f6874821713420aa7b8e114495c6ae4-11"></a>    <span class="n">N4</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="mi">4</span><span class="o">*</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
<a id="rest_code_0f6874821713420aa7b8e114495c6ae4-12" name="rest_code_0f6874821713420aa7b8e114495c6ae4-12" href="posts/hermite_interp/#rest_code_0f6874821713420aa7b8e114495c6ae4-12"></a>    <span class="n">interp</span> <span class="o">=</span> <span class="n">N1</span><span class="o">*</span><span class="n">f1</span> <span class="o">+</span> <span class="n">N2</span><span class="o">*</span><span class="n">f2</span> <span class="o">+</span> <span class="n">jaco</span><span class="o">*</span><span class="p">(</span><span class="n">N3</span><span class="o">*</span><span class="n">g1</span> <span class="o">+</span> <span class="n">N4</span><span class="o">*</span><span class="n">g2</span><span class="p">)</span>
<a id="rest_code_0f6874821713420aa7b8e114495c6ae4-13" name="rest_code_0f6874821713420aa7b8e114495c6ae4-13" href="posts/hermite_interp/#rest_code_0f6874821713420aa7b8e114495c6ae4-13"></a>    <span class="k">return</span> <span class="n">interp</span>
</pre></div>
<p>En este caso, interpolamos la función <code class="docutils literal">sinc</code></p>
<div class="code"><pre class="code ipython2"><a id="rest_code_40df3bc1bfc34e64af886ce118c25833-1" name="rest_code_40df3bc1bfc34e64af886ce118c25833-1" href="posts/hermite_interp/#rest_code_40df3bc1bfc34e64af886ce118c25833-1"></a><span class="k">def</span> <span class="nf">fun</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<a id="rest_code_40df3bc1bfc34e64af886ce118c25833-2" name="rest_code_40df3bc1bfc34e64af886ce118c25833-2" href="posts/hermite_interp/#rest_code_40df3bc1bfc34e64af886ce118c25833-2"></a>    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">x</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">x</span><span class="p">)</span>
<a id="rest_code_40df3bc1bfc34e64af886ce118c25833-3" name="rest_code_40df3bc1bfc34e64af886ce118c25833-3" href="posts/hermite_interp/#rest_code_40df3bc1bfc34e64af886ce118c25833-3"></a>
<a id="rest_code_40df3bc1bfc34e64af886ce118c25833-4" name="rest_code_40df3bc1bfc34e64af886ce118c25833-4" href="posts/hermite_interp/#rest_code_40df3bc1bfc34e64af886ce118c25833-4"></a>
<a id="rest_code_40df3bc1bfc34e64af886ce118c25833-5" name="rest_code_40df3bc1bfc34e64af886ce118c25833-5" href="posts/hermite_interp/#rest_code_40df3bc1bfc34e64af886ce118c25833-5"></a><span class="k">def</span> <span class="nf">grad</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<a id="rest_code_40df3bc1bfc34e64af886ce118c25833-6" name="rest_code_40df3bc1bfc34e64af886ce118c25833-6" href="posts/hermite_interp/#rest_code_40df3bc1bfc34e64af886ce118c25833-6"></a>    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">x</span><span class="p">)</span><span class="o">/</span><span class="n">x</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">x</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
<p>El siguiente bloque de código calcula la interpolación y la grafica.</p>
<div class="code"><pre class="code ipython2"><a id="rest_code_9741d3749a8f4a2daea7194237daeb0a-1" name="rest_code_9741d3749a8f4a2daea7194237daeb0a-1" href="posts/hermite_interp/#rest_code_9741d3749a8f4a2daea7194237daeb0a-1"></a><span class="n">a</span> <span class="o">=</span> <span class="mi">2</span>
<a id="rest_code_9741d3749a8f4a2daea7194237daeb0a-2" name="rest_code_9741d3749a8f4a2daea7194237daeb0a-2" href="posts/hermite_interp/#rest_code_9741d3749a8f4a2daea7194237daeb0a-2"></a><span class="n">b</span> <span class="o">=</span> <span class="mi">5</span>
<a id="rest_code_9741d3749a8f4a2daea7194237daeb0a-3" name="rest_code_9741d3749a8f4a2daea7194237daeb0a-3" href="posts/hermite_interp/#rest_code_9741d3749a8f4a2daea7194237daeb0a-3"></a><span class="n">nels</span> <span class="o">=</span> <span class="mi">7</span>
<a id="rest_code_9741d3749a8f4a2daea7194237daeb0a-4" name="rest_code_9741d3749a8f4a2daea7194237daeb0a-4" href="posts/hermite_interp/#rest_code_9741d3749a8f4a2daea7194237daeb0a-4"></a><span class="n">npts</span> <span class="o">=</span> <span class="mi">200</span>
<a id="rest_code_9741d3749a8f4a2daea7194237daeb0a-5" name="rest_code_9741d3749a8f4a2daea7194237daeb0a-5" href="posts/hermite_interp/#rest_code_9741d3749a8f4a2daea7194237daeb0a-5"></a><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">npts</span><span class="p">)</span>
<a id="rest_code_9741d3749a8f4a2daea7194237daeb0a-6" name="rest_code_9741d3749a8f4a2daea7194237daeb0a-6" href="posts/hermite_interp/#rest_code_9741d3749a8f4a2daea7194237daeb0a-6"></a><span class="n">y</span> <span class="o">=</span> <span class="n">fun</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a id="rest_code_9741d3749a8f4a2daea7194237daeb0a-7" name="rest_code_9741d3749a8f4a2daea7194237daeb0a-7" href="posts/hermite_interp/#rest_code_9741d3749a8f4a2daea7194237daeb0a-7"></a><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">"black"</span><span class="p">)</span>
<a id="rest_code_9741d3749a8f4a2daea7194237daeb0a-8" name="rest_code_9741d3749a8f4a2daea7194237daeb0a-8" href="posts/hermite_interp/#rest_code_9741d3749a8f4a2daea7194237daeb0a-8"></a><span class="n">xi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">num</span><span class="o">=</span><span class="n">nels</span><span class="p">,</span> <span class="n">endpoint</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<a id="rest_code_9741d3749a8f4a2daea7194237daeb0a-9" name="rest_code_9741d3749a8f4a2daea7194237daeb0a-9" href="posts/hermite_interp/#rest_code_9741d3749a8f4a2daea7194237daeb0a-9"></a><span class="n">dx</span> <span class="o">=</span> <span class="n">xi</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">xi</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<a id="rest_code_9741d3749a8f4a2daea7194237daeb0a-10" name="rest_code_9741d3749a8f4a2daea7194237daeb0a-10" href="posts/hermite_interp/#rest_code_9741d3749a8f4a2daea7194237daeb0a-10"></a><span class="k">for</span> <span class="n">x0</span> <span class="ow">in</span> <span class="n">xi</span><span class="p">:</span>
<a id="rest_code_9741d3749a8f4a2daea7194237daeb0a-11" name="rest_code_9741d3749a8f4a2daea7194237daeb0a-11" href="posts/hermite_interp/#rest_code_9741d3749a8f4a2daea7194237daeb0a-11"></a>    <span class="n">x1</span> <span class="o">=</span> <span class="n">x0</span> <span class="o">+</span> <span class="n">dx</span>
<a id="rest_code_9741d3749a8f4a2daea7194237daeb0a-12" name="rest_code_9741d3749a8f4a2daea7194237daeb0a-12" href="posts/hermite_interp/#rest_code_9741d3749a8f4a2daea7194237daeb0a-12"></a>    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">npts</span><span class="p">)</span>
<a id="rest_code_9741d3749a8f4a2daea7194237daeb0a-13" name="rest_code_9741d3749a8f4a2daea7194237daeb0a-13" href="posts/hermite_interp/#rest_code_9741d3749a8f4a2daea7194237daeb0a-13"></a>    <span class="n">y</span> <span class="o">=</span> <span class="n">hermite_interp</span><span class="p">(</span><span class="n">fun</span><span class="p">,</span> <span class="n">grad</span><span class="p">,</span> <span class="n">x0</span><span class="o">=</span><span class="n">x0</span><span class="p">,</span> <span class="n">x1</span><span class="o">=</span><span class="n">x1</span><span class="p">,</span> <span class="n">npts</span><span class="o">=</span><span class="n">npts</span><span class="p">)</span>
<a id="rest_code_9741d3749a8f4a2daea7194237daeb0a-14" name="rest_code_9741d3749a8f4a2daea7194237daeb0a-14" href="posts/hermite_interp/#rest_code_9741d3749a8f4a2daea7194237daeb0a-14"></a><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">"dashed"</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">"#4daf4a"</span><span class="p">)</span>
<a id="rest_code_9741d3749a8f4a2daea7194237daeb0a-15" name="rest_code_9741d3749a8f4a2daea7194237daeb0a-15" href="posts/hermite_interp/#rest_code_9741d3749a8f4a2daea7194237daeb0a-15"></a><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]],</span> <span class="p">[</span><span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">y</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]],</span> <span class="n">marker</span><span class="o">=</span><span class="s2">"o"</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">"#4daf4a"</span><span class="p">,</span>
<a id="rest_code_9741d3749a8f4a2daea7194237daeb0a-16" name="rest_code_9741d3749a8f4a2daea7194237daeb0a-16" href="posts/hermite_interp/#rest_code_9741d3749a8f4a2daea7194237daeb0a-16"></a>         <span class="n">linewidth</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<a id="rest_code_9741d3749a8f4a2daea7194237daeb0a-17" name="rest_code_9741d3749a8f4a2daea7194237daeb0a-17" href="posts/hermite_interp/#rest_code_9741d3749a8f4a2daea7194237daeb0a-17"></a><span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">"x"</span><span class="p">)</span>
<a id="rest_code_9741d3749a8f4a2daea7194237daeb0a-18" name="rest_code_9741d3749a8f4a2daea7194237daeb0a-18" href="posts/hermite_interp/#rest_code_9741d3749a8f4a2daea7194237daeb0a-18"></a><span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">"y"</span><span class="p">)</span>
<a id="rest_code_9741d3749a8f4a2daea7194237daeb0a-19" name="rest_code_9741d3749a8f4a2daea7194237daeb0a-19" href="posts/hermite_interp/#rest_code_9741d3749a8f4a2daea7194237daeb0a-19"></a><span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s2">"Exact function"</span><span class="p">,</span> <span class="s2">"Interpolation"</span><span class="p">])</span>
<a id="rest_code_9741d3749a8f4a2daea7194237daeb0a-20" name="rest_code_9741d3749a8f4a2daea7194237daeb0a-20" href="posts/hermite_interp/#rest_code_9741d3749a8f4a2daea7194237daeb0a-20"></a><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
<img alt="/images/sinc_interp.svg" src="../images/sinc_interp.svg"><section id="referencias"><h2>Referencias</h2>
<aside class="footnote-list brackets"><aside class="footnote brackets" id="footnote-1" role="note"><span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="posts/hermite_interp/#footnote-reference-1">1</a><span class="fn-bracket">]</span></span>
<p>Walter Gautschi (1962). On inverses of Vandermonde
and confluent Vandermonde matrices. Numerische Mathematik, 4
117-123.</p>
</aside></aside></section>
</div>
    </article><article class="post h-entry post-text"><header><h1 class="post-title p-name"><a href="posts/herramientas-investigacion/" class="u-url">Herramientas (auxiliares) para Investigación</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn">Nicolás Guarín-Zapata</span></p>
            <p class="dateline"><a href="posts/herramientas-investigacion/" rel="bookmark"><time class="post-date published dt-published" datetime="2014-07-12T04:24:00-05:00" title="2014-07-12 04:24">2014-07-12 04:24</time></a></p>
                <p class="commentline">
    
    <a href="posts/herramientas-investigacion/#disqus_thread" data-disqus-identifier="cache/posts/herramientas-investigacion.html">Comentarios</a>


        </p>
</div>
    </header><div class="e-content entry-content">
    <p>En esta entrada quiero hablar de algunas herramientas (...o algo así)
que son útiles en el día a día de la investigación, pero que no suelen
ser tan populares por ser en cierta forma <em>tangenciales</em> al área
específica en la que cada uno trabaja.</p>
<section id="scripting"><h2>Scripting</h2>
<p>Un <a class="reference external" href="http://en.wikipedia.org/wiki/Scripting_language">script</a>  es un
programa <em>usualmente</em> simple que realiza una serie de tareas. ¡Lo
siento! trato de ceñirme al castellano pero no me gustan las
traducciones para este término (archivo de órdenes, archivo de
procesamiento por lotes o guion). Si existe una tarea que debe ser
hecha más de... cinco veces (el número varía de acuerdo a la
paciencia), entonces creo que es algo que podemos pedirle al
computador que haga esta tarea por nosotros. En otras palabras:
podemos automatizar ese trabajo. Algunas tareas que pueden ser una
buena alternativa para automatizar son: renombrar 100 archivos,
convertir un archivo de un formato a otro (p. ej., STL a OBJ), leer
387 archivos con información sobre el clima y graficar su evolución
temporal (temperatura mínima, máxima y promedio). Estas tareas pueden
ser fáciles de hacer a mano, pero por la cantidad de trabajo que
involucran son tediosas.</p>
<p>Lo primero es hacernos con un lenguaje de scripting. Algunas opciones
son <a class="reference external" href="https://www.python.org/">Python</a>,
<a class="reference external" href="http://www.gnu.org/software/bash/">Bash</a>,
<a class="reference external" href="http://julialang.org/">Julia</a>,
<a class="reference external" href="http://www.mathworks.com/products/matlab/">Matlab</a>/<a class="reference external" href="http://www.gnu.org/software/octave/">Octave</a>,
<a class="reference external" href="http://www.scilab.org/">Scilab</a>. Dejándome llevar por el sesgo,
recomiendo usar Python.</p>
</section><section id="graficos-y-esquemas"><h2>Gráficos y esquemas</h2>
<p>Una imagen vale más que mil palabras, o eso dice el dicho.
Personalmente, me parece absolutamente cierto y trato de hacer
<em>dibujitos</em> para poder entender mejor algo o lograrlo explicar mejor.
Lo primero que me gustaría mencionar es la diferencia entre imágenes
de mapas de bits (o ráster) e imágenes vectoriales.</p>
<ul class="simple">
<li><p><a class="reference external" href="http://en.wikipedia.org/wiki/Raster_graphics">Imagen de mapa de
bits</a>: es una imagen
que está representada por un arreglo (o rejilla rectangular) de
pixeles. Dicho de otro modo, se almacena la información de color que
hay en cada punto de la imagen. Los formatos más populares almacenan
la información comprimida. Para gráficos con alto contraste (como
esquemas o diagramas) el mejor formato es PNG. Si se tiene una
animación, GIF sería preferible. Y para el caso de fotografías es
mejor utilizar JPG.</p></li>
<li><p><a class="reference external" href="http://en.wikipedia.org/wiki/Vector_graphics">Imagen vectorial</a>:
es una imagen que está formada por entidades geométricas. En esta no
se almacena la información punto a punto sino <em>la construcción</em> de
las formas que la constituyen. Por esta razón, estas imágenes no se
<em>pixelan</em> pues la información que se tiene es de cómo construirla.
Este tipo de imágenes es la mejor opciones para esquemas y diagramas,
pues sólo se almacena la información de los trazos y texto que se
añadan en ellas (ver Figura 1). El estándar <em>de facto</em> para este tipo
de imágenes es PDF —es el que suelo para incluir en mis documentos
\(\LaTeX\), aunque existe forma de embeber SVG en \(\LaTeX\)
pero es algo que aún no exploro—. A pesar de que PDF sea el
<em>estándar</em>, el formato a preferir es <a class="reference external" href="http://en.wikipedia.org/wiki/Scalable_Vector_Graphics">SVG (Scalable Vector
Graphics)</a>
que es un estándar a través de la internet y la mayoría de
navegadores <em>modernos</em> permiten visualizar.</p></li>
</ul>
<p>Recapitulando, deberíamos usar imágenes JPG para fotografías y SVG
para esquemas/diagramas. Otro atributo que puede ser de utilidad es el
manejo de capas, SVG permite esto.... y de formatos ráster tenemos la
opción de usar TIFF.</p>
<p>En cuanto a software para generar/editar este tipo de imágenes debo
decir que existen gran cantidad de programas que permiten exportar a
estos formatos: Python/Matplotlib, Matlab, Inkscape, Adobe
Illustrator, GIMP, Photoshop, LibreOffice. Si el gráfico es generado a
partir de un cálculo o de una serie de datos yo uso Matplotlib. Si en
cambio, queremos hacer un esquema o —como suelo decir— un muñeco mi
herramienta favorita es <a class="reference external" href="http://www.inkscape.org/">Inkscape.</a> Este
programa pretende ser una alternativa libre a programas como Adobe
Illustrator —y sí que lo consigue. Obviamente, se podría usar
Illustrator o Corel Draw para esta tarea. Si el único uso sería hacer
esquemas técnico, creo que sería un desperdicio.</p>
<table><tbody>
<tr>
<td><img alt="/images/sensor_hall.png" src="../images/sensor_hall.png"></td>
</tr>
<tr>
<td><p><strong>Figura 1.</strong> Esquema de sensado de campo magnético de <a class="reference external" href="http://en.wikipedia.org/wiki/Neodymium_magnet">imanes
permanentes</a> por
<a class="reference external" href="http://en.wikipedia.org/wiki/Hall_effect">efecto Hall</a>. Sacado
de mi <a class="reference external" href="https://goo.gl/G9RRhC">trabajo de grado</a> de Ingeniería
Física.</p></td>
</tr>
</tbody></table></section><section id="tomar-notas"><h2>Tomar notas</h2>
<p>Supongo que para algunos parecería un poco trivial hablar de "tomar
notas" y mucho más viniendo de alguien que no tenía cuadernos en el
bachillerato, pero como soy un poco terco creo que igual escribiré un
poco sobre esto. Lo primero que me gustaría mencionar es que recuerdo
que me hablaran de este tema en el colegio, pero nunca hubo nada
formal respecto a desarrollar estas habilidades. Buscando en la web,
hay gran cantidad de información. Incluso el artículo de <a class="reference external" href="http://en.wikipedia.org/wiki/Note-taking">Wikipedia en
inglés</a> es interesante.
No hay nada mejor para escribir que tener una pluma y un papel de buen
gramaje, por eso es que aún uso un cuaderno en donde llevo cuenta de
lo que hago en mi investigación y tomo notas. Sin embargo, este
esquema es bastante lineal y deja por fuera oportunidades más
<em>contemporáneas.</em> Es decir ¿por qué conformarse con un documento en
este tiempo de hiper-documentos? Las ventajas de tomar notas
digitalmente saltan a la vista, en un hiper-documento se pueden tener
enlaces, embeber imágenes, video y sonido.</p>
<p>En cuanto a herramientas, acá incluyo una pequeña lista:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://evernote.com/">Evernote</a> es probablemente la herramienta
más popular para tomar notas. Es multiplataforma, Freemium
(funcionalidad básica gratuita y avanzada paga), y cuenta con muchas
opciones. Yo la uso, pero no mucho en mi investigación.</p></li>
<li><p><a class="reference external" href="http://zim-wiki.org/">Zim</a> es una wiki offline. Tiene gran
cantidad de opciones como calendario, ecuaciones con código
<span class="math">\(\LaTeX\)</span>, imágenes... en fin. El pero que le encuentro es que no
he logrado configurar las ecuaciones en Windows (y en mi oficina debo
usar Windows :-/).</p></li>
<li><p><a class="reference external" href="http://www.docear.org/">Docear</a> esta es una herramienta pensada,
principalmente, para manejar bibliografía. Sin embargo, permite tomar
notas y, en general, manejar la información de la investigación. La
característica más (o menos) atractiva es que funciona alrededor de
mapas mentales.</p></li>
<li><p><a class="reference external" href="https://www.zotero.org/">Zotero</a> también es una herramienta para
manejar bibliografía, aunque permite manejar algo de toma de notas
(al menos alrededor de la bibliografía).</p></li>
<li><p><a class="reference external" href="http://www.mendeley.com/">Mendeley</a> es muy parecido al anterior,
aunque con más funcionalidades. El pero más grande que le encuentro
es que en 2013 fue comprado por Elsevier.</p></li>
</ul>
<p>En cuanto a manejo de bibliografía también me gustaría mencionar
<a class="reference external" href="http://endnote.com/">EndNote</a> que es el programa con mayor
trayectoria y  <a class="reference external" href="http://jabref.sourceforge.net/">JabRef</a> que es el
que he usado por más tiempo. Algunas referencias interesantes
comparando manejadores de bibliografía están acá:
<a class="reference external" href="https://www.researchgate.net/post/alternative_to_Endnote?_tpcectx=qa_overview_following">[A]</a>
<a class="reference external" href="http://www.docear.org/2013/10/14/what-makes-a-bad-reference-manager/">[B]</a>
<a class="reference external" href="http://www.docear.org/2014/01/15/comprehensive-comparison-of-reference-managers-mendeley-vs-zotero-vs-docear/">[C]</a>.</p>
</section><section id="reconstruccion-de-graficos"><h2>Reconstrucción de gráficos</h2>
<p>Es común encontrarse con información presentada en forma de gráficos.
También es común que queramos tener los datos numéricos de estos
gráficos para poder compararlos con los nuestros. Para saber si
nuestras medidas/simulaciones/métodos dan resultados similares a otros
presentados en la literatura. Para esta tarea se pueden usar potentes
software de procesamiento de imágenes, u otros más modestos diseñados
específicamente para este fin.</p>
<table><tbody>
<tr>
<td><img alt="/images/pointplot.jpg" src="../images/pointplot.jpg"></td>
</tr>
<tr>
<td><p><strong>Figura 2.</strong> Gráfico original.</p></td>
</tr>
</tbody></table>
<table><tbody>
<tr>
<td><img alt="/images/digitized_pts.png" src="../images/digitized_pts.png"></td>
</tr>
<tr>
<td><p><strong>Figura 3.</strong> Gráfico procesado en Engauge Digitizer. Algunos puntos
fueron seleccionados (automáticamente) para obtener sus coordenadas.</p></td>
</tr>
</tbody></table>
<ul class="simple">
<li><p><a class="reference external" href="http://extensions.libreoffice.org/extension-center/digitizer-of-xy-chart">Digitizer of XY
chart</a>
este es un plugin para Libreoffice/OpenOffice y exporta el resultado
a la hoja de cálculo actual, es simple y fácil de usar.</p></li>
<li><p><a class="reference external" href="http://digitizer.sourceforge.net/">Engauge Digitizer</a>, es el que
normalmente uso cuando necesito hacer esta tarea (ver Figuras XX). Es
de código abierto (y libre) y tiene una buena cantidad de opciones
para facilitar la tarea.</p></li>
<li><p><a class="reference external" href="http://plotdigitizer.sourceforge.net/">Plot Digitizer</a> no tengo
mucha información sobre este (pues nunca lo he usado), salvo que está
escrito en Java.</p></li>
<li><p><a class="reference external" href="http://imagej.nih.gov/ij/">ImageJ</a> este es un (completo) programa
de procesamiento de imágenes que está escrito en Java. No lo he usado
para esta tarea de manera regular, pero podría usarse para ello.</p></li>
</ul></section><section id="visualizacion-cientifica"><h2>Visualización científica</h2>
<p>La <a class="reference external" href="https://en.wikipedia.org/wiki/Scientific_visualization">visualización
científica</a>
que se encarga de generar gráficos que permitan visualizar "datos
científicos" para facilitar el entendimiento que hay detrás de los
datos. Para esta labor muchos hemos usado lenguajes de scripting como
Matlab/Octave, Scilab o Python (con Matplotlib o Mayavi). Sin embargo,
como la visualización se trata de algo visual —¿como si no?—, es bueno
contar con una herramienta que permita generar y cambiar los gráficos
de manera interactiva, aunque siempre debemos automatizar la mayor
cantidad de trabajo posible (la pereza siempre ha sido uno de los
móviles más grandes de la humanidad, hay que aceptarlo).</p>
<ul class="simple">
<li><p><a class="reference external" href="http://code.enthought.com/projects/mayavi/">MayaVi</a>, este es un
programa escrito en Python que usa
<a class="reference external" href="http://en.wikipedia.org/wiki/VTK">VTK</a>. Es una herramienta muy
versátil y la gran ventaja que tiene es que puede usarse dentro de
<a class="reference external" href="https://scipy-lectures.github.io/packages/3d_plotting/index.html">scripts</a>
de Python.</p></li>
<li><p><a class="reference external" href="http://www.paraview.org/">Paraview</a>, este programa también está
basado en VTK y permite paralelizar las labores (para los
computadores con múltiple núcleo y los clústers). Abajo incluyo un
video generado en Paraview para mostrar sus capacidades.</p></li>
<li><p><a class="reference external" href="https://wci.llnl.gov/simulation/computer-codes/visit">Visit</a>,
este programa también está basado en VTK, nunca lo he usado pero
quise incluirlo porque la gente dice que puede ser más intuitivo que
Paraview.</p></li>
<li><p><a class="reference external" href="http://www.tecplot.com/">Tecplot,</a> este programa es muy popular
en Purdue. Creo que inicialmente fue pensado para CFD, pero se ha
expandido mucho. En cuanto a gráficos 3D no me parece mejor que
ParaView, sin embargo, las capacidades de gráficos 2D (gráficos XY, y
demás) lo hacen atractivo.</p></li>
<li><p><a class="reference external" href="http://jwork.org/scavis/">Scavis</a>, este está escrito en Java. No
lo conocía hasta que inicie la escritura de esta entrada pero me
llamó la atención y quise incluirlo en la lista. Algo que me llamó
la atención es que permite scripting en varios lenguajes: Java,
Python, Ruby, BeanShell y Matlab/Octave.</p></li>
<li><p><a class="reference external" href="http://www.originlab.com/">Origin</a>, nunca lo he usado pero no lo
quise dejar por fuera porque siempre he oído hablar maravillas de él
(probablemente compárandolo con Excel... pero no puedo opinar).</p></li>
</ul>
<iframe src="https://player.vimeo.com/video/2016815" width="640" height="483" frameborder="0" webkitallowfullscreen mozallowfullscreen allowfullscreen>
</iframe>
<p>
    <ahref>Simulación de fuego cruzado en <a href="https://vimeo.com">Vimeo</a>.
</ahref></p></section><section id="manejo-de-versiones"><h2>Manejo de versiones</h2>
<p>El <a class="reference external" href="http://en.wikipedia.org/wiki/Revision_control">manejo de
versiones</a> es la
administración de cambios en documentos, código fuente y otro tipo de
información. Esto puede hacerse de forma manual, pero es fácil cometer
errores o remplazar la versión de un código fácilmente, y por esto es
recomendable usar un software que facilite el trabajo. La idea es
tener un <em>lugar</em> (repositorio) en donde se almacenan las versiones y
los cambios, y llevar un registro de estos. De esta forma se puede
volver a una versión anterior de los documentos y varias personas
pueden trabajar conjuntamente.  Existen dos paradigmas (o
arquitecturas) para el manejo de versiones: centralizada y
distribuida. En la primera existe un repositorio centralizado en donde
se encuentra toda la información. En la arquitectura distribuida cada
usuario tiene una copia del respositorio. Personalmente sólo he usado
<a class="reference external" href="http://git-scm.com/">Git</a>, que entra en la categoría distribuida y
es uno de los software de manejo de versiones más populares
actualmente; lo usan compañías como Google, Facebook y Netflix.</p>
<p>Un ejemplo puede verse en este
<a class="reference external" href="https://github.com/bebopsan/SEC-Thesis">repositorio</a>, en donde
está el documento de trabajo de grado de Santiago Echeverri, el cual
tuve la oportunidad de asesorar. Este documento lo editamos
conjuntamente mientras él estaba en Medellín  y yo me encontraba en
Estados Unidos. El documento se hizo en el lenguaje de marcadores
<span class="math">\(\LaTeX\)</span>.</p>
<p>Además de tener un control sobre las versiones y poder acceder a
versiones anteriores, es útil poder almacenar la información en un
lugar accesible desde cualquier lugar del mundo con una conexión a
internet. Esto puede lograrse con un servidor propio, obviamente, o
también a través de un proveedor externo. Dos proyectos que  son muy
populares para alojar repositorios y manejar sus versiones son
(<a class="reference external" href="http://www.infoworld.com/d/application-development/bitbucket-vs-github-which-project-host-has-the-most-227061">comparación entre Github y
BitBucket</a>):</p>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/">Github</a>  es el más popular en este momento.
Permite tener proyectos con un número ilimitado de colaboradores.
Para tener un repositorio privado es necesario pagar.</p></li>
<li><p><a class="reference external" href="https://bitbucket.org/">BitBucket</a> tiene como principal ventaja que
permite tener repositorios privados sin la necesidad de pagar. Sólo
es gratuito para proyectos con 5 colaboradores o menos (o para
proyectos <a class="reference external" href="https://bitbucket.org/account/user/nicoguaro/plans/">académicos</a>).</p></li>
</ul></section><section id="enlaces-sugeridos"><h2>Enlaces sugeridos</h2>
<ol class="arabic simple">
<li><p>Software Carpentry. <a class="reference external" href="http://software-carpentry.org/">http://software-carpentry.org/</a></p></li>
<li><p>Python Scientific Lecture Notes. <a class="reference external" href="https://scipy-lectures.github.io/">https://scipy-lectures.github.io/</a></p></li>
</ol>
<p>Seguro dejé mucho temas por fuera así como herramientas dentro de
algún tópico. Si ese es el caso, agradecería que me lo digan en los
comentarios.</p>
</section>
</div>
    </article><article class="post h-entry post-text"><header><h1 class="post-title p-name"><a href="posts/la-zorra-y-las-uvas/" class="u-url">La zorra y las uvas</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn">Nicolás Guarín-Zapata</span></p>
            <p class="dateline"><a href="posts/la-zorra-y-las-uvas/" rel="bookmark"><time class="post-date published dt-published" datetime="2014-05-28T23:27:00-05:00" title="2014-05-28 23:27">2014-05-28 23:27</time></a></p>
                <p class="commentline">
    
    <a href="posts/la-zorra-y-las-uvas/#disqus_thread" data-disqus-identifier="cache/posts/la-zorra-y-las-uvas.html">Comentarios</a>


        </p>
</div>
    </header><div class="e-content entry-content">
    <p>Mirando en internet no encontré una versión en español de la fábula de
Esopo "La zorra y las uvas" que me gustara (o que al menos rimara :P).
De hecho, el artículo de Wikipedia en
<a class="reference external" href="http://es.m.wikipedia.org/wiki/La_zorra_y_las_uvas">español</a> es
bastante más malo que su equivalente en
<a class="reference external" href="http://en.m.wikipedia.org/wiki/The_Fox_and_the_Grapes">inglés</a>.  Por
esto, y por petición de una amiga, hice mi versión con rima asonante. Y
reza así</p>
<p><strong>La Zorra y las uvas</strong></p>
<div class="line-block">
<div class="line">La zorra que con ansias uvas buscaba</div>
<div class="line">no pudo alcanzarlas por lo alto que estaban.</div>
<div class="line">Giró y exclamó, con risa lastimera:</div>
<div class="line">¡Están verdes! No valen mi espera.</div>
</div>
<div class="line-block">
<div class="line"><br></div>
</div>
    </div>
    </article><article class="post h-entry post-text"><header><h1 class="post-title p-name"><a href="posts/notas-tableta/" class="u-url">Tomando notas de clase con mi tableta</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn">Nicolás Guarín-Zapata</span></p>
            <p class="dateline"><a href="posts/notas-tableta/" rel="bookmark"><time class="post-date published dt-published" datetime="2014-05-20T21:23:00-05:00" title="2014-05-20 21:23">2014-05-20 21:23</time></a></p>
                <p class="commentline">
    
    <a href="posts/notas-tableta/#disqus_thread" data-disqus-identifier="cache/posts/notas-tableta.html">Comentarios</a>


        </p>
</div>
    </header><div class="e-content entry-content">
    <p>El año pasado el niño dios me regaló una <a class="reference external" href="http://www.samsung.com/us/mobile/galaxy-note/GT-N8013EAVXAR">Samsung Galaxy Note
10.1</a>
(modelo 2012). Esta tableta viene diseñada para tomar notas, pues trae
un S-Pen (fabricado por Wacom, que creo que fabrican la
<a class="reference external" href="http://www.wacom.com/en/us/business/technology-solutions">tecnología</a>
para la mayoría de tabletas comerciales) y varias aplicaciones
pensadas para ello. Como: S Note, PhotoShop Touch, <a class="reference external" href="http://www.crayonphysics.com/">Crayon
Physics</a> (tienen que jugarlo es muy
divertido).</p>
<p>Decidí entonces hacer un experimento tomando notas de clase con mi
tableta completamente en las dos materias que cursé en el "semestre"
de primavera de 2014. En Optimización usé el lapiz que viene con la
tableta y para Física Molecular usé un <a class="reference external" href="http://www.wacom.com/en/us/everyday/bamboo-stylus-feel-samsung-galaxy-note">Bamboo
Stylus</a>
que, se supone, es diseñado específicamente para esta tableta. Las
notas las tomé con el software por defecto (S Note) y convertí a PDF
(las notas fueron hechas enteramente con el software):</p>
<ul class="simple">
<li><p><a class="reference external" href="https://drive.google.com/file/d/0ByfUxGpgeoJ9TExLUkJ5TGVNYzA/edit?usp=sharing">Notas de
Optimización</a></p></li>
<li><p><a class="reference external" href="https://drive.google.com/file/d/0ByfUxGpgeoJ9aEJQejZIYzFHdk0/edit?usp=sharing">Notas de Física Computacional
(Bio)Molecular</a></p></li>
</ul>
<p>Aunque la sensación al tacto del Bamboo Stylus es mucho más agradable,
el desempeño del S Pen es mucho mejor. En ambos casos, la sensación es
muy diferente a la de usar papel y lápiz (lapicero/pluma), en gran
medida porque la fricción es muy poca en comparación (algo que es
mejor con los lapices conductores). La experiencia de usuario del
lápiz varía mucho entre una aplicación y otra, lo que genera buenas
expectativas. En cuanto a tomar notas: es muy recomendado para tomar
notas cortas (como reuniones); no tanto para tomar notas largas (como
notas de clase), a menos que se quiera tener una copia digital
fácilmente.</p>
<section id="apps"><h2>Apps</h2>
<p>La tecnología detrás de la tableta es la parte más importante. De
manera simple y rápida, el lapiz tiene una antena y la tableta una
rejilla de antenas que están sintonizadas en la misma frecuencia (<a class="reference external" href="http://en.wikipedia.org/wiki/Wacom#Technology">531
kHz</a>, en <a class="reference external" href="http://www.androidauthority.com/break-it-down-how-does-the-s-pen-work-154435/">este
enlace</a>
explican su funcionamiento un poco mejor). Sin embargo, también es
importante tener en cuenta el software que se usa para tomar nota:</p>
<p><a class="reference external" href="http://content.samsung.com/us/contents/aboutn/sNoteIntro.do">S
Note</a></p>
<ul class="simple">
<li><p>Es la aplicación nativa para tomar notas.</p></li>
<li><p>Tiene reconocimiento de formas y ecuaciones. Las ecuaciones deben ser
simples, no esperen tomar notas de Mecánica Cuántica o Mecánica del
Medio Continuo usado esta herramienta.</p></li>
<li><p>Permite insertar imágenes y grabar sonidos dentro de la aplicación.</p></li>
<li><p>Tiene "palm rejection".</p></li>
<li><p>El tamaño de papel no es configurable.</p></li>
</ul>
<p><a class="reference external" href="http://papyrusapp.com/">Papyrus</a></p>
<ul class="simple">
<li><p>Tiene "palm rejection" y permite configurar el dedo como borrador
(que puede ser útil).</p></li>
<li><p>Permite tener varios tamaños de papel y diferentes fondos.</p></li>
<li><p>Permite hacer rectángulos y elipses.</p></li>
<li><p>Los pinceles son muy básicos.</p></li>
</ul>
<p><a class="reference external" href="http://noteanytime.com/en/">Note Anytime</a></p>
<ul class="simple">
<li><p>Permite tener varios tamaños de papel.</p></li>
<li><p>Almacena los trazos vectorialmente y se pueden editar (cambiar color,
tamaño o estilo) posteriormente.</p></li>
<li><p>Tiene varios pinceles y además son configurables.</p></li>
<li><p>No puede convertir las notas en PDF.</p></li>
<li><p>No tiene "palm rejection".</p></li>
</ul>
<p><a class="reference external" href="http://code.google.com/p/android-quill/">Quill</a></p>
<ul class="simple">
<li><p>Es open source, aunque si lo adquieren a través de la "Google Store"
tiene costo.</p></li>
<li><p>El algoritmo de reconocimiento de trazos es mejor que el de los otros
software (y es ajustable).</p></li>
<li><p>Aún está en una etapa preliminar.</p></li>
</ul>
<p>Lástimosamente no hay una versión de
<a class="reference external" href="https://www.fiftythree.com/paper.html">Paper</a> (de
FiftyThree) para Android, y, aunque existe una versión de <a class="reference external" href="http://www.wacom.com/en/us/everyday/bamboo-paper">Bamboo
Paper</a> (de Wacom)
para Android no es compatible con esta tableta.</p>
</section><section id="en-conclusion"><h2>En conclusión</h2>
<p>Remplazar la toma de notas "tradicionales" por notas  "digitales"
puede ser un poco apresurado, pero es realizable. La aplicación que
viene por defecto (S Note) permite realizar el trabajo "out of the
box", pero podría ser mejor. Las aplicaciones que me parecen más
promisorias son: Note Anytime y Quill.</p>
</section>
</div>
    </article><article class="post h-entry post-text"><header><h1 class="post-title p-name"><a href="posts/ar-er-ir/" class="u-url">Palabras terminadas en "ar", "er" o "ir"</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn">Nicolás Guarín-Zapata</span></p>
            <p class="dateline"><a href="posts/ar-er-ir/" rel="bookmark"><time class="post-date published dt-published" datetime="2013-09-04T01:32:00-05:00" title="2013-09-04 01:32">2013-09-04 01:32</time></a></p>
                <p class="commentline">
    
    <a href="posts/ar-er-ir/#disqus_thread" data-disqus-identifier="cache/posts/ar-er-ir.html">Comentarios</a>


        </p>
</div>
    </header><div class="e-content entry-content">
    <p>Cuando estaba en el colegio, en ocasiones mencionaban las palabras terminadas
en "ar", "er" o "ir" —iguales al final de nuestros verbos en infinitivo— que no
eran verbos. Eran pocos ejemplos los que mencionaban, así que algunos años
después me dio el arrebato de hacer una
lista… y hela aquí:</p>
<table>
<thead><tr>
<th class="head"><p>AR</p></th>
<th class="head"><p>AR</p></th>
<th class="head"><p>AR</p></th>
<th class="head"><p>ER</p></th>
<th class="head"><p>IR</p></th>
</tr></thead>
<tbody>
<tr>
<td><p>agar</p></td>
<td><p>dispar</p></td>
<td><p>pajar</p></td>
<td><p>alfiler</p></td>
<td><p>cachemir</p></td>
</tr>
<tr>
<td><p>ajuar</p></td>
<td><p>ejemplar</p></td>
<td><p>paladar</p></td>
<td><p>alquiler</p></td>
<td><p>casimir</p></td>
</tr>
<tr>
<td><p>alar</p></td>
<td><p>escolar</p></td>
<td><p>palatar</p></td>
<td><p>amater</p></td>
<td><p>elixir</p></td>
</tr>
<tr>
<td><p>albañar</p></td>
<td><p>espectacular</p></td>
<td><p>palomar</p></td>
<td><p>anteayer</p></td>
<td><p>emir</p></td>
</tr>
<tr>
<td><p>albar</p></td>
<td><p>estelar</p></td>
<td><p>papilar</p></td>
<td><p>antier</p></td>
<td><p>faquir</p></td>
</tr>
<tr>
<td><p>alfar</p></td>
<td><p>extracurricular</p></td>
<td><p>par</p></td>
<td><p>atelier</p></td>
<td><p>kefir</p></td>
</tr>
<tr>
<td><p>alizar</p></td>
<td><p>familiar</p></td>
<td><p>paramilitar</p></td>
<td><p>ayer</p></td>
<td><p>menhir</p></td>
</tr>
<tr>
<td><p>almiar</p></td>
<td><p>fular</p></td>
<td><p>particular</p></td>
<td><p>bachiller</p></td>
<td><p>nadir</p></td>
</tr>
<tr>
<td><p>almimbar</p></td>
<td><p>globular</p></td>
<td><p>peculiar</p></td>
<td><p>bereber</p></td>
<td><p>porvenir</p></td>
</tr>
<tr>
<td><p>alminar</p></td>
<td><p>hangar</p></td>
<td><p>pendular</p></td>
<td><p>brigadier</p></td>
<td><p>sir</p></td>
</tr>
<tr>
<td><p>altar</p></td>
<td><p>hogar</p></td>
<td><p>peninsular</p></td>
<td><p>canciller</p></td>
<td><p>souvenir</p></td>
</tr>
<tr>
<td><p>alveolar</p></td>
<td><p>ijar</p></td>
<td><p>perpendicular</p></td>
<td><p>cualquier</p></td>
<td><p>visir</p></td>
</tr>
<tr>
<td><p>antealtar</p></td>
<td><p>impar</p></td>
<td><p>pilar</p></td>
<td><p>doquier</p></td>
<td><p>zafir</p></td>
</tr>
<tr>
<td><p>antisolar</p></td>
<td><p>insular</p></td>
<td><p>pinar</p></td>
<td><p>dossier</p></td>
<td></td>
</tr>
<tr>
<td><p>ar</p></td>
<td><p>intercelular</p></td>
<td><p>planar</p></td>
<td><p>enser</p></td>
<td></td>
</tr>
<tr>
<td><p>auricular</p></td>
<td><p>intraocular</p></td>
<td><p>polar</p></td>
<td><p>ester</p></td>
<td></td>
</tr>
<tr>
<td><p>avatar</p></td>
<td><p>jaguar</p></td>
<td><p>policelular</p></td>
<td><p>menester</p></td>
<td></td>
</tr>
<tr>
<td><p>axilar</p></td>
<td><p>juglar</p></td>
<td><p>pulgar</p></td>
<td><p>mercader</p></td>
<td></td>
</tr>
<tr>
<td><p>azahar</p></td>
<td><p>lagar</p></td>
<td><p>pulmonar</p></td>
<td><p>micer</p></td>
<td></td>
</tr>
<tr>
<td><p>azar</p></td>
<td><p>lanar</p></td>
<td><p>quasar</p></td>
<td><p>neceser</p></td>
<td></td>
</tr>
<tr>
<td><p>bacillar</p></td>
<td><p>lar</p></td>
<td><p>radar</p></td>
<td><p>palier</p></td>
<td></td>
</tr>
<tr>
<td><p>bar</p></td>
<td><p>limonar</p></td>
<td><p>radicular</p></td>
<td><p>placer</p></td>
<td></td>
</tr>
<tr>
<td><p>bazar</p></td>
<td><p>llar</p></td>
<td><p>rectangular</p></td>
<td><p>plumier</p></td>
<td></td>
</tr>
<tr>
<td><p>bicelular</p></td>
<td><p>lobular</p></td>
<td><p>reticular</p></td>
<td><p>premier</p></td>
<td></td>
</tr>
<tr>
<td><p>bienestar</p></td>
<td><p>lodazar</p></td>
<td><p>samovar</p></td>
<td><p>primer</p></td>
<td></td>
</tr>
<tr>
<td><p>bifilar</p></td>
<td><p>lugar</p></td>
<td><p>secular</p></td>
<td><p>rosicler</p></td>
<td></td>
</tr>
<tr>
<td><p>biliar</p></td>
<td><p>lunar</p></td>
<td><p>seglar</p></td>
<td><p>salmer</p></td>
<td></td>
</tr>
<tr>
<td><p>billar</p></td>
<td><p>malar</p></td>
<td><p>semicircular</p></td>
<td><p>somier</p></td>
<td></td>
</tr>
<tr>
<td><p>binocular</p></td>
<td><p>maleolar</p></td>
<td><p>semilunar</p></td>
<td><p>sumiller</p></td>
<td></td>
</tr>
<tr>
<td><p>bipolar</p></td>
<td><p>malvar</p></td>
<td><p>similar</p></td>
<td><p>taller</p></td>
<td></td>
</tr>
<tr>
<td><p>broncopulmonar</p></td>
<td><p>mandibular</p></td>
<td><p>solar</p></td>
<td><p>tercer</p></td>
<td></td>
</tr>
<tr>
<td><p>bulevar</p></td>
<td><p>manglar</p></td>
<td><p>subcelular</p></td>
<td><p>veguer</p></td>
<td></td>
</tr>
<tr>
<td><p>calamar</p></td>
<td><p>manillar</p></td>
<td><p>supraclavicular</p></td>
<td></td>
<td></td>
</tr>
<tr>
<td><p>calcañar</p></td>
<td><p>manjar</p></td>
<td><p>supralunar</p></td>
<td></td>
<td></td>
</tr>
<tr>
<td><p>capilar</p></td>
<td><p>mar</p></td>
<td><p>telar</p></td>
<td></td>
<td></td>
</tr>
<tr>
<td><p>capsular</p></td>
<td><p>maxilar</p></td>
<td><p>testicular</p></td>
<td></td>
<td></td>
</tr>
<tr>
<td><p>caviar</p></td>
<td><p>melocotonar</p></td>
<td><p>tisular</p></td>
<td></td>
<td></td>
</tr>
<tr>
<td><p>celular</p></td>
<td><p>melonar</p></td>
<td><p>trifilar</p></td>
<td></td>
<td></td>
</tr>
<tr>
<td><p>centenar</p></td>
<td><p>membrillar</p></td>
<td><p>trufar</p></td>
<td></td>
<td></td>
</tr>
<tr>
<td><p>ciliar</p></td>
<td><p>miliar</p></td>
<td><p>tubular</p></td>
<td></td>
<td></td>
</tr>
<tr>
<td><p>clavicular</p></td>
<td><p>militar</p></td>
<td><p>tular</p></td>
<td></td>
<td></td>
</tr>
<tr>
<td><p>collar</p></td>
<td><p>millar</p></td>
<td><p>ultramar</p></td>
<td></td>
<td></td>
</tr>
<tr>
<td><p>consular</p></td>
<td><p>molar</p></td>
<td><p>uvular</p></td>
<td></td>
<td></td>
</tr>
<tr>
<td><p>coplanar</p></td>
<td><p>mollar</p></td>
<td><p>vascular</p></td>
<td></td>
<td></td>
</tr>
<tr>
<td><p>crepuscular</p></td>
<td><p>muladar</p></td>
<td><p>vehicular</p></td>
<td></td>
<td></td>
</tr>
<tr>
<td><p>corpuscular</p></td>
<td><p>monocelular</p></td>
<td><p>vermicular</p></td>
<td></td>
<td></td>
</tr>
<tr>
<td><p>cuadrangular</p></td>
<td><p>mular</p></td>
<td><p>vesicular</p></td>
<td></td>
<td></td>
</tr>
<tr>
<td><p>cular</p></td>
<td><p>muscular</p></td>
<td><p>vulgar</p></td>
<td></td>
<td></td>
</tr>
<tr>
<td><p>curricular</p></td>
<td><p>nuclear</p></td>
<td><p>yugular</p></td>
<td></td>
<td></td>
</tr>
<tr>
<td><p>dactilar</p></td>
<td><p>ocular</p></td>
<td><p>zar</p></td>
<td></td>
<td></td>
</tr>
<tr>
<td><p>dinar</p></td>
<td><p>olivar</p></td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<div class="line-block">
<div class="line"><br></div>
</div>
<p>Si tienes alguna sugerencia de palabra que haga falta la puedes dejar en los
comentarios.</p>
<p>Última actualización: Octubre 21, 2022.</p>
<p>Descargar la lista en formato <a class="reference external" href="../downloads/ar_er_ir.csv">CSV</a> o en formato
<a class="reference external" href="../downloads/ar_er_ir.xls">XLS</a>.</p>
    </div>
    </article><article class="post h-entry post-text"><header><h1 class="post-title p-name"><a href="posts/teletransportacion-star-trek/" class="u-url">Respecto a la teletransportación en Star Trek</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn">Nicolás Guarín-Zapata</span></p>
            <p class="dateline"><a href="posts/teletransportacion-star-trek/" rel="bookmark"><time class="post-date published dt-published" datetime="2013-04-18T03:40:00-05:00" title="2013-04-18 03:40">2013-04-18 03:40</time></a></p>
                <p class="commentline">
    
    <a href="posts/teletransportacion-star-trek/#disqus_thread" data-disqus-identifier="cache/posts/teletransportacion-star-trek.html">Comentarios</a>


        </p>
</div>
    </header><div class="e-content entry-content">
    <p>Alguna vez una amiga me preguntó sobre cuál era más fácil de dos métodos para
teletransportar personas. Uno consistía en "desconfigurar" y "reconfigurar" a
la persona (como información, similar a <a class="reference external" href="http://en.wikipedia.org/wiki/Transporter_%28Star_Trek%29">Start Trek</a>
y la otra en "crear un atajo" entre dos lugares del espacio-tiempo para pasar
a la persona. Obviamente, en ambos casos suponiendo que tales cosas se pueden
hacer.</p>
<p>Respecto a la creación del atajo en el espacio-tiempo, creo que no he
estudiado las ecuaciones de Relatividad General para poder hacer las cuentas,
aunque tal vez en <a class="reference external" href="http://fisicapasion.blogspot.com/">Física Pasión</a>
nos regalen estos cálculos.</p>
<p>La primera de las alternativas consiste,
básicamente, en la representación de una persona como información y su
procesamiento de "desconfiguración", transmisión y procesamiento de
"reconfiguración". Ya que los humanos estamos hechos, mayormente,
de agua asumiremos una persona de agua para los cálculos. Además tomaremos
como masa de referencia <span class="math">\(70\ \mbox{kg}\)</span>.</p>
<p>Algunos datos que usaremos
son:</p>
<ul class="simple">
<li><p>La masa molar del agua es <span class="math">\(M_{H_2O}=18,01528\ \mbox{g/mol}\)</span>;</p></li>
<li><p>El número de Avogadro es <span class="math">\(N_A=6,022 \times 10^{23}/\mbox{mol}\)</span>.</p></li>
</ul>
<p>Entonces tendríamos que el número de moléculas en una persona es</p>
<div class="math">
\begin{equation*}
m_\text{persona} = \frac{70\ \mbox{kg}\ \mbox{moles}}
    {18,015\times 10^{-3} \text{kg}}
    =3885,7\ \mbox{moles}\, ,
\end{equation*}
</div>
<p>y el número de moléculas sería</p>
<div class="math">
\begin{equation*}
N_\text{moleculas} = N_A m_\text{persona} = 2,34\times 10^{27}\ \mbox{moleculas}\, .
\end{equation*}
</div>
<p>El agua tiene 12 modos vibracionales y 6 traslacionales, y además 40 números
cuánticos electrónicos. Lo que suma un total de 58 grados de libertad por
cada molécula. Así que el número total de grados de libertad es</p>
<div class="math">
\begin{equation*}
N_{GDL} = 1,36\times 10^{29}\, .
\end{equation*}
</div>
<p>En 2011 hubo un <a class="reference external" href="https://goo.gl/YEvzpM">record de transmisión</a>
de 186 Gb/s, considerando esta tasa el tiempo que tardaría en transmitirse la
totalidad de los datos (asumiendo datos representados como reales de 32 bits)
tardaría <span class="math">\(2,3\times 10^{16}\ \mbox{s}\)</span> o, equivalentemente,
<span class="math">\(1,70\times 10^{10}\)</span> años (la edad estimada del universo es de
<span class="math">\(1,37\times 10^{10}\)</span> años).</p>
<p>Si quisiéramos que esto pasara realmente rápido, digamos en 1 milisegundo,
la tasa de transmisión debería ser <span class="math">\(2,3\times 10^{19}\)</span> más rápida que el
récord que alcanzaron en el CERN… algo que es inconcebible para nosotros
actualmente.</p>
    </div>
    </article>
</div>

        <nav class="postindexpager"><ul class="pager">
<li class="previous">
                <a href="index-2.html" rel="prev">Publicaciones posteriores</a>
            </li>
        </ul></nav><script>var disqus_shortname="nicoguaro-github";(function(){var a=document.createElement("script");a.async=true;a.src="https://"+disqus_shortname+".disqus.com/count.js";(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(a)}());</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML" integrity="sha384-3lJUsx1TJHt7BA4udB5KPnDrlkO8T6J6v/op7ui0BbCjvZ9WqV4Xm6DTP6kQ/iBH" crossorigin="anonymous"></script><script type="text/x-mathjax-config">
        MathJax.Hub.Config({tex2jax: {inlineMath: [['$latex ','$'], ['\\(','\\)']]}});
        </script><footer id="footer"><p><a href="https://creativecommons.org/licenses/by/4.0/" rel="nofollow">CC BY 4.0</a> © 2022 <a href="mailto:nicoguarin@gmail.com">Nicolás Guarín-Zapata</a>- Powered by <a href="https://getnikola.com" rel="nofollow">Nikola</a></p>
            
        </footer>
</div>
    </div>
    <label for="sidebar-checkbox" class="sidebar-toggle"></label>
    
<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-145359674-1', 'auto');
ga('send', 'pageview');
</script><script src="../assets/js/all-nocdn.js"></script><!-- fancy dates --><script>
    moment.locale("es");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates -->
</body>
</html>
