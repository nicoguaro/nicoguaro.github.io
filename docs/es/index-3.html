<!DOCTYPE html>
<html prefix="" lang="es">
<head>
<meta charset="utf-8">
<meta name="description" content="Blog y sitio web personales">
<meta name="viewport" content="width=device-width">
<title>Nicolás' blog (publicaciones antiguas, página 3) | Nicolás' blog</title>
<link href="../assets/css/all.css" rel="stylesheet" type="text/css">
<link rel="stylesheet" href="//fonts.googleapis.com/css?family=PT+Serif:400,400italic,700%7CPT+Sans:400">
<link rel="alternate" type="application/rss+xml" title="RSS (en)" href="../rss.xml">
<link rel="alternate" type="application/rss+xml" title="RSS (es)" href="rss.xml">
<link rel="canonical" href="https://nicoguaro.github.io/es/index-3.html">
<link rel="prev" href="index-4.html" type="text/html">
<link rel="next" href="index-2.html" type="text/html">
<!--[if lt IE 9]><script src="../assets/js/html5.js"></script><![endif]-->
</head>
<body>
    <a href="#content" class="sr-only sr-only-focusable">Ir al contenido principal</a>
    <!-- Target for toggling the sidebar `.sidebar-checkbox` is for regular
            styles, `#sidebar-checkbox` for behavior. -->
    <input type="checkbox" class="sidebar-checkbox" id="sidebar-checkbox"><!-- Toggleable sidebar --><div class="sidebar" id="sidebar">
        <div class="sidebar-item">
            <p>A reserved <a href="https://getnikola.com" target="_blank">Nikola</a> theme that places the utmost gravity on content with a hidden drawer. Made by <a href="https://twitter.com/mdo" target="_blank">@mdo</a> for Jekyll,
            ported to Nikola by <a href="https://twitter.com/ralsina" target="_blank">@ralsina</a>.</p>
        </div>
        
    <nav id="menu" role="navigation" class="sidebar-nav"><a class="sidebar-nav-item" href="../pages/about/">About</a>
        <a class="sidebar-nav-item" href="../index.html">Blog</a>
        <a class="sidebar-nav-item" href="../pages/preprints-archive/">Preprints</a>
        <a class="sidebar-nav-item" href="../pages/links/">Links</a>
        <a class="sidebar-nav-item" href="../archive.html">Archive</a>
        <a class="sidebar-nav-item" href="../categories/">Tags</a>
        <a class="sidebar-nav-item" href="../rss.xml">RSS feed</a>
    
    
    </nav>
</div>

    <!-- Wrap is the content to shift when toggling the sidebar. We wrap the
         content to avoid any CSS collisions with our real content. -->
    <div class="wrap">
      <div class="masthead">
        <div class="container">
          
    <h3 id="brand" class="masthead-title">
      <a href="https://nicoguaro.github.io/es/" title="Nicolás' blog" rel="home">Nicolás' blog</a>
    </h3>

        </div>
      </div>

      <div class="container content" id="content">
        

<div class="posts">
    <article class="post h-entry post-text"><header><h1 class="post-title p-name"><a href="posts/numerical-22/" class="u-url">Reto de métodos numéricos: Día 22</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn">Nicolás Guarín-Zapata</span></p>
            <p class="dateline"><a href="posts/numerical-22/" rel="bookmark"><time class="post-date published dt-published" datetime="2017-10-22T10:51:10-05:00" title="2017-10-22 10:51">2017-10-22 10:51</time></a></p>
                <p class="commentline">
        
    <a href="posts/numerical-22/#disqus_thread" data-disqus-identifier="cache/posts/numerical-22.html">Comentarios</a>


        </p>
</div>
    </header><div class="e-content entry-content">
    <div>
<p>Durante octubre (2017) estaré escribiendo un programa por día para algunos
métodos numéricos famosos en Python y Julia. Esto está pensado como
un ejercicio, no esperen que el código sea lo suficientemente bueno para
usarse en la "vida real". Además, también debo mencionar que casi que no
tengo experiencia con Julia, así que probablemente no escriba un Julia
idiomático y se parezca más a Python.</p>
<div class="section" id="diferencias-finitas-problemas-de-valores-propios">
<h2>Diferencias finitas: problemas de valores propios</h2>
<p>Hoy tenemos el <a class="reference external" href="https://en.wikipedia.org/wiki/Finite_difference_method">método de diferencias finitas</a>
para calcular los modos de vibración de una viga. La ecuación de interés
es</p>
<div class="math">
\begin{equation*}
\nabla^ 4 u = k^2 u
\end{equation*}
</div>
<p>con</p>
<div class="math">
\begin{equation*}
u(0) = u(L)  = 0
\end{equation*}
</div>
<p>A continuación se presenta el código.</p>
<div class="section" id="python">
<h3>Python</h3>
<pre class="code python"><a name="rest_code_915b3d977fcd4a3ba27b855cc831c3fd-1"></a><span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">division</span><span class="p">,</span> <span class="n">print_function</span>
<a name="rest_code_915b3d977fcd4a3ba27b855cc831c3fd-2"></a><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<a name="rest_code_915b3d977fcd4a3ba27b855cc831c3fd-3"></a><span class="kn">from</span> <span class="nn">scipy.linalg</span> <span class="kn">import</span> <span class="n">eigh</span> <span class="k">as</span> <span class="n">eigsh</span>
<a name="rest_code_915b3d977fcd4a3ba27b855cc831c3fd-4"></a><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<a name="rest_code_915b3d977fcd4a3ba27b855cc831c3fd-5"></a>
<a name="rest_code_915b3d977fcd4a3ba27b855cc831c3fd-6"></a>
<a name="rest_code_915b3d977fcd4a3ba27b855cc831c3fd-7"></a><span class="k">def</span> <span class="nf">beam_FDM_eigs</span><span class="p">(</span><span class="n">L</span><span class="p">,</span> <span class="n">N</span><span class="p">):</span>
<a name="rest_code_915b3d977fcd4a3ba27b855cc831c3fd-8"></a>    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">N</span><span class="p">)</span>
<a name="rest_code_915b3d977fcd4a3ba27b855cc831c3fd-9"></a>    <span class="n">dx</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<a name="rest_code_915b3d977fcd4a3ba27b855cc831c3fd-10"></a>    <span class="n">stiff</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="mi">6</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">N</span> <span class="o">-</span> <span class="mi">2</span><span class="p">))</span> <span class="o">-</span>\
<a name="rest_code_915b3d977fcd4a3ba27b855cc831c3fd-11"></a>            <span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">N</span> <span class="o">-</span> <span class="mi">3</span><span class="p">),</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">N</span> <span class="o">-</span> <span class="mi">3</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span>\
<a name="rest_code_915b3d977fcd4a3ba27b855cc831c3fd-12"></a>            <span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="mi">1</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">N</span> <span class="o">-</span> <span class="mi">4</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="mi">1</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">N</span> <span class="o">-</span> <span class="mi">4</span><span class="p">),</span> <span class="o">-</span><span class="mi">2</span><span class="p">)</span>
<a name="rest_code_915b3d977fcd4a3ba27b855cc831c3fd-13"></a>    <span class="n">vals</span><span class="p">,</span> <span class="n">vecs</span> <span class="o">=</span> <span class="n">eigsh</span><span class="p">(</span><span class="n">stiff</span><span class="o">/</span><span class="n">dx</span><span class="o">**</span><span class="mi">4</span><span class="p">)</span>
<a name="rest_code_915b3d977fcd4a3ba27b855cc831c3fd-14"></a>    <span class="k">return</span> <span class="n">vals</span><span class="p">,</span> <span class="n">vecs</span><span class="p">,</span> <span class="n">x</span>
<a name="rest_code_915b3d977fcd4a3ba27b855cc831c3fd-15"></a>
<a name="rest_code_915b3d977fcd4a3ba27b855cc831c3fd-16"></a>
<a name="rest_code_915b3d977fcd4a3ba27b855cc831c3fd-17"></a><span class="n">N</span> <span class="o">=</span> <span class="mi">1001</span>
<a name="rest_code_915b3d977fcd4a3ba27b855cc831c3fd-18"></a><span class="n">nvals</span> <span class="o">=</span> <span class="mi">20</span>
<a name="rest_code_915b3d977fcd4a3ba27b855cc831c3fd-19"></a><span class="n">nvecs</span> <span class="o">=</span> <span class="mi">4</span>
<a name="rest_code_915b3d977fcd4a3ba27b855cc831c3fd-20"></a><span class="n">vals</span><span class="p">,</span> <span class="n">vecs</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="n">beam_FDM_eigs</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">N</span><span class="p">)</span>
<a name="rest_code_915b3d977fcd4a3ba27b855cc831c3fd-21"></a>
<a name="rest_code_915b3d977fcd4a3ba27b855cc831c3fd-22"></a><span class="c1">#%% Plotting</span>
<a name="rest_code_915b3d977fcd4a3ba27b855cc831c3fd-23"></a><span class="n">num</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">nvals</span><span class="p">,</span> <span class="n">nvals</span><span class="p">)</span>
<a name="rest_code_915b3d977fcd4a3ba27b855cc831c3fd-24"></a><span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s2">"mathtext.fontset"</span><span class="p">]</span> <span class="o">=</span> <span class="s2">"cm"</span>
<a name="rest_code_915b3d977fcd4a3ba27b855cc831c3fd-25"></a><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<a name="rest_code_915b3d977fcd4a3ba27b855cc831c3fd-26"></a><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<a name="rest_code_915b3d977fcd4a3ba27b855cc831c3fd-27"></a><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">num</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">vals</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">nvals</span><span class="p">]),</span> <span class="s2">"o"</span><span class="p">)</span>
<a name="rest_code_915b3d977fcd4a3ba27b855cc831c3fd-28"></a><span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">"$N$"</span><span class="p">)</span>
<a name="rest_code_915b3d977fcd4a3ba27b855cc831c3fd-29"></a><span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">"$\omega\sqrt{\frac{\lambda}</span><span class="si">{EI}</span><span class="s2">}$"</span><span class="p">)</span>
<a name="rest_code_915b3d977fcd4a3ba27b855cc831c3fd-30"></a><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span> <span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<a name="rest_code_915b3d977fcd4a3ba27b855cc831c3fd-31"></a><span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nvecs</span><span class="p">):</span>
<a name="rest_code_915b3d977fcd4a3ba27b855cc831c3fd-32"></a>    <span class="n">vec</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
<a name="rest_code_915b3d977fcd4a3ba27b855cc831c3fd-33"></a>    <span class="n">vec</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">vecs</span><span class="p">[:,</span> <span class="n">k</span><span class="p">]</span>
<a name="rest_code_915b3d977fcd4a3ba27b855cc831c3fd-34"></a>    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">vec</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">'$n=</span><span class="si">%i</span><span class="s1">$'</span><span class="o">%</span><span class="p">(</span><span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
<a name="rest_code_915b3d977fcd4a3ba27b855cc831c3fd-35"></a>
<a name="rest_code_915b3d977fcd4a3ba27b855cc831c3fd-36"></a><span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">"$x$"</span><span class="p">)</span>
<a name="rest_code_915b3d977fcd4a3ba27b855cc831c3fd-37"></a><span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">"$w$"</span><span class="p">)</span>
<a name="rest_code_915b3d977fcd4a3ba27b855cc831c3fd-38"></a><span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">ncol</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">framealpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<a name="rest_code_915b3d977fcd4a3ba27b855cc831c3fd-39"></a><span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<a name="rest_code_915b3d977fcd4a3ba27b855cc831c3fd-40"></a><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre>
</div>
<div class="section" id="julia">
<h3>Julia</h3>
<pre class="code julia"><a name="rest_code_8ae68b6f4c9d4ea6ba0e42e0acc0264d-1"></a><span class="k">using</span> <span class="n">PyPlot</span>
<a name="rest_code_8ae68b6f4c9d4ea6ba0e42e0acc0264d-2"></a>
<a name="rest_code_8ae68b6f4c9d4ea6ba0e42e0acc0264d-3"></a>
<a name="rest_code_8ae68b6f4c9d4ea6ba0e42e0acc0264d-4"></a><span class="k">function</span> <span class="n">beam_FDM_eigs</span><span class="p">(</span><span class="n">L</span><span class="p">,</span> <span class="n">N</span><span class="p">)</span>
<a name="rest_code_8ae68b6f4c9d4ea6ba0e42e0acc0264d-5"></a>    <span class="n">x</span> <span class="o">=</span> <span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">N</span><span class="p">)</span>
<a name="rest_code_8ae68b6f4c9d4ea6ba0e42e0acc0264d-6"></a>    <span class="n">dx</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">-</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<a name="rest_code_8ae68b6f4c9d4ea6ba0e42e0acc0264d-7"></a>    <span class="n">stiff</span> <span class="o">=</span> <span class="n">diagm</span><span class="p">(</span><span class="mi">6</span><span class="o">*</span><span class="n">ones</span><span class="p">(</span><span class="n">N</span> <span class="o">-</span> <span class="mi">2</span><span class="p">))</span> <span class="o">-</span>
<a name="rest_code_8ae68b6f4c9d4ea6ba0e42e0acc0264d-8"></a>            <span class="n">diagm</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">ones</span><span class="p">(</span><span class="n">N</span> <span class="o">-</span> <span class="mi">3</span><span class="p">),</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="n">diagm</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">ones</span><span class="p">(</span><span class="n">N</span> <span class="o">-</span> <span class="mi">3</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span>
<a name="rest_code_8ae68b6f4c9d4ea6ba0e42e0acc0264d-9"></a>            <span class="n">diagm</span><span class="p">(</span><span class="mi">1</span><span class="o">*</span><span class="n">ones</span><span class="p">(</span><span class="n">N</span> <span class="o">-</span> <span class="mi">4</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">diagm</span><span class="p">(</span><span class="mi">1</span><span class="o">*</span><span class="n">ones</span><span class="p">(</span><span class="n">N</span> <span class="o">-</span> <span class="mi">4</span><span class="p">),</span> <span class="o">-</span><span class="mi">2</span><span class="p">)</span>
<a name="rest_code_8ae68b6f4c9d4ea6ba0e42e0acc0264d-10"></a>    <span class="n">vals</span><span class="p">,</span> <span class="n">vecs</span> <span class="o">=</span> <span class="n">eig</span><span class="p">(</span><span class="n">stiff</span><span class="o">/</span><span class="n">dx</span><span class="o">^</span><span class="mi">4</span><span class="p">)</span>
<a name="rest_code_8ae68b6f4c9d4ea6ba0e42e0acc0264d-11"></a>    <span class="k">return</span> <span class="n">vals</span><span class="p">,</span> <span class="n">vecs</span><span class="p">,</span> <span class="n">x</span>
<a name="rest_code_8ae68b6f4c9d4ea6ba0e42e0acc0264d-12"></a><span class="k">end</span>
<a name="rest_code_8ae68b6f4c9d4ea6ba0e42e0acc0264d-13"></a>
<a name="rest_code_8ae68b6f4c9d4ea6ba0e42e0acc0264d-14"></a>
<a name="rest_code_8ae68b6f4c9d4ea6ba0e42e0acc0264d-15"></a><span class="n">N</span> <span class="o">=</span> <span class="mi">1001</span>
<a name="rest_code_8ae68b6f4c9d4ea6ba0e42e0acc0264d-16"></a><span class="n">nvals</span> <span class="o">=</span> <span class="mi">20</span>
<a name="rest_code_8ae68b6f4c9d4ea6ba0e42e0acc0264d-17"></a><span class="n">nvecs</span> <span class="o">=</span> <span class="mi">4</span>
<a name="rest_code_8ae68b6f4c9d4ea6ba0e42e0acc0264d-18"></a><span class="n">vals</span><span class="p">,</span> <span class="n">vecs</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="n">beam_FDM_eigs</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">N</span><span class="p">)</span>
<a name="rest_code_8ae68b6f4c9d4ea6ba0e42e0acc0264d-19"></a>
<a name="rest_code_8ae68b6f4c9d4ea6ba0e42e0acc0264d-20"></a><span class="c">#%% Plotting</span>
<a name="rest_code_8ae68b6f4c9d4ea6ba0e42e0acc0264d-21"></a><span class="n">num</span> <span class="o">=</span> <span class="mi">1</span><span class="o">:</span><span class="n">nvals</span>
<a name="rest_code_8ae68b6f4c9d4ea6ba0e42e0acc0264d-22"></a><span class="c"># Missing line for setting the math font</span>
<a name="rest_code_8ae68b6f4c9d4ea6ba0e42e0acc0264d-23"></a><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<a name="rest_code_8ae68b6f4c9d4ea6ba0e42e0acc0264d-24"></a><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<a name="rest_code_8ae68b6f4c9d4ea6ba0e42e0acc0264d-25"></a><span class="n">plot</span><span class="p">(</span><span class="n">num</span><span class="p">,</span> <span class="n">sqrt</span><span class="o">.</span><span class="p">(</span><span class="n">vals</span><span class="p">[</span><span class="mi">1</span><span class="o">:</span><span class="n">nvals</span><span class="p">]),</span> <span class="s">"o"</span><span class="p">)</span>
<a name="rest_code_8ae68b6f4c9d4ea6ba0e42e0acc0264d-26"></a><span class="n">xlabel</span><span class="p">(</span><span class="n">L</span><span class="s">"</span><span class="si">$N</span><span class="s">$"</span><span class="p">)</span>
<a name="rest_code_8ae68b6f4c9d4ea6ba0e42e0acc0264d-27"></a><span class="n">ylabel</span><span class="p">(</span><span class="n">L</span><span class="s">"$\omega\sqrt{</span><span class="se">\f</span><span class="s">rac{\lambda}{EI}}$"</span><span class="p">)</span>
<a name="rest_code_8ae68b6f4c9d4ea6ba0e42e0acc0264d-28"></a><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span> <span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<a name="rest_code_8ae68b6f4c9d4ea6ba0e42e0acc0264d-29"></a><span class="k">for</span> <span class="n">k</span> <span class="kp">in</span> <span class="mi">1</span><span class="o">:</span><span class="n">nvecs</span>
<a name="rest_code_8ae68b6f4c9d4ea6ba0e42e0acc0264d-30"></a>    <span class="n">vec</span> <span class="o">=</span> <span class="n">zeros</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
<a name="rest_code_8ae68b6f4c9d4ea6ba0e42e0acc0264d-31"></a>    <span class="n">vec</span><span class="p">[</span><span class="mi">2</span><span class="o">:</span><span class="k">end</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">vecs</span><span class="p">[</span><span class="o">:</span><span class="p">,</span> <span class="n">k</span><span class="p">]</span>
<a name="rest_code_8ae68b6f4c9d4ea6ba0e42e0acc0264d-32"></a>    <span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">vec</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">"n=</span><span class="si">$</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="s">"</span><span class="p">)</span>
<a name="rest_code_8ae68b6f4c9d4ea6ba0e42e0acc0264d-33"></a><span class="k">end</span>
<a name="rest_code_8ae68b6f4c9d4ea6ba0e42e0acc0264d-34"></a>
<a name="rest_code_8ae68b6f4c9d4ea6ba0e42e0acc0264d-35"></a><span class="n">xlabel</span><span class="p">(</span><span class="n">L</span><span class="s">"</span><span class="si">$x</span><span class="s">$"</span><span class="p">)</span>
<a name="rest_code_8ae68b6f4c9d4ea6ba0e42e0acc0264d-36"></a><span class="n">ylabel</span><span class="p">(</span><span class="n">L</span><span class="s">"</span><span class="si">$w</span><span class="s">$"</span><span class="p">)</span>
<a name="rest_code_8ae68b6f4c9d4ea6ba0e42e0acc0264d-37"></a><span class="n">legend</span><span class="p">(</span><span class="n">ncol</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">framealpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<a name="rest_code_8ae68b6f4c9d4ea6ba0e42e0acc0264d-38"></a><span class="n">tight_layout</span><span class="p">()</span>
<a name="rest_code_8ae68b6f4c9d4ea6ba0e42e0acc0264d-39"></a><span class="n">show</span><span class="p">()</span>
</pre>
<p>Ambos tienen (casi) el mismo resultado, presentado a continuación</p>
<img alt="Modos de vibración de una viga empotrada." class="align-center" src="../images/beam_modes.svg" style="width: 800px;">
</div>
<div class="section" id="comparacion-python-julia">
<h3>Comparación Python/Julia</h3>
<p>Respecto al número de líneas tenemos: 40 en Python y 39 en Julia.  La comparación
en tiempo de ejecución se realizó con el comando mágico de IPython <code class="docutils literal">%timeit</code>
y con <code class="docutils literal">@benchmark</code> en Julia.</p>
<p>Para Python:</p>
<pre class="code IPython"><a name="rest_code_073e18e8990b4c128b9890a53fed3b67-1"></a><span class="o">%</span><span class="k">timeit</span> beam_FDM_eigs(1.0, N)
</pre>
<p>con resultado</p>
<pre class="code text"><a name="rest_code_47ddbaa1dbe348a88a929f954218d8ef-1"></a>10 loops, best of 3: 196 ms per loop
</pre>
<p>Para Julia:</p>
<pre class="code julia"><a name="rest_code_b2516f1c43264d06a5a98630e2ed5a1e-1"></a><span class="nd">@benchmark</span> <span class="n">beam_FDM_eigs</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">N</span><span class="p">)</span>
</pre>
<p>con resultado</p>
<pre class="code julia"><a name="rest_code_69cf5f70dc114c20b1e706eff281e27a-1"></a><span class="n">BenchmarkTools</span><span class="o">.</span><span class="n">Trial</span><span class="o">:</span>
<a name="rest_code_69cf5f70dc114c20b1e706eff281e27a-2"></a>  <span class="n">memory</span> <span class="n">estimate</span><span class="o">:</span>  <span class="mf">99.42</span> <span class="n">MiB</span>
<a name="rest_code_69cf5f70dc114c20b1e706eff281e27a-3"></a>  <span class="n">allocs</span> <span class="n">estimate</span><span class="o">:</span>  <span class="mi">55</span>
<a name="rest_code_69cf5f70dc114c20b1e706eff281e27a-4"></a>  <span class="o">--------------</span>
<a name="rest_code_69cf5f70dc114c20b1e706eff281e27a-5"></a>  <span class="n">minimum</span> <span class="n">time</span><span class="o">:</span>     <span class="mf">665.152</span> <span class="n">ms</span> <span class="p">(</span><span class="mf">17.14</span><span class="o">%</span> <span class="n">GC</span><span class="p">)</span>
<a name="rest_code_69cf5f70dc114c20b1e706eff281e27a-6"></a>  <span class="n">median</span> <span class="n">time</span><span class="o">:</span>      <span class="mf">775.441</span> <span class="n">ms</span> <span class="p">(</span><span class="mf">21.76</span><span class="o">%</span> <span class="n">GC</span><span class="p">)</span>
<a name="rest_code_69cf5f70dc114c20b1e706eff281e27a-7"></a>  <span class="n">mean</span> <span class="n">time</span><span class="o">:</span>        <span class="mf">853.401</span> <span class="n">ms</span> <span class="p">(</span><span class="mf">16.86</span><span class="o">%</span> <span class="n">GC</span><span class="p">)</span>
<a name="rest_code_69cf5f70dc114c20b1e706eff281e27a-8"></a>  <span class="n">maximum</span> <span class="n">time</span><span class="o">:</span>     <span class="mf">1.236</span> <span class="n">s</span> <span class="p">(</span><span class="mf">15.68</span><span class="o">%</span> <span class="n">GC</span><span class="p">)</span>
<a name="rest_code_69cf5f70dc114c20b1e706eff281e27a-9"></a>  <span class="o">--------------</span>
<a name="rest_code_69cf5f70dc114c20b1e706eff281e27a-10"></a>  <span class="n">samples</span><span class="o">:</span>          <span class="mi">6</span>
<a name="rest_code_69cf5f70dc114c20b1e706eff281e27a-11"></a>  <span class="n">evals</span><span class="o">/</span><span class="n">sample</span><span class="o">:</span>     <span class="mi">1</span>
</pre>
<p>En este caso, podemos decir que el código de Python es alrededor de 4
veces más rápido que el de Julia.</p>
</div>
</div>
</div>
    </div>
    </article><article class="post h-entry post-text"><header><h1 class="post-title p-name"><a href="posts/numerical-21/" class="u-url">Reto de métodos numéricos: Día 21</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn">Nicolás Guarín-Zapata</span></p>
            <p class="dateline"><a href="posts/numerical-21/" rel="bookmark"><time class="post-date published dt-published" datetime="2017-10-21T14:57:55-05:00" title="2017-10-21 14:57">2017-10-21 14:57</time></a></p>
                <p class="commentline">
        
    <a href="posts/numerical-21/#disqus_thread" data-disqus-identifier="cache/posts/numerical-21.html">Comentarios</a>


        </p>
</div>
    </header><div class="e-content entry-content">
    <div>
<p>Durante octubre (2017) estaré escribiendo un programa por día para algunos
métodos numéricos famosos en Python y Julia. Esto está pensado como
un ejercicio, no esperen que el código sea lo suficientemente bueno para
usarse en la "vida real". Además, también debo mencionar que casi que no
tengo experiencia con Julia, así que probablemente no escriba un Julia
idiomático y se parezca más a Python.</p>
<div class="section" id="itearacion-de-jacobi">
<h2>Itearación de Jacobi</h2>
<p>Hoy tenemos el <a class="reference external" href="https://en.wikipedia.org/wiki/Finite_difference_method">método de diferencias finitas</a> combinado con
el <a class="reference external" href="https://en.wikipedia.org/wiki/Jacobi_method">método de Jacobi</a>.
Vamos a resolver la ecuación de Laplace.</p>
<div class="math">
\begin{equation*}
\nabla^ 2 u = 0
\end{equation*}
</div>
<p>con</p>
<div class="math">
\begin{align*}
u(0, y) = 1 -y,\quad u(x, 0) = 1 - x,\\
u(1, y) = u(x, 1) = 0
\end{align*}
</div>
<p>A continuación se presenta el código.</p>
<div class="section" id="python">
<h3>Python</h3>
<pre class="code python"><a name="rest_code_6e92728d346946138e2fed31a0dd5674-1"></a><span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">division</span><span class="p">,</span> <span class="n">print_function</span>
<a name="rest_code_6e92728d346946138e2fed31a0dd5674-2"></a><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<a name="rest_code_6e92728d346946138e2fed31a0dd5674-3"></a><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<a name="rest_code_6e92728d346946138e2fed31a0dd5674-4"></a>
<a name="rest_code_6e92728d346946138e2fed31a0dd5674-5"></a>
<a name="rest_code_6e92728d346946138e2fed31a0dd5674-6"></a><span class="k">def</span> <span class="nf">jacobi</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">update</span><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="mf">1e-6</span><span class="p">,</span> <span class="n">niter</span><span class="o">=</span><span class="mi">500</span><span class="p">):</span>
<a name="rest_code_6e92728d346946138e2fed31a0dd5674-7"></a>    <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">niter</span><span class="p">):</span>
<a name="rest_code_6e92728d346946138e2fed31a0dd5674-8"></a>        <span class="n">u_new</span> <span class="o">=</span> <span class="n">update</span><span class="p">(</span><span class="n">u</span><span class="p">)</span>
<a name="rest_code_6e92728d346946138e2fed31a0dd5674-9"></a>        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">u_new</span> <span class="o">-</span> <span class="n">u</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">tol</span><span class="p">:</span>
<a name="rest_code_6e92728d346946138e2fed31a0dd5674-10"></a>            <span class="k">break</span>
<a name="rest_code_6e92728d346946138e2fed31a0dd5674-11"></a>        <span class="k">else</span><span class="p">:</span>
<a name="rest_code_6e92728d346946138e2fed31a0dd5674-12"></a>            <span class="n">u</span> <span class="o">=</span> <span class="n">u_new</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<a name="rest_code_6e92728d346946138e2fed31a0dd5674-13"></a>    <span class="k">return</span> <span class="n">u</span><span class="p">,</span> <span class="n">n</span>
<a name="rest_code_6e92728d346946138e2fed31a0dd5674-14"></a>
<a name="rest_code_6e92728d346946138e2fed31a0dd5674-15"></a>
<a name="rest_code_6e92728d346946138e2fed31a0dd5674-16"></a><span class="k">def</span> <span class="nf">heat_FDM</span><span class="p">(</span><span class="n">u</span><span class="p">):</span>
<a name="rest_code_6e92728d346946138e2fed31a0dd5674-17"></a>    <span class="n">u_new</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<a name="rest_code_6e92728d346946138e2fed31a0dd5674-18"></a>    <span class="n">u_new</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.25</span><span class="o">*</span><span class="p">(</span><span class="n">u_new</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">u_new</span><span class="p">[</span><span class="mi">2</span><span class="p">:,</span> <span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span>\
<a name="rest_code_6e92728d346946138e2fed31a0dd5674-19"></a>         <span class="n">u_new</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="n">u_new</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">:])</span>
<a name="rest_code_6e92728d346946138e2fed31a0dd5674-20"></a>    <span class="k">return</span> <span class="n">u_new</span>
<a name="rest_code_6e92728d346946138e2fed31a0dd5674-21"></a>
<a name="rest_code_6e92728d346946138e2fed31a0dd5674-22"></a>
<a name="rest_code_6e92728d346946138e2fed31a0dd5674-23"></a><span class="n">nx</span> <span class="o">=</span> <span class="mi">50</span>
<a name="rest_code_6e92728d346946138e2fed31a0dd5674-24"></a><span class="n">ny</span> <span class="o">=</span> <span class="mi">50</span>
<a name="rest_code_6e92728d346946138e2fed31a0dd5674-25"></a><span class="n">x_vec</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">nx</span><span class="p">)</span>
<a name="rest_code_6e92728d346946138e2fed31a0dd5674-26"></a><span class="n">y_vec</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">ny</span><span class="p">)</span>
<a name="rest_code_6e92728d346946138e2fed31a0dd5674-27"></a><span class="n">u0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nx</span><span class="p">,</span> <span class="n">ny</span><span class="p">))</span>
<a name="rest_code_6e92728d346946138e2fed31a0dd5674-28"></a><span class="n">u0</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">x_vec</span>
<a name="rest_code_6e92728d346946138e2fed31a0dd5674-29"></a><span class="n">u0</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">y_vec</span>
<a name="rest_code_6e92728d346946138e2fed31a0dd5674-30"></a><span class="n">nvec</span> <span class="o">=</span> <span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="mi">10000</span><span class="p">,</span> <span class="mi">100000</span><span class="p">]</span>
<a name="rest_code_6e92728d346946138e2fed31a0dd5674-31"></a><span class="k">for</span> <span class="n">num</span><span class="p">,</span> <span class="n">niter</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">nvec</span><span class="p">):</span>
<a name="rest_code_6e92728d346946138e2fed31a0dd5674-32"></a>    <span class="n">u</span><span class="p">,</span> <span class="n">n</span> <span class="o">=</span> <span class="n">jacobi</span><span class="p">(</span><span class="n">u0</span><span class="p">,</span> <span class="n">heat_FDM</span><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="mf">1e-12</span><span class="p">,</span> <span class="n">niter</span><span class="o">=</span><span class="n">niter</span><span class="p">)</span>
<a name="rest_code_6e92728d346946138e2fed31a0dd5674-33"></a>    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">num</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<a name="rest_code_6e92728d346946138e2fed31a0dd5674-34"></a>    <span class="n">plt</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">'hot'</span><span class="p">)</span>
<a name="rest_code_6e92728d346946138e2fed31a0dd5674-35"></a>    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">"$x$"</span><span class="p">)</span>
<a name="rest_code_6e92728d346946138e2fed31a0dd5674-36"></a>    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">"$y$"</span><span class="p">)</span>
<a name="rest_code_6e92728d346946138e2fed31a0dd5674-37"></a>    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">'</span><span class="si">{}</span><span class="s1"> iterations'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">n</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
<a name="rest_code_6e92728d346946138e2fed31a0dd5674-38"></a>    <span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">'image'</span><span class="p">)</span>
<a name="rest_code_6e92728d346946138e2fed31a0dd5674-39"></a><span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<a name="rest_code_6e92728d346946138e2fed31a0dd5674-40"></a><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre>
</div>
<div class="section" id="julia">
<h3>Julia</h3>
<pre class="code julia"><a name="rest_code_deb9f281530a43c7a90250d11ec6fe33-1"></a><span class="k">using</span> <span class="n">PyPlot</span>
<a name="rest_code_deb9f281530a43c7a90250d11ec6fe33-2"></a>
<a name="rest_code_deb9f281530a43c7a90250d11ec6fe33-3"></a>
<a name="rest_code_deb9f281530a43c7a90250d11ec6fe33-4"></a><span class="k">function</span> <span class="n">jacobi</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">update</span><span class="p">;</span> <span class="n">tol</span><span class="o">=</span><span class="mf">1e-6</span><span class="p">,</span> <span class="n">niter</span><span class="o">=</span><span class="mi">500</span><span class="p">)</span>
<a name="rest_code_deb9f281530a43c7a90250d11ec6fe33-5"></a>    <span class="n">num</span> <span class="o">=</span> <span class="n">niter</span>
<a name="rest_code_deb9f281530a43c7a90250d11ec6fe33-6"></a>    <span class="k">for</span> <span class="n">n</span> <span class="o">=</span> <span class="mi">1</span><span class="o">:</span><span class="n">niter</span>
<a name="rest_code_deb9f281530a43c7a90250d11ec6fe33-7"></a>        <span class="n">u_new</span> <span class="o">=</span> <span class="n">update</span><span class="p">(</span><span class="n">u</span><span class="p">)</span>
<a name="rest_code_deb9f281530a43c7a90250d11ec6fe33-8"></a>        <span class="k">if</span> <span class="n">norm</span><span class="p">(</span><span class="n">u_new</span> <span class="o">-</span> <span class="n">u</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">tol</span>
<a name="rest_code_deb9f281530a43c7a90250d11ec6fe33-9"></a>            <span class="n">num</span> <span class="o">=</span> <span class="n">n</span>
<a name="rest_code_deb9f281530a43c7a90250d11ec6fe33-10"></a>            <span class="k">break</span>
<a name="rest_code_deb9f281530a43c7a90250d11ec6fe33-11"></a>        <span class="k">else</span>
<a name="rest_code_deb9f281530a43c7a90250d11ec6fe33-12"></a>            <span class="n">u</span> <span class="o">=</span> <span class="n">copy</span><span class="p">(</span><span class="n">u_new</span><span class="p">)</span>
<a name="rest_code_deb9f281530a43c7a90250d11ec6fe33-13"></a>        <span class="k">end</span>
<a name="rest_code_deb9f281530a43c7a90250d11ec6fe33-14"></a>    <span class="k">end</span>
<a name="rest_code_deb9f281530a43c7a90250d11ec6fe33-15"></a>    <span class="k">return</span> <span class="n">u</span><span class="p">,</span> <span class="n">num</span>
<a name="rest_code_deb9f281530a43c7a90250d11ec6fe33-16"></a><span class="k">end</span>
<a name="rest_code_deb9f281530a43c7a90250d11ec6fe33-17"></a>
<a name="rest_code_deb9f281530a43c7a90250d11ec6fe33-18"></a>
<a name="rest_code_deb9f281530a43c7a90250d11ec6fe33-19"></a><span class="k">function</span> <span class="n">heat_FDM</span><span class="p">(</span><span class="n">u</span><span class="p">)</span>
<a name="rest_code_deb9f281530a43c7a90250d11ec6fe33-20"></a>    <span class="n">u_new</span> <span class="o">=</span> <span class="n">copy</span><span class="p">(</span><span class="n">u</span><span class="p">)</span>
<a name="rest_code_deb9f281530a43c7a90250d11ec6fe33-21"></a>    <span class="n">u_new</span><span class="p">[</span><span class="mi">2</span><span class="o">:</span><span class="k">end</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="o">:</span><span class="k">end</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.25</span><span class="o">*</span><span class="p">(</span><span class="n">u_new</span><span class="p">[</span><span class="mi">1</span><span class="o">:</span><span class="k">end</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="o">:</span><span class="k">end</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span>
<a name="rest_code_deb9f281530a43c7a90250d11ec6fe33-22"></a>        <span class="n">u_new</span><span class="p">[</span><span class="mi">3</span><span class="o">:</span><span class="k">end</span><span class="p">,</span> <span class="mi">2</span><span class="o">:</span><span class="k">end</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">u_new</span><span class="p">[</span><span class="mi">2</span><span class="o">:</span><span class="k">end</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="o">:</span><span class="k">end</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="n">u_new</span><span class="p">[</span><span class="mi">2</span><span class="o">:</span><span class="k">end</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="o">:</span><span class="k">end</span><span class="p">])</span>
<a name="rest_code_deb9f281530a43c7a90250d11ec6fe33-23"></a>    <span class="k">return</span> <span class="n">u_new</span>
<a name="rest_code_deb9f281530a43c7a90250d11ec6fe33-24"></a><span class="k">end</span>
<a name="rest_code_deb9f281530a43c7a90250d11ec6fe33-25"></a>
<a name="rest_code_deb9f281530a43c7a90250d11ec6fe33-26"></a>
<a name="rest_code_deb9f281530a43c7a90250d11ec6fe33-27"></a><span class="n">nx</span> <span class="o">=</span> <span class="mi">50</span>
<a name="rest_code_deb9f281530a43c7a90250d11ec6fe33-28"></a><span class="n">ny</span> <span class="o">=</span> <span class="mi">50</span>
<a name="rest_code_deb9f281530a43c7a90250d11ec6fe33-29"></a><span class="n">x_vec</span> <span class="o">=</span> <span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">nx</span><span class="p">)</span>
<a name="rest_code_deb9f281530a43c7a90250d11ec6fe33-30"></a><span class="n">y_vec</span> <span class="o">=</span> <span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">ny</span><span class="p">)</span>
<a name="rest_code_deb9f281530a43c7a90250d11ec6fe33-31"></a><span class="n">u0</span> <span class="o">=</span> <span class="n">zeros</span><span class="p">(</span><span class="n">nx</span><span class="p">,</span> <span class="n">ny</span><span class="p">)</span>
<a name="rest_code_deb9f281530a43c7a90250d11ec6fe33-32"></a><span class="n">u0</span><span class="p">[</span><span class="o">:</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">x_vec</span>
<a name="rest_code_deb9f281530a43c7a90250d11ec6fe33-33"></a><span class="n">u0</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="o">:</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">y_vec</span>
<a name="rest_code_deb9f281530a43c7a90250d11ec6fe33-34"></a><span class="n">nvec</span> <span class="o">=</span> <span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="mi">10000</span><span class="p">,</span> <span class="mi">100000</span><span class="p">]</span>
<a name="rest_code_deb9f281530a43c7a90250d11ec6fe33-35"></a><span class="k">for</span> <span class="p">(</span><span class="n">num</span><span class="p">,</span> <span class="n">niter</span><span class="p">)</span> <span class="o">=</span> <span class="n">enumerate</span><span class="p">(</span><span class="n">nvec</span><span class="p">)</span>
<a name="rest_code_deb9f281530a43c7a90250d11ec6fe33-36"></a>    <span class="n">u</span><span class="p">,</span> <span class="n">n</span> <span class="o">=</span> <span class="n">jacobi</span><span class="p">(</span><span class="n">u0</span><span class="p">,</span> <span class="n">heat_FDM</span><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="mf">1e-12</span><span class="p">,</span> <span class="n">niter</span><span class="o">=</span><span class="n">niter</span><span class="p">)</span>
<a name="rest_code_deb9f281530a43c7a90250d11ec6fe33-37"></a>    <span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">num</span><span class="p">)</span>
<a name="rest_code_deb9f281530a43c7a90250d11ec6fe33-38"></a>    <span class="n">contourf</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s">"hot"</span><span class="p">)</span>
<a name="rest_code_deb9f281530a43c7a90250d11ec6fe33-39"></a>    <span class="n">xlabel</span><span class="p">(</span><span class="n">L</span><span class="s">"</span><span class="si">$x</span><span class="s">$"</span><span class="p">)</span>
<a name="rest_code_deb9f281530a43c7a90250d11ec6fe33-40"></a>    <span class="n">ylabel</span><span class="p">(</span><span class="n">L</span><span class="s">"</span><span class="si">$y</span><span class="s">$"</span><span class="p">)</span>
<a name="rest_code_deb9f281530a43c7a90250d11ec6fe33-41"></a>    <span class="n">title</span><span class="p">(</span><span class="s">"</span><span class="si">$</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="s"> iterations"</span><span class="p">)</span>
<a name="rest_code_deb9f281530a43c7a90250d11ec6fe33-42"></a>    <span class="n">axis</span><span class="p">(</span><span class="s">"image"</span><span class="p">)</span>
<a name="rest_code_deb9f281530a43c7a90250d11ec6fe33-43"></a><span class="k">end</span>
<a name="rest_code_deb9f281530a43c7a90250d11ec6fe33-44"></a><span class="n">tight_layout</span><span class="p">()</span>
<a name="rest_code_deb9f281530a43c7a90250d11ec6fe33-45"></a><span class="n">show</span><span class="p">()</span>
</pre>
<img alt="Solución de la ecuación diferencial que satisface las condicionse de frontera." class="align-center" src="../images/jacobi_heat.svg" style="width: 600px;">
</div>
<div class="section" id="comparacion-python-julia">
<h3>Comparación Python/Julia</h3>
<p>Respecto al número de líneas tenemos: 40 en Python y 45 en Julia.  La comparación
en tiempo de ejecución se realizó con el comando mágico de IPython <code class="docutils literal">%timeit</code>
y con <code class="docutils literal">@benchmark</code> en Julia.</p>
<p>Para Python:</p>
<pre class="code IPython"><a name="rest_code_2938afb65cd0495f8d190a24899ab9c1-1"></a><span class="o">%</span><span class="k">timeit</span> jacobi(u0, heat_FDM, tol=1e-12, niter=1000)
</pre>
<p>con resultado</p>
<pre class="code text"><a name="rest_code_d8b3784fb8824251933dd09ecd614648-1"></a>10 loops, best of 3: 29.6 ms per loop
</pre>
<p>Para Julia:</p>
<pre class="code julia"><a name="rest_code_0c15b0f2b7334b9ea2708abee681113d-1"></a><span class="nd">@benchmark</span> <span class="n">jacobi</span><span class="p">(</span><span class="n">u0</span><span class="p">,</span> <span class="n">heat_FDM</span><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="mf">1e-12</span><span class="p">,</span> <span class="n">niter</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
</pre>
<p>con resultado</p>
<pre class="code julia"><a name="rest_code_216a99a2e04a48e6a9d84081f90135a1-1"></a><span class="n">BenchmarkTools</span><span class="o">.</span><span class="n">Trial</span><span class="o">:</span>
<a name="rest_code_216a99a2e04a48e6a9d84081f90135a1-2"></a>  <span class="n">memory</span> <span class="n">estimate</span><span class="o">:</span>  <span class="mf">247.89</span> <span class="n">MiB</span>
<a name="rest_code_216a99a2e04a48e6a9d84081f90135a1-3"></a>  <span class="n">allocs</span> <span class="n">estimate</span><span class="o">:</span>  <span class="mi">43002</span>
<a name="rest_code_216a99a2e04a48e6a9d84081f90135a1-4"></a>  <span class="o">--------------</span>
<a name="rest_code_216a99a2e04a48e6a9d84081f90135a1-5"></a>  <span class="n">minimum</span> <span class="n">time</span><span class="o">:</span>     <span class="mf">196.943</span> <span class="n">ms</span> <span class="p">(</span><span class="mf">5.66</span><span class="o">%</span> <span class="n">GC</span><span class="p">)</span>
<a name="rest_code_216a99a2e04a48e6a9d84081f90135a1-6"></a>  <span class="n">median</span> <span class="n">time</span><span class="o">:</span>      <span class="mf">203.230</span> <span class="n">ms</span> <span class="p">(</span><span class="mf">5.74</span><span class="o">%</span> <span class="n">GC</span><span class="p">)</span>
<a name="rest_code_216a99a2e04a48e6a9d84081f90135a1-7"></a>  <span class="n">mean</span> <span class="n">time</span><span class="o">:</span>        <span class="mf">203.060</span> <span class="n">ms</span> <span class="p">(</span><span class="mf">6.01</span><span class="o">%</span> <span class="n">GC</span><span class="p">)</span>
<a name="rest_code_216a99a2e04a48e6a9d84081f90135a1-8"></a>  <span class="n">maximum</span> <span class="n">time</span><span class="o">:</span>     <span class="mf">208.017</span> <span class="n">ms</span> <span class="p">(</span><span class="mf">5.51</span><span class="o">%</span> <span class="n">GC</span><span class="p">)</span>
<a name="rest_code_216a99a2e04a48e6a9d84081f90135a1-9"></a>  <span class="o">--------------</span>
<a name="rest_code_216a99a2e04a48e6a9d84081f90135a1-10"></a>  <span class="n">samples</span><span class="o">:</span>          <span class="mi">25</span>
<a name="rest_code_216a99a2e04a48e6a9d84081f90135a1-11"></a>  <span class="n">evals</span><span class="o">/</span><span class="n">sample</span><span class="o">:</span>     <span class="mi">1</span>
</pre>
<p>En este caso, podemos decir que el código de Python es alrededor de 10 veces
más rápido que el de Julia.</p>
</div>
</div>
</div>
    </div>
    </article><article class="post h-entry post-text"><header><h1 class="post-title p-name"><a href="posts/numerical-20/" class="u-url">Reto de métodos numéricos: Día 20</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn">Nicolás Guarín-Zapata</span></p>
            <p class="dateline"><a href="posts/numerical-20/" rel="bookmark"><time class="post-date published dt-published" datetime="2017-10-20T20:10:43-05:00" title="2017-10-20 20:10">2017-10-20 20:10</time></a></p>
                <p class="commentline">
        
    <a href="posts/numerical-20/#disqus_thread" data-disqus-identifier="cache/posts/numerical-20.html">Comentarios</a>


        </p>
</div>
    </header><div class="e-content entry-content">
    <div>
<p>Durante octubre (2017) estaré escribiendo un programa por día para algunos
métodos numéricos famosos en Python y Julia. Esto está pensado como
un ejercicio, no esperen que el código sea lo suficientemente bueno para
usarse en la "vida real". Además, también debo mencionar que casi que no
tengo experiencia con Julia, así que probablemente no escriba un Julia
idiomático y se parezca más a Python.</p>
<div class="section" id="metodo-del-disparo">
<h2>Método del disparo</h2>
<p>Hoy tenemos el <a class="reference external" href="https://en.wikipedia.org/wiki/Shooting_method">método del disparo</a>.
Este es un método para resolver problemas de valores en la frontera
convirtiéndolos en una sucesión de problemas de valores iniciales.</p>
<p>A grandes rasgos, para una ecuación de segundo orden tenemos</p>
<div class="math">
\begin{equation*}
y''(x) = f(x, y(x), y'(x)),\quad y(x_0) = y_0,\quad y(x_1) = y_1\, ,
\end{equation*}
</div>
<p>y resolvemos la sucesión de problemas
and we solve the sequence of problems</p>
<div class="math">
\begin{equation*}
y''(x) = f(x, y(x), y'(x)),\quad y(x_0) = y_0,\quad y'(x_0) = a
\end{equation*}
</div>
<p>hasta que la función <span class="math">\(F(a) = y(x_1; a) - y_1\)</span> tenga una raíz.</p>
<p>Vamos a probar este método con el problema de valores en la frontera</p>
<div class="math">
\begin{equation*}
y''(x) = \frac{3}{2} y^2,\quad w(0) = 4,\quad w(1) = 1\, .
\end{equation*}
</div>
<p>A continuación se presenta el código.</p>
<div class="section" id="python">
<h3>Python</h3>
<pre class="code python"><a name="rest_code_39975dae9388447b9c18c774e3420fa8-1"></a><span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">division</span><span class="p">,</span> <span class="n">print_function</span>
<a name="rest_code_39975dae9388447b9c18c774e3420fa8-2"></a><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<a name="rest_code_39975dae9388447b9c18c774e3420fa8-3"></a><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<a name="rest_code_39975dae9388447b9c18c774e3420fa8-4"></a><span class="kn">from</span> <span class="nn">scipy.optimize</span> <span class="kn">import</span> <span class="n">newton</span>
<a name="rest_code_39975dae9388447b9c18c774e3420fa8-5"></a><span class="kn">from</span> <span class="nn">scipy.integrate</span> <span class="kn">import</span> <span class="n">odeint</span>
<a name="rest_code_39975dae9388447b9c18c774e3420fa8-6"></a>
<a name="rest_code_39975dae9388447b9c18c774e3420fa8-7"></a>
<a name="rest_code_39975dae9388447b9c18c774e3420fa8-8"></a><span class="k">def</span> <span class="nf">shooting</span><span class="p">(</span><span class="n">dydx</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">xf</span><span class="p">,</span> <span class="n">shoot</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<a name="rest_code_39975dae9388447b9c18c774e3420fa8-9"></a>    <span class="k">if</span> <span class="n">shoot</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a name="rest_code_39975dae9388447b9c18c774e3420fa8-10"></a>        <span class="n">shoot</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="o">-</span><span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>
<a name="rest_code_39975dae9388447b9c18c774e3420fa8-11"></a>    <span class="n">F</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">s</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">xf</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="n">odeint</span><span class="p">(</span><span class="n">dydx</span><span class="p">,</span> <span class="p">[</span><span class="n">x0</span><span class="p">,</span> <span class="n">s</span><span class="p">],</span> <span class="n">x</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">xf</span>
<a name="rest_code_39975dae9388447b9c18c774e3420fa8-12"></a>    <span class="n">shoot</span> <span class="o">=</span> <span class="n">newton</span><span class="p">(</span><span class="n">F</span><span class="p">,</span> <span class="n">shoot</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">xf</span><span class="p">,</span> <span class="n">x</span><span class="p">))</span>
<a name="rest_code_39975dae9388447b9c18c774e3420fa8-13"></a>    <span class="n">y</span> <span class="o">=</span> <span class="n">odeint</span><span class="p">(</span><span class="n">dydx</span><span class="p">,</span> <span class="p">[</span><span class="n">x0</span><span class="p">,</span> <span class="n">shoot</span><span class="p">],</span> <span class="n">x</span><span class="p">)</span>
<a name="rest_code_39975dae9388447b9c18c774e3420fa8-14"></a>    <span class="k">return</span> <span class="n">y</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">shoot</span>
<a name="rest_code_39975dae9388447b9c18c774e3420fa8-15"></a>
<a name="rest_code_39975dae9388447b9c18c774e3420fa8-16"></a>
<a name="rest_code_39975dae9388447b9c18c774e3420fa8-17"></a><span class="n">func</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">y</span><span class="p">,</span> <span class="n">t</span><span class="p">:</span> <span class="p">[</span><span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mf">1.5</span><span class="o">*</span><span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">]</span>
<a name="rest_code_39975dae9388447b9c18c774e3420fa8-18"></a><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
<a name="rest_code_39975dae9388447b9c18c774e3420fa8-19"></a><span class="n">y</span><span class="p">,</span> <span class="n">shoot</span> <span class="o">=</span> <span class="n">shooting</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">shoot</span><span class="o">=-</span><span class="mi">5</span><span class="p">)</span>
<a name="rest_code_39975dae9388447b9c18c774e3420fa8-20"></a><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<a name="rest_code_39975dae9388447b9c18c774e3420fa8-21"></a><span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">"$x$"</span><span class="p">)</span>
<a name="rest_code_39975dae9388447b9c18c774e3420fa8-22"></a><span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">"$y$"</span><span class="p">)</span>
<a name="rest_code_39975dae9388447b9c18c774e3420fa8-23"></a><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre>
</div>
<div class="section" id="julia">
<h3>Julia</h3>
<pre class="code julia"><a name="rest_code_f8d872b0b32f4b1f9aa167de22c713cb-1"></a><span class="k">using</span> <span class="n">PyPlot</span><span class="p">,</span> <span class="n">DifferentialEquations</span><span class="p">,</span> <span class="n">Roots</span>
<a name="rest_code_f8d872b0b32f4b1f9aa167de22c713cb-2"></a>
<a name="rest_code_f8d872b0b32f4b1f9aa167de22c713cb-3"></a>
<a name="rest_code_f8d872b0b32f4b1f9aa167de22c713cb-4"></a><span class="k">function</span> <span class="n">shooting</span><span class="p">(</span><span class="n">dydx</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">yf</span><span class="p">;</span> <span class="n">shoot</span><span class="o">=</span><span class="nb">nothing</span><span class="p">)</span>
<a name="rest_code_f8d872b0b32f4b1f9aa167de22c713cb-5"></a>    <span class="k">if</span> <span class="n">shoot</span> <span class="o">==</span> <span class="nb">nothing</span>
<a name="rest_code_f8d872b0b32f4b1f9aa167de22c713cb-6"></a>        <span class="n">shoot</span> <span class="o">=</span> <span class="n">rand</span><span class="p">(</span><span class="o">-</span><span class="mi">20</span><span class="o">:</span><span class="mf">0.1</span><span class="o">:</span><span class="mi">20</span><span class="p">)</span>
<a name="rest_code_f8d872b0b32f4b1f9aa167de22c713cb-7"></a>    <span class="k">end</span>
<a name="rest_code_f8d872b0b32f4b1f9aa167de22c713cb-8"></a>    <span class="k">function</span> <span class="n">F</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
<a name="rest_code_f8d872b0b32f4b1f9aa167de22c713cb-9"></a>        <span class="n">prob</span> <span class="o">=</span> <span class="n">ODEProblem</span><span class="p">(</span><span class="n">dydx</span><span class="p">,</span> <span class="p">[</span><span class="n">y0</span><span class="p">,</span> <span class="n">s</span><span class="p">],</span> <span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="k">end</span><span class="p">]))</span>
<a name="rest_code_f8d872b0b32f4b1f9aa167de22c713cb-10"></a>        <span class="n">sol</span> <span class="o">=</span> <span class="n">solve</span><span class="p">(</span><span class="n">prob</span><span class="p">)</span>
<a name="rest_code_f8d872b0b32f4b1f9aa167de22c713cb-11"></a>        <span class="k">return</span> <span class="n">sol</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="k">end</span><span class="p">])[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">yf</span>
<a name="rest_code_f8d872b0b32f4b1f9aa167de22c713cb-12"></a>    <span class="k">end</span>
<a name="rest_code_f8d872b0b32f4b1f9aa167de22c713cb-13"></a>    <span class="n">shoot</span> <span class="o">=</span> <span class="n">fzero</span><span class="p">(</span><span class="n">F</span><span class="p">,</span> <span class="n">shoot</span><span class="p">)</span>
<a name="rest_code_f8d872b0b32f4b1f9aa167de22c713cb-14"></a>    <span class="n">prob</span> <span class="o">=</span> <span class="n">ODEProblem</span><span class="p">(</span><span class="n">dydx</span><span class="p">,</span> <span class="p">[</span><span class="n">y0</span><span class="p">,</span> <span class="n">shoot</span><span class="p">],</span> <span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="k">end</span><span class="p">]))</span>
<a name="rest_code_f8d872b0b32f4b1f9aa167de22c713cb-15"></a>    <span class="n">sol</span> <span class="o">=</span> <span class="n">solve</span><span class="p">(</span><span class="n">prob</span><span class="p">,</span> <span class="n">solveat</span><span class="o">=</span><span class="n">x</span><span class="p">)</span>
<a name="rest_code_f8d872b0b32f4b1f9aa167de22c713cb-16"></a>    <span class="k">return</span> <span class="n">sol</span><span class="p">(</span><span class="n">x</span><span class="p">)[</span><span class="mi">1</span><span class="p">,</span> <span class="o">:</span><span class="p">],</span> <span class="n">shoot</span>
<a name="rest_code_f8d872b0b32f4b1f9aa167de22c713cb-17"></a><span class="k">end</span>
<a name="rest_code_f8d872b0b32f4b1f9aa167de22c713cb-18"></a>
<a name="rest_code_f8d872b0b32f4b1f9aa167de22c713cb-19"></a>
<a name="rest_code_f8d872b0b32f4b1f9aa167de22c713cb-20"></a><span class="n">func</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span> <span class="o">=</span> <span class="p">[</span><span class="n">y</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="mf">1.5</span><span class="o">*</span><span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">^</span><span class="mi">2</span><span class="p">]</span>
<a name="rest_code_f8d872b0b32f4b1f9aa167de22c713cb-21"></a><span class="n">x</span> <span class="o">=</span> <span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
<a name="rest_code_f8d872b0b32f4b1f9aa167de22c713cb-22"></a><span class="n">y</span><span class="p">,</span> <span class="n">shoot</span> <span class="o">=</span> <span class="n">shooting</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">x</span> <span class="p">,</span> <span class="mf">4.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="n">shoot</span><span class="o">=-</span><span class="mf">5.0</span><span class="p">)</span>
<a name="rest_code_f8d872b0b32f4b1f9aa167de22c713cb-23"></a><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</pre>
<p>En ambos casos el resultado es el siguiente gráfico, y la pendiente es
-7.9999999657800833.</p>
<img alt="Solución de la ecuación diferencial que satisface las condiciones de frontera." class="align-center" src="../images/shooting.svg" style="width: 600px;"><p>Debemos mentionar que la convergencia del método depende de la selección de la
aproximación inicial. Por ejemplo, si escogemos como parámetro inicial -50
en el problema anterior, obtenemos una solución completamente diferente.</p>
<pre class="code text"><a name="rest_code_dad8a9b5ca6a48b3ad0194be35f9380b-1"></a>y, shoot = shooting(func, x , 4.0, 1.0, shoot=-50.0)
</pre>
<img alt="Solución de la ecuación diferencial que satisface las condiciones de frontera." class="align-center" src="../images/shooting-s-50.svg" style="width: 600px;"><p>Y la pendiente que se obtiene es -35.858547970130971.</p>
</div>
<div class="section" id="comparacion-python-julia">
<h3>Comparación Python/Julia</h3>
<p>Respecto al número de líneas tenemos: 20 en Python y 23 en Julia.  La comparación
en tiempo de ejecución se realizó con el comando mágico de IPython <code class="docutils literal">%timeit</code>
y con <code class="docutils literal">@benchmark</code> en Julia.</p>
<p>Para Python:</p>
<pre class="code IPython"><a name="rest_code_a31c01ca01bb4ef78dfa51a1743987a0-1"></a><span class="o">%</span><span class="k">timeit</span> shooting(func, x, 4, 1, shoot=-5)
</pre>
<p>con resultado</p>
<pre class="code text"><a name="rest_code_cfabcb5202084b26835b76cab5c85ba2-1"></a>100 loops, best of 3: 1.9 ms per loop
</pre>
<p>Para Julia:</p>
<pre class="code julia"><a name="rest_code_38a7bf9069934e4bb195a319baeb3ec0-1"></a><span class="nd">@benchmark</span> <span class="n">shooting</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="mf">4.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="n">shoot</span><span class="o">=-</span><span class="mf">5.0</span><span class="p">)</span>
</pre>
<p>con resultado</p>
<pre class="code julia"><a name="rest_code_e4decf70bcd343acbe3347ae4b3dc95d-1"></a><span class="n">BenchmarkTools</span><span class="o">.</span><span class="n">Trial</span><span class="o">:</span>
<a name="rest_code_e4decf70bcd343acbe3347ae4b3dc95d-2"></a>  <span class="n">memory</span> <span class="n">estimate</span><span class="o">:</span>  <span class="mf">4.18</span> <span class="n">MiB</span>
<a name="rest_code_e4decf70bcd343acbe3347ae4b3dc95d-3"></a>  <span class="n">allocs</span> <span class="n">estimate</span><span class="o">:</span>  <span class="mi">78552</span>
<a name="rest_code_e4decf70bcd343acbe3347ae4b3dc95d-4"></a>  <span class="o">--------------</span>
<a name="rest_code_e4decf70bcd343acbe3347ae4b3dc95d-5"></a>  <span class="n">minimum</span> <span class="n">time</span><span class="o">:</span>     <span class="mf">10.065</span> <span class="n">ms</span> <span class="p">(</span><span class="mf">0.00</span><span class="o">%</span> <span class="n">GC</span><span class="p">)</span>
<a name="rest_code_e4decf70bcd343acbe3347ae4b3dc95d-6"></a>  <span class="n">median</span> <span class="n">time</span><span class="o">:</span>      <span class="mf">10.593</span> <span class="n">ms</span> <span class="p">(</span><span class="mf">0.00</span><span class="o">%</span> <span class="n">GC</span><span class="p">)</span>
<a name="rest_code_e4decf70bcd343acbe3347ae4b3dc95d-7"></a>  <span class="n">mean</span> <span class="n">time</span><span class="o">:</span>        <span class="mf">11.769</span> <span class="n">ms</span> <span class="p">(</span><span class="mf">9.28</span><span class="o">%</span> <span class="n">GC</span><span class="p">)</span>
<a name="rest_code_e4decf70bcd343acbe3347ae4b3dc95d-8"></a>  <span class="n">maximum</span> <span class="n">time</span><span class="o">:</span>     <span class="mf">22.252</span> <span class="n">ms</span> <span class="p">(</span><span class="mf">48.58</span><span class="o">%</span> <span class="n">GC</span><span class="p">)</span>
<a name="rest_code_e4decf70bcd343acbe3347ae4b3dc95d-9"></a>  <span class="o">--------------</span>
<a name="rest_code_e4decf70bcd343acbe3347ae4b3dc95d-10"></a>  <span class="n">samples</span><span class="o">:</span>          <span class="mi">425</span>
<a name="rest_code_e4decf70bcd343acbe3347ae4b3dc95d-11"></a>  <span class="n">evals</span><span class="o">/</span><span class="n">sample</span><span class="o">:</span>     <span class="mi">1</span>
</pre>
<p>En este caso, podemos decir que el código de Python es alrededor de 5 veces más
rápido que el de Julia. Sin embargo, el código es más diferente que en los otros
retos. Por ejemplo, no estoy usando <code class="docutils literal">newton</code> en Julia.</p>
</div>
</div>
</div>
    </div>
    </article><article class="post h-entry post-text"><header><h1 class="post-title p-name"><a href="posts/numerical-19/" class="u-url">Reto de métodos numéricos: Día 19</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn">Nicolás Guarín-Zapata</span></p>
            <p class="dateline"><a href="posts/numerical-19/" rel="bookmark"><time class="post-date published dt-published" datetime="2017-10-19T15:24:57-05:00" title="2017-10-19 15:24">2017-10-19 15:24</time></a></p>
                <p class="commentline">
        
    <a href="posts/numerical-19/#disqus_thread" data-disqus-identifier="cache/posts/numerical-19.html">Comentarios</a>


        </p>
</div>
    </header><div class="e-content entry-content">
    <div>
<p>Durante octubre (2017) estaré escribiendo un programa por día para algunos
métodos numéricos famosos en Python y Julia. Esto está pensado como
un ejercicio, no esperen que el código sea lo suficientemente bueno para
usarse en la "vida real". Además, también debo mencionar que casi que no
tengo experiencia con Julia, así que probablemente no escriba un Julia
idiomático y se parezca más a Python.</p>
<div class="section" id="integracion-de-verlet">
<h2>Integración de Verlet</h2>
<p>Hoy tenemos la técnica de <a class="reference external" href="https://en.wikipedia.org/wiki/Verlet_integration">integración de Verlet</a>. Este método se usa de
formae xtendida para integrar las ecuaciones de movimiento de muchos sistemas,
como en mecánica orbital o dinámica molecular. Una de las razones principales
para escoger este método es que es un
<a class="reference external" href="https://en.wikipedia.org/wiki/Symplectic_integrator">integrado simpléctico</a>.</p>
<p>La fórmula para avanzar en el tiempo es</p>
<div class="math">
\begin{equation*}
\mathbf{x}_{n+1}=2 \mathbf{x}_n- \mathbf{x}_{n-1}+ A(\mathbf{x}_n)\,\Delta t^2.
\end{equation*}
</div>
<p>donde <span class="math">\(A(\mathbf{x}_n)\)</span> es la aceleración para el instante de tiempo actual.</p>
<p>A continuación se presentan los códigos.</p>
<div class="section" id="python">
<h3>Python</h3>
<pre class="code python"><a name="rest_code_0281d00b62514986a8712c2497fa6605-1"></a><span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">division</span><span class="p">,</span> <span class="n">print_function</span>
<a name="rest_code_0281d00b62514986a8712c2497fa6605-2"></a><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<a name="rest_code_0281d00b62514986a8712c2497fa6605-3"></a><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<a name="rest_code_0281d00b62514986a8712c2497fa6605-4"></a>
<a name="rest_code_0281d00b62514986a8712c2497fa6605-5"></a>
<a name="rest_code_0281d00b62514986a8712c2497fa6605-6"></a><span class="k">def</span> <span class="nf">verlet</span><span class="p">(</span><span class="n">force</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">v0</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">()):</span>
<a name="rest_code_0281d00b62514986a8712c2497fa6605-7"></a>    <span class="n">ndof</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">x0</span><span class="p">)</span>
<a name="rest_code_0281d00b62514986a8712c2497fa6605-8"></a>    <span class="n">ntimes</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
<a name="rest_code_0281d00b62514986a8712c2497fa6605-9"></a>    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">ndof</span><span class="p">,</span> <span class="n">ntimes</span><span class="p">))</span>
<a name="rest_code_0281d00b62514986a8712c2497fa6605-10"></a>    <span class="n">dt</span> <span class="o">=</span> <span class="n">t</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<a name="rest_code_0281d00b62514986a8712c2497fa6605-11"></a>    <span class="n">x</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">x0</span>
<a name="rest_code_0281d00b62514986a8712c2497fa6605-12"></a>    <span class="n">F</span> <span class="o">=</span> <span class="n">force</span><span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">v0</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">)</span>
<a name="rest_code_0281d00b62514986a8712c2497fa6605-13"></a>    <span class="n">x</span><span class="p">[::</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">x0</span><span class="p">[::</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="n">v0</span><span class="p">[::</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">dt</span> <span class="o">+</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">F</span><span class="p">[::</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">dt</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="n">m</span>
<a name="rest_code_0281d00b62514986a8712c2497fa6605-14"></a>    <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">::</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">x0</span><span class="p">[</span><span class="mi">1</span><span class="p">::</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="n">v0</span><span class="p">[</span><span class="mi">1</span><span class="p">::</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">dt</span> <span class="o">+</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">F</span><span class="p">[</span><span class="mi">1</span><span class="p">::</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">dt</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="n">m</span>
<a name="rest_code_0281d00b62514986a8712c2497fa6605-15"></a>    <span class="k">for</span> <span class="n">cont</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">ntimes</span><span class="p">):</span>
<a name="rest_code_0281d00b62514986a8712c2497fa6605-16"></a>        <span class="n">dt</span> <span class="o">=</span> <span class="n">t</span><span class="p">[</span><span class="n">cont</span><span class="p">]</span> <span class="o">-</span> <span class="n">t</span><span class="p">[</span><span class="n">cont</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>
<a name="rest_code_0281d00b62514986a8712c2497fa6605-17"></a>        <span class="n">v</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span><span class="p">[:,</span> <span class="n">cont</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">x</span><span class="p">[:,</span> <span class="n">cont</span> <span class="o">-</span> <span class="mi">2</span><span class="p">])</span><span class="o">/</span><span class="n">dt</span>
<a name="rest_code_0281d00b62514986a8712c2497fa6605-18"></a>        <span class="n">acel</span> <span class="o">=</span> <span class="n">force</span><span class="p">(</span><span class="n">x</span><span class="p">[:,</span> <span class="n">cont</span> <span class="o">-</span> <span class="mi">1</span><span class="p">],</span> <span class="n">v</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">)</span>
<a name="rest_code_0281d00b62514986a8712c2497fa6605-19"></a>        <span class="n">acel</span><span class="p">[::</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">acel</span><span class="p">[::</span><span class="mi">2</span><span class="p">]</span><span class="o">/</span><span class="n">m</span>
<a name="rest_code_0281d00b62514986a8712c2497fa6605-20"></a>        <span class="n">acel</span><span class="p">[</span><span class="mi">1</span><span class="p">::</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">acel</span><span class="p">[</span><span class="mi">1</span><span class="p">::</span><span class="mi">2</span><span class="p">]</span><span class="o">/</span><span class="n">m</span>
<a name="rest_code_0281d00b62514986a8712c2497fa6605-21"></a>        <span class="n">x</span><span class="p">[:,</span> <span class="n">cont</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="p">[:,</span> <span class="n">cont</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">x</span><span class="p">[:,</span> <span class="n">cont</span> <span class="o">-</span> <span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="n">acel</span><span class="o">*</span><span class="n">dt</span><span class="o">**</span><span class="mi">2</span>
<a name="rest_code_0281d00b62514986a8712c2497fa6605-22"></a>    <span class="k">return</span> <span class="n">x</span>
<a name="rest_code_0281d00b62514986a8712c2497fa6605-23"></a>
<a name="rest_code_0281d00b62514986a8712c2497fa6605-24"></a>
<a name="rest_code_0281d00b62514986a8712c2497fa6605-25"></a><span class="n">spring_force</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">k</span><span class="p">:</span> <span class="o">-</span><span class="n">k</span><span class="o">*</span><span class="n">x</span>
<a name="rest_code_0281d00b62514986a8712c2497fa6605-26"></a><span class="n">x0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">])</span>
<a name="rest_code_0281d00b62514986a8712c2497fa6605-27"></a><span class="n">v0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">])</span>
<a name="rest_code_0281d00b62514986a8712c2497fa6605-28"></a><span class="n">m</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.0</span><span class="p">])</span>
<a name="rest_code_0281d00b62514986a8712c2497fa6605-29"></a><span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">10.0</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
<a name="rest_code_0281d00b62514986a8712c2497fa6605-30"></a><span class="n">k</span> <span class="o">=</span> <span class="mf">1.0</span>
<a name="rest_code_0281d00b62514986a8712c2497fa6605-31"></a><span class="n">x</span> <span class="o">=</span> <span class="n">verlet</span><span class="p">(</span><span class="n">spring_force</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">v0</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">k</span><span class="p">,))</span>
<a name="rest_code_0281d00b62514986a8712c2497fa6605-32"></a>
<a name="rest_code_0281d00b62514986a8712c2497fa6605-33"></a><span class="c1">#%% Plot</span>
<a name="rest_code_0281d00b62514986a8712c2497fa6605-34"></a><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<a name="rest_code_0281d00b62514986a8712c2497fa6605-35"></a><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">121</span><span class="p">)</span>
<a name="rest_code_0281d00b62514986a8712c2497fa6605-36"></a><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:])</span>
<a name="rest_code_0281d00b62514986a8712c2497fa6605-37"></a><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:])</span>
<a name="rest_code_0281d00b62514986a8712c2497fa6605-38"></a><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">122</span><span class="p">)</span>
<a name="rest_code_0281d00b62514986a8712c2497fa6605-39"></a><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:],</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:])</span>
<a name="rest_code_0281d00b62514986a8712c2497fa6605-40"></a><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre>
</div>
<div class="section" id="julia">
<h3>Julia</h3>
<pre class="code julia"><a name="rest_code_e8fdfa9949bb4b01aa70c8fb55c7fc71-1"></a><span class="k">using</span> <span class="n">PyPlot</span>
<a name="rest_code_e8fdfa9949bb4b01aa70c8fb55c7fc71-2"></a>
<a name="rest_code_e8fdfa9949bb4b01aa70c8fb55c7fc71-3"></a>
<a name="rest_code_e8fdfa9949bb4b01aa70c8fb55c7fc71-4"></a><span class="k">function</span> <span class="n">verlet</span><span class="p">(</span><span class="n">force</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">v0</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">t</span><span class="p">;</span> <span class="n">args</span><span class="o">=</span><span class="p">())</span>
<a name="rest_code_e8fdfa9949bb4b01aa70c8fb55c7fc71-5"></a>    <span class="n">ndof</span> <span class="o">=</span> <span class="n">length</span><span class="p">(</span><span class="n">x0</span><span class="p">)</span>
<a name="rest_code_e8fdfa9949bb4b01aa70c8fb55c7fc71-6"></a>    <span class="n">ntimes</span> <span class="o">=</span> <span class="n">length</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
<a name="rest_code_e8fdfa9949bb4b01aa70c8fb55c7fc71-7"></a>    <span class="n">x</span> <span class="o">=</span> <span class="n">zeros</span><span class="p">(</span><span class="n">ndof</span><span class="p">,</span> <span class="n">ntimes</span><span class="p">)</span>
<a name="rest_code_e8fdfa9949bb4b01aa70c8fb55c7fc71-8"></a>    <span class="n">dt</span> <span class="o">=</span> <span class="n">t</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">-</span> <span class="n">t</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<a name="rest_code_e8fdfa9949bb4b01aa70c8fb55c7fc71-9"></a>    <span class="n">x</span><span class="p">[</span><span class="o">:</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">x0</span>
<a name="rest_code_e8fdfa9949bb4b01aa70c8fb55c7fc71-10"></a>    <span class="n">F</span> <span class="o">=</span> <span class="n">force</span><span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">v0</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">args</span><span class="o">...</span><span class="p">)</span>
<a name="rest_code_e8fdfa9949bb4b01aa70c8fb55c7fc71-11"></a>    <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="o">:</span><span class="mi">2</span><span class="o">:</span><span class="k">end</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">x0</span><span class="p">[</span><span class="mi">1</span><span class="o">:</span><span class="mi">2</span><span class="o">:</span><span class="k">end</span><span class="p">]</span> <span class="o">+</span> <span class="n">v0</span><span class="p">[</span><span class="mi">1</span><span class="o">:</span><span class="mi">2</span><span class="o">:</span><span class="k">end</span><span class="p">]</span><span class="o">*</span><span class="n">dt</span> <span class="o">+</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">F</span><span class="p">[</span><span class="mi">1</span><span class="o">:</span><span class="mi">2</span><span class="o">:</span><span class="k">end</span><span class="p">]</span><span class="o">*</span><span class="n">dt</span><span class="o">^</span><span class="mf">2.</span><span class="o">/</span><span class="n">m</span>
<a name="rest_code_e8fdfa9949bb4b01aa70c8fb55c7fc71-12"></a>    <span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="o">:</span><span class="mi">2</span><span class="o">:</span><span class="k">end</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">x0</span><span class="p">[</span><span class="mi">2</span><span class="o">:</span><span class="mi">2</span><span class="o">:</span><span class="k">end</span><span class="p">]</span> <span class="o">+</span> <span class="n">v0</span><span class="p">[</span><span class="mi">2</span><span class="o">:</span><span class="mi">2</span><span class="o">:</span><span class="k">end</span><span class="p">]</span><span class="o">*</span><span class="n">dt</span> <span class="o">+</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">F</span><span class="p">[</span><span class="mi">2</span><span class="o">:</span><span class="mi">2</span><span class="o">:</span><span class="k">end</span><span class="p">]</span><span class="o">*</span><span class="n">dt</span><span class="o">^</span><span class="mf">2.</span><span class="o">/</span><span class="n">m</span>
<a name="rest_code_e8fdfa9949bb4b01aa70c8fb55c7fc71-13"></a>    <span class="k">for</span> <span class="n">cont</span> <span class="o">=</span> <span class="mi">3</span><span class="o">:</span><span class="n">ntimes</span>
<a name="rest_code_e8fdfa9949bb4b01aa70c8fb55c7fc71-14"></a>        <span class="n">dt</span> <span class="o">=</span> <span class="n">t</span><span class="p">[</span><span class="n">cont</span><span class="p">]</span> <span class="o">-</span> <span class="n">t</span><span class="p">[</span><span class="n">cont</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>
<a name="rest_code_e8fdfa9949bb4b01aa70c8fb55c7fc71-15"></a>        <span class="n">v</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="o">:</span><span class="p">,</span> <span class="n">cont</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">x</span><span class="p">[</span><span class="o">:</span><span class="p">,</span> <span class="n">cont</span> <span class="o">-</span> <span class="mi">2</span><span class="p">])</span><span class="o">/</span><span class="n">dt</span>
<a name="rest_code_e8fdfa9949bb4b01aa70c8fb55c7fc71-16"></a>        <span class="n">acel</span> <span class="o">=</span> <span class="n">force</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="o">:</span><span class="p">,</span> <span class="n">cont</span> <span class="o">-</span> <span class="mi">1</span><span class="p">],</span> <span class="n">v</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">args</span><span class="o">...</span><span class="p">)</span>
<a name="rest_code_e8fdfa9949bb4b01aa70c8fb55c7fc71-17"></a>        <span class="n">acel</span><span class="p">[</span><span class="mi">1</span><span class="o">:</span><span class="mi">2</span><span class="o">:</span><span class="k">end</span><span class="p">]</span> <span class="o">=</span> <span class="n">acel</span><span class="p">[</span><span class="mi">1</span><span class="o">:</span><span class="mi">2</span><span class="o">:</span><span class="k">end</span><span class="p">]</span><span class="o">./</span><span class="n">m</span>
<a name="rest_code_e8fdfa9949bb4b01aa70c8fb55c7fc71-18"></a>        <span class="n">acel</span><span class="p">[</span><span class="mi">2</span><span class="o">:</span><span class="mi">2</span><span class="o">:</span><span class="k">end</span><span class="p">]</span> <span class="o">=</span> <span class="n">acel</span><span class="p">[</span><span class="mi">2</span><span class="o">:</span><span class="mi">2</span><span class="o">:</span><span class="k">end</span><span class="p">]</span><span class="o">./</span><span class="n">m</span>
<a name="rest_code_e8fdfa9949bb4b01aa70c8fb55c7fc71-19"></a>        <span class="n">x</span><span class="p">[</span><span class="o">:</span><span class="p">,</span> <span class="n">cont</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="o">:</span><span class="p">,</span> <span class="n">cont</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">x</span><span class="p">[</span><span class="o">:</span><span class="p">,</span> <span class="n">cont</span> <span class="o">-</span> <span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="n">acel</span><span class="o">*</span><span class="n">dt</span><span class="o">^</span><span class="mi">2</span>
<a name="rest_code_e8fdfa9949bb4b01aa70c8fb55c7fc71-20"></a>    <span class="k">end</span>
<a name="rest_code_e8fdfa9949bb4b01aa70c8fb55c7fc71-21"></a>    <span class="k">return</span> <span class="n">x</span>
<a name="rest_code_e8fdfa9949bb4b01aa70c8fb55c7fc71-22"></a><span class="k">end</span>
<a name="rest_code_e8fdfa9949bb4b01aa70c8fb55c7fc71-23"></a>
<a name="rest_code_e8fdfa9949bb4b01aa70c8fb55c7fc71-24"></a>
<a name="rest_code_e8fdfa9949bb4b01aa70c8fb55c7fc71-25"></a><span class="n">spring_force</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="o">=</span> <span class="o">-</span><span class="n">k</span><span class="o">*</span><span class="n">x</span>
<a name="rest_code_e8fdfa9949bb4b01aa70c8fb55c7fc71-26"></a><span class="n">x0</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]</span>
<a name="rest_code_e8fdfa9949bb4b01aa70c8fb55c7fc71-27"></a><span class="n">v0</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]</span>
<a name="rest_code_e8fdfa9949bb4b01aa70c8fb55c7fc71-28"></a><span class="n">m</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">]</span>
<a name="rest_code_e8fdfa9949bb4b01aa70c8fb55c7fc71-29"></a><span class="n">t</span> <span class="o">=</span> <span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">10.0</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
<a name="rest_code_e8fdfa9949bb4b01aa70c8fb55c7fc71-30"></a><span class="n">k</span> <span class="o">=</span> <span class="mf">1.0</span>
<a name="rest_code_e8fdfa9949bb4b01aa70c8fb55c7fc71-31"></a><span class="n">x</span> <span class="o">=</span> <span class="n">verlet</span><span class="p">(</span><span class="n">spring_force</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">v0</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">k</span><span class="p">,))</span>
<a name="rest_code_e8fdfa9949bb4b01aa70c8fb55c7fc71-32"></a>
<a name="rest_code_e8fdfa9949bb4b01aa70c8fb55c7fc71-33"></a><span class="c">#%% Plot</span>
<a name="rest_code_e8fdfa9949bb4b01aa70c8fb55c7fc71-34"></a><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<a name="rest_code_e8fdfa9949bb4b01aa70c8fb55c7fc71-35"></a><span class="n">subplot</span><span class="p">(</span><span class="mi">121</span><span class="p">)</span>
<a name="rest_code_e8fdfa9949bb4b01aa70c8fb55c7fc71-36"></a><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="o">:</span><span class="p">])</span>
<a name="rest_code_e8fdfa9949bb4b01aa70c8fb55c7fc71-37"></a><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="o">:</span><span class="p">])</span>
<a name="rest_code_e8fdfa9949bb4b01aa70c8fb55c7fc71-38"></a><span class="n">subplot</span><span class="p">(</span><span class="mi">122</span><span class="p">)</span>
<a name="rest_code_e8fdfa9949bb4b01aa70c8fb55c7fc71-39"></a><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="o">:</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="o">:</span><span class="p">])</span>
<a name="rest_code_e8fdfa9949bb4b01aa70c8fb55c7fc71-40"></a><span class="n">show</span><span class="p">()</span>
</pre>
<p>En ambos casos el resultado es la siguiente gráfica.</p>
<img alt="Integración de Verlet para una masa con dos resortes ortogonales." class="align-center" src="../images/verlet.svg" style="width: 600px;">
</div>
<div class="section" id="comparacion-python-julia">
<h3>Comparación Python/Julia</h3>
<p>Respecto al número de líneas tenemos: 40 en Python y 40 en Julia.  La comparación
en tiempo de ejecución se realizó con el comando mágico de IPython <code class="docutils literal">%timeit</code>
y con <code class="docutils literal">@benchmark</code> en Julia.</p>
<p>Para Python:</p>
<pre class="code IPython"><a name="rest_code_8014992184b74cc091d6db933019da34-1"></a><span class="o">%</span><span class="k">timeit</span> -n 100 verlet(spring_force, x0, v0, m, t, args=(k,))
</pre>
<p>con resultado</p>
<pre class="code text"><a name="rest_code_5d1b4b3feafa41f2b174741c5c1572e1-1"></a>100 loops, best of 3: 26.5 ms per loop
</pre>
<p>Para Julia:</p>
<pre class="code julia"><a name="rest_code_46ad2a7275834e039dc86bc5e694d18b-1"></a><span class="nd">@benchmark</span> <span class="n">verlet</span><span class="p">(</span><span class="n">spring_force</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">v0</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">k</span><span class="p">,))</span>
</pre>
<p>con resultado</p>
<pre class="code julia"><a name="rest_code_12f1575a9ece489a930c76e941e1b45f-1"></a><span class="n">BenchmarkTools</span><span class="o">.</span><span class="n">Trial</span><span class="o">:</span>
<a name="rest_code_12f1575a9ece489a930c76e941e1b45f-2"></a>  <span class="n">memory</span> <span class="n">estimate</span><span class="o">:</span>  <span class="mf">4.36</span> <span class="n">MiB</span>
<a name="rest_code_12f1575a9ece489a930c76e941e1b45f-3"></a>  <span class="n">allocs</span> <span class="n">estimate</span><span class="o">:</span>  <span class="mi">101839</span>
<a name="rest_code_12f1575a9ece489a930c76e941e1b45f-4"></a>  <span class="o">--------------</span>
<a name="rest_code_12f1575a9ece489a930c76e941e1b45f-5"></a>  <span class="n">minimum</span> <span class="n">time</span><span class="o">:</span>     <span class="mf">73.159</span> <span class="n">ms</span> <span class="p">(</span><span class="mf">0.00</span><span class="o">%</span> <span class="n">GC</span><span class="p">)</span>
<a name="rest_code_12f1575a9ece489a930c76e941e1b45f-6"></a>  <span class="n">median</span> <span class="n">time</span><span class="o">:</span>      <span class="mf">74.883</span> <span class="n">ms</span> <span class="p">(</span><span class="mf">0.00</span><span class="o">%</span> <span class="n">GC</span><span class="p">)</span>
<a name="rest_code_12f1575a9ece489a930c76e941e1b45f-7"></a>  <span class="n">mean</span> <span class="n">time</span><span class="o">:</span>        <span class="mf">75.464</span> <span class="n">ms</span> <span class="p">(</span><span class="mf">1.02</span><span class="o">%</span> <span class="n">GC</span><span class="p">)</span>
<a name="rest_code_12f1575a9ece489a930c76e941e1b45f-8"></a>  <span class="n">maximum</span> <span class="n">time</span><span class="o">:</span>     <span class="mf">80.017</span> <span class="n">ms</span> <span class="p">(</span><span class="mf">4.87</span><span class="o">%</span> <span class="n">GC</span><span class="p">)</span>
<a name="rest_code_12f1575a9ece489a930c76e941e1b45f-9"></a>  <span class="o">--------------</span>
<a name="rest_code_12f1575a9ece489a930c76e941e1b45f-10"></a>  <span class="n">samples</span><span class="o">:</span>          <span class="mi">67</span>
<a name="rest_code_12f1575a9ece489a930c76e941e1b45f-11"></a>  <span class="n">evals</span><span class="o">/</span><span class="n">sample</span><span class="o">:</span>     <span class="mi">1</span>
</pre>
<p>En este caso, podemos decir que el código de Python es alrededor de 3 veces
más rápido que el de Julia.</p>
</div>
</div>
</div>
    </div>
    </article><article class="post h-entry post-text"><header><h1 class="post-title p-name"><a href="posts/numerical-18/" class="u-url">Reto de métodos numéricos: Día 18</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn">Nicolás Guarín-Zapata</span></p>
            <p class="dateline"><a href="posts/numerical-18/" rel="bookmark"><time class="post-date published dt-published" datetime="2017-10-18T19:58:37-05:00" title="2017-10-18 19:58">2017-10-18 19:58</time></a></p>
                <p class="commentline">
        
    <a href="posts/numerical-18/#disqus_thread" data-disqus-identifier="cache/posts/numerical-18.html">Comentarios</a>


        </p>
</div>
    </header><div class="e-content entry-content">
    <div>
<p>Durante octubre (2017) estaré escribiendo un programa por día para algunos
métodos numéricos famosos en Python y Julia. Esto está pensado como
un ejercicio, no esperen que el código sea lo suficientemente bueno para
usarse en la "vida real". Además, también debo mencionar que casi que no
tengo experiencia con Julia, así que probablemente no escriba un Julia
idiomático y se parezca más a Python.</p>
<div class="section" id="el-metodo-de-runke-kutta">
<h2>
<em>El</em> método de Runke-Kutta</h2>
<p>Hoy tenemos <em>el</em> <a class="reference external" href="https://en.wikipedia.org/wiki/Runge%E2%80%93Kutta_methods">método de Runge-Kutta</a>. Este es el
método de Runge-Kutta más popular, y usa un promedio ponderado de 4
incrementos (más pequeños).</p>
<p>Los increntos se hacen de acuerdo a la siguiente fórmula</p>
<div class="math">
\begin{equation*}
y_{n+1} = y_n + \tfrac{h}{6}\left(k_1 + 2k_2 + 2k_3 + k_4 \right)
\end{equation*}
</div>
<p>donde</p>
<div class="math">
\begin{align*}
k_1 &amp;= f(t_n, y_n), \\
k_2 &amp;= f\left(t_n + \frac{h}{2}, y_n + \frac{h}{2}k_1\right), \\
k_3 &amp;= f\left(t_n + \frac{h}{2}, y_n + \frac{h}{2}k_2\right), \\
k_4 &amp;= f\left(t_n + h, y_n + h k_3\right).
\end{align*}
</div>
<p>A continuación se presentan los códigos.</p>
<div class="section" id="python">
<h3>Python</h3>
<pre class="code python"><a name="rest_code_6829a1d639d744329e53d01d1c9b4de3-1"></a><span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">division</span><span class="p">,</span> <span class="n">print_function</span>
<a name="rest_code_6829a1d639d744329e53d01d1c9b4de3-2"></a><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<a name="rest_code_6829a1d639d744329e53d01d1c9b4de3-3"></a><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<a name="rest_code_6829a1d639d744329e53d01d1c9b4de3-4"></a>
<a name="rest_code_6829a1d639d744329e53d01d1c9b4de3-5"></a>
<a name="rest_code_6829a1d639d744329e53d01d1c9b4de3-6"></a><span class="k">def</span> <span class="nf">RK4</span><span class="p">(</span><span class="n">dydt</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">()):</span>
<a name="rest_code_6829a1d639d744329e53d01d1c9b4de3-7"></a>    <span class="n">ndof</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">y0</span><span class="p">)</span>
<a name="rest_code_6829a1d639d744329e53d01d1c9b4de3-8"></a>    <span class="n">ntimes</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
<a name="rest_code_6829a1d639d744329e53d01d1c9b4de3-9"></a>    <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">ndof</span><span class="p">,</span> <span class="n">ntimes</span><span class="p">))</span>
<a name="rest_code_6829a1d639d744329e53d01d1c9b4de3-10"></a>    <span class="n">y</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">y0</span>
<a name="rest_code_6829a1d639d744329e53d01d1c9b4de3-11"></a>    <span class="k">for</span> <span class="n">cont</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">ntimes</span><span class="p">):</span>
<a name="rest_code_6829a1d639d744329e53d01d1c9b4de3-12"></a>        <span class="n">h</span> <span class="o">=</span> <span class="n">t</span><span class="p">[</span><span class="n">cont</span><span class="p">]</span> <span class="o">-</span> <span class="n">t</span><span class="p">[</span><span class="n">cont</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>
<a name="rest_code_6829a1d639d744329e53d01d1c9b4de3-13"></a>        <span class="n">k1</span> <span class="o">=</span> <span class="n">dydt</span><span class="p">(</span><span class="n">y</span><span class="p">[:,</span> <span class="n">cont</span> <span class="o">-</span> <span class="mi">1</span><span class="p">],</span> <span class="n">t</span><span class="p">[</span><span class="n">cont</span><span class="p">],</span> <span class="o">*</span><span class="n">args</span><span class="p">)</span>
<a name="rest_code_6829a1d639d744329e53d01d1c9b4de3-14"></a>        <span class="n">k2</span> <span class="o">=</span> <span class="n">dydt</span><span class="p">(</span><span class="n">y</span><span class="p">[:,</span> <span class="n">cont</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">h</span><span class="o">*</span><span class="n">k1</span><span class="p">,</span> <span class="n">t</span><span class="p">[</span><span class="n">cont</span><span class="p">]</span> <span class="o">+</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">h</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">)</span>
<a name="rest_code_6829a1d639d744329e53d01d1c9b4de3-15"></a>        <span class="n">k3</span> <span class="o">=</span> <span class="n">dydt</span><span class="p">(</span><span class="n">y</span><span class="p">[:,</span> <span class="n">cont</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">h</span><span class="o">*</span><span class="n">k2</span><span class="p">,</span> <span class="n">t</span><span class="p">[</span><span class="n">cont</span><span class="p">]</span> <span class="o">+</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">h</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">)</span>
<a name="rest_code_6829a1d639d744329e53d01d1c9b4de3-16"></a>        <span class="n">k4</span> <span class="o">=</span> <span class="n">dydt</span><span class="p">(</span><span class="n">y</span><span class="p">[:,</span> <span class="n">cont</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">h</span><span class="o">*</span><span class="n">k3</span><span class="p">,</span> <span class="n">t</span><span class="p">[</span><span class="n">cont</span><span class="p">]</span> <span class="o">+</span> <span class="n">h</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">)</span>
<a name="rest_code_6829a1d639d744329e53d01d1c9b4de3-17"></a>        <span class="n">y</span><span class="p">[:,</span> <span class="n">cont</span><span class="p">]</span> <span class="o">=</span> <span class="n">y</span><span class="p">[:,</span> <span class="n">cont</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">h</span><span class="o">/</span><span class="mi">6</span><span class="o">*</span><span class="p">(</span><span class="n">k1</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">k2</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">k3</span> <span class="o">+</span> <span class="n">k4</span><span class="p">)</span>
<a name="rest_code_6829a1d639d744329e53d01d1c9b4de3-18"></a>    <span class="k">return</span> <span class="n">y</span>
<a name="rest_code_6829a1d639d744329e53d01d1c9b4de3-19"></a>
<a name="rest_code_6829a1d639d744329e53d01d1c9b4de3-20"></a>
<a name="rest_code_6829a1d639d744329e53d01d1c9b4de3-21"></a><span class="k">def</span> <span class="nf">pend</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
<a name="rest_code_6829a1d639d744329e53d01d1c9b4de3-22"></a>    <span class="n">theta</span><span class="p">,</span> <span class="n">omega</span> <span class="o">=</span> <span class="n">y</span>
<a name="rest_code_6829a1d639d744329e53d01d1c9b4de3-23"></a>    <span class="n">dydt</span> <span class="o">=</span> <span class="p">[</span><span class="n">omega</span><span class="p">,</span> <span class="o">-</span><span class="n">b</span><span class="o">*</span><span class="n">omega</span> <span class="o">-</span> <span class="n">c</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">)]</span>
<a name="rest_code_6829a1d639d744329e53d01d1c9b4de3-24"></a>    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">dydt</span><span class="p">)</span>
<a name="rest_code_6829a1d639d744329e53d01d1c9b4de3-25"></a>
<a name="rest_code_6829a1d639d744329e53d01d1c9b4de3-26"></a>
<a name="rest_code_6829a1d639d744329e53d01d1c9b4de3-27"></a><span class="n">b</span> <span class="o">=</span> <span class="mf">0.25</span>
<a name="rest_code_6829a1d639d744329e53d01d1c9b4de3-28"></a><span class="n">c</span> <span class="o">=</span> <span class="mf">5.0</span>
<a name="rest_code_6829a1d639d744329e53d01d1c9b4de3-29"></a><span class="n">y0</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">-</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]</span>
<a name="rest_code_6829a1d639d744329e53d01d1c9b4de3-30"></a><span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">101</span><span class="p">)</span>
<a name="rest_code_6829a1d639d744329e53d01d1c9b4de3-31"></a><span class="n">y</span> <span class="o">=</span> <span class="n">RK4</span><span class="p">(</span><span class="n">pend</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">))</span>
<a name="rest_code_6829a1d639d744329e53d01d1c9b4de3-32"></a><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:])</span>
<a name="rest_code_6829a1d639d744329e53d01d1c9b4de3-33"></a><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:])</span>
<a name="rest_code_6829a1d639d744329e53d01d1c9b4de3-34"></a><span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">"$t$"</span><span class="p">)</span>
<a name="rest_code_6829a1d639d744329e53d01d1c9b4de3-35"></a><span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="sa">r</span><span class="s2">"$\theta(t)$"</span><span class="p">,</span> <span class="sa">r</span><span class="s2">"$\omega(t)$"</span><span class="p">])</span>
<a name="rest_code_6829a1d639d744329e53d01d1c9b4de3-36"></a><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre>
</div>
<div class="section" id="julia">
<h3>Julia</h3>
<pre class="code julia"><a name="rest_code_fbbcc36097bb4ee586297ba28c956cc8-1"></a><span class="k">using</span> <span class="n">PyPlot</span>
<a name="rest_code_fbbcc36097bb4ee586297ba28c956cc8-2"></a>
<a name="rest_code_fbbcc36097bb4ee586297ba28c956cc8-3"></a>
<a name="rest_code_fbbcc36097bb4ee586297ba28c956cc8-4"></a><span class="k">function</span> <span class="n">euler</span><span class="p">(</span><span class="n">dydt</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">t</span><span class="p">;</span> <span class="n">args</span><span class="o">=</span><span class="p">())</span>
<a name="rest_code_fbbcc36097bb4ee586297ba28c956cc8-5"></a>    <span class="n">ndof</span> <span class="o">=</span> <span class="n">length</span><span class="p">(</span><span class="n">y0</span><span class="p">)</span>
<a name="rest_code_fbbcc36097bb4ee586297ba28c956cc8-6"></a>    <span class="n">ntimes</span> <span class="o">=</span> <span class="n">length</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
<a name="rest_code_fbbcc36097bb4ee586297ba28c956cc8-7"></a>    <span class="n">y</span> <span class="o">=</span> <span class="n">zeros</span><span class="p">(</span><span class="n">ndof</span><span class="p">,</span> <span class="n">ntimes</span><span class="p">)</span>
<a name="rest_code_fbbcc36097bb4ee586297ba28c956cc8-8"></a>    <span class="n">y</span><span class="p">[</span><span class="o">:</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">y0</span>
<a name="rest_code_fbbcc36097bb4ee586297ba28c956cc8-9"></a>    <span class="k">for</span> <span class="n">cont</span> <span class="o">=</span> <span class="mi">2</span><span class="o">:</span><span class="n">ntimes</span>
<a name="rest_code_fbbcc36097bb4ee586297ba28c956cc8-10"></a>        <span class="n">h</span> <span class="o">=</span> <span class="n">t</span><span class="p">[</span><span class="n">cont</span><span class="p">]</span> <span class="o">-</span> <span class="n">t</span><span class="p">[</span><span class="n">cont</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>
<a name="rest_code_fbbcc36097bb4ee586297ba28c956cc8-11"></a>        <span class="n">y</span><span class="p">[</span><span class="o">:</span><span class="p">,</span> <span class="n">cont</span><span class="p">]</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="o">:</span><span class="p">,</span> <span class="n">cont</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">h</span><span class="o">*</span><span class="n">dydt</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="o">:</span><span class="p">,</span> <span class="n">cont</span> <span class="o">-</span> <span class="mi">1</span><span class="p">],</span> <span class="n">t</span><span class="p">[</span><span class="n">cont</span><span class="p">],</span> <span class="n">args</span><span class="o">...</span><span class="p">)</span>
<a name="rest_code_fbbcc36097bb4ee586297ba28c956cc8-12"></a>    <span class="k">end</span>
<a name="rest_code_fbbcc36097bb4ee586297ba28c956cc8-13"></a>    <span class="k">return</span> <span class="n">y</span>
<a name="rest_code_fbbcc36097bb4ee586297ba28c956cc8-14"></a><span class="k">end</span>
<a name="rest_code_fbbcc36097bb4ee586297ba28c956cc8-15"></a>
<a name="rest_code_fbbcc36097bb4ee586297ba28c956cc8-16"></a>
<a name="rest_code_fbbcc36097bb4ee586297ba28c956cc8-17"></a><span class="k">function</span> <span class="n">pend</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span>
<a name="rest_code_fbbcc36097bb4ee586297ba28c956cc8-18"></a>    <span class="n">theta</span><span class="p">,</span> <span class="n">omega</span> <span class="o">=</span> <span class="n">y</span>
<a name="rest_code_fbbcc36097bb4ee586297ba28c956cc8-19"></a>    <span class="n">dydt</span> <span class="o">=</span> <span class="p">[</span><span class="n">omega</span><span class="p">,</span> <span class="o">-</span><span class="n">b</span><span class="o">*</span><span class="n">omega</span> <span class="o">-</span> <span class="n">c</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">)]</span>
<a name="rest_code_fbbcc36097bb4ee586297ba28c956cc8-20"></a>    <span class="k">return</span> <span class="n">dydt</span>
<a name="rest_code_fbbcc36097bb4ee586297ba28c956cc8-21"></a><span class="k">end</span>
<a name="rest_code_fbbcc36097bb4ee586297ba28c956cc8-22"></a>
<a name="rest_code_fbbcc36097bb4ee586297ba28c956cc8-23"></a>
<a name="rest_code_fbbcc36097bb4ee586297ba28c956cc8-24"></a><span class="n">b</span> <span class="o">=</span> <span class="mf">0.25</span>
<a name="rest_code_fbbcc36097bb4ee586297ba28c956cc8-25"></a><span class="n">c</span> <span class="o">=</span> <span class="mf">5.0</span>
<a name="rest_code_fbbcc36097bb4ee586297ba28c956cc8-26"></a><span class="n">y0</span> <span class="o">=</span> <span class="p">[</span><span class="nb">pi</span> <span class="o">-</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]</span>
<a name="rest_code_fbbcc36097bb4ee586297ba28c956cc8-27"></a><span class="n">t</span> <span class="o">=</span> <span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">1001</span><span class="p">)</span>
<a name="rest_code_fbbcc36097bb4ee586297ba28c956cc8-28"></a><span class="n">y</span> <span class="o">=</span> <span class="n">euler</span><span class="p">(</span><span class="n">pend</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">))</span>
<a name="rest_code_fbbcc36097bb4ee586297ba28c956cc8-29"></a><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="o">:</span><span class="p">])</span>
<a name="rest_code_fbbcc36097bb4ee586297ba28c956cc8-30"></a><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="o">:</span><span class="p">])</span>
<a name="rest_code_fbbcc36097bb4ee586297ba28c956cc8-31"></a><span class="n">xlabel</span><span class="p">(</span><span class="n">L</span><span class="s">"</span><span class="si">$t</span><span class="s">$"</span><span class="p">)</span>
<a name="rest_code_fbbcc36097bb4ee586297ba28c956cc8-32"></a><span class="n">legend</span><span class="p">([</span><span class="n">L</span><span class="s">"$</span><span class="se">\t</span><span class="s">heta(t)$"</span><span class="p">,</span> <span class="n">L</span><span class="s">"$\omega(t)$"</span><span class="p">])</span>
<a name="rest_code_fbbcc36097bb4ee586297ba28c956cc8-33"></a><span class="n">show</span><span class="p">()</span>
</pre>
<p>En ambos casos el resultado es la siguiente figura.</p>
<img alt="Solución para un péndulo usanto el método de Runge-Kutta." class="align-center" src="../images/RK4.svg" style="width: 500px;">
</div>
<div class="section" id="comparacion-euler-runge-kutta">
<h3>Comparación Euler/Runge-Kutta</h3>
<p>Si comparamos los métodos de Euler y Runge-Kutta para el ejemplo anterior usando
101 pasos, 10 veces menos que antes, obtenemos los resultados de abajo.
El gráfico superior se obtuvo usando el método de Euler. Podemos ver que los
resultados no son los mismos. Podríamos decir (de forma poco rigurosa) que
necesitamos menos pasos en el método de Runge-Kutta que en el método de Euler.</p>
<img alt="Comparación: método de Euler." class="align-center" src="../images/euler-101.svg" style="width: 500px;"><img alt="Comparación: método de Runge-Kutta." class="align-center" src="../images/RK4-101.svg" style="width: 500px;">
</div>
<div class="section" id="comparacion-python-julia">
<h3>Comparación Python/Julia</h3>
<p>Respecto al número de líneas tenemos: 36 en Python y 37 en Julia.  La comparación
en tiempo de ejecución se realizó con el comando mágico de IPython <code class="docutils literal">%timeit</code>
y con <code class="docutils literal">@benchmark</code> en Julia.</p>
<p>Para Python:</p>
<pre class="code IPython"><a name="rest_code_3971e62c700348eab056209bd7584e99-1"></a><span class="o">%</span><span class="k">timeit</span> RK4(pend, y0, t, args=(b, c))
</pre>
<p>con resultado</p>
<pre class="code text"><a name="rest_code_1d7fb4b791cd4764b806d8d333377388-1"></a>100 loops, best of 3: 7.62 ms per loop
</pre>
<p>Para Julia:</p>
<pre class="code julia"><a name="rest_code_a4be61dda95e425596296a2ef9654bd7-1"></a><span class="nd">@benchmark</span> <span class="n">RK4</span><span class="p">(</span><span class="n">pend</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">))</span>
</pre>
<p>con result</p>
<pre class="code julia"><a name="rest_code_a2a6eac57bc5425cad71d4a861902f97-1"></a><span class="n">BenchmarkTools</span><span class="o">.</span><span class="n">Trial</span><span class="o">:</span>
<a name="rest_code_a2a6eac57bc5425cad71d4a861902f97-2"></a>  <span class="n">memory</span> <span class="n">estimate</span><span class="o">:</span>  <span class="mf">255.09</span> <span class="n">KiB</span>
<a name="rest_code_a2a6eac57bc5425cad71d4a861902f97-3"></a>  <span class="n">allocs</span> <span class="n">estimate</span><span class="o">:</span>  <span class="mi">5205</span>
<a name="rest_code_a2a6eac57bc5425cad71d4a861902f97-4"></a>  <span class="o">--------------</span>
<a name="rest_code_a2a6eac57bc5425cad71d4a861902f97-5"></a>  <span class="n">minimum</span> <span class="n">time</span><span class="o">:</span>     <span class="mf">152.881</span> <span class="n">μs</span> <span class="p">(</span><span class="mf">0.00</span><span class="o">%</span> <span class="n">GC</span><span class="p">)</span>
<a name="rest_code_a2a6eac57bc5425cad71d4a861902f97-6"></a>  <span class="n">median</span> <span class="n">time</span><span class="o">:</span>      <span class="mf">159.939</span> <span class="n">μs</span> <span class="p">(</span><span class="mf">0.00</span><span class="o">%</span> <span class="n">GC</span><span class="p">)</span>
<a name="rest_code_a2a6eac57bc5425cad71d4a861902f97-7"></a>  <span class="n">mean</span> <span class="n">time</span><span class="o">:</span>        <span class="mf">202.514</span> <span class="n">μs</span> <span class="p">(</span><span class="mf">16.55</span><span class="o">%</span> <span class="n">GC</span><span class="p">)</span>
<a name="rest_code_a2a6eac57bc5425cad71d4a861902f97-8"></a>  <span class="n">maximum</span> <span class="n">time</span><span class="o">:</span>     <span class="mf">3.785</span> <span class="n">ms</span> <span class="p">(</span><span class="mf">91.79</span><span class="o">%</span> <span class="n">GC</span><span class="p">)</span>
<a name="rest_code_a2a6eac57bc5425cad71d4a861902f97-9"></a>  <span class="o">--------------</span>
<a name="rest_code_a2a6eac57bc5425cad71d4a861902f97-10"></a>  <span class="n">samples</span><span class="o">:</span>          <span class="mi">10000</span>
<a name="rest_code_a2a6eac57bc5425cad71d4a861902f97-11"></a>  <span class="n">evals</span><span class="o">/</span><span class="n">sample</span><span class="o">:</span>     <span class="mi">1</span>
</pre>
<p>En este caso, podemos decir que el código de Python es alrededor de
50 veces más lento que el de Julia.</p>
</div>
</div>
</div>
    </div>
    </article><article class="post h-entry post-text"><header><h1 class="post-title p-name"><a href="posts/numerical-17/" class="u-url">Reto de métodos numéricos: Día 17</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn">Nicolás Guarín-Zapata</span></p>
            <p class="dateline"><a href="posts/numerical-17/" rel="bookmark"><time class="post-date published dt-published" datetime="2017-10-17T16:29:05-05:00" title="2017-10-17 16:29">2017-10-17 16:29</time></a></p>
                <p class="commentline">
        
    <a href="posts/numerical-17/#disqus_thread" data-disqus-identifier="cache/posts/numerical-17.html">Comentarios</a>


        </p>
</div>
    </header><div class="e-content entry-content">
    <div>
<p>Durante octubre (2017) estaré escribiendo un programa por día para algunos
métodos numéricos famosos en Python y Julia. Esto está pensado como
un ejercicio, no esperen que el código sea lo suficientemente bueno para
usarse en la "vida real". Además, también debo mencionar que casi que no
tengo experiencia con Julia, así que probablemente no escriba un Julia
idiomático y se parezca más a Python.</p>
<div class="section" id="metodo-de-euler">
<h2>Método de Euler</h2>
<p>Hoy tenemos el <a class="reference external" href="https://en.wikipedia.org/wiki/Euler_method">método de Euler</a>.
Que es el <a class="reference external" href="https://en.wikipedia.org/wiki/Runge%E2%80%93Kutta_method">método de Runge-Kutta</a>,
más simple y lleva su nombre por Leonhard Euler que lo usó en el siglo 18.</p>
<p>El método consiste en realizar actualizacion de la función usando el valor de
la pendiente con la fórmula</p>
<div class="math">
\begin{equation*}
y_{n + 1} = y_n + hf(t_n, y_n)
\end{equation*}
</div>
<p>A continuación se presentan los códigos.</p>
<div class="section" id="python">
<h3>Python</h3>
<pre class="code python"><a name="rest_code_8116194aa0524cdf93496256a494a371-1"></a><span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">division</span><span class="p">,</span> <span class="n">print_function</span>
<a name="rest_code_8116194aa0524cdf93496256a494a371-2"></a><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<a name="rest_code_8116194aa0524cdf93496256a494a371-3"></a><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<a name="rest_code_8116194aa0524cdf93496256a494a371-4"></a>
<a name="rest_code_8116194aa0524cdf93496256a494a371-5"></a>
<a name="rest_code_8116194aa0524cdf93496256a494a371-6"></a><span class="k">def</span> <span class="nf">euler</span><span class="p">(</span><span class="n">dydt</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">()):</span>
<a name="rest_code_8116194aa0524cdf93496256a494a371-7"></a>    <span class="n">ndof</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">y0</span><span class="p">)</span>
<a name="rest_code_8116194aa0524cdf93496256a494a371-8"></a>    <span class="n">ntimes</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
<a name="rest_code_8116194aa0524cdf93496256a494a371-9"></a>    <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">ndof</span><span class="p">,</span> <span class="n">ntimes</span><span class="p">))</span>
<a name="rest_code_8116194aa0524cdf93496256a494a371-10"></a>    <span class="n">y</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">y0</span>
<a name="rest_code_8116194aa0524cdf93496256a494a371-11"></a>    <span class="k">for</span> <span class="n">cont</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">ntimes</span><span class="p">):</span>
<a name="rest_code_8116194aa0524cdf93496256a494a371-12"></a>        <span class="n">h</span> <span class="o">=</span> <span class="n">t</span><span class="p">[</span><span class="n">cont</span><span class="p">]</span> <span class="o">-</span> <span class="n">t</span><span class="p">[</span><span class="n">cont</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>
<a name="rest_code_8116194aa0524cdf93496256a494a371-13"></a>        <span class="n">y</span><span class="p">[:,</span> <span class="n">cont</span><span class="p">]</span> <span class="o">=</span> <span class="n">y</span><span class="p">[:,</span> <span class="n">cont</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">h</span><span class="o">*</span><span class="n">dydt</span><span class="p">(</span><span class="n">y</span><span class="p">[:,</span> <span class="n">cont</span> <span class="o">-</span> <span class="mi">1</span><span class="p">],</span> <span class="n">t</span><span class="p">[</span><span class="n">cont</span><span class="p">],</span> <span class="o">*</span><span class="n">args</span><span class="p">)</span>
<a name="rest_code_8116194aa0524cdf93496256a494a371-14"></a>    <span class="k">return</span> <span class="n">y</span>
<a name="rest_code_8116194aa0524cdf93496256a494a371-15"></a>
<a name="rest_code_8116194aa0524cdf93496256a494a371-16"></a>
<a name="rest_code_8116194aa0524cdf93496256a494a371-17"></a><span class="k">def</span> <span class="nf">pend</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
<a name="rest_code_8116194aa0524cdf93496256a494a371-18"></a>    <span class="n">theta</span><span class="p">,</span> <span class="n">omega</span> <span class="o">=</span> <span class="n">y</span>
<a name="rest_code_8116194aa0524cdf93496256a494a371-19"></a>    <span class="n">dydt</span> <span class="o">=</span> <span class="p">[</span><span class="n">omega</span><span class="p">,</span> <span class="o">-</span><span class="n">b</span><span class="o">*</span><span class="n">omega</span> <span class="o">-</span> <span class="n">c</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">)]</span>
<a name="rest_code_8116194aa0524cdf93496256a494a371-20"></a>    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">dydt</span><span class="p">)</span>
<a name="rest_code_8116194aa0524cdf93496256a494a371-21"></a>
<a name="rest_code_8116194aa0524cdf93496256a494a371-22"></a>
<a name="rest_code_8116194aa0524cdf93496256a494a371-23"></a><span class="n">b</span> <span class="o">=</span> <span class="mf">0.25</span>
<a name="rest_code_8116194aa0524cdf93496256a494a371-24"></a><span class="n">c</span> <span class="o">=</span> <span class="mf">5.0</span>
<a name="rest_code_8116194aa0524cdf93496256a494a371-25"></a><span class="n">y0</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">-</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]</span>
<a name="rest_code_8116194aa0524cdf93496256a494a371-26"></a><span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10001</span><span class="p">)</span>
<a name="rest_code_8116194aa0524cdf93496256a494a371-27"></a><span class="n">y</span> <span class="o">=</span> <span class="n">euler</span><span class="p">(</span><span class="n">pend</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">))</span>
<a name="rest_code_8116194aa0524cdf93496256a494a371-28"></a><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:])</span>
<a name="rest_code_8116194aa0524cdf93496256a494a371-29"></a><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:])</span>
<a name="rest_code_8116194aa0524cdf93496256a494a371-30"></a><span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">"$t$"</span><span class="p">)</span>
<a name="rest_code_8116194aa0524cdf93496256a494a371-31"></a><span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="sa">r</span><span class="s2">"$\theta(t)$"</span><span class="p">,</span> <span class="sa">r</span><span class="s2">"$\omega(t)$"</span><span class="p">])</span>
<a name="rest_code_8116194aa0524cdf93496256a494a371-32"></a><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre>
</div>
<div class="section" id="julia">
<h3>Julia</h3>
<pre class="code julia"><a name="rest_code_eca46b74d591419181a9f077357fa085-1"></a><span class="k">using</span> <span class="n">PyPlot</span>
<a name="rest_code_eca46b74d591419181a9f077357fa085-2"></a>
<a name="rest_code_eca46b74d591419181a9f077357fa085-3"></a>
<a name="rest_code_eca46b74d591419181a9f077357fa085-4"></a><span class="k">function</span> <span class="n">euler</span><span class="p">(</span><span class="n">dydt</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">t</span><span class="p">;</span> <span class="n">args</span><span class="o">=</span><span class="p">())</span>
<a name="rest_code_eca46b74d591419181a9f077357fa085-5"></a>    <span class="n">ndof</span> <span class="o">=</span> <span class="n">length</span><span class="p">(</span><span class="n">y0</span><span class="p">)</span>
<a name="rest_code_eca46b74d591419181a9f077357fa085-6"></a>    <span class="n">ntimes</span> <span class="o">=</span> <span class="n">length</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
<a name="rest_code_eca46b74d591419181a9f077357fa085-7"></a>    <span class="n">y</span> <span class="o">=</span> <span class="n">zeros</span><span class="p">(</span><span class="n">ndof</span><span class="p">,</span> <span class="n">ntimes</span><span class="p">)</span>
<a name="rest_code_eca46b74d591419181a9f077357fa085-8"></a>    <span class="n">y</span><span class="p">[</span><span class="o">:</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">y0</span>
<a name="rest_code_eca46b74d591419181a9f077357fa085-9"></a>    <span class="k">for</span> <span class="n">cont</span> <span class="o">=</span> <span class="mi">2</span><span class="o">:</span><span class="n">ntimes</span>
<a name="rest_code_eca46b74d591419181a9f077357fa085-10"></a>        <span class="n">h</span> <span class="o">=</span> <span class="n">t</span><span class="p">[</span><span class="n">cont</span><span class="p">]</span> <span class="o">-</span> <span class="n">t</span><span class="p">[</span><span class="n">cont</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>
<a name="rest_code_eca46b74d591419181a9f077357fa085-11"></a>        <span class="n">y</span><span class="p">[</span><span class="o">:</span><span class="p">,</span> <span class="n">cont</span><span class="p">]</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="o">:</span><span class="p">,</span> <span class="n">cont</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">h</span><span class="o">*</span><span class="n">dydt</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="o">:</span><span class="p">,</span> <span class="n">cont</span> <span class="o">-</span> <span class="mi">1</span><span class="p">],</span> <span class="n">t</span><span class="p">[</span><span class="n">cont</span><span class="p">],</span> <span class="n">args</span><span class="o">...</span><span class="p">)</span>
<a name="rest_code_eca46b74d591419181a9f077357fa085-12"></a>    <span class="k">end</span>
<a name="rest_code_eca46b74d591419181a9f077357fa085-13"></a>    <span class="k">return</span> <span class="n">y</span>
<a name="rest_code_eca46b74d591419181a9f077357fa085-14"></a><span class="k">end</span>
<a name="rest_code_eca46b74d591419181a9f077357fa085-15"></a>
<a name="rest_code_eca46b74d591419181a9f077357fa085-16"></a>
<a name="rest_code_eca46b74d591419181a9f077357fa085-17"></a><span class="k">function</span> <span class="n">pend</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span>
<a name="rest_code_eca46b74d591419181a9f077357fa085-18"></a>    <span class="n">theta</span><span class="p">,</span> <span class="n">omega</span> <span class="o">=</span> <span class="n">y</span>
<a name="rest_code_eca46b74d591419181a9f077357fa085-19"></a>    <span class="n">dydt</span> <span class="o">=</span> <span class="p">[</span><span class="n">omega</span><span class="p">,</span> <span class="o">-</span><span class="n">b</span><span class="o">*</span><span class="n">omega</span> <span class="o">-</span> <span class="n">c</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">)]</span>
<a name="rest_code_eca46b74d591419181a9f077357fa085-20"></a>    <span class="k">return</span> <span class="n">dydt</span>
<a name="rest_code_eca46b74d591419181a9f077357fa085-21"></a><span class="k">end</span>
<a name="rest_code_eca46b74d591419181a9f077357fa085-22"></a>
<a name="rest_code_eca46b74d591419181a9f077357fa085-23"></a>
<a name="rest_code_eca46b74d591419181a9f077357fa085-24"></a><span class="n">b</span> <span class="o">=</span> <span class="mf">0.25</span>
<a name="rest_code_eca46b74d591419181a9f077357fa085-25"></a><span class="n">c</span> <span class="o">=</span> <span class="mf">5.0</span>
<a name="rest_code_eca46b74d591419181a9f077357fa085-26"></a><span class="n">y0</span> <span class="o">=</span> <span class="p">[</span><span class="nb">pi</span> <span class="o">-</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]</span>
<a name="rest_code_eca46b74d591419181a9f077357fa085-27"></a><span class="n">t</span> <span class="o">=</span> <span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">1001</span><span class="p">)</span>
<a name="rest_code_eca46b74d591419181a9f077357fa085-28"></a><span class="n">y</span> <span class="o">=</span> <span class="n">euler</span><span class="p">(</span><span class="n">pend</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">))</span>
<a name="rest_code_eca46b74d591419181a9f077357fa085-29"></a><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="o">:</span><span class="p">])</span>
<a name="rest_code_eca46b74d591419181a9f077357fa085-30"></a><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="o">:</span><span class="p">])</span>
<a name="rest_code_eca46b74d591419181a9f077357fa085-31"></a><span class="n">xlabel</span><span class="p">(</span><span class="n">L</span><span class="s">"</span><span class="si">$t</span><span class="s">$"</span><span class="p">)</span>
<a name="rest_code_eca46b74d591419181a9f077357fa085-32"></a><span class="n">legend</span><span class="p">([</span><span class="n">L</span><span class="s">"$</span><span class="se">\t</span><span class="s">heta(t)$"</span><span class="p">,</span> <span class="n">L</span><span class="s">"$\omega(t)$"</span><span class="p">])</span>
<a name="rest_code_eca46b74d591419181a9f077357fa085-33"></a><span class="n">show</span><span class="p">()</span>
</pre>
<p>En ambos casos el resultado es la siguiente gráfica</p>
<img alt="Solución para un péndulo usando el método de Euler." class="align-center" src="../images/euler.svg" style="width: 500px;">
</div>
<div class="section" id="comparacion-python-julia">
<h3>Comparación Python/Julia</h3>
<p>Respecto al número de líneas tenemos: 32 en Python y 33 en Julia.  La comparación
en tiempo de ejecución se realizó con el comando mágico de IPython <code class="docutils literal">%timeit</code>
y con <code class="docutils literal">@benchmark</code> en Julia.</p>
<p>Para Python:</p>
<pre class="code IPython"><a name="rest_code_b0be609ea4b74d4a92cde31745aaeb70-1"></a><span class="o">%</span><span class="k">timeit</span> euler(pend, y0, t, args=(b, c))
</pre>
<p>con resultado</p>
<pre class="code text"><a name="rest_code_e9f4d528809b4cd691f162a7b76a690c-1"></a>100 loops, best of 3: 18.5 ms per loop
</pre>
<p>Para Julia:</p>
<pre class="code julia"><a name="rest_code_e2233714a0de4d01afa56391b3b4b65b-1"></a><span class="nd">@benchmark</span> <span class="n">euler</span><span class="p">(</span><span class="n">pend</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">))</span>
</pre>
<p>con resultado</p>
<pre class="code julia"><a name="rest_code_e853922dee8a4bbaab3134b0a9f67c12-1"></a><span class="n">BenchmarkTools</span><span class="o">.</span><span class="n">Trial</span><span class="o">:</span>
<a name="rest_code_e853922dee8a4bbaab3134b0a9f67c12-2"></a>  <span class="n">memory</span> <span class="n">estimate</span><span class="o">:</span>  <span class="mf">648.33</span> <span class="n">KiB</span>
<a name="rest_code_e853922dee8a4bbaab3134b0a9f67c12-3"></a>  <span class="n">allocs</span> <span class="n">estimate</span><span class="o">:</span>  <span class="mi">15473</span>
<a name="rest_code_e853922dee8a4bbaab3134b0a9f67c12-4"></a>  <span class="o">--------------</span>
<a name="rest_code_e853922dee8a4bbaab3134b0a9f67c12-5"></a>  <span class="n">minimum</span> <span class="n">time</span><span class="o">:</span>     <span class="mf">366.236</span> <span class="n">μs</span> <span class="p">(</span><span class="mf">0.00</span><span class="o">%</span> <span class="n">GC</span><span class="p">)</span>
<a name="rest_code_e853922dee8a4bbaab3134b0a9f67c12-6"></a>  <span class="n">median</span> <span class="n">time</span><span class="o">:</span>      <span class="mf">399.615</span> <span class="n">μs</span> <span class="p">(</span><span class="mf">0.00</span><span class="o">%</span> <span class="n">GC</span><span class="p">)</span>
<a name="rest_code_e853922dee8a4bbaab3134b0a9f67c12-7"></a>  <span class="n">mean</span> <span class="n">time</span><span class="o">:</span>        <span class="mf">486.364</span> <span class="n">μs</span> <span class="p">(</span><span class="mf">16.96</span><span class="o">%</span> <span class="n">GC</span><span class="p">)</span>
<a name="rest_code_e853922dee8a4bbaab3134b0a9f67c12-8"></a>  <span class="n">maximum</span> <span class="n">time</span><span class="o">:</span>     <span class="mf">4.613</span> <span class="n">ms</span> <span class="p">(</span><span class="mf">80.26</span><span class="o">%</span> <span class="n">GC</span><span class="p">)</span>
<a name="rest_code_e853922dee8a4bbaab3134b0a9f67c12-9"></a>  <span class="o">--------------</span>
<a name="rest_code_e853922dee8a4bbaab3134b0a9f67c12-10"></a>  <span class="n">samples</span><span class="o">:</span>          <span class="mi">10000</span>
<a name="rest_code_e853922dee8a4bbaab3134b0a9f67c12-11"></a>  <span class="n">evals</span><span class="o">/</span><span class="n">sample</span><span class="o">:</span>     <span class="mi">1</span>
</pre>
<p>En este caso, podemos decir que el código de Python es alrededor de 40
veces más lento que el de Julia.</p>
</div>
</div>
</div>
    </div>
    </article><article class="post h-entry post-text"><header><h1 class="post-title p-name"><a href="posts/numerical-16/" class="u-url">Reto de métodos numéricos: Día 16</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn">Nicolás Guarín-Zapata</span></p>
            <p class="dateline"><a href="posts/numerical-16/" rel="bookmark"><time class="post-date published dt-published" datetime="2017-10-17T16:29:00-05:00" title="2017-10-17 16:29">2017-10-17 16:29</time></a></p>
                <p class="commentline">
        
    <a href="posts/numerical-16/#disqus_thread" data-disqus-identifier="cache/posts/numerical-16.html">Comentarios</a>


        </p>
</div>
    </header><div class="e-content entry-content">
    <div>
<p>Durante octubre (2017) estaré escribiendo un programa por día para algunos
métodos numéricos famosos en Python y Julia. Esto está pensado como
un ejercicio, no esperen que el código sea lo suficientemente bueno para
usarse en la "vida real". Además, también debo mencionar que casi que no
tengo experiencia con Julia, así que probablemente no escriba un Julia
idiomático y se parezca más a Python.</p>
<div class="section" id="cuadratura-de-clenshaw-curtis">
<h2>Cuadratura de Clenshaw-Curtis</h2>
<p>Hoy tenemos la <a class="reference external" href="https://en.wikipedia.org/wiki/Clenshaw%E2%80%93Curtis_quadrature">cuadratura de Clenshaw-Curtis</a>. Este
método se basa en la expansión del integrando en
<a class="reference external" href="https://en.wikipedia.org/wiki/Chebyshev_polynomials">polinomios de Chebyshev</a>.</p>
<p>Vamos a probar la cuadratura con la integral</p>
<div class="math">
\begin{equation*}
\int_0^3 e^{-x^2} \mathrm{d}x \approx 0.8862073482595214
\end{equation*}
</div>
<p>A continuación se presentan los códigos.</p>
<div class="section" id="python">
<h3>Python</h3>
<pre class="code python"><a name="rest_code_ddda5adf21a54c89ac1ae1489b86fc50-1"></a><span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">division</span><span class="p">,</span> <span class="n">print_function</span>
<a name="rest_code_ddda5adf21a54c89ac1ae1489b86fc50-2"></a><span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="n">linspace</span><span class="p">,</span> <span class="n">cos</span><span class="p">,</span> <span class="n">pi</span><span class="p">,</span> <span class="n">exp</span><span class="p">,</span> <span class="nb">sum</span>
<a name="rest_code_ddda5adf21a54c89ac1ae1489b86fc50-3"></a>
<a name="rest_code_ddda5adf21a54c89ac1ae1489b86fc50-4"></a>
<a name="rest_code_ddda5adf21a54c89ac1ae1489b86fc50-5"></a><span class="k">def</span> <span class="nf">clenshaw_curtis</span><span class="p">(</span><span class="n">fun</span><span class="p">,</span> <span class="n">N</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">a</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
<a name="rest_code_ddda5adf21a54c89ac1ae1489b86fc50-6"></a>    <span class="n">nodes</span> <span class="o">=</span> <span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">N</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">pi</span>
<a name="rest_code_ddda5adf21a54c89ac1ae1489b86fc50-7"></a>    <span class="n">jac</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="n">b</span> <span class="o">-</span> <span class="n">a</span><span class="p">)</span>
<a name="rest_code_ddda5adf21a54c89ac1ae1489b86fc50-8"></a>    <span class="n">tfun</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">fun</span><span class="p">(</span><span class="n">a</span> <span class="o">+</span> <span class="n">jac</span><span class="o">*</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
<a name="rest_code_ddda5adf21a54c89ac1ae1489b86fc50-9"></a>    <span class="n">inte</span> <span class="o">=</span> <span class="mi">0</span>
<a name="rest_code_ddda5adf21a54c89ac1ae1489b86fc50-10"></a>    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">N</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">):</span>
<a name="rest_code_ddda5adf21a54c89ac1ae1489b86fc50-11"></a>        <span class="n">coef</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="n">N</span><span class="o">*</span><span class="p">(</span><span class="n">tfun</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">tfun</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="n">k</span> <span class="o">+</span>\
<a name="rest_code_ddda5adf21a54c89ac1ae1489b86fc50-12"></a>            <span class="mi">2</span><span class="o">*</span><span class="nb">sum</span><span class="p">(</span><span class="n">tfun</span><span class="p">(</span><span class="n">cos</span><span class="p">(</span><span class="n">nodes</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">k</span><span class="o">*</span><span class="n">nodes</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">])))</span>
<a name="rest_code_ddda5adf21a54c89ac1ae1489b86fc50-13"></a>        <span class="k">if</span> <span class="n">k</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
<a name="rest_code_ddda5adf21a54c89ac1ae1489b86fc50-14"></a>            <span class="n">inte</span> <span class="o">+=</span> <span class="n">coef</span>
<a name="rest_code_ddda5adf21a54c89ac1ae1489b86fc50-15"></a>        <span class="k">elif</span> <span class="n">k</span> <span class="o">==</span> <span class="n">N</span><span class="p">:</span>
<a name="rest_code_ddda5adf21a54c89ac1ae1489b86fc50-16"></a>            <span class="n">inte</span> <span class="o">+=</span> <span class="n">coef</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">N</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<a name="rest_code_ddda5adf21a54c89ac1ae1489b86fc50-17"></a>        <span class="k">else</span><span class="p">:</span>
<a name="rest_code_ddda5adf21a54c89ac1ae1489b86fc50-18"></a>            <span class="n">inte</span> <span class="o">+=</span> <span class="mi">2</span><span class="o">*</span><span class="n">coef</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">k</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<a name="rest_code_ddda5adf21a54c89ac1ae1489b86fc50-19"></a>    <span class="k">return</span> <span class="n">inte</span><span class="o">*</span><span class="n">jac</span>
<a name="rest_code_ddda5adf21a54c89ac1ae1489b86fc50-20"></a>
<a name="rest_code_ddda5adf21a54c89ac1ae1489b86fc50-21"></a><span class="n">N</span> <span class="o">=</span> <span class="mi">100</span>
<a name="rest_code_ddda5adf21a54c89ac1ae1489b86fc50-22"></a><span class="n">fun</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<a name="rest_code_ddda5adf21a54c89ac1ae1489b86fc50-23"></a><span class="nb">print</span><span class="p">(</span><span class="n">clenshaw_curtis</span><span class="p">(</span><span class="n">fun</span><span class="p">,</span> <span class="n">N</span><span class="o">=</span><span class="n">N</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="mi">3</span><span class="p">))</span>
</pre>
<p>con resultado</p>
<pre class="code python"><a name="rest_code_77a80bd80e4e4fa9acd3178876f46849-1"></a><span class="mf">0.885906202792</span>
</pre>
</div>
<div class="section" id="julia">
<h3>Julia</h3>
<pre class="code julia"><a name="rest_code_bc4f40fdafc04ded957904ca5d07c38f-1"></a><span class="k">function</span> <span class="n">clenshaw_curtis</span><span class="p">(</span><span class="n">fun</span><span class="p">;</span> <span class="n">N</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">a</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<a name="rest_code_bc4f40fdafc04ded957904ca5d07c38f-2"></a>    <span class="n">nodes</span> <span class="o">=</span> <span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">N</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="nb">pi</span>
<a name="rest_code_bc4f40fdafc04ded957904ca5d07c38f-3"></a>    <span class="n">jac</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="n">b</span> <span class="o">-</span> <span class="n">a</span><span class="p">)</span>
<a name="rest_code_bc4f40fdafc04ded957904ca5d07c38f-4"></a>    <span class="n">tfun</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">=</span> <span class="n">fun</span><span class="p">(</span><span class="n">a</span> <span class="o">+</span> <span class="n">jac</span><span class="o">*</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
<a name="rest_code_bc4f40fdafc04ded957904ca5d07c38f-5"></a>    <span class="n">inte</span> <span class="o">=</span> <span class="mi">0</span>
<a name="rest_code_bc4f40fdafc04ded957904ca5d07c38f-6"></a>    <span class="k">for</span> <span class="n">k</span> <span class="o">=</span> <span class="mi">0</span><span class="o">:</span><span class="mi">2</span><span class="o">:</span><span class="n">N</span>
<a name="rest_code_bc4f40fdafc04ded957904ca5d07c38f-7"></a>        <span class="n">coef</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="n">N</span><span class="o">*</span><span class="p">(</span><span class="n">tfun</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">tfun</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">^</span><span class="n">k</span> <span class="o">+</span>
<a name="rest_code_bc4f40fdafc04ded957904ca5d07c38f-8"></a>            <span class="mi">2</span><span class="o">*</span><span class="n">sum</span><span class="p">(</span><span class="n">tfun</span><span class="p">(</span><span class="n">cos</span><span class="o">.</span><span class="p">(</span><span class="n">nodes</span><span class="p">[</span><span class="mi">2</span><span class="o">:</span><span class="k">end</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span><span class="o">.*</span><span class="n">cos</span><span class="o">.</span><span class="p">(</span><span class="n">k</span><span class="o">*</span><span class="n">nodes</span><span class="p">[</span><span class="mi">2</span><span class="o">:</span><span class="k">end</span><span class="o">-</span><span class="mi">1</span><span class="p">])))</span>
<a name="rest_code_bc4f40fdafc04ded957904ca5d07c38f-9"></a>        <span class="k">if</span> <span class="n">k</span> <span class="o">==</span> <span class="mi">0</span>
<a name="rest_code_bc4f40fdafc04ded957904ca5d07c38f-10"></a>            <span class="n">inte</span> <span class="o">+=</span> <span class="n">coef</span>
<a name="rest_code_bc4f40fdafc04ded957904ca5d07c38f-11"></a>        <span class="k">elseif</span> <span class="n">k</span> <span class="o">==</span> <span class="n">N</span>
<a name="rest_code_bc4f40fdafc04ded957904ca5d07c38f-12"></a>            <span class="n">inte</span> <span class="o">+=</span> <span class="n">coef</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">N</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span>
<a name="rest_code_bc4f40fdafc04ded957904ca5d07c38f-13"></a>        <span class="k">else</span>
<a name="rest_code_bc4f40fdafc04ded957904ca5d07c38f-14"></a>            <span class="n">inte</span> <span class="o">+=</span> <span class="mi">2</span><span class="o">*</span><span class="n">coef</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">k</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span>
<a name="rest_code_bc4f40fdafc04ded957904ca5d07c38f-15"></a>        <span class="k">end</span>
<a name="rest_code_bc4f40fdafc04ded957904ca5d07c38f-16"></a>    <span class="k">end</span>
<a name="rest_code_bc4f40fdafc04ded957904ca5d07c38f-17"></a>    <span class="k">return</span> <span class="n">inte</span><span class="o">*</span><span class="n">jac</span>
<a name="rest_code_bc4f40fdafc04ded957904ca5d07c38f-18"></a><span class="k">end</span>
<a name="rest_code_bc4f40fdafc04ded957904ca5d07c38f-19"></a>
<a name="rest_code_bc4f40fdafc04ded957904ca5d07c38f-20"></a><span class="n">N</span> <span class="o">=</span> <span class="mi">100</span>
<a name="rest_code_bc4f40fdafc04ded957904ca5d07c38f-21"></a><span class="n">fun</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">=</span> <span class="n">exp</span><span class="o">.</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="o">.^</span><span class="mi">2</span><span class="p">)</span>
<a name="rest_code_bc4f40fdafc04ded957904ca5d07c38f-22"></a><span class="n">print</span><span class="p">(</span><span class="n">clenshaw_curtis</span><span class="p">(</span><span class="n">fun</span><span class="p">,</span> <span class="n">N</span><span class="o">=</span><span class="n">N</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="mi">3</span><span class="p">))</span>
</pre>
<p>con resultado</p>
<pre class="code julia"><a name="rest_code_ba3a0c3d0bd94ecebbeef5dde8cec209-1"></a><span class="mf">0.8859062027920102</span>
</pre>
</div>
<div class="section" id="comparacion-python-julia">
<h3>Comparación Python/Julia</h3>
<p>Respecto al número de líneas tenemos: 24 en Python y 23 en Julia.  La comparación
en tiempo de ejecución se realizó con el comando mágico de IPython <code class="docutils literal">%timeit</code>
y con <code class="docutils literal">@benchmark</code> en Julia.</p>
<p>Para Python:</p>
<pre class="code IPython"><a name="rest_code_d00ab0087aef44b1ba2023669611152d-1"></a><span class="o">%</span><span class="k">timeit</span> -n 10000 clenshaw_curtis(fun, N=N, a=0, b=3)
</pre>
<p>con resultado</p>
<pre class="code text"><a name="rest_code_6a071d5a77944132b0cd4e6bb1255c6f-1"></a>10000 loops, best of 3: 2.4 ms per loop
</pre>
<p>Para Julia:</p>
<pre class="code julia"><a name="rest_code_8a5a682ce4894b8b8a7c548fd3b10253-1"></a><span class="nd">@benchmark</span> <span class="n">clenshaw_curtis</span><span class="p">(</span><span class="n">fun</span><span class="p">,</span> <span class="n">N</span><span class="o">=</span><span class="n">N</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
</pre>
<p>con result</p>
<pre class="code julia"><a name="rest_code_6901e87a0b54480a9015c2a8f2d1265a-1"></a><span class="n">BenchmarkTools</span><span class="o">.</span><span class="n">Trial</span><span class="o">:</span>
<a name="rest_code_6901e87a0b54480a9015c2a8f2d1265a-2"></a>  <span class="n">memory</span> <span class="n">estimate</span><span class="o">:</span>  <span class="mf">359.56</span> <span class="n">KiB</span>
<a name="rest_code_6901e87a0b54480a9015c2a8f2d1265a-3"></a>  <span class="n">allocs</span> <span class="n">estimate</span><span class="o">:</span>  <span class="mi">565</span>
<a name="rest_code_6901e87a0b54480a9015c2a8f2d1265a-4"></a>  <span class="o">--------------</span>
<a name="rest_code_6901e87a0b54480a9015c2a8f2d1265a-5"></a>  <span class="n">minimum</span> <span class="n">time</span><span class="o">:</span>     <span class="mf">381.676</span> <span class="n">μs</span> <span class="p">(</span><span class="mf">0.00</span><span class="o">%</span> <span class="n">GC</span><span class="p">)</span>
<a name="rest_code_6901e87a0b54480a9015c2a8f2d1265a-6"></a>  <span class="n">median</span> <span class="n">time</span><span class="o">:</span>      <span class="mf">388.497</span> <span class="n">μs</span> <span class="p">(</span><span class="mf">0.00</span><span class="o">%</span> <span class="n">GC</span><span class="p">)</span>
<a name="rest_code_6901e87a0b54480a9015c2a8f2d1265a-7"></a>  <span class="n">mean</span> <span class="n">time</span><span class="o">:</span>        <span class="mf">413.471</span> <span class="n">μs</span> <span class="p">(</span><span class="mf">1.77</span><span class="o">%</span> <span class="n">GC</span><span class="p">)</span>
<a name="rest_code_6901e87a0b54480a9015c2a8f2d1265a-8"></a>  <span class="n">maximum</span> <span class="n">time</span><span class="o">:</span>     <span class="mf">1.298</span> <span class="n">ms</span> <span class="p">(</span><span class="mf">49.07</span><span class="o">%</span> <span class="n">GC</span><span class="p">)</span>
<a name="rest_code_6901e87a0b54480a9015c2a8f2d1265a-9"></a>  <span class="o">--------------</span>
<a name="rest_code_6901e87a0b54480a9015c2a8f2d1265a-10"></a>  <span class="n">samples</span><span class="o">:</span>          <span class="mi">10000</span>
<a name="rest_code_6901e87a0b54480a9015c2a8f2d1265a-11"></a>  <span class="n">evals</span><span class="o">/</span><span class="n">sample</span><span class="o">:</span>     <span class="mi">1</span>
</pre>
<p>En este caso, podemos decir que el código de Python es alrededor de 6 veces
más lento que el de Julia.</p>
</div>
</div>
</div>
    </div>
    </article><article class="post h-entry post-text"><header><h1 class="post-title p-name"><a href="posts/numerical-15/" class="u-url">Reto de métodos numéricos: Día 15</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn">Nicolás Guarín-Zapata</span></p>
            <p class="dateline"><a href="posts/numerical-15/" rel="bookmark"><time class="post-date published dt-published" datetime="2017-10-17T16:22:06-05:00" title="2017-10-17 16:22">2017-10-17 16:22</time></a></p>
                <p class="commentline">
        
    <a href="posts/numerical-15/#disqus_thread" data-disqus-identifier="cache/posts/numerical-15.html">Comentarios</a>


        </p>
</div>
    </header><div class="e-content entry-content">
    <div>
<p>Durante octubre (2017) estaré escribiendo un programa por día para algunos
métodos numéricos famosos en Python y Julia. Esto está pensado como
un ejercicio, no esperen que el código sea lo suficientemente bueno para
usarse en la "vida real". Además, también debo mencionar que casi que no
tengo experiencia con Julia, así que probablemente no escriba un Julia
idiomático y se parezca más a Python.</p>
<div class="section" id="regla-de-simpson">
<h2>Regla de Simpson</h2>
<p>Hoy tenemos la <a class="reference external" href="https://es.wikipedia.org/wiki/Regla_de_Simpson">regla de Simpson</a>. Esta es otra de las
<a class="reference external" href="https://es.wikipedia.org/wiki/F%C3%B3rmulas_de_Newton%E2%80%93Cotes">fórmulas de Newton-Cotes</a>,
que se usa para la integración numérica. Newton-Cotes está relacionada con
la interpolación de Lagrange con puntos equidistantes.</p>
<p>A continuación se presentan los códigos.</p>
<div class="section" id="python">
<h3>Python</h3>
<pre class="code python"><a name="rest_code_953fdbecb6df4810b511df1222376fcc-1"></a><span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">division</span><span class="p">,</span> <span class="n">print_function</span>
<a name="rest_code_953fdbecb6df4810b511df1222376fcc-2"></a><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<a name="rest_code_953fdbecb6df4810b511df1222376fcc-3"></a>
<a name="rest_code_953fdbecb6df4810b511df1222376fcc-4"></a>
<a name="rest_code_953fdbecb6df4810b511df1222376fcc-5"></a><span class="k">def</span> <span class="nf">simps</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dx</span><span class="o">=</span><span class="mf">1.0</span><span class="p">):</span>
<a name="rest_code_953fdbecb6df4810b511df1222376fcc-6"></a>    <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
<a name="rest_code_953fdbecb6df4810b511df1222376fcc-7"></a>    <span class="k">if</span> <span class="n">x</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a name="rest_code_953fdbecb6df4810b511df1222376fcc-8"></a>        <span class="n">inte</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">n</span><span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="mi">4</span><span class="o">*</span><span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="n">y</span><span class="p">[</span><span class="mi">2</span><span class="p">:</span><span class="n">n</span><span class="p">:</span><span class="mi">2</span><span class="p">])</span><span class="o">*</span><span class="n">dx</span>
<a name="rest_code_953fdbecb6df4810b511df1222376fcc-9"></a>    <span class="k">else</span><span class="p">:</span>
<a name="rest_code_953fdbecb6df4810b511df1222376fcc-10"></a>        <span class="n">dx</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">::</span><span class="mi">2</span><span class="p">]</span> <span class="o">-</span> <span class="n">x</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span>
<a name="rest_code_953fdbecb6df4810b511df1222376fcc-11"></a>        <span class="n">inte</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">n</span><span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="mi">4</span><span class="o">*</span><span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="n">y</span><span class="p">[</span><span class="mi">2</span><span class="p">:</span><span class="n">n</span><span class="p">:</span><span class="mi">2</span><span class="p">],</span> <span class="n">dx</span><span class="p">)</span>
<a name="rest_code_953fdbecb6df4810b511df1222376fcc-12"></a>    <span class="k">return</span> <span class="n">inte</span><span class="o">/</span><span class="mi">3</span>
<a name="rest_code_953fdbecb6df4810b511df1222376fcc-13"></a>
<a name="rest_code_953fdbecb6df4810b511df1222376fcc-14"></a>
<a name="rest_code_953fdbecb6df4810b511df1222376fcc-15"></a><span class="n">n</span> <span class="o">=</span> <span class="mi">21</span>
<a name="rest_code_953fdbecb6df4810b511df1222376fcc-16"></a><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
<a name="rest_code_953fdbecb6df4810b511df1222376fcc-17"></a><span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="rest_code_953fdbecb6df4810b511df1222376fcc-18"></a><span class="nb">print</span><span class="p">(</span><span class="n">simps</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">))</span>
<a name="rest_code_953fdbecb6df4810b511df1222376fcc-19"></a><span class="nb">print</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
</pre>
<p>con resultados</p>
<pre class="code python"><a name="rest_code_a646301e4db147958e2ee23c54cd0695-1"></a><span class="mf">1.8397296125</span>
<a name="rest_code_a646301e4db147958e2ee23c54cd0695-2"></a><span class="mf">1.83907152908</span>
</pre>
</div>
<div class="section" id="julia">
<h3>Julia</h3>
<pre class="code julia"><a name="rest_code_f4c24ea9b558483195d886a2c1b63fc9-1"></a><span class="k">function</span> <span class="n">simps</span><span class="p">(</span><span class="n">y</span><span class="p">;</span> <span class="n">x</span><span class="o">=</span><span class="nb">nothing</span><span class="p">,</span> <span class="n">dx</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>
<a name="rest_code_f4c24ea9b558483195d886a2c1b63fc9-2"></a>    <span class="n">n</span> <span class="o">=</span> <span class="n">length</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
<a name="rest_code_f4c24ea9b558483195d886a2c1b63fc9-3"></a>    <span class="k">if</span> <span class="n">x</span> <span class="o">==</span> <span class="nb">nothing</span>
<a name="rest_code_f4c24ea9b558483195d886a2c1b63fc9-4"></a>        <span class="n">inte</span> <span class="o">=</span> <span class="n">sum</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="o">:</span><span class="mi">2</span><span class="o">:</span><span class="n">n</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="mi">4</span><span class="o">*</span><span class="n">y</span><span class="p">[</span><span class="mi">2</span><span class="o">:</span><span class="mi">2</span><span class="o">:</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">y</span><span class="p">[</span><span class="mi">3</span><span class="o">:</span><span class="mi">2</span><span class="o">:</span><span class="n">n</span><span class="p">])</span><span class="o">*</span><span class="n">dx</span>
<a name="rest_code_f4c24ea9b558483195d886a2c1b63fc9-5"></a>    <span class="k">else</span>
<a name="rest_code_f4c24ea9b558483195d886a2c1b63fc9-6"></a>        <span class="n">dx</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="o">:</span><span class="mi">2</span><span class="o">:</span><span class="k">end</span><span class="p">]</span> <span class="o">-</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="o">:</span><span class="mi">2</span><span class="o">:</span><span class="k">end</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<a name="rest_code_f4c24ea9b558483195d886a2c1b63fc9-7"></a>        <span class="n">inte</span> <span class="o">=</span> <span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="o">:</span><span class="mi">2</span><span class="o">:</span><span class="n">n</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="mi">4</span><span class="o">*</span><span class="n">y</span><span class="p">[</span><span class="mi">2</span><span class="o">:</span><span class="mi">2</span><span class="o">:</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">y</span><span class="p">[</span><span class="mi">3</span><span class="o">:</span><span class="mi">2</span><span class="o">:</span><span class="n">n</span><span class="p">])</span><span class="o">'</span> <span class="o">*</span> <span class="n">dx</span>
<a name="rest_code_f4c24ea9b558483195d886a2c1b63fc9-8"></a>    <span class="k">end</span>
<a name="rest_code_f4c24ea9b558483195d886a2c1b63fc9-9"></a>    <span class="k">return</span> <span class="n">inte</span><span class="o">/</span><span class="mi">3</span>
<a name="rest_code_f4c24ea9b558483195d886a2c1b63fc9-10"></a><span class="k">end</span>
<a name="rest_code_f4c24ea9b558483195d886a2c1b63fc9-11"></a>
<a name="rest_code_f4c24ea9b558483195d886a2c1b63fc9-12"></a>
<a name="rest_code_f4c24ea9b558483195d886a2c1b63fc9-13"></a><span class="n">n</span> <span class="o">=</span> <span class="mi">21</span>
<a name="rest_code_f4c24ea9b558483195d886a2c1b63fc9-14"></a><span class="n">x</span> <span class="o">=</span> <span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
<a name="rest_code_f4c24ea9b558483195d886a2c1b63fc9-15"></a><span class="n">y</span> <span class="o">=</span> <span class="n">sin</span><span class="o">.</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="rest_code_f4c24ea9b558483195d886a2c1b63fc9-16"></a><span class="n">println</span><span class="p">(</span><span class="n">simps</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">))</span>
<a name="rest_code_f4c24ea9b558483195d886a2c1b63fc9-17"></a><span class="n">println</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">cos</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
</pre>
<p>con resultados</p>
<pre class="code julia"><a name="rest_code_d4eac42ba7934e67b73bfa3408f1ca06-1"></a><span class="mf">1.8397296124951257</span>
<a name="rest_code_d4eac42ba7934e67b73bfa3408f1ca06-2"></a><span class="mf">1.8390715290764525</span>
</pre>
</div>
<div class="section" id="comparacion-python-julia">
<h3>Comparación Python/Julia</h3>
<p>Respecto al número de líneas tenemos: 19 en Python y 17 en Julia.  La comparación
en tiempo de ejecución se realizó con el comando mágico de IPython <code class="docutils literal">%timeit</code>
y con <code class="docutils literal">@benchmark</code> en Julia.</p>
<p>Para Python:</p>
<pre class="code IPython"><a name="rest_code_2d00c8f160f54859a0bbe7a1a0d347f5-1"></a><span class="o">%</span><span class="k">timeit</span> simps(y, x=x)
</pre>
<p>con resultado</p>
<pre class="code text"><a name="rest_code_694a1a1d270840ba8735b354fa56d7c1-1"></a>100000 loops, best of 3: 13.8 µs per loop
</pre>
<p>Para Julia:</p>
<pre class="code julia"><a name="rest_code_a387239337884744a6c71dc390fae8d4-1"></a><span class="nd">@benchmark</span> <span class="n">simps</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">)</span>
</pre>
<p>con resultado</p>
<pre class="code julia"><a name="rest_code_d8fb3dd4ef1349f0a77b15563c1b6156-1"></a><span class="n">BenchmarkTools</span><span class="o">.</span><span class="n">Trial</span><span class="o">:</span>
<a name="rest_code_d8fb3dd4ef1349f0a77b15563c1b6156-2"></a>  <span class="n">memory</span> <span class="n">estimate</span><span class="o">:</span>  <span class="mf">1.23</span> <span class="n">KiB</span>
<a name="rest_code_d8fb3dd4ef1349f0a77b15563c1b6156-3"></a>  <span class="n">allocs</span> <span class="n">estimate</span><span class="o">:</span>  <span class="mi">14</span>
<a name="rest_code_d8fb3dd4ef1349f0a77b15563c1b6156-4"></a>  <span class="o">--------------</span>
<a name="rest_code_d8fb3dd4ef1349f0a77b15563c1b6156-5"></a>  <span class="n">minimum</span> <span class="n">time</span><span class="o">:</span>     <span class="mf">1.117</span> <span class="n">μs</span> <span class="p">(</span><span class="mf">0.00</span><span class="o">%</span> <span class="n">GC</span><span class="p">)</span>
<a name="rest_code_d8fb3dd4ef1349f0a77b15563c1b6156-6"></a>  <span class="n">median</span> <span class="n">time</span><span class="o">:</span>      <span class="mf">1.200</span> <span class="n">μs</span> <span class="p">(</span><span class="mf">0.00</span><span class="o">%</span> <span class="n">GC</span><span class="p">)</span>
<a name="rest_code_d8fb3dd4ef1349f0a77b15563c1b6156-7"></a>  <span class="n">mean</span> <span class="n">time</span><span class="o">:</span>        <span class="mf">1.404</span> <span class="n">μs</span> <span class="p">(</span><span class="mf">7.04</span><span class="o">%</span> <span class="n">GC</span><span class="p">)</span>
<a name="rest_code_d8fb3dd4ef1349f0a77b15563c1b6156-8"></a>  <span class="n">maximum</span> <span class="n">time</span><span class="o">:</span>     <span class="mf">222.286</span> <span class="n">μs</span> <span class="p">(</span><span class="mf">96.45</span><span class="o">%</span> <span class="n">GC</span><span class="p">)</span>
<a name="rest_code_d8fb3dd4ef1349f0a77b15563c1b6156-9"></a>  <span class="o">--------------</span>
<a name="rest_code_d8fb3dd4ef1349f0a77b15563c1b6156-10"></a>  <span class="n">samples</span><span class="o">:</span>          <span class="mi">10000</span>
<a name="rest_code_d8fb3dd4ef1349f0a77b15563c1b6156-11"></a>  <span class="n">evals</span><span class="o">/</span><span class="n">sample</span><span class="o">:</span>     <span class="mi">10</span>
</pre>
<p>En este caso, podemos decir que el código de Python es alrededor de 10 veces
más lento que el de Julia.</p>
</div>
</div>
</div>
    </div>
    </article><article class="post h-entry post-text"><header><h1 class="post-title p-name"><a href="posts/numerical-14/" class="u-url">Reto de métodos numéricos: Día 14</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn">Nicolás Guarín-Zapata</span></p>
            <p class="dateline"><a href="posts/numerical-14/" rel="bookmark"><time class="post-date published dt-published" datetime="2017-10-14T14:00:42-05:00" title="2017-10-14 14:00">2017-10-14 14:00</time></a></p>
                <p class="commentline">
        
    <a href="posts/numerical-14/#disqus_thread" data-disqus-identifier="cache/posts/numerical-14.html">Comentarios</a>


        </p>
</div>
    </header><div class="e-content entry-content">
    <div>
<p>Durante octubre (2017) estaré escribiendo un programa por día para algunos
métodos numéricos famosos en Python y Julia. Esto está pensado como
un ejercicio, no esperen que el código sea lo suficientemente bueno para
usarse en la "vida real". Además, también debo mencionar que casi que no
tengo experiencia con Julia, así que probablemente no escriba un Julia
idiomático y se parezca más a Python.</p>
<div class="section" id="regla-del-trapecio">
<h2>Regla del trapecio</h2>
<p>Hoy tenemos la <a class="reference external" href="https://es.wikipedia.org/wiki/Regla_del_trapecio">regla del trapecio</a>. Esta es la más simple de
las <a class="reference external" href="https://es.wikipedia.org/wiki/F%C3%B3rmulas_de_Newton%E2%80%93Cotes">fórmulas de Newton-Cotes</a>
para integración numérica. La integración de Newton-Cotes se relaciona con
la interpolación de Lagrange con puntos equidistantes.</p>
<p>A continuación se presentan los códigos.</p>
<div class="section" id="python">
<h3>Python</h3>
<pre class="code python"><a name="rest_code_17e2ade91c0f4d2d97cbe015b19f436d-1"></a><span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">division</span><span class="p">,</span> <span class="n">print_function</span>
<a name="rest_code_17e2ade91c0f4d2d97cbe015b19f436d-2"></a><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<a name="rest_code_17e2ade91c0f4d2d97cbe015b19f436d-3"></a>
<a name="rest_code_17e2ade91c0f4d2d97cbe015b19f436d-4"></a>
<a name="rest_code_17e2ade91c0f4d2d97cbe015b19f436d-5"></a><span class="k">def</span> <span class="nf">trapz</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dx</span><span class="o">=</span><span class="mf">1.0</span><span class="p">):</span>
<a name="rest_code_17e2ade91c0f4d2d97cbe015b19f436d-6"></a>    <span class="k">if</span> <span class="n">x</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a name="rest_code_17e2ade91c0f4d2d97cbe015b19f436d-7"></a>        <span class="n">inte</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">dx</span><span class="o">*</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">y</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<a name="rest_code_17e2ade91c0f4d2d97cbe015b19f436d-8"></a>    <span class="k">else</span><span class="p">:</span>
<a name="rest_code_17e2ade91c0f4d2d97cbe015b19f436d-9"></a>        <span class="n">dx</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="o">-</span> <span class="n">x</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<a name="rest_code_17e2ade91c0f4d2d97cbe015b19f436d-10"></a>        <span class="n">inte</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">y</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span> <span class="n">dx</span><span class="p">)</span>
<a name="rest_code_17e2ade91c0f4d2d97cbe015b19f436d-11"></a>    <span class="k">return</span> <span class="n">inte</span>
<a name="rest_code_17e2ade91c0f4d2d97cbe015b19f436d-12"></a>
<a name="rest_code_17e2ade91c0f4d2d97cbe015b19f436d-13"></a>
<a name="rest_code_17e2ade91c0f4d2d97cbe015b19f436d-14"></a><span class="n">dx</span> <span class="o">=</span> <span class="mf">0.001</span>
<a name="rest_code_17e2ade91c0f4d2d97cbe015b19f436d-15"></a><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">dx</span><span class="p">)</span>
<a name="rest_code_17e2ade91c0f4d2d97cbe015b19f436d-16"></a><span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="rest_code_17e2ade91c0f4d2d97cbe015b19f436d-17"></a><span class="nb">print</span><span class="p">(</span><span class="n">trapz</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">dx</span><span class="o">=</span><span class="n">dx</span><span class="p">))</span>
<a name="rest_code_17e2ade91c0f4d2d97cbe015b19f436d-18"></a><span class="nb">print</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
</pre>
<p>con resultado</p>
<pre class="code python"><a name="rest_code_9a7cf62727f84acfbbc2f793de5238aa-1"></a><span class="mf">1.83961497726</span>
<a name="rest_code_9a7cf62727f84acfbbc2f793de5238aa-2"></a><span class="mf">1.83907152908</span>
</pre>
</div>
<div class="section" id="julia">
<h3>Julia</h3>
<pre class="code julia"><a name="rest_code_0cdfe2f8237240759e6c8e7be88c8254-1"></a><span class="k">function</span> <span class="n">trapz</span><span class="p">(</span><span class="n">y</span><span class="p">;</span> <span class="n">x</span><span class="o">=</span><span class="nb">nothing</span><span class="p">,</span> <span class="n">dx</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>
<a name="rest_code_0cdfe2f8237240759e6c8e7be88c8254-2"></a>    <span class="k">if</span> <span class="n">x</span> <span class="o">==</span> <span class="nb">nothing</span>
<a name="rest_code_0cdfe2f8237240759e6c8e7be88c8254-3"></a>        <span class="n">inte</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">dx</span><span class="o">*</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">sum</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="mi">2</span><span class="o">:</span><span class="k">end</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">y</span><span class="p">[</span><span class="k">end</span><span class="p">])</span>
<a name="rest_code_0cdfe2f8237240759e6c8e7be88c8254-4"></a>    <span class="k">else</span>
<a name="rest_code_0cdfe2f8237240759e6c8e7be88c8254-5"></a>        <span class="n">dx</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="o">:</span><span class="k">end</span><span class="p">]</span> <span class="o">-</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="o">:</span><span class="k">end</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<a name="rest_code_0cdfe2f8237240759e6c8e7be88c8254-6"></a>        <span class="n">inte</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span> <span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="o">:</span><span class="k">end</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">y</span><span class="p">[</span><span class="mi">2</span><span class="o">:</span><span class="k">end</span><span class="p">])</span><span class="o">'</span> <span class="o">*</span> <span class="n">dx</span>
<a name="rest_code_0cdfe2f8237240759e6c8e7be88c8254-7"></a>    <span class="k">end</span>
<a name="rest_code_0cdfe2f8237240759e6c8e7be88c8254-8"></a>    <span class="k">return</span> <span class="n">inte</span>
<a name="rest_code_0cdfe2f8237240759e6c8e7be88c8254-9"></a><span class="k">end</span>
<a name="rest_code_0cdfe2f8237240759e6c8e7be88c8254-10"></a>
<a name="rest_code_0cdfe2f8237240759e6c8e7be88c8254-11"></a>
<a name="rest_code_0cdfe2f8237240759e6c8e7be88c8254-12"></a><span class="n">dx</span> <span class="o">=</span> <span class="mf">0.001</span>
<a name="rest_code_0cdfe2f8237240759e6c8e7be88c8254-13"></a><span class="n">x</span> <span class="o">=</span> <span class="mi">0</span><span class="o">:</span><span class="n">dx</span><span class="o">:</span><span class="mi">10</span>
<a name="rest_code_0cdfe2f8237240759e6c8e7be88c8254-14"></a><span class="n">y</span> <span class="o">=</span> <span class="n">sin</span><span class="o">.</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="rest_code_0cdfe2f8237240759e6c8e7be88c8254-15"></a><span class="n">println</span><span class="p">(</span><span class="n">trapz</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">dx</span><span class="o">=</span><span class="n">dx</span><span class="p">))</span>
<a name="rest_code_0cdfe2f8237240759e6c8e7be88c8254-16"></a><span class="n">println</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">cos</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
</pre>
<p>con resultado</p>
<pre class="code julia"><a name="rest_code_40b0eb21281647bbb09266ca5790b939-1"></a><span class="mf">1.8390713758204895</span>
<a name="rest_code_40b0eb21281647bbb09266ca5790b939-2"></a><span class="mf">1.8390715290764525</span>
</pre>
</div>
<div class="section" id="comparacion-python-julia">
<h3>Comparación Python/Julia</h3>
<p>Respecto al número de líneas tenemos: 18 en Python y 16 en Julia.  La comparación
en tiempo de ejecución se realizó con el comando mágico de IPython <code class="docutils literal">%timeit</code>
y con <code class="docutils literal">@benchmark</code> en Julia.</p>
<p>Para Python:</p>
<pre class="code IPython"><a name="rest_code_a68de0b8b6704ddf86e1df7280c48380-1"></a><span class="o">%</span><span class="k">timeit</span> trapz(y, dx=dx)
</pre>
<p>con resultado</p>
<pre class="code text"><a name="rest_code_bb2983feaa3c4950942460410874e375-1"></a>100000 loops, best of 3: 16.9 µs per loop
</pre>
<p>Para Julia:</p>
<pre class="code julia"><a name="rest_code_7f0ff826213f450188f02d239d0a36ad-1"></a><span class="nd">@benchmark</span> <span class="n">trapz</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">dx</span><span class="o">=</span><span class="n">dx</span><span class="p">)</span>
</pre>
<p>con resultado</p>
<pre class="code julia"><a name="rest_code_d77851ce7e3f497099a716a8ed7f38cd-1"></a><span class="n">BenchmarkTools</span><span class="o">.</span><span class="n">Trial</span><span class="o">:</span>
<a name="rest_code_d77851ce7e3f497099a716a8ed7f38cd-2"></a>  <span class="n">memory</span> <span class="n">estimate</span><span class="o">:</span>  <span class="mf">78.31</span> <span class="n">KiB</span>
<a name="rest_code_d77851ce7e3f497099a716a8ed7f38cd-3"></a>  <span class="n">allocs</span> <span class="n">estimate</span><span class="o">:</span>  <span class="mi">4</span>
<a name="rest_code_d77851ce7e3f497099a716a8ed7f38cd-4"></a>  <span class="o">--------------</span>
<a name="rest_code_d77851ce7e3f497099a716a8ed7f38cd-5"></a>  <span class="n">minimum</span> <span class="n">time</span><span class="o">:</span>     <span class="mf">13.080</span> <span class="n">μs</span> <span class="p">(</span><span class="mf">0.00</span><span class="o">%</span> <span class="n">GC</span><span class="p">)</span>
<a name="rest_code_d77851ce7e3f497099a716a8ed7f38cd-6"></a>  <span class="n">median</span> <span class="n">time</span><span class="o">:</span>      <span class="mf">16.333</span> <span class="n">μs</span> <span class="p">(</span><span class="mf">0.00</span><span class="o">%</span> <span class="n">GC</span><span class="p">)</span>
<a name="rest_code_d77851ce7e3f497099a716a8ed7f38cd-7"></a>  <span class="n">mean</span> <span class="n">time</span><span class="o">:</span>        <span class="mf">20.099</span> <span class="n">μs</span> <span class="p">(</span><span class="mf">12.66</span><span class="o">%</span> <span class="n">GC</span><span class="p">)</span>
<a name="rest_code_d77851ce7e3f497099a716a8ed7f38cd-8"></a>  <span class="n">maximum</span> <span class="n">time</span><span class="o">:</span>     <span class="mf">963.732</span> <span class="n">μs</span> <span class="p">(</span><span class="mf">90.60</span><span class="o">%</span> <span class="n">GC</span><span class="p">)</span>
<a name="rest_code_d77851ce7e3f497099a716a8ed7f38cd-9"></a>  <span class="o">--------------</span>
<a name="rest_code_d77851ce7e3f497099a716a8ed7f38cd-10"></a>  <span class="n">samples</span><span class="o">:</span>          <span class="mi">10000</span>
<a name="rest_code_d77851ce7e3f497099a716a8ed7f38cd-11"></a>  <span class="n">evals</span><span class="o">/</span><span class="n">sample</span><span class="o">:</span>     <span class="mi">1</span>
</pre>
<p>En este caso, podemos decir que el código de Python es tan rápido como
el de Julia.</p>
</div>
</div>
</div>
    </div>
    </article><article class="post h-entry post-text"><header><h1 class="post-title p-name"><a href="posts/numerical-13/" class="u-url">Reto de métodos numéricos: Día 13</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn">Nicolás Guarín-Zapata</span></p>
            <p class="dateline"><a href="posts/numerical-13/" rel="bookmark"><time class="post-date published dt-published" datetime="2017-10-13T19:20:06-05:00" title="2017-10-13 19:20">2017-10-13 19:20</time></a></p>
                <p class="commentline">
        
    <a href="posts/numerical-13/#disqus_thread" data-disqus-identifier="cache/posts/numerical-13.html">Comentarios</a>


        </p>
</div>
    </header><div class="e-content entry-content">
    <div>
<p>Durante octubre (2017) estaré escribiendo un programa por día para algunos
métodos numéricos famosos en Python y Julia. Esto está pensado como
un ejercicio, no esperen que el código sea lo suficientemente bueno para
usarse en la "vida real". Además, también debo mencionar que casi que no
tengo experiencia con Julia, así que probablemente no escriba un Julia
idiomático y se parezca más a Python.</p>
<div class="section" id="splines-cubicas">
<h2>Splines cúbicas</h2>
<p>Hoy tenemos <a class="reference external" href="https://en.wikipedia.org/wiki/Spline_(mathematics)">interpolación por splines cúbicas</a>.
Las splines cúbicas se usan a menudo porque brindan una aproximación a una
función con continuidad hasta la segunda derivada. Para más detalles se
puede revisar <a class="reference external" href="https://en.wikipedia.org/wiki/Spline_(mathematics)#Algorithm_for_computing_natural_cubic_splines">este algoritmo</a>.
La diferencia principal es qeu formaremos la matriz y luego resolveremos el
sistema. Es más común resolver el sistema de forma directa ya que este es
tridiagonal.</p>
<p>A continuación los códigos.</p>
<div class="section" id="python">
<h3>Python</h3>
<pre class="code python"><a name="rest_code_3cc78a73e4bb40708334f8605ee02e48-1"></a><span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">division</span><span class="p">,</span> <span class="n">print_function</span>
<a name="rest_code_3cc78a73e4bb40708334f8605ee02e48-2"></a><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<a name="rest_code_3cc78a73e4bb40708334f8605ee02e48-3"></a><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<a name="rest_code_3cc78a73e4bb40708334f8605ee02e48-4"></a>
<a name="rest_code_3cc78a73e4bb40708334f8605ee02e48-5"></a>
<a name="rest_code_3cc78a73e4bb40708334f8605ee02e48-6"></a><span class="k">def</span> <span class="nf">spline_coeff</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
<a name="rest_code_3cc78a73e4bb40708334f8605ee02e48-7"></a>    <span class="n">h</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="o">-</span> <span class="n">x</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<a name="rest_code_3cc78a73e4bb40708334f8605ee02e48-8"></a>    <span class="n">d_up</span> <span class="o">=</span> <span class="n">h</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<a name="rest_code_3cc78a73e4bb40708334f8605ee02e48-9"></a>    <span class="n">d_up</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
<a name="rest_code_3cc78a73e4bb40708334f8605ee02e48-10"></a>    <span class="n">d_down</span> <span class="o">=</span> <span class="n">h</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<a name="rest_code_3cc78a73e4bb40708334f8605ee02e48-11"></a>    <span class="n">d_down</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
<a name="rest_code_3cc78a73e4bb40708334f8605ee02e48-12"></a>    <span class="n">d_cent</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="rest_code_3cc78a73e4bb40708334f8605ee02e48-13"></a>    <span class="n">d_cent</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">h</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">h</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span>
<a name="rest_code_3cc78a73e4bb40708334f8605ee02e48-14"></a>    <span class="n">mat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">d_cent</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">d_up</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">d_down</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a name="rest_code_3cc78a73e4bb40708334f8605ee02e48-15"></a>    <span class="n">alpha</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="rest_code_3cc78a73e4bb40708334f8605ee02e48-16"></a>    <span class="n">alpha</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">3</span><span class="o">/</span><span class="n">h</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span><span class="o">*</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="mi">2</span><span class="p">:]</span> <span class="o">-</span> <span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="o">-</span> <span class="mi">3</span><span class="o">/</span><span class="n">h</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">y</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">])</span>
<a name="rest_code_3cc78a73e4bb40708334f8605ee02e48-17"></a>    <span class="n">c</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">mat</span><span class="p">,</span> <span class="n">alpha</span><span class="p">)</span>
<a name="rest_code_3cc78a73e4bb40708334f8605ee02e48-18"></a>    <span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="rest_code_3cc78a73e4bb40708334f8605ee02e48-19"></a>    <span class="n">d</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="rest_code_3cc78a73e4bb40708334f8605ee02e48-20"></a>    <span class="n">b</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="o">-</span> <span class="n">y</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="n">h</span> <span class="o">-</span> <span class="n">h</span><span class="o">/</span><span class="mi">3</span><span class="o">*</span><span class="p">(</span><span class="n">c</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">c</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<a name="rest_code_3cc78a73e4bb40708334f8605ee02e48-21"></a>    <span class="n">d</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">c</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="o">-</span> <span class="n">c</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">h</span><span class="p">)</span>
<a name="rest_code_3cc78a73e4bb40708334f8605ee02e48-22"></a>    <span class="k">return</span> <span class="n">y</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">d</span>
<a name="rest_code_3cc78a73e4bb40708334f8605ee02e48-23"></a>
<a name="rest_code_3cc78a73e4bb40708334f8605ee02e48-24"></a>
<a name="rest_code_3cc78a73e4bb40708334f8605ee02e48-25"></a><span class="n">n</span> <span class="o">=</span> <span class="mi">20</span>
<a name="rest_code_3cc78a73e4bb40708334f8605ee02e48-26"></a><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
<a name="rest_code_3cc78a73e4bb40708334f8605ee02e48-27"></a><span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="rest_code_3cc78a73e4bb40708334f8605ee02e48-28"></a><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">d</span> <span class="o">=</span> <span class="n">spline_coeff</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<a name="rest_code_3cc78a73e4bb40708334f8605ee02e48-29"></a><span class="k">for</span> <span class="n">cont</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
<a name="rest_code_3cc78a73e4bb40708334f8605ee02e48-30"></a>    <span class="n">x_loc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">cont</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="n">cont</span> <span class="o">+</span> <span class="mi">1</span><span class="p">],</span> <span class="mi">100</span><span class="p">)</span>
<a name="rest_code_3cc78a73e4bb40708334f8605ee02e48-31"></a>    <span class="n">y_loc</span> <span class="o">=</span> <span class="n">a</span><span class="p">[</span><span class="n">cont</span><span class="p">]</span> <span class="o">+</span> <span class="n">b</span><span class="p">[</span><span class="n">cont</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">x_loc</span> <span class="o">-</span> <span class="n">x</span><span class="p">[</span><span class="n">cont</span><span class="p">])</span> <span class="o">+</span>\
<a name="rest_code_3cc78a73e4bb40708334f8605ee02e48-32"></a>            <span class="n">c</span><span class="p">[</span><span class="n">cont</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">x_loc</span> <span class="o">-</span> <span class="n">x</span><span class="p">[</span><span class="n">cont</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span>\
<a name="rest_code_3cc78a73e4bb40708334f8605ee02e48-33"></a>            <span class="n">d</span><span class="p">[</span><span class="n">cont</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">x_loc</span> <span class="o">-</span> <span class="n">x</span><span class="p">[</span><span class="n">cont</span><span class="p">])</span><span class="o">**</span><span class="mi">3</span>
<a name="rest_code_3cc78a73e4bb40708334f8605ee02e48-34"></a>    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_loc</span><span class="p">,</span> <span class="n">y_loc</span><span class="p">,</span> <span class="s2">"red"</span><span class="p">)</span>
<a name="rest_code_3cc78a73e4bb40708334f8605ee02e48-35"></a><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s2">"o"</span><span class="p">)</span>
<a name="rest_code_3cc78a73e4bb40708334f8605ee02e48-36"></a><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre>
</div>
<div class="section" id="julia">
<h3>Julia</h3>
<pre class="code julia"><a name="rest_code_792c6e72d8bf41608ea88df3e65b0ecf-1"></a><span class="k">using</span> <span class="n">PyPlot</span>
<a name="rest_code_792c6e72d8bf41608ea88df3e65b0ecf-2"></a>
<a name="rest_code_792c6e72d8bf41608ea88df3e65b0ecf-3"></a>
<a name="rest_code_792c6e72d8bf41608ea88df3e65b0ecf-4"></a><span class="k">function</span> <span class="n">spline_coeff</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<a name="rest_code_792c6e72d8bf41608ea88df3e65b0ecf-5"></a>    <span class="n">h</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="o">:</span><span class="k">end</span><span class="p">]</span> <span class="o">-</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="o">:</span><span class="k">end</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<a name="rest_code_792c6e72d8bf41608ea88df3e65b0ecf-6"></a>    <span class="n">d_up</span> <span class="o">=</span> <span class="n">copy</span><span class="p">(</span><span class="n">h</span><span class="p">)</span>
<a name="rest_code_792c6e72d8bf41608ea88df3e65b0ecf-7"></a>    <span class="n">d_up</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span>
<a name="rest_code_792c6e72d8bf41608ea88df3e65b0ecf-8"></a>    <span class="n">d_down</span> <span class="o">=</span> <span class="n">copy</span><span class="p">(</span><span class="n">h</span><span class="p">)</span>
<a name="rest_code_792c6e72d8bf41608ea88df3e65b0ecf-9"></a>    <span class="n">d_down</span><span class="p">[</span><span class="k">end</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span>
<a name="rest_code_792c6e72d8bf41608ea88df3e65b0ecf-10"></a>    <span class="n">d_cent</span> <span class="o">=</span> <span class="n">ones</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="rest_code_792c6e72d8bf41608ea88df3e65b0ecf-11"></a>    <span class="n">d_cent</span><span class="p">[</span><span class="mi">2</span><span class="o">:</span><span class="k">end</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">h</span><span class="p">[</span><span class="mi">1</span><span class="o">:</span><span class="k">end</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">h</span><span class="p">[</span><span class="mi">2</span><span class="o">:</span><span class="k">end</span><span class="p">])</span>
<a name="rest_code_792c6e72d8bf41608ea88df3e65b0ecf-12"></a>    <span class="n">mat</span> <span class="o">=</span> <span class="n">diagm</span><span class="p">(</span><span class="n">d_cent</span><span class="p">)</span> <span class="o">+</span> <span class="n">diagm</span><span class="p">(</span><span class="n">d_up</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">diagm</span><span class="p">(</span><span class="n">d_down</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a name="rest_code_792c6e72d8bf41608ea88df3e65b0ecf-13"></a>    <span class="n">alpha</span> <span class="o">=</span> <span class="n">zeros</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="rest_code_792c6e72d8bf41608ea88df3e65b0ecf-14"></a>    <span class="n">alpha</span><span class="p">[</span><span class="mi">2</span><span class="o">:</span><span class="k">end</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mf">3.</span><span class="o">/</span><span class="n">h</span><span class="p">[</span><span class="mi">2</span><span class="o">:</span><span class="k">end</span><span class="p">]</span><span class="o">.*</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="mi">3</span><span class="o">:</span><span class="k">end</span><span class="p">]</span> <span class="o">-</span> <span class="n">y</span><span class="p">[</span><span class="mi">2</span><span class="o">:</span><span class="k">end</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="o">-</span> <span class="mf">3.</span><span class="o">/</span><span class="n">h</span><span class="p">[</span><span class="mi">1</span><span class="o">:</span><span class="k">end</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.*</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="mi">2</span><span class="o">:</span><span class="k">end</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="o">:</span><span class="k">end</span><span class="o">-</span><span class="mi">2</span><span class="p">])</span>
<a name="rest_code_792c6e72d8bf41608ea88df3e65b0ecf-15"></a>    <span class="n">c</span> <span class="o">=</span> <span class="n">mat</span> <span class="o">\</span> <span class="n">alpha</span>
<a name="rest_code_792c6e72d8bf41608ea88df3e65b0ecf-16"></a>    <span class="n">b</span> <span class="o">=</span> <span class="n">zeros</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="rest_code_792c6e72d8bf41608ea88df3e65b0ecf-17"></a>    <span class="n">d</span> <span class="o">=</span> <span class="n">zeros</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="rest_code_792c6e72d8bf41608ea88df3e65b0ecf-18"></a>    <span class="n">b</span><span class="p">[</span><span class="mi">1</span><span class="o">:</span><span class="k">end</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="mi">2</span><span class="o">:</span><span class="k">end</span><span class="p">]</span> <span class="o">-</span> <span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="o">:</span><span class="k">end</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span><span class="o">./</span><span class="n">h</span> <span class="o">-</span> <span class="n">h</span><span class="o">./</span><span class="mf">3.</span><span class="o">*</span><span class="p">(</span><span class="n">c</span><span class="p">[</span><span class="mi">2</span><span class="o">:</span><span class="k">end</span><span class="p">]</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">c</span><span class="p">[</span><span class="mi">1</span><span class="o">:</span><span class="k">end</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<a name="rest_code_792c6e72d8bf41608ea88df3e65b0ecf-19"></a>    <span class="n">d</span><span class="p">[</span><span class="mi">1</span><span class="o">:</span><span class="k">end</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">c</span><span class="p">[</span><span class="mi">2</span><span class="o">:</span><span class="k">end</span><span class="p">]</span> <span class="o">-</span> <span class="n">c</span><span class="p">[</span><span class="mi">1</span><span class="o">:</span><span class="k">end</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span><span class="o">./</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">h</span><span class="p">)</span>
<a name="rest_code_792c6e72d8bf41608ea88df3e65b0ecf-20"></a>    <span class="k">return</span> <span class="n">y</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">d</span>
<a name="rest_code_792c6e72d8bf41608ea88df3e65b0ecf-21"></a><span class="k">end</span>
<a name="rest_code_792c6e72d8bf41608ea88df3e65b0ecf-22"></a>
<a name="rest_code_792c6e72d8bf41608ea88df3e65b0ecf-23"></a>
<a name="rest_code_792c6e72d8bf41608ea88df3e65b0ecf-24"></a><span class="n">n</span> <span class="o">=</span> <span class="mi">21</span>
<a name="rest_code_792c6e72d8bf41608ea88df3e65b0ecf-25"></a><span class="n">x</span> <span class="o">=</span> <span class="n">collect</span><span class="p">(</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="nb">pi</span><span class="p">,</span> <span class="n">n</span><span class="p">))</span>
<a name="rest_code_792c6e72d8bf41608ea88df3e65b0ecf-26"></a><span class="n">y</span> <span class="o">=</span> <span class="n">sin</span><span class="o">.</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="rest_code_792c6e72d8bf41608ea88df3e65b0ecf-27"></a><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">d</span> <span class="o">=</span> <span class="n">spline_coeff</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<a name="rest_code_792c6e72d8bf41608ea88df3e65b0ecf-28"></a><span class="k">for</span> <span class="n">cont</span> <span class="o">=</span> <span class="mi">1</span><span class="o">:</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span>
<a name="rest_code_792c6e72d8bf41608ea88df3e65b0ecf-29"></a>    <span class="n">x_loc</span> <span class="o">=</span> <span class="n">linspace</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">cont</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="n">cont</span> <span class="o">+</span> <span class="mi">1</span><span class="p">],</span> <span class="mi">100</span><span class="p">)</span>
<a name="rest_code_792c6e72d8bf41608ea88df3e65b0ecf-30"></a>    <span class="n">y_loc</span> <span class="o">=</span> <span class="n">a</span><span class="p">[</span><span class="n">cont</span><span class="p">]</span> <span class="o">+</span> <span class="n">b</span><span class="p">[</span><span class="n">cont</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">x_loc</span> <span class="o">-</span> <span class="n">x</span><span class="p">[</span><span class="n">cont</span><span class="p">])</span> <span class="o">+</span>
<a name="rest_code_792c6e72d8bf41608ea88df3e65b0ecf-31"></a>            <span class="n">c</span><span class="p">[</span><span class="n">cont</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">x_loc</span> <span class="o">-</span> <span class="n">x</span><span class="p">[</span><span class="n">cont</span><span class="p">])</span><span class="o">.^</span><span class="mi">2</span> <span class="o">+</span>
<a name="rest_code_792c6e72d8bf41608ea88df3e65b0ecf-32"></a>            <span class="n">d</span><span class="p">[</span><span class="n">cont</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">x_loc</span> <span class="o">-</span> <span class="n">x</span><span class="p">[</span><span class="n">cont</span><span class="p">])</span><span class="o">.^</span><span class="mi">3</span>
<a name="rest_code_792c6e72d8bf41608ea88df3e65b0ecf-33"></a>    <span class="n">plot</span><span class="p">(</span><span class="n">x_loc</span><span class="p">,</span> <span class="n">y_loc</span><span class="p">,</span> <span class="s">"red"</span><span class="p">)</span>
<a name="rest_code_792c6e72d8bf41608ea88df3e65b0ecf-34"></a><span class="k">end</span>
<a name="rest_code_792c6e72d8bf41608ea88df3e65b0ecf-35"></a><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s">"o"</span><span class="p">)</span>
<a name="rest_code_792c6e72d8bf41608ea88df3e65b0ecf-36"></a><span class="n">show</span><span class="p">()</span>
</pre>
<p>En ambos casos el resultado es la siguiente gráfica.</p>
<img alt="Interpolación spline." class="align-center" src="../images/spline.svg" style="width: 500px;">
</div>
<div class="section" id="comparacion-python-julia">
<h3>Comparación Python/Julia</h3>
<p>Respecto al número de líneas tenemos: 36 en Python y 37 en Julia.  La comparación
en tiempo de ejecución se realizó con el comando mágico de IPython <code class="docutils literal">%timeit</code>
y con <code class="docutils literal">@benchmark</code> en Julia.</p>
<p>Para Python:</p>
<pre class="code IPython"><a name="rest_code_b7ed4e7c129a4a9883f2df6ee2c25a78-1"></a><span class="o">%</span><span class="k">timeit</span> a, b, c, d = spline_coeff(x, y)
</pre>
<p>con resultado</p>
<pre class="code text"><a name="rest_code_df991f115b8442c88539216c40e21712-1"></a>1000 loops, best of 3: 216 µs per loop
</pre>
<p>Para Julia:</p>
<pre class="code julia"><a name="rest_code_1e0d0a7361924e51808dd981b7220986-1"></a><span class="nd">@benchmark</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">d</span> <span class="o">=</span> <span class="n">spline_coeff</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</pre>
<p>con resultado</p>
<pre class="code julia"><a name="rest_code_d988428aa1e443cf8becb5567bfc59c6-1"></a><span class="n">BenchmarkTools</span><span class="o">.</span><span class="n">Trial</span><span class="o">:</span>
<a name="rest_code_d988428aa1e443cf8becb5567bfc59c6-2"></a>  <span class="n">memory</span> <span class="n">estimate</span><span class="o">:</span>  <span class="mf">31.59</span> <span class="n">KiB</span>
<a name="rest_code_d988428aa1e443cf8becb5567bfc59c6-3"></a>  <span class="n">allocs</span> <span class="n">estimate</span><span class="o">:</span>  <span class="mi">52</span>
<a name="rest_code_d988428aa1e443cf8becb5567bfc59c6-4"></a>  <span class="o">--------------</span>
<a name="rest_code_d988428aa1e443cf8becb5567bfc59c6-5"></a>  <span class="n">minimum</span> <span class="n">time</span><span class="o">:</span>     <span class="mf">18.024</span> <span class="n">μs</span> <span class="p">(</span><span class="mf">0.00</span><span class="o">%</span> <span class="n">GC</span><span class="p">)</span>
<a name="rest_code_d988428aa1e443cf8becb5567bfc59c6-6"></a>  <span class="n">median</span> <span class="n">time</span><span class="o">:</span>      <span class="mf">26.401</span> <span class="n">μs</span> <span class="p">(</span><span class="mf">0.00</span><span class="o">%</span> <span class="n">GC</span><span class="p">)</span>
<a name="rest_code_d988428aa1e443cf8becb5567bfc59c6-7"></a>  <span class="n">mean</span> <span class="n">time</span><span class="o">:</span>        <span class="mf">44.035</span> <span class="n">μs</span> <span class="p">(</span><span class="mf">3.94</span><span class="o">%</span> <span class="n">GC</span><span class="p">)</span>
<a name="rest_code_d988428aa1e443cf8becb5567bfc59c6-8"></a>  <span class="n">maximum</span> <span class="n">time</span><span class="o">:</span>     <span class="mf">9.833</span> <span class="n">ms</span> <span class="p">(</span><span class="mf">0.00</span><span class="o">%</span> <span class="n">GC</span><span class="p">)</span>
<a name="rest_code_d988428aa1e443cf8becb5567bfc59c6-9"></a>  <span class="o">--------------</span>
<a name="rest_code_d988428aa1e443cf8becb5567bfc59c6-10"></a>  <span class="n">samples</span><span class="o">:</span>          <span class="mi">10000</span>
<a name="rest_code_d988428aa1e443cf8becb5567bfc59c6-11"></a>  <span class="n">evals</span><span class="o">/</span><span class="n">sample</span><span class="o">:</span>     <span class="mi">1</span>
</pre>
<p>En este caso, podemos decir que el código de Python es alrededor de 10 veces más
lento.</p>
</div>
</div>
</div>
    </div>
    </article>
</div>

        <nav class="postindexpager"><ul class="pager">
<li class="previous">
                <a href="index-4.html" rel="prev">Publicaciones posteriores</a>
            </li>
            <li class="next">
                <a href="index-2.html" rel="next">Publicaciones anteriores</a>
            </li>
        </ul></nav><script>var disqus_shortname="nicoguaro-github";(function(){var a=document.createElement("script");a.async=true;a.src="https://"+disqus_shortname+".disqus.com/count.js";(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(a)}());</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML" integrity="sha384-3lJUsx1TJHt7BA4udB5KPnDrlkO8T6J6v/op7ui0BbCjvZ9WqV4Xm6DTP6kQ/iBH" crossorigin="anonymous"></script><script type="text/x-mathjax-config">
        MathJax.Hub.Config({tex2jax: {inlineMath: [['$latex ','$'], ['\\(','\\)']]}});
        </script><footer id="footer"><p>Contents © 2021 <a href="mailto:nicoguarin@gmail.com">Nicolás Guarín-Zapata</a> - Powered by <a href="https://getnikola.com" rel="nofollow">Nikola</a> 
<a rel="license" href="http://creativecommons.org/licenses/by/4.0/">
<img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by/4.0/88x31.png"></a></p>
            
        </footer>
</div>
    </div>
    <label for="sidebar-checkbox" class="sidebar-toggle"></label>
    
<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-145359674-1', 'auto');
ga('send', 'pageview');
</script><script src="../assets/js/all-nocdn.js"></script><!-- fancy dates --><script>
    moment.locale("es");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates -->
</body>
</html>
