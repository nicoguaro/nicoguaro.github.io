<!DOCTYPE html>
<html prefix="" lang="es">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width">
<title>Diferencias finitas en dominios infinitos | Nicolás' blog</title>
<link href="../../../assets/css/all.css" rel="stylesheet" type="text/css">
<link rel="stylesheet" href="//fonts.googleapis.com/css?family=PT+Serif:400,400italic,700%7CPT+Sans:400">
<link rel="alternate" type="application/rss+xml" title="RSS (en)" href="../../../rss.xml">
<link rel="alternate" type="application/rss+xml" title="RSS (es)" href="../../rss.xml">
<link rel="canonical" href="https://nicoguaro.github.io/es/posts/infinite_fdm/">
<!--[if lt IE 9]><script src="../../../../assets/js/html5.js"></script><![endif]--><meta name="author" content="Nicolás Guarín-Zapata">
<link rel="prev" href="../cyclic_colormaps/" title="Comparación de mapas de colores cíclicos" type="text/html">
<link rel="next" href="../isometric_inkscape/" title="Gráficos isométricos en Inkscape" type="text/html">
<meta property="og:site_name" content="Nicolás' blog">
<meta property="og:title" content="Diferencias finitas en dominios infinitos">
<meta property="og:url" content="https://nicoguaro.github.io/es/posts/infinite_fdm/">
<meta property="og:description" content="Diferencias finitas en dominios infinitos
Gracias a mi amigo, Edward Villegas,
terminé pensando acerca del uso de cambio de variables en la solución
de problemas de valores propios con diferencias fin">
<meta property="og:type" content="article">
<meta property="article:published_time" content="2018-05-17T15:57:00-05:00">
<meta property="article:tag" content="computación científica">
<meta property="article:tag" content="edp">
<meta property="article:tag" content="método de diferencias finitas">
<meta property="article:tag" content="python">
<link rel="alternate" hreflang="en" href="../../../posts/infinite_fdm/">
</head>
<body>
    <a href="#content" class="sr-only sr-only-focusable">Ir al contenido principal</a>
    <!-- Target for toggling the sidebar `.sidebar-checkbox` is for regular
            styles, `#sidebar-checkbox` for behavior. -->
    <input type="checkbox" class="sidebar-checkbox" id="sidebar-checkbox"><!-- Toggleable sidebar --><div class="sidebar" id="sidebar">
        <div class="sidebar-item">
            <p>This is my personal website and blog.</p>
        </div>
        
    <nav id="menu" role="navigation" class="sidebar-nav"><a class="sidebar-nav-item" href="../../../pages/about/">About</a>
        <a class="sidebar-nav-item" href="../../../index.html">Blog</a>
        <a class="sidebar-nav-item" href="../../../pages/preprints-archive/">Preprints</a>
        <a class="sidebar-nav-item" href="../../../pages/links/">Links</a>
        <a class="sidebar-nav-item" href="../../../archive.html">Archive</a>
        <a class="sidebar-nav-item" href="../../../categories/">Tags</a>
        <a class="sidebar-nav-item" href="../../../rss.xml">RSS feed</a>
    
    
    </nav>
</div>

    <!-- Wrap is the content to shift when toggling the sidebar. We wrap the
         content to avoid any CSS collisions with our real content. -->
    <div class="wrap">
      <div class="masthead">
        <div class="container">
          
    <h3 id="brand" class="masthead-title">
      <a href="https://nicoguaro.github.io/es/" title="Nicolás' blog" rel="home">Nicolás' blog</a>
    </h3>

        </div>
      </div>

      <div class="container content" id="content">
        
<article class="post-text h-entry hentry postpage" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="post-title p-name entry-title" itemprop="headline name"><a href="." class="u-url">Diferencias finitas en dominios infinitos</a></h1>

        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn">Nicolás Guarín-Zapata</span></p>
            <p class="dateline"><a href="." rel="bookmark"><time class="post-date published dt-published" datetime="2018-05-17T15:57:00-05:00" itemprop="datePublished" title="2018-05-17 15:57">2018-05-17 15:57</time></a></p>
                <p class="commentline">
    
    <a href="#disqus_thread" data-disqus-identifier="cache/posts/infinite_fdm.html">Comentarios</a>


        </p>
</div>
        
        <div class="metadata posttranslations translations">
            <h3 class="posttranslations-intro">También disponible en:</h3>
                <p><a href="../../../posts/infinite_fdm/" rel="alternate" hreflang="en">English</a></p>
        </div>

    </header><div class="e-content entry-content" itemprop="articleBody text">
    <section id="diferencias-finitas-en-dominios-infinitos"><h2>Diferencias finitas en dominios infinitos</h2>
<p>Gracias a mi amigo, <a class="reference external" href="http://cosmoscalibur.com/">Edward Villegas</a>,
terminé pensando acerca del uso de cambio de variables en la solución
de problemas de valores propios con diferencias finitas.</p>
<section id="el-problema"><h3>El problema</h3>
<p>Digamos que queremos resolver una ecuación diferencias sobre un dominio
infinito. Un caso común es la solución de la  <a class="reference external" href="https://en.wikipedia.org/wiki/Schr%C3%B6dinger_equation#Time-independent_equation">ecuación de Schrödinger
independiente del tiempo</a>
sujeta a un potencial <span class="math">\(V(x)\)</span>. Por ejemplo</p>
<div class="math">
\begin{equation*}
-\frac{1}{2}\frac{\mathrm{d}^2}{\mathrm{d}x^2}\psi(x) + V(x) \psi(x) = E\psi(x),\quad \forall x\in (-\infty, \infty),
\end{equation*}
</div>
<p>en donde queremos encontrar las parejas de valores/funciones propias
<span class="math">\((E_n, \psi_n(x))\)</span>.</p>
<p>Lo que normalmente hago cuando uso <a class="reference external" href="https://en.wikipedia.org/wiki/Finite_difference_method">diferencias
finitas</a>
es dividir el dominio regularmente. Donde tomo un dominio lo <em>suficientemente
grande</em>, para que la solución haya decaído a cero. Lo que hago en esta
publicación es usar un cambio de variable para convertir el intervalo
a uno finito y luego dividir el dominio transformado regularmente
en intervalos finitos.</p>
</section><section id="mi-enfoque-usual"><h3>Mi enfoque usual</h3>
<p>Mi enfoque usual es aproximar la segunda derivada con una <a class="reference external" href="https://en.wikipedia.org/wiki/Finite_difference_coefficient">diferencia
centrada</a>
para el punto <span class="math">\(x_i\)</span>, de la siguiente manera</p>
<div class="math">
\begin{equation*}
\frac{\mathrm{d}^2 f(x)}{\mathrm{d}x^2} \approx \frac{f(x + \Delta x) - 2 f(x_i) + f(x - \Delta x)}{\Delta x^2}\, ,
\end{equation*}
</div>
<p>con <span class="math">\(\Delta x\)</span> la separación entre puntos consecutivos.</p>
<p>Podemos solucionar este problem en Python con el siguiente bloque
de código:</p>
<div class="code"><pre class="code python"><a id="rest_code_aac8dd83ba704f67a5418046cb561258-1" name="rest_code_aac8dd83ba704f67a5418046cb561258-1" href="#rest_code_aac8dd83ba704f67a5418046cb561258-1"></a><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<a id="rest_code_aac8dd83ba704f67a5418046cb561258-2" name="rest_code_aac8dd83ba704f67a5418046cb561258-2" href="#rest_code_aac8dd83ba704f67a5418046cb561258-2"></a><span class="kn">from</span> <span class="nn">scipy.sparse</span> <span class="kn">import</span> <span class="n">diags</span>
<a id="rest_code_aac8dd83ba704f67a5418046cb561258-3" name="rest_code_aac8dd83ba704f67a5418046cb561258-3" href="#rest_code_aac8dd83ba704f67a5418046cb561258-3"></a><span class="kn">from</span> <span class="nn">scipy.sparse.linalg</span> <span class="kn">import</span> <span class="n">eigs</span>
<a id="rest_code_aac8dd83ba704f67a5418046cb561258-4" name="rest_code_aac8dd83ba704f67a5418046cb561258-4" href="#rest_code_aac8dd83ba704f67a5418046cb561258-4"></a>
<a id="rest_code_aac8dd83ba704f67a5418046cb561258-5" name="rest_code_aac8dd83ba704f67a5418046cb561258-5" href="#rest_code_aac8dd83ba704f67a5418046cb561258-5"></a>
<a id="rest_code_aac8dd83ba704f67a5418046cb561258-6" name="rest_code_aac8dd83ba704f67a5418046cb561258-6" href="#rest_code_aac8dd83ba704f67a5418046cb561258-6"></a><span class="k">def</span> <span class="nf">regular_FD</span><span class="p">(</span><span class="n">pot</span><span class="p">,</span> <span class="n">npts</span><span class="o">=</span><span class="mi">101</span><span class="p">,</span> <span class="n">x_max</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">nvals</span><span class="o">=</span><span class="mi">6</span><span class="p">):</span>
<a id="rest_code_aac8dd83ba704f67a5418046cb561258-7" name="rest_code_aac8dd83ba704f67a5418046cb561258-7" href="#rest_code_aac8dd83ba704f67a5418046cb561258-7"></a>    <span class="sd">"""</span>
<a id="rest_code_aac8dd83ba704f67a5418046cb561258-8" name="rest_code_aac8dd83ba704f67a5418046cb561258-8" href="#rest_code_aac8dd83ba704f67a5418046cb561258-8"></a><span class="sd">    Find eigenvalues/eigenfunctions for Schrodinger</span>
<a id="rest_code_aac8dd83ba704f67a5418046cb561258-9" name="rest_code_aac8dd83ba704f67a5418046cb561258-9" href="#rest_code_aac8dd83ba704f67a5418046cb561258-9"></a><span class="sd">    equation for the given potential `pot` using</span>
<a id="rest_code_aac8dd83ba704f67a5418046cb561258-10" name="rest_code_aac8dd83ba704f67a5418046cb561258-10" href="#rest_code_aac8dd83ba704f67a5418046cb561258-10"></a><span class="sd">    finite differences</span>
<a id="rest_code_aac8dd83ba704f67a5418046cb561258-11" name="rest_code_aac8dd83ba704f67a5418046cb561258-11" href="#rest_code_aac8dd83ba704f67a5418046cb561258-11"></a><span class="sd">    """</span>
<a id="rest_code_aac8dd83ba704f67a5418046cb561258-12" name="rest_code_aac8dd83ba704f67a5418046cb561258-12" href="#rest_code_aac8dd83ba704f67a5418046cb561258-12"></a>    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="n">x_max</span><span class="p">,</span> <span class="n">x_max</span><span class="p">,</span> <span class="n">npts</span><span class="p">)</span>
<a id="rest_code_aac8dd83ba704f67a5418046cb561258-13" name="rest_code_aac8dd83ba704f67a5418046cb561258-13" href="#rest_code_aac8dd83ba704f67a5418046cb561258-13"></a>    <span class="n">dx</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<a id="rest_code_aac8dd83ba704f67a5418046cb561258-14" name="rest_code_aac8dd83ba704f67a5418046cb561258-14" href="#rest_code_aac8dd83ba704f67a5418046cb561258-14"></a>    <span class="n">D2</span> <span class="o">=</span> <span class="n">diags</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="n">npts</span><span class="p">,</span> <span class="n">npts</span><span class="p">))</span><span class="o">/</span><span class="n">dx</span><span class="o">**</span><span class="mi">2</span>
<a id="rest_code_aac8dd83ba704f67a5418046cb561258-15" name="rest_code_aac8dd83ba704f67a5418046cb561258-15" href="#rest_code_aac8dd83ba704f67a5418046cb561258-15"></a>    <span class="n">V</span> <span class="o">=</span> <span class="n">diags</span><span class="p">(</span><span class="n">pot</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<a id="rest_code_aac8dd83ba704f67a5418046cb561258-16" name="rest_code_aac8dd83ba704f67a5418046cb561258-16" href="#rest_code_aac8dd83ba704f67a5418046cb561258-16"></a>    <span class="n">H</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.5</span><span class="o">*</span><span class="n">D2</span> <span class="o">+</span> <span class="n">V</span>
<a id="rest_code_aac8dd83ba704f67a5418046cb561258-17" name="rest_code_aac8dd83ba704f67a5418046cb561258-17" href="#rest_code_aac8dd83ba704f67a5418046cb561258-17"></a>    <span class="n">vals</span><span class="p">,</span> <span class="n">vecs</span> <span class="o">=</span> <span class="n">eigs</span><span class="p">(</span><span class="n">H</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="n">nvals</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s2">"SM"</span><span class="p">)</span>
<a id="rest_code_aac8dd83ba704f67a5418046cb561258-18" name="rest_code_aac8dd83ba704f67a5418046cb561258-18" href="#rest_code_aac8dd83ba704f67a5418046cb561258-18"></a>    <span class="k">return</span> <span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">vals</span><span class="p">),</span> <span class="n">vecs</span>
</pre></div>
<p>Configuremos los gráficos con el siguiente bloque de código.</p>
<div class="code"><pre class="code python"><a id="rest_code_ccd9bf8bff494790b408861333b94348-1" name="rest_code_ccd9bf8bff494790b408861333b94348-1" href="#rest_code_ccd9bf8bff494790b408861333b94348-1"></a><span class="c1"># Jupyter notebook plotting setup &amp; imports</span>
<a id="rest_code_ccd9bf8bff494790b408861333b94348-2" name="rest_code_ccd9bf8bff494790b408861333b94348-2" href="#rest_code_ccd9bf8bff494790b408861333b94348-2"></a><span class="o">%</span><span class="n">matplotlib</span> <span class="n">notebook</span>
<a id="rest_code_ccd9bf8bff494790b408861333b94348-3" name="rest_code_ccd9bf8bff494790b408861333b94348-3" href="#rest_code_ccd9bf8bff494790b408861333b94348-3"></a><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<a id="rest_code_ccd9bf8bff494790b408861333b94348-4" name="rest_code_ccd9bf8bff494790b408861333b94348-4" href="#rest_code_ccd9bf8bff494790b408861333b94348-4"></a>
<a id="rest_code_ccd9bf8bff494790b408861333b94348-5" name="rest_code_ccd9bf8bff494790b408861333b94348-5" href="#rest_code_ccd9bf8bff494790b408861333b94348-5"></a><span class="n">gray</span> <span class="o">=</span> <span class="s1">'#757575'</span>
<a id="rest_code_ccd9bf8bff494790b408861333b94348-6" name="rest_code_ccd9bf8bff494790b408861333b94348-6" href="#rest_code_ccd9bf8bff494790b408861333b94348-6"></a><span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s2">"figure.figsize"</span><span class="p">]</span> <span class="o">=</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">4</span>
<a id="rest_code_ccd9bf8bff494790b408861333b94348-7" name="rest_code_ccd9bf8bff494790b408861333b94348-7" href="#rest_code_ccd9bf8bff494790b408861333b94348-7"></a><span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s2">"mathtext.fontset"</span><span class="p">]</span> <span class="o">=</span> <span class="s2">"cm"</span>
<a id="rest_code_ccd9bf8bff494790b408861333b94348-8" name="rest_code_ccd9bf8bff494790b408861333b94348-8" href="#rest_code_ccd9bf8bff494790b408861333b94348-8"></a><span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s2">"text.color"</span><span class="p">]</span> <span class="o">=</span> <span class="n">gray</span>
<a id="rest_code_ccd9bf8bff494790b408861333b94348-9" name="rest_code_ccd9bf8bff494790b408861333b94348-9" href="#rest_code_ccd9bf8bff494790b408861333b94348-9"></a><span class="n">fontsize</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s2">"font.size"</span><span class="p">]</span> <span class="o">=</span> <span class="mi">12</span>
<a id="rest_code_ccd9bf8bff494790b408861333b94348-10" name="rest_code_ccd9bf8bff494790b408861333b94348-10" href="#rest_code_ccd9bf8bff494790b408861333b94348-10"></a><span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s2">"xtick.color"</span><span class="p">]</span> <span class="o">=</span> <span class="n">gray</span>
<a id="rest_code_ccd9bf8bff494790b408861333b94348-11" name="rest_code_ccd9bf8bff494790b408861333b94348-11" href="#rest_code_ccd9bf8bff494790b408861333b94348-11"></a><span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s2">"ytick.color"</span><span class="p">]</span> <span class="o">=</span> <span class="n">gray</span>
<a id="rest_code_ccd9bf8bff494790b408861333b94348-12" name="rest_code_ccd9bf8bff494790b408861333b94348-12" href="#rest_code_ccd9bf8bff494790b408861333b94348-12"></a><span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s2">"axes.labelcolor"</span><span class="p">]</span> <span class="o">=</span> <span class="n">gray</span>
<a id="rest_code_ccd9bf8bff494790b408861333b94348-13" name="rest_code_ccd9bf8bff494790b408861333b94348-13" href="#rest_code_ccd9bf8bff494790b408861333b94348-13"></a><span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s2">"axes.edgecolor"</span><span class="p">]</span> <span class="o">=</span> <span class="n">gray</span>
<a id="rest_code_ccd9bf8bff494790b408861333b94348-14" name="rest_code_ccd9bf8bff494790b408861333b94348-14" href="#rest_code_ccd9bf8bff494790b408861333b94348-14"></a><span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s2">"axes.spines.right"</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
<a id="rest_code_ccd9bf8bff494790b408861333b94348-15" name="rest_code_ccd9bf8bff494790b408861333b94348-15" href="#rest_code_ccd9bf8bff494790b408861333b94348-15"></a><span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s2">"axes.spines.top"</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
</pre></div>
<p>Consideremos el <a class="reference external" href="https://en.wikipedia.org/wiki/Quantum_harmonic_oscillator">oscilador armónico
cuántico</a>,
que tiene como valores propios</p>
<div class="math">
\begin{equation*}
E_n = n + \frac{1}{2},\quad \forall n = 0, 1, 2 \cdots
\end{equation*}
</div>
<p>Usando el método de diferencias finitas obtenemos valores que están
muy cerca de los analíticos.</p>
<div class="code"><pre class="code python"><a id="rest_code_d5386c9254f04c63b48a7483caa7a764-1" name="rest_code_d5386c9254f04c63b48a7483caa7a764-1" href="#rest_code_d5386c9254f04c63b48a7483caa7a764-1"></a><span class="n">x</span><span class="p">,</span> <span class="n">vals</span><span class="p">,</span> <span class="n">vecs</span> <span class="o">=</span> <span class="n">regular_FD</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="n">npts</span><span class="o">=</span><span class="mi">201</span><span class="p">)</span>
<a id="rest_code_d5386c9254f04c63b48a7483caa7a764-2" name="rest_code_d5386c9254f04c63b48a7483caa7a764-2" href="#rest_code_d5386c9254f04c63b48a7483caa7a764-2"></a><span class="n">vals</span>
</pre></div>
<p>Con respuesta</p>
<div class="code"><pre class="code python"><a id="rest_code_ea0fc7c0ed3c4bc68296996a871b14bf-1" name="rest_code_ea0fc7c0ed3c4bc68296996a871b14bf-1" href="#rest_code_ea0fc7c0ed3c4bc68296996a871b14bf-1"></a><span class="n">array</span><span class="p">([</span><span class="mf">0.4996873</span> <span class="p">,</span> <span class="mf">1.49843574</span><span class="p">,</span> <span class="mf">2.49593063</span><span class="p">,</span> <span class="mf">3.49216962</span><span class="p">,</span> <span class="mf">4.48715031</span><span class="p">,</span>
<a id="rest_code_ea0fc7c0ed3c4bc68296996a871b14bf-2" name="rest_code_ea0fc7c0ed3c4bc68296996a871b14bf-2" href="#rest_code_ea0fc7c0ed3c4bc68296996a871b14bf-2"></a>       <span class="mf">5.4808703</span> <span class="p">])</span>
</pre></div>
<p>Los valores analíticos son los siguientes</p>
<div class="code"><pre class="code text"><a id="rest_code_971517896a90466c81d5373757a8b431-1" name="rest_code_971517896a90466c81d5373757a8b431-1" href="#rest_code_971517896a90466c81d5373757a8b431-1"></a>[0.5, 1.5, 2.5, 3.5, 4.5, 5.5])
</pre></div>
<p>Si graficamos estos dos conjuntos, obtenemos lo siguiente.</p>
<div class="code"><pre class="code python"><a id="rest_code_1d91da71629a4af7bd6d9e1e33abe89a-1" name="rest_code_1d91da71629a4af7bd6d9e1e33abe89a-1" href="#rest_code_1d91da71629a4af7bd6d9e1e33abe89a-1"></a><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<a id="rest_code_1d91da71629a4af7bd6d9e1e33abe89a-2" name="rest_code_1d91da71629a4af7bd6d9e1e33abe89a-2" href="#rest_code_1d91da71629a4af7bd6d9e1e33abe89a-2"></a><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">anal_vals</span><span class="p">)</span>
<a id="rest_code_1d91da71629a4af7bd6d9e1e33abe89a-3" name="rest_code_1d91da71629a4af7bd6d9e1e33abe89a-3" href="#rest_code_1d91da71629a4af7bd6d9e1e33abe89a-3"></a><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">vals</span><span class="p">,</span> <span class="s2">"o"</span><span class="p">)</span>
<a id="rest_code_1d91da71629a4af7bd6d9e1e33abe89a-4" name="rest_code_1d91da71629a4af7bd6d9e1e33abe89a-4" href="#rest_code_1d91da71629a4af7bd6d9e1e33abe89a-4"></a><span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">"$n$"</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<a id="rest_code_1d91da71629a4af7bd6d9e1e33abe89a-5" name="rest_code_1d91da71629a4af7bd6d9e1e33abe89a-5" href="#rest_code_1d91da71629a4af7bd6d9e1e33abe89a-5"></a><span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">"$E_n$"</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<a id="rest_code_1d91da71629a4af7bd6d9e1e33abe89a-6" name="rest_code_1d91da71629a4af7bd6d9e1e33abe89a-6" href="#rest_code_1d91da71629a4af7bd6d9e1e33abe89a-6"></a><span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s2">"Analytic"</span><span class="p">,</span> <span class="s2">"Finite differences"</span><span class="p">])</span>
<a id="rest_code_1d91da71629a4af7bd6d9e1e33abe89a-7" name="rest_code_1d91da71629a4af7bd6d9e1e33abe89a-7" href="#rest_code_1d91da71629a4af7bd6d9e1e33abe89a-7"></a><span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">();</span>
</pre></div>
<img alt="Valores propios para la diferencia finita regular." class="align-center" src="../../../images/infinite_fdm/eigvals_regular.svg" style="width: 600px;"><p>Veamos las funciones propias</p>
<div class="code"><pre class="code python"><a id="rest_code_8eebabf384b54a8eb1b7462388ba70c7-1" name="rest_code_8eebabf384b54a8eb1b7462388ba70c7-1" href="#rest_code_8eebabf384b54a8eb1b7462388ba70c7-1"></a><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<a id="rest_code_8eebabf384b54a8eb1b7462388ba70c7-2" name="rest_code_8eebabf384b54a8eb1b7462388ba70c7-2" href="#rest_code_8eebabf384b54a8eb1b7462388ba70c7-2"></a><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">vecs</span><span class="p">[:,</span> <span class="p">:</span><span class="mi">3</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<a id="rest_code_8eebabf384b54a8eb1b7462388ba70c7-3" name="rest_code_8eebabf384b54a8eb1b7462388ba70c7-3" href="#rest_code_8eebabf384b54a8eb1b7462388ba70c7-3"></a><span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
<a id="rest_code_8eebabf384b54a8eb1b7462388ba70c7-4" name="rest_code_8eebabf384b54a8eb1b7462388ba70c7-4" href="#rest_code_8eebabf384b54a8eb1b7462388ba70c7-4"></a><span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">"$x$"</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<a id="rest_code_8eebabf384b54a8eb1b7462388ba70c7-5" name="rest_code_8eebabf384b54a8eb1b7462388ba70c7-5" href="#rest_code_8eebabf384b54a8eb1b7462388ba70c7-5"></a><span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">"$|\psi_n(x)|^2$"</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<a id="rest_code_8eebabf384b54a8eb1b7462388ba70c7-6" name="rest_code_8eebabf384b54a8eb1b7462388ba70c7-6" href="#rest_code_8eebabf384b54a8eb1b7462388ba70c7-6"></a><span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">([])</span>
<a id="rest_code_8eebabf384b54a8eb1b7462388ba70c7-7" name="rest_code_8eebabf384b54a8eb1b7462388ba70c7-7" href="#rest_code_8eebabf384b54a8eb1b7462388ba70c7-7"></a><span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">();</span>
</pre></div>
<img alt="Funciones propias para la diferencia finita regular." class="align-center" src="../../../images/infinite_fdm/eigvecs_regular.svg" style="width: 600px;"><p>Un inconveniente con este método es el muestreo redundante hacia los extremos
del intervalo mientras submuestreamos el centro.</p>
</section><section id="transformando-el-dominio"><h3>Transformando el dominio</h3>
<p>Ahora, consideremos el caso en el que transormamos el dominio infinito a uno
finito usando un cambio de variable</p>
<div class="math">
\begin{equation*}
\xi = \xi(x)
\end{equation*}
</div>
<p>con <span class="math">\(\xi \in (-1, 1)\)</span>. Dos opciones para esta transformación son:</p>
<ul class="simple">
<li><p><span class="math">\(\xi = \tanh x\)</span>; y</p></li>
<li><p><span class="math">\(\xi = \frac{2}{\pi} \arctan x\)</span>.</p></li>
</ul>
<p>Haciendo este cambio de variable la ecuación, debemos resolver
la siguiente ecuación</p>
<div class="math">
\begin{equation*}
-\frac{1}{2}\left(\frac{\mathrm{d}\xi}{\mathrm{d}x}\right)^2\frac{\mathrm{d}^2}{\mathrm{d}\xi^2}\psi(\xi) - \frac{1}{2}\frac{\mathrm{d}^2\xi}{\mathrm{d}x^2}\frac{\mathrm{d}}{\mathrm{d}\xi}\psi(\xi) + V(\xi) \psi(\xi) = E\psi(\xi)
\end{equation*}
</div>
<p>El siguiente bloque de código resuelve el problema de valores propios
en el dominio transformado:</p>
<div class="code"><pre class="code python"><a id="rest_code_380fecfd75f9447484ff5574d4301676-1" name="rest_code_380fecfd75f9447484ff5574d4301676-1" href="#rest_code_380fecfd75f9447484ff5574d4301676-1"></a><span class="k">def</span> <span class="nf">mapped_FD</span><span class="p">(</span><span class="n">pot</span><span class="p">,</span> <span class="n">fun</span><span class="p">,</span> <span class="n">dxdxi</span><span class="p">,</span> <span class="n">dxdxi2</span><span class="p">,</span> <span class="n">npts</span><span class="o">=</span><span class="mi">101</span><span class="p">,</span> <span class="n">nvals</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">xi_tol</span><span class="o">=</span><span class="mf">1e-6</span><span class="p">):</span>
<a id="rest_code_380fecfd75f9447484ff5574d4301676-2" name="rest_code_380fecfd75f9447484ff5574d4301676-2" href="#rest_code_380fecfd75f9447484ff5574d4301676-2"></a>    <span class="sd">"""</span>
<a id="rest_code_380fecfd75f9447484ff5574d4301676-3" name="rest_code_380fecfd75f9447484ff5574d4301676-3" href="#rest_code_380fecfd75f9447484ff5574d4301676-3"></a><span class="sd">    Find eigenvalues/eigenfunctions for Schrodinger</span>
<a id="rest_code_380fecfd75f9447484ff5574d4301676-4" name="rest_code_380fecfd75f9447484ff5574d4301676-4" href="#rest_code_380fecfd75f9447484ff5574d4301676-4"></a><span class="sd">    equation for the given potential `pot` using</span>
<a id="rest_code_380fecfd75f9447484ff5574d4301676-5" name="rest_code_380fecfd75f9447484ff5574d4301676-5" href="#rest_code_380fecfd75f9447484ff5574d4301676-5"></a><span class="sd">    finite differences over a mapped domain on (-1, 1)</span>
<a id="rest_code_380fecfd75f9447484ff5574d4301676-6" name="rest_code_380fecfd75f9447484ff5574d4301676-6" href="#rest_code_380fecfd75f9447484ff5574d4301676-6"></a><span class="sd">    """</span>
<a id="rest_code_380fecfd75f9447484ff5574d4301676-7" name="rest_code_380fecfd75f9447484ff5574d4301676-7" href="#rest_code_380fecfd75f9447484ff5574d4301676-7"></a>    <span class="n">xi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span> <span class="o">+</span> <span class="n">xi_tol</span><span class="p">,</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">xi_tol</span><span class="p">,</span> <span class="n">npts</span><span class="p">)</span>
<a id="rest_code_380fecfd75f9447484ff5574d4301676-8" name="rest_code_380fecfd75f9447484ff5574d4301676-8" href="#rest_code_380fecfd75f9447484ff5574d4301676-8"></a>    <span class="n">x</span> <span class="o">=</span> <span class="n">fun</span><span class="p">(</span><span class="n">xi</span><span class="p">)</span>
<a id="rest_code_380fecfd75f9447484ff5574d4301676-9" name="rest_code_380fecfd75f9447484ff5574d4301676-9" href="#rest_code_380fecfd75f9447484ff5574d4301676-9"></a>    <span class="n">dxi</span> <span class="o">=</span> <span class="n">xi</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">xi</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<a id="rest_code_380fecfd75f9447484ff5574d4301676-10" name="rest_code_380fecfd75f9447484ff5574d4301676-10" href="#rest_code_380fecfd75f9447484ff5574d4301676-10"></a>    <span class="n">D2</span> <span class="o">=</span> <span class="n">diags</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="n">npts</span><span class="p">,</span> <span class="n">npts</span><span class="p">))</span><span class="o">/</span><span class="n">dxi</span><span class="o">**</span><span class="mi">2</span>
<a id="rest_code_380fecfd75f9447484ff5574d4301676-11" name="rest_code_380fecfd75f9447484ff5574d4301676-11" href="#rest_code_380fecfd75f9447484ff5574d4301676-11"></a>    <span class="n">D1</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">diags</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="n">npts</span><span class="p">,</span> <span class="n">npts</span><span class="p">))</span><span class="o">/</span><span class="n">dxi</span>
<a id="rest_code_380fecfd75f9447484ff5574d4301676-12" name="rest_code_380fecfd75f9447484ff5574d4301676-12" href="#rest_code_380fecfd75f9447484ff5574d4301676-12"></a>    <span class="n">V</span> <span class="o">=</span> <span class="n">diags</span><span class="p">(</span><span class="n">pot</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<a id="rest_code_380fecfd75f9447484ff5574d4301676-13" name="rest_code_380fecfd75f9447484ff5574d4301676-13" href="#rest_code_380fecfd75f9447484ff5574d4301676-13"></a>    <span class="n">fac1</span> <span class="o">=</span> <span class="n">diags</span><span class="p">(</span><span class="n">dxdxi</span><span class="p">(</span><span class="n">xi</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<a id="rest_code_380fecfd75f9447484ff5574d4301676-14" name="rest_code_380fecfd75f9447484ff5574d4301676-14" href="#rest_code_380fecfd75f9447484ff5574d4301676-14"></a>    <span class="n">fac2</span> <span class="o">=</span> <span class="n">diags</span><span class="p">(</span><span class="n">dxdxi2</span><span class="p">(</span><span class="n">xi</span><span class="p">))</span>
<a id="rest_code_380fecfd75f9447484ff5574d4301676-15" name="rest_code_380fecfd75f9447484ff5574d4301676-15" href="#rest_code_380fecfd75f9447484ff5574d4301676-15"></a>    <span class="n">H</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.5</span><span class="o">*</span><span class="n">fac1</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">D2</span><span class="p">)</span> <span class="o">-</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">fac2</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">D1</span><span class="p">)</span> <span class="o">+</span> <span class="n">V</span>
<a id="rest_code_380fecfd75f9447484ff5574d4301676-16" name="rest_code_380fecfd75f9447484ff5574d4301676-16" href="#rest_code_380fecfd75f9447484ff5574d4301676-16"></a>    <span class="n">vals</span><span class="p">,</span> <span class="n">vecs</span> <span class="o">=</span> <span class="n">eigs</span><span class="p">(</span><span class="n">H</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="n">nvals</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s2">"SM"</span><span class="p">)</span>
<a id="rest_code_380fecfd75f9447484ff5574d4301676-17" name="rest_code_380fecfd75f9447484ff5574d4301676-17" href="#rest_code_380fecfd75f9447484ff5574d4301676-17"></a>    <span class="k">return</span> <span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">vals</span><span class="p">),</span> <span class="n">vecs</span>
</pre></div>
<section id="primera-transformacion-xi-tanh-x"><h4>Primera transformación: <span class="math">\(\xi = \tanh(x)\)</span>
</h4>
<p>Consideremos la primera transformación</p>
<div class="math">
\begin{equation*}
\xi = \tanh(x)\, .
\end{equation*}
</div>
<p>En este caso,</p>
<div class="math">
\begin{equation*}
\frac{\mathrm{d}\xi}{\mathrm{d}x} = 1 - \tanh^2(x) = 1 - \xi^2\, ,
\end{equation*}
</div>
<p>y</p>
<div class="math">
\begin{equation*}
\frac{\mathrm{d}^2\xi}{\mathrm{d}x^2} = -2\tanh(x)[1 - \tanh^2(x)] = -2\xi[1 - \xi^2]\, .
\end{equation*}
</div>
<p>Necesitamos definir las funciones</p>
<div class="code"><pre class="code python"><a id="rest_code_79a0afe6c9b7429daad6822958dec8e6-1" name="rest_code_79a0afe6c9b7429daad6822958dec8e6-1" href="#rest_code_79a0afe6c9b7429daad6822958dec8e6-1"></a><span class="n">pot</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span>
<a id="rest_code_79a0afe6c9b7429daad6822958dec8e6-2" name="rest_code_79a0afe6c9b7429daad6822958dec8e6-2" href="#rest_code_79a0afe6c9b7429daad6822958dec8e6-2"></a><span class="n">fun</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">xi</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">arctanh</span><span class="p">(</span><span class="n">xi</span><span class="p">)</span>
<a id="rest_code_79a0afe6c9b7429daad6822958dec8e6-3" name="rest_code_79a0afe6c9b7429daad6822958dec8e6-3" href="#rest_code_79a0afe6c9b7429daad6822958dec8e6-3"></a><span class="n">dxdxi</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">xi</span><span class="p">:</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">xi</span><span class="o">**</span><span class="mi">2</span>
<a id="rest_code_79a0afe6c9b7429daad6822958dec8e6-4" name="rest_code_79a0afe6c9b7429daad6822958dec8e6-4" href="#rest_code_79a0afe6c9b7429daad6822958dec8e6-4"></a><span class="n">dxdxi2</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">xi</span><span class="p">:</span> <span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">xi</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">xi</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
<p>y correr</p>
<div class="code"><pre class="code python"><a id="rest_code_d96f3d61f1ec46bca79034e0f0325d59-1" name="rest_code_d96f3d61f1ec46bca79034e0f0325d59-1" href="#rest_code_d96f3d61f1ec46bca79034e0f0325d59-1"></a><span class="n">x</span><span class="p">,</span> <span class="n">vals</span><span class="p">,</span> <span class="n">vecs</span> <span class="o">=</span> <span class="n">mapped_FD</span><span class="p">(</span><span class="n">pot</span><span class="p">,</span> <span class="n">fun</span><span class="p">,</span> <span class="n">dxdxi</span><span class="p">,</span> <span class="n">dxdxi2</span><span class="p">,</span> <span class="n">npts</span><span class="o">=</span><span class="mi">201</span><span class="p">)</span>
<a id="rest_code_d96f3d61f1ec46bca79034e0f0325d59-2" name="rest_code_d96f3d61f1ec46bca79034e0f0325d59-2" href="#rest_code_d96f3d61f1ec46bca79034e0f0325d59-2"></a><span class="n">vals</span>
</pre></div>
<p>Y obtenemos los siguientes valores propios</p>
<div class="code"><pre class="code python"><a id="rest_code_a75f641a983043e48cf3e440673a0526-1" name="rest_code_a75f641a983043e48cf3e440673a0526-1" href="#rest_code_a75f641a983043e48cf3e440673a0526-1"></a><span class="n">array</span><span class="p">([</span><span class="mf">0.49989989</span><span class="p">,</span> <span class="mf">1.4984226</span> <span class="p">,</span> <span class="mf">2.49003572</span><span class="p">,</span> <span class="mf">3.46934257</span><span class="p">,</span> <span class="mf">4.46935021</span><span class="p">,</span>
<a id="rest_code_a75f641a983043e48cf3e440673a0526-2" name="rest_code_a75f641a983043e48cf3e440673a0526-2" href="#rest_code_a75f641a983043e48cf3e440673a0526-2"></a>       <span class="mf">5.59552989</span><span class="p">])</span>
</pre></div>
<p>Si los comparamos con los valores analítivos obtenemos lo siguiente.</p>
<div class="code"><pre class="code python"><a id="rest_code_96409b66d9734394a0f3da680e0cda34-1" name="rest_code_96409b66d9734394a0f3da680e0cda34-1" href="#rest_code_96409b66d9734394a0f3da680e0cda34-1"></a><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<a id="rest_code_96409b66d9734394a0f3da680e0cda34-2" name="rest_code_96409b66d9734394a0f3da680e0cda34-2" href="#rest_code_96409b66d9734394a0f3da680e0cda34-2"></a><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">anal_vals</span><span class="p">)</span>
<a id="rest_code_96409b66d9734394a0f3da680e0cda34-3" name="rest_code_96409b66d9734394a0f3da680e0cda34-3" href="#rest_code_96409b66d9734394a0f3da680e0cda34-3"></a><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">vals</span><span class="p">,</span> <span class="s2">"o"</span><span class="p">)</span>
<a id="rest_code_96409b66d9734394a0f3da680e0cda34-4" name="rest_code_96409b66d9734394a0f3da680e0cda34-4" href="#rest_code_96409b66d9734394a0f3da680e0cda34-4"></a><span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s2">"Analytic"</span><span class="p">,</span> <span class="s2">"Finite differences"</span><span class="p">])</span>
<a id="rest_code_96409b66d9734394a0f3da680e0cda34-5" name="rest_code_96409b66d9734394a0f3da680e0cda34-5" href="#rest_code_96409b66d9734394a0f3da680e0cda34-5"></a><span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">"$n$"</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<a id="rest_code_96409b66d9734394a0f3da680e0cda34-6" name="rest_code_96409b66d9734394a0f3da680e0cda34-6" href="#rest_code_96409b66d9734394a0f3da680e0cda34-6"></a><span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">"$E_n$"</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<a id="rest_code_96409b66d9734394a0f3da680e0cda34-7" name="rest_code_96409b66d9734394a0f3da680e0cda34-7" href="#rest_code_96409b66d9734394a0f3da680e0cda34-7"></a><span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">();</span>
</pre></div>
<img alt="Valores propios para la primera transormación." class="align-center" src="../../../images/infinite_fdm/eigvals_tanh.svg" style="width: 600px;"><p>Y las siguientes funciones propias.</p>
<div class="code"><pre class="code python"><a id="rest_code_00b4a28a6bdc40e0b1856c768f9b508f-1" name="rest_code_00b4a28a6bdc40e0b1856c768f9b508f-1" href="#rest_code_00b4a28a6bdc40e0b1856c768f9b508f-1"></a><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<a id="rest_code_00b4a28a6bdc40e0b1856c768f9b508f-2" name="rest_code_00b4a28a6bdc40e0b1856c768f9b508f-2" href="#rest_code_00b4a28a6bdc40e0b1856c768f9b508f-2"></a><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">vecs</span><span class="p">[:,</span> <span class="p">:</span><span class="mi">3</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<a id="rest_code_00b4a28a6bdc40e0b1856c768f9b508f-3" name="rest_code_00b4a28a6bdc40e0b1856c768f9b508f-3" href="#rest_code_00b4a28a6bdc40e0b1856c768f9b508f-3"></a><span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
<a id="rest_code_00b4a28a6bdc40e0b1856c768f9b508f-4" name="rest_code_00b4a28a6bdc40e0b1856c768f9b508f-4" href="#rest_code_00b4a28a6bdc40e0b1856c768f9b508f-4"></a><span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">"$x$"</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<a id="rest_code_00b4a28a6bdc40e0b1856c768f9b508f-5" name="rest_code_00b4a28a6bdc40e0b1856c768f9b508f-5" href="#rest_code_00b4a28a6bdc40e0b1856c768f9b508f-5"></a><span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">"$|\psi_n(x)|^2$"</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<a id="rest_code_00b4a28a6bdc40e0b1856c768f9b508f-6" name="rest_code_00b4a28a6bdc40e0b1856c768f9b508f-6" href="#rest_code_00b4a28a6bdc40e0b1856c768f9b508f-6"></a><span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">([])</span>
<a id="rest_code_00b4a28a6bdc40e0b1856c768f9b508f-7" name="rest_code_00b4a28a6bdc40e0b1856c768f9b508f-7" href="#rest_code_00b4a28a6bdc40e0b1856c768f9b508f-7"></a><span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">();</span>
</pre></div>
<img alt="Funciones propias para la primera transformación." class="align-center" src="../../../images/infinite_fdm/eigvecs_tanh.svg" style="width: 600px;"></section><section id="segunda-transformacion-xi-frac-2-pi-mathrm-atan-x"><h4>Segunda transformación: <span class="math">\(\xi = \frac{2}{\pi}\mathrm{atan}(x)\)</span>
</h4>
<p>Consideremos ahora la segunda transformación</p>
<div class="math">
\begin{equation*}
\xi = \frac{2}{\pi}\mathrm{atan}(x)\, .
\end{equation*}
</div>
<p>En este caso,</p>
<div class="math">
\begin{equation*}
\frac{\mathrm{d}\xi}{\mathrm{d}x} = \frac{2}{\pi(1 + x^2)} = \frac{2 \cos^2\xi}{\pi} \, ,
\end{equation*}
</div>
<p>y</p>
<div class="math">
\begin{equation*}
\frac{\mathrm{d}^2\xi}{\mathrm{d}x^2} = -\frac{4x}{\pi(1 + x^2)^2} = -\frac{4 \cos^4\xi \tan \xi}{\pi}\, .
\end{equation*}
</div>
<p>Una vez más, definimos las funciones</p>
<div class="code"><pre class="code python"><a id="rest_code_99b92f232fe244d3bfb1d42ce097385c-1" name="rest_code_99b92f232fe244d3bfb1d42ce097385c-1" href="#rest_code_99b92f232fe244d3bfb1d42ce097385c-1"></a><span class="n">pot</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span>
<a id="rest_code_99b92f232fe244d3bfb1d42ce097385c-2" name="rest_code_99b92f232fe244d3bfb1d42ce097385c-2" href="#rest_code_99b92f232fe244d3bfb1d42ce097385c-2"></a><span class="n">fun</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">xi</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">tan</span><span class="p">(</span><span class="mf">0.5</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">xi</span><span class="p">)</span>
<a id="rest_code_99b92f232fe244d3bfb1d42ce097385c-3" name="rest_code_99b92f232fe244d3bfb1d42ce097385c-3" href="#rest_code_99b92f232fe244d3bfb1d42ce097385c-3"></a><span class="n">dxdxi</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">xi</span><span class="p">:</span> <span class="mi">2</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mf">0.5</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">xi</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>
<a id="rest_code_99b92f232fe244d3bfb1d42ce097385c-4" name="rest_code_99b92f232fe244d3bfb1d42ce097385c-4" href="#rest_code_99b92f232fe244d3bfb1d42ce097385c-4"></a><span class="n">dxdxi2</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">xi</span><span class="p">:</span> <span class="o">-</span><span class="mi">4</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mf">0.5</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">xi</span><span class="p">)</span><span class="o">**</span><span class="mi">4</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">tan</span><span class="p">(</span><span class="mf">0.5</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">xi</span><span class="p">)</span>
</pre></div>
<p>y ejecutamos</p>
<div class="code"><pre class="code python"><a id="rest_code_c8ab46a146c54f1095260dcadb245b4a-1" name="rest_code_c8ab46a146c54f1095260dcadb245b4a-1" href="#rest_code_c8ab46a146c54f1095260dcadb245b4a-1"></a><span class="n">x</span><span class="p">,</span> <span class="n">vals</span><span class="p">,</span> <span class="n">vecs</span> <span class="o">=</span> <span class="n">mapped_FD</span><span class="p">(</span><span class="n">pot</span><span class="p">,</span> <span class="n">fun</span><span class="p">,</span> <span class="n">dxdxi</span><span class="p">,</span> <span class="n">dxdxi2</span><span class="p">,</span> <span class="n">npts</span><span class="o">=</span><span class="mi">201</span><span class="p">)</span>
<a id="rest_code_c8ab46a146c54f1095260dcadb245b4a-2" name="rest_code_c8ab46a146c54f1095260dcadb245b4a-2" href="#rest_code_c8ab46a146c54f1095260dcadb245b4a-2"></a><span class="n">vals</span>
</pre></div>
<p>para obtener los siguientes valores propios</p>
<div class="code"><pre class="code python"><a id="rest_code_ab19e5adba6e4b518e2e4e1de3452dfb-1" name="rest_code_ab19e5adba6e4b518e2e4e1de3452dfb-1" href="#rest_code_ab19e5adba6e4b518e2e4e1de3452dfb-1"></a><span class="n">array</span><span class="p">([</span><span class="mf">0.49997815</span><span class="p">,</span> <span class="mf">1.49979632</span><span class="p">,</span> <span class="mf">2.49930872</span><span class="p">,</span> <span class="mf">3.49824697</span><span class="p">,</span> <span class="mf">4.49627555</span><span class="p">,</span>
<a id="rest_code_ab19e5adba6e4b518e2e4e1de3452dfb-2" name="rest_code_ab19e5adba6e4b518e2e4e1de3452dfb-2" href="#rest_code_ab19e5adba6e4b518e2e4e1de3452dfb-2"></a>       <span class="mf">5.49295665</span><span class="p">])</span>
</pre></div>
<p>con la siguiente gráfica</p>
<div class="code"><pre class="code python"><a id="rest_code_0fa675610d784ec8b4f9d62bc4b9ec2f-1" name="rest_code_0fa675610d784ec8b4f9d62bc4b9ec2f-1" href="#rest_code_0fa675610d784ec8b4f9d62bc4b9ec2f-1"></a><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<a id="rest_code_0fa675610d784ec8b4f9d62bc4b9ec2f-2" name="rest_code_0fa675610d784ec8b4f9d62bc4b9ec2f-2" href="#rest_code_0fa675610d784ec8b4f9d62bc4b9ec2f-2"></a><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">anal_vals</span><span class="p">)</span>
<a id="rest_code_0fa675610d784ec8b4f9d62bc4b9ec2f-3" name="rest_code_0fa675610d784ec8b4f9d62bc4b9ec2f-3" href="#rest_code_0fa675610d784ec8b4f9d62bc4b9ec2f-3"></a><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">vals</span><span class="p">,</span> <span class="s2">"o"</span><span class="p">)</span>
<a id="rest_code_0fa675610d784ec8b4f9d62bc4b9ec2f-4" name="rest_code_0fa675610d784ec8b4f9d62bc4b9ec2f-4" href="#rest_code_0fa675610d784ec8b4f9d62bc4b9ec2f-4"></a><span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s2">"Analytic"</span><span class="p">,</span> <span class="s2">"Finite differences"</span><span class="p">])</span>
<a id="rest_code_0fa675610d784ec8b4f9d62bc4b9ec2f-5" name="rest_code_0fa675610d784ec8b4f9d62bc4b9ec2f-5" href="#rest_code_0fa675610d784ec8b4f9d62bc4b9ec2f-5"></a><span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">"$n$"</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<a id="rest_code_0fa675610d784ec8b4f9d62bc4b9ec2f-6" name="rest_code_0fa675610d784ec8b4f9d62bc4b9ec2f-6" href="#rest_code_0fa675610d784ec8b4f9d62bc4b9ec2f-6"></a><span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">"$E_n$"</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<a id="rest_code_0fa675610d784ec8b4f9d62bc4b9ec2f-7" name="rest_code_0fa675610d784ec8b4f9d62bc4b9ec2f-7" href="#rest_code_0fa675610d784ec8b4f9d62bc4b9ec2f-7"></a><span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">();</span>
</pre></div>
<img alt="Valores propios para la segunda transformación." class="align-center" src="../../../images/infinite_fdm/eigvals_atan.svg" style="width: 600px;"><p>y las siguientes funciones propias.</p>
<div class="code"><pre class="code python"><a id="rest_code_19ffb234de5542e58be594fcad20177f-1" name="rest_code_19ffb234de5542e58be594fcad20177f-1" href="#rest_code_19ffb234de5542e58be594fcad20177f-1"></a><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<a id="rest_code_19ffb234de5542e58be594fcad20177f-2" name="rest_code_19ffb234de5542e58be594fcad20177f-2" href="#rest_code_19ffb234de5542e58be594fcad20177f-2"></a><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">vecs</span><span class="p">[:,</span> <span class="p">:</span><span class="mi">3</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<a id="rest_code_19ffb234de5542e58be594fcad20177f-3" name="rest_code_19ffb234de5542e58be594fcad20177f-3" href="#rest_code_19ffb234de5542e58be594fcad20177f-3"></a><span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">"$x$"</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<a id="rest_code_19ffb234de5542e58be594fcad20177f-4" name="rest_code_19ffb234de5542e58be594fcad20177f-4" href="#rest_code_19ffb234de5542e58be594fcad20177f-4"></a><span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">"$|\psi|^2$"</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<a id="rest_code_19ffb234de5542e58be594fcad20177f-5" name="rest_code_19ffb234de5542e58be594fcad20177f-5" href="#rest_code_19ffb234de5542e58be594fcad20177f-5"></a><span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
<a id="rest_code_19ffb234de5542e58be594fcad20177f-6" name="rest_code_19ffb234de5542e58be594fcad20177f-6" href="#rest_code_19ffb234de5542e58be594fcad20177f-6"></a><span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">"$x$"</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<a id="rest_code_19ffb234de5542e58be594fcad20177f-7" name="rest_code_19ffb234de5542e58be594fcad20177f-7" href="#rest_code_19ffb234de5542e58be594fcad20177f-7"></a><span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">"$|\psi_n(x)|^2$"</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<a id="rest_code_19ffb234de5542e58be594fcad20177f-8" name="rest_code_19ffb234de5542e58be594fcad20177f-8" href="#rest_code_19ffb234de5542e58be594fcad20177f-8"></a><span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">([])</span>
<a id="rest_code_19ffb234de5542e58be594fcad20177f-9" name="rest_code_19ffb234de5542e58be594fcad20177f-9" href="#rest_code_19ffb234de5542e58be594fcad20177f-9"></a><span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">();</span>
</pre></div>
<img alt="Funciones propias para la segunda transformación." class="align-center" src="../../../images/infinite_fdm/eigvecs_atan.svg" style="width: 600px;"></section></section><section id="conclusion"><h3>Conclusión</h3>
<p>El método funciona bien, aunque la ecuación diferencial es más
complicada por el cambio de variable. Aunque existen métodos más
elegantes para considerar dominiso infinitos, este es lo suficientemente
simple para hacerse en 10 líneas de código.</p>
<p>Podemos ver que la transforamción <span class="math">\(\xi = \mathrm{atan}(x)\)</span>, cubre
mejor el dominio que <span class="math">\(\xi = \tanh(x)\)</span>, donde la mayoría de los puntos
están ubicados en el centro del intervalo.</p>
<p>¡Gracias por leer!</p>
<small>
  <i>
    Esta publicación se escribió en el Jupyter notebook. Puedes
    <a href="../../downloads/notebooks/finite_diff_map.ipynb">descargar</a>
    este notebook, o ver una versión estática en
    <a href="http://nbviewer.jupyter.org/url/nicoguaro.github.io/downloads/notebooks/finite_diff_map.ipynb">nbviewer</a>.
  <i>
</i></i></small></section></section>
</div>
    <aside class="postpromonav"><nav><ul itemprop="keywords" class="tags">
<li><a class="tag p-category" href="../../categories/computacion-cientifica/" rel="tag">computación científica</a></li>
            <li><a class="tag p-category" href="../../categories/edp/" rel="tag">edp</a></li>
            <li><a class="tag p-category" href="../../categories/metodo-de-diferencias-finitas/" rel="tag">método de diferencias finitas</a></li>
            <li><a class="tag p-category" href="../../categories/python/" rel="tag">python</a></li>
        </ul>
<ul class="pager hidden-print">
<li class="previous">
                <a href="../cyclic_colormaps/" rel="prev" title="Comparación de mapas de colores cíclicos">Publicación anterior</a>
            </li>
            <li class="next">
                <a href="../isometric_inkscape/" rel="next" title="Gráficos isométricos en Inkscape">Siguiente publicación</a>
            </li>
        </ul></nav></aside><section class="comments hidden-print"><h2>Comentarios</h2>
        
    
        <div id="disqus_thread"></div>
        <script>
        var disqus_shortname ="nicoguaro-github",
            disqus_url="https://nicoguaro.github.io/es/posts/infinite_fdm/",
        disqus_title="Diferencias finitas en dominios infinitos",
        disqus_identifier="cache/posts/infinite_fdm.html",
        disqus_config = function () {
            this.language = "es_ES";
        };
        (function() {
            var dsq = document.createElement('script'); dsq.async = true;
            dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script><noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a>
</noscript>
    <a href="https://disqus.com" class="dsq-brlink" rel="nofollow">Comments powered by <span class="logo-disqus">Disqus</span></a>


        </section><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML" integrity="sha384-3lJUsx1TJHt7BA4udB5KPnDrlkO8T6J6v/op7ui0BbCjvZ9WqV4Xm6DTP6kQ/iBH" crossorigin="anonymous"></script><script type="text/x-mathjax-config">
        MathJax.Hub.Config({tex2jax: {inlineMath: [['$latex ','$'], ['\\(','\\)']]}});
        </script></article><script>var disqus_shortname="nicoguaro-github";(function(){var a=document.createElement("script");a.async=true;a.src="https://"+disqus_shortname+".disqus.com/count.js";(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(a)}());</script><footer id="footer"><p><a href="https://creativecommons.org/licenses/by/4.0/" rel="nofollow">CC BY 4.0</a> © 2022 <a href="mailto:nicoguarin@gmail.com">Nicolás Guarín-Zapata</a>- Powered by <a href="https://getnikola.com" rel="nofollow">Nikola</a></p>
            
        </footer>
</div>
    </div>
    <label for="sidebar-checkbox" class="sidebar-toggle"></label>
    
<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-145359674-1', 'auto');
ga('send', 'pageview');
</script><script src="../../../assets/js/all-nocdn.js"></script><!-- fancy dates --><script>
    moment.locale("es");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates -->
</body>
</html>
