<!DOCTYPE html>
<html prefix="" lang="es">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width">
<title>Reto de métodos numéricos: Día 12 | Nicolás' blog</title>
<link href="../../../assets/css/all.css" rel="stylesheet" type="text/css">
<link rel="stylesheet" href="//fonts.googleapis.com/css?family=PT+Serif:400,400italic,700%7CPT+Sans:400">
<link rel="alternate" type="application/rss+xml" title="RSS (en)" href="../../../rss.xml">
<link rel="alternate" type="application/rss+xml" title="RSS (es)" href="../../rss.xml">
<link rel="canonical" href="https://nicoguaro.github.io/es/posts/numerical-12/">
<!--[if lt IE 9]><script src="../../../assets/js/html5.js"></script><![endif]--><meta name="author" content="Nicolás Guarín-Zapata">
<link rel="prev" href="../numerical-11/" title="Reto de métodos numéricos: Día 11" type="text/html">
<link rel="next" href="../numerical-13/" title="Reto de métodos numéricos: Día 13" type="text/html">
<meta property="og:site_name" content="Nicolás' blog">
<meta property="og:title" content="Reto de métodos numéricos: Día 12">
<meta property="og:url" content="https://nicoguaro.github.io/es/posts/numerical-12/">
<meta property="og:description" content="Durante octubre (2017) estaré escribiendo un programa por día para algunos
métodos numéricos famosos en Python y Julia. Esto está pensado como
un ejercicio, no esperen que el código sea lo suficientem">
<meta property="og:type" content="article">
<meta property="article:published_time" content="2017-10-12T15:06:10-05:00">
<meta property="article:tag" content="computación científica">
<meta property="article:tag" content="interpolación">
<meta property="article:tag" content="julia">
<meta property="article:tag" content="métodos numéricos">
<meta property="article:tag" content="python">
<link rel="alternate" hreflang="en" href="../../../posts/numerical-12/">
</head>
<body>
    <a href="#content" class="sr-only sr-only-focusable">Ir al contenido principal</a>
    <!-- Target for toggling the sidebar `.sidebar-checkbox` is for regular
            styles, `#sidebar-checkbox` for behavior. -->
    <input type="checkbox" class="sidebar-checkbox" id="sidebar-checkbox"><!-- Toggleable sidebar --><div class="sidebar" id="sidebar">
        <div class="sidebar-item">
            <p>A reserved <a href="https://getnikola.com" target="_blank">Nikola</a> theme that places the utmost gravity on content with a hidden drawer. Made by <a href="https://twitter.com/mdo" target="_blank">@mdo</a> for Jekyll,
            ported to Nikola by <a href="https://twitter.com/ralsina" target="_blank">@ralsina</a>.</p>
        </div>
        
    <nav id="menu" role="navigation" class="sidebar-nav"><a class="sidebar-nav-item" href="../../../pages/about/">About</a>
        <a class="sidebar-nav-item" href="../../../index.html">Blog</a>
        <a class="sidebar-nav-item" href="../../../pages/preprints-archive/">Preprints</a>
        <a class="sidebar-nav-item" href="../../../pages/links/">Links</a>
        <a class="sidebar-nav-item" href="../../../archive.html">Archive</a>
        <a class="sidebar-nav-item" href="../../../categories/">Tags</a>
        <a class="sidebar-nav-item" href="../../../rss.xml">RSS feed</a>
    
    
    </nav>
</div>

    <!-- Wrap is the content to shift when toggling the sidebar. We wrap the
         content to avoid any CSS collisions with our real content. -->
    <div class="wrap">
      <div class="masthead">
        <div class="container">
          
    <h3 id="brand" class="masthead-title">
      <a href="https://nicoguaro.github.io/es/" title="Nicolás' blog" rel="home">Nicolás' blog</a>
    </h3>

        </div>
      </div>

      <div class="container content" id="content">
        
<article class="post-text h-entry hentry postpage" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="post-title p-name entry-title" itemprop="headline name"><a href="." class="u-url">Reto de métodos numéricos: Día 12</a></h1>

        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn">Nicolás Guarín-Zapata</span></p>
            <p class="dateline"><a href="." rel="bookmark"><time class="post-date published dt-published" datetime="2017-10-12T15:06:10-05:00" itemprop="datePublished" title="2017-10-12 15:06">2017-10-12 15:06</time></a></p>
                <p class="commentline">
        
    <a href="#disqus_thread" data-disqus-identifier="cache/posts/numerical-12.html">Comentarios</a>


        </p>
</div>
        
        <div class="metadata posttranslations translations">
            <h3 class="posttranslations-intro">También disponible en:</h3>
                <p><a href="../../../posts/numerical-12/" rel="alternate" hreflang="en">English</a></p>
        </div>

    </header><div class="e-content entry-content" itemprop="articleBody text">
    <div>
<p>Durante octubre (2017) estaré escribiendo un programa por día para algunos
métodos numéricos famosos en Python y Julia. Esto está pensado como
un ejercicio, no esperen que el código sea lo suficientemente bueno para
usarse en la "vida real". Además, también debo mencionar que casi que no
tengo experiencia con Julia, así que probablemente no escriba un Julia
idiomático y se parezca más a Python.</p>
<div class="section" id="interpolacion-de-hermite-invirtiendo-la-matriz-de-vandermonde">
<h2>Interpolación de Hermite: Invirtiendo la matriz de Vandermonde</h2>
<p>Hoy vamos a comparar la <a class="reference external" href="posts/numerical-11">inerpolación de Lagrange</a> con la
<a class="reference external" href="https://en.wikipedia.org/wiki/Hermite_interpolation">interpolación de Hermite</a>.
Para este ejemplo usaremos la <a class="reference external" href="https://en.wikipedia.org/wiki/Vandermonde_matrix">matriz de Vandermone confluente</a> <span class="math">\(V\)</span>. El código está
basado en un código mío <em>viejo</em> que está disponible en
<a class="reference external" href="https://github.com/nicoguaro/FEM_resources/terpolation/interp.py">este repo</a>.</p>
<p>Como en el caso de la interpolación de Lagrange, resolvemos el sistema</p>
<div class="math">
\begin{equation*}
V\mathbf{c} = I
\end{equation*}
</div>
<p>donde <span class="math">\(\mathbf{c}\)</span> es el vector de coeficientes y <span class="math">\(I\)</span> es la matriz
identidad. Este método no es estable y no debería usarse para cálculos de
interpoladores de orden alto, incluso para muestreos escogidos de forma óptima.
Este fallará alrededor de 20 puntos. Una mejor aproximación es usar interpolación
en <a class="reference external" href="https://en.wikipedia.org/wiki/Lagrange_polynomial#Barycentric_form">forma baricéntrico</a>.</p>
<p>En el ejemplo a continuación usamos los <a class="reference external" href="https://en.wikipedia.org/wiki/Chebyshev_nodes">nodos de Chebyshev</a>. Los nodos están dados por</p>
<div class="math">
\begin{equation*}
x_k = \cos\left(\frac{2k-1}{2n}\pi\right), \quad k = 1, \ldots, n
\end{equation*}
</div>
<p>donde <span class="math">\(n\)</span> es el grado del polinomio.</p>
<p>A continuación se presentan los códigos.</p>
<div class="section" id="python">
<h3>Python</h3>
<pre class="code python"><a name="rest_code_87addac6d84e41c5ae6e16a3f7c0d480-1"></a><span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">division</span><span class="p">,</span> <span class="n">print_function</span>
<a name="rest_code_87addac6d84e41c5ae6e16a3f7c0d480-2"></a><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<a name="rest_code_87addac6d84e41c5ae6e16a3f7c0d480-3"></a><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<a name="rest_code_87addac6d84e41c5ae6e16a3f7c0d480-4"></a>
<a name="rest_code_87addac6d84e41c5ae6e16a3f7c0d480-5"></a>
<a name="rest_code_87addac6d84e41c5ae6e16a3f7c0d480-6"></a><span class="k">def</span> <span class="nf">vander_mat</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<a name="rest_code_87addac6d84e41c5ae6e16a3f7c0d480-7"></a>    <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="rest_code_87addac6d84e41c5ae6e16a3f7c0d480-8"></a>    <span class="n">van</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">n</span><span class="p">,</span> <span class="n">n</span><span class="p">))</span>
<a name="rest_code_87addac6d84e41c5ae6e16a3f7c0d480-9"></a>    <span class="n">power</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">))</span>
<a name="rest_code_87addac6d84e41c5ae6e16a3f7c0d480-10"></a>    <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
<a name="rest_code_87addac6d84e41c5ae6e16a3f7c0d480-11"></a>        <span class="n">van</span><span class="p">[</span><span class="n">row</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="n">row</span><span class="p">]</span><span class="o">**</span><span class="n">power</span>
<a name="rest_code_87addac6d84e41c5ae6e16a3f7c0d480-12"></a>    <span class="k">return</span> <span class="n">van</span>
<a name="rest_code_87addac6d84e41c5ae6e16a3f7c0d480-13"></a>
<a name="rest_code_87addac6d84e41c5ae6e16a3f7c0d480-14"></a>
<a name="rest_code_87addac6d84e41c5ae6e16a3f7c0d480-15"></a><span class="k">def</span> <span class="nf">conf_vander_mat</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<a name="rest_code_87addac6d84e41c5ae6e16a3f7c0d480-16"></a>    <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="rest_code_87addac6d84e41c5ae6e16a3f7c0d480-17"></a>    <span class="n">conf_van</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">2</span><span class="o">*</span><span class="n">n</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">n</span><span class="p">))</span>
<a name="rest_code_87addac6d84e41c5ae6e16a3f7c0d480-18"></a>    <span class="n">power</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">n</span><span class="p">))</span>
<a name="rest_code_87addac6d84e41c5ae6e16a3f7c0d480-19"></a>    <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
<a name="rest_code_87addac6d84e41c5ae6e16a3f7c0d480-20"></a>        <span class="n">conf_van</span><span class="p">[</span><span class="n">row</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="n">row</span><span class="p">]</span><span class="o">**</span><span class="n">power</span>
<a name="rest_code_87addac6d84e41c5ae6e16a3f7c0d480-21"></a>        <span class="n">conf_van</span><span class="p">[</span><span class="n">row</span> <span class="o">+</span> <span class="n">n</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">power</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="n">row</span><span class="p">]</span><span class="o">**</span><span class="p">(</span><span class="n">power</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
<a name="rest_code_87addac6d84e41c5ae6e16a3f7c0d480-22"></a>    <span class="k">return</span> <span class="n">conf_van</span>
<a name="rest_code_87addac6d84e41c5ae6e16a3f7c0d480-23"></a>
<a name="rest_code_87addac6d84e41c5ae6e16a3f7c0d480-24"></a>
<a name="rest_code_87addac6d84e41c5ae6e16a3f7c0d480-25"></a><span class="k">def</span> <span class="nf">inter_coef</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">inter_type</span><span class="o">=</span><span class="s2">"lagrange"</span><span class="p">):</span>
<a name="rest_code_87addac6d84e41c5ae6e16a3f7c0d480-26"></a>    <span class="k">if</span> <span class="n">inter_type</span> <span class="o">==</span> <span class="s2">"lagrange"</span><span class="p">:</span>
<a name="rest_code_87addac6d84e41c5ae6e16a3f7c0d480-27"></a>        <span class="n">vand_mat</span> <span class="o">=</span> <span class="n">vander_mat</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="rest_code_87addac6d84e41c5ae6e16a3f7c0d480-28"></a>    <span class="k">elif</span> <span class="n">inter_type</span> <span class="o">==</span> <span class="s2">"hermite"</span><span class="p">:</span>
<a name="rest_code_87addac6d84e41c5ae6e16a3f7c0d480-29"></a>        <span class="n">vand_mat</span> <span class="o">=</span> <span class="n">conf_vander_mat</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="rest_code_87addac6d84e41c5ae6e16a3f7c0d480-30"></a>    <span class="n">coef</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">vand_mat</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="n">vand_mat</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
<a name="rest_code_87addac6d84e41c5ae6e16a3f7c0d480-31"></a>    <span class="k">return</span> <span class="n">coef</span>
<a name="rest_code_87addac6d84e41c5ae6e16a3f7c0d480-32"></a>
<a name="rest_code_87addac6d84e41c5ae6e16a3f7c0d480-33"></a>
<a name="rest_code_87addac6d84e41c5ae6e16a3f7c0d480-34"></a><span class="k">def</span> <span class="nf">compute_interp</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">x_eval</span><span class="p">,</span> <span class="n">df</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<a name="rest_code_87addac6d84e41c5ae6e16a3f7c0d480-35"></a>    <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="rest_code_87addac6d84e41c5ae6e16a3f7c0d480-36"></a>    <span class="k">if</span> <span class="n">df</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a name="rest_code_87addac6d84e41c5ae6e16a3f7c0d480-37"></a>        <span class="n">coef</span> <span class="o">=</span> <span class="n">inter_coef</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">inter_type</span><span class="o">=</span><span class="s2">"lagrange"</span><span class="p">)</span>
<a name="rest_code_87addac6d84e41c5ae6e16a3f7c0d480-38"></a>    <span class="k">else</span><span class="p">:</span>
<a name="rest_code_87addac6d84e41c5ae6e16a3f7c0d480-39"></a>        <span class="n">coef</span> <span class="o">=</span> <span class="n">inter_coef</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">inter_type</span><span class="o">=</span><span class="s2">"hermite"</span><span class="p">)</span>
<a name="rest_code_87addac6d84e41c5ae6e16a3f7c0d480-40"></a>    <span class="n">f_eval</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">x_eval</span><span class="p">)</span>
<a name="rest_code_87addac6d84e41c5ae6e16a3f7c0d480-41"></a>    <span class="n">nmat</span> <span class="o">=</span> <span class="n">coef</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<a name="rest_code_87addac6d84e41c5ae6e16a3f7c0d480-42"></a>    <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nmat</span><span class="p">):</span>
<a name="rest_code_87addac6d84e41c5ae6e16a3f7c0d480-43"></a>        <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nmat</span><span class="p">):</span>
<a name="rest_code_87addac6d84e41c5ae6e16a3f7c0d480-44"></a>            <span class="k">if</span> <span class="n">col</span> <span class="o">&lt;</span> <span class="n">n</span> <span class="ow">or</span> <span class="n">nmat</span> <span class="o">==</span> <span class="n">n</span><span class="p">:</span>
<a name="rest_code_87addac6d84e41c5ae6e16a3f7c0d480-45"></a>                <span class="n">f_eval</span> <span class="o">+=</span> <span class="n">coef</span><span class="p">[</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">]</span><span class="o">*</span><span class="n">x_eval</span><span class="o">**</span><span class="n">row</span><span class="o">*</span><span class="n">f</span><span class="p">[</span><span class="n">col</span><span class="p">]</span>
<a name="rest_code_87addac6d84e41c5ae6e16a3f7c0d480-46"></a>            <span class="k">else</span><span class="p">:</span>
<a name="rest_code_87addac6d84e41c5ae6e16a3f7c0d480-47"></a>                <span class="n">f_eval</span> <span class="o">+=</span> <span class="n">coef</span><span class="p">[</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">]</span><span class="o">*</span><span class="n">x_eval</span><span class="o">**</span><span class="n">row</span><span class="o">*</span><span class="n">df</span><span class="p">[</span><span class="n">col</span> <span class="o">-</span> <span class="n">n</span><span class="p">]</span>
<a name="rest_code_87addac6d84e41c5ae6e16a3f7c0d480-48"></a>    <span class="k">return</span> <span class="n">f_eval</span>
<a name="rest_code_87addac6d84e41c5ae6e16a3f7c0d480-49"></a>
<a name="rest_code_87addac6d84e41c5ae6e16a3f7c0d480-50"></a>
<a name="rest_code_87addac6d84e41c5ae6e16a3f7c0d480-51"></a>
<a name="rest_code_87addac6d84e41c5ae6e16a3f7c0d480-52"></a>
<a name="rest_code_87addac6d84e41c5ae6e16a3f7c0d480-53"></a><span class="n">n</span> <span class="o">=</span> <span class="mi">7</span>
<a name="rest_code_87addac6d84e41c5ae6e16a3f7c0d480-54"></a><span class="n">x</span> <span class="o">=</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">n</span><span class="p">))</span>
<a name="rest_code_87addac6d84e41c5ae6e16a3f7c0d480-55"></a><span class="n">f</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="mi">25</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<a name="rest_code_87addac6d84e41c5ae6e16a3f7c0d480-56"></a><span class="n">df</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="o">-</span><span class="mi">50</span><span class="o">*</span><span class="n">x</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="mi">25</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>
<a name="rest_code_87addac6d84e41c5ae6e16a3f7c0d480-57"></a><span class="n">x_eval</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">500</span><span class="p">)</span>
<a name="rest_code_87addac6d84e41c5ae6e16a3f7c0d480-58"></a><span class="n">interp_f</span> <span class="o">=</span> <span class="n">compute_interp</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">x_eval</span><span class="p">,</span> <span class="n">df</span><span class="o">=</span><span class="n">df</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<a name="rest_code_87addac6d84e41c5ae6e16a3f7c0d480-59"></a><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_eval</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">x_eval</span><span class="p">))</span>
<a name="rest_code_87addac6d84e41c5ae6e16a3f7c0d480-60"></a><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_eval</span><span class="p">,</span> <span class="n">interp_f</span><span class="p">)</span>
<a name="rest_code_87addac6d84e41c5ae6e16a3f7c0d480-61"></a><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="s2">"."</span><span class="p">)</span>
<a name="rest_code_87addac6d84e41c5ae6e16a3f7c0d480-62"></a><span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">)</span>
<a name="rest_code_87addac6d84e41c5ae6e16a3f7c0d480-63"></a><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre>
</div>
<div class="section" id="julia">
<h3>Julia</h3>
<pre class="code julia"><a name="rest_code_70023994965044e38cd3c415946eeae4-1"></a><span class="k">using</span> <span class="n">PyPlot</span>
<a name="rest_code_70023994965044e38cd3c415946eeae4-2"></a>
<a name="rest_code_70023994965044e38cd3c415946eeae4-3"></a>
<a name="rest_code_70023994965044e38cd3c415946eeae4-4"></a><span class="k">function</span> <span class="n">vander_mat</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="rest_code_70023994965044e38cd3c415946eeae4-5"></a>    <span class="n">n</span> <span class="o">=</span> <span class="n">length</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="rest_code_70023994965044e38cd3c415946eeae4-6"></a>    <span class="n">van</span> <span class="o">=</span> <span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
<a name="rest_code_70023994965044e38cd3c415946eeae4-7"></a>    <span class="n">power</span> <span class="o">=</span> <span class="mi">0</span><span class="o">:</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span>
<a name="rest_code_70023994965044e38cd3c415946eeae4-8"></a>    <span class="k">for</span> <span class="n">row</span> <span class="o">=</span> <span class="mi">1</span><span class="o">:</span><span class="n">n</span>
<a name="rest_code_70023994965044e38cd3c415946eeae4-9"></a>        <span class="n">van</span><span class="p">[</span><span class="n">row</span><span class="p">,</span> <span class="o">:</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="n">row</span><span class="p">]</span><span class="o">.^</span><span class="n">power</span>
<a name="rest_code_70023994965044e38cd3c415946eeae4-10"></a>    <span class="k">end</span>
<a name="rest_code_70023994965044e38cd3c415946eeae4-11"></a>    <span class="k">return</span> <span class="n">van</span>
<a name="rest_code_70023994965044e38cd3c415946eeae4-12"></a><span class="k">end</span>
<a name="rest_code_70023994965044e38cd3c415946eeae4-13"></a>
<a name="rest_code_70023994965044e38cd3c415946eeae4-14"></a>
<a name="rest_code_70023994965044e38cd3c415946eeae4-15"></a><span class="k">function</span> <span class="n">conf_vander_mat</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="rest_code_70023994965044e38cd3c415946eeae4-16"></a>    <span class="n">n</span> <span class="o">=</span> <span class="n">length</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="rest_code_70023994965044e38cd3c415946eeae4-17"></a>    <span class="n">conf_van</span> <span class="o">=</span> <span class="n">zeros</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">n</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">n</span><span class="p">)</span>
<a name="rest_code_70023994965044e38cd3c415946eeae4-18"></a>    <span class="n">power</span> <span class="o">=</span> <span class="mi">0</span><span class="o">:</span><span class="mi">2</span><span class="o">*</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span>
<a name="rest_code_70023994965044e38cd3c415946eeae4-19"></a>    <span class="k">for</span> <span class="n">row</span> <span class="o">=</span> <span class="mi">1</span><span class="o">:</span><span class="n">n</span>
<a name="rest_code_70023994965044e38cd3c415946eeae4-20"></a>        <span class="n">conf_van</span><span class="p">[</span><span class="n">row</span><span class="p">,</span> <span class="o">:</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="n">row</span><span class="p">]</span><span class="o">.^</span><span class="n">power</span>
<a name="rest_code_70023994965044e38cd3c415946eeae4-21"></a>        <span class="n">conf_van</span><span class="p">[</span><span class="n">row</span> <span class="o">+</span> <span class="n">n</span><span class="p">,</span> <span class="o">:</span><span class="p">]</span> <span class="o">=</span> <span class="n">power</span><span class="o">.*</span><span class="n">x</span><span class="p">[</span><span class="n">row</span><span class="p">]</span><span class="o">.^</span><span class="p">(</span><span class="n">power</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
<a name="rest_code_70023994965044e38cd3c415946eeae4-22"></a>    <span class="k">end</span>
<a name="rest_code_70023994965044e38cd3c415946eeae4-23"></a>    <span class="k">return</span> <span class="n">conf_van</span>
<a name="rest_code_70023994965044e38cd3c415946eeae4-24"></a><span class="k">end</span>
<a name="rest_code_70023994965044e38cd3c415946eeae4-25"></a>
<a name="rest_code_70023994965044e38cd3c415946eeae4-26"></a>
<a name="rest_code_70023994965044e38cd3c415946eeae4-27"></a><span class="k">function</span> <span class="n">inter_coef</span><span class="p">(</span><span class="n">x</span><span class="p">;</span> <span class="n">inter_type</span><span class="o">=</span><span class="s">"lagrange"</span><span class="p">)</span>
<a name="rest_code_70023994965044e38cd3c415946eeae4-28"></a>    <span class="k">if</span> <span class="n">inter_type</span> <span class="o">==</span> <span class="s">"lagrange"</span>
<a name="rest_code_70023994965044e38cd3c415946eeae4-29"></a>        <span class="n">vand_mat</span> <span class="o">=</span> <span class="n">vander_mat</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="rest_code_70023994965044e38cd3c415946eeae4-30"></a>    <span class="k">elseif</span> <span class="n">inter_type</span> <span class="o">==</span> <span class="s">"hermite"</span>
<a name="rest_code_70023994965044e38cd3c415946eeae4-31"></a>        <span class="n">vand_mat</span> <span class="o">=</span> <span class="n">conf_vander_mat</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="rest_code_70023994965044e38cd3c415946eeae4-32"></a>    <span class="k">end</span>
<a name="rest_code_70023994965044e38cd3c415946eeae4-33"></a>    <span class="n">coef</span> <span class="o">=</span> <span class="n">vand_mat</span> <span class="o">\</span> <span class="n">eye</span><span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="n">vand_mat</span><span class="p">)[</span><span class="mi">1</span><span class="p">])</span>
<a name="rest_code_70023994965044e38cd3c415946eeae4-34"></a>    <span class="k">return</span> <span class="n">coef</span>
<a name="rest_code_70023994965044e38cd3c415946eeae4-35"></a><span class="k">end</span>
<a name="rest_code_70023994965044e38cd3c415946eeae4-36"></a>
<a name="rest_code_70023994965044e38cd3c415946eeae4-37"></a>
<a name="rest_code_70023994965044e38cd3c415946eeae4-38"></a><span class="k">function</span> <span class="n">compute_interp</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">x_eval</span><span class="p">;</span> <span class="n">df</span><span class="o">=</span><span class="nb">nothing</span><span class="p">)</span>
<a name="rest_code_70023994965044e38cd3c415946eeae4-39"></a>    <span class="n">n</span> <span class="o">=</span> <span class="n">length</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="rest_code_70023994965044e38cd3c415946eeae4-40"></a>    <span class="k">if</span> <span class="n">df</span> <span class="o">==</span> <span class="nb">nothing</span>
<a name="rest_code_70023994965044e38cd3c415946eeae4-41"></a>        <span class="n">coef</span> <span class="o">=</span> <span class="n">inter_coef</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">inter_type</span><span class="o">=</span><span class="s">"lagrange"</span><span class="p">)</span>
<a name="rest_code_70023994965044e38cd3c415946eeae4-42"></a>    <span class="k">else</span>
<a name="rest_code_70023994965044e38cd3c415946eeae4-43"></a>        <span class="n">coef</span> <span class="o">=</span> <span class="n">inter_coef</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">inter_type</span><span class="o">=</span><span class="s">"hermite"</span><span class="p">)</span>
<a name="rest_code_70023994965044e38cd3c415946eeae4-44"></a>    <span class="k">end</span>
<a name="rest_code_70023994965044e38cd3c415946eeae4-45"></a>    <span class="n">f_eval</span> <span class="o">=</span> <span class="n">zeros</span><span class="p">(</span><span class="n">x_eval</span><span class="p">)</span>
<a name="rest_code_70023994965044e38cd3c415946eeae4-46"></a>    <span class="n">nmat</span> <span class="o">=</span> <span class="n">size</span><span class="p">(</span><span class="n">coef</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
<a name="rest_code_70023994965044e38cd3c415946eeae4-47"></a>    <span class="k">for</span> <span class="n">row</span> <span class="o">=</span> <span class="mi">1</span><span class="o">:</span><span class="n">nmat</span>
<a name="rest_code_70023994965044e38cd3c415946eeae4-48"></a>        <span class="k">for</span> <span class="n">col</span> <span class="o">=</span> <span class="mi">1</span><span class="o">:</span><span class="n">nmat</span>
<a name="rest_code_70023994965044e38cd3c415946eeae4-49"></a>            <span class="k">if</span> <span class="n">col</span> <span class="o">&lt;=</span> <span class="n">n</span> <span class="o">||</span> <span class="n">nmat</span> <span class="o">==</span> <span class="n">n</span>
<a name="rest_code_70023994965044e38cd3c415946eeae4-50"></a>                <span class="n">f_eval</span> <span class="o">+=</span> <span class="n">coef</span><span class="p">[</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">]</span><span class="o">*</span><span class="n">x_eval</span><span class="o">.^</span><span class="p">(</span><span class="n">row</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">f</span><span class="p">[</span><span class="n">col</span><span class="p">]</span>
<a name="rest_code_70023994965044e38cd3c415946eeae4-51"></a>            <span class="k">else</span>
<a name="rest_code_70023994965044e38cd3c415946eeae4-52"></a>                <span class="n">f_eval</span> <span class="o">+=</span> <span class="n">coef</span><span class="p">[</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">]</span><span class="o">*</span><span class="n">x_eval</span><span class="o">.^</span><span class="p">(</span><span class="n">row</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">df</span><span class="p">[</span><span class="n">col</span> <span class="o">-</span> <span class="n">n</span><span class="p">]</span>
<a name="rest_code_70023994965044e38cd3c415946eeae4-53"></a>            <span class="k">end</span>
<a name="rest_code_70023994965044e38cd3c415946eeae4-54"></a>        <span class="k">end</span>
<a name="rest_code_70023994965044e38cd3c415946eeae4-55"></a>    <span class="k">end</span>
<a name="rest_code_70023994965044e38cd3c415946eeae4-56"></a>    <span class="k">return</span> <span class="n">f_eval</span>
<a name="rest_code_70023994965044e38cd3c415946eeae4-57"></a><span class="k">end</span>
<a name="rest_code_70023994965044e38cd3c415946eeae4-58"></a>
<a name="rest_code_70023994965044e38cd3c415946eeae4-59"></a>
<a name="rest_code_70023994965044e38cd3c415946eeae4-60"></a><span class="n">n</span> <span class="o">=</span> <span class="mi">7</span>
<a name="rest_code_70023994965044e38cd3c415946eeae4-61"></a><span class="n">x</span> <span class="o">=</span> <span class="o">-</span><span class="n">cos</span><span class="o">.</span><span class="p">(</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">pi</span><span class="p">,</span> <span class="n">n</span><span class="p">))</span>
<a name="rest_code_70023994965044e38cd3c415946eeae4-62"></a><span class="n">f</span> <span class="o">=</span> <span class="mf">1.</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="mi">25</span><span class="o">*</span><span class="n">x</span><span class="o">.^</span><span class="mi">2</span><span class="p">)</span>
<a name="rest_code_70023994965044e38cd3c415946eeae4-63"></a><span class="n">df</span> <span class="o">=</span> <span class="o">-</span><span class="mi">50</span><span class="o">*</span><span class="n">x</span><span class="o">./</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="mi">25</span><span class="o">*</span><span class="n">x</span><span class="o">.^</span><span class="mi">2</span><span class="p">)</span><span class="o">.^</span><span class="mi">2</span>
<a name="rest_code_70023994965044e38cd3c415946eeae4-64"></a><span class="n">x_eval</span> <span class="o">=</span> <span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">500</span><span class="p">)</span>
<a name="rest_code_70023994965044e38cd3c415946eeae4-65"></a><span class="n">interp_f</span> <span class="o">=</span> <span class="n">compute_interp</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">x_eval</span><span class="p">,</span> <span class="n">df</span><span class="o">=</span><span class="n">df</span><span class="p">)</span>
<a name="rest_code_70023994965044e38cd3c415946eeae4-66"></a><span class="n">plot</span><span class="p">(</span><span class="n">x_eval</span><span class="p">,</span> <span class="mf">1.</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="mi">25</span><span class="o">*</span><span class="n">x_eval</span><span class="o">.^</span><span class="mi">2</span><span class="p">))</span>
<a name="rest_code_70023994965044e38cd3c415946eeae4-67"></a><span class="n">plot</span><span class="p">(</span><span class="n">x_eval</span><span class="p">,</span> <span class="n">interp_f</span><span class="p">)</span>
<a name="rest_code_70023994965044e38cd3c415946eeae4-68"></a><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="s">"."</span><span class="p">)</span>
<a name="rest_code_70023994965044e38cd3c415946eeae4-69"></a><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">)</span>
<a name="rest_code_70023994965044e38cd3c415946eeae4-70"></a><span class="n">show</span><span class="p">()</span>
</pre>
<p>En ambos casos el resultado es el siguiente gráfico.</p>
<img alt="Interpolación de Hermite usando la matriz de Vandermonde." class="align-center" src="../../../images/hermite_vandermonde.svg" style="width: 500px;"><p>Y, si probamos con un <span class="math">\(n\)</span> grande, digamos <span class="math">\(n=43\)</span>, podemos ver los
problemas.</p>
<img alt="Interpolación de Hermite usando la matriz de Vandermonde." class="align-center" src="../../../images/hermite_vandermonde-n-23.svg" style="width: 500px;">
</div>
<div class="section" id="comparacion-python-julia">
<h3>Comparación Python/Julia</h3>
<p>Respecto al número de líneas tenemos: 61 en Python y 70 en Julia.  La comparación
en tiempo de ejecución se realizó con el comando mágico de IPython <code class="docutils literal">%timeit</code>
y con <code class="docutils literal">@benchmark</code> en Julia.</p>
<p>Para Python:</p>
<pre class="code IPython"><a name="rest_code_b42fa65b3d9147db89aae99ffc4118d3-1"></a><span class="o">%%time</span>it -n 100
<a name="rest_code_b42fa65b3d9147db89aae99ffc4118d3-2"></a><span class="n">n</span> <span class="o">=</span> <span class="mi">7</span>
<a name="rest_code_b42fa65b3d9147db89aae99ffc4118d3-3"></a><span class="n">x</span> <span class="o">=</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">n</span><span class="p">))</span>
<a name="rest_code_b42fa65b3d9147db89aae99ffc4118d3-4"></a><span class="n">f</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="mi">25</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<a name="rest_code_b42fa65b3d9147db89aae99ffc4118d3-5"></a><span class="n">df</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="o">-</span><span class="mi">50</span><span class="o">*</span><span class="n">x</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="mi">25</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>
<a name="rest_code_b42fa65b3d9147db89aae99ffc4118d3-6"></a><span class="n">x_eval</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">500</span><span class="p">)</span>
<a name="rest_code_b42fa65b3d9147db89aae99ffc4118d3-7"></a><span class="n">interp_f</span> <span class="o">=</span> <span class="n">compute_interp</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">x_eval</span><span class="p">,</span> <span class="n">df</span><span class="o">=</span><span class="n">df</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
</pre>
<p>con resultado</p>
<pre class="code text"><a name="rest_code_0ff56176dfe3452fae3daafd74bd1458-1"></a>100 loops, best of 3: 18.1 ms per loop
</pre>
<p>Para Julia:</p>
<pre class="code julia"><a name="rest_code_f2b49879171b4027a2acb2f67130bb76-1"></a><span class="k">function</span> <span class="n">bench</span><span class="p">()</span>
<a name="rest_code_f2b49879171b4027a2acb2f67130bb76-2"></a>   <span class="n">n</span> <span class="o">=</span> <span class="mi">7</span>
<a name="rest_code_f2b49879171b4027a2acb2f67130bb76-3"></a>   <span class="n">x</span> <span class="o">=</span> <span class="o">-</span><span class="n">cos</span><span class="o">.</span><span class="p">(</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">pi</span><span class="p">,</span> <span class="n">n</span><span class="p">))</span>
<a name="rest_code_f2b49879171b4027a2acb2f67130bb76-4"></a>   <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">=</span> <span class="mf">1.</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="mi">25</span><span class="o">*</span><span class="n">x</span><span class="o">.^</span><span class="mi">2</span><span class="p">)</span>
<a name="rest_code_f2b49879171b4027a2acb2f67130bb76-5"></a>   <span class="n">df</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">=</span> <span class="o">-</span><span class="mi">50</span><span class="o">*</span><span class="n">x</span><span class="o">./</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="mi">25</span><span class="o">*</span><span class="n">x</span><span class="o">.^</span><span class="mi">2</span><span class="p">)</span><span class="o">.^</span><span class="mi">2</span>
<a name="rest_code_f2b49879171b4027a2acb2f67130bb76-6"></a>   <span class="n">x_eval</span> <span class="o">=</span> <span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">500</span><span class="p">)</span>
<a name="rest_code_f2b49879171b4027a2acb2f67130bb76-7"></a>   <span class="n">interp_f</span> <span class="o">=</span> <span class="n">compute_interp</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">x_eval</span><span class="p">,</span> <span class="n">df</span><span class="o">=</span><span class="n">df</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<a name="rest_code_f2b49879171b4027a2acb2f67130bb76-8"></a><span class="k">end</span>
<a name="rest_code_f2b49879171b4027a2acb2f67130bb76-9"></a><span class="nd">@benchmark</span> <span class="n">bench</span><span class="p">()</span>
</pre>
<p>con resultado</p>
<pre class="code julia"><a name="rest_code_95475a635f7d4a6f98e8de2ccf5eebfd-1"></a><span class="n">BenchmarkTools</span><span class="o">.</span><span class="n">Trial</span><span class="o">:</span>
<a name="rest_code_95475a635f7d4a6f98e8de2ccf5eebfd-2"></a>  <span class="n">memory</span> <span class="n">estimate</span><span class="o">:</span>  <span class="mf">3.13</span> <span class="n">MiB</span>
<a name="rest_code_95475a635f7d4a6f98e8de2ccf5eebfd-3"></a>  <span class="n">allocs</span> <span class="n">estimate</span><span class="o">:</span>  <span class="mi">836</span>
<a name="rest_code_95475a635f7d4a6f98e8de2ccf5eebfd-4"></a>  <span class="o">--------------</span>
<a name="rest_code_95475a635f7d4a6f98e8de2ccf5eebfd-5"></a>  <span class="n">minimum</span> <span class="n">time</span><span class="o">:</span>     <span class="mf">10.318</span> <span class="n">ms</span> <span class="p">(</span><span class="mf">0.00</span><span class="o">%</span> <span class="n">GC</span><span class="p">)</span>
<a name="rest_code_95475a635f7d4a6f98e8de2ccf5eebfd-6"></a>  <span class="n">median</span> <span class="n">time</span><span class="o">:</span>      <span class="mf">10.449</span> <span class="n">ms</span> <span class="p">(</span><span class="mf">0.00</span><span class="o">%</span> <span class="n">GC</span><span class="p">)</span>
<a name="rest_code_95475a635f7d4a6f98e8de2ccf5eebfd-7"></a>  <span class="n">mean</span> <span class="n">time</span><span class="o">:</span>        <span class="mf">11.362</span> <span class="n">ms</span> <span class="p">(</span><span class="mf">1.74</span><span class="o">%</span> <span class="n">GC</span><span class="p">)</span>
<a name="rest_code_95475a635f7d4a6f98e8de2ccf5eebfd-8"></a>  <span class="n">maximum</span> <span class="n">time</span><span class="o">:</span>     <span class="mf">26.646</span> <span class="n">ms</span> <span class="p">(</span><span class="mf">0.00</span><span class="o">%</span> <span class="n">GC</span><span class="p">)</span>
<a name="rest_code_95475a635f7d4a6f98e8de2ccf5eebfd-9"></a>  <span class="o">--------------</span>
<a name="rest_code_95475a635f7d4a6f98e8de2ccf5eebfd-10"></a>  <span class="n">samples</span><span class="o">:</span>          <span class="mi">100</span>
<a name="rest_code_95475a635f7d4a6f98e8de2ccf5eebfd-11"></a>  <span class="n">evals</span><span class="o">/</span><span class="n">sample</span><span class="o">:</span>     <span class="mi">1</span>
</pre>
<p>En este caso, podemos decir que el código de Python es tan rápido como el de
Julia.</p>
</div>
<div class="section" id="comparacion-de-interpolacion-de-hermite-lagrange">
<h3>Comparación de Interpolación de Hermite/Lagrange</h3>
<p>Queremos comparar la interpolación de Hermite y de Lagrange para el mismo
número de grados de libertad. Usamos la misma función para la prueba</p>
<div class="math">
\begin{equation*}
f(x) = \frac{1}{1 + 25x^2}
\end{equation*}
</div>
<p>Este es el código de Python que hace la comparación</p>
<pre class="code Python"><a name="rest_code_011a2237d52f4b7fb0a66bc3c73fdb20-1"></a><span class="n">n_dof</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">20</span><span class="p">))</span>
<a name="rest_code_011a2237d52f4b7fb0a66bc3c73fdb20-2"></a><span class="n">error_herm</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">19</span><span class="p">)</span>
<a name="rest_code_011a2237d52f4b7fb0a66bc3c73fdb20-3"></a><span class="n">error_lag</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">19</span><span class="p">)</span>
<a name="rest_code_011a2237d52f4b7fb0a66bc3c73fdb20-4"></a><span class="k">for</span> <span class="n">cont</span><span class="p">,</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">n_dof</span><span class="p">):</span>
<a name="rest_code_011a2237d52f4b7fb0a66bc3c73fdb20-5"></a>    <span class="n">f</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="mi">25</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<a name="rest_code_011a2237d52f4b7fb0a66bc3c73fdb20-6"></a>    <span class="n">df</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="o">-</span><span class="mi">50</span><span class="o">*</span><span class="n">x</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="mi">25</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>
<a name="rest_code_011a2237d52f4b7fb0a66bc3c73fdb20-7"></a>    <span class="n">x</span> <span class="o">=</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">n</span><span class="p">))</span>
<a name="rest_code_011a2237d52f4b7fb0a66bc3c73fdb20-8"></a>    <span class="n">x2</span> <span class="o">=</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">n</span><span class="p">))</span>
<a name="rest_code_011a2237d52f4b7fb0a66bc3c73fdb20-9"></a>    <span class="n">x_eval</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">500</span><span class="p">)</span>
<a name="rest_code_011a2237d52f4b7fb0a66bc3c73fdb20-10"></a>    <span class="n">herm</span> <span class="o">=</span> <span class="n">compute_interp</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">x_eval</span><span class="p">,</span> <span class="n">df</span><span class="o">=</span><span class="n">df</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<a name="rest_code_011a2237d52f4b7fb0a66bc3c73fdb20-11"></a>    <span class="n">lag</span> <span class="o">=</span> <span class="n">compute_interp</span><span class="p">(</span><span class="n">x2</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">x2</span><span class="p">),</span> <span class="n">x_eval</span><span class="p">)</span>
<a name="rest_code_011a2237d52f4b7fb0a66bc3c73fdb20-12"></a>    <span class="n">fun</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">x_eval</span><span class="p">)</span>
<a name="rest_code_011a2237d52f4b7fb0a66bc3c73fdb20-13"></a>    <span class="n">error_herm</span><span class="p">[</span><span class="n">cont</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">fun</span> <span class="o">-</span> <span class="n">herm</span><span class="p">)</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">fun</span><span class="p">)</span>
<a name="rest_code_011a2237d52f4b7fb0a66bc3c73fdb20-14"></a>    <span class="n">error_lag</span><span class="p">[</span><span class="n">cont</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">fun</span> <span class="o">-</span> <span class="n">lag</span><span class="p">)</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">fun</span><span class="p">)</span>
<a name="rest_code_011a2237d52f4b7fb0a66bc3c73fdb20-15"></a>
<a name="rest_code_011a2237d52f4b7fb0a66bc3c73fdb20-16"></a><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">n_dof</span><span class="p">,</span> <span class="n">error_lag</span><span class="p">)</span>
<a name="rest_code_011a2237d52f4b7fb0a66bc3c73fdb20-17"></a><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">n_dof</span><span class="p">,</span> <span class="n">error_herm</span><span class="p">)</span>
<a name="rest_code_011a2237d52f4b7fb0a66bc3c73fdb20-18"></a><span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">"Number of degrees of freedom"</span><span class="p">)</span>
<a name="rest_code_011a2237d52f4b7fb0a66bc3c73fdb20-19"></a><span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">"Relative error"</span><span class="p">)</span>
<a name="rest_code_011a2237d52f4b7fb0a66bc3c73fdb20-20"></a><span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s2">"Lagrange"</span><span class="p">,</span> <span class="s2">"Hermite"</span><span class="p">])</span>
<a name="rest_code_011a2237d52f4b7fb0a66bc3c73fdb20-21"></a><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre>
<p>Y esta es la comparación de los errores relativos</p>
<img alt="Comparación de errores entre interpolación de Lagrange y Hermite." class="align-center" src="../../../images/hermite_lagrange_error.svg" style="width: 500px;"><p>En general, la aproximación de Lagrange está cerca de la función.</p>
</div>
</div>
</div>
    </div>
    <aside class="postpromonav"><nav><ul itemprop="keywords" class="tags">
<li><a class="tag p-category" href="../../categories/computacion-cientifica/" rel="tag">computación científica</a></li>
            <li><a class="tag p-category" href="../../categories/interpolacion/" rel="tag">interpolación</a></li>
            <li><a class="tag p-category" href="../../categories/julia/" rel="tag">julia</a></li>
            <li><a class="tag p-category" href="../../categories/metodos-numericos/" rel="tag">métodos numéricos</a></li>
            <li><a class="tag p-category" href="../../categories/python/" rel="tag">python</a></li>
        </ul>
<ul class="pager hidden-print">
<li class="previous">
                <a href="../numerical-11/" rel="prev" title="Reto de métodos numéricos: Día 11">Publicación anterior</a>
            </li>
            <li class="next">
                <a href="../numerical-13/" rel="next" title="Reto de métodos numéricos: Día 13">Siguiente publicación</a>
            </li>
        </ul></nav></aside><section class="comments hidden-print"><h2>Comentarios</h2>
        
        
        <div id="disqus_thread"></div>
        <script>
        var disqus_shortname ="nicoguaro-github",
            disqus_url="https://nicoguaro.github.io/es/posts/numerical-12/",
        disqus_title="Reto de m\u00e9todos num\u00e9ricos: D\u00eda 12",
        disqus_identifier="cache/posts/numerical-12.html",
        disqus_config = function () {
            this.language = "es_ES";
        };
        (function() {
            var dsq = document.createElement('script'); dsq.async = true;
            dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script><noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a>
</noscript>
    <a href="https://disqus.com" class="dsq-brlink" rel="nofollow">Comments powered by <span class="logo-disqus">Disqus</span></a>


        </section><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML" integrity="sha384-3lJUsx1TJHt7BA4udB5KPnDrlkO8T6J6v/op7ui0BbCjvZ9WqV4Xm6DTP6kQ/iBH" crossorigin="anonymous"></script><script type="text/x-mathjax-config">
        MathJax.Hub.Config({tex2jax: {inlineMath: [['$latex ','$'], ['\\(','\\)']]}});
        </script></article><script>var disqus_shortname="nicoguaro-github";(function(){var a=document.createElement("script");a.async=true;a.src="https://"+disqus_shortname+".disqus.com/count.js";(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(a)}());</script><footer id="footer"><p>Contents © 2021 <a href="mailto:nicoguarin@gmail.com">Nicolás Guarín-Zapata</a> - Powered by <a href="https://getnikola.com" rel="nofollow">Nikola</a> 
<a rel="license" href="http://creativecommons.org/licenses/by/4.0/">
<img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by/4.0/88x31.png"></a></p>
            
        </footer>
</div>
    </div>
    <label for="sidebar-checkbox" class="sidebar-toggle"></label>
    
<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-145359674-1', 'auto');
ga('send', 'pageview');
</script><script src="../../../assets/js/all-nocdn.js"></script><!-- fancy dates --><script>
    moment.locale("es");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates -->
</body>
</html>
