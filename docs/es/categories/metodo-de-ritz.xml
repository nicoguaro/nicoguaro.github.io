<?xml version="1.0" encoding="utf-8"?>
<?xml-stylesheet type="text/xsl" href="../../assets/xml/rss.xsl" media="all"?><rss version="2.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Nicolás' blog (Publicaciones sobre método de ritz)</title><link>https://nicoguaro.github.io/</link><description></description><atom:link href="https://nicoguaro.github.io/es/categories/metodo-de-ritz.xml" rel="self" type="application/rss+xml"></atom:link><language>es</language><copyright>Contents © 2025 &lt;a href="mailto:nicoguarin@gmail.com"&gt;Nicolás Guarín-Zapata&lt;/a&gt; 
&lt;a rel="license" href="http://creativecommons.org/licenses/by/4.0/"&gt;
&lt;img alt="Creative Commons License"
style="border-width:0"
src="https://i.creativecommons.org/l/by/4.0/88x31.png"&gt;&lt;/a&gt;</copyright><lastBuildDate>Fri, 28 Feb 2025 03:50:49 GMT</lastBuildDate><generator>Nikola (getnikola.com)</generator><docs>http://blogs.law.harvard.edu/tech/rss</docs><item><title>Reto de métodos numéricos: Día 23</title><link>https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-23/</link><dc:creator>Nicolás Guarín-Zapata</dc:creator><description>&lt;p&gt;Durante octubre (2017) estaré escribiendo un programa por día para algunos
métodos numéricos famosos en Python y Julia. Esto está pensado como
un ejercicio, no esperen que el código sea lo suficientemente bueno para
usarse en la "vida real". Además, también debo mencionar que casi que no
tengo experiencia con Julia, así que probablemente no escriba un Julia
idiomático y se parezca más a Python.&lt;/p&gt;
&lt;section id="metodo-de-ritz"&gt;
&lt;h2&gt;Método de Ritz&lt;/h2&gt;
&lt;p&gt;Hoy tenemos el &lt;a class="reference external" href="https://en.wikipedia.org/wiki/Ritz_method"&gt;método de Ritz&lt;/a&gt;
para resolver la ecuación:&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
\frac{d^2 u}{dx^2} = f(x)
\end{equation*}
&lt;/div&gt;
&lt;p&gt;con&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
u(0) = u(1)  = 0
\end{equation*}
&lt;/div&gt;
&lt;p&gt;El método consiste en formar un funcional que es &lt;em&gt;equivalente&lt;/em&gt; a la ecuación
diferencial, proponer una aproximación como una combinación lineal de un
conjunto de funciones base y encontrar el &lt;em&gt;mejor&lt;/em&gt; conjunto de coeficientes
para esta combinación. Este &lt;em&gt;mejor&lt;/em&gt; solución se encuentra minimizando el
funcional.&lt;/p&gt;
&lt;p&gt;El funcional para esta ecuación diferencial es&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
\Pi[u] = -\int_{0}^{1} \left(\frac{d u}{d x}\right)^2 dx
         -\int_{0}^{1}  u f(x) dx
\end{equation*}
&lt;/div&gt;
&lt;p&gt;En este caso, estamos usando la aproximación&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
\hat{u}(x) = x (1 - x)\sum_{n=0}^{N} c_n x^n\, ,
\end{equation*}
&lt;/div&gt;
&lt;p&gt;en donde escogimos el factor &lt;span class="math"&gt;\(x (1 - x)\)&lt;/span&gt; para forzar que las funciones
satisfagan las condiciones de frontera. El funcional aproximado es&lt;/p&gt;
&lt;div class="math"&gt;
\begin{align*}
\Pi[\hat{u}] = -\sum_{n=0}^{N} \sum_{m=0}^{N} c_n c_m
    \left[\frac{2 + 2m + 2n + 2mn}{(n + m + 1)(n + m + 2)(n + m +3)}\right]
    -\\ \sum_{n=0}^{N} c_n\int_{0}^{1} x^{n + 1}(1 - x) f(x) dx
\end{align*}
&lt;/div&gt;
&lt;p&gt;en donde, en general, necesitamos realizar una integración numérica para el
segundo término.&lt;/p&gt;
&lt;p&gt;Minimizando el funcional&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
\frac{\partial \Pi[\hat{u}]}{\partial c_m} = 0\, ,
\end{equation*}
&lt;/div&gt;
&lt;p&gt;obtenmos el siguiente sistema de ecuaciones&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
[K]\{\mathbf{c}\} = \{\mathbf{b}\}
\end{equation*}
&lt;/div&gt;
&lt;p&gt;con&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
K_{mn} = \frac{2 + 2m + 2n + 2mn}{(n + m + 1)(n + m + 2)(n + m +3)}
\end{equation*}
&lt;/div&gt;
&lt;p&gt;y&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
b_m = -\int_{0}^{1} x^{m + 1}(1 - x) f(x) dx\, .
\end{equation*}
&lt;/div&gt;
&lt;p&gt;Probaremos la implementación con la función &lt;span class="math"&gt;\(f(x) = x^3\)&lt;/span&gt;, que
lleva a la solución&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
u(x) = \frac{x (x^4 - 1)}{20}
\end{equation*}
&lt;/div&gt;
&lt;p&gt;A continuación se presenta el código.&lt;/p&gt;
&lt;section id="python"&gt;
&lt;h3&gt;Python&lt;/h3&gt;
&lt;div class="code"&gt;&lt;pre class="code python"&gt;&lt;a id="rest_code_72488ba91f524e5c88f48aae14f9fbfc-1" name="rest_code_72488ba91f524e5c88f48aae14f9fbfc-1" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-23/#rest_code_72488ba91f524e5c88f48aae14f9fbfc-1"&gt;&lt;/a&gt;&lt;span class="kn"&gt;from&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nn"&gt;__future__&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;division&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;print_function&lt;/span&gt;
&lt;a id="rest_code_72488ba91f524e5c88f48aae14f9fbfc-2" name="rest_code_72488ba91f524e5c88f48aae14f9fbfc-2" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-23/#rest_code_72488ba91f524e5c88f48aae14f9fbfc-2"&gt;&lt;/a&gt;&lt;span class="kn"&gt;import&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nn"&gt;numpy&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;as&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nn"&gt;np&lt;/span&gt;
&lt;a id="rest_code_72488ba91f524e5c88f48aae14f9fbfc-3" name="rest_code_72488ba91f524e5c88f48aae14f9fbfc-3" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-23/#rest_code_72488ba91f524e5c88f48aae14f9fbfc-3"&gt;&lt;/a&gt;&lt;span class="kn"&gt;from&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nn"&gt;scipy.integrate&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;quad&lt;/span&gt;
&lt;a id="rest_code_72488ba91f524e5c88f48aae14f9fbfc-4" name="rest_code_72488ba91f524e5c88f48aae14f9fbfc-4" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-23/#rest_code_72488ba91f524e5c88f48aae14f9fbfc-4"&gt;&lt;/a&gt;&lt;span class="kn"&gt;from&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nn"&gt;scipy.linalg&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;solve&lt;/span&gt;
&lt;a id="rest_code_72488ba91f524e5c88f48aae14f9fbfc-5" name="rest_code_72488ba91f524e5c88f48aae14f9fbfc-5" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-23/#rest_code_72488ba91f524e5c88f48aae14f9fbfc-5"&gt;&lt;/a&gt;&lt;span class="kn"&gt;import&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nn"&gt;matplotlib.pyplot&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;as&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nn"&gt;plt&lt;/span&gt;
&lt;a id="rest_code_72488ba91f524e5c88f48aae14f9fbfc-6" name="rest_code_72488ba91f524e5c88f48aae14f9fbfc-6" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-23/#rest_code_72488ba91f524e5c88f48aae14f9fbfc-6"&gt;&lt;/a&gt;
&lt;a id="rest_code_72488ba91f524e5c88f48aae14f9fbfc-7" name="rest_code_72488ba91f524e5c88f48aae14f9fbfc-7" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-23/#rest_code_72488ba91f524e5c88f48aae14f9fbfc-7"&gt;&lt;/a&gt;
&lt;a id="rest_code_72488ba91f524e5c88f48aae14f9fbfc-8" name="rest_code_72488ba91f524e5c88f48aae14f9fbfc-8" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-23/#rest_code_72488ba91f524e5c88f48aae14f9fbfc-8"&gt;&lt;/a&gt;&lt;span class="k"&gt;def&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nf"&gt;ritz&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;source&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_72488ba91f524e5c88f48aae14f9fbfc-9" name="rest_code_72488ba91f524e5c88f48aae14f9fbfc-9" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-23/#rest_code_72488ba91f524e5c88f48aae14f9fbfc-9"&gt;&lt;/a&gt;    &lt;span class="n"&gt;stiff_mat&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_72488ba91f524e5c88f48aae14f9fbfc-10" name="rest_code_72488ba91f524e5c88f48aae14f9fbfc-10" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-23/#rest_code_72488ba91f524e5c88f48aae14f9fbfc-10"&gt;&lt;/a&gt;    &lt;span class="n"&gt;rhs&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_72488ba91f524e5c88f48aae14f9fbfc-11" name="rest_code_72488ba91f524e5c88f48aae14f9fbfc-11" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-23/#rest_code_72488ba91f524e5c88f48aae14f9fbfc-11"&gt;&lt;/a&gt;    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;row&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_72488ba91f524e5c88f48aae14f9fbfc-12" name="rest_code_72488ba91f524e5c88f48aae14f9fbfc-12" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-23/#rest_code_72488ba91f524e5c88f48aae14f9fbfc-12"&gt;&lt;/a&gt;        &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;col&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_72488ba91f524e5c88f48aae14f9fbfc-13" name="rest_code_72488ba91f524e5c88f48aae14f9fbfc-13" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-23/#rest_code_72488ba91f524e5c88f48aae14f9fbfc-13"&gt;&lt;/a&gt;            &lt;span class="n"&gt;numer&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;row&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;col&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;row&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_72488ba91f524e5c88f48aae14f9fbfc-14" name="rest_code_72488ba91f524e5c88f48aae14f9fbfc-14" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-23/#rest_code_72488ba91f524e5c88f48aae14f9fbfc-14"&gt;&lt;/a&gt;            &lt;span class="n"&gt;denom&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;row&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;col&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;row&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;col&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;row&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;col&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_72488ba91f524e5c88f48aae14f9fbfc-15" name="rest_code_72488ba91f524e5c88f48aae14f9fbfc-15" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-23/#rest_code_72488ba91f524e5c88f48aae14f9fbfc-15"&gt;&lt;/a&gt;            &lt;span class="n"&gt;stiff_mat&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;row&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;numer&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;denom&lt;/span&gt;
&lt;a id="rest_code_72488ba91f524e5c88f48aae14f9fbfc-16" name="rest_code_72488ba91f524e5c88f48aae14f9fbfc-16" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-23/#rest_code_72488ba91f524e5c88f48aae14f9fbfc-16"&gt;&lt;/a&gt;        &lt;span class="n"&gt;fun&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;lambda&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;row&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;source&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_72488ba91f524e5c88f48aae14f9fbfc-17" name="rest_code_72488ba91f524e5c88f48aae14f9fbfc-17" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-23/#rest_code_72488ba91f524e5c88f48aae14f9fbfc-17"&gt;&lt;/a&gt;        &lt;span class="n"&gt;rhs&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;row&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;_&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;quad&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;fun&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_72488ba91f524e5c88f48aae14f9fbfc-18" name="rest_code_72488ba91f524e5c88f48aae14f9fbfc-18" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-23/#rest_code_72488ba91f524e5c88f48aae14f9fbfc-18"&gt;&lt;/a&gt;    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;stiff_mat&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;rhs&lt;/span&gt;
&lt;a id="rest_code_72488ba91f524e5c88f48aae14f9fbfc-19" name="rest_code_72488ba91f524e5c88f48aae14f9fbfc-19" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-23/#rest_code_72488ba91f524e5c88f48aae14f9fbfc-19"&gt;&lt;/a&gt;
&lt;a id="rest_code_72488ba91f524e5c88f48aae14f9fbfc-20" name="rest_code_72488ba91f524e5c88f48aae14f9fbfc-20" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-23/#rest_code_72488ba91f524e5c88f48aae14f9fbfc-20"&gt;&lt;/a&gt;
&lt;a id="rest_code_72488ba91f524e5c88f48aae14f9fbfc-21" name="rest_code_72488ba91f524e5c88f48aae14f9fbfc-21" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-23/#rest_code_72488ba91f524e5c88f48aae14f9fbfc-21"&gt;&lt;/a&gt;&lt;span class="n"&gt;N&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;
&lt;a id="rest_code_72488ba91f524e5c88f48aae14f9fbfc-22" name="rest_code_72488ba91f524e5c88f48aae14f9fbfc-22" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-23/#rest_code_72488ba91f524e5c88f48aae14f9fbfc-22"&gt;&lt;/a&gt;&lt;span class="n"&gt;source&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;lambda&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;
&lt;a id="rest_code_72488ba91f524e5c88f48aae14f9fbfc-23" name="rest_code_72488ba91f524e5c88f48aae14f9fbfc-23" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-23/#rest_code_72488ba91f524e5c88f48aae14f9fbfc-23"&gt;&lt;/a&gt;&lt;span class="n"&gt;mat&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;rhs&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;ritz&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;source&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_72488ba91f524e5c88f48aae14f9fbfc-24" name="rest_code_72488ba91f524e5c88f48aae14f9fbfc-24" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-23/#rest_code_72488ba91f524e5c88f48aae14f9fbfc-24"&gt;&lt;/a&gt;&lt;span class="n"&gt;c&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;solve&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;mat&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;rhs&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_72488ba91f524e5c88f48aae14f9fbfc-25" name="rest_code_72488ba91f524e5c88f48aae14f9fbfc-25" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-23/#rest_code_72488ba91f524e5c88f48aae14f9fbfc-25"&gt;&lt;/a&gt;&lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;linspace&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;100&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_72488ba91f524e5c88f48aae14f9fbfc-26" name="rest_code_72488ba91f524e5c88f48aae14f9fbfc-26" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-23/#rest_code_72488ba91f524e5c88f48aae14f9fbfc-26"&gt;&lt;/a&gt;&lt;span class="n"&gt;y&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros_like&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_72488ba91f524e5c88f48aae14f9fbfc-27" name="rest_code_72488ba91f524e5c88f48aae14f9fbfc-27" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-23/#rest_code_72488ba91f524e5c88f48aae14f9fbfc-27"&gt;&lt;/a&gt;&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;cont&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_72488ba91f524e5c88f48aae14f9fbfc-28" name="rest_code_72488ba91f524e5c88f48aae14f9fbfc-28" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-23/#rest_code_72488ba91f524e5c88f48aae14f9fbfc-28"&gt;&lt;/a&gt;    &lt;span class="n"&gt;y&lt;/span&gt; &lt;span class="o"&gt;+=&lt;/span&gt; &lt;span class="n"&gt;c&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;cont&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;cont&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_72488ba91f524e5c88f48aae14f9fbfc-29" name="rest_code_72488ba91f524e5c88f48aae14f9fbfc-29" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-23/#rest_code_72488ba91f524e5c88f48aae14f9fbfc-29"&gt;&lt;/a&gt;
&lt;a id="rest_code_72488ba91f524e5c88f48aae14f9fbfc-30" name="rest_code_72488ba91f524e5c88f48aae14f9fbfc-30" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-23/#rest_code_72488ba91f524e5c88f48aae14f9fbfc-30"&gt;&lt;/a&gt;&lt;span class="c1"&gt;#%% Plotting&lt;/span&gt;
&lt;a id="rest_code_72488ba91f524e5c88f48aae14f9fbfc-31" name="rest_code_72488ba91f524e5c88f48aae14f9fbfc-31" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-23/#rest_code_72488ba91f524e5c88f48aae14f9fbfc-31"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;figure&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;figsize&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_72488ba91f524e5c88f48aae14f9fbfc-32" name="rest_code_72488ba91f524e5c88f48aae14f9fbfc-32" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-23/#rest_code_72488ba91f524e5c88f48aae14f9fbfc-32"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;plot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_72488ba91f524e5c88f48aae14f9fbfc-33" name="rest_code_72488ba91f524e5c88f48aae14f9fbfc-33" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-23/#rest_code_72488ba91f524e5c88f48aae14f9fbfc-33"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;plot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="mi"&gt;20&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;linestyle&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;"dashed"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_72488ba91f524e5c88f48aae14f9fbfc-34" name="rest_code_72488ba91f524e5c88f48aae14f9fbfc-34" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-23/#rest_code_72488ba91f524e5c88f48aae14f9fbfc-34"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="sa"&gt;r&lt;/span&gt;&lt;span class="s2"&gt;"$x$"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_72488ba91f524e5c88f48aae14f9fbfc-35" name="rest_code_72488ba91f524e5c88f48aae14f9fbfc-35" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-23/#rest_code_72488ba91f524e5c88f48aae14f9fbfc-35"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ylabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="sa"&gt;r&lt;/span&gt;&lt;span class="s2"&gt;"$y$"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_72488ba91f524e5c88f48aae14f9fbfc-36" name="rest_code_72488ba91f524e5c88f48aae14f9fbfc-36" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-23/#rest_code_72488ba91f524e5c88f48aae14f9fbfc-36"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;legend&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="s2"&gt;"Ritz solution"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;"Exact solution"&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_72488ba91f524e5c88f48aae14f9fbfc-37" name="rest_code_72488ba91f524e5c88f48aae14f9fbfc-37" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-23/#rest_code_72488ba91f524e5c88f48aae14f9fbfc-37"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;tight_layout&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a id="rest_code_72488ba91f524e5c88f48aae14f9fbfc-38" name="rest_code_72488ba91f524e5c88f48aae14f9fbfc-38" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-23/#rest_code_72488ba91f524e5c88f48aae14f9fbfc-38"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;show&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/section&gt;
&lt;section id="julia"&gt;
&lt;h3&gt;Julia&lt;/h3&gt;
&lt;div class="code"&gt;&lt;pre class="code julia"&gt;&lt;a id="rest_code_520fca578fd2480c84fcd2ee68dae066-1" name="rest_code_520fca578fd2480c84fcd2ee68dae066-1" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-23/#rest_code_520fca578fd2480c84fcd2ee68dae066-1"&gt;&lt;/a&gt;&lt;span class="k"&gt;using&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;PyPlot&lt;/span&gt;
&lt;a id="rest_code_520fca578fd2480c84fcd2ee68dae066-2" name="rest_code_520fca578fd2480c84fcd2ee68dae066-2" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-23/#rest_code_520fca578fd2480c84fcd2ee68dae066-2"&gt;&lt;/a&gt;
&lt;a id="rest_code_520fca578fd2480c84fcd2ee68dae066-3" name="rest_code_520fca578fd2480c84fcd2ee68dae066-3" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-23/#rest_code_520fca578fd2480c84fcd2ee68dae066-3"&gt;&lt;/a&gt;
&lt;a id="rest_code_520fca578fd2480c84fcd2ee68dae066-4" name="rest_code_520fca578fd2480c84fcd2ee68dae066-4" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-23/#rest_code_520fca578fd2480c84fcd2ee68dae066-4"&gt;&lt;/a&gt;&lt;span class="k"&gt;function&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ritz&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;source&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_520fca578fd2480c84fcd2ee68dae066-5" name="rest_code_520fca578fd2480c84fcd2ee68dae066-5" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-23/#rest_code_520fca578fd2480c84fcd2ee68dae066-5"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;stiff_mat&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_520fca578fd2480c84fcd2ee68dae066-6" name="rest_code_520fca578fd2480c84fcd2ee68dae066-6" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-23/#rest_code_520fca578fd2480c84fcd2ee68dae066-6"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;rhs&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_520fca578fd2480c84fcd2ee68dae066-7" name="rest_code_520fca578fd2480c84fcd2ee68dae066-7" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-23/#rest_code_520fca578fd2480c84fcd2ee68dae066-7"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;for&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;row&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;in&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;
&lt;a id="rest_code_520fca578fd2480c84fcd2ee68dae066-8" name="rest_code_520fca578fd2480c84fcd2ee68dae066-8" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-23/#rest_code_520fca578fd2480c84fcd2ee68dae066-8"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="k"&gt;for&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;in&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;
&lt;a id="rest_code_520fca578fd2480c84fcd2ee68dae066-9" name="rest_code_520fca578fd2480c84fcd2ee68dae066-9" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-23/#rest_code_520fca578fd2480c84fcd2ee68dae066-9"&gt;&lt;/a&gt;&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="n"&gt;numer&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;row&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;row&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_520fca578fd2480c84fcd2ee68dae066-10" name="rest_code_520fca578fd2480c84fcd2ee68dae066-10" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-23/#rest_code_520fca578fd2480c84fcd2ee68dae066-10"&gt;&lt;/a&gt;&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="n"&gt;denom&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;row&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;row&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;row&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_520fca578fd2480c84fcd2ee68dae066-11" name="rest_code_520fca578fd2480c84fcd2ee68dae066-11" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-23/#rest_code_520fca578fd2480c84fcd2ee68dae066-11"&gt;&lt;/a&gt;&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="n"&gt;stiff_mat&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;row&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;numer&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;denom&lt;/span&gt;
&lt;a id="rest_code_520fca578fd2480c84fcd2ee68dae066-12" name="rest_code_520fca578fd2480c84fcd2ee68dae066-12" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-23/#rest_code_520fca578fd2480c84fcd2ee68dae066-12"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="k"&gt;end&lt;/span&gt;
&lt;a id="rest_code_520fca578fd2480c84fcd2ee68dae066-13" name="rest_code_520fca578fd2480c84fcd2ee68dae066-13" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-23/#rest_code_520fca578fd2480c84fcd2ee68dae066-13"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;fun&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;^&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;row&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;source&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_520fca578fd2480c84fcd2ee68dae066-14" name="rest_code_520fca578fd2480c84fcd2ee68dae066-14" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-23/#rest_code_520fca578fd2480c84fcd2ee68dae066-14"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;rhs&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;row&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;_&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;quadgk&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;fun&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_520fca578fd2480c84fcd2ee68dae066-15" name="rest_code_520fca578fd2480c84fcd2ee68dae066-15" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-23/#rest_code_520fca578fd2480c84fcd2ee68dae066-15"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;end&lt;/span&gt;
&lt;a id="rest_code_520fca578fd2480c84fcd2ee68dae066-16" name="rest_code_520fca578fd2480c84fcd2ee68dae066-16" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-23/#rest_code_520fca578fd2480c84fcd2ee68dae066-16"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;return&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;stiff_mat&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;rhs&lt;/span&gt;
&lt;a id="rest_code_520fca578fd2480c84fcd2ee68dae066-17" name="rest_code_520fca578fd2480c84fcd2ee68dae066-17" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-23/#rest_code_520fca578fd2480c84fcd2ee68dae066-17"&gt;&lt;/a&gt;&lt;span class="k"&gt;end&lt;/span&gt;
&lt;a id="rest_code_520fca578fd2480c84fcd2ee68dae066-18" name="rest_code_520fca578fd2480c84fcd2ee68dae066-18" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-23/#rest_code_520fca578fd2480c84fcd2ee68dae066-18"&gt;&lt;/a&gt;
&lt;a id="rest_code_520fca578fd2480c84fcd2ee68dae066-19" name="rest_code_520fca578fd2480c84fcd2ee68dae066-19" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-23/#rest_code_520fca578fd2480c84fcd2ee68dae066-19"&gt;&lt;/a&gt;
&lt;a id="rest_code_520fca578fd2480c84fcd2ee68dae066-20" name="rest_code_520fca578fd2480c84fcd2ee68dae066-20" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-23/#rest_code_520fca578fd2480c84fcd2ee68dae066-20"&gt;&lt;/a&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;
&lt;a id="rest_code_520fca578fd2480c84fcd2ee68dae066-21" name="rest_code_520fca578fd2480c84fcd2ee68dae066-21" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-23/#rest_code_520fca578fd2480c84fcd2ee68dae066-21"&gt;&lt;/a&gt;&lt;span class="n"&gt;source&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;^&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;
&lt;a id="rest_code_520fca578fd2480c84fcd2ee68dae066-22" name="rest_code_520fca578fd2480c84fcd2ee68dae066-22" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-23/#rest_code_520fca578fd2480c84fcd2ee68dae066-22"&gt;&lt;/a&gt;&lt;span class="n"&gt;mat&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;rhs&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ritz&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;source&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_520fca578fd2480c84fcd2ee68dae066-23" name="rest_code_520fca578fd2480c84fcd2ee68dae066-23" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-23/#rest_code_520fca578fd2480c84fcd2ee68dae066-23"&gt;&lt;/a&gt;&lt;span class="n"&gt;c&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;mat&lt;/span&gt;&lt;span class="o"&gt;\&lt;/span&gt;&lt;span class="n"&gt;rhs&lt;/span&gt;
&lt;a id="rest_code_520fca578fd2480c84fcd2ee68dae066-24" name="rest_code_520fca578fd2480c84fcd2ee68dae066-24" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-23/#rest_code_520fca578fd2480c84fcd2ee68dae066-24"&gt;&lt;/a&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;linspace&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;100&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_520fca578fd2480c84fcd2ee68dae066-25" name="rest_code_520fca578fd2480c84fcd2ee68dae066-25" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-23/#rest_code_520fca578fd2480c84fcd2ee68dae066-25"&gt;&lt;/a&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_520fca578fd2480c84fcd2ee68dae066-26" name="rest_code_520fca578fd2480c84fcd2ee68dae066-26" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-23/#rest_code_520fca578fd2480c84fcd2ee68dae066-26"&gt;&lt;/a&gt;&lt;span class="k"&gt;for&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;cont&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;in&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;
&lt;a id="rest_code_520fca578fd2480c84fcd2ee68dae066-27" name="rest_code_520fca578fd2480c84fcd2ee68dae066-27" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-23/#rest_code_520fca578fd2480c84fcd2ee68dae066-27"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;c&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;cont&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;.^&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;cont&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.*&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_520fca578fd2480c84fcd2ee68dae066-28" name="rest_code_520fca578fd2480c84fcd2ee68dae066-28" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-23/#rest_code_520fca578fd2480c84fcd2ee68dae066-28"&gt;&lt;/a&gt;&lt;span class="k"&gt;end&lt;/span&gt;
&lt;a id="rest_code_520fca578fd2480c84fcd2ee68dae066-29" name="rest_code_520fca578fd2480c84fcd2ee68dae066-29" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-23/#rest_code_520fca578fd2480c84fcd2ee68dae066-29"&gt;&lt;/a&gt;
&lt;a id="rest_code_520fca578fd2480c84fcd2ee68dae066-30" name="rest_code_520fca578fd2480c84fcd2ee68dae066-30" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-23/#rest_code_520fca578fd2480c84fcd2ee68dae066-30"&gt;&lt;/a&gt;&lt;span class="c"&gt;#%% Plotting&lt;/span&gt;
&lt;a id="rest_code_520fca578fd2480c84fcd2ee68dae066-31" name="rest_code_520fca578fd2480c84fcd2ee68dae066-31" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-23/#rest_code_520fca578fd2480c84fcd2ee68dae066-31"&gt;&lt;/a&gt;&lt;span class="n"&gt;figure&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;figsize&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_520fca578fd2480c84fcd2ee68dae066-32" name="rest_code_520fca578fd2480c84fcd2ee68dae066-32" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-23/#rest_code_520fca578fd2480c84fcd2ee68dae066-32"&gt;&lt;/a&gt;&lt;span class="n"&gt;plot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_520fca578fd2480c84fcd2ee68dae066-33" name="rest_code_520fca578fd2480c84fcd2ee68dae066-33" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-23/#rest_code_520fca578fd2480c84fcd2ee68dae066-33"&gt;&lt;/a&gt;&lt;span class="n"&gt;plot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;.*&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;.^&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="mi"&gt;20&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;linestyle&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;"dashed"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_520fca578fd2480c84fcd2ee68dae066-34" name="rest_code_520fca578fd2480c84fcd2ee68dae066-34" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-23/#rest_code_520fca578fd2480c84fcd2ee68dae066-34"&gt;&lt;/a&gt;&lt;span class="n"&gt;xlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="sa"&gt;L&lt;/span&gt;&lt;span class="s"&gt;"&lt;/span&gt;&lt;span class="si"&gt;$x&lt;/span&gt;&lt;span class="s"&gt;$"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_520fca578fd2480c84fcd2ee68dae066-35" name="rest_code_520fca578fd2480c84fcd2ee68dae066-35" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-23/#rest_code_520fca578fd2480c84fcd2ee68dae066-35"&gt;&lt;/a&gt;&lt;span class="n"&gt;ylabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="sa"&gt;L&lt;/span&gt;&lt;span class="s"&gt;"&lt;/span&gt;&lt;span class="si"&gt;$y&lt;/span&gt;&lt;span class="s"&gt;$"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_520fca578fd2480c84fcd2ee68dae066-36" name="rest_code_520fca578fd2480c84fcd2ee68dae066-36" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-23/#rest_code_520fca578fd2480c84fcd2ee68dae066-36"&gt;&lt;/a&gt;&lt;span class="n"&gt;legend&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="s"&gt;"Ritz solution"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s"&gt;"Exact solution"&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_520fca578fd2480c84fcd2ee68dae066-37" name="rest_code_520fca578fd2480c84fcd2ee68dae066-37" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-23/#rest_code_520fca578fd2480c84fcd2ee68dae066-37"&gt;&lt;/a&gt;&lt;span class="n"&gt;tight_layout&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a id="rest_code_520fca578fd2480c84fcd2ee68dae066-38" name="rest_code_520fca578fd2480c84fcd2ee68dae066-38" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-23/#rest_code_520fca578fd2480c84fcd2ee68dae066-38"&gt;&lt;/a&gt;&lt;span class="n"&gt;show&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Ambos tiene (casi) el mismo resultado y se muestra a continuación&lt;/p&gt;
&lt;img alt="Método de Ritz usando 2 términos." class="align-center" src="https://nicoguaro.github.io/images/ritz.svg" style="width: 400px;"&gt;
&lt;p&gt;Y si consideramos 3 términos en la expansion, obtenemos&lt;/p&gt;
&lt;img alt="Método de Ritz usando 3 términos." class="align-center" src="https://nicoguaro.github.io/images/ritz-N-3.svg" style="width: 400px;"&gt;
&lt;/section&gt;
&lt;section id="comparacion-python-julia"&gt;
&lt;h3&gt;Comparación Python/Julia&lt;/h3&gt;
&lt;p&gt;Respecto al número de líneas tenemos: 38 en Python y 38 en Julia.  La comparación
en tiempo de ejecución se realizó con el comando mágico de IPython &lt;code class="docutils literal"&gt;%timeit&lt;/code&gt;
y con &lt;code class="docutils literal"&gt;@benchmark&lt;/code&gt; en Julia.&lt;/p&gt;
&lt;p&gt;Para Python:&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code IPython"&gt;&lt;a id="rest_code_140fc144b8ff4ad987e9f4700cece78a-1" name="rest_code_140fc144b8ff4ad987e9f4700cece78a-1" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-23/#rest_code_140fc144b8ff4ad987e9f4700cece78a-1"&gt;&lt;/a&gt;&lt;span class="o"&gt;%%time&lt;/span&gt;it
&lt;a id="rest_code_140fc144b8ff4ad987e9f4700cece78a-2" name="rest_code_140fc144b8ff4ad987e9f4700cece78a-2" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-23/#rest_code_140fc144b8ff4ad987e9f4700cece78a-2"&gt;&lt;/a&gt;&lt;span class="n"&gt;mat&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;rhs&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;ritz&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;source&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_140fc144b8ff4ad987e9f4700cece78a-3" name="rest_code_140fc144b8ff4ad987e9f4700cece78a-3" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-23/#rest_code_140fc144b8ff4ad987e9f4700cece78a-3"&gt;&lt;/a&gt;&lt;span class="n"&gt;c&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;solve&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;mat&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;rhs&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;con resultado&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code text"&gt;&lt;a id="rest_code_208d60f9068e457baa59e34328a8e29a-1" name="rest_code_208d60f9068e457baa59e34328a8e29a-1" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-23/#rest_code_208d60f9068e457baa59e34328a8e29a-1"&gt;&lt;/a&gt;1000 loops, best of 3: 228 µs per loop
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Para Julia:&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code julia"&gt;&lt;a id="rest_code_097d6dd9b07649d8bb1508b99c02756d-1" name="rest_code_097d6dd9b07649d8bb1508b99c02756d-1" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-23/#rest_code_097d6dd9b07649d8bb1508b99c02756d-1"&gt;&lt;/a&gt;&lt;span class="k"&gt;function&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;bench&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a id="rest_code_097d6dd9b07649d8bb1508b99c02756d-2" name="rest_code_097d6dd9b07649d8bb1508b99c02756d-2" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-23/#rest_code_097d6dd9b07649d8bb1508b99c02756d-2"&gt;&lt;/a&gt;&lt;span class="w"&gt;   &lt;/span&gt;&lt;span class="n"&gt;mat&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;rhs&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ritz&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;source&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_097d6dd9b07649d8bb1508b99c02756d-3" name="rest_code_097d6dd9b07649d8bb1508b99c02756d-3" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-23/#rest_code_097d6dd9b07649d8bb1508b99c02756d-3"&gt;&lt;/a&gt;&lt;span class="w"&gt;   &lt;/span&gt;&lt;span class="n"&gt;c&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;mat&lt;/span&gt;&lt;span class="o"&gt;\&lt;/span&gt;&lt;span class="n"&gt;rhs&lt;/span&gt;
&lt;a id="rest_code_097d6dd9b07649d8bb1508b99c02756d-4" name="rest_code_097d6dd9b07649d8bb1508b99c02756d-4" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-23/#rest_code_097d6dd9b07649d8bb1508b99c02756d-4"&gt;&lt;/a&gt;&lt;span class="k"&gt;end&lt;/span&gt;
&lt;a id="rest_code_097d6dd9b07649d8bb1508b99c02756d-5" name="rest_code_097d6dd9b07649d8bb1508b99c02756d-5" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-23/#rest_code_097d6dd9b07649d8bb1508b99c02756d-5"&gt;&lt;/a&gt;&lt;span class="nd"&gt;@benchmark&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;bench&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;con resultado&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code julia"&gt;&lt;a id="rest_code_7cd569be9580455380f630e7407baa9e-1" name="rest_code_7cd569be9580455380f630e7407baa9e-1" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-23/#rest_code_7cd569be9580455380f630e7407baa9e-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;BenchmarkTools&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Trial&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
&lt;a id="rest_code_7cd569be9580455380f630e7407baa9e-2" name="rest_code_7cd569be9580455380f630e7407baa9e-2" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-23/#rest_code_7cd569be9580455380f630e7407baa9e-2"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;memory&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;estimate&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="mf"&gt;6.56&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;KiB&lt;/span&gt;
&lt;a id="rest_code_7cd569be9580455380f630e7407baa9e-3" name="rest_code_7cd569be9580455380f630e7407baa9e-3" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-23/#rest_code_7cd569be9580455380f630e7407baa9e-3"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;allocs&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;estimate&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="mi"&gt;340&lt;/span&gt;
&lt;a id="rest_code_7cd569be9580455380f630e7407baa9e-4" name="rest_code_7cd569be9580455380f630e7407baa9e-4" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-23/#rest_code_7cd569be9580455380f630e7407baa9e-4"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="o"&gt;--------------&lt;/span&gt;
&lt;a id="rest_code_7cd569be9580455380f630e7407baa9e-5" name="rest_code_7cd569be9580455380f630e7407baa9e-5" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-23/#rest_code_7cd569be9580455380f630e7407baa9e-5"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;minimum&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;     &lt;/span&gt;&lt;span class="mf"&gt;13.527&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;μs&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;0.00&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;GC&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_7cd569be9580455380f630e7407baa9e-6" name="rest_code_7cd569be9580455380f630e7407baa9e-6" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-23/#rest_code_7cd569be9580455380f630e7407baa9e-6"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;median&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="mf"&gt;15.927&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;μs&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;0.00&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;GC&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_7cd569be9580455380f630e7407baa9e-7" name="rest_code_7cd569be9580455380f630e7407baa9e-7" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-23/#rest_code_7cd569be9580455380f630e7407baa9e-7"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;mean&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="mf"&gt;17.133&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;μs&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;4.50&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;GC&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_7cd569be9580455380f630e7407baa9e-8" name="rest_code_7cd569be9580455380f630e7407baa9e-8" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-23/#rest_code_7cd569be9580455380f630e7407baa9e-8"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;maximum&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;     &lt;/span&gt;&lt;span class="mf"&gt;2.807&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ms&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;97.36&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;GC&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_7cd569be9580455380f630e7407baa9e-9" name="rest_code_7cd569be9580455380f630e7407baa9e-9" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-23/#rest_code_7cd569be9580455380f630e7407baa9e-9"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="o"&gt;--------------&lt;/span&gt;
&lt;a id="rest_code_7cd569be9580455380f630e7407baa9e-10" name="rest_code_7cd569be9580455380f630e7407baa9e-10" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-23/#rest_code_7cd569be9580455380f630e7407baa9e-10"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;samples&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;          &lt;/span&gt;&lt;span class="mi"&gt;10000&lt;/span&gt;
&lt;a id="rest_code_7cd569be9580455380f630e7407baa9e-11" name="rest_code_7cd569be9580455380f630e7407baa9e-11" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-23/#rest_code_7cd569be9580455380f630e7407baa9e-11"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;evals&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;sample&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;     &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;En este caso, podemos decir que el código de Python es alrededor de 14 veces
más lento que el de Julia.&lt;/p&gt;
&lt;/section&gt;
&lt;/section&gt;</description><category>computación científica</category><category>julia</category><category>método de ritz</category><category>métodos numéricos</category><category>python</category><guid>https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-23/</guid><pubDate>Tue, 24 Oct 2017 01:30:03 GMT</pubDate></item></channel></rss>