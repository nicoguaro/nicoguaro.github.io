<?xml version="1.0" encoding="utf-8"?>
<?xml-stylesheet type="text/xsl" href="../../assets/xml/rss.xsl" media="all"?><rss version="2.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Nicolás' blog (Publicaciones sobre computación científica)</title><link>https://nicoguaro.github.io/</link><description></description><atom:link href="https://nicoguaro.github.io/es/categories/computacion-cientifica.xml" rel="self" type="application/rss+xml"></atom:link><language>es</language><copyright>Contents © 2022 &lt;a href="mailto:nicoguarin@gmail.com"&gt;Nicolás Guarín-Zapata&lt;/a&gt; 
&lt;a rel="license" href="http://creativecommons.org/licenses/by/4.0/"&gt;
&lt;img alt="Creative Commons License"
style="border-width:0"
src="https://i.creativecommons.org/l/by/4.0/88x31.png"&gt;&lt;/a&gt;</copyright><lastBuildDate>Wed, 30 Nov 2022 22:22:05 GMT</lastBuildDate><generator>Nikola (getnikola.com)</generator><docs>http://blogs.law.harvard.edu/tech/rss</docs><item><title>Regresando al Método de elementos de frontera</title><link>https://nicoguaro.github.io/es/posts/bem_corrected/</link><dc:creator>Nicolás Guarín-Zapata</dc:creator><description>&lt;p&gt;Durante octubre (2017) estuve escribiendo un programa por día para algunos
métodos numéricos famosos en Python y Julia. Esto estaba pensado como
un ejercicio para aprender Julia. Puedne ver un  &lt;a class="reference external" href="https://nicoguaro.github.io/es/posts/numerical_summary"&gt;resumen aquí&lt;/a&gt;.
Tuve éxito en 30 de los retos, exceptuando por el BEM
(&lt;a class="reference external" href="https://en.wikipedia.org/wiki/Boundary_element_method"&gt;Método de elementos de frontera, en inglés&lt;/a&gt;),
donde no pude encontrar que hice mal ese día. La publicación original está
&lt;a class="reference external" href="https://nicoguaro.github.io/es/posts/numerical-26"&gt;aquí&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Thomas Klimpel encontró el error y me escribió un email describiendo lo
que estaba mal. Entonces, estoy creando esta publicación con la implementación
correcta del BEM.&lt;/p&gt;
&lt;section id="el-metodo-de-elementos-de-frontera"&gt;
&lt;h2&gt;El Método de Elementos de Frontera&lt;/h2&gt;
&lt;p&gt;Queremos rsolver la ecuación&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
\nabla^2 u = -f(x, y)\quad \forall (x, y) \in \Omega\, ,
\end{equation*}
&lt;/div&gt;
&lt;p&gt;con&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
u(x) = g(x, y), \quad \forall (x, y)\in \partial \Omega \, .
\end{equation*}
&lt;/div&gt;
&lt;p&gt;Para este método, necesitamos usar la representación integral de la ecuación,
que, en este caso, es&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
u(\boldsymbol{\xi})  = \int_{S} [u(\mathbf{x}) F(\mathbf{x}, \boldsymbol{\xi})
    - q(\mathbf{x})G(\mathbf{x}, \boldsymbol{\xi})]\mathrm{d}S(\mathbf{x})
    + \int_{V} f(\mathbf{x}) G(\mathbf{x}, \boldsymbol{\xi}) \mathrm{d}V(\mathbf{x})
\end{equation*}
&lt;/div&gt;
&lt;p&gt;con&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
G(\mathbf{x}, \boldsymbol{\xi})= -\frac{1}{2\pi}\ln|\mathbf{x} - \xi|
\end{equation*}
&lt;/div&gt;
&lt;p&gt;y&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
F(\mathbf{x}, \boldsymbol{\xi}) =
  -\frac{1}{2\pi |\mathbf{x} - \boldsymbol{\xi}|^2}
  (\mathbf{x} - \boldsymbol{\xi})\cdot\hat{\mathbf{n}}
\end{equation*}
&lt;/div&gt;
&lt;p&gt;Entonces, podemos formar un sistema de ecuaciones&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
[G]\{q\} = [F]\{u\}\, ,
\end{equation*}
&lt;/div&gt;
&lt;p&gt;que obtenemos discretizando la frontera. Si tomamos variables constantes en
la discretización, las integrales se pueden calcular analíticamente&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
G_{nm} = -\frac{1}{2\pi}\left[r \sin\theta\left(\ln|r| - 1\right)
         + \theta r\cos\theta\right]^{\theta_B, r_B}_{\theta_A, r_A}
\end{equation*}
&lt;/div&gt;
&lt;p&gt;y&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
F_{nm} = \left[\frac{\theta}{2\pi}\right]^{\theta_B}_{\theta_A}
\end{equation*}
&lt;/div&gt;
&lt;p&gt;para puntos &lt;span class="math"&gt;\(n\)&lt;/span&gt; y &lt;span class="math"&gt;\(m\)&lt;/span&gt; en diferentos elementos, y los subíndices
&lt;span class="math"&gt;\(A, B\)&lt;/span&gt; se refieren a los puntos finales del elemento de evaluación.
Debemos tener cuidado al evaluar esta expresión ya que &lt;span class="math"&gt;\(r_A\)&lt;/span&gt; y &lt;span class="math"&gt;\(r_B\)&lt;/span&gt;
pueden ser (casi) cero y hacer que &lt;em&gt;explote&lt;/em&gt;. Además, aquí es donde estaba el
problema principal ya que olvidé calcular los ángulos para elements que están,
en general, no alineados con los ejes vertical u horizontal.&lt;/p&gt;
&lt;p&gt;Para los términos en la diagonal las integrales se evalúan como&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
G_{nn} = -\frac{L}{2\pi}\left(\ln\left\vert\frac{L}{2}\right\vert - 1\right)
\end{equation*}
&lt;/div&gt;
&lt;p&gt;y&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
F_{nn} = - \frac{1}{2}
\end{equation*}
&lt;/div&gt;
&lt;p&gt;con &lt;span class="math"&gt;\(L\)&lt;/span&gt; el tamaño del elemento.&lt;/p&gt;
&lt;p&gt;A continuación está el código. Tengan en cuenta que este código funciona para
problemas puramente de Dirichlet. Para problemas mixtos Dirichlet-Neumann,
las matrices de influencia deben reordenarse para separar las incógnitas de
las variables conocidas en lados opuestos de la ecuación.&lt;/p&gt;
&lt;p&gt;Pueden descargar los archivos para este  &lt;a class="reference external" href="https://nicoguaro.github.io/downloads/bem.zip"&gt;proyecto aquí&lt;/a&gt;.
Se incluye un archivo YML para crear un ambiente de conda con la lista de
dependencias. Por ejemplo, se usa la versión 3.0 de
&lt;a class="reference external" href="https://github.com/nschloe/meshio"&gt;Meshio&lt;/a&gt;.&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code python"&gt;&lt;a id="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-1" name="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-1" href="https://nicoguaro.github.io/es/posts/bem_corrected/#rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-1"&gt;&lt;/a&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;numpy&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;np&lt;/span&gt;
&lt;a id="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-2" name="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-2" href="https://nicoguaro.github.io/es/posts/bem_corrected/#rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-2"&gt;&lt;/a&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;numpy&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;log&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;arctan2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;pi&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;mean&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;arctan&lt;/span&gt;
&lt;a id="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-3" name="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-3" href="https://nicoguaro.github.io/es/posts/bem_corrected/#rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-3"&gt;&lt;/a&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;numpy.linalg&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;norm&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;solve&lt;/span&gt;
&lt;a id="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-4" name="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-4" href="https://nicoguaro.github.io/es/posts/bem_corrected/#rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-4"&gt;&lt;/a&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;matplotlib.pyplot&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;plt&lt;/span&gt;
&lt;a id="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-5" name="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-5" href="https://nicoguaro.github.io/es/posts/bem_corrected/#rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-5"&gt;&lt;/a&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;mpl_toolkits.mplot3d&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;Axes3D&lt;/span&gt;
&lt;a id="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-6" name="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-6" href="https://nicoguaro.github.io/es/posts/bem_corrected/#rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-6"&gt;&lt;/a&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;meshio&lt;/span&gt;
&lt;a id="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-7" name="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-7" href="https://nicoguaro.github.io/es/posts/bem_corrected/#rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-7"&gt;&lt;/a&gt;
&lt;a id="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-8" name="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-8" href="https://nicoguaro.github.io/es/posts/bem_corrected/#rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-8"&gt;&lt;/a&gt;
&lt;a id="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-9" name="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-9" href="https://nicoguaro.github.io/es/posts/bem_corrected/#rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-9"&gt;&lt;/a&gt;  &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;assem&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;elems&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-10" name="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-10" href="https://nicoguaro.github.io/es/posts/bem_corrected/#rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-10"&gt;&lt;/a&gt;      &lt;span class="sd"&gt;"""Assembly matrices for the BEM problem&lt;/span&gt;
&lt;a id="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-11" name="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-11" href="https://nicoguaro.github.io/es/posts/bem_corrected/#rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-11"&gt;&lt;/a&gt;
&lt;a id="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-12" name="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-12" href="https://nicoguaro.github.io/es/posts/bem_corrected/#rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-12"&gt;&lt;/a&gt;&lt;span class="sd"&gt;      Parameters&lt;/span&gt;
&lt;a id="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-13" name="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-13" href="https://nicoguaro.github.io/es/posts/bem_corrected/#rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-13"&gt;&lt;/a&gt;&lt;span class="sd"&gt;      ----------&lt;/span&gt;
&lt;a id="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-14" name="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-14" href="https://nicoguaro.github.io/es/posts/bem_corrected/#rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-14"&gt;&lt;/a&gt;&lt;span class="sd"&gt;      coords : ndarray, float&lt;/span&gt;
&lt;a id="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-15" name="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-15" href="https://nicoguaro.github.io/es/posts/bem_corrected/#rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-15"&gt;&lt;/a&gt;&lt;span class="sd"&gt;          Coordinates for the nodes.&lt;/span&gt;
&lt;a id="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-16" name="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-16" href="https://nicoguaro.github.io/es/posts/bem_corrected/#rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-16"&gt;&lt;/a&gt;&lt;span class="sd"&gt;      elems : ndarray, int&lt;/span&gt;
&lt;a id="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-17" name="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-17" href="https://nicoguaro.github.io/es/posts/bem_corrected/#rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-17"&gt;&lt;/a&gt;&lt;span class="sd"&gt;          Connectivity for the elements.&lt;/span&gt;
&lt;a id="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-18" name="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-18" href="https://nicoguaro.github.io/es/posts/bem_corrected/#rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-18"&gt;&lt;/a&gt;
&lt;a id="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-19" name="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-19" href="https://nicoguaro.github.io/es/posts/bem_corrected/#rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-19"&gt;&lt;/a&gt;&lt;span class="sd"&gt;      Returns&lt;/span&gt;
&lt;a id="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-20" name="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-20" href="https://nicoguaro.github.io/es/posts/bem_corrected/#rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-20"&gt;&lt;/a&gt;&lt;span class="sd"&gt;      -------&lt;/span&gt;
&lt;a id="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-21" name="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-21" href="https://nicoguaro.github.io/es/posts/bem_corrected/#rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-21"&gt;&lt;/a&gt;&lt;span class="sd"&gt;      Gmat : ndarray, float&lt;/span&gt;
&lt;a id="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-22" name="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-22" href="https://nicoguaro.github.io/es/posts/bem_corrected/#rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-22"&gt;&lt;/a&gt;&lt;span class="sd"&gt;          Influence matrix for the flow.&lt;/span&gt;
&lt;a id="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-23" name="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-23" href="https://nicoguaro.github.io/es/posts/bem_corrected/#rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-23"&gt;&lt;/a&gt;&lt;span class="sd"&gt;      Fmat : ndarray, float&lt;/span&gt;
&lt;a id="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-24" name="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-24" href="https://nicoguaro.github.io/es/posts/bem_corrected/#rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-24"&gt;&lt;/a&gt;&lt;span class="sd"&gt;          Influence matrix for primary variable.&lt;/span&gt;
&lt;a id="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-25" name="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-25" href="https://nicoguaro.github.io/es/posts/bem_corrected/#rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-25"&gt;&lt;/a&gt;&lt;span class="sd"&gt;      """&lt;/span&gt;
&lt;a id="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-26" name="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-26" href="https://nicoguaro.github.io/es/posts/bem_corrected/#rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-26"&gt;&lt;/a&gt;      &lt;span class="n"&gt;nelems&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;elems&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;shape&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-27" name="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-27" href="https://nicoguaro.github.io/es/posts/bem_corrected/#rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-27"&gt;&lt;/a&gt;      &lt;span class="n"&gt;Gmat&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="n"&gt;nelems&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;nelems&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-28" name="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-28" href="https://nicoguaro.github.io/es/posts/bem_corrected/#rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-28"&gt;&lt;/a&gt;      &lt;span class="n"&gt;Fmat&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="n"&gt;nelems&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;nelems&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-29" name="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-29" href="https://nicoguaro.github.io/es/posts/bem_corrected/#rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-29"&gt;&lt;/a&gt;      &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;ev_cont&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;elem1&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;enumerate&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;elems&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-30" name="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-30" href="https://nicoguaro.github.io/es/posts/bem_corrected/#rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-30"&gt;&lt;/a&gt;          &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;col_cont&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;elem2&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;enumerate&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;elems&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-31" name="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-31" href="https://nicoguaro.github.io/es/posts/bem_corrected/#rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-31"&gt;&lt;/a&gt;              &lt;span class="n"&gt;pt_col&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;mean&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;elem2&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;axis&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-32" name="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-32" href="https://nicoguaro.github.io/es/posts/bem_corrected/#rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-32"&gt;&lt;/a&gt;              &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;ev_cont&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="n"&gt;col_cont&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a id="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-33" name="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-33" href="https://nicoguaro.github.io/es/posts/bem_corrected/#rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-33"&gt;&lt;/a&gt;                  &lt;span class="n"&gt;L&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;norm&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;elem1&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]]&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;elem1&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]])&lt;/span&gt;
&lt;a id="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-34" name="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-34" href="https://nicoguaro.github.io/es/posts/bem_corrected/#rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-34"&gt;&lt;/a&gt;                  &lt;span class="n"&gt;Gmat&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ev_cont&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;ev_cont&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;L&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;pi&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;log&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;L&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-35" name="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-35" href="https://nicoguaro.github.io/es/posts/bem_corrected/#rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-35"&gt;&lt;/a&gt;                  &lt;span class="n"&gt;Fmat&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ev_cont&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;ev_cont&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="mf"&gt;0.5&lt;/span&gt;
&lt;a id="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-36" name="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-36" href="https://nicoguaro.github.io/es/posts/bem_corrected/#rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-36"&gt;&lt;/a&gt;              &lt;span class="k"&gt;else&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a id="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-37" name="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-37" href="https://nicoguaro.github.io/es/posts/bem_corrected/#rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-37"&gt;&lt;/a&gt;                  &lt;span class="n"&gt;Gij&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;Fij&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;influence_coeff&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;elem1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;pt_col&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-38" name="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-38" href="https://nicoguaro.github.io/es/posts/bem_corrected/#rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-38"&gt;&lt;/a&gt;                  &lt;span class="n"&gt;Gmat&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ev_cont&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;col_cont&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Gij&lt;/span&gt;
&lt;a id="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-39" name="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-39" href="https://nicoguaro.github.io/es/posts/bem_corrected/#rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-39"&gt;&lt;/a&gt;                  &lt;span class="n"&gt;Fmat&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ev_cont&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;col_cont&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Fij&lt;/span&gt;
&lt;a id="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-40" name="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-40" href="https://nicoguaro.github.io/es/posts/bem_corrected/#rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-40"&gt;&lt;/a&gt;      &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;Gmat&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;Fmat&lt;/span&gt;
&lt;a id="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-41" name="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-41" href="https://nicoguaro.github.io/es/posts/bem_corrected/#rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-41"&gt;&lt;/a&gt;
&lt;a id="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-42" name="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-42" href="https://nicoguaro.github.io/es/posts/bem_corrected/#rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-42"&gt;&lt;/a&gt;
&lt;a id="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-43" name="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-43" href="https://nicoguaro.github.io/es/posts/bem_corrected/#rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-43"&gt;&lt;/a&gt;  &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;influence_coeff&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;elem&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;pt_col&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-44" name="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-44" href="https://nicoguaro.github.io/es/posts/bem_corrected/#rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-44"&gt;&lt;/a&gt;      &lt;span class="sd"&gt;"""Compute influence coefficients&lt;/span&gt;
&lt;a id="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-45" name="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-45" href="https://nicoguaro.github.io/es/posts/bem_corrected/#rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-45"&gt;&lt;/a&gt;
&lt;a id="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-46" name="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-46" href="https://nicoguaro.github.io/es/posts/bem_corrected/#rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-46"&gt;&lt;/a&gt;&lt;span class="sd"&gt;      Parameters&lt;/span&gt;
&lt;a id="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-47" name="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-47" href="https://nicoguaro.github.io/es/posts/bem_corrected/#rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-47"&gt;&lt;/a&gt;&lt;span class="sd"&gt;      ----------&lt;/span&gt;
&lt;a id="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-48" name="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-48" href="https://nicoguaro.github.io/es/posts/bem_corrected/#rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-48"&gt;&lt;/a&gt;&lt;span class="sd"&gt;      elems : ndarray, int&lt;/span&gt;
&lt;a id="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-49" name="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-49" href="https://nicoguaro.github.io/es/posts/bem_corrected/#rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-49"&gt;&lt;/a&gt;&lt;span class="sd"&gt;          Connectivity for the elements.&lt;/span&gt;
&lt;a id="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-50" name="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-50" href="https://nicoguaro.github.io/es/posts/bem_corrected/#rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-50"&gt;&lt;/a&gt;&lt;span class="sd"&gt;      coords : ndarray, float&lt;/span&gt;
&lt;a id="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-51" name="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-51" href="https://nicoguaro.github.io/es/posts/bem_corrected/#rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-51"&gt;&lt;/a&gt;&lt;span class="sd"&gt;          Coordinates for the nodes.&lt;/span&gt;
&lt;a id="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-52" name="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-52" href="https://nicoguaro.github.io/es/posts/bem_corrected/#rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-52"&gt;&lt;/a&gt;&lt;span class="sd"&gt;      pt_col : ndarray&lt;/span&gt;
&lt;a id="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-53" name="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-53" href="https://nicoguaro.github.io/es/posts/bem_corrected/#rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-53"&gt;&lt;/a&gt;&lt;span class="sd"&gt;          Coordinates of the colocation point.&lt;/span&gt;
&lt;a id="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-54" name="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-54" href="https://nicoguaro.github.io/es/posts/bem_corrected/#rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-54"&gt;&lt;/a&gt;
&lt;a id="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-55" name="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-55" href="https://nicoguaro.github.io/es/posts/bem_corrected/#rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-55"&gt;&lt;/a&gt;&lt;span class="sd"&gt;      Returns&lt;/span&gt;
&lt;a id="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-56" name="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-56" href="https://nicoguaro.github.io/es/posts/bem_corrected/#rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-56"&gt;&lt;/a&gt;&lt;span class="sd"&gt;      -------&lt;/span&gt;
&lt;a id="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-57" name="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-57" href="https://nicoguaro.github.io/es/posts/bem_corrected/#rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-57"&gt;&lt;/a&gt;&lt;span class="sd"&gt;      G_coeff : float&lt;/span&gt;
&lt;a id="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-58" name="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-58" href="https://nicoguaro.github.io/es/posts/bem_corrected/#rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-58"&gt;&lt;/a&gt;&lt;span class="sd"&gt;          Influence coefficient for flows.&lt;/span&gt;
&lt;a id="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-59" name="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-59" href="https://nicoguaro.github.io/es/posts/bem_corrected/#rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-59"&gt;&lt;/a&gt;&lt;span class="sd"&gt;      F_coeff : float&lt;/span&gt;
&lt;a id="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-60" name="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-60" href="https://nicoguaro.github.io/es/posts/bem_corrected/#rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-60"&gt;&lt;/a&gt;&lt;span class="sd"&gt;          Influence coefficient for primary variable.&lt;/span&gt;
&lt;a id="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-61" name="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-61" href="https://nicoguaro.github.io/es/posts/bem_corrected/#rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-61"&gt;&lt;/a&gt;&lt;span class="sd"&gt;      """&lt;/span&gt;
&lt;a id="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-62" name="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-62" href="https://nicoguaro.github.io/es/posts/bem_corrected/#rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-62"&gt;&lt;/a&gt;      &lt;span class="n"&gt;dcos&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;elem&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]]&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;elem&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]]&lt;/span&gt;
&lt;a id="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-63" name="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-63" href="https://nicoguaro.github.io/es/posts/bem_corrected/#rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-63"&gt;&lt;/a&gt;      &lt;span class="n"&gt;dcos&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;dcos&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="n"&gt;norm&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;dcos&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-64" name="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-64" href="https://nicoguaro.github.io/es/posts/bem_corrected/#rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-64"&gt;&lt;/a&gt;      &lt;span class="n"&gt;rotmat&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;([[&lt;/span&gt;&lt;span class="n"&gt;dcos&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;dcos&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]],&lt;/span&gt;
&lt;a id="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-65" name="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-65" href="https://nicoguaro.github.io/es/posts/bem_corrected/#rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-65"&gt;&lt;/a&gt;                      &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;dcos&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;dcos&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]]])&lt;/span&gt;
&lt;a id="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-66" name="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-66" href="https://nicoguaro.github.io/es/posts/bem_corrected/#rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-66"&gt;&lt;/a&gt;      &lt;span class="n"&gt;r_A&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;rotmat&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;dot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;elem&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]]&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;pt_col&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-67" name="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-67" href="https://nicoguaro.github.io/es/posts/bem_corrected/#rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-67"&gt;&lt;/a&gt;      &lt;span class="n"&gt;r_B&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;rotmat&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;dot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;elem&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]]&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;pt_col&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-68" name="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-68" href="https://nicoguaro.github.io/es/posts/bem_corrected/#rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-68"&gt;&lt;/a&gt;      &lt;span class="n"&gt;theta_A&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;arctan2&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;r_A&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;r_A&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-69" name="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-69" href="https://nicoguaro.github.io/es/posts/bem_corrected/#rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-69"&gt;&lt;/a&gt;      &lt;span class="n"&gt;theta_B&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;arctan2&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;r_B&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;r_B&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-70" name="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-70" href="https://nicoguaro.github.io/es/posts/bem_corrected/#rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-70"&gt;&lt;/a&gt;      &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;norm&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;r_A&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="mf"&gt;1e-6&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a id="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-71" name="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-71" href="https://nicoguaro.github.io/es/posts/bem_corrected/#rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-71"&gt;&lt;/a&gt;          &lt;span class="n"&gt;G_coeff&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;r_B&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;log&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;norm&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;r_B&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;theta_B&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;r_B&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-72" name="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-72" href="https://nicoguaro.github.io/es/posts/bem_corrected/#rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-72"&gt;&lt;/a&gt;      &lt;span class="k"&gt;elif&lt;/span&gt; &lt;span class="n"&gt;norm&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;r_B&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="mf"&gt;1e-6&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a id="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-73" name="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-73" href="https://nicoguaro.github.io/es/posts/bem_corrected/#rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-73"&gt;&lt;/a&gt;          &lt;span class="n"&gt;G_coeff&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;r_A&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;log&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;norm&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;r_A&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;theta_A&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;r_A&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-74" name="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-74" href="https://nicoguaro.github.io/es/posts/bem_corrected/#rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-74"&gt;&lt;/a&gt;      &lt;span class="k"&gt;else&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a id="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-75" name="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-75" href="https://nicoguaro.github.io/es/posts/bem_corrected/#rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-75"&gt;&lt;/a&gt;          &lt;span class="n"&gt;G_coeff&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;r_B&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;log&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;norm&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;r_B&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;theta_B&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;r_B&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;\
&lt;a id="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-76" name="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-76" href="https://nicoguaro.github.io/es/posts/bem_corrected/#rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-76"&gt;&lt;/a&gt;                  &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;r_A&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;log&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;norm&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;r_A&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;theta_A&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;r_A&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-77" name="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-77" href="https://nicoguaro.github.io/es/posts/bem_corrected/#rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-77"&gt;&lt;/a&gt;      &lt;span class="n"&gt;F_coeff&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;theta_B&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;theta_A&lt;/span&gt;
&lt;a id="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-78" name="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-78" href="https://nicoguaro.github.io/es/posts/bem_corrected/#rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-78"&gt;&lt;/a&gt;      &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;G_coeff&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;pi&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;F_coeff&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;pi&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-79" name="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-79" href="https://nicoguaro.github.io/es/posts/bem_corrected/#rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-79"&gt;&lt;/a&gt;
&lt;a id="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-80" name="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-80" href="https://nicoguaro.github.io/es/posts/bem_corrected/#rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-80"&gt;&lt;/a&gt;
&lt;a id="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-81" name="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-81" href="https://nicoguaro.github.io/es/posts/bem_corrected/#rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-81"&gt;&lt;/a&gt;  &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;eval_sol&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ev_coords&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;elems&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;u_boundary&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;q_boundary&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-82" name="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-82" href="https://nicoguaro.github.io/es/posts/bem_corrected/#rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-82"&gt;&lt;/a&gt;      &lt;span class="sd"&gt;"""Evaluate the solution in a set of points&lt;/span&gt;
&lt;a id="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-83" name="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-83" href="https://nicoguaro.github.io/es/posts/bem_corrected/#rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-83"&gt;&lt;/a&gt;
&lt;a id="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-84" name="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-84" href="https://nicoguaro.github.io/es/posts/bem_corrected/#rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-84"&gt;&lt;/a&gt;&lt;span class="sd"&gt;      Parameters&lt;/span&gt;
&lt;a id="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-85" name="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-85" href="https://nicoguaro.github.io/es/posts/bem_corrected/#rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-85"&gt;&lt;/a&gt;&lt;span class="sd"&gt;      ----------&lt;/span&gt;
&lt;a id="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-86" name="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-86" href="https://nicoguaro.github.io/es/posts/bem_corrected/#rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-86"&gt;&lt;/a&gt;&lt;span class="sd"&gt;      ev_coords : ndarray, float&lt;/span&gt;
&lt;a id="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-87" name="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-87" href="https://nicoguaro.github.io/es/posts/bem_corrected/#rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-87"&gt;&lt;/a&gt;&lt;span class="sd"&gt;          Coordinates of the evaluation points.&lt;/span&gt;
&lt;a id="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-88" name="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-88" href="https://nicoguaro.github.io/es/posts/bem_corrected/#rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-88"&gt;&lt;/a&gt;&lt;span class="sd"&gt;      coords : ndarray, float&lt;/span&gt;
&lt;a id="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-89" name="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-89" href="https://nicoguaro.github.io/es/posts/bem_corrected/#rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-89"&gt;&lt;/a&gt;&lt;span class="sd"&gt;          Coordinates for the nodes.&lt;/span&gt;
&lt;a id="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-90" name="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-90" href="https://nicoguaro.github.io/es/posts/bem_corrected/#rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-90"&gt;&lt;/a&gt;&lt;span class="sd"&gt;      elems : ndarray, int&lt;/span&gt;
&lt;a id="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-91" name="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-91" href="https://nicoguaro.github.io/es/posts/bem_corrected/#rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-91"&gt;&lt;/a&gt;&lt;span class="sd"&gt;          Connectivity for the elements.&lt;/span&gt;
&lt;a id="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-92" name="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-92" href="https://nicoguaro.github.io/es/posts/bem_corrected/#rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-92"&gt;&lt;/a&gt;&lt;span class="sd"&gt;      u_boundary : ndarray, float&lt;/span&gt;
&lt;a id="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-93" name="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-93" href="https://nicoguaro.github.io/es/posts/bem_corrected/#rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-93"&gt;&lt;/a&gt;&lt;span class="sd"&gt;          Primary variable in the nodes.&lt;/span&gt;
&lt;a id="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-94" name="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-94" href="https://nicoguaro.github.io/es/posts/bem_corrected/#rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-94"&gt;&lt;/a&gt;&lt;span class="sd"&gt;      q_boundary : [type]&lt;/span&gt;
&lt;a id="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-95" name="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-95" href="https://nicoguaro.github.io/es/posts/bem_corrected/#rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-95"&gt;&lt;/a&gt;&lt;span class="sd"&gt;          Flows in the nodes.&lt;/span&gt;
&lt;a id="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-96" name="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-96" href="https://nicoguaro.github.io/es/posts/bem_corrected/#rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-96"&gt;&lt;/a&gt;
&lt;a id="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-97" name="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-97" href="https://nicoguaro.github.io/es/posts/bem_corrected/#rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-97"&gt;&lt;/a&gt;&lt;span class="sd"&gt;      Returns&lt;/span&gt;
&lt;a id="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-98" name="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-98" href="https://nicoguaro.github.io/es/posts/bem_corrected/#rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-98"&gt;&lt;/a&gt;&lt;span class="sd"&gt;      -------&lt;/span&gt;
&lt;a id="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-99" name="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-99" href="https://nicoguaro.github.io/es/posts/bem_corrected/#rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-99"&gt;&lt;/a&gt;&lt;span class="sd"&gt;      solution : ndarray, float&lt;/span&gt;
&lt;a id="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-100" name="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-100" href="https://nicoguaro.github.io/es/posts/bem_corrected/#rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-100"&gt;&lt;/a&gt;&lt;span class="sd"&gt;          Solution evaluated in the given points.&lt;/span&gt;
&lt;a id="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-101" name="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-101" href="https://nicoguaro.github.io/es/posts/bem_corrected/#rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-101"&gt;&lt;/a&gt;&lt;span class="sd"&gt;      """&lt;/span&gt;
&lt;a id="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-102" name="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-102" href="https://nicoguaro.github.io/es/posts/bem_corrected/#rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-102"&gt;&lt;/a&gt;      &lt;span class="n"&gt;npts&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;ev_coords&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;shape&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-103" name="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-103" href="https://nicoguaro.github.io/es/posts/bem_corrected/#rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-103"&gt;&lt;/a&gt;      &lt;span class="n"&gt;solution&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;npts&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-104" name="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-104" href="https://nicoguaro.github.io/es/posts/bem_corrected/#rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-104"&gt;&lt;/a&gt;      &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;k&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;npts&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-105" name="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-105" href="https://nicoguaro.github.io/es/posts/bem_corrected/#rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-105"&gt;&lt;/a&gt;          &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;ev_cont&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;elem&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;enumerate&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;elems&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-106" name="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-106" href="https://nicoguaro.github.io/es/posts/bem_corrected/#rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-106"&gt;&lt;/a&gt;              &lt;span class="n"&gt;pt_col&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;ev_coords&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;k&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-107" name="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-107" href="https://nicoguaro.github.io/es/posts/bem_corrected/#rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-107"&gt;&lt;/a&gt;              &lt;span class="n"&gt;G&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;F&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;influence_coeff&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;elem&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;pt_col&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-108" name="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-108" href="https://nicoguaro.github.io/es/posts/bem_corrected/#rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-108"&gt;&lt;/a&gt;              &lt;span class="n"&gt;solution&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;k&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;+=&lt;/span&gt; &lt;span class="n"&gt;u_boundary&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ev_cont&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;F&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;q_boundary&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ev_cont&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;G&lt;/span&gt;
&lt;a id="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-109" name="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-109" href="https://nicoguaro.github.io/es/posts/bem_corrected/#rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-109"&gt;&lt;/a&gt;      &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;solution&lt;/span&gt;
&lt;a id="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-110" name="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-110" href="https://nicoguaro.github.io/es/posts/bem_corrected/#rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-110"&gt;&lt;/a&gt;
&lt;a id="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-111" name="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-111" href="https://nicoguaro.github.io/es/posts/bem_corrected/#rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-111"&gt;&lt;/a&gt;
&lt;a id="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-112" name="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-112" href="https://nicoguaro.github.io/es/posts/bem_corrected/#rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-112"&gt;&lt;/a&gt;&lt;span class="c1"&gt;#%% Simulation&lt;/span&gt;
&lt;a id="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-113" name="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-113" href="https://nicoguaro.github.io/es/posts/bem_corrected/#rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-113"&gt;&lt;/a&gt;&lt;span class="n"&gt;mesh&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;meshio&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;read&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"disk.msh"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-114" name="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-114" href="https://nicoguaro.github.io/es/posts/bem_corrected/#rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-114"&gt;&lt;/a&gt;&lt;span class="n"&gt;elems&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;mesh&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;cells&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;"line"&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-115" name="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-115" href="https://nicoguaro.github.io/es/posts/bem_corrected/#rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-115"&gt;&lt;/a&gt;&lt;span class="n"&gt;bound_nodes&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;list&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;set&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;elems&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;flatten&lt;/span&gt;&lt;span class="p"&gt;()))&lt;/span&gt;
&lt;a id="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-116" name="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-116" href="https://nicoguaro.github.io/es/posts/bem_corrected/#rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-116"&gt;&lt;/a&gt;&lt;span class="n"&gt;coords&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;mesh&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;points&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;bound_nodes&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-117" name="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-117" href="https://nicoguaro.github.io/es/posts/bem_corrected/#rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-117"&gt;&lt;/a&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;y&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;T&lt;/span&gt;
&lt;a id="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-118" name="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-118" href="https://nicoguaro.github.io/es/posts/bem_corrected/#rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-118"&gt;&lt;/a&gt;&lt;span class="n"&gt;x_m&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;y_m&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;0.5&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;elems&lt;/span&gt;&lt;span class="p"&gt;[:,&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]]&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;elems&lt;/span&gt;&lt;span class="p"&gt;[:,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]])&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;T&lt;/span&gt;
&lt;a id="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-119" name="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-119" href="https://nicoguaro.github.io/es/posts/bem_corrected/#rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-119"&gt;&lt;/a&gt;&lt;span class="n"&gt;theta&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;arctan2&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;y_m&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;x_m&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-120" name="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-120" href="https://nicoguaro.github.io/es/posts/bem_corrected/#rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-120"&gt;&lt;/a&gt;&lt;span class="n"&gt;u_boundary&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;cos&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;6&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;theta&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-121" name="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-121" href="https://nicoguaro.github.io/es/posts/bem_corrected/#rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-121"&gt;&lt;/a&gt;
&lt;a id="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-122" name="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-122" href="https://nicoguaro.github.io/es/posts/bem_corrected/#rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-122"&gt;&lt;/a&gt;
&lt;a id="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-123" name="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-123" href="https://nicoguaro.github.io/es/posts/bem_corrected/#rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-123"&gt;&lt;/a&gt;&lt;span class="c1"&gt;#%% Assembly&lt;/span&gt;
&lt;a id="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-124" name="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-124" href="https://nicoguaro.github.io/es/posts/bem_corrected/#rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-124"&gt;&lt;/a&gt;&lt;span class="n"&gt;Gmat&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;Fmat&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;assem&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;elems&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-125" name="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-125" href="https://nicoguaro.github.io/es/posts/bem_corrected/#rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-125"&gt;&lt;/a&gt;
&lt;a id="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-126" name="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-126" href="https://nicoguaro.github.io/es/posts/bem_corrected/#rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-126"&gt;&lt;/a&gt;&lt;span class="c1"&gt;#%% Solution&lt;/span&gt;
&lt;a id="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-127" name="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-127" href="https://nicoguaro.github.io/es/posts/bem_corrected/#rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-127"&gt;&lt;/a&gt;&lt;span class="n"&gt;q_boundary&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;solve&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Gmat&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;Fmat&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;dot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;u_boundary&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-128" name="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-128" href="https://nicoguaro.github.io/es/posts/bem_corrected/#rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-128"&gt;&lt;/a&gt;
&lt;a id="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-129" name="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-129" href="https://nicoguaro.github.io/es/posts/bem_corrected/#rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-129"&gt;&lt;/a&gt;&lt;span class="c1"&gt;#%% Evaluation&lt;/span&gt;
&lt;a id="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-130" name="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-130" href="https://nicoguaro.github.io/es/posts/bem_corrected/#rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-130"&gt;&lt;/a&gt;&lt;span class="n"&gt;ev_coords&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt;  &lt;span class="n"&gt;mesh&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;points&lt;/span&gt;&lt;span class="p"&gt;[:,&lt;/span&gt; &lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-131" name="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-131" href="https://nicoguaro.github.io/es/posts/bem_corrected/#rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-131"&gt;&lt;/a&gt;&lt;span class="n"&gt;ev_x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;ev_y&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;ev_coords&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;T&lt;/span&gt;
&lt;a id="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-132" name="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-132" href="https://nicoguaro.github.io/es/posts/bem_corrected/#rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-132"&gt;&lt;/a&gt;&lt;span class="n"&gt;solution&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;eval_sol&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ev_coords&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;elems&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;u_boundary&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;q_boundary&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-133" name="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-133" href="https://nicoguaro.github.io/es/posts/bem_corrected/#rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-133"&gt;&lt;/a&gt;
&lt;a id="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-134" name="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-134" href="https://nicoguaro.github.io/es/posts/bem_corrected/#rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-134"&gt;&lt;/a&gt;&lt;span class="c1"&gt;#%% Visualization&lt;/span&gt;
&lt;a id="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-135" name="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-135" href="https://nicoguaro.github.io/es/posts/bem_corrected/#rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-135"&gt;&lt;/a&gt;&lt;span class="n"&gt;tris&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;mesh&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;cells&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;"triangle"&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-136" name="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-136" href="https://nicoguaro.github.io/es/posts/bem_corrected/#rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-136"&gt;&lt;/a&gt;&lt;span class="n"&gt;fig&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;figure&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a id="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-137" name="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-137" href="https://nicoguaro.github.io/es/posts/bem_corrected/#rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-137"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;fig&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;add_subplot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;111&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;projection&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'3d'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-138" name="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-138" href="https://nicoguaro.github.io/es/posts/bem_corrected/#rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-138"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;plot_trisurf&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ev_x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;ev_y&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;solution&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;cmap&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;"RdYlBu"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;lw&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mf"&gt;0.3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;a id="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-139" name="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-139" href="https://nicoguaro.github.io/es/posts/bem_corrected/#rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-139"&gt;&lt;/a&gt;                &lt;span class="n"&gt;edgecolor&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;"#3c3c3c"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-140" name="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-140" href="https://nicoguaro.github.io/es/posts/bem_corrected/#rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-140"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xticks&lt;/span&gt;&lt;span class="p"&gt;([])&lt;/span&gt;
&lt;a id="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-141" name="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-141" href="https://nicoguaro.github.io/es/posts/bem_corrected/#rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-141"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;yticks&lt;/span&gt;&lt;span class="p"&gt;([])&lt;/span&gt;
&lt;a id="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-142" name="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-142" href="https://nicoguaro.github.io/es/posts/bem_corrected/#rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-142"&gt;&lt;/a&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_zticks&lt;/span&gt;&lt;span class="p"&gt;([])&lt;/span&gt;
&lt;a id="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-143" name="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-143" href="https://nicoguaro.github.io/es/posts/bem_corrected/#rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-143"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;savefig&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"bem_solution.png"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;bbox_inches&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;"tight"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;transparent&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;True&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;a id="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-144" name="rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-144" href="https://nicoguaro.github.io/es/posts/bem_corrected/#rest_code_90c4ef65bd1b4f72910fb890a21b6bb4-144"&gt;&lt;/a&gt;            &lt;span class="n"&gt;dpi&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;300&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;En este caso obtenemos el siguiente resultado.&lt;/p&gt;
&lt;img alt="Solución de la ecuación diferencial usando BEM." class="align-center" src="https://nicoguaro.github.io/images/bem_solution.png" style="width: 600px;"&gt;
&lt;/section&gt;</description><category>computación científica</category><category>julia</category><category>método de elementos de frontera</category><category>métodos numéricos</category><category>python</category><guid>https://nicoguaro.github.io/es/posts/bem_corrected/</guid><pubDate>Mon, 22 Feb 2021 15:00:00 GMT</pubDate></item><item><title>Revisión ortográfica en Jupyter Notebook</title><link>https://nicoguaro.github.io/es/posts/ortografia_jupyter/</link><dc:creator>Nicolás Guarín-Zapata</dc:creator><description>&lt;p&gt;El objetivo de esta publicación es mostrar cómo tener revisión automática
de ortografía en Jupyter Notebook, como se muestra a continuación.&lt;/p&gt;
&lt;img alt="Ejemplo de corrección ortográfica en Jupyter Notebook." class="align-center" src="https://nicoguaro.github.io/images/ortografia_jupyter/ejemplo_ortografia.png" style="width: 600px;"&gt;
&lt;p&gt;Existen &lt;a class="reference external" href="https://stackoverflow.com/q/39324039/3358223"&gt;varias formas&lt;/a&gt; de
realizar esto. Sin embargo, la forma más fácil es a través del complemento
(&lt;em&gt;nbextension&lt;/em&gt;) &lt;a class="reference external" href="https://nicoguaro.github.io/es/posts/ortografia_jupyter/&amp;lt;https:/jupyter-contrib-nbextensions.readthedocs.io/en/latest/nbextensions/spellchecker/README.html"&gt;Spellchecker&lt;/a&gt;.&lt;/p&gt;
&lt;section id="paso-a-paso"&gt;
&lt;h2&gt;Paso a paso&lt;/h2&gt;
&lt;p&gt;Los pasos a seguir son los siguientes:&lt;/p&gt;
&lt;ol class="arabic simple"&gt;
&lt;li&gt;&lt;p&gt;Instalar Jupyter notebook extensions (&lt;a class="reference external" href="https://github.com/ipython-contrib/jupyter_contrib_nbextensions"&gt;nbextensions&lt;/a&gt;). Este incluye
&lt;a class="reference external" href="https://nicoguaro.github.io/es/posts/ortografia_jupyter/&amp;lt;https:/jupyter-contrib-nbextensions.readthedocs.io/en/latest/nbextensions/spellchecker/README.html"&gt;Spellchecker&lt;/a&gt;.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Ubicar los diccionarios en la carpeta donde está el complemento. Los
diccionarios deben usar la codificación UTF-8.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Configurar la ruta de los diccionarios. Esta puede ser una URL o
una ruta relativa respecto a la carpeta en donde se encuentra el complemento.&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;A continuación describiremos en detalle cada paso.&lt;/p&gt;
&lt;section id="paso-1-instalacion-de-nbextensions"&gt;
&lt;h3&gt;Paso 1: Instalación de nbextensions&lt;/h3&gt;
&lt;p&gt;Existe una lista de complementos que agregan algunas funcionalidades
comúnmente usadas a Jupyter notebook.&lt;/p&gt;
&lt;p&gt;Escriba lo siguiente en una terminal, para instalarlo usando PIP.&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code bash"&gt;&lt;a id="rest_code_f14aa2712ef2459dad2521ef1f2043be-1" name="rest_code_f14aa2712ef2459dad2521ef1f2043be-1" href="https://nicoguaro.github.io/es/posts/ortografia_jupyter/#rest_code_f14aa2712ef2459dad2521ef1f2043be-1"&gt;&lt;/a&gt;pip install jupyter_contrib_nbextensions
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Sin embargo, si se está usando Anaconda el &lt;strong&gt;método recomendado&lt;/strong&gt; es usar
&lt;code class="docutils literal"&gt;conda&lt;/code&gt;, como se muestra a continuación.&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code bash"&gt;&lt;a id="rest_code_ca3f4084a6aa4a1db594dcaffae2cf6e-1" name="rest_code_ca3f4084a6aa4a1db594dcaffae2cf6e-1" href="https://nicoguaro.github.io/es/posts/ortografia_jupyter/#rest_code_ca3f4084a6aa4a1db594dcaffae2cf6e-1"&gt;&lt;/a&gt;conda install -c conda-forge jupyter_contrib_nbextensions
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Esto debe instalar los complementos y también la
&lt;a class="reference external" href="https://github.com/Jupyter-contrib/jupyter_nbextensions_configurator"&gt;interfaz de configuración&lt;/a&gt;.
En el menú principal de Jupyter notebook aparecerá una nueva pestaña
nombrada &lt;em&gt;Nbextensions&lt;/em&gt; en donde se pueden elegir los complementos a usar.
La apariencia es la siguiente.&lt;/p&gt;
&lt;img alt="Interfaz gráfica para los complementos de Jupyter." class="align-center" src="https://nicoguaro.github.io/images/ortografia_jupyter/interfaz_nbextensions.png" style="width: 600px;"&gt;
&lt;p&gt;Algunos complementos recomendados son:&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;&lt;strong&gt;Collapsible Headings:&lt;/strong&gt; que permite ocultar secciones de los documentos.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;strong&gt;RISE:&lt;/strong&gt; que convierte los notebooks en presentaciones.&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/section&gt;
&lt;section id="paso-2-diccionarios-para-espanol"&gt;
&lt;h3&gt;Paso 2: Diccionarios para español&lt;/h3&gt;
&lt;p&gt;La documentación de &lt;a class="reference external" href="https://nicoguaro.github.io/es/posts/ortografia_jupyter/&amp;lt;https:/jupyter-contrib-nbextensions.readthedocs.io/en/latest/nbextensions/spellchecker/README.html"&gt;Spellchecker&lt;/a&gt; sugiere usar un script de Python para
descargar diccionarios del proyecto &lt;a class="reference external" href="https://chromium.googlesource.com/chromium/deps/hunspell_dictionaries/+/master"&gt;Chromium&lt;/a&gt;.
Sin embargo, estos tienen como codificación ISO-8859-1 (occidente) y falla
para caracteres con tildes o virgulillas. Para que no haya problemas el
diccionario debe tener codificación &lt;a class="reference external" href="https://en.wikipedia.org/wiki/UTF-8"&gt;UTF-8&lt;/a&gt;.
Pueden descargarse en &lt;a class="reference external" href="https://nicoguaro.github.io/downloads/dict_es_ES.zip"&gt;este enlace&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Una vez que se tienen los diccionarios se deben ubicar en la ruta del
complemento. En mi computador esta sería&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code text"&gt;&lt;a id="rest_code_0f6b60fcc302449b8e19f817c3e41797-1" name="rest_code_0f6b60fcc302449b8e19f817c3e41797-1" href="https://nicoguaro.github.io/es/posts/ortografia_jupyter/#rest_code_0f6b60fcc302449b8e19f817c3e41797-1"&gt;&lt;/a&gt;~/.local/share/jupyter/nbextensions/spellchecker/
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;y dentro de esta los ubicaremos en&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code text"&gt;&lt;a id="rest_code_0276688a10534317847e69a1f4f27510-1" name="rest_code_0276688a10534317847e69a1f4f27510-1" href="https://nicoguaro.github.io/es/posts/ortografia_jupyter/#rest_code_0276688a10534317847e69a1f4f27510-1"&gt;&lt;/a&gt;~/.local/share/jupyter/nbextensions/spellchecker/typo/dictionaries
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Esta ubicación es arbitraria, lo importante es que necesitamos conocer
la ruta relativa al complemento.&lt;/p&gt;
&lt;/section&gt;
&lt;section id="paso-3-configuracion-complementos"&gt;
&lt;h3&gt;Paso 3: Configuración complementos&lt;/h3&gt;
&lt;p&gt;Ahora, en la pestaña &lt;em&gt;Nbextensions&lt;/em&gt; seleccionamos el complemento y llenamos
los campos con la información de nuestro diccionario:&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;language code to use with typo.js: &lt;code class="docutils literal"&gt;es_ES&lt;/code&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;url for the dictionary .dic file to use: &lt;code class="docutils literal"&gt;./typo/dictionaries/es_ES.dic&lt;/code&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;url for the dictionary .aff file to use: &lt;code class="docutils literal"&gt;./typo/dictionaries/es_ES.aff&lt;/code&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Esto se muestra a continuación.&lt;/p&gt;
&lt;img alt="Configuración con archivos locales." class="align-center" src="https://nicoguaro.github.io/images/ortografia_jupyter/config_local.png" style="width: 600px;"&gt;
&lt;p&gt;Otra opción es usar la URL para los archivos. En &lt;a class="reference external" href="https://github.com/wooorm/dictionaries"&gt;https://github.com/wooorm/dictionaries&lt;/a&gt;
están disponibles los diccionarios del proyecto &lt;a class="reference external" href="https://hunspell.github.io/"&gt;hunspell&lt;/a&gt;
en UTF-8. En este caso, la configuración sería:&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;language code to use with typo.js: &lt;code class="docutils literal"&gt;es_ES&lt;/code&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;url for the dictionary .dic file to use: &lt;code class="docutils literal"&gt;&lt;span class="pre"&gt;https://raw.githubusercontent.com/wooorm/dictionaries/master/dictionaries/es/index.dic&lt;/span&gt;&lt;/code&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;url for the dictionary .aff file to use: &lt;code class="docutils literal"&gt;&lt;span class="pre"&gt;https://raw.githubusercontent.com/wooorm/dictionaries/master/dictionaries/es/index.aff&lt;/span&gt;&lt;/code&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Y se muestra a continuación.&lt;/p&gt;
&lt;img alt="Configuración con archivos remotos." class="align-center" src="https://nicoguaro.github.io/images/ortografia_jupyter/config_url.png" style="width: 600px;"&gt;
&lt;/section&gt;
&lt;/section&gt;</description><category>ciencia de datos</category><category>computación científica</category><category>python</category><category>tutorial</category><guid>https://nicoguaro.github.io/es/posts/ortografia_jupyter/</guid><pubDate>Tue, 20 Aug 2019 19:45:41 GMT</pubDate></item><item><title>Diferencias finitas en dominios infinitos</title><link>https://nicoguaro.github.io/es/posts/infinite_fdm/</link><dc:creator>Nicolás Guarín-Zapata</dc:creator><description>&lt;section id="diferencias-finitas-en-dominios-infinitos"&gt;
&lt;h2&gt;Diferencias finitas en dominios infinitos&lt;/h2&gt;
&lt;p&gt;Gracias a mi amigo, &lt;a class="reference external" href="http://cosmoscalibur.com/"&gt;Edward Villegas&lt;/a&gt;,
terminé pensando acerca del uso de cambio de variables en la solución
de problemas de valores propios con diferencias finitas.&lt;/p&gt;
&lt;section id="el-problema"&gt;
&lt;h3&gt;El problema&lt;/h3&gt;
&lt;p&gt;Digamos que queremos resolver una ecuación diferencias sobre un dominio
infinito. Un caso común es la solución de la  &lt;a class="reference external" href="https://en.wikipedia.org/wiki/Schr%C3%B6dinger_equation#Time-independent_equation"&gt;ecuación de Schrödinger
independiente del tiempo&lt;/a&gt;
sujeta a un potencial &lt;span class="math"&gt;\(V(x)\)&lt;/span&gt;. Por ejemplo&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
-\frac{1}{2}\frac{\mathrm{d}^2}{\mathrm{d}x^2}\psi(x) + V(x) \psi(x) = E\psi(x),\quad \forall x\in (-\infty, \infty),
\end{equation*}
&lt;/div&gt;
&lt;p&gt;en donde queremos encontrar las parejas de valores/funciones propias
&lt;span class="math"&gt;\((E_n, \psi_n(x))\)&lt;/span&gt;.&lt;/p&gt;
&lt;p&gt;Lo que normalmente hago cuando uso &lt;a class="reference external" href="https://en.wikipedia.org/wiki/Finite_difference_method"&gt;diferencias
finitas&lt;/a&gt;
es dividir el dominio regularmente. Donde tomo un dominio lo &lt;em&gt;suficientemente
grande&lt;/em&gt;, para que la solución haya decaído a cero. Lo que hago en esta
publicación es usar un cambio de variable para convertir el intervalo
a uno finito y luego dividir el dominio transformado regularmente
en intervalos finitos.&lt;/p&gt;
&lt;/section&gt;
&lt;section id="mi-enfoque-usual"&gt;
&lt;h3&gt;Mi enfoque usual&lt;/h3&gt;
&lt;p&gt;Mi enfoque usual es aproximar la segunda derivada con una &lt;a class="reference external" href="https://en.wikipedia.org/wiki/Finite_difference_coefficient"&gt;diferencia
centrada&lt;/a&gt;
para el punto &lt;span class="math"&gt;\(x_i\)&lt;/span&gt;, de la siguiente manera&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
\frac{\mathrm{d}^2 f(x)}{\mathrm{d}x^2} \approx \frac{f(x + \Delta x) - 2 f(x_i) + f(x - \Delta x)}{\Delta x^2}\, ,
\end{equation*}
&lt;/div&gt;
&lt;p&gt;con &lt;span class="math"&gt;\(\Delta x\)&lt;/span&gt; la separación entre puntos consecutivos.&lt;/p&gt;
&lt;p&gt;Podemos solucionar este problem en Python con el siguiente bloque
de código:&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code python"&gt;&lt;a id="rest_code_ff1bc56abd2040ed9770d54fb427d36b-1" name="rest_code_ff1bc56abd2040ed9770d54fb427d36b-1" href="https://nicoguaro.github.io/es/posts/infinite_fdm/#rest_code_ff1bc56abd2040ed9770d54fb427d36b-1"&gt;&lt;/a&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;numpy&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;np&lt;/span&gt;
&lt;a id="rest_code_ff1bc56abd2040ed9770d54fb427d36b-2" name="rest_code_ff1bc56abd2040ed9770d54fb427d36b-2" href="https://nicoguaro.github.io/es/posts/infinite_fdm/#rest_code_ff1bc56abd2040ed9770d54fb427d36b-2"&gt;&lt;/a&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;scipy.sparse&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;diags&lt;/span&gt;
&lt;a id="rest_code_ff1bc56abd2040ed9770d54fb427d36b-3" name="rest_code_ff1bc56abd2040ed9770d54fb427d36b-3" href="https://nicoguaro.github.io/es/posts/infinite_fdm/#rest_code_ff1bc56abd2040ed9770d54fb427d36b-3"&gt;&lt;/a&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;scipy.sparse.linalg&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;eigs&lt;/span&gt;
&lt;a id="rest_code_ff1bc56abd2040ed9770d54fb427d36b-4" name="rest_code_ff1bc56abd2040ed9770d54fb427d36b-4" href="https://nicoguaro.github.io/es/posts/infinite_fdm/#rest_code_ff1bc56abd2040ed9770d54fb427d36b-4"&gt;&lt;/a&gt;
&lt;a id="rest_code_ff1bc56abd2040ed9770d54fb427d36b-5" name="rest_code_ff1bc56abd2040ed9770d54fb427d36b-5" href="https://nicoguaro.github.io/es/posts/infinite_fdm/#rest_code_ff1bc56abd2040ed9770d54fb427d36b-5"&gt;&lt;/a&gt;
&lt;a id="rest_code_ff1bc56abd2040ed9770d54fb427d36b-6" name="rest_code_ff1bc56abd2040ed9770d54fb427d36b-6" href="https://nicoguaro.github.io/es/posts/infinite_fdm/#rest_code_ff1bc56abd2040ed9770d54fb427d36b-6"&gt;&lt;/a&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;regular_FD&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;pot&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;npts&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;101&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;x_max&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;nvals&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;6&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_ff1bc56abd2040ed9770d54fb427d36b-7" name="rest_code_ff1bc56abd2040ed9770d54fb427d36b-7" href="https://nicoguaro.github.io/es/posts/infinite_fdm/#rest_code_ff1bc56abd2040ed9770d54fb427d36b-7"&gt;&lt;/a&gt;    &lt;span class="sd"&gt;"""&lt;/span&gt;
&lt;a id="rest_code_ff1bc56abd2040ed9770d54fb427d36b-8" name="rest_code_ff1bc56abd2040ed9770d54fb427d36b-8" href="https://nicoguaro.github.io/es/posts/infinite_fdm/#rest_code_ff1bc56abd2040ed9770d54fb427d36b-8"&gt;&lt;/a&gt;&lt;span class="sd"&gt;    Find eigenvalues/eigenfunctions for Schrodinger&lt;/span&gt;
&lt;a id="rest_code_ff1bc56abd2040ed9770d54fb427d36b-9" name="rest_code_ff1bc56abd2040ed9770d54fb427d36b-9" href="https://nicoguaro.github.io/es/posts/infinite_fdm/#rest_code_ff1bc56abd2040ed9770d54fb427d36b-9"&gt;&lt;/a&gt;&lt;span class="sd"&gt;    equation for the given potential `pot` using&lt;/span&gt;
&lt;a id="rest_code_ff1bc56abd2040ed9770d54fb427d36b-10" name="rest_code_ff1bc56abd2040ed9770d54fb427d36b-10" href="https://nicoguaro.github.io/es/posts/infinite_fdm/#rest_code_ff1bc56abd2040ed9770d54fb427d36b-10"&gt;&lt;/a&gt;&lt;span class="sd"&gt;    finite differences&lt;/span&gt;
&lt;a id="rest_code_ff1bc56abd2040ed9770d54fb427d36b-11" name="rest_code_ff1bc56abd2040ed9770d54fb427d36b-11" href="https://nicoguaro.github.io/es/posts/infinite_fdm/#rest_code_ff1bc56abd2040ed9770d54fb427d36b-11"&gt;&lt;/a&gt;&lt;span class="sd"&gt;    """&lt;/span&gt;
&lt;a id="rest_code_ff1bc56abd2040ed9770d54fb427d36b-12" name="rest_code_ff1bc56abd2040ed9770d54fb427d36b-12" href="https://nicoguaro.github.io/es/posts/infinite_fdm/#rest_code_ff1bc56abd2040ed9770d54fb427d36b-12"&gt;&lt;/a&gt;    &lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;linspace&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;x_max&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;x_max&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;npts&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_ff1bc56abd2040ed9770d54fb427d36b-13" name="rest_code_ff1bc56abd2040ed9770d54fb427d36b-13" href="https://nicoguaro.github.io/es/posts/infinite_fdm/#rest_code_ff1bc56abd2040ed9770d54fb427d36b-13"&gt;&lt;/a&gt;    &lt;span class="n"&gt;dx&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_ff1bc56abd2040ed9770d54fb427d36b-14" name="rest_code_ff1bc56abd2040ed9770d54fb427d36b-14" href="https://nicoguaro.github.io/es/posts/infinite_fdm/#rest_code_ff1bc56abd2040ed9770d54fb427d36b-14"&gt;&lt;/a&gt;    &lt;span class="n"&gt;D2&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;diags&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;shape&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;npts&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;npts&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;dx&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;
&lt;a id="rest_code_ff1bc56abd2040ed9770d54fb427d36b-15" name="rest_code_ff1bc56abd2040ed9770d54fb427d36b-15" href="https://nicoguaro.github.io/es/posts/infinite_fdm/#rest_code_ff1bc56abd2040ed9770d54fb427d36b-15"&gt;&lt;/a&gt;    &lt;span class="n"&gt;V&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;diags&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;pot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_ff1bc56abd2040ed9770d54fb427d36b-16" name="rest_code_ff1bc56abd2040ed9770d54fb427d36b-16" href="https://nicoguaro.github.io/es/posts/infinite_fdm/#rest_code_ff1bc56abd2040ed9770d54fb427d36b-16"&gt;&lt;/a&gt;    &lt;span class="n"&gt;H&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;0.5&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;D2&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;V&lt;/span&gt;
&lt;a id="rest_code_ff1bc56abd2040ed9770d54fb427d36b-17" name="rest_code_ff1bc56abd2040ed9770d54fb427d36b-17" href="https://nicoguaro.github.io/es/posts/infinite_fdm/#rest_code_ff1bc56abd2040ed9770d54fb427d36b-17"&gt;&lt;/a&gt;    &lt;span class="n"&gt;vals&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;vecs&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;eigs&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;H&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;k&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;nvals&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;which&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;"SM"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_ff1bc56abd2040ed9770d54fb427d36b-18" name="rest_code_ff1bc56abd2040ed9770d54fb427d36b-18" href="https://nicoguaro.github.io/es/posts/infinite_fdm/#rest_code_ff1bc56abd2040ed9770d54fb427d36b-18"&gt;&lt;/a&gt;    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;real&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;vals&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;vecs&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Configuremos los gráficos con el siguiente bloque de código.&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code python"&gt;&lt;a id="rest_code_787f3a2421f44ffb8f27cc36f626eb66-1" name="rest_code_787f3a2421f44ffb8f27cc36f626eb66-1" href="https://nicoguaro.github.io/es/posts/infinite_fdm/#rest_code_787f3a2421f44ffb8f27cc36f626eb66-1"&gt;&lt;/a&gt;&lt;span class="c1"&gt;# Jupyter notebook plotting setup &amp;amp; imports&lt;/span&gt;
&lt;a id="rest_code_787f3a2421f44ffb8f27cc36f626eb66-2" name="rest_code_787f3a2421f44ffb8f27cc36f626eb66-2" href="https://nicoguaro.github.io/es/posts/infinite_fdm/#rest_code_787f3a2421f44ffb8f27cc36f626eb66-2"&gt;&lt;/a&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="n"&gt;matplotlib&lt;/span&gt; &lt;span class="n"&gt;notebook&lt;/span&gt;
&lt;a id="rest_code_787f3a2421f44ffb8f27cc36f626eb66-3" name="rest_code_787f3a2421f44ffb8f27cc36f626eb66-3" href="https://nicoguaro.github.io/es/posts/infinite_fdm/#rest_code_787f3a2421f44ffb8f27cc36f626eb66-3"&gt;&lt;/a&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;matplotlib.pyplot&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;plt&lt;/span&gt;
&lt;a id="rest_code_787f3a2421f44ffb8f27cc36f626eb66-4" name="rest_code_787f3a2421f44ffb8f27cc36f626eb66-4" href="https://nicoguaro.github.io/es/posts/infinite_fdm/#rest_code_787f3a2421f44ffb8f27cc36f626eb66-4"&gt;&lt;/a&gt;
&lt;a id="rest_code_787f3a2421f44ffb8f27cc36f626eb66-5" name="rest_code_787f3a2421f44ffb8f27cc36f626eb66-5" href="https://nicoguaro.github.io/es/posts/infinite_fdm/#rest_code_787f3a2421f44ffb8f27cc36f626eb66-5"&gt;&lt;/a&gt;&lt;span class="n"&gt;gray&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;'#757575'&lt;/span&gt;
&lt;a id="rest_code_787f3a2421f44ffb8f27cc36f626eb66-6" name="rest_code_787f3a2421f44ffb8f27cc36f626eb66-6" href="https://nicoguaro.github.io/es/posts/infinite_fdm/#rest_code_787f3a2421f44ffb8f27cc36f626eb66-6"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;rcParams&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;"figure.figsize"&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;6&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;4&lt;/span&gt;
&lt;a id="rest_code_787f3a2421f44ffb8f27cc36f626eb66-7" name="rest_code_787f3a2421f44ffb8f27cc36f626eb66-7" href="https://nicoguaro.github.io/es/posts/infinite_fdm/#rest_code_787f3a2421f44ffb8f27cc36f626eb66-7"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;rcParams&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;"mathtext.fontset"&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s2"&gt;"cm"&lt;/span&gt;
&lt;a id="rest_code_787f3a2421f44ffb8f27cc36f626eb66-8" name="rest_code_787f3a2421f44ffb8f27cc36f626eb66-8" href="https://nicoguaro.github.io/es/posts/infinite_fdm/#rest_code_787f3a2421f44ffb8f27cc36f626eb66-8"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;rcParams&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;"text.color"&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;gray&lt;/span&gt;
&lt;a id="rest_code_787f3a2421f44ffb8f27cc36f626eb66-9" name="rest_code_787f3a2421f44ffb8f27cc36f626eb66-9" href="https://nicoguaro.github.io/es/posts/infinite_fdm/#rest_code_787f3a2421f44ffb8f27cc36f626eb66-9"&gt;&lt;/a&gt;&lt;span class="n"&gt;fontsize&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;rcParams&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;"font.size"&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;12&lt;/span&gt;
&lt;a id="rest_code_787f3a2421f44ffb8f27cc36f626eb66-10" name="rest_code_787f3a2421f44ffb8f27cc36f626eb66-10" href="https://nicoguaro.github.io/es/posts/infinite_fdm/#rest_code_787f3a2421f44ffb8f27cc36f626eb66-10"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;rcParams&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;"xtick.color"&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;gray&lt;/span&gt;
&lt;a id="rest_code_787f3a2421f44ffb8f27cc36f626eb66-11" name="rest_code_787f3a2421f44ffb8f27cc36f626eb66-11" href="https://nicoguaro.github.io/es/posts/infinite_fdm/#rest_code_787f3a2421f44ffb8f27cc36f626eb66-11"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;rcParams&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;"ytick.color"&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;gray&lt;/span&gt;
&lt;a id="rest_code_787f3a2421f44ffb8f27cc36f626eb66-12" name="rest_code_787f3a2421f44ffb8f27cc36f626eb66-12" href="https://nicoguaro.github.io/es/posts/infinite_fdm/#rest_code_787f3a2421f44ffb8f27cc36f626eb66-12"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;rcParams&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;"axes.labelcolor"&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;gray&lt;/span&gt;
&lt;a id="rest_code_787f3a2421f44ffb8f27cc36f626eb66-13" name="rest_code_787f3a2421f44ffb8f27cc36f626eb66-13" href="https://nicoguaro.github.io/es/posts/infinite_fdm/#rest_code_787f3a2421f44ffb8f27cc36f626eb66-13"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;rcParams&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;"axes.edgecolor"&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;gray&lt;/span&gt;
&lt;a id="rest_code_787f3a2421f44ffb8f27cc36f626eb66-14" name="rest_code_787f3a2421f44ffb8f27cc36f626eb66-14" href="https://nicoguaro.github.io/es/posts/infinite_fdm/#rest_code_787f3a2421f44ffb8f27cc36f626eb66-14"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;rcParams&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;"axes.spines.right"&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="kc"&gt;False&lt;/span&gt;
&lt;a id="rest_code_787f3a2421f44ffb8f27cc36f626eb66-15" name="rest_code_787f3a2421f44ffb8f27cc36f626eb66-15" href="https://nicoguaro.github.io/es/posts/infinite_fdm/#rest_code_787f3a2421f44ffb8f27cc36f626eb66-15"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;rcParams&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;"axes.spines.top"&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="kc"&gt;False&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Consideremos el &lt;a class="reference external" href="https://en.wikipedia.org/wiki/Quantum_harmonic_oscillator"&gt;oscilador armónico
cuántico&lt;/a&gt;,
que tiene como valores propios&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
E_n = n + \frac{1}{2},\quad \forall n = 0, 1, 2 \cdots
\end{equation*}
&lt;/div&gt;
&lt;p&gt;Usando el método de diferencias finitas obtenemos valores que están
muy cerca de los analíticos.&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code python"&gt;&lt;a id="rest_code_84e62012b2f0470392587dc95617e113-1" name="rest_code_84e62012b2f0470392587dc95617e113-1" href="https://nicoguaro.github.io/es/posts/infinite_fdm/#rest_code_84e62012b2f0470392587dc95617e113-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;vals&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;vecs&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;regular_FD&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;lambda&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="mf"&gt;0.5&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;npts&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;201&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_84e62012b2f0470392587dc95617e113-2" name="rest_code_84e62012b2f0470392587dc95617e113-2" href="https://nicoguaro.github.io/es/posts/infinite_fdm/#rest_code_84e62012b2f0470392587dc95617e113-2"&gt;&lt;/a&gt;&lt;span class="n"&gt;vals&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Con respuesta&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code python"&gt;&lt;a id="rest_code_191520ceeed94f46abb4f034c7832d69-1" name="rest_code_191520ceeed94f46abb4f034c7832d69-1" href="https://nicoguaro.github.io/es/posts/infinite_fdm/#rest_code_191520ceeed94f46abb4f034c7832d69-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="mf"&gt;0.4996873&lt;/span&gt; &lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;1.49843574&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;2.49593063&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;3.49216962&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;4.48715031&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;a id="rest_code_191520ceeed94f46abb4f034c7832d69-2" name="rest_code_191520ceeed94f46abb4f034c7832d69-2" href="https://nicoguaro.github.io/es/posts/infinite_fdm/#rest_code_191520ceeed94f46abb4f034c7832d69-2"&gt;&lt;/a&gt;       &lt;span class="mf"&gt;5.4808703&lt;/span&gt; &lt;span class="p"&gt;])&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Los valores analíticos son los siguientes&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code text"&gt;&lt;a id="rest_code_455490060ab54a2780d3d11ed98c965a-1" name="rest_code_455490060ab54a2780d3d11ed98c965a-1" href="https://nicoguaro.github.io/es/posts/infinite_fdm/#rest_code_455490060ab54a2780d3d11ed98c965a-1"&gt;&lt;/a&gt;[0.5, 1.5, 2.5, 3.5, 4.5, 5.5])
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Si graficamos estos dos conjuntos, obtenemos lo siguiente.&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code python"&gt;&lt;a id="rest_code_7a43eb7b241c4f7599f5d8ef7ddd146d-1" name="rest_code_7a43eb7b241c4f7599f5d8ef7ddd146d-1" href="https://nicoguaro.github.io/es/posts/infinite_fdm/#rest_code_7a43eb7b241c4f7599f5d8ef7ddd146d-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;figure&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a id="rest_code_7a43eb7b241c4f7599f5d8ef7ddd146d-2" name="rest_code_7a43eb7b241c4f7599f5d8ef7ddd146d-2" href="https://nicoguaro.github.io/es/posts/infinite_fdm/#rest_code_7a43eb7b241c4f7599f5d8ef7ddd146d-2"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;plot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;anal_vals&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_7a43eb7b241c4f7599f5d8ef7ddd146d-3" name="rest_code_7a43eb7b241c4f7599f5d8ef7ddd146d-3" href="https://nicoguaro.github.io/es/posts/infinite_fdm/#rest_code_7a43eb7b241c4f7599f5d8ef7ddd146d-3"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;plot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;vals&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;"o"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_7a43eb7b241c4f7599f5d8ef7ddd146d-4" name="rest_code_7a43eb7b241c4f7599f5d8ef7ddd146d-4" href="https://nicoguaro.github.io/es/posts/infinite_fdm/#rest_code_7a43eb7b241c4f7599f5d8ef7ddd146d-4"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="sa"&gt;r&lt;/span&gt;&lt;span class="s2"&gt;"$n$"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;fontsize&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;16&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_7a43eb7b241c4f7599f5d8ef7ddd146d-5" name="rest_code_7a43eb7b241c4f7599f5d8ef7ddd146d-5" href="https://nicoguaro.github.io/es/posts/infinite_fdm/#rest_code_7a43eb7b241c4f7599f5d8ef7ddd146d-5"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ylabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="sa"&gt;r&lt;/span&gt;&lt;span class="s2"&gt;"$E_n$"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;fontsize&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;16&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_7a43eb7b241c4f7599f5d8ef7ddd146d-6" name="rest_code_7a43eb7b241c4f7599f5d8ef7ddd146d-6" href="https://nicoguaro.github.io/es/posts/infinite_fdm/#rest_code_7a43eb7b241c4f7599f5d8ef7ddd146d-6"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;legend&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="s2"&gt;"Analytic"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;"Finite differences"&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_7a43eb7b241c4f7599f5d8ef7ddd146d-7" name="rest_code_7a43eb7b241c4f7599f5d8ef7ddd146d-7" href="https://nicoguaro.github.io/es/posts/infinite_fdm/#rest_code_7a43eb7b241c4f7599f5d8ef7ddd146d-7"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;tight_layout&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;img alt="Valores propios para la diferencia finita regular." class="align-center" src="https://nicoguaro.github.io/images/infinite_fdm/eigvals_regular.svg" style="width: 600px;"&gt;
&lt;p&gt;Veamos las funciones propias&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code python"&gt;&lt;a id="rest_code_81a3921da87147d790ce25401e1f86b7-1" name="rest_code_81a3921da87147d790ce25401e1f86b7-1" href="https://nicoguaro.github.io/es/posts/infinite_fdm/#rest_code_81a3921da87147d790ce25401e1f86b7-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;figure&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a id="rest_code_81a3921da87147d790ce25401e1f86b7-2" name="rest_code_81a3921da87147d790ce25401e1f86b7-2" href="https://nicoguaro.github.io/es/posts/infinite_fdm/#rest_code_81a3921da87147d790ce25401e1f86b7-2"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;plot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;abs&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;vecs&lt;/span&gt;&lt;span class="p"&gt;[:,&lt;/span&gt; &lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_81a3921da87147d790ce25401e1f86b7-3" name="rest_code_81a3921da87147d790ce25401e1f86b7-3" href="https://nicoguaro.github.io/es/posts/infinite_fdm/#rest_code_81a3921da87147d790ce25401e1f86b7-3"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlim&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;6&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;6&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_81a3921da87147d790ce25401e1f86b7-4" name="rest_code_81a3921da87147d790ce25401e1f86b7-4" href="https://nicoguaro.github.io/es/posts/infinite_fdm/#rest_code_81a3921da87147d790ce25401e1f86b7-4"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="sa"&gt;r&lt;/span&gt;&lt;span class="s2"&gt;"$x$"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;fontsize&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;16&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_81a3921da87147d790ce25401e1f86b7-5" name="rest_code_81a3921da87147d790ce25401e1f86b7-5" href="https://nicoguaro.github.io/es/posts/infinite_fdm/#rest_code_81a3921da87147d790ce25401e1f86b7-5"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ylabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="sa"&gt;r&lt;/span&gt;&lt;span class="s2"&gt;"$|\psi_n(x)|^2$"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;fontsize&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;16&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_81a3921da87147d790ce25401e1f86b7-6" name="rest_code_81a3921da87147d790ce25401e1f86b7-6" href="https://nicoguaro.github.io/es/posts/infinite_fdm/#rest_code_81a3921da87147d790ce25401e1f86b7-6"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;yticks&lt;/span&gt;&lt;span class="p"&gt;([])&lt;/span&gt;
&lt;a id="rest_code_81a3921da87147d790ce25401e1f86b7-7" name="rest_code_81a3921da87147d790ce25401e1f86b7-7" href="https://nicoguaro.github.io/es/posts/infinite_fdm/#rest_code_81a3921da87147d790ce25401e1f86b7-7"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;tight_layout&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;img alt="Funciones propias para la diferencia finita regular." class="align-center" src="https://nicoguaro.github.io/images/infinite_fdm/eigvecs_regular.svg" style="width: 600px;"&gt;
&lt;p&gt;Un inconveniente con este método es el muestreo redundante hacia los extremos
del intervalo mientras submuestreamos el centro.&lt;/p&gt;
&lt;/section&gt;
&lt;section id="transformando-el-dominio"&gt;
&lt;h3&gt;Transformando el dominio&lt;/h3&gt;
&lt;p&gt;Ahora, consideremos el caso en el que transormamos el dominio infinito a uno
finito usando un cambio de variable&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
\xi = \xi(x)
\end{equation*}
&lt;/div&gt;
&lt;p&gt;con &lt;span class="math"&gt;\(\xi \in (-1, 1)\)&lt;/span&gt;. Dos opciones para esta transformación son:&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;&lt;span class="math"&gt;\(\xi = \tanh x\)&lt;/span&gt;; y&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;span class="math"&gt;\(\xi = \frac{2}{\pi} \arctan x\)&lt;/span&gt;.&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Haciendo este cambio de variable la ecuación, debemos resolver
la siguiente ecuación&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
-\frac{1}{2}\left(\frac{\mathrm{d}\xi}{\mathrm{d}x}\right)^2\frac{\mathrm{d}^2}{\mathrm{d}\xi^2}\psi(\xi) - \frac{1}{2}\frac{\mathrm{d}^2\xi}{\mathrm{d}x^2}\frac{\mathrm{d}}{\mathrm{d}\xi}\psi(\xi) + V(\xi) \psi(\xi) = E\psi(\xi)
\end{equation*}
&lt;/div&gt;
&lt;p&gt;El siguiente bloque de código resuelve el problema de valores propios
en el dominio transformado:&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code python"&gt;&lt;a id="rest_code_fcfd660c15cd4a93a3cdcdeac8f91ffd-1" name="rest_code_fcfd660c15cd4a93a3cdcdeac8f91ffd-1" href="https://nicoguaro.github.io/es/posts/infinite_fdm/#rest_code_fcfd660c15cd4a93a3cdcdeac8f91ffd-1"&gt;&lt;/a&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;mapped_FD&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;pot&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;fun&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;dxdxi&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;dxdxi2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;npts&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;101&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;nvals&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;6&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;xi_tol&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mf"&gt;1e-6&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_fcfd660c15cd4a93a3cdcdeac8f91ffd-2" name="rest_code_fcfd660c15cd4a93a3cdcdeac8f91ffd-2" href="https://nicoguaro.github.io/es/posts/infinite_fdm/#rest_code_fcfd660c15cd4a93a3cdcdeac8f91ffd-2"&gt;&lt;/a&gt;    &lt;span class="sd"&gt;"""&lt;/span&gt;
&lt;a id="rest_code_fcfd660c15cd4a93a3cdcdeac8f91ffd-3" name="rest_code_fcfd660c15cd4a93a3cdcdeac8f91ffd-3" href="https://nicoguaro.github.io/es/posts/infinite_fdm/#rest_code_fcfd660c15cd4a93a3cdcdeac8f91ffd-3"&gt;&lt;/a&gt;&lt;span class="sd"&gt;    Find eigenvalues/eigenfunctions for Schrodinger&lt;/span&gt;
&lt;a id="rest_code_fcfd660c15cd4a93a3cdcdeac8f91ffd-4" name="rest_code_fcfd660c15cd4a93a3cdcdeac8f91ffd-4" href="https://nicoguaro.github.io/es/posts/infinite_fdm/#rest_code_fcfd660c15cd4a93a3cdcdeac8f91ffd-4"&gt;&lt;/a&gt;&lt;span class="sd"&gt;    equation for the given potential `pot` using&lt;/span&gt;
&lt;a id="rest_code_fcfd660c15cd4a93a3cdcdeac8f91ffd-5" name="rest_code_fcfd660c15cd4a93a3cdcdeac8f91ffd-5" href="https://nicoguaro.github.io/es/posts/infinite_fdm/#rest_code_fcfd660c15cd4a93a3cdcdeac8f91ffd-5"&gt;&lt;/a&gt;&lt;span class="sd"&gt;    finite differences over a mapped domain on (-1, 1)&lt;/span&gt;
&lt;a id="rest_code_fcfd660c15cd4a93a3cdcdeac8f91ffd-6" name="rest_code_fcfd660c15cd4a93a3cdcdeac8f91ffd-6" href="https://nicoguaro.github.io/es/posts/infinite_fdm/#rest_code_fcfd660c15cd4a93a3cdcdeac8f91ffd-6"&gt;&lt;/a&gt;&lt;span class="sd"&gt;    """&lt;/span&gt;
&lt;a id="rest_code_fcfd660c15cd4a93a3cdcdeac8f91ffd-7" name="rest_code_fcfd660c15cd4a93a3cdcdeac8f91ffd-7" href="https://nicoguaro.github.io/es/posts/infinite_fdm/#rest_code_fcfd660c15cd4a93a3cdcdeac8f91ffd-7"&gt;&lt;/a&gt;    &lt;span class="n"&gt;xi&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;linspace&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;xi_tol&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;xi_tol&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;npts&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_fcfd660c15cd4a93a3cdcdeac8f91ffd-8" name="rest_code_fcfd660c15cd4a93a3cdcdeac8f91ffd-8" href="https://nicoguaro.github.io/es/posts/infinite_fdm/#rest_code_fcfd660c15cd4a93a3cdcdeac8f91ffd-8"&gt;&lt;/a&gt;    &lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;fun&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;xi&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_fcfd660c15cd4a93a3cdcdeac8f91ffd-9" name="rest_code_fcfd660c15cd4a93a3cdcdeac8f91ffd-9" href="https://nicoguaro.github.io/es/posts/infinite_fdm/#rest_code_fcfd660c15cd4a93a3cdcdeac8f91ffd-9"&gt;&lt;/a&gt;    &lt;span class="n"&gt;dxi&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;xi&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;xi&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_fcfd660c15cd4a93a3cdcdeac8f91ffd-10" name="rest_code_fcfd660c15cd4a93a3cdcdeac8f91ffd-10" href="https://nicoguaro.github.io/es/posts/infinite_fdm/#rest_code_fcfd660c15cd4a93a3cdcdeac8f91ffd-10"&gt;&lt;/a&gt;    &lt;span class="n"&gt;D2&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;diags&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;shape&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;npts&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;npts&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;dxi&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;
&lt;a id="rest_code_fcfd660c15cd4a93a3cdcdeac8f91ffd-11" name="rest_code_fcfd660c15cd4a93a3cdcdeac8f91ffd-11" href="https://nicoguaro.github.io/es/posts/infinite_fdm/#rest_code_fcfd660c15cd4a93a3cdcdeac8f91ffd-11"&gt;&lt;/a&gt;    &lt;span class="n"&gt;D1&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;0.5&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;diags&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;shape&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;npts&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;npts&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;dxi&lt;/span&gt;
&lt;a id="rest_code_fcfd660c15cd4a93a3cdcdeac8f91ffd-12" name="rest_code_fcfd660c15cd4a93a3cdcdeac8f91ffd-12" href="https://nicoguaro.github.io/es/posts/infinite_fdm/#rest_code_fcfd660c15cd4a93a3cdcdeac8f91ffd-12"&gt;&lt;/a&gt;    &lt;span class="n"&gt;V&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;diags&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;pot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_fcfd660c15cd4a93a3cdcdeac8f91ffd-13" name="rest_code_fcfd660c15cd4a93a3cdcdeac8f91ffd-13" href="https://nicoguaro.github.io/es/posts/infinite_fdm/#rest_code_fcfd660c15cd4a93a3cdcdeac8f91ffd-13"&gt;&lt;/a&gt;    &lt;span class="n"&gt;fac1&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;diags&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;dxdxi&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;xi&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_fcfd660c15cd4a93a3cdcdeac8f91ffd-14" name="rest_code_fcfd660c15cd4a93a3cdcdeac8f91ffd-14" href="https://nicoguaro.github.io/es/posts/infinite_fdm/#rest_code_fcfd660c15cd4a93a3cdcdeac8f91ffd-14"&gt;&lt;/a&gt;    &lt;span class="n"&gt;fac2&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;diags&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;dxdxi2&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;xi&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_fcfd660c15cd4a93a3cdcdeac8f91ffd-15" name="rest_code_fcfd660c15cd4a93a3cdcdeac8f91ffd-15" href="https://nicoguaro.github.io/es/posts/infinite_fdm/#rest_code_fcfd660c15cd4a93a3cdcdeac8f91ffd-15"&gt;&lt;/a&gt;    &lt;span class="n"&gt;H&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;0.5&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;fac1&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;dot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;D2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="mf"&gt;0.5&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;fac2&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;dot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;D1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;V&lt;/span&gt;
&lt;a id="rest_code_fcfd660c15cd4a93a3cdcdeac8f91ffd-16" name="rest_code_fcfd660c15cd4a93a3cdcdeac8f91ffd-16" href="https://nicoguaro.github.io/es/posts/infinite_fdm/#rest_code_fcfd660c15cd4a93a3cdcdeac8f91ffd-16"&gt;&lt;/a&gt;    &lt;span class="n"&gt;vals&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;vecs&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;eigs&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;H&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;k&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;nvals&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;which&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;"SM"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_fcfd660c15cd4a93a3cdcdeac8f91ffd-17" name="rest_code_fcfd660c15cd4a93a3cdcdeac8f91ffd-17" href="https://nicoguaro.github.io/es/posts/infinite_fdm/#rest_code_fcfd660c15cd4a93a3cdcdeac8f91ffd-17"&gt;&lt;/a&gt;    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;real&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;vals&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;vecs&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;section id="primera-transformacion-xi-tanh-x"&gt;
&lt;h4&gt;Primera transformación: &lt;span class="math"&gt;\(\xi = \tanh(x)\)&lt;/span&gt;&lt;/h4&gt;
&lt;p&gt;Consideremos la primera transformación&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
\xi = \tanh(x)\, .
\end{equation*}
&lt;/div&gt;
&lt;p&gt;En este caso,&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
\frac{\mathrm{d}\xi}{\mathrm{d}x} = 1 - \tanh^2(x) = 1 - \xi^2\, ,
\end{equation*}
&lt;/div&gt;
&lt;p&gt;y&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
\frac{\mathrm{d}^2\xi}{\mathrm{d}x^2} = -2\tanh(x)[1 - \tanh^2(x)] = -2\xi[1 - \xi^2]\, .
\end{equation*}
&lt;/div&gt;
&lt;p&gt;Necesitamos definir las funciones&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code python"&gt;&lt;a id="rest_code_c4cae6c095c2483ebefdae1f8368de61-1" name="rest_code_c4cae6c095c2483ebefdae1f8368de61-1" href="https://nicoguaro.github.io/es/posts/infinite_fdm/#rest_code_c4cae6c095c2483ebefdae1f8368de61-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;pot&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;lambda&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="mf"&gt;0.5&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;
&lt;a id="rest_code_c4cae6c095c2483ebefdae1f8368de61-2" name="rest_code_c4cae6c095c2483ebefdae1f8368de61-2" href="https://nicoguaro.github.io/es/posts/infinite_fdm/#rest_code_c4cae6c095c2483ebefdae1f8368de61-2"&gt;&lt;/a&gt;&lt;span class="n"&gt;fun&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;lambda&lt;/span&gt; &lt;span class="n"&gt;xi&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;arctanh&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;xi&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_c4cae6c095c2483ebefdae1f8368de61-3" name="rest_code_c4cae6c095c2483ebefdae1f8368de61-3" href="https://nicoguaro.github.io/es/posts/infinite_fdm/#rest_code_c4cae6c095c2483ebefdae1f8368de61-3"&gt;&lt;/a&gt;&lt;span class="n"&gt;dxdxi&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;lambda&lt;/span&gt; &lt;span class="n"&gt;xi&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;xi&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;
&lt;a id="rest_code_c4cae6c095c2483ebefdae1f8368de61-4" name="rest_code_c4cae6c095c2483ebefdae1f8368de61-4" href="https://nicoguaro.github.io/es/posts/infinite_fdm/#rest_code_c4cae6c095c2483ebefdae1f8368de61-4"&gt;&lt;/a&gt;&lt;span class="n"&gt;dxdxi2&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;lambda&lt;/span&gt; &lt;span class="n"&gt;xi&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;xi&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;xi&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;y correr&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code python"&gt;&lt;a id="rest_code_3c370215414b4d8097e06d1c9dcaa3f4-1" name="rest_code_3c370215414b4d8097e06d1c9dcaa3f4-1" href="https://nicoguaro.github.io/es/posts/infinite_fdm/#rest_code_3c370215414b4d8097e06d1c9dcaa3f4-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;vals&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;vecs&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;mapped_FD&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;pot&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;fun&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;dxdxi&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;dxdxi2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;npts&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;201&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_3c370215414b4d8097e06d1c9dcaa3f4-2" name="rest_code_3c370215414b4d8097e06d1c9dcaa3f4-2" href="https://nicoguaro.github.io/es/posts/infinite_fdm/#rest_code_3c370215414b4d8097e06d1c9dcaa3f4-2"&gt;&lt;/a&gt;&lt;span class="n"&gt;vals&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Y obtenemos los siguientes valores propios&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code python"&gt;&lt;a id="rest_code_db8710c99d624cb3ba36c2e6142f00a4-1" name="rest_code_db8710c99d624cb3ba36c2e6142f00a4-1" href="https://nicoguaro.github.io/es/posts/infinite_fdm/#rest_code_db8710c99d624cb3ba36c2e6142f00a4-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="mf"&gt;0.49989989&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;1.4984226&lt;/span&gt; &lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;2.49003572&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;3.46934257&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;4.46935021&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;a id="rest_code_db8710c99d624cb3ba36c2e6142f00a4-2" name="rest_code_db8710c99d624cb3ba36c2e6142f00a4-2" href="https://nicoguaro.github.io/es/posts/infinite_fdm/#rest_code_db8710c99d624cb3ba36c2e6142f00a4-2"&gt;&lt;/a&gt;       &lt;span class="mf"&gt;5.59552989&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Si los comparamos con los valores analítivos obtenemos lo siguiente.&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code python"&gt;&lt;a id="rest_code_087d46809ae34c099d864bf59d87b0d3-1" name="rest_code_087d46809ae34c099d864bf59d87b0d3-1" href="https://nicoguaro.github.io/es/posts/infinite_fdm/#rest_code_087d46809ae34c099d864bf59d87b0d3-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;figure&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a id="rest_code_087d46809ae34c099d864bf59d87b0d3-2" name="rest_code_087d46809ae34c099d864bf59d87b0d3-2" href="https://nicoguaro.github.io/es/posts/infinite_fdm/#rest_code_087d46809ae34c099d864bf59d87b0d3-2"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;plot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;anal_vals&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_087d46809ae34c099d864bf59d87b0d3-3" name="rest_code_087d46809ae34c099d864bf59d87b0d3-3" href="https://nicoguaro.github.io/es/posts/infinite_fdm/#rest_code_087d46809ae34c099d864bf59d87b0d3-3"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;plot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;vals&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;"o"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_087d46809ae34c099d864bf59d87b0d3-4" name="rest_code_087d46809ae34c099d864bf59d87b0d3-4" href="https://nicoguaro.github.io/es/posts/infinite_fdm/#rest_code_087d46809ae34c099d864bf59d87b0d3-4"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;legend&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="s2"&gt;"Analytic"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;"Finite differences"&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_087d46809ae34c099d864bf59d87b0d3-5" name="rest_code_087d46809ae34c099d864bf59d87b0d3-5" href="https://nicoguaro.github.io/es/posts/infinite_fdm/#rest_code_087d46809ae34c099d864bf59d87b0d3-5"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="sa"&gt;r&lt;/span&gt;&lt;span class="s2"&gt;"$n$"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;fontsize&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;16&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_087d46809ae34c099d864bf59d87b0d3-6" name="rest_code_087d46809ae34c099d864bf59d87b0d3-6" href="https://nicoguaro.github.io/es/posts/infinite_fdm/#rest_code_087d46809ae34c099d864bf59d87b0d3-6"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ylabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="sa"&gt;r&lt;/span&gt;&lt;span class="s2"&gt;"$E_n$"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;fontsize&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;16&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_087d46809ae34c099d864bf59d87b0d3-7" name="rest_code_087d46809ae34c099d864bf59d87b0d3-7" href="https://nicoguaro.github.io/es/posts/infinite_fdm/#rest_code_087d46809ae34c099d864bf59d87b0d3-7"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;tight_layout&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;img alt="Valores propios para la primera transormación." class="align-center" src="https://nicoguaro.github.io/images/infinite_fdm/eigvals_tanh.svg" style="width: 600px;"&gt;
&lt;p&gt;Y las siguientes funciones propias.&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code python"&gt;&lt;a id="rest_code_676b70c42f7e4861809e51d9dd7a38b5-1" name="rest_code_676b70c42f7e4861809e51d9dd7a38b5-1" href="https://nicoguaro.github.io/es/posts/infinite_fdm/#rest_code_676b70c42f7e4861809e51d9dd7a38b5-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;figure&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a id="rest_code_676b70c42f7e4861809e51d9dd7a38b5-2" name="rest_code_676b70c42f7e4861809e51d9dd7a38b5-2" href="https://nicoguaro.github.io/es/posts/infinite_fdm/#rest_code_676b70c42f7e4861809e51d9dd7a38b5-2"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;plot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;abs&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;vecs&lt;/span&gt;&lt;span class="p"&gt;[:,&lt;/span&gt; &lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_676b70c42f7e4861809e51d9dd7a38b5-3" name="rest_code_676b70c42f7e4861809e51d9dd7a38b5-3" href="https://nicoguaro.github.io/es/posts/infinite_fdm/#rest_code_676b70c42f7e4861809e51d9dd7a38b5-3"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlim&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;6&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;6&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_676b70c42f7e4861809e51d9dd7a38b5-4" name="rest_code_676b70c42f7e4861809e51d9dd7a38b5-4" href="https://nicoguaro.github.io/es/posts/infinite_fdm/#rest_code_676b70c42f7e4861809e51d9dd7a38b5-4"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="sa"&gt;r&lt;/span&gt;&lt;span class="s2"&gt;"$x$"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;fontsize&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;16&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_676b70c42f7e4861809e51d9dd7a38b5-5" name="rest_code_676b70c42f7e4861809e51d9dd7a38b5-5" href="https://nicoguaro.github.io/es/posts/infinite_fdm/#rest_code_676b70c42f7e4861809e51d9dd7a38b5-5"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ylabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="sa"&gt;r&lt;/span&gt;&lt;span class="s2"&gt;"$|\psi_n(x)|^2$"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;fontsize&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;16&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_676b70c42f7e4861809e51d9dd7a38b5-6" name="rest_code_676b70c42f7e4861809e51d9dd7a38b5-6" href="https://nicoguaro.github.io/es/posts/infinite_fdm/#rest_code_676b70c42f7e4861809e51d9dd7a38b5-6"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;yticks&lt;/span&gt;&lt;span class="p"&gt;([])&lt;/span&gt;
&lt;a id="rest_code_676b70c42f7e4861809e51d9dd7a38b5-7" name="rest_code_676b70c42f7e4861809e51d9dd7a38b5-7" href="https://nicoguaro.github.io/es/posts/infinite_fdm/#rest_code_676b70c42f7e4861809e51d9dd7a38b5-7"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;tight_layout&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;img alt="Funciones propias para la primera transformación." class="align-center" src="https://nicoguaro.github.io/images/infinite_fdm/eigvecs_tanh.svg" style="width: 600px;"&gt;
&lt;/section&gt;
&lt;section id="segunda-transformacion-xi-frac-2-pi-mathrm-atan-x"&gt;
&lt;h4&gt;Segunda transformación: &lt;span class="math"&gt;\(\xi = \frac{2}{\pi}\mathrm{atan}(x)\)&lt;/span&gt;&lt;/h4&gt;
&lt;p&gt;Consideremos ahora la segunda transformación&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
\xi = \frac{2}{\pi}\mathrm{atan}(x)\, .
\end{equation*}
&lt;/div&gt;
&lt;p&gt;En este caso,&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
\frac{\mathrm{d}\xi}{\mathrm{d}x} = \frac{2}{\pi(1 + x^2)} = \frac{2 \cos^2\xi}{\pi} \, ,
\end{equation*}
&lt;/div&gt;
&lt;p&gt;y&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
\frac{\mathrm{d}^2\xi}{\mathrm{d}x^2} = -\frac{4x}{\pi(1 + x^2)^2} = -\frac{4 \cos^4\xi \tan \xi}{\pi}\, .
\end{equation*}
&lt;/div&gt;
&lt;p&gt;Una vez más, definimos las funciones&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code python"&gt;&lt;a id="rest_code_afd2239015314b9580a5c0d1861631ed-1" name="rest_code_afd2239015314b9580a5c0d1861631ed-1" href="https://nicoguaro.github.io/es/posts/infinite_fdm/#rest_code_afd2239015314b9580a5c0d1861631ed-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;pot&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;lambda&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="mf"&gt;0.5&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;
&lt;a id="rest_code_afd2239015314b9580a5c0d1861631ed-2" name="rest_code_afd2239015314b9580a5c0d1861631ed-2" href="https://nicoguaro.github.io/es/posts/infinite_fdm/#rest_code_afd2239015314b9580a5c0d1861631ed-2"&gt;&lt;/a&gt;&lt;span class="n"&gt;fun&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;lambda&lt;/span&gt; &lt;span class="n"&gt;xi&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;tan&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;0.5&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;pi&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;xi&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_afd2239015314b9580a5c0d1861631ed-3" name="rest_code_afd2239015314b9580a5c0d1861631ed-3" href="https://nicoguaro.github.io/es/posts/infinite_fdm/#rest_code_afd2239015314b9580a5c0d1861631ed-3"&gt;&lt;/a&gt;&lt;span class="n"&gt;dxdxi&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;lambda&lt;/span&gt; &lt;span class="n"&gt;xi&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;pi&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;cos&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;0.5&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;pi&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;xi&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;
&lt;a id="rest_code_afd2239015314b9580a5c0d1861631ed-4" name="rest_code_afd2239015314b9580a5c0d1861631ed-4" href="https://nicoguaro.github.io/es/posts/infinite_fdm/#rest_code_afd2239015314b9580a5c0d1861631ed-4"&gt;&lt;/a&gt;&lt;span class="n"&gt;dxdxi2&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;lambda&lt;/span&gt; &lt;span class="n"&gt;xi&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;pi&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;cos&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;0.5&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;pi&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;xi&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;tan&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;0.5&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;pi&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;xi&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;y ejecutamos&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code python"&gt;&lt;a id="rest_code_597441f136f447f08496a939569bad41-1" name="rest_code_597441f136f447f08496a939569bad41-1" href="https://nicoguaro.github.io/es/posts/infinite_fdm/#rest_code_597441f136f447f08496a939569bad41-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;vals&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;vecs&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;mapped_FD&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;pot&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;fun&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;dxdxi&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;dxdxi2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;npts&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;201&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_597441f136f447f08496a939569bad41-2" name="rest_code_597441f136f447f08496a939569bad41-2" href="https://nicoguaro.github.io/es/posts/infinite_fdm/#rest_code_597441f136f447f08496a939569bad41-2"&gt;&lt;/a&gt;&lt;span class="n"&gt;vals&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;para obtener los siguientes valores propios&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code python"&gt;&lt;a id="rest_code_b23892e80df94aa580c536182350a5a9-1" name="rest_code_b23892e80df94aa580c536182350a5a9-1" href="https://nicoguaro.github.io/es/posts/infinite_fdm/#rest_code_b23892e80df94aa580c536182350a5a9-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="mf"&gt;0.49997815&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;1.49979632&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;2.49930872&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;3.49824697&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;4.49627555&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;a id="rest_code_b23892e80df94aa580c536182350a5a9-2" name="rest_code_b23892e80df94aa580c536182350a5a9-2" href="https://nicoguaro.github.io/es/posts/infinite_fdm/#rest_code_b23892e80df94aa580c536182350a5a9-2"&gt;&lt;/a&gt;       &lt;span class="mf"&gt;5.49295665&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;con la siguiente gráfica&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code python"&gt;&lt;a id="rest_code_28b9c38eb0cf4fcc87f356061dcfa600-1" name="rest_code_28b9c38eb0cf4fcc87f356061dcfa600-1" href="https://nicoguaro.github.io/es/posts/infinite_fdm/#rest_code_28b9c38eb0cf4fcc87f356061dcfa600-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;figure&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a id="rest_code_28b9c38eb0cf4fcc87f356061dcfa600-2" name="rest_code_28b9c38eb0cf4fcc87f356061dcfa600-2" href="https://nicoguaro.github.io/es/posts/infinite_fdm/#rest_code_28b9c38eb0cf4fcc87f356061dcfa600-2"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;plot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;anal_vals&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_28b9c38eb0cf4fcc87f356061dcfa600-3" name="rest_code_28b9c38eb0cf4fcc87f356061dcfa600-3" href="https://nicoguaro.github.io/es/posts/infinite_fdm/#rest_code_28b9c38eb0cf4fcc87f356061dcfa600-3"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;plot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;vals&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;"o"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_28b9c38eb0cf4fcc87f356061dcfa600-4" name="rest_code_28b9c38eb0cf4fcc87f356061dcfa600-4" href="https://nicoguaro.github.io/es/posts/infinite_fdm/#rest_code_28b9c38eb0cf4fcc87f356061dcfa600-4"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;legend&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="s2"&gt;"Analytic"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;"Finite differences"&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_28b9c38eb0cf4fcc87f356061dcfa600-5" name="rest_code_28b9c38eb0cf4fcc87f356061dcfa600-5" href="https://nicoguaro.github.io/es/posts/infinite_fdm/#rest_code_28b9c38eb0cf4fcc87f356061dcfa600-5"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="sa"&gt;r&lt;/span&gt;&lt;span class="s2"&gt;"$n$"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;fontsize&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;16&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_28b9c38eb0cf4fcc87f356061dcfa600-6" name="rest_code_28b9c38eb0cf4fcc87f356061dcfa600-6" href="https://nicoguaro.github.io/es/posts/infinite_fdm/#rest_code_28b9c38eb0cf4fcc87f356061dcfa600-6"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ylabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="sa"&gt;r&lt;/span&gt;&lt;span class="s2"&gt;"$E_n$"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;fontsize&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;16&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_28b9c38eb0cf4fcc87f356061dcfa600-7" name="rest_code_28b9c38eb0cf4fcc87f356061dcfa600-7" href="https://nicoguaro.github.io/es/posts/infinite_fdm/#rest_code_28b9c38eb0cf4fcc87f356061dcfa600-7"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;tight_layout&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;img alt="Valores propios para la segunda transformación." class="align-center" src="https://nicoguaro.github.io/images/infinite_fdm/eigvals_atan.svg" style="width: 600px;"&gt;
&lt;p&gt;y las siguientes funciones propias.&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code python"&gt;&lt;a id="rest_code_acb6b768c302454cb963a2f9e141ac54-1" name="rest_code_acb6b768c302454cb963a2f9e141ac54-1" href="https://nicoguaro.github.io/es/posts/infinite_fdm/#rest_code_acb6b768c302454cb963a2f9e141ac54-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;figure&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a id="rest_code_acb6b768c302454cb963a2f9e141ac54-2" name="rest_code_acb6b768c302454cb963a2f9e141ac54-2" href="https://nicoguaro.github.io/es/posts/infinite_fdm/#rest_code_acb6b768c302454cb963a2f9e141ac54-2"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;plot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;abs&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;vecs&lt;/span&gt;&lt;span class="p"&gt;[:,&lt;/span&gt; &lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_acb6b768c302454cb963a2f9e141ac54-3" name="rest_code_acb6b768c302454cb963a2f9e141ac54-3" href="https://nicoguaro.github.io/es/posts/infinite_fdm/#rest_code_acb6b768c302454cb963a2f9e141ac54-3"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="sa"&gt;r&lt;/span&gt;&lt;span class="s2"&gt;"$x$"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;fontsize&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;16&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_acb6b768c302454cb963a2f9e141ac54-4" name="rest_code_acb6b768c302454cb963a2f9e141ac54-4" href="https://nicoguaro.github.io/es/posts/infinite_fdm/#rest_code_acb6b768c302454cb963a2f9e141ac54-4"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ylabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="sa"&gt;r&lt;/span&gt;&lt;span class="s2"&gt;"$|\psi|^2$"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;fontsize&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;16&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_acb6b768c302454cb963a2f9e141ac54-5" name="rest_code_acb6b768c302454cb963a2f9e141ac54-5" href="https://nicoguaro.github.io/es/posts/infinite_fdm/#rest_code_acb6b768c302454cb963a2f9e141ac54-5"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlim&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;6&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;6&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_acb6b768c302454cb963a2f9e141ac54-6" name="rest_code_acb6b768c302454cb963a2f9e141ac54-6" href="https://nicoguaro.github.io/es/posts/infinite_fdm/#rest_code_acb6b768c302454cb963a2f9e141ac54-6"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="sa"&gt;r&lt;/span&gt;&lt;span class="s2"&gt;"$x$"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;fontsize&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;16&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_acb6b768c302454cb963a2f9e141ac54-7" name="rest_code_acb6b768c302454cb963a2f9e141ac54-7" href="https://nicoguaro.github.io/es/posts/infinite_fdm/#rest_code_acb6b768c302454cb963a2f9e141ac54-7"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ylabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="sa"&gt;r&lt;/span&gt;&lt;span class="s2"&gt;"$|\psi_n(x)|^2$"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;fontsize&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;16&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_acb6b768c302454cb963a2f9e141ac54-8" name="rest_code_acb6b768c302454cb963a2f9e141ac54-8" href="https://nicoguaro.github.io/es/posts/infinite_fdm/#rest_code_acb6b768c302454cb963a2f9e141ac54-8"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;yticks&lt;/span&gt;&lt;span class="p"&gt;([])&lt;/span&gt;
&lt;a id="rest_code_acb6b768c302454cb963a2f9e141ac54-9" name="rest_code_acb6b768c302454cb963a2f9e141ac54-9" href="https://nicoguaro.github.io/es/posts/infinite_fdm/#rest_code_acb6b768c302454cb963a2f9e141ac54-9"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;tight_layout&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;img alt="Funciones propias para la segunda transformación." class="align-center" src="https://nicoguaro.github.io/images/infinite_fdm/eigvecs_atan.svg" style="width: 600px;"&gt;
&lt;/section&gt;
&lt;/section&gt;
&lt;section id="conclusion"&gt;
&lt;h3&gt;Conclusión&lt;/h3&gt;
&lt;p&gt;El método funciona bien, aunque la ecuación diferencial es más
complicada por el cambio de variable. Aunque existen métodos más
elegantes para considerar dominiso infinitos, este es lo suficientemente
simple para hacerse en 10 líneas de código.&lt;/p&gt;
&lt;p&gt;Podemos ver que la transforamción &lt;span class="math"&gt;\(\xi = \mathrm{atan}(x)\)&lt;/span&gt;, cubre
mejor el dominio que &lt;span class="math"&gt;\(\xi = \tanh(x)\)&lt;/span&gt;, donde la mayoría de los puntos
están ubicados en el centro del intervalo.&lt;/p&gt;
&lt;p&gt;¡Gracias por leer!&lt;/p&gt;
&lt;small&gt;
  &lt;i&gt;
    Esta publicación se escribió en el Jupyter notebook. Puedes
    &lt;a href="https://nicoguaro.github.io/es/downloads/notebooks/finite_diff_map.ipynb"&gt;descargar&lt;/a&gt;
    este notebook, o ver una versión estática en
    &lt;a href="http://nbviewer.jupyter.org/url/nicoguaro.github.io/downloads/notebooks/finite_diff_map.ipynb"&gt;nbviewer&lt;/a&gt;.
  &lt;i&gt;
&lt;/i&gt;&lt;/i&gt;&lt;/small&gt;&lt;/section&gt;
&lt;/section&gt;</description><category>computación científica</category><category>edp</category><category>método de diferencias finitas</category><category>python</category><guid>https://nicoguaro.github.io/es/posts/infinite_fdm/</guid><pubDate>Thu, 17 May 2018 20:57:00 GMT</pubDate></item><item><title>Comparación de mapas de colores cíclicos</title><link>https://nicoguaro.github.io/es/posts/cyclic_colormaps/</link><dc:creator>Nicolás Guarín-Zapata</dc:creator><description>&lt;p&gt;Empecé esta publicación buscando implementaciones de
&lt;a class="reference external" href="https://en.wikipedia.org/wiki/Diffusion_map"&gt;mapas de difusión&lt;/a&gt;
en Python, que no pude encontrar. Me puse entonces a seguir un
&lt;a class="reference external" href="http://scikit-learn.org/stable/auto_examples/manifold/plot_compare_methods.html#sphx-glr-auto-examples-manifold-plot-compare-methods-py"&gt;ejemplo&lt;/a&gt;
sobre &lt;a class="reference external" href="https://en.wikipedia.org/wiki/Nonlinear_dimensionality_reduction"&gt;aprendizaje de variedades&lt;/a&gt;
de &lt;a class="reference external" href="https://jakevdp.github.io/"&gt;Jake Vanderplas&lt;/a&gt; en un &lt;a class="reference external" href="https://commons.wikimedia.org/wiki/File:Diffusion_map_of_a_torodial_helix.jpg"&gt;conjunto de datos diferente&lt;/a&gt;.
Y funcionó bien&lt;/p&gt;
&lt;img alt="/images/manifold_learning_toroidal_helix.svg" src="https://nicoguaro.github.io/images/manifold_learning_toroidal_helix.svg"&gt;
&lt;p&gt;pero el mapa de color es &lt;a class="reference external" href="https://matplotlib.org/examples/color/colormaps_reference.html"&gt;"Spectral"&lt;/a&gt;,
que es divergente. Esto me puso a pensar acerca de usar un mapa de
colores cícliclo, y terminé en esta pregunta de
&lt;a class="reference external" href="https://stackoverflow.com/q/23712207/3358223"&gt;StackOverflow&lt;/a&gt;.
Y decidí comparar algunos mapas de colores cíclicos.&lt;/p&gt;
&lt;p&gt;Elegí mapas de colores de diferentes fuentes&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference external" href="https://matplotlib.org/cmocean/"&gt;cmocean&lt;/a&gt;:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;phase&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference external" href="http://paraview.org/"&gt;Paraview&lt;/a&gt;:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;hue_L60&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;erdc_iceFire&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;nic_Edge&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference external" href="https://github.com/bokeh/colorcet"&gt;Colorcet&lt;/a&gt;:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;colorwheel&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;cyclic_mrybm_35_75_c68&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;cyclic_mygbm_30_95_c78&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;y, obviamente, &lt;code class="docutils literal"&gt;hsv&lt;/code&gt;. Los mapas de colores en formato de texto
plano se pueden descargar &lt;a class="reference external" href="https://nicoguaro.github.io/downloads/cyclic_colormaps.zip"&gt;aquí&lt;/a&gt;.&lt;/p&gt;
&lt;section id="comparacion"&gt;
&lt;h2&gt;Comparación&lt;/h2&gt;
&lt;p&gt;Para todos los ejemplos se importaron los siguientes módulos:&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code python"&gt;&lt;a id="rest_code_41672f70e9a04a88ac28d749a7653ab7-1" name="rest_code_41672f70e9a04a88ac28d749a7653ab7-1" href="https://nicoguaro.github.io/es/posts/cyclic_colormaps/#rest_code_41672f70e9a04a88ac28d749a7653ab7-1"&gt;&lt;/a&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;__future__&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;division&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;print_function&lt;/span&gt;
&lt;a id="rest_code_41672f70e9a04a88ac28d749a7653ab7-2" name="rest_code_41672f70e9a04a88ac28d749a7653ab7-2" href="https://nicoguaro.github.io/es/posts/cyclic_colormaps/#rest_code_41672f70e9a04a88ac28d749a7653ab7-2"&gt;&lt;/a&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;numpy&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;np&lt;/span&gt;
&lt;a id="rest_code_41672f70e9a04a88ac28d749a7653ab7-3" name="rest_code_41672f70e9a04a88ac28d749a7653ab7-3" href="https://nicoguaro.github.io/es/posts/cyclic_colormaps/#rest_code_41672f70e9a04a88ac28d749a7653ab7-3"&gt;&lt;/a&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;matplotlib.pyplot&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;plt&lt;/span&gt;
&lt;a id="rest_code_41672f70e9a04a88ac28d749a7653ab7-4" name="rest_code_41672f70e9a04a88ac28d749a7653ab7-4" href="https://nicoguaro.github.io/es/posts/cyclic_colormaps/#rest_code_41672f70e9a04a88ac28d749a7653ab7-4"&gt;&lt;/a&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;matplotlib.colors&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;LinearSegmentedColormap&lt;/span&gt;
&lt;a id="rest_code_41672f70e9a04a88ac28d749a7653ab7-5" name="rest_code_41672f70e9a04a88ac28d749a7653ab7-5" href="https://nicoguaro.github.io/es/posts/cyclic_colormaps/#rest_code_41672f70e9a04a88ac28d749a7653ab7-5"&gt;&lt;/a&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;colorspacious&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;cspace_convert&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;section id="imagen-de-prueba"&gt;
&lt;h3&gt;Imagen de prueba&lt;/h3&gt;
&lt;p&gt;Peter Kovesi propuso una manera de comparar mapas de colores
cíclicos en un
&lt;a class="reference external" href="http://peterkovesi.com/projects/colourmaps/colourmaptestimage.html"&gt;artículo&lt;/a&gt;
en 2015. Consta de una rampa en espiral con ondulaciones. En
coordenadas polares es&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
c = (A \rho^p \sin(n \theta) + \theta)\, \mathrm{mod}\, 2\pi
\end{equation*}
&lt;/div&gt;
&lt;p&gt;con &lt;span class="math"&gt;\(A\)&lt;/span&gt; la amplitud de la oscilación, &lt;span class="math"&gt;\(\rho\)&lt;/span&gt;
el radio normalizado en [0, 1], &lt;span class="math"&gt;\(p\)&lt;/span&gt; un número positivo,
y &lt;span class="math"&gt;\(n\)&lt;/span&gt; el número de ciclos.&lt;/p&gt;
&lt;p&gt;Y la siguiente función crea la rejilla en Python.&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code python"&gt;&lt;a id="rest_code_90fa879cff384650b2fcc90da502be21-1" name="rest_code_90fa879cff384650b2fcc90da502be21-1" href="https://nicoguaro.github.io/es/posts/cyclic_colormaps/#rest_code_90fa879cff384650b2fcc90da502be21-1"&gt;&lt;/a&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;circle_sine_ramp&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;r_max&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;r_min&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mf"&gt;0.3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;amp&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;pi&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;cycles&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;50&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;a id="rest_code_90fa879cff384650b2fcc90da502be21-2" name="rest_code_90fa879cff384650b2fcc90da502be21-2" href="https://nicoguaro.github.io/es/posts/cyclic_colormaps/#rest_code_90fa879cff384650b2fcc90da502be21-2"&gt;&lt;/a&gt;                     &lt;span class="n"&gt;power&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;nr&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;50&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;ntheta&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;1025&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_90fa879cff384650b2fcc90da502be21-3" name="rest_code_90fa879cff384650b2fcc90da502be21-3" href="https://nicoguaro.github.io/es/posts/cyclic_colormaps/#rest_code_90fa879cff384650b2fcc90da502be21-3"&gt;&lt;/a&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;t&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;mgrid&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;r_min&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="n"&gt;r_max&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="n"&gt;nr&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;pi&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="n"&gt;ntheta&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_90fa879cff384650b2fcc90da502be21-4" name="rest_code_90fa879cff384650b2fcc90da502be21-4" href="https://nicoguaro.github.io/es/posts/cyclic_colormaps/#rest_code_90fa879cff384650b2fcc90da502be21-4"&gt;&lt;/a&gt;&lt;span class="n"&gt;r_norm&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;r_min&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;r_max&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;r_min&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_90fa879cff384650b2fcc90da502be21-5" name="rest_code_90fa879cff384650b2fcc90da502be21-5" href="https://nicoguaro.github.io/es/posts/cyclic_colormaps/#rest_code_90fa879cff384650b2fcc90da502be21-5"&gt;&lt;/a&gt;&lt;span class="n"&gt;vals&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;amp&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;r_norm&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="n"&gt;power&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sin&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;cycles&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;t&lt;/span&gt;
&lt;a id="rest_code_90fa879cff384650b2fcc90da502be21-6" name="rest_code_90fa879cff384650b2fcc90da502be21-6" href="https://nicoguaro.github.io/es/posts/cyclic_colormaps/#rest_code_90fa879cff384650b2fcc90da502be21-6"&gt;&lt;/a&gt;&lt;span class="n"&gt;vals&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;mod&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;vals&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;pi&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_90fa879cff384650b2fcc90da502be21-7" name="rest_code_90fa879cff384650b2fcc90da502be21-7" href="https://nicoguaro.github.io/es/posts/cyclic_colormaps/#rest_code_90fa879cff384650b2fcc90da502be21-7"&gt;&lt;/a&gt;&lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;vals&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;El resultado es el siguiente&lt;/p&gt;
&lt;img alt="/images/sine_helix_cyclic_cmap.png" src="https://nicoguaro.github.io/images/sine_helix_cyclic_cmap.png"&gt;
&lt;/section&gt;
&lt;section id="prueba-para-daltonismo"&gt;
&lt;h3&gt;Prueba para daltonismo&lt;/h3&gt;
&lt;div class="code"&gt;&lt;pre class="code python"&gt;&lt;a id="rest_code_ac7558cb028b4c6a8fd09665213b9d27-1" name="rest_code_ac7558cb028b4c6a8fd09665213b9d27-1" href="https://nicoguaro.github.io/es/posts/cyclic_colormaps/#rest_code_ac7558cb028b4c6a8fd09665213b9d27-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;vals&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;circle_sine_ramp&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;cycles&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_ac7558cb028b4c6a8fd09665213b9d27-2" name="rest_code_ac7558cb028b4c6a8fd09665213b9d27-2" href="https://nicoguaro.github.io/es/posts/cyclic_colormaps/#rest_code_ac7558cb028b4c6a8fd09665213b9d27-2"&gt;&lt;/a&gt;&lt;span class="n"&gt;cmaps&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;"hsv"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;a id="rest_code_ac7558cb028b4c6a8fd09665213b9d27-3" name="rest_code_ac7558cb028b4c6a8fd09665213b9d27-3" href="https://nicoguaro.github.io/es/posts/cyclic_colormaps/#rest_code_ac7558cb028b4c6a8fd09665213b9d27-3"&gt;&lt;/a&gt;         &lt;span class="s2"&gt;"cmocean_phase"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;a id="rest_code_ac7558cb028b4c6a8fd09665213b9d27-4" name="rest_code_ac7558cb028b4c6a8fd09665213b9d27-4" href="https://nicoguaro.github.io/es/posts/cyclic_colormaps/#rest_code_ac7558cb028b4c6a8fd09665213b9d27-4"&gt;&lt;/a&gt;         &lt;span class="s2"&gt;"hue_L60"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;a id="rest_code_ac7558cb028b4c6a8fd09665213b9d27-5" name="rest_code_ac7558cb028b4c6a8fd09665213b9d27-5" href="https://nicoguaro.github.io/es/posts/cyclic_colormaps/#rest_code_ac7558cb028b4c6a8fd09665213b9d27-5"&gt;&lt;/a&gt;         &lt;span class="s2"&gt;"erdc_iceFire"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;a id="rest_code_ac7558cb028b4c6a8fd09665213b9d27-6" name="rest_code_ac7558cb028b4c6a8fd09665213b9d27-6" href="https://nicoguaro.github.io/es/posts/cyclic_colormaps/#rest_code_ac7558cb028b4c6a8fd09665213b9d27-6"&gt;&lt;/a&gt;         &lt;span class="s2"&gt;"nic_Edge"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;a id="rest_code_ac7558cb028b4c6a8fd09665213b9d27-7" name="rest_code_ac7558cb028b4c6a8fd09665213b9d27-7" href="https://nicoguaro.github.io/es/posts/cyclic_colormaps/#rest_code_ac7558cb028b4c6a8fd09665213b9d27-7"&gt;&lt;/a&gt;         &lt;span class="s2"&gt;"colorwheel"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;a id="rest_code_ac7558cb028b4c6a8fd09665213b9d27-8" name="rest_code_ac7558cb028b4c6a8fd09665213b9d27-8" href="https://nicoguaro.github.io/es/posts/cyclic_colormaps/#rest_code_ac7558cb028b4c6a8fd09665213b9d27-8"&gt;&lt;/a&gt;         &lt;span class="s2"&gt;"cyclic_mrybm"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;a id="rest_code_ac7558cb028b4c6a8fd09665213b9d27-9" name="rest_code_ac7558cb028b4c6a8fd09665213b9d27-9" href="https://nicoguaro.github.io/es/posts/cyclic_colormaps/#rest_code_ac7558cb028b4c6a8fd09665213b9d27-9"&gt;&lt;/a&gt;         &lt;span class="s2"&gt;"cyclic_mygbm"&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_ac7558cb028b4c6a8fd09665213b9d27-10" name="rest_code_ac7558cb028b4c6a8fd09665213b9d27-10" href="https://nicoguaro.github.io/es/posts/cyclic_colormaps/#rest_code_ac7558cb028b4c6a8fd09665213b9d27-10"&gt;&lt;/a&gt;&lt;span class="n"&gt;severity&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;50&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;50&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;50&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_ac7558cb028b4c6a8fd09665213b9d27-11" name="rest_code_ac7558cb028b4c6a8fd09665213b9d27-11" href="https://nicoguaro.github.io/es/posts/cyclic_colormaps/#rest_code_ac7558cb028b4c6a8fd09665213b9d27-11"&gt;&lt;/a&gt;&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;colormap&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;cmaps&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a id="rest_code_ac7558cb028b4c6a8fd09665213b9d27-12" name="rest_code_ac7558cb028b4c6a8fd09665213b9d27-12" href="https://nicoguaro.github.io/es/posts/cyclic_colormaps/#rest_code_ac7558cb028b4c6a8fd09665213b9d27-12"&gt;&lt;/a&gt;    &lt;span class="n"&gt;data&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;loadtxt&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;colormap&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="s2"&gt;".txt"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_ac7558cb028b4c6a8fd09665213b9d27-13" name="rest_code_ac7558cb028b4c6a8fd09665213b9d27-13" href="https://nicoguaro.github.io/es/posts/cyclic_colormaps/#rest_code_ac7558cb028b4c6a8fd09665213b9d27-13"&gt;&lt;/a&gt;    &lt;span class="n"&gt;fig&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;figure&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a id="rest_code_ac7558cb028b4c6a8fd09665213b9d27-14" name="rest_code_ac7558cb028b4c6a8fd09665213b9d27-14" href="https://nicoguaro.github.io/es/posts/cyclic_colormaps/#rest_code_ac7558cb028b4c6a8fd09665213b9d27-14"&gt;&lt;/a&gt;    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;cont&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_ac7558cb028b4c6a8fd09665213b9d27-15" name="rest_code_ac7558cb028b4c6a8fd09665213b9d27-15" href="https://nicoguaro.github.io/es/posts/cyclic_colormaps/#rest_code_ac7558cb028b4c6a8fd09665213b9d27-15"&gt;&lt;/a&gt;        &lt;span class="n"&gt;cvd_space&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="s2"&gt;"name"&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s2"&gt;"sRGB1+CVD"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;a id="rest_code_ac7558cb028b4c6a8fd09665213b9d27-16" name="rest_code_ac7558cb028b4c6a8fd09665213b9d27-16" href="https://nicoguaro.github.io/es/posts/cyclic_colormaps/#rest_code_ac7558cb028b4c6a8fd09665213b9d27-16"&gt;&lt;/a&gt;             &lt;span class="s2"&gt;"cvd_type"&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;cvd_type&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;cont&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;
&lt;a id="rest_code_ac7558cb028b4c6a8fd09665213b9d27-17" name="rest_code_ac7558cb028b4c6a8fd09665213b9d27-17" href="https://nicoguaro.github.io/es/posts/cyclic_colormaps/#rest_code_ac7558cb028b4c6a8fd09665213b9d27-17"&gt;&lt;/a&gt;             &lt;span class="s2"&gt;"severity"&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;severity&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;cont&lt;/span&gt;&lt;span class="p"&gt;]}&lt;/span&gt;
&lt;a id="rest_code_ac7558cb028b4c6a8fd09665213b9d27-18" name="rest_code_ac7558cb028b4c6a8fd09665213b9d27-18" href="https://nicoguaro.github.io/es/posts/cyclic_colormaps/#rest_code_ac7558cb028b4c6a8fd09665213b9d27-18"&gt;&lt;/a&gt;        &lt;span class="n"&gt;data2&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;cspace_convert&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;cvd_space&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;"sRGB1"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_ac7558cb028b4c6a8fd09665213b9d27-19" name="rest_code_ac7558cb028b4c6a8fd09665213b9d27-19" href="https://nicoguaro.github.io/es/posts/cyclic_colormaps/#rest_code_ac7558cb028b4c6a8fd09665213b9d27-19"&gt;&lt;/a&gt;        &lt;span class="n"&gt;data2&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;clip&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;data2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_ac7558cb028b4c6a8fd09665213b9d27-20" name="rest_code_ac7558cb028b4c6a8fd09665213b9d27-20" href="https://nicoguaro.github.io/es/posts/cyclic_colormaps/#rest_code_ac7558cb028b4c6a8fd09665213b9d27-20"&gt;&lt;/a&gt;        &lt;span class="n"&gt;cmap&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;LinearSegmentedColormap&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;from_list&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'my_colormap'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;data2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_ac7558cb028b4c6a8fd09665213b9d27-21" name="rest_code_ac7558cb028b4c6a8fd09665213b9d27-21" href="https://nicoguaro.github.io/es/posts/cyclic_colormaps/#rest_code_ac7558cb028b4c6a8fd09665213b9d27-21"&gt;&lt;/a&gt;        &lt;span class="n"&gt;ax&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;subplot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;cont&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;projection&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;"polar"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_ac7558cb028b4c6a8fd09665213b9d27-22" name="rest_code_ac7558cb028b4c6a8fd09665213b9d27-22" href="https://nicoguaro.github.io/es/posts/cyclic_colormaps/#rest_code_ac7558cb028b4c6a8fd09665213b9d27-22"&gt;&lt;/a&gt;        &lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;pcolormesh&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;vals&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;cmap&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;cmap&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_ac7558cb028b4c6a8fd09665213b9d27-23" name="rest_code_ac7558cb028b4c6a8fd09665213b9d27-23" href="https://nicoguaro.github.io/es/posts/cyclic_colormaps/#rest_code_ac7558cb028b4c6a8fd09665213b9d27-23"&gt;&lt;/a&gt;        &lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_xticks&lt;/span&gt;&lt;span class="p"&gt;([])&lt;/span&gt;
&lt;a id="rest_code_ac7558cb028b4c6a8fd09665213b9d27-24" name="rest_code_ac7558cb028b4c6a8fd09665213b9d27-24" href="https://nicoguaro.github.io/es/posts/cyclic_colormaps/#rest_code_ac7558cb028b4c6a8fd09665213b9d27-24"&gt;&lt;/a&gt;        &lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_yticks&lt;/span&gt;&lt;span class="p"&gt;([])&lt;/span&gt;
&lt;a id="rest_code_ac7558cb028b4c6a8fd09665213b9d27-25" name="rest_code_ac7558cb028b4c6a8fd09665213b9d27-25" href="https://nicoguaro.github.io/es/posts/cyclic_colormaps/#rest_code_ac7558cb028b4c6a8fd09665213b9d27-25"&gt;&lt;/a&gt;    &lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;suptitle&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;colormap&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_ac7558cb028b4c6a8fd09665213b9d27-26" name="rest_code_ac7558cb028b4c6a8fd09665213b9d27-26" href="https://nicoguaro.github.io/es/posts/cyclic_colormaps/#rest_code_ac7558cb028b4c6a8fd09665213b9d27-26"&gt;&lt;/a&gt;    &lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;tight_layout&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a id="rest_code_ac7558cb028b4c6a8fd09665213b9d27-27" name="rest_code_ac7558cb028b4c6a8fd09665213b9d27-27" href="https://nicoguaro.github.io/es/posts/cyclic_colormaps/#rest_code_ac7558cb028b4c6a8fd09665213b9d27-27"&gt;&lt;/a&gt;    &lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;savefig&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;colormap&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="s2"&gt;".png"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;dpi&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;300&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;figure class="align-center"&gt;
&lt;img alt="/images/hsv_eval.png" src="https://nicoguaro.github.io/images/hsv_eval.png"&gt;
&lt;figcaption&gt;
&lt;p&gt;Comparación de &lt;code class="docutils literal"&gt;hsv&lt;/code&gt; para diferentes deficiencias visuales
del color.&lt;/p&gt;
&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;figure class="align-center"&gt;
&lt;img alt="/images/cmocean_phase_eval.png" src="https://nicoguaro.github.io/images/cmocean_phase_eval.png"&gt;
&lt;figcaption&gt;
&lt;p&gt;Comparación de &lt;code class="docutils literal"&gt;Phase&lt;/code&gt; para diferentes deficiencias visuales
del color.&lt;/p&gt;
&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;figure class="align-center"&gt;
&lt;img alt="/images/hue_L60_eval.png" src="https://nicoguaro.github.io/images/hue_L60_eval.png"&gt;
&lt;figcaption&gt;
&lt;p&gt;Comparación de &lt;code class="docutils literal"&gt;hue_L60&lt;/code&gt; para diferentes deficiencias visuales
del color.&lt;/p&gt;
&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;figure class="align-center"&gt;
&lt;img alt="/images/erdc_iceFire_eval.png" src="https://nicoguaro.github.io/images/erdc_iceFire_eval.png"&gt;
&lt;figcaption&gt;
&lt;p&gt;Comparación de &lt;code class="docutils literal"&gt;erdc_iceFire&lt;/code&gt; para diferentes deficiencias visuales
del color.&lt;/p&gt;
&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;figure class="align-center"&gt;
&lt;img alt="/images/nic_Edge_eval.png" src="https://nicoguaro.github.io/images/nic_Edge_eval.png"&gt;
&lt;figcaption&gt;
&lt;p&gt;Comparación de &lt;code class="docutils literal"&gt;nic_Edge&lt;/code&gt; para diferentes deficiencias visuales
del color.&lt;/p&gt;
&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;figure class="align-center"&gt;
&lt;img alt="/images/colorwheel_eval.png" src="https://nicoguaro.github.io/images/colorwheel_eval.png"&gt;
&lt;figcaption&gt;
&lt;p&gt;Comparación de &lt;code class="docutils literal"&gt;Colorwheel&lt;/code&gt; para diferentes deficiencias visuales
del color.&lt;/p&gt;
&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;figure class="align-center"&gt;
&lt;img alt="/images/cyclic_mrybm_eval.png" src="https://nicoguaro.github.io/images/cyclic_mrybm_eval.png"&gt;
&lt;figcaption&gt;
&lt;p&gt;Comparación de &lt;code class="docutils literal"&gt;Cyclic_mrybm&lt;/code&gt; para diferentes deficiencias visuales
del color.&lt;/p&gt;
&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;figure class="align-center"&gt;
&lt;img alt="/images/cyclic_mygbm_eval.png" src="https://nicoguaro.github.io/images/cyclic_mygbm_eval.png"&gt;
&lt;figcaption&gt;
&lt;p&gt;Comparación de &lt;code class="docutils literal"&gt;Cyclic_mygbm&lt;/code&gt; para diferentes deficiencias visuales
del color.&lt;/p&gt;
&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;/section&gt;
&lt;/section&gt;
&lt;section id="mapas-de-colores-ciclicos-generados-aleatoriamente"&gt;
&lt;h2&gt;Mapas de colores cíclicos generados aleatoriamente&lt;/h2&gt;
&lt;p&gt;¿Qué pasa si generamos mapas de colores cíclicos aleatoriamente?
¿Cómo lucirían?&lt;/p&gt;
&lt;p&gt;A continuación están las piezas de código y mapas de colores
resultantes.&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code python"&gt;&lt;a id="rest_code_fe89e79abf514dfe9eb8e4ccb2b9c293-1" name="rest_code_fe89e79abf514dfe9eb8e4ccb2b9c293-1" href="https://nicoguaro.github.io/es/posts/cyclic_colormaps/#rest_code_fe89e79abf514dfe9eb8e4ccb2b9c293-1"&gt;&lt;/a&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;__future__&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;division&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;print_function&lt;/span&gt;
&lt;a id="rest_code_fe89e79abf514dfe9eb8e4ccb2b9c293-2" name="rest_code_fe89e79abf514dfe9eb8e4ccb2b9c293-2" href="https://nicoguaro.github.io/es/posts/cyclic_colormaps/#rest_code_fe89e79abf514dfe9eb8e4ccb2b9c293-2"&gt;&lt;/a&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;numpy&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;np&lt;/span&gt;
&lt;a id="rest_code_fe89e79abf514dfe9eb8e4ccb2b9c293-3" name="rest_code_fe89e79abf514dfe9eb8e4ccb2b9c293-3" href="https://nicoguaro.github.io/es/posts/cyclic_colormaps/#rest_code_fe89e79abf514dfe9eb8e4ccb2b9c293-3"&gt;&lt;/a&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;mpl_toolkits.mplot3d&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;Axes3D&lt;/span&gt;
&lt;a id="rest_code_fe89e79abf514dfe9eb8e4ccb2b9c293-4" name="rest_code_fe89e79abf514dfe9eb8e4ccb2b9c293-4" href="https://nicoguaro.github.io/es/posts/cyclic_colormaps/#rest_code_fe89e79abf514dfe9eb8e4ccb2b9c293-4"&gt;&lt;/a&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;matplotlib.pyplot&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;plt&lt;/span&gt;
&lt;a id="rest_code_fe89e79abf514dfe9eb8e4ccb2b9c293-5" name="rest_code_fe89e79abf514dfe9eb8e4ccb2b9c293-5" href="https://nicoguaro.github.io/es/posts/cyclic_colormaps/#rest_code_fe89e79abf514dfe9eb8e4ccb2b9c293-5"&gt;&lt;/a&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;matplotlib.colors&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;LinearSegmentedColormap&lt;/span&gt;
&lt;a id="rest_code_fe89e79abf514dfe9eb8e4ccb2b9c293-6" name="rest_code_fe89e79abf514dfe9eb8e4ccb2b9c293-6" href="https://nicoguaro.github.io/es/posts/cyclic_colormaps/#rest_code_fe89e79abf514dfe9eb8e4ccb2b9c293-6"&gt;&lt;/a&gt;
&lt;a id="rest_code_fe89e79abf514dfe9eb8e4ccb2b9c293-7" name="rest_code_fe89e79abf514dfe9eb8e4ccb2b9c293-7" href="https://nicoguaro.github.io/es/posts/cyclic_colormaps/#rest_code_fe89e79abf514dfe9eb8e4ccb2b9c293-7"&gt;&lt;/a&gt;
&lt;a id="rest_code_fe89e79abf514dfe9eb8e4ccb2b9c293-8" name="rest_code_fe89e79abf514dfe9eb8e4ccb2b9c293-8" href="https://nicoguaro.github.io/es/posts/cyclic_colormaps/#rest_code_fe89e79abf514dfe9eb8e4ccb2b9c293-8"&gt;&lt;/a&gt;&lt;span class="c1"&gt;# Next line to silence pyflakes. This import is needed.&lt;/span&gt;
&lt;a id="rest_code_fe89e79abf514dfe9eb8e4ccb2b9c293-9" name="rest_code_fe89e79abf514dfe9eb8e4ccb2b9c293-9" href="https://nicoguaro.github.io/es/posts/cyclic_colormaps/#rest_code_fe89e79abf514dfe9eb8e4ccb2b9c293-9"&gt;&lt;/a&gt;&lt;span class="n"&gt;Axes3D&lt;/span&gt;
&lt;a id="rest_code_fe89e79abf514dfe9eb8e4ccb2b9c293-10" name="rest_code_fe89e79abf514dfe9eb8e4ccb2b9c293-10" href="https://nicoguaro.github.io/es/posts/cyclic_colormaps/#rest_code_fe89e79abf514dfe9eb8e4ccb2b9c293-10"&gt;&lt;/a&gt;
&lt;a id="rest_code_fe89e79abf514dfe9eb8e4ccb2b9c293-11" name="rest_code_fe89e79abf514dfe9eb8e4ccb2b9c293-11" href="https://nicoguaro.github.io/es/posts/cyclic_colormaps/#rest_code_fe89e79abf514dfe9eb8e4ccb2b9c293-11"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;close&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"all"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_fe89e79abf514dfe9eb8e4ccb2b9c293-12" name="rest_code_fe89e79abf514dfe9eb8e4ccb2b9c293-12" href="https://nicoguaro.github.io/es/posts/cyclic_colormaps/#rest_code_fe89e79abf514dfe9eb8e4ccb2b9c293-12"&gt;&lt;/a&gt;&lt;span class="n"&gt;fig&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;figure&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a id="rest_code_fe89e79abf514dfe9eb8e4ccb2b9c293-13" name="rest_code_fe89e79abf514dfe9eb8e4ccb2b9c293-13" href="https://nicoguaro.github.io/es/posts/cyclic_colormaps/#rest_code_fe89e79abf514dfe9eb8e4ccb2b9c293-13"&gt;&lt;/a&gt;&lt;span class="n"&gt;fig2&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;figure&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a id="rest_code_fe89e79abf514dfe9eb8e4ccb2b9c293-14" name="rest_code_fe89e79abf514dfe9eb8e4ccb2b9c293-14" href="https://nicoguaro.github.io/es/posts/cyclic_colormaps/#rest_code_fe89e79abf514dfe9eb8e4ccb2b9c293-14"&gt;&lt;/a&gt;&lt;span class="n"&gt;nx&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;4&lt;/span&gt;
&lt;a id="rest_code_fe89e79abf514dfe9eb8e4ccb2b9c293-15" name="rest_code_fe89e79abf514dfe9eb8e4ccb2b9c293-15" href="https://nicoguaro.github.io/es/posts/cyclic_colormaps/#rest_code_fe89e79abf514dfe9eb8e4ccb2b9c293-15"&gt;&lt;/a&gt;&lt;span class="n"&gt;ny&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;4&lt;/span&gt;
&lt;a id="rest_code_fe89e79abf514dfe9eb8e4ccb2b9c293-16" name="rest_code_fe89e79abf514dfe9eb8e4ccb2b9c293-16" href="https://nicoguaro.github.io/es/posts/cyclic_colormaps/#rest_code_fe89e79abf514dfe9eb8e4ccb2b9c293-16"&gt;&lt;/a&gt;&lt;span class="n"&gt;azimuths&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;arange&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;361&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_fe89e79abf514dfe9eb8e4ccb2b9c293-17" name="rest_code_fe89e79abf514dfe9eb8e4ccb2b9c293-17" href="https://nicoguaro.github.io/es/posts/cyclic_colormaps/#rest_code_fe89e79abf514dfe9eb8e4ccb2b9c293-17"&gt;&lt;/a&gt;&lt;span class="n"&gt;zeniths&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;arange&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;30&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;70&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_fe89e79abf514dfe9eb8e4ccb2b9c293-18" name="rest_code_fe89e79abf514dfe9eb8e4ccb2b9c293-18" href="https://nicoguaro.github.io/es/posts/cyclic_colormaps/#rest_code_fe89e79abf514dfe9eb8e4ccb2b9c293-18"&gt;&lt;/a&gt;&lt;span class="n"&gt;values&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;azimuths&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ones&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="mi"&gt;30&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;361&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_fe89e79abf514dfe9eb8e4ccb2b9c293-19" name="rest_code_fe89e79abf514dfe9eb8e4ccb2b9c293-19" href="https://nicoguaro.github.io/es/posts/cyclic_colormaps/#rest_code_fe89e79abf514dfe9eb8e4ccb2b9c293-19"&gt;&lt;/a&gt;&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;cont&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;nx&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;ny&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_fe89e79abf514dfe9eb8e4ccb2b9c293-20" name="rest_code_fe89e79abf514dfe9eb8e4ccb2b9c293-20" href="https://nicoguaro.github.io/es/posts/cyclic_colormaps/#rest_code_fe89e79abf514dfe9eb8e4ccb2b9c293-20"&gt;&lt;/a&gt;    &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;random&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;seed&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;seed&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;cont&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_fe89e79abf514dfe9eb8e4ccb2b9c293-21" name="rest_code_fe89e79abf514dfe9eb8e4ccb2b9c293-21" href="https://nicoguaro.github.io/es/posts/cyclic_colormaps/#rest_code_fe89e79abf514dfe9eb8e4ccb2b9c293-21"&gt;&lt;/a&gt;    &lt;span class="n"&gt;rad&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;random&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;uniform&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;0.1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.5&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_fe89e79abf514dfe9eb8e4ccb2b9c293-22" name="rest_code_fe89e79abf514dfe9eb8e4ccb2b9c293-22" href="https://nicoguaro.github.io/es/posts/cyclic_colormaps/#rest_code_fe89e79abf514dfe9eb8e4ccb2b9c293-22"&gt;&lt;/a&gt;    &lt;span class="n"&gt;center&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;random&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;uniform&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;rad&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;rad&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;size&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_fe89e79abf514dfe9eb8e4ccb2b9c293-23" name="rest_code_fe89e79abf514dfe9eb8e4ccb2b9c293-23" href="https://nicoguaro.github.io/es/posts/cyclic_colormaps/#rest_code_fe89e79abf514dfe9eb8e4ccb2b9c293-23"&gt;&lt;/a&gt;    &lt;span class="n"&gt;mat&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;random&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;rand&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_fe89e79abf514dfe9eb8e4ccb2b9c293-24" name="rest_code_fe89e79abf514dfe9eb8e4ccb2b9c293-24" href="https://nicoguaro.github.io/es/posts/cyclic_colormaps/#rest_code_fe89e79abf514dfe9eb8e4ccb2b9c293-24"&gt;&lt;/a&gt;    &lt;span class="n"&gt;rot_mat&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;_&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;linalg&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;qr&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;mat&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_fe89e79abf514dfe9eb8e4ccb2b9c293-25" name="rest_code_fe89e79abf514dfe9eb8e4ccb2b9c293-25" href="https://nicoguaro.github.io/es/posts/cyclic_colormaps/#rest_code_fe89e79abf514dfe9eb8e4ccb2b9c293-25"&gt;&lt;/a&gt;    &lt;span class="n"&gt;t&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;linspace&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;pi&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;256&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_fe89e79abf514dfe9eb8e4ccb2b9c293-26" name="rest_code_fe89e79abf514dfe9eb8e4ccb2b9c293-26" href="https://nicoguaro.github.io/es/posts/cyclic_colormaps/#rest_code_fe89e79abf514dfe9eb8e4ccb2b9c293-26"&gt;&lt;/a&gt;    &lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;rad&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;cos&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_fe89e79abf514dfe9eb8e4ccb2b9c293-27" name="rest_code_fe89e79abf514dfe9eb8e4ccb2b9c293-27" href="https://nicoguaro.github.io/es/posts/cyclic_colormaps/#rest_code_fe89e79abf514dfe9eb8e4ccb2b9c293-27"&gt;&lt;/a&gt;    &lt;span class="n"&gt;y&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;rad&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sin&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_fe89e79abf514dfe9eb8e4ccb2b9c293-28" name="rest_code_fe89e79abf514dfe9eb8e4ccb2b9c293-28" href="https://nicoguaro.github.io/es/posts/cyclic_colormaps/#rest_code_fe89e79abf514dfe9eb8e4ccb2b9c293-28"&gt;&lt;/a&gt;    &lt;span class="n"&gt;z&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;0.0&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;cos&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_fe89e79abf514dfe9eb8e4ccb2b9c293-29" name="rest_code_fe89e79abf514dfe9eb8e4ccb2b9c293-29" href="https://nicoguaro.github.io/es/posts/cyclic_colormaps/#rest_code_fe89e79abf514dfe9eb8e4ccb2b9c293-29"&gt;&lt;/a&gt;    &lt;span class="n"&gt;X&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;vstack&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;z&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_fe89e79abf514dfe9eb8e4ccb2b9c293-30" name="rest_code_fe89e79abf514dfe9eb8e4ccb2b9c293-30" href="https://nicoguaro.github.io/es/posts/cyclic_colormaps/#rest_code_fe89e79abf514dfe9eb8e4ccb2b9c293-30"&gt;&lt;/a&gt;    &lt;span class="n"&gt;X&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;rot_mat&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;dot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;X&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;center&lt;/span&gt;
&lt;a id="rest_code_fe89e79abf514dfe9eb8e4ccb2b9c293-31" name="rest_code_fe89e79abf514dfe9eb8e4ccb2b9c293-31" href="https://nicoguaro.github.io/es/posts/cyclic_colormaps/#rest_code_fe89e79abf514dfe9eb8e4ccb2b9c293-31"&gt;&lt;/a&gt;
&lt;a id="rest_code_fe89e79abf514dfe9eb8e4ccb2b9c293-32" name="rest_code_fe89e79abf514dfe9eb8e4ccb2b9c293-32" href="https://nicoguaro.github.io/es/posts/cyclic_colormaps/#rest_code_fe89e79abf514dfe9eb8e4ccb2b9c293-32"&gt;&lt;/a&gt;    &lt;span class="n"&gt;ax&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;fig&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;add_subplot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ny&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;nx&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;cont&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;projection&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'polar'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_fe89e79abf514dfe9eb8e4ccb2b9c293-33" name="rest_code_fe89e79abf514dfe9eb8e4ccb2b9c293-33" href="https://nicoguaro.github.io/es/posts/cyclic_colormaps/#rest_code_fe89e79abf514dfe9eb8e4ccb2b9c293-33"&gt;&lt;/a&gt;    &lt;span class="n"&gt;cmap&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;LinearSegmentedColormap&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;from_list&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'my_colormap'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;X&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;T&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_fe89e79abf514dfe9eb8e4ccb2b9c293-34" name="rest_code_fe89e79abf514dfe9eb8e4ccb2b9c293-34" href="https://nicoguaro.github.io/es/posts/cyclic_colormaps/#rest_code_fe89e79abf514dfe9eb8e4ccb2b9c293-34"&gt;&lt;/a&gt;    &lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;pcolormesh&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;azimuths&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;pi&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="mf"&gt;180.0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;zeniths&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;values&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;cmap&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;cmap&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_fe89e79abf514dfe9eb8e4ccb2b9c293-35" name="rest_code_fe89e79abf514dfe9eb8e4ccb2b9c293-35" href="https://nicoguaro.github.io/es/posts/cyclic_colormaps/#rest_code_fe89e79abf514dfe9eb8e4ccb2b9c293-35"&gt;&lt;/a&gt;    &lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_xticks&lt;/span&gt;&lt;span class="p"&gt;([])&lt;/span&gt;
&lt;a id="rest_code_fe89e79abf514dfe9eb8e4ccb2b9c293-36" name="rest_code_fe89e79abf514dfe9eb8e4ccb2b9c293-36" href="https://nicoguaro.github.io/es/posts/cyclic_colormaps/#rest_code_fe89e79abf514dfe9eb8e4ccb2b9c293-36"&gt;&lt;/a&gt;    &lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_yticks&lt;/span&gt;&lt;span class="p"&gt;([])&lt;/span&gt;
&lt;a id="rest_code_fe89e79abf514dfe9eb8e4ccb2b9c293-37" name="rest_code_fe89e79abf514dfe9eb8e4ccb2b9c293-37" href="https://nicoguaro.github.io/es/posts/cyclic_colormaps/#rest_code_fe89e79abf514dfe9eb8e4ccb2b9c293-37"&gt;&lt;/a&gt;
&lt;a id="rest_code_fe89e79abf514dfe9eb8e4ccb2b9c293-38" name="rest_code_fe89e79abf514dfe9eb8e4ccb2b9c293-38" href="https://nicoguaro.github.io/es/posts/cyclic_colormaps/#rest_code_fe89e79abf514dfe9eb8e4ccb2b9c293-38"&gt;&lt;/a&gt;    &lt;span class="n"&gt;ax2&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;fig2&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;add_subplot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ny&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;nx&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;cont&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;projection&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'3d'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_fe89e79abf514dfe9eb8e4ccb2b9c293-39" name="rest_code_fe89e79abf514dfe9eb8e4ccb2b9c293-39" href="https://nicoguaro.github.io/es/posts/cyclic_colormaps/#rest_code_fe89e79abf514dfe9eb8e4ccb2b9c293-39"&gt;&lt;/a&gt;    &lt;span class="n"&gt;ax2&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;plot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;X&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;:],&lt;/span&gt; &lt;span class="n"&gt;X&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;:],&lt;/span&gt; &lt;span class="n"&gt;X&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;:])&lt;/span&gt;
&lt;a id="rest_code_fe89e79abf514dfe9eb8e4ccb2b9c293-40" name="rest_code_fe89e79abf514dfe9eb8e4ccb2b9c293-40" href="https://nicoguaro.github.io/es/posts/cyclic_colormaps/#rest_code_fe89e79abf514dfe9eb8e4ccb2b9c293-40"&gt;&lt;/a&gt;    &lt;span class="n"&gt;ax2&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_xlim&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_fe89e79abf514dfe9eb8e4ccb2b9c293-41" name="rest_code_fe89e79abf514dfe9eb8e4ccb2b9c293-41" href="https://nicoguaro.github.io/es/posts/cyclic_colormaps/#rest_code_fe89e79abf514dfe9eb8e4ccb2b9c293-41"&gt;&lt;/a&gt;    &lt;span class="n"&gt;ax2&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_ylim&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_fe89e79abf514dfe9eb8e4ccb2b9c293-42" name="rest_code_fe89e79abf514dfe9eb8e4ccb2b9c293-42" href="https://nicoguaro.github.io/es/posts/cyclic_colormaps/#rest_code_fe89e79abf514dfe9eb8e4ccb2b9c293-42"&gt;&lt;/a&gt;    &lt;span class="n"&gt;ax2&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_zlim&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_fe89e79abf514dfe9eb8e4ccb2b9c293-43" name="rest_code_fe89e79abf514dfe9eb8e4ccb2b9c293-43" href="https://nicoguaro.github.io/es/posts/cyclic_colormaps/#rest_code_fe89e79abf514dfe9eb8e4ccb2b9c293-43"&gt;&lt;/a&gt;    &lt;span class="n"&gt;ax2&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;view_init&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;30&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;60&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_fe89e79abf514dfe9eb8e4ccb2b9c293-44" name="rest_code_fe89e79abf514dfe9eb8e4ccb2b9c293-44" href="https://nicoguaro.github.io/es/posts/cyclic_colormaps/#rest_code_fe89e79abf514dfe9eb8e4ccb2b9c293-44"&gt;&lt;/a&gt;    &lt;span class="n"&gt;ax2&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_xticks&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.5&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;1.0&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_fe89e79abf514dfe9eb8e4ccb2b9c293-45" name="rest_code_fe89e79abf514dfe9eb8e4ccb2b9c293-45" href="https://nicoguaro.github.io/es/posts/cyclic_colormaps/#rest_code_fe89e79abf514dfe9eb8e4ccb2b9c293-45"&gt;&lt;/a&gt;    &lt;span class="n"&gt;ax2&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_yticks&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.5&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;1.0&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_fe89e79abf514dfe9eb8e4ccb2b9c293-46" name="rest_code_fe89e79abf514dfe9eb8e4ccb2b9c293-46" href="https://nicoguaro.github.io/es/posts/cyclic_colormaps/#rest_code_fe89e79abf514dfe9eb8e4ccb2b9c293-46"&gt;&lt;/a&gt;    &lt;span class="n"&gt;ax2&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_zticks&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.5&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;1.0&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_fe89e79abf514dfe9eb8e4ccb2b9c293-47" name="rest_code_fe89e79abf514dfe9eb8e4ccb2b9c293-47" href="https://nicoguaro.github.io/es/posts/cyclic_colormaps/#rest_code_fe89e79abf514dfe9eb8e4ccb2b9c293-47"&gt;&lt;/a&gt;    &lt;span class="n"&gt;ax2&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_xticklabels&lt;/span&gt;&lt;span class="p"&gt;([])&lt;/span&gt;
&lt;a id="rest_code_fe89e79abf514dfe9eb8e4ccb2b9c293-48" name="rest_code_fe89e79abf514dfe9eb8e4ccb2b9c293-48" href="https://nicoguaro.github.io/es/posts/cyclic_colormaps/#rest_code_fe89e79abf514dfe9eb8e4ccb2b9c293-48"&gt;&lt;/a&gt;    &lt;span class="n"&gt;ax2&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_yticklabels&lt;/span&gt;&lt;span class="p"&gt;([])&lt;/span&gt;
&lt;a id="rest_code_fe89e79abf514dfe9eb8e4ccb2b9c293-49" name="rest_code_fe89e79abf514dfe9eb8e4ccb2b9c293-49" href="https://nicoguaro.github.io/es/posts/cyclic_colormaps/#rest_code_fe89e79abf514dfe9eb8e4ccb2b9c293-49"&gt;&lt;/a&gt;    &lt;span class="n"&gt;ax2&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_zticklabels&lt;/span&gt;&lt;span class="p"&gt;([])&lt;/span&gt;
&lt;a id="rest_code_fe89e79abf514dfe9eb8e4ccb2b9c293-50" name="rest_code_fe89e79abf514dfe9eb8e4ccb2b9c293-50" href="https://nicoguaro.github.io/es/posts/cyclic_colormaps/#rest_code_fe89e79abf514dfe9eb8e4ccb2b9c293-50"&gt;&lt;/a&gt;
&lt;a id="rest_code_fe89e79abf514dfe9eb8e4ccb2b9c293-51" name="rest_code_fe89e79abf514dfe9eb8e4ccb2b9c293-51" href="https://nicoguaro.github.io/es/posts/cyclic_colormaps/#rest_code_fe89e79abf514dfe9eb8e4ccb2b9c293-51"&gt;&lt;/a&gt;
&lt;a id="rest_code_fe89e79abf514dfe9eb8e4ccb2b9c293-52" name="rest_code_fe89e79abf514dfe9eb8e4ccb2b9c293-52" href="https://nicoguaro.github.io/es/posts/cyclic_colormaps/#rest_code_fe89e79abf514dfe9eb8e4ccb2b9c293-52"&gt;&lt;/a&gt;&lt;span class="n"&gt;fig&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;savefig&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"random_cmaps.png"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;dpi&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;300&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;transparent&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;True&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_fe89e79abf514dfe9eb8e4ccb2b9c293-53" name="rest_code_fe89e79abf514dfe9eb8e4ccb2b9c293-53" href="https://nicoguaro.github.io/es/posts/cyclic_colormaps/#rest_code_fe89e79abf514dfe9eb8e4ccb2b9c293-53"&gt;&lt;/a&gt;&lt;span class="n"&gt;fig2&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;savefig&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"random_cmaps_traj.svg"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;transparent&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;True&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;figure class="align-center"&gt;
&lt;img alt="/images/random_cmaps.png" src="https://nicoguaro.github.io/images/random_cmaps.png"&gt;
&lt;figcaption&gt;
&lt;p&gt;16 mapas de colores generados aleatoriamente.&lt;/p&gt;
&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;figure class="align-center"&gt;
&lt;img alt="/images/random_cmaps_traj.svg" src="https://nicoguaro.github.io/images/random_cmaps_traj.svg"&gt;
&lt;figcaption&gt;
&lt;p&gt;Trayectorias en espacio RGB para los mapas de colores generados
aleatoriamente.&lt;/p&gt;
&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;Una idea interesante sería tomar estos mapas de colores y optimizar
algunos parámetros perceptuales como luminosidad para obtener
mapas de colores útiles.&lt;/p&gt;
&lt;/section&gt;
&lt;section id="conclusiones"&gt;
&lt;h2&gt;Conclusiones&lt;/h2&gt;
&lt;p&gt;Probablemente, yo usaría &lt;code class="docutils literal"&gt;phase&lt;/code&gt;, &lt;code class="docutils literal"&gt;colorwheel&lt;/code&gt;, o &lt;code class="docutils literal"&gt;mrybm&lt;/code&gt; en
el futuro.&lt;/p&gt;
&lt;figure class="align-center"&gt;
&lt;img alt="/images/toroidal_helix_phase.svg" src="https://nicoguaro.github.io/images/toroidal_helix_phase.svg"&gt;
&lt;figcaption&gt;
&lt;p&gt;Imagen inicial usando &lt;code class="docutils literal"&gt;phase&lt;/code&gt;.&lt;/p&gt;
&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;figure class="align-center"&gt;
&lt;img alt="/images/toroidal_helix_colorwheel.svg" src="https://nicoguaro.github.io/images/toroidal_helix_colorwheel.svg"&gt;
&lt;figcaption&gt;
&lt;p&gt;Imagen inicial usando &lt;code class="docutils literal"&gt;colorwheel&lt;/code&gt;.&lt;/p&gt;
&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;figure class="align-center"&gt;
&lt;img alt="/images/toroidal_helix_mrybm.svg" src="https://nicoguaro.github.io/images/toroidal_helix_mrybm.svg"&gt;
&lt;figcaption&gt;
&lt;p&gt;Imagen inicial usando &lt;code class="docutils literal"&gt;mrybm&lt;/code&gt;.&lt;/p&gt;
&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;/section&gt;
&lt;section id="referencias"&gt;
&lt;h2&gt;Referencias&lt;/h2&gt;
&lt;ol class="arabic simple"&gt;
&lt;li&gt;&lt;p&gt;Peter Kovesi. Good Colour Maps: How to Design Them.
arXiv:1509.03700 [cs.GR] 2015&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;/section&gt;</description><category>computación científica</category><category>matplotlib</category><category>python</category><category>visualización</category><guid>https://nicoguaro.github.io/es/posts/cyclic_colormaps/</guid><pubDate>Tue, 02 Jan 2018 23:55:41 GMT</pubDate></item><item><title>Reto de métodos numéricos: resumen</title><link>https://nicoguaro.github.io/es/posts/numerical_challenge/numerical_summary/</link><dc:creator>Nicolás Guarín-Zapata</dc:creator><description>&lt;p&gt;Durante octubre (2017) escribí un programa por día para algunos
métodos numéricos famosos en Python y Julia. Esto está pensado como
un ejercicio, no esperen que el código sea lo suficientemente bueno para
usarse en la "vida real". Además, también debo mencionar que casi que no
tenía experiencia con Julia, así que probablemente no escriba un Julia
idiomático y se parezca más a Python.&lt;/p&gt;
&lt;section id="resumen"&gt;
&lt;h2&gt;Resumen&lt;/h2&gt;
&lt;p&gt;Esta publicación resume el reto. Para ver el código fuente pueden remitirse
&lt;a class="reference external" href="https://github.com/nicoguaro/numerical_challenge_2017"&gt;al repositorio&lt;/a&gt;.&lt;/p&gt;
&lt;section id="el-veredicto"&gt;
&lt;h3&gt;El veredicto&lt;/h3&gt;
&lt;p&gt;Ya que el reto es conmigo mismo, y el propósito era aprender algo de
Julia, el veredicto es: &lt;strong&gt;exitoso&lt;/strong&gt;. Sin embargo, fallé en el día 26
con el Método de Elementos de Frontera.&lt;/p&gt;
&lt;/section&gt;
&lt;section id="la-lista-de-metodos"&gt;
&lt;h3&gt;La lista de métodos&lt;/h3&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;&lt;th class="head"&gt;&lt;p&gt;Día&lt;/p&gt;&lt;/th&gt;
&lt;th class="head"&gt;&lt;p&gt;Método numérico&lt;/p&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;&lt;td&gt;&lt;p&gt;&lt;a class="reference external" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-01"&gt;01&lt;/a&gt;&lt;/p&gt;&lt;/td&gt;
&lt;td&gt;&lt;p&gt;Bisección&lt;/p&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;&lt;p&gt;&lt;a class="reference external" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-02"&gt;02&lt;/a&gt;&lt;/p&gt;&lt;/td&gt;
&lt;td&gt;&lt;p&gt;Regula falsi&lt;/p&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;&lt;p&gt;&lt;a class="reference external" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-03"&gt;03&lt;/a&gt;&lt;/p&gt;&lt;/td&gt;
&lt;td&gt;&lt;p&gt;Newton&lt;/p&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;&lt;p&gt;&lt;a class="reference external" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-04"&gt;04&lt;/a&gt;&lt;/p&gt;&lt;/td&gt;
&lt;td&gt;&lt;p&gt;Newton multivariable&lt;/p&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;&lt;p&gt;&lt;a class="reference external" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-05"&gt;05&lt;/a&gt;&lt;/p&gt;&lt;/td&gt;
&lt;td&gt;&lt;p&gt;Broyden&lt;/p&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;&lt;p&gt;&lt;a class="reference external" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-06"&gt;06&lt;/a&gt;&lt;/p&gt;&lt;/td&gt;
&lt;td&gt;&lt;p&gt;Descenso del gradiente&lt;/p&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;&lt;p&gt;&lt;a class="reference external" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-07"&gt;07&lt;/a&gt;&lt;/p&gt;&lt;/td&gt;
&lt;td&gt;&lt;p&gt;Nelder-Mead&lt;/p&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;&lt;p&gt;&lt;a class="reference external" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-08"&gt;08&lt;/a&gt;&lt;/p&gt;&lt;/td&gt;
&lt;td&gt;&lt;p&gt;Newton para optimización&lt;/p&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;&lt;p&gt;&lt;a class="reference external" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-09"&gt;09&lt;/a&gt;&lt;/p&gt;&lt;/td&gt;
&lt;td&gt;&lt;p&gt;Interpolación de Lagrange&lt;/p&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;&lt;p&gt;&lt;a class="reference external" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-10"&gt;10&lt;/a&gt;&lt;/p&gt;&lt;/td&gt;
&lt;td&gt;&lt;p&gt;Interpolación de Lagrange con muestreo de Lobatto&lt;/p&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;&lt;p&gt;&lt;a class="reference external" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-11"&gt;11&lt;/a&gt;&lt;/p&gt;&lt;/td&gt;
&lt;td&gt;&lt;p&gt;Interpolación de Lagrange con matriz de Vandermonde&lt;/p&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;&lt;p&gt;&lt;a class="reference external" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-12"&gt;12&lt;/a&gt;&lt;/p&gt;&lt;/td&gt;
&lt;td&gt;&lt;p&gt;Interpolación de Hermite&lt;/p&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;&lt;p&gt;&lt;a class="reference external" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-13"&gt;13&lt;/a&gt;&lt;/p&gt;&lt;/td&gt;
&lt;td&gt;&lt;p&gt;Interpolación spline&lt;/p&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;&lt;p&gt;&lt;a class="reference external" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-14"&gt;14&lt;/a&gt;&lt;/p&gt;&lt;/td&gt;
&lt;td&gt;&lt;p&gt;Cuadratura trapezoidal&lt;/p&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;&lt;p&gt;&lt;a class="reference external" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-15"&gt;15&lt;/a&gt;&lt;/p&gt;&lt;/td&gt;
&lt;td&gt;&lt;p&gt;Cuadratura de Simpson&lt;/p&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;&lt;p&gt;&lt;a class="reference external" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-16"&gt;16&lt;/a&gt;&lt;/p&gt;&lt;/td&gt;
&lt;td&gt;&lt;p&gt;Cuadratura de Clenshaw-Curtis&lt;/p&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;&lt;p&gt;&lt;a class="reference external" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-17"&gt;17&lt;/a&gt;&lt;/p&gt;&lt;/td&gt;
&lt;td&gt;&lt;p&gt;Integración de Euler&lt;/p&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;&lt;p&gt;&lt;a class="reference external" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-18"&gt;18&lt;/a&gt;&lt;/p&gt;&lt;/td&gt;
&lt;td&gt;&lt;p&gt;Integración de Runge-Kutta&lt;/p&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;&lt;p&gt;&lt;a class="reference external" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-19"&gt;19&lt;/a&gt;&lt;/p&gt;&lt;/td&gt;
&lt;td&gt;&lt;p&gt;Integración de Verlet&lt;/p&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;&lt;p&gt;&lt;a class="reference external" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-20"&gt;20&lt;/a&gt;&lt;/p&gt;&lt;/td&gt;
&lt;td&gt;&lt;p&gt;Método del disparo&lt;/p&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;&lt;p&gt;&lt;a class="reference external" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-21"&gt;21&lt;/a&gt;&lt;/p&gt;&lt;/td&gt;
&lt;td&gt;&lt;p&gt;Diferencias finitas con método de Jacobi&lt;/p&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;&lt;p&gt;&lt;a class="reference external" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-22"&gt;22&lt;/a&gt;&lt;/p&gt;&lt;/td&gt;
&lt;td&gt;&lt;p&gt;Diferencias finitas para valores propios&lt;/p&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;&lt;p&gt;&lt;a class="reference external" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-23"&gt;23&lt;/a&gt;&lt;/p&gt;&lt;/td&gt;
&lt;td&gt;&lt;p&gt;Método de Ritz&lt;/p&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;&lt;p&gt;&lt;a class="reference external" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-24"&gt;24&lt;/a&gt;&lt;/p&gt;&lt;/td&gt;
&lt;td&gt;&lt;p&gt;Elementos finitos en 1D&lt;/p&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;&lt;p&gt;&lt;a class="reference external" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-25"&gt;25&lt;/a&gt;&lt;/p&gt;&lt;/td&gt;
&lt;td&gt;&lt;p&gt;Elementos finitos en 2D&lt;/p&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;&lt;p&gt;&lt;a class="reference external" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-26"&gt;26&lt;/a&gt;&lt;/p&gt;&lt;/td&gt;
&lt;td&gt;&lt;p&gt;Método de elementos de frontera&lt;/p&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;&lt;p&gt;&lt;a class="reference external" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-27"&gt;27&lt;/a&gt;&lt;/p&gt;&lt;/td&gt;
&lt;td&gt;&lt;p&gt;Integración Monte-Carlo&lt;/p&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;&lt;p&gt;&lt;a class="reference external" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-28"&gt;28&lt;/a&gt;&lt;/p&gt;&lt;/td&gt;
&lt;td&gt;&lt;p&gt;Factorización LU factorization&lt;/p&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;&lt;p&gt;&lt;a class="reference external" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-29"&gt;29&lt;/a&gt;&lt;/p&gt;&lt;/td&gt;
&lt;td&gt;&lt;p&gt;Factorización de Cholesky&lt;/p&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;&lt;p&gt;&lt;a class="reference external" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-30"&gt;30&lt;/a&gt;&lt;/p&gt;&lt;/td&gt;
&lt;td&gt;&lt;p&gt;Gradiente conjugado&lt;/p&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;&lt;p&gt;&lt;a class="reference external" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-31"&gt;31&lt;/a&gt;&lt;/p&gt;&lt;/td&gt;
&lt;td&gt;&lt;p&gt;Elementos finitos con solucionador&lt;/p&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;/section&gt;
&lt;section id="conclusiones"&gt;
&lt;h3&gt;Conclusiones&lt;/h3&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;Este era un ejercicio de kata de código para aprender algunos detalles sobre
Julia para computación científica. Como tal, fue muy útil para mí ensuciarme
las manos con Julia.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Implementar el Método de Elementos de Frontera en un día parece algo difícil.
Yo ya lo sabía de antemano, pero lo intenté de todas formas … sin éxito.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;La sintaxis de Julia está en un punto intermedio entre Python y Matlab. Esto
hace que sea fácil de usar, aunque la documentación de algunas paquetes está
en una etapa preliminar en este momento.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;No volveré a hacer un reto como estos en un rato. Requiere de mucha atención
realizarlo.&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/section&gt;
&lt;/section&gt;</description><category>computación científica</category><category>julia</category><category>métodos numéricos</category><category>python</category><guid>https://nicoguaro.github.io/es/posts/numerical_challenge/numerical_summary/</guid><pubDate>Tue, 14 Nov 2017 16:22:23 GMT</pubDate></item><item><title>Reto de métodos numéricos: Día 31</title><link>https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-31/</link><dc:creator>Nicolás Guarín-Zapata</dc:creator><description>&lt;p&gt;Durante octubre (2017) estaré escribiendo un programa por día para algunos
métodos numéricos famosos en Python y Julia. Esto está pensado como
un ejercicio, no esperen que el código sea lo suficientemente bueno para
usarse en la "vida real". Además, también debo mencionar que casi que no
tengo experiencia con Julia, así que probablemente no escriba un Julia
idiomático y se parezca más a Python.&lt;/p&gt;
&lt;section id="poniendo-todo-junto"&gt;
&lt;h2&gt;Poniendo todo junto&lt;/h2&gt;
&lt;p&gt;Hoy, estoy juntando partes, es decir, voy a resolver un sistema de ecuaciones
que resulta de elementos finitos usando gradiente conjugado.&lt;/p&gt;
&lt;p&gt;A continuación el código.&lt;/p&gt;
&lt;section id="python"&gt;
&lt;h3&gt;Python&lt;/h3&gt;
&lt;div class="code"&gt;&lt;pre class="code python"&gt;&lt;a id="rest_code_40031a30d9d243d9a8535784e90254c9-1" name="rest_code_40031a30d9d243d9a8535784e90254c9-1" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-31/#rest_code_40031a30d9d243d9a8535784e90254c9-1"&gt;&lt;/a&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;__future__&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;division&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;print_function&lt;/span&gt;
&lt;a id="rest_code_40031a30d9d243d9a8535784e90254c9-2" name="rest_code_40031a30d9d243d9a8535784e90254c9-2" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-31/#rest_code_40031a30d9d243d9a8535784e90254c9-2"&gt;&lt;/a&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;numpy&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;np&lt;/span&gt;
&lt;a id="rest_code_40031a30d9d243d9a8535784e90254c9-3" name="rest_code_40031a30d9d243d9a8535784e90254c9-3" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-31/#rest_code_40031a30d9d243d9a8535784e90254c9-3"&gt;&lt;/a&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;matplotlib.pyplot&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;plt&lt;/span&gt;
&lt;a id="rest_code_40031a30d9d243d9a8535784e90254c9-4" name="rest_code_40031a30d9d243d9a8535784e90254c9-4" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-31/#rest_code_40031a30d9d243d9a8535784e90254c9-4"&gt;&lt;/a&gt;
&lt;a id="rest_code_40031a30d9d243d9a8535784e90254c9-5" name="rest_code_40031a30d9d243d9a8535784e90254c9-5" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-31/#rest_code_40031a30d9d243d9a8535784e90254c9-5"&gt;&lt;/a&gt;
&lt;a id="rest_code_40031a30d9d243d9a8535784e90254c9-6" name="rest_code_40031a30d9d243d9a8535784e90254c9-6" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-31/#rest_code_40031a30d9d243d9a8535784e90254c9-6"&gt;&lt;/a&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;FEM1D&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;source&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_40031a30d9d243d9a8535784e90254c9-7" name="rest_code_40031a30d9d243d9a8535784e90254c9-7" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-31/#rest_code_40031a30d9d243d9a8535784e90254c9-7"&gt;&lt;/a&gt;    &lt;span class="n"&gt;N&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_40031a30d9d243d9a8535784e90254c9-8" name="rest_code_40031a30d9d243d9a8535784e90254c9-8" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-31/#rest_code_40031a30d9d243d9a8535784e90254c9-8"&gt;&lt;/a&gt;    &lt;span class="n"&gt;stiff_loc&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;([[&lt;/span&gt;&lt;span class="mf"&gt;2.0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;2.0&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;2.0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;2.0&lt;/span&gt;&lt;span class="p"&gt;]])&lt;/span&gt;
&lt;a id="rest_code_40031a30d9d243d9a8535784e90254c9-9" name="rest_code_40031a30d9d243d9a8535784e90254c9-9" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-31/#rest_code_40031a30d9d243d9a8535784e90254c9-9"&gt;&lt;/a&gt;    &lt;span class="n"&gt;eles&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="n"&gt;cont&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;cont&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;cont&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;N&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)]&lt;/span&gt;
&lt;a id="rest_code_40031a30d9d243d9a8535784e90254c9-10" name="rest_code_40031a30d9d243d9a8535784e90254c9-10" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-31/#rest_code_40031a30d9d243d9a8535784e90254c9-10"&gt;&lt;/a&gt;    &lt;span class="n"&gt;stiff&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_40031a30d9d243d9a8535784e90254c9-11" name="rest_code_40031a30d9d243d9a8535784e90254c9-11" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-31/#rest_code_40031a30d9d243d9a8535784e90254c9-11"&gt;&lt;/a&gt;    &lt;span class="n"&gt;rhs&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_40031a30d9d243d9a8535784e90254c9-12" name="rest_code_40031a30d9d243d9a8535784e90254c9-12" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-31/#rest_code_40031a30d9d243d9a8535784e90254c9-12"&gt;&lt;/a&gt;    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;ele&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;eles&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a id="rest_code_40031a30d9d243d9a8535784e90254c9-13" name="rest_code_40031a30d9d243d9a8535784e90254c9-13" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-31/#rest_code_40031a30d9d243d9a8535784e90254c9-13"&gt;&lt;/a&gt;        &lt;span class="n"&gt;jaco&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ele&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]]&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ele&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]]&lt;/span&gt;
&lt;a id="rest_code_40031a30d9d243d9a8535784e90254c9-14" name="rest_code_40031a30d9d243d9a8535784e90254c9-14" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-31/#rest_code_40031a30d9d243d9a8535784e90254c9-14"&gt;&lt;/a&gt;        &lt;span class="n"&gt;rhs&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ele&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;rhs&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ele&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;jaco&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;source&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ele&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_40031a30d9d243d9a8535784e90254c9-15" name="rest_code_40031a30d9d243d9a8535784e90254c9-15" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-31/#rest_code_40031a30d9d243d9a8535784e90254c9-15"&gt;&lt;/a&gt;        &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;cont1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;row&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;enumerate&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ele&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_40031a30d9d243d9a8535784e90254c9-16" name="rest_code_40031a30d9d243d9a8535784e90254c9-16" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-31/#rest_code_40031a30d9d243d9a8535784e90254c9-16"&gt;&lt;/a&gt;            &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;cont2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;col&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;enumerate&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ele&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_40031a30d9d243d9a8535784e90254c9-17" name="rest_code_40031a30d9d243d9a8535784e90254c9-17" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-31/#rest_code_40031a30d9d243d9a8535784e90254c9-17"&gt;&lt;/a&gt;                &lt;span class="n"&gt;stiff&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;row&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;stiff&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;row&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt;  &lt;span class="n"&gt;stiff_loc&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;cont1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;cont2&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;jaco&lt;/span&gt;
&lt;a id="rest_code_40031a30d9d243d9a8535784e90254c9-18" name="rest_code_40031a30d9d243d9a8535784e90254c9-18" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-31/#rest_code_40031a30d9d243d9a8535784e90254c9-18"&gt;&lt;/a&gt;    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;stiff&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;rhs&lt;/span&gt;
&lt;a id="rest_code_40031a30d9d243d9a8535784e90254c9-19" name="rest_code_40031a30d9d243d9a8535784e90254c9-19" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-31/#rest_code_40031a30d9d243d9a8535784e90254c9-19"&gt;&lt;/a&gt;
&lt;a id="rest_code_40031a30d9d243d9a8535784e90254c9-20" name="rest_code_40031a30d9d243d9a8535784e90254c9-20" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-31/#rest_code_40031a30d9d243d9a8535784e90254c9-20"&gt;&lt;/a&gt;
&lt;a id="rest_code_40031a30d9d243d9a8535784e90254c9-21" name="rest_code_40031a30d9d243d9a8535784e90254c9-21" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-31/#rest_code_40031a30d9d243d9a8535784e90254c9-21"&gt;&lt;/a&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;conj_grad&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;tol&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mf"&gt;1e-8&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_40031a30d9d243d9a8535784e90254c9-22" name="rest_code_40031a30d9d243d9a8535784e90254c9-22" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-31/#rest_code_40031a30d9d243d9a8535784e90254c9-22"&gt;&lt;/a&gt;    &lt;span class="n"&gt;r&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;b&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;dot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_40031a30d9d243d9a8535784e90254c9-23" name="rest_code_40031a30d9d243d9a8535784e90254c9-23" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-31/#rest_code_40031a30d9d243d9a8535784e90254c9-23"&gt;&lt;/a&gt;    &lt;span class="n"&gt;p&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;r&lt;/span&gt;
&lt;a id="rest_code_40031a30d9d243d9a8535784e90254c9-24" name="rest_code_40031a30d9d243d9a8535784e90254c9-24" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-31/#rest_code_40031a30d9d243d9a8535784e90254c9-24"&gt;&lt;/a&gt;    &lt;span class="n"&gt;rsq_old&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;dot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_40031a30d9d243d9a8535784e90254c9-25" name="rest_code_40031a30d9d243d9a8535784e90254c9-25" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-31/#rest_code_40031a30d9d243d9a8535784e90254c9-25"&gt;&lt;/a&gt;    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;cont&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;)):&lt;/span&gt;
&lt;a id="rest_code_40031a30d9d243d9a8535784e90254c9-26" name="rest_code_40031a30d9d243d9a8535784e90254c9-26" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-31/#rest_code_40031a30d9d243d9a8535784e90254c9-26"&gt;&lt;/a&gt;        &lt;span class="n"&gt;Ap&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;dot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_40031a30d9d243d9a8535784e90254c9-27" name="rest_code_40031a30d9d243d9a8535784e90254c9-27" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-31/#rest_code_40031a30d9d243d9a8535784e90254c9-27"&gt;&lt;/a&gt;        &lt;span class="n"&gt;alpha&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;rsq_old&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;dot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Ap&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_40031a30d9d243d9a8535784e90254c9-28" name="rest_code_40031a30d9d243d9a8535784e90254c9-28" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-31/#rest_code_40031a30d9d243d9a8535784e90254c9-28"&gt;&lt;/a&gt;        &lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;alpha&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;p&lt;/span&gt;
&lt;a id="rest_code_40031a30d9d243d9a8535784e90254c9-29" name="rest_code_40031a30d9d243d9a8535784e90254c9-29" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-31/#rest_code_40031a30d9d243d9a8535784e90254c9-29"&gt;&lt;/a&gt;        &lt;span class="n"&gt;r&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;r&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;alpha&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;Ap&lt;/span&gt;
&lt;a id="rest_code_40031a30d9d243d9a8535784e90254c9-30" name="rest_code_40031a30d9d243d9a8535784e90254c9-30" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-31/#rest_code_40031a30d9d243d9a8535784e90254c9-30"&gt;&lt;/a&gt;        &lt;span class="n"&gt;rsq_new&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;dot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_40031a30d9d243d9a8535784e90254c9-31" name="rest_code_40031a30d9d243d9a8535784e90254c9-31" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-31/#rest_code_40031a30d9d243d9a8535784e90254c9-31"&gt;&lt;/a&gt;        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sqrt&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;rsq_new&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;tol&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a id="rest_code_40031a30d9d243d9a8535784e90254c9-32" name="rest_code_40031a30d9d243d9a8535784e90254c9-32" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-31/#rest_code_40031a30d9d243d9a8535784e90254c9-32"&gt;&lt;/a&gt;            &lt;span class="k"&gt;break&lt;/span&gt;
&lt;a id="rest_code_40031a30d9d243d9a8535784e90254c9-33" name="rest_code_40031a30d9d243d9a8535784e90254c9-33" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-31/#rest_code_40031a30d9d243d9a8535784e90254c9-33"&gt;&lt;/a&gt;        &lt;span class="n"&gt;p&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;r&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;rsq_new&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="n"&gt;rsq_old&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;p&lt;/span&gt;
&lt;a id="rest_code_40031a30d9d243d9a8535784e90254c9-34" name="rest_code_40031a30d9d243d9a8535784e90254c9-34" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-31/#rest_code_40031a30d9d243d9a8535784e90254c9-34"&gt;&lt;/a&gt;        &lt;span class="n"&gt;rsq_old&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;rsq_new&lt;/span&gt;
&lt;a id="rest_code_40031a30d9d243d9a8535784e90254c9-35" name="rest_code_40031a30d9d243d9a8535784e90254c9-35" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-31/#rest_code_40031a30d9d243d9a8535784e90254c9-35"&gt;&lt;/a&gt;    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;cont&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sqrt&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;rsq_new&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_40031a30d9d243d9a8535784e90254c9-36" name="rest_code_40031a30d9d243d9a8535784e90254c9-36" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-31/#rest_code_40031a30d9d243d9a8535784e90254c9-36"&gt;&lt;/a&gt;
&lt;a id="rest_code_40031a30d9d243d9a8535784e90254c9-37" name="rest_code_40031a30d9d243d9a8535784e90254c9-37" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-31/#rest_code_40031a30d9d243d9a8535784e90254c9-37"&gt;&lt;/a&gt;
&lt;a id="rest_code_40031a30d9d243d9a8535784e90254c9-38" name="rest_code_40031a30d9d243d9a8535784e90254c9-38" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-31/#rest_code_40031a30d9d243d9a8535784e90254c9-38"&gt;&lt;/a&gt;&lt;span class="n"&gt;fun&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;lambda&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;
&lt;a id="rest_code_40031a30d9d243d9a8535784e90254c9-39" name="rest_code_40031a30d9d243d9a8535784e90254c9-39" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-31/#rest_code_40031a30d9d243d9a8535784e90254c9-39"&gt;&lt;/a&gt;&lt;span class="n"&gt;N_vec&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;logspace&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;0.5&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;50&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;dtype&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nb"&gt;int&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_40031a30d9d243d9a8535784e90254c9-40" name="rest_code_40031a30d9d243d9a8535784e90254c9-40" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-31/#rest_code_40031a30d9d243d9a8535784e90254c9-40"&gt;&lt;/a&gt;&lt;span class="n"&gt;err_vec&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros_like&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N_vec&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;dtype&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nb"&gt;float&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_40031a30d9d243d9a8535784e90254c9-41" name="rest_code_40031a30d9d243d9a8535784e90254c9-41" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-31/#rest_code_40031a30d9d243d9a8535784e90254c9-41"&gt;&lt;/a&gt;&lt;span class="n"&gt;niter_vec&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros_like&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N_vec&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_40031a30d9d243d9a8535784e90254c9-42" name="rest_code_40031a30d9d243d9a8535784e90254c9-42" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-31/#rest_code_40031a30d9d243d9a8535784e90254c9-42"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;figure&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;figsize&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;8&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_40031a30d9d243d9a8535784e90254c9-43" name="rest_code_40031a30d9d243d9a8535784e90254c9-43" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-31/#rest_code_40031a30d9d243d9a8535784e90254c9-43"&gt;&lt;/a&gt;&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;cont&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;N&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;enumerate&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N_vec&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_40031a30d9d243d9a8535784e90254c9-44" name="rest_code_40031a30d9d243d9a8535784e90254c9-44" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-31/#rest_code_40031a30d9d243d9a8535784e90254c9-44"&gt;&lt;/a&gt;    &lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;linspace&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_40031a30d9d243d9a8535784e90254c9-45" name="rest_code_40031a30d9d243d9a8535784e90254c9-45" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-31/#rest_code_40031a30d9d243d9a8535784e90254c9-45"&gt;&lt;/a&gt;    &lt;span class="n"&gt;stiff&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;rhs&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;FEM1D&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;fun&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_40031a30d9d243d9a8535784e90254c9-46" name="rest_code_40031a30d9d243d9a8535784e90254c9-46" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-31/#rest_code_40031a30d9d243d9a8535784e90254c9-46"&gt;&lt;/a&gt;    &lt;span class="n"&gt;sol&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_40031a30d9d243d9a8535784e90254c9-47" name="rest_code_40031a30d9d243d9a8535784e90254c9-47" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-31/#rest_code_40031a30d9d243d9a8535784e90254c9-47"&gt;&lt;/a&gt;    &lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;niter&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;_&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;conj_grad&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;stiff&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;rhs&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;rhs&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a id="rest_code_40031a30d9d243d9a8535784e90254c9-48" name="rest_code_40031a30d9d243d9a8535784e90254c9-48" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-31/#rest_code_40031a30d9d243d9a8535784e90254c9-48"&gt;&lt;/a&gt;    &lt;span class="n"&gt;err&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;linalg&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;norm&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;sol&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="mi"&gt;20&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;linalg&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;norm&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="mi"&gt;20&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_40031a30d9d243d9a8535784e90254c9-49" name="rest_code_40031a30d9d243d9a8535784e90254c9-49" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-31/#rest_code_40031a30d9d243d9a8535784e90254c9-49"&gt;&lt;/a&gt;    &lt;span class="n"&gt;err_vec&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;cont&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;err&lt;/span&gt;
&lt;a id="rest_code_40031a30d9d243d9a8535784e90254c9-50" name="rest_code_40031a30d9d243d9a8535784e90254c9-50" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-31/#rest_code_40031a30d9d243d9a8535784e90254c9-50"&gt;&lt;/a&gt;    &lt;span class="n"&gt;niter_vec&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;cont&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;niter&lt;/span&gt;
&lt;a id="rest_code_40031a30d9d243d9a8535784e90254c9-51" name="rest_code_40031a30d9d243d9a8535784e90254c9-51" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-31/#rest_code_40031a30d9d243d9a8535784e90254c9-51"&gt;&lt;/a&gt;
&lt;a id="rest_code_40031a30d9d243d9a8535784e90254c9-52" name="rest_code_40031a30d9d243d9a8535784e90254c9-52" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-31/#rest_code_40031a30d9d243d9a8535784e90254c9-52"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;subplot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;121&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_40031a30d9d243d9a8535784e90254c9-53" name="rest_code_40031a30d9d243d9a8535784e90254c9-53" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-31/#rest_code_40031a30d9d243d9a8535784e90254c9-53"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;loglog&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N_vec&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;err_vec&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_40031a30d9d243d9a8535784e90254c9-54" name="rest_code_40031a30d9d243d9a8535784e90254c9-54" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-31/#rest_code_40031a30d9d243d9a8535784e90254c9-54"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"Number of nodes"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_40031a30d9d243d9a8535784e90254c9-55" name="rest_code_40031a30d9d243d9a8535784e90254c9-55" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-31/#rest_code_40031a30d9d243d9a8535784e90254c9-55"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ylabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"Relative error"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_40031a30d9d243d9a8535784e90254c9-56" name="rest_code_40031a30d9d243d9a8535784e90254c9-56" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-31/#rest_code_40031a30d9d243d9a8535784e90254c9-56"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;subplot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;122&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_40031a30d9d243d9a8535784e90254c9-57" name="rest_code_40031a30d9d243d9a8535784e90254c9-57" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-31/#rest_code_40031a30d9d243d9a8535784e90254c9-57"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;loglog&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N_vec&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;niter_vec&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_40031a30d9d243d9a8535784e90254c9-58" name="rest_code_40031a30d9d243d9a8535784e90254c9-58" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-31/#rest_code_40031a30d9d243d9a8535784e90254c9-58"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"Number of nodes"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_40031a30d9d243d9a8535784e90254c9-59" name="rest_code_40031a30d9d243d9a8535784e90254c9-59" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-31/#rest_code_40031a30d9d243d9a8535784e90254c9-59"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ylabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"Number of iterations"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_40031a30d9d243d9a8535784e90254c9-60" name="rest_code_40031a30d9d243d9a8535784e90254c9-60" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-31/#rest_code_40031a30d9d243d9a8535784e90254c9-60"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;tight_layout&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a id="rest_code_40031a30d9d243d9a8535784e90254c9-61" name="rest_code_40031a30d9d243d9a8535784e90254c9-61" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-31/#rest_code_40031a30d9d243d9a8535784e90254c9-61"&gt;&lt;/a&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;show&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/section&gt;
&lt;section id="julia"&gt;
&lt;h3&gt;Julia&lt;/h3&gt;
&lt;div class="code"&gt;&lt;pre class="code julia"&gt;&lt;a id="rest_code_0069a5f524a3466282cdb8cefb2ae8bb-1" name="rest_code_0069a5f524a3466282cdb8cefb2ae8bb-1" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-31/#rest_code_0069a5f524a3466282cdb8cefb2ae8bb-1"&gt;&lt;/a&gt;&lt;span class="k"&gt;using&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;PyPlot&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_0069a5f524a3466282cdb8cefb2ae8bb-2" name="rest_code_0069a5f524a3466282cdb8cefb2ae8bb-2" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-31/#rest_code_0069a5f524a3466282cdb8cefb2ae8bb-2"&gt;&lt;/a&gt;
&lt;a id="rest_code_0069a5f524a3466282cdb8cefb2ae8bb-3" name="rest_code_0069a5f524a3466282cdb8cefb2ae8bb-3" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-31/#rest_code_0069a5f524a3466282cdb8cefb2ae8bb-3"&gt;&lt;/a&gt;
&lt;a id="rest_code_0069a5f524a3466282cdb8cefb2ae8bb-4" name="rest_code_0069a5f524a3466282cdb8cefb2ae8bb-4" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-31/#rest_code_0069a5f524a3466282cdb8cefb2ae8bb-4"&gt;&lt;/a&gt;&lt;span class="k"&gt;function&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;FEM1D&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;source&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_0069a5f524a3466282cdb8cefb2ae8bb-5" name="rest_code_0069a5f524a3466282cdb8cefb2ae8bb-5" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-31/#rest_code_0069a5f524a3466282cdb8cefb2ae8bb-5"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;length&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_0069a5f524a3466282cdb8cefb2ae8bb-6" name="rest_code_0069a5f524a3466282cdb8cefb2ae8bb-6" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-31/#rest_code_0069a5f524a3466282cdb8cefb2ae8bb-6"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;stiff_loc&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mf"&gt;2.0&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;2.0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;2.0&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;2.0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_0069a5f524a3466282cdb8cefb2ae8bb-7" name="rest_code_0069a5f524a3466282cdb8cefb2ae8bb-7" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-31/#rest_code_0069a5f524a3466282cdb8cefb2ae8bb-7"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;eles&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;[[&lt;/span&gt;&lt;span class="n"&gt;cont&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;cont&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;for&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;cont&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;in&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_0069a5f524a3466282cdb8cefb2ae8bb-8" name="rest_code_0069a5f524a3466282cdb8cefb2ae8bb-8" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-31/#rest_code_0069a5f524a3466282cdb8cefb2ae8bb-8"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;stiff&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_0069a5f524a3466282cdb8cefb2ae8bb-9" name="rest_code_0069a5f524a3466282cdb8cefb2ae8bb-9" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-31/#rest_code_0069a5f524a3466282cdb8cefb2ae8bb-9"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;rhs&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_0069a5f524a3466282cdb8cefb2ae8bb-10" name="rest_code_0069a5f524a3466282cdb8cefb2ae8bb-10" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-31/#rest_code_0069a5f524a3466282cdb8cefb2ae8bb-10"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;for&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ele&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;in&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;eles&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_0069a5f524a3466282cdb8cefb2ae8bb-11" name="rest_code_0069a5f524a3466282cdb8cefb2ae8bb-11" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-31/#rest_code_0069a5f524a3466282cdb8cefb2ae8bb-11"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;jaco&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ele&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;]]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ele&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]]&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_0069a5f524a3466282cdb8cefb2ae8bb-12" name="rest_code_0069a5f524a3466282cdb8cefb2ae8bb-12" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-31/#rest_code_0069a5f524a3466282cdb8cefb2ae8bb-12"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;rhs&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ele&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;rhs&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ele&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;jaco&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;source&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;coords&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ele&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_0069a5f524a3466282cdb8cefb2ae8bb-13" name="rest_code_0069a5f524a3466282cdb8cefb2ae8bb-13" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-31/#rest_code_0069a5f524a3466282cdb8cefb2ae8bb-13"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;stiff&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ele&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ele&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;stiff&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ele&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ele&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;stiff_loc&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;jaco&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_0069a5f524a3466282cdb8cefb2ae8bb-14" name="rest_code_0069a5f524a3466282cdb8cefb2ae8bb-14" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-31/#rest_code_0069a5f524a3466282cdb8cefb2ae8bb-14"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;end&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_0069a5f524a3466282cdb8cefb2ae8bb-15" name="rest_code_0069a5f524a3466282cdb8cefb2ae8bb-15" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-31/#rest_code_0069a5f524a3466282cdb8cefb2ae8bb-15"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;return&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;stiff&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;rhs&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_0069a5f524a3466282cdb8cefb2ae8bb-16" name="rest_code_0069a5f524a3466282cdb8cefb2ae8bb-16" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-31/#rest_code_0069a5f524a3466282cdb8cefb2ae8bb-16"&gt;&lt;/a&gt;&lt;span class="k"&gt;end&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_0069a5f524a3466282cdb8cefb2ae8bb-17" name="rest_code_0069a5f524a3466282cdb8cefb2ae8bb-17" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-31/#rest_code_0069a5f524a3466282cdb8cefb2ae8bb-17"&gt;&lt;/a&gt;
&lt;a id="rest_code_0069a5f524a3466282cdb8cefb2ae8bb-18" name="rest_code_0069a5f524a3466282cdb8cefb2ae8bb-18" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-31/#rest_code_0069a5f524a3466282cdb8cefb2ae8bb-18"&gt;&lt;/a&gt;
&lt;a id="rest_code_0069a5f524a3466282cdb8cefb2ae8bb-19" name="rest_code_0069a5f524a3466282cdb8cefb2ae8bb-19" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-31/#rest_code_0069a5f524a3466282cdb8cefb2ae8bb-19"&gt;&lt;/a&gt;&lt;span class="k"&gt;function&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;conj_grad&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;tol&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mf"&gt;1e-8&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_0069a5f524a3466282cdb8cefb2ae8bb-20" name="rest_code_0069a5f524a3466282cdb8cefb2ae8bb-20" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-31/#rest_code_0069a5f524a3466282cdb8cefb2ae8bb-20"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_0069a5f524a3466282cdb8cefb2ae8bb-21" name="rest_code_0069a5f524a3466282cdb8cefb2ae8bb-21" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-31/#rest_code_0069a5f524a3466282cdb8cefb2ae8bb-21"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_0069a5f524a3466282cdb8cefb2ae8bb-22" name="rest_code_0069a5f524a3466282cdb8cefb2ae8bb-22" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-31/#rest_code_0069a5f524a3466282cdb8cefb2ae8bb-22"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;rsq_old&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;dot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_0069a5f524a3466282cdb8cefb2ae8bb-23" name="rest_code_0069a5f524a3466282cdb8cefb2ae8bb-23" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-31/#rest_code_0069a5f524a3466282cdb8cefb2ae8bb-23"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;niter&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_0069a5f524a3466282cdb8cefb2ae8bb-24" name="rest_code_0069a5f524a3466282cdb8cefb2ae8bb-24" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-31/#rest_code_0069a5f524a3466282cdb8cefb2ae8bb-24"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;for&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;cont&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="n"&gt;length&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_0069a5f524a3466282cdb8cefb2ae8bb-25" name="rest_code_0069a5f524a3466282cdb8cefb2ae8bb-25" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-31/#rest_code_0069a5f524a3466282cdb8cefb2ae8bb-25"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;Ap&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_0069a5f524a3466282cdb8cefb2ae8bb-26" name="rest_code_0069a5f524a3466282cdb8cefb2ae8bb-26" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-31/#rest_code_0069a5f524a3466282cdb8cefb2ae8bb-26"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;alpha&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;rsq_old&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;dot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Ap&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_0069a5f524a3466282cdb8cefb2ae8bb-27" name="rest_code_0069a5f524a3466282cdb8cefb2ae8bb-27" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-31/#rest_code_0069a5f524a3466282cdb8cefb2ae8bb-27"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;alpha&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_0069a5f524a3466282cdb8cefb2ae8bb-28" name="rest_code_0069a5f524a3466282cdb8cefb2ae8bb-28" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-31/#rest_code_0069a5f524a3466282cdb8cefb2ae8bb-28"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;alpha&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;Ap&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_0069a5f524a3466282cdb8cefb2ae8bb-29" name="rest_code_0069a5f524a3466282cdb8cefb2ae8bb-29" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-31/#rest_code_0069a5f524a3466282cdb8cefb2ae8bb-29"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;rsq_new&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;dot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_0069a5f524a3466282cdb8cefb2ae8bb-30" name="rest_code_0069a5f524a3466282cdb8cefb2ae8bb-30" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-31/#rest_code_0069a5f524a3466282cdb8cefb2ae8bb-30"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;sqrt&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;rsq_new&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;tol&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_0069a5f524a3466282cdb8cefb2ae8bb-31" name="rest_code_0069a5f524a3466282cdb8cefb2ae8bb-31" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-31/#rest_code_0069a5f524a3466282cdb8cefb2ae8bb-31"&gt;&lt;/a&gt;&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="k"&gt;break&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_0069a5f524a3466282cdb8cefb2ae8bb-32" name="rest_code_0069a5f524a3466282cdb8cefb2ae8bb-32" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-31/#rest_code_0069a5f524a3466282cdb8cefb2ae8bb-32"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="k"&gt;end&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_0069a5f524a3466282cdb8cefb2ae8bb-33" name="rest_code_0069a5f524a3466282cdb8cefb2ae8bb-33" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-31/#rest_code_0069a5f524a3466282cdb8cefb2ae8bb-33"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;rsq_new&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;rsq_old&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_0069a5f524a3466282cdb8cefb2ae8bb-34" name="rest_code_0069a5f524a3466282cdb8cefb2ae8bb-34" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-31/#rest_code_0069a5f524a3466282cdb8cefb2ae8bb-34"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;rsq_old&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;rsq_new&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_0069a5f524a3466282cdb8cefb2ae8bb-35" name="rest_code_0069a5f524a3466282cdb8cefb2ae8bb-35" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-31/#rest_code_0069a5f524a3466282cdb8cefb2ae8bb-35"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;niter&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_0069a5f524a3466282cdb8cefb2ae8bb-36" name="rest_code_0069a5f524a3466282cdb8cefb2ae8bb-36" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-31/#rest_code_0069a5f524a3466282cdb8cefb2ae8bb-36"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;end&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_0069a5f524a3466282cdb8cefb2ae8bb-37" name="rest_code_0069a5f524a3466282cdb8cefb2ae8bb-37" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-31/#rest_code_0069a5f524a3466282cdb8cefb2ae8bb-37"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;return&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;niter&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;norm&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_0069a5f524a3466282cdb8cefb2ae8bb-38" name="rest_code_0069a5f524a3466282cdb8cefb2ae8bb-38" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-31/#rest_code_0069a5f524a3466282cdb8cefb2ae8bb-38"&gt;&lt;/a&gt;&lt;span class="k"&gt;end&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_0069a5f524a3466282cdb8cefb2ae8bb-39" name="rest_code_0069a5f524a3466282cdb8cefb2ae8bb-39" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-31/#rest_code_0069a5f524a3466282cdb8cefb2ae8bb-39"&gt;&lt;/a&gt;
&lt;a id="rest_code_0069a5f524a3466282cdb8cefb2ae8bb-40" name="rest_code_0069a5f524a3466282cdb8cefb2ae8bb-40" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-31/#rest_code_0069a5f524a3466282cdb8cefb2ae8bb-40"&gt;&lt;/a&gt;
&lt;a id="rest_code_0069a5f524a3466282cdb8cefb2ae8bb-41" name="rest_code_0069a5f524a3466282cdb8cefb2ae8bb-41" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-31/#rest_code_0069a5f524a3466282cdb8cefb2ae8bb-41"&gt;&lt;/a&gt;
&lt;a id="rest_code_0069a5f524a3466282cdb8cefb2ae8bb-42" name="rest_code_0069a5f524a3466282cdb8cefb2ae8bb-42" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-31/#rest_code_0069a5f524a3466282cdb8cefb2ae8bb-42"&gt;&lt;/a&gt;&lt;span class="n"&gt;fun&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;.^&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_0069a5f524a3466282cdb8cefb2ae8bb-43" name="rest_code_0069a5f524a3466282cdb8cefb2ae8bb-43" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-31/#rest_code_0069a5f524a3466282cdb8cefb2ae8bb-43"&gt;&lt;/a&gt;&lt;span class="n"&gt;N_vec&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;round&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;logspace&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;0.5&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;50&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_0069a5f524a3466282cdb8cefb2ae8bb-44" name="rest_code_0069a5f524a3466282cdb8cefb2ae8bb-44" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-31/#rest_code_0069a5f524a3466282cdb8cefb2ae8bb-44"&gt;&lt;/a&gt;&lt;span class="n"&gt;err_vec&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N_vec&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_0069a5f524a3466282cdb8cefb2ae8bb-45" name="rest_code_0069a5f524a3466282cdb8cefb2ae8bb-45" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-31/#rest_code_0069a5f524a3466282cdb8cefb2ae8bb-45"&gt;&lt;/a&gt;&lt;span class="n"&gt;niter_vec&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N_vec&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_0069a5f524a3466282cdb8cefb2ae8bb-46" name="rest_code_0069a5f524a3466282cdb8cefb2ae8bb-46" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-31/#rest_code_0069a5f524a3466282cdb8cefb2ae8bb-46"&gt;&lt;/a&gt;&lt;span class="n"&gt;figure&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;figsize&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;8&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_0069a5f524a3466282cdb8cefb2ae8bb-47" name="rest_code_0069a5f524a3466282cdb8cefb2ae8bb-47" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-31/#rest_code_0069a5f524a3466282cdb8cefb2ae8bb-47"&gt;&lt;/a&gt;&lt;span class="k"&gt;for&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;cont&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;in&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;enumerate&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N_vec&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_0069a5f524a3466282cdb8cefb2ae8bb-48" name="rest_code_0069a5f524a3466282cdb8cefb2ae8bb-48" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-31/#rest_code_0069a5f524a3466282cdb8cefb2ae8bb-48"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;linspace&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;0.0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;1.0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_0069a5f524a3466282cdb8cefb2ae8bb-49" name="rest_code_0069a5f524a3466282cdb8cefb2ae8bb-49" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-31/#rest_code_0069a5f524a3466282cdb8cefb2ae8bb-49"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;stiff&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;rhs&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;FEM1D&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;fun&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_0069a5f524a3466282cdb8cefb2ae8bb-50" name="rest_code_0069a5f524a3466282cdb8cefb2ae8bb-50" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-31/#rest_code_0069a5f524a3466282cdb8cefb2ae8bb-50"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_0069a5f524a3466282cdb8cefb2ae8bb-51" name="rest_code_0069a5f524a3466282cdb8cefb2ae8bb-51" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-31/#rest_code_0069a5f524a3466282cdb8cefb2ae8bb-51"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="k"&gt;end&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;niter&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;_&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;conj_grad&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;stiff&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="k"&gt;end&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="k"&gt;end&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_0069a5f524a3466282cdb8cefb2ae8bb-52" name="rest_code_0069a5f524a3466282cdb8cefb2ae8bb-52" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-31/#rest_code_0069a5f524a3466282cdb8cefb2ae8bb-52"&gt;&lt;/a&gt;&lt;span class="w"&gt;                                &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;rhs&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="k"&gt;end&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;rhs&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="k"&gt;end&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_0069a5f524a3466282cdb8cefb2ae8bb-53" name="rest_code_0069a5f524a3466282cdb8cefb2ae8bb-53" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-31/#rest_code_0069a5f524a3466282cdb8cefb2ae8bb-53"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;err&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;norm&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;sol&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;.*&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;.^&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="mi"&gt;20&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;norm&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;.*&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;.^&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="mi"&gt;20&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_0069a5f524a3466282cdb8cefb2ae8bb-54" name="rest_code_0069a5f524a3466282cdb8cefb2ae8bb-54" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-31/#rest_code_0069a5f524a3466282cdb8cefb2ae8bb-54"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;err_vec&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;cont&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;err&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_0069a5f524a3466282cdb8cefb2ae8bb-55" name="rest_code_0069a5f524a3466282cdb8cefb2ae8bb-55" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-31/#rest_code_0069a5f524a3466282cdb8cefb2ae8bb-55"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;niter_vec&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;cont&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;niter&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_0069a5f524a3466282cdb8cefb2ae8bb-56" name="rest_code_0069a5f524a3466282cdb8cefb2ae8bb-56" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-31/#rest_code_0069a5f524a3466282cdb8cefb2ae8bb-56"&gt;&lt;/a&gt;&lt;span class="k"&gt;end&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_0069a5f524a3466282cdb8cefb2ae8bb-57" name="rest_code_0069a5f524a3466282cdb8cefb2ae8bb-57" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-31/#rest_code_0069a5f524a3466282cdb8cefb2ae8bb-57"&gt;&lt;/a&gt;&lt;span class="n"&gt;subplot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;121&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_0069a5f524a3466282cdb8cefb2ae8bb-58" name="rest_code_0069a5f524a3466282cdb8cefb2ae8bb-58" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-31/#rest_code_0069a5f524a3466282cdb8cefb2ae8bb-58"&gt;&lt;/a&gt;&lt;span class="n"&gt;loglog&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N_vec&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;err_vec&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_0069a5f524a3466282cdb8cefb2ae8bb-59" name="rest_code_0069a5f524a3466282cdb8cefb2ae8bb-59" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-31/#rest_code_0069a5f524a3466282cdb8cefb2ae8bb-59"&gt;&lt;/a&gt;&lt;span class="n"&gt;xlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;"Number of nodes"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_0069a5f524a3466282cdb8cefb2ae8bb-60" name="rest_code_0069a5f524a3466282cdb8cefb2ae8bb-60" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-31/#rest_code_0069a5f524a3466282cdb8cefb2ae8bb-60"&gt;&lt;/a&gt;&lt;span class="n"&gt;ylabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;"Relative error"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_0069a5f524a3466282cdb8cefb2ae8bb-61" name="rest_code_0069a5f524a3466282cdb8cefb2ae8bb-61" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-31/#rest_code_0069a5f524a3466282cdb8cefb2ae8bb-61"&gt;&lt;/a&gt;&lt;span class="n"&gt;subplot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;122&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_0069a5f524a3466282cdb8cefb2ae8bb-62" name="rest_code_0069a5f524a3466282cdb8cefb2ae8bb-62" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-31/#rest_code_0069a5f524a3466282cdb8cefb2ae8bb-62"&gt;&lt;/a&gt;&lt;span class="n"&gt;loglog&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N_vec&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;niter_vec&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_0069a5f524a3466282cdb8cefb2ae8bb-63" name="rest_code_0069a5f524a3466282cdb8cefb2ae8bb-63" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-31/#rest_code_0069a5f524a3466282cdb8cefb2ae8bb-63"&gt;&lt;/a&gt;&lt;span class="n"&gt;xlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;"Number of nodes"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_0069a5f524a3466282cdb8cefb2ae8bb-64" name="rest_code_0069a5f524a3466282cdb8cefb2ae8bb-64" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-31/#rest_code_0069a5f524a3466282cdb8cefb2ae8bb-64"&gt;&lt;/a&gt;&lt;span class="n"&gt;ylabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;"Number of iterations"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_0069a5f524a3466282cdb8cefb2ae8bb-65" name="rest_code_0069a5f524a3466282cdb8cefb2ae8bb-65" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-31/#rest_code_0069a5f524a3466282cdb8cefb2ae8bb-65"&gt;&lt;/a&gt;&lt;span class="n"&gt;tight_layout&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_0069a5f524a3466282cdb8cefb2ae8bb-66" name="rest_code_0069a5f524a3466282cdb8cefb2ae8bb-66" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-31/#rest_code_0069a5f524a3466282cdb8cefb2ae8bb-66"&gt;&lt;/a&gt;&lt;span class="n"&gt;show&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;En este caso, vamos a analizar el error de la solución como función del número
de nodos. Se muestra esto y el número de iteraciones requeridas en el gradiente
conjugado.&lt;/p&gt;
&lt;img alt="Error relativo en la solución." class="align-center" src="https://nicoguaro.github.io/images/FEM1D_convergence.svg" style="width: 800px;"&gt;
&lt;/section&gt;
&lt;/section&gt;</description><category>computación científica</category><category>gradiente conjugado</category><category>julia</category><category>método de elementos finitos</category><category>métodos numéricos</category><category>python</category><guid>https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-31/</guid><pubDate>Wed, 01 Nov 2017 01:45:09 GMT</pubDate></item><item><title>Reto de métodos numéricos: Día 30</title><link>https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-30/</link><dc:creator>Nicolás Guarín-Zapata</dc:creator><description>&lt;p&gt;Durante octubre (2017) estaré escribiendo un programa por día para algunos
métodos numéricos famosos en Python y Julia. Esto está pensado como
un ejercicio, no esperen que el código sea lo suficientemente bueno para
usarse en la "vida real". Además, también debo mencionar que casi que no
tengo experiencia con Julia, así que probablemente no escriba un Julia
idiomático y se parezca más a Python.&lt;/p&gt;
&lt;section id="gradiente-conjugado"&gt;
&lt;h2&gt;Gradiente conjugado&lt;/h2&gt;
&lt;p&gt;Hoy tenemos el &lt;a class="reference external" href="https://en.wikipedia.org/wiki/Conjugate_gradient_method"&gt;método del gradiente conjugado&lt;/a&gt;.
Este método se usa comúnmente para resolver sistemas lineales positivos
definidos. En comparación con el descenso del gradiente, escogemos una
dirección de descenso que es conjugado con su residual, es decir, es ortogonal
con una matriz de ponderación.&lt;/p&gt;
&lt;p&gt;A continuación se presenta el código.&lt;/p&gt;
&lt;section id="python"&gt;
&lt;h3&gt;Python&lt;/h3&gt;
&lt;div class="code"&gt;&lt;pre class="code python"&gt;&lt;a id="rest_code_ea4c2e76edec4c17a383e5d3306c5a8d-1" name="rest_code_ea4c2e76edec4c17a383e5d3306c5a8d-1" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-30/#rest_code_ea4c2e76edec4c17a383e5d3306c5a8d-1"&gt;&lt;/a&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;__future__&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;division&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;print_function&lt;/span&gt;
&lt;a id="rest_code_ea4c2e76edec4c17a383e5d3306c5a8d-2" name="rest_code_ea4c2e76edec4c17a383e5d3306c5a8d-2" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-30/#rest_code_ea4c2e76edec4c17a383e5d3306c5a8d-2"&gt;&lt;/a&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;numpy&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;np&lt;/span&gt;
&lt;a id="rest_code_ea4c2e76edec4c17a383e5d3306c5a8d-3" name="rest_code_ea4c2e76edec4c17a383e5d3306c5a8d-3" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-30/#rest_code_ea4c2e76edec4c17a383e5d3306c5a8d-3"&gt;&lt;/a&gt;
&lt;a id="rest_code_ea4c2e76edec4c17a383e5d3306c5a8d-4" name="rest_code_ea4c2e76edec4c17a383e5d3306c5a8d-4" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-30/#rest_code_ea4c2e76edec4c17a383e5d3306c5a8d-4"&gt;&lt;/a&gt;
&lt;a id="rest_code_ea4c2e76edec4c17a383e5d3306c5a8d-5" name="rest_code_ea4c2e76edec4c17a383e5d3306c5a8d-5" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-30/#rest_code_ea4c2e76edec4c17a383e5d3306c5a8d-5"&gt;&lt;/a&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;conj_grad&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;tol&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mf"&gt;1e-8&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_ea4c2e76edec4c17a383e5d3306c5a8d-6" name="rest_code_ea4c2e76edec4c17a383e5d3306c5a8d-6" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-30/#rest_code_ea4c2e76edec4c17a383e5d3306c5a8d-6"&gt;&lt;/a&gt;    &lt;span class="n"&gt;r&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;b&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;dot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_ea4c2e76edec4c17a383e5d3306c5a8d-7" name="rest_code_ea4c2e76edec4c17a383e5d3306c5a8d-7" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-30/#rest_code_ea4c2e76edec4c17a383e5d3306c5a8d-7"&gt;&lt;/a&gt;    &lt;span class="n"&gt;p&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;r&lt;/span&gt;
&lt;a id="rest_code_ea4c2e76edec4c17a383e5d3306c5a8d-8" name="rest_code_ea4c2e76edec4c17a383e5d3306c5a8d-8" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-30/#rest_code_ea4c2e76edec4c17a383e5d3306c5a8d-8"&gt;&lt;/a&gt;    &lt;span class="n"&gt;rsq_old&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;dot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_ea4c2e76edec4c17a383e5d3306c5a8d-9" name="rest_code_ea4c2e76edec4c17a383e5d3306c5a8d-9" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-30/#rest_code_ea4c2e76edec4c17a383e5d3306c5a8d-9"&gt;&lt;/a&gt;    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;cont&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;)):&lt;/span&gt;
&lt;a id="rest_code_ea4c2e76edec4c17a383e5d3306c5a8d-10" name="rest_code_ea4c2e76edec4c17a383e5d3306c5a8d-10" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-30/#rest_code_ea4c2e76edec4c17a383e5d3306c5a8d-10"&gt;&lt;/a&gt;        &lt;span class="n"&gt;Ap&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;dot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_ea4c2e76edec4c17a383e5d3306c5a8d-11" name="rest_code_ea4c2e76edec4c17a383e5d3306c5a8d-11" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-30/#rest_code_ea4c2e76edec4c17a383e5d3306c5a8d-11"&gt;&lt;/a&gt;        &lt;span class="n"&gt;alpha&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;rsq_old&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;dot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Ap&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_ea4c2e76edec4c17a383e5d3306c5a8d-12" name="rest_code_ea4c2e76edec4c17a383e5d3306c5a8d-12" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-30/#rest_code_ea4c2e76edec4c17a383e5d3306c5a8d-12"&gt;&lt;/a&gt;        &lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;alpha&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;p&lt;/span&gt;
&lt;a id="rest_code_ea4c2e76edec4c17a383e5d3306c5a8d-13" name="rest_code_ea4c2e76edec4c17a383e5d3306c5a8d-13" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-30/#rest_code_ea4c2e76edec4c17a383e5d3306c5a8d-13"&gt;&lt;/a&gt;        &lt;span class="n"&gt;r&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;r&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;alpha&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;Ap&lt;/span&gt;
&lt;a id="rest_code_ea4c2e76edec4c17a383e5d3306c5a8d-14" name="rest_code_ea4c2e76edec4c17a383e5d3306c5a8d-14" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-30/#rest_code_ea4c2e76edec4c17a383e5d3306c5a8d-14"&gt;&lt;/a&gt;        &lt;span class="n"&gt;rsq_new&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;dot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_ea4c2e76edec4c17a383e5d3306c5a8d-15" name="rest_code_ea4c2e76edec4c17a383e5d3306c5a8d-15" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-30/#rest_code_ea4c2e76edec4c17a383e5d3306c5a8d-15"&gt;&lt;/a&gt;        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sqrt&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;rsq_new&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;tol&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a id="rest_code_ea4c2e76edec4c17a383e5d3306c5a8d-16" name="rest_code_ea4c2e76edec4c17a383e5d3306c5a8d-16" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-30/#rest_code_ea4c2e76edec4c17a383e5d3306c5a8d-16"&gt;&lt;/a&gt;            &lt;span class="k"&gt;break&lt;/span&gt;
&lt;a id="rest_code_ea4c2e76edec4c17a383e5d3306c5a8d-17" name="rest_code_ea4c2e76edec4c17a383e5d3306c5a8d-17" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-30/#rest_code_ea4c2e76edec4c17a383e5d3306c5a8d-17"&gt;&lt;/a&gt;        &lt;span class="n"&gt;p&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;r&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;rsq_new&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="n"&gt;rsq_old&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;p&lt;/span&gt;
&lt;a id="rest_code_ea4c2e76edec4c17a383e5d3306c5a8d-18" name="rest_code_ea4c2e76edec4c17a383e5d3306c5a8d-18" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-30/#rest_code_ea4c2e76edec4c17a383e5d3306c5a8d-18"&gt;&lt;/a&gt;        &lt;span class="n"&gt;rsq_old&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;rsq_new&lt;/span&gt;
&lt;a id="rest_code_ea4c2e76edec4c17a383e5d3306c5a8d-19" name="rest_code_ea4c2e76edec4c17a383e5d3306c5a8d-19" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-30/#rest_code_ea4c2e76edec4c17a383e5d3306c5a8d-19"&gt;&lt;/a&gt;    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;cont&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sqrt&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;rsq_new&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_ea4c2e76edec4c17a383e5d3306c5a8d-20" name="rest_code_ea4c2e76edec4c17a383e5d3306c5a8d-20" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-30/#rest_code_ea4c2e76edec4c17a383e5d3306c5a8d-20"&gt;&lt;/a&gt;
&lt;a id="rest_code_ea4c2e76edec4c17a383e5d3306c5a8d-21" name="rest_code_ea4c2e76edec4c17a383e5d3306c5a8d-21" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-30/#rest_code_ea4c2e76edec4c17a383e5d3306c5a8d-21"&gt;&lt;/a&gt;
&lt;a id="rest_code_ea4c2e76edec4c17a383e5d3306c5a8d-22" name="rest_code_ea4c2e76edec4c17a383e5d3306c5a8d-22" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-30/#rest_code_ea4c2e76edec4c17a383e5d3306c5a8d-22"&gt;&lt;/a&gt;&lt;span class="n"&gt;N&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;1000&lt;/span&gt;
&lt;a id="rest_code_ea4c2e76edec4c17a383e5d3306c5a8d-23" name="rest_code_ea4c2e76edec4c17a383e5d3306c5a8d-23" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-30/#rest_code_ea4c2e76edec4c17a383e5d3306c5a8d-23"&gt;&lt;/a&gt;&lt;span class="n"&gt;A&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;diag&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ones&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;diag&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ones&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt;\
&lt;a id="rest_code_ea4c2e76edec4c17a383e5d3306c5a8d-24" name="rest_code_ea4c2e76edec4c17a383e5d3306c5a8d-24" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-30/#rest_code_ea4c2e76edec4c17a383e5d3306c5a8d-24"&gt;&lt;/a&gt;    &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;diag&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ones&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_ea4c2e76edec4c17a383e5d3306c5a8d-25" name="rest_code_ea4c2e76edec4c17a383e5d3306c5a8d-25" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-30/#rest_code_ea4c2e76edec4c17a383e5d3306c5a8d-25"&gt;&lt;/a&gt;&lt;span class="n"&gt;b&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ones&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_ea4c2e76edec4c17a383e5d3306c5a8d-26" name="rest_code_ea4c2e76edec4c17a383e5d3306c5a8d-26" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-30/#rest_code_ea4c2e76edec4c17a383e5d3306c5a8d-26"&gt;&lt;/a&gt;&lt;span class="n"&gt;x0&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ones&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_ea4c2e76edec4c17a383e5d3306c5a8d-27" name="rest_code_ea4c2e76edec4c17a383e5d3306c5a8d-27" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-30/#rest_code_ea4c2e76edec4c17a383e5d3306c5a8d-27"&gt;&lt;/a&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;niter&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;accu&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;conj_grad&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;x0&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/section&gt;
&lt;section id="julia"&gt;
&lt;h3&gt;Julia&lt;/h3&gt;
&lt;div class="code"&gt;&lt;pre class="code julia"&gt;&lt;a id="rest_code_5a8cbd9806084fdc82be838f31d89b30-1" name="rest_code_5a8cbd9806084fdc82be838f31d89b30-1" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-30/#rest_code_5a8cbd9806084fdc82be838f31d89b30-1"&gt;&lt;/a&gt;&lt;span class="k"&gt;function&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;conj_grad&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;tol&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mf"&gt;1e-8&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_5a8cbd9806084fdc82be838f31d89b30-2" name="rest_code_5a8cbd9806084fdc82be838f31d89b30-2" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-30/#rest_code_5a8cbd9806084fdc82be838f31d89b30-2"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_5a8cbd9806084fdc82be838f31d89b30-3" name="rest_code_5a8cbd9806084fdc82be838f31d89b30-3" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-30/#rest_code_5a8cbd9806084fdc82be838f31d89b30-3"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_5a8cbd9806084fdc82be838f31d89b30-4" name="rest_code_5a8cbd9806084fdc82be838f31d89b30-4" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-30/#rest_code_5a8cbd9806084fdc82be838f31d89b30-4"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;rsq_old&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;dot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_5a8cbd9806084fdc82be838f31d89b30-5" name="rest_code_5a8cbd9806084fdc82be838f31d89b30-5" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-30/#rest_code_5a8cbd9806084fdc82be838f31d89b30-5"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;niter&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_5a8cbd9806084fdc82be838f31d89b30-6" name="rest_code_5a8cbd9806084fdc82be838f31d89b30-6" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-30/#rest_code_5a8cbd9806084fdc82be838f31d89b30-6"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;for&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;cont&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="n"&gt;length&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_5a8cbd9806084fdc82be838f31d89b30-7" name="rest_code_5a8cbd9806084fdc82be838f31d89b30-7" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-30/#rest_code_5a8cbd9806084fdc82be838f31d89b30-7"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;Ap&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_5a8cbd9806084fdc82be838f31d89b30-8" name="rest_code_5a8cbd9806084fdc82be838f31d89b30-8" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-30/#rest_code_5a8cbd9806084fdc82be838f31d89b30-8"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;alpha&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;rsq_old&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;dot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Ap&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_5a8cbd9806084fdc82be838f31d89b30-9" name="rest_code_5a8cbd9806084fdc82be838f31d89b30-9" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-30/#rest_code_5a8cbd9806084fdc82be838f31d89b30-9"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;alpha&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_5a8cbd9806084fdc82be838f31d89b30-10" name="rest_code_5a8cbd9806084fdc82be838f31d89b30-10" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-30/#rest_code_5a8cbd9806084fdc82be838f31d89b30-10"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;alpha&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;Ap&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_5a8cbd9806084fdc82be838f31d89b30-11" name="rest_code_5a8cbd9806084fdc82be838f31d89b30-11" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-30/#rest_code_5a8cbd9806084fdc82be838f31d89b30-11"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;rsq_new&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;dot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_5a8cbd9806084fdc82be838f31d89b30-12" name="rest_code_5a8cbd9806084fdc82be838f31d89b30-12" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-30/#rest_code_5a8cbd9806084fdc82be838f31d89b30-12"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;sqrt&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;rsq_new&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;tol&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_5a8cbd9806084fdc82be838f31d89b30-13" name="rest_code_5a8cbd9806084fdc82be838f31d89b30-13" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-30/#rest_code_5a8cbd9806084fdc82be838f31d89b30-13"&gt;&lt;/a&gt;&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="k"&gt;break&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_5a8cbd9806084fdc82be838f31d89b30-14" name="rest_code_5a8cbd9806084fdc82be838f31d89b30-14" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-30/#rest_code_5a8cbd9806084fdc82be838f31d89b30-14"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="k"&gt;end&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_5a8cbd9806084fdc82be838f31d89b30-15" name="rest_code_5a8cbd9806084fdc82be838f31d89b30-15" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-30/#rest_code_5a8cbd9806084fdc82be838f31d89b30-15"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;rsq_new&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;rsq_old&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_5a8cbd9806084fdc82be838f31d89b30-16" name="rest_code_5a8cbd9806084fdc82be838f31d89b30-16" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-30/#rest_code_5a8cbd9806084fdc82be838f31d89b30-16"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;rsq_old&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;rsq_new&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_5a8cbd9806084fdc82be838f31d89b30-17" name="rest_code_5a8cbd9806084fdc82be838f31d89b30-17" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-30/#rest_code_5a8cbd9806084fdc82be838f31d89b30-17"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;niter&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_5a8cbd9806084fdc82be838f31d89b30-18" name="rest_code_5a8cbd9806084fdc82be838f31d89b30-18" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-30/#rest_code_5a8cbd9806084fdc82be838f31d89b30-18"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;end&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_5a8cbd9806084fdc82be838f31d89b30-19" name="rest_code_5a8cbd9806084fdc82be838f31d89b30-19" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-30/#rest_code_5a8cbd9806084fdc82be838f31d89b30-19"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;return&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;niter&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;norm&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_5a8cbd9806084fdc82be838f31d89b30-20" name="rest_code_5a8cbd9806084fdc82be838f31d89b30-20" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-30/#rest_code_5a8cbd9806084fdc82be838f31d89b30-20"&gt;&lt;/a&gt;&lt;span class="k"&gt;end&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_5a8cbd9806084fdc82be838f31d89b30-21" name="rest_code_5a8cbd9806084fdc82be838f31d89b30-21" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-30/#rest_code_5a8cbd9806084fdc82be838f31d89b30-21"&gt;&lt;/a&gt;
&lt;a id="rest_code_5a8cbd9806084fdc82be838f31d89b30-22" name="rest_code_5a8cbd9806084fdc82be838f31d89b30-22" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-30/#rest_code_5a8cbd9806084fdc82be838f31d89b30-22"&gt;&lt;/a&gt;
&lt;a id="rest_code_5a8cbd9806084fdc82be838f31d89b30-23" name="rest_code_5a8cbd9806084fdc82be838f31d89b30-23" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-30/#rest_code_5a8cbd9806084fdc82be838f31d89b30-23"&gt;&lt;/a&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1000&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_5a8cbd9806084fdc82be838f31d89b30-24" name="rest_code_5a8cbd9806084fdc82be838f31d89b30-24" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-30/#rest_code_5a8cbd9806084fdc82be838f31d89b30-24"&gt;&lt;/a&gt;&lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;diagm&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;ones&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;diagm&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ones&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;diagm&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ones&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_5a8cbd9806084fdc82be838f31d89b30-25" name="rest_code_5a8cbd9806084fdc82be838f31d89b30-25" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-30/#rest_code_5a8cbd9806084fdc82be838f31d89b30-25"&gt;&lt;/a&gt;&lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ones&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_5a8cbd9806084fdc82be838f31d89b30-26" name="rest_code_5a8cbd9806084fdc82be838f31d89b30-26" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-30/#rest_code_5a8cbd9806084fdc82be838f31d89b30-26"&gt;&lt;/a&gt;&lt;span class="n"&gt;x0&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ones&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_5a8cbd9806084fdc82be838f31d89b30-27" name="rest_code_5a8cbd9806084fdc82be838f31d89b30-27" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-30/#rest_code_5a8cbd9806084fdc82be838f31d89b30-27"&gt;&lt;/a&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;niter&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;accu&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;conj_grad&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;x0&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;En este caso, vamos a probar el método con una matriz que viene de una
discretización de una derivada de segundo orden usando diferencias finitas.&lt;/p&gt;
&lt;/section&gt;
&lt;section id="comparacion-python-julia"&gt;
&lt;h3&gt;Comparación Python/Julia&lt;/h3&gt;
&lt;p&gt;Respecto al número de líneas tenemos: 27 en Python y 27 en Julia.  La comparación
en tiempo de ejecución se realizó con el comando mágico de IPython &lt;code class="docutils literal"&gt;%timeit&lt;/code&gt;
y con &lt;code class="docutils literal"&gt;@benchmark&lt;/code&gt; en Julia.&lt;/p&gt;
&lt;p&gt;Para Python:&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code IPython"&gt;&lt;a id="rest_code_806244f56cf64f47b20a21b2282ab8a2-1" name="rest_code_806244f56cf64f47b20a21b2282ab8a2-1" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-30/#rest_code_806244f56cf64f47b20a21b2282ab8a2-1"&gt;&lt;/a&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="k"&gt;timeit&lt;/span&gt; conj_grad(A, b, x0)
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;con resultado&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code text"&gt;&lt;a id="rest_code_4b8723663dbe4d8dbc410f01817a2fdf-1" name="rest_code_4b8723663dbe4d8dbc410f01817a2fdf-1" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-30/#rest_code_4b8723663dbe4d8dbc410f01817a2fdf-1"&gt;&lt;/a&gt;10 loops, best of 3: 107 ms per loop
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Para Julia:&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code julia"&gt;&lt;a id="rest_code_11a97a86fcdf498daf7e74948071ad40-1" name="rest_code_11a97a86fcdf498daf7e74948071ad40-1" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-30/#rest_code_11a97a86fcdf498daf7e74948071ad40-1"&gt;&lt;/a&gt;&lt;span class="nd"&gt;@benchmark&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;conj_grad&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;x0&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;con resultado&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code julia"&gt;&lt;a id="rest_code_8df94036bdd64020b127d130621b7e50-1" name="rest_code_8df94036bdd64020b127d130621b7e50-1" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-30/#rest_code_8df94036bdd64020b127d130621b7e50-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;BenchmarkTools&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Trial&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_8df94036bdd64020b127d130621b7e50-2" name="rest_code_8df94036bdd64020b127d130621b7e50-2" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-30/#rest_code_8df94036bdd64020b127d130621b7e50-2"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;memory&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;estimate&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="mf"&gt;27.13&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;MiB&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_8df94036bdd64020b127d130621b7e50-3" name="rest_code_8df94036bdd64020b127d130621b7e50-3" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-30/#rest_code_8df94036bdd64020b127d130621b7e50-3"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;allocs&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;estimate&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="mi"&gt;3501&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_8df94036bdd64020b127d130621b7e50-4" name="rest_code_8df94036bdd64020b127d130621b7e50-4" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-30/#rest_code_8df94036bdd64020b127d130621b7e50-4"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="o"&gt;--------------&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_8df94036bdd64020b127d130621b7e50-5" name="rest_code_8df94036bdd64020b127d130621b7e50-5" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-30/#rest_code_8df94036bdd64020b127d130621b7e50-5"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;minimum&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;     &lt;/span&gt;&lt;span class="mf"&gt;128.477&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ms&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;0.54&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;GC&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_8df94036bdd64020b127d130621b7e50-6" name="rest_code_8df94036bdd64020b127d130621b7e50-6" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-30/#rest_code_8df94036bdd64020b127d130621b7e50-6"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;median&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="mf"&gt;294.407&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ms&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;0.24&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;GC&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_8df94036bdd64020b127d130621b7e50-7" name="rest_code_8df94036bdd64020b127d130621b7e50-7" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-30/#rest_code_8df94036bdd64020b127d130621b7e50-7"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;mean&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="mf"&gt;298.208&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ms&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;0.30&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;GC&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_8df94036bdd64020b127d130621b7e50-8" name="rest_code_8df94036bdd64020b127d130621b7e50-8" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-30/#rest_code_8df94036bdd64020b127d130621b7e50-8"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;maximum&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;     &lt;/span&gt;&lt;span class="mf"&gt;464.223&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ms&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;0.30&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;GC&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_8df94036bdd64020b127d130621b7e50-9" name="rest_code_8df94036bdd64020b127d130621b7e50-9" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-30/#rest_code_8df94036bdd64020b127d130621b7e50-9"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="o"&gt;--------------&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_8df94036bdd64020b127d130621b7e50-10" name="rest_code_8df94036bdd64020b127d130621b7e50-10" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-30/#rest_code_8df94036bdd64020b127d130621b7e50-10"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;samples&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;          &lt;/span&gt;&lt;span class="mi"&gt;17&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_8df94036bdd64020b127d130621b7e50-11" name="rest_code_8df94036bdd64020b127d130621b7e50-11" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-30/#rest_code_8df94036bdd64020b127d130621b7e50-11"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;evals&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;sample&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;     &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;En este caso, podemos decir que el código de Python es alrededor de 2 veces más
rápido que el de Julia.&lt;/p&gt;
&lt;/section&gt;
&lt;/section&gt;</description><category>computación científica</category><category>gradiente conjugado</category><category>julia</category><category>métodos numéricos</category><category>python</category><guid>https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-30/</guid><pubDate>Tue, 31 Oct 2017 00:38:03 GMT</pubDate></item><item><title>Reto de métodos numéricos: Día 29</title><link>https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-29/</link><dc:creator>Nicolás Guarín-Zapata</dc:creator><description>&lt;p&gt;Durante octubre (2017) estaré escribiendo un programa por día para algunos
métodos numéricos famosos en Python y Julia. Esto está pensado como
un ejercicio, no esperen que el código sea lo suficientemente bueno para
usarse en la "vida real". Además, también debo mencionar que casi que no
tengo experiencia con Julia, así que probablemente no escriba un Julia
idiomático y se parezca más a Python.&lt;/p&gt;
&lt;section id="descomposicion-de-cholesky"&gt;
&lt;h2&gt;Descomposición de Cholesky&lt;/h2&gt;
&lt;p&gt;Hoy tenemos la &lt;a class="reference external" href="https://en.wikipedia.org/wiki/Cholesky_decomposition"&gt;descomposición de Cholesky&lt;/a&gt;.
Es una factorización de una matriz hermítica, positiva definita en matrices
triangulares inferior y superior. La diferencia principal con la descomposición LU
es que la matriz inferior es la transpuesta hermítica de la superior.&lt;/p&gt;
&lt;p&gt;A continuación se presenta el código.&lt;/p&gt;
&lt;section id="python"&gt;
&lt;h3&gt;Python&lt;/h3&gt;
&lt;div class="code"&gt;&lt;pre class="code python"&gt;&lt;a id="rest_code_1e6f33c698c442f4a19c8204a6b77711-1" name="rest_code_1e6f33c698c442f4a19c8204a6b77711-1" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-29/#rest_code_1e6f33c698c442f4a19c8204a6b77711-1"&gt;&lt;/a&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;__future__&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;division&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;print_function&lt;/span&gt;
&lt;a id="rest_code_1e6f33c698c442f4a19c8204a6b77711-2" name="rest_code_1e6f33c698c442f4a19c8204a6b77711-2" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-29/#rest_code_1e6f33c698c442f4a19c8204a6b77711-2"&gt;&lt;/a&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;numpy&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;np&lt;/span&gt;
&lt;a id="rest_code_1e6f33c698c442f4a19c8204a6b77711-3" name="rest_code_1e6f33c698c442f4a19c8204a6b77711-3" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-29/#rest_code_1e6f33c698c442f4a19c8204a6b77711-3"&gt;&lt;/a&gt;
&lt;a id="rest_code_1e6f33c698c442f4a19c8204a6b77711-4" name="rest_code_1e6f33c698c442f4a19c8204a6b77711-4" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-29/#rest_code_1e6f33c698c442f4a19c8204a6b77711-4"&gt;&lt;/a&gt;
&lt;a id="rest_code_1e6f33c698c442f4a19c8204a6b77711-5" name="rest_code_1e6f33c698c442f4a19c8204a6b77711-5" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-29/#rest_code_1e6f33c698c442f4a19c8204a6b77711-5"&gt;&lt;/a&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;cholesky&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;mat&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_1e6f33c698c442f4a19c8204a6b77711-6" name="rest_code_1e6f33c698c442f4a19c8204a6b77711-6" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-29/#rest_code_1e6f33c698c442f4a19c8204a6b77711-6"&gt;&lt;/a&gt;    &lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;_&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;mat&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;shape&lt;/span&gt;
&lt;a id="rest_code_1e6f33c698c442f4a19c8204a6b77711-7" name="rest_code_1e6f33c698c442f4a19c8204a6b77711-7" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-29/#rest_code_1e6f33c698c442f4a19c8204a6b77711-7"&gt;&lt;/a&gt;    &lt;span class="n"&gt;mat&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;mat&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;copy&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a id="rest_code_1e6f33c698c442f4a19c8204a6b77711-8" name="rest_code_1e6f33c698c442f4a19c8204a6b77711-8" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-29/#rest_code_1e6f33c698c442f4a19c8204a6b77711-8"&gt;&lt;/a&gt;    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;col&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_1e6f33c698c442f4a19c8204a6b77711-9" name="rest_code_1e6f33c698c442f4a19c8204a6b77711-9" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-29/#rest_code_1e6f33c698c442f4a19c8204a6b77711-9"&gt;&lt;/a&gt;        &lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;mat&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;
&lt;a id="rest_code_1e6f33c698c442f4a19c8204a6b77711-10" name="rest_code_1e6f33c698c442f4a19c8204a6b77711-10" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-29/#rest_code_1e6f33c698c442f4a19c8204a6b77711-10"&gt;&lt;/a&gt;               &lt;span class="n"&gt;mat&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;dot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;mat&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="p"&gt;]))&lt;/span&gt;
&lt;a id="rest_code_1e6f33c698c442f4a19c8204a6b77711-11" name="rest_code_1e6f33c698c442f4a19c8204a6b77711-11" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-29/#rest_code_1e6f33c698c442f4a19c8204a6b77711-11"&gt;&lt;/a&gt;        &lt;span class="n"&gt;mat&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sqrt&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;mat&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;
&lt;a id="rest_code_1e6f33c698c442f4a19c8204a6b77711-12" name="rest_code_1e6f33c698c442f4a19c8204a6b77711-12" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-29/#rest_code_1e6f33c698c442f4a19c8204a6b77711-12"&gt;&lt;/a&gt;               &lt;span class="n"&gt;mat&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;dot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;mat&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="p"&gt;]))&lt;/span&gt;
&lt;a id="rest_code_1e6f33c698c442f4a19c8204a6b77711-13" name="rest_code_1e6f33c698c442f4a19c8204a6b77711-13" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-29/#rest_code_1e6f33c698c442f4a19c8204a6b77711-13"&gt;&lt;/a&gt;        &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;row&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;col&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_1e6f33c698c442f4a19c8204a6b77711-14" name="rest_code_1e6f33c698c442f4a19c8204a6b77711-14" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-29/#rest_code_1e6f33c698c442f4a19c8204a6b77711-14"&gt;&lt;/a&gt;            &lt;span class="n"&gt;mat&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;row&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;mat&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;row&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;
&lt;a id="rest_code_1e6f33c698c442f4a19c8204a6b77711-15" name="rest_code_1e6f33c698c442f4a19c8204a6b77711-15" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-29/#rest_code_1e6f33c698c442f4a19c8204a6b77711-15"&gt;&lt;/a&gt;               &lt;span class="n"&gt;mat&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;row&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;dot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;mat&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="p"&gt;]))&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;mat&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_1e6f33c698c442f4a19c8204a6b77711-16" name="rest_code_1e6f33c698c442f4a19c8204a6b77711-16" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-29/#rest_code_1e6f33c698c442f4a19c8204a6b77711-16"&gt;&lt;/a&gt;    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;row&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_1e6f33c698c442f4a19c8204a6b77711-17" name="rest_code_1e6f33c698c442f4a19c8204a6b77711-17" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-29/#rest_code_1e6f33c698c442f4a19c8204a6b77711-17"&gt;&lt;/a&gt;        &lt;span class="n"&gt;mat&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="n"&gt;row&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;row&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;
&lt;a id="rest_code_1e6f33c698c442f4a19c8204a6b77711-18" name="rest_code_1e6f33c698c442f4a19c8204a6b77711-18" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-29/#rest_code_1e6f33c698c442f4a19c8204a6b77711-18"&gt;&lt;/a&gt;    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;mat&lt;/span&gt;
&lt;a id="rest_code_1e6f33c698c442f4a19c8204a6b77711-19" name="rest_code_1e6f33c698c442f4a19c8204a6b77711-19" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-29/#rest_code_1e6f33c698c442f4a19c8204a6b77711-19"&gt;&lt;/a&gt;
&lt;a id="rest_code_1e6f33c698c442f4a19c8204a6b77711-20" name="rest_code_1e6f33c698c442f4a19c8204a6b77711-20" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-29/#rest_code_1e6f33c698c442f4a19c8204a6b77711-20"&gt;&lt;/a&gt;
&lt;a id="rest_code_1e6f33c698c442f4a19c8204a6b77711-21" name="rest_code_1e6f33c698c442f4a19c8204a6b77711-21" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-29/#rest_code_1e6f33c698c442f4a19c8204a6b77711-21"&gt;&lt;/a&gt;&lt;span class="n"&gt;A&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;
&lt;a id="rest_code_1e6f33c698c442f4a19c8204a6b77711-22" name="rest_code_1e6f33c698c442f4a19c8204a6b77711-22" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-29/#rest_code_1e6f33c698c442f4a19c8204a6b77711-22"&gt;&lt;/a&gt;    &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;
&lt;a id="rest_code_1e6f33c698c442f4a19c8204a6b77711-23" name="rest_code_1e6f33c698c442f4a19c8204a6b77711-23" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-29/#rest_code_1e6f33c698c442f4a19c8204a6b77711-23"&gt;&lt;/a&gt;    &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;4.25&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;2.75&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;
&lt;a id="rest_code_1e6f33c698c442f4a19c8204a6b77711-24" name="rest_code_1e6f33c698c442f4a19c8204a6b77711-24" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-29/#rest_code_1e6f33c698c442f4a19c8204a6b77711-24"&gt;&lt;/a&gt;    &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;2.75&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;3.5&lt;/span&gt;&lt;span class="p"&gt;]],&lt;/span&gt; &lt;span class="n"&gt;dtype&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nb"&gt;float&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_1e6f33c698c442f4a19c8204a6b77711-25" name="rest_code_1e6f33c698c442f4a19c8204a6b77711-25" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-29/#rest_code_1e6f33c698c442f4a19c8204a6b77711-25"&gt;&lt;/a&gt;&lt;span class="n"&gt;B&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;cholesky&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/section&gt;
&lt;section id="julia"&gt;
&lt;h3&gt;Julia&lt;/h3&gt;
&lt;div class="code"&gt;&lt;pre class="code julia"&gt;&lt;a id="rest_code_0a8e8c95c6a24db092267fcbf0a91660-1" name="rest_code_0a8e8c95c6a24db092267fcbf0a91660-1" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-29/#rest_code_0a8e8c95c6a24db092267fcbf0a91660-1"&gt;&lt;/a&gt;&lt;span class="k"&gt;function&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;cholesky&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;mat&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_0a8e8c95c6a24db092267fcbf0a91660-2" name="rest_code_0a8e8c95c6a24db092267fcbf0a91660-2" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-29/#rest_code_0a8e8c95c6a24db092267fcbf0a91660-2"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;_&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;size&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;mat&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_0a8e8c95c6a24db092267fcbf0a91660-3" name="rest_code_0a8e8c95c6a24db092267fcbf0a91660-3" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-29/#rest_code_0a8e8c95c6a24db092267fcbf0a91660-3"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;mat&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;copy&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;mat&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_0a8e8c95c6a24db092267fcbf0a91660-4" name="rest_code_0a8e8c95c6a24db092267fcbf0a91660-4" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-29/#rest_code_0a8e8c95c6a24db092267fcbf0a91660-4"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;for&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_0a8e8c95c6a24db092267fcbf0a91660-5" name="rest_code_0a8e8c95c6a24db092267fcbf0a91660-5" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-29/#rest_code_0a8e8c95c6a24db092267fcbf0a91660-5"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;mat&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;sqrt&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;mat&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_0a8e8c95c6a24db092267fcbf0a91660-6" name="rest_code_0a8e8c95c6a24db092267fcbf0a91660-6" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-29/#rest_code_0a8e8c95c6a24db092267fcbf0a91660-6"&gt;&lt;/a&gt;&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="n"&gt;dot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;mat&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;mat&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]))&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_0a8e8c95c6a24db092267fcbf0a91660-7" name="rest_code_0a8e8c95c6a24db092267fcbf0a91660-7" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-29/#rest_code_0a8e8c95c6a24db092267fcbf0a91660-7"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="k"&gt;for&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;row&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_0a8e8c95c6a24db092267fcbf0a91660-8" name="rest_code_0a8e8c95c6a24db092267fcbf0a91660-8" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-29/#rest_code_0a8e8c95c6a24db092267fcbf0a91660-8"&gt;&lt;/a&gt;&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="n"&gt;mat&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;row&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;mat&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;row&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_0a8e8c95c6a24db092267fcbf0a91660-9" name="rest_code_0a8e8c95c6a24db092267fcbf0a91660-9" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-29/#rest_code_0a8e8c95c6a24db092267fcbf0a91660-9"&gt;&lt;/a&gt;&lt;span class="w"&gt;               &lt;/span&gt;&lt;span class="n"&gt;dot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;mat&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;row&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;mat&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]))&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;mat&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_0a8e8c95c6a24db092267fcbf0a91660-10" name="rest_code_0a8e8c95c6a24db092267fcbf0a91660-10" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-29/#rest_code_0a8e8c95c6a24db092267fcbf0a91660-10"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="k"&gt;end&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_0a8e8c95c6a24db092267fcbf0a91660-11" name="rest_code_0a8e8c95c6a24db092267fcbf0a91660-11" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-29/#rest_code_0a8e8c95c6a24db092267fcbf0a91660-11"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;end&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_0a8e8c95c6a24db092267fcbf0a91660-12" name="rest_code_0a8e8c95c6a24db092267fcbf0a91660-12" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-29/#rest_code_0a8e8c95c6a24db092267fcbf0a91660-12"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;for&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;row&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_0a8e8c95c6a24db092267fcbf0a91660-13" name="rest_code_0a8e8c95c6a24db092267fcbf0a91660-13" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-29/#rest_code_0a8e8c95c6a24db092267fcbf0a91660-13"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;mat&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="n"&gt;row&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;row&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_0a8e8c95c6a24db092267fcbf0a91660-14" name="rest_code_0a8e8c95c6a24db092267fcbf0a91660-14" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-29/#rest_code_0a8e8c95c6a24db092267fcbf0a91660-14"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;end&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_0a8e8c95c6a24db092267fcbf0a91660-15" name="rest_code_0a8e8c95c6a24db092267fcbf0a91660-15" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-29/#rest_code_0a8e8c95c6a24db092267fcbf0a91660-15"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;return&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;mat&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_0a8e8c95c6a24db092267fcbf0a91660-16" name="rest_code_0a8e8c95c6a24db092267fcbf0a91660-16" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-29/#rest_code_0a8e8c95c6a24db092267fcbf0a91660-16"&gt;&lt;/a&gt;&lt;span class="k"&gt;end&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_0a8e8c95c6a24db092267fcbf0a91660-17" name="rest_code_0a8e8c95c6a24db092267fcbf0a91660-17" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-29/#rest_code_0a8e8c95c6a24db092267fcbf0a91660-17"&gt;&lt;/a&gt;
&lt;a id="rest_code_0a8e8c95c6a24db092267fcbf0a91660-18" name="rest_code_0a8e8c95c6a24db092267fcbf0a91660-18" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-29/#rest_code_0a8e8c95c6a24db092267fcbf0a91660-18"&gt;&lt;/a&gt;
&lt;a id="rest_code_0a8e8c95c6a24db092267fcbf0a91660-19" name="rest_code_0a8e8c95c6a24db092267fcbf0a91660-19" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-29/#rest_code_0a8e8c95c6a24db092267fcbf0a91660-19"&gt;&lt;/a&gt;&lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_0a8e8c95c6a24db092267fcbf0a91660-20" name="rest_code_0a8e8c95c6a24db092267fcbf0a91660-20" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-29/#rest_code_0a8e8c95c6a24db092267fcbf0a91660-20"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;4.25&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;2.75&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_0a8e8c95c6a24db092267fcbf0a91660-21" name="rest_code_0a8e8c95c6a24db092267fcbf0a91660-21" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-29/#rest_code_0a8e8c95c6a24db092267fcbf0a91660-21"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;2.75&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;3.5&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_0a8e8c95c6a24db092267fcbf0a91660-22" name="rest_code_0a8e8c95c6a24db092267fcbf0a91660-22" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-29/#rest_code_0a8e8c95c6a24db092267fcbf0a91660-22"&gt;&lt;/a&gt;&lt;span class="n"&gt;B&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;cholesky&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Como ejemplo tenemos la siguiente matriz&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
A = \begin{bmatrix}
     4 &amp;amp;-1 &amp;amp;1\\
    -1 &amp;amp;4.25 &amp;amp;2.75\\
     1 &amp;amp;2.75 &amp;amp;3.5
    \end{bmatrix}
\end{equation*}
&lt;/div&gt;
&lt;p&gt;Y la respuesta en ambos códigos es&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code text"&gt;&lt;a id="rest_code_7426472ca9fc42dbb8f1efc1d1f1525c-1" name="rest_code_7426472ca9fc42dbb8f1efc1d1f1525c-1" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-29/#rest_code_7426472ca9fc42dbb8f1efc1d1f1525c-1"&gt;&lt;/a&gt;2.0  0.0  0.0
&lt;a id="rest_code_7426472ca9fc42dbb8f1efc1d1f1525c-2" name="rest_code_7426472ca9fc42dbb8f1efc1d1f1525c-2" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-29/#rest_code_7426472ca9fc42dbb8f1efc1d1f1525c-2"&gt;&lt;/a&gt;-0.5  2.0  0.0
&lt;a id="rest_code_7426472ca9fc42dbb8f1efc1d1f1525c-3" name="rest_code_7426472ca9fc42dbb8f1efc1d1f1525c-3" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-29/#rest_code_7426472ca9fc42dbb8f1efc1d1f1525c-3"&gt;&lt;/a&gt;0.5  1.5  1.0
&lt;/pre&gt;&lt;/div&gt;
&lt;/section&gt;
&lt;section id="comparacion-python-julia"&gt;
&lt;h3&gt;Comparación Python/Julia&lt;/h3&gt;
&lt;p&gt;Respecto al número de líneas tenemos: 23 en Python y 22 en Julia.  La comparación
en tiempo de ejecución se realizó con el comando mágico de IPython &lt;code class="docutils literal"&gt;%timeit&lt;/code&gt;
y con &lt;code class="docutils literal"&gt;@benchmark&lt;/code&gt; en Julia.&lt;/p&gt;
&lt;p&gt;Para Python:&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code IPython"&gt;&lt;a id="rest_code_2fb541685bfa49ef9960611100ddf15f-1" name="rest_code_2fb541685bfa49ef9960611100ddf15f-1" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-29/#rest_code_2fb541685bfa49ef9960611100ddf15f-1"&gt;&lt;/a&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="k"&gt;timeit&lt;/span&gt; cholesky(np.eye(100))
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;con resultado&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code text"&gt;&lt;a id="rest_code_3c76d0ca602f42a2a43e9dbffd1a54cb-1" name="rest_code_3c76d0ca602f42a2a43e9dbffd1a54cb-1" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-29/#rest_code_3c76d0ca602f42a2a43e9dbffd1a54cb-1"&gt;&lt;/a&gt;100 loops, best of 3: 13 ms per loop
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Para Julia:&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code julia"&gt;&lt;a id="rest_code_c49ae506e25c44d0afbf694d62b1d3cd-1" name="rest_code_c49ae506e25c44d0afbf694d62b1d3cd-1" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-29/#rest_code_c49ae506e25c44d0afbf694d62b1d3cd-1"&gt;&lt;/a&gt;&lt;span class="nd"&gt;@benchmark&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;cholesky&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;eye&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;100&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;con resultado&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code julia"&gt;&lt;a id="rest_code_2645b82b1e9c4614a999035f34114fa4-1" name="rest_code_2645b82b1e9c4614a999035f34114fa4-1" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-29/#rest_code_2645b82b1e9c4614a999035f34114fa4-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;BenchmarkTools&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Trial&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_2645b82b1e9c4614a999035f34114fa4-2" name="rest_code_2645b82b1e9c4614a999035f34114fa4-2" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-29/#rest_code_2645b82b1e9c4614a999035f34114fa4-2"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;memory&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;estimate&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="mf"&gt;4.01&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;MiB&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_2645b82b1e9c4614a999035f34114fa4-3" name="rest_code_2645b82b1e9c4614a999035f34114fa4-3" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-29/#rest_code_2645b82b1e9c4614a999035f34114fa4-3"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;allocs&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;estimate&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="mi"&gt;20303&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_2645b82b1e9c4614a999035f34114fa4-4" name="rest_code_2645b82b1e9c4614a999035f34114fa4-4" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-29/#rest_code_2645b82b1e9c4614a999035f34114fa4-4"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="o"&gt;--------------&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_2645b82b1e9c4614a999035f34114fa4-5" name="rest_code_2645b82b1e9c4614a999035f34114fa4-5" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-29/#rest_code_2645b82b1e9c4614a999035f34114fa4-5"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;minimum&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;     &lt;/span&gt;&lt;span class="mf"&gt;1.010&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ms&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;0.00&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;GC&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_2645b82b1e9c4614a999035f34114fa4-6" name="rest_code_2645b82b1e9c4614a999035f34114fa4-6" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-29/#rest_code_2645b82b1e9c4614a999035f34114fa4-6"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;median&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="mf"&gt;1.136&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ms&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;0.00&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;GC&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_2645b82b1e9c4614a999035f34114fa4-7" name="rest_code_2645b82b1e9c4614a999035f34114fa4-7" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-29/#rest_code_2645b82b1e9c4614a999035f34114fa4-7"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;mean&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="mf"&gt;1.370&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ms&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;17.85&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;GC&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_2645b82b1e9c4614a999035f34114fa4-8" name="rest_code_2645b82b1e9c4614a999035f34114fa4-8" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-29/#rest_code_2645b82b1e9c4614a999035f34114fa4-8"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;maximum&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;     &lt;/span&gt;&lt;span class="mf"&gt;4.652&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ms&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;40.37&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;GC&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_2645b82b1e9c4614a999035f34114fa4-9" name="rest_code_2645b82b1e9c4614a999035f34114fa4-9" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-29/#rest_code_2645b82b1e9c4614a999035f34114fa4-9"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="o"&gt;--------------&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_2645b82b1e9c4614a999035f34114fa4-10" name="rest_code_2645b82b1e9c4614a999035f34114fa4-10" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-29/#rest_code_2645b82b1e9c4614a999035f34114fa4-10"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;samples&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;          &lt;/span&gt;&lt;span class="mi"&gt;3637&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_2645b82b1e9c4614a999035f34114fa4-11" name="rest_code_2645b82b1e9c4614a999035f34114fa4-11" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-29/#rest_code_2645b82b1e9c4614a999035f34114fa4-11"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;evals&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;sample&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;     &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;En este caso, podemos decir que el código de Python es alrededor de 10 veces
más lento que el de Julia.&lt;/p&gt;
&lt;/section&gt;
&lt;/section&gt;</description><category>computación científica</category><category>descomposición de cholesky</category><category>julia</category><category>métodos numéricos</category><category>python</category><guid>https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-29/</guid><pubDate>Mon, 30 Oct 2017 02:10:08 GMT</pubDate></item><item><title>Reto de métodos numéricos: Día 28</title><link>https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-28/</link><dc:creator>Nicolás Guarín-Zapata</dc:creator><description>&lt;p&gt;Durante octubre (2017) estaré escribiendo un programa por día para algunos
métodos numéricos famosos en Python y Julia. Esto está pensado como
un ejercicio, no esperen que el código sea lo suficientemente bueno para
usarse en la "vida real". Además, también debo mencionar que casi que no
tengo experiencia con Julia, así que probablemente no escriba un Julia
idiomático y se parezca más a Python.&lt;/p&gt;
&lt;section id="factorizacion-lu"&gt;
&lt;h2&gt;Factorización LU&lt;/h2&gt;
&lt;p&gt;Hoy tenemos la &lt;a class="reference external" href="https://en.wikipedia.org/wiki/LU_decomposition"&gt;descomposición LU&lt;/a&gt;.
Este es la factorización de una matriz en su formas triangulares inferior (L)
y superior (U). Básicamente, almacena cada uno de los pasos de una eliminación
gaussiana en matrices.&lt;/p&gt;
&lt;p&gt;A continuación el código.&lt;/p&gt;
&lt;section id="python"&gt;
&lt;h3&gt;Python&lt;/h3&gt;
&lt;div class="code"&gt;&lt;pre class="code python"&gt;&lt;a id="rest_code_75cef7c9c0ae49b6b325b86f99d62aa7-1" name="rest_code_75cef7c9c0ae49b6b325b86f99d62aa7-1" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-28/#rest_code_75cef7c9c0ae49b6b325b86f99d62aa7-1"&gt;&lt;/a&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;__future__&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;division&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;print_function&lt;/span&gt;
&lt;a id="rest_code_75cef7c9c0ae49b6b325b86f99d62aa7-2" name="rest_code_75cef7c9c0ae49b6b325b86f99d62aa7-2" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-28/#rest_code_75cef7c9c0ae49b6b325b86f99d62aa7-2"&gt;&lt;/a&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;numpy&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;np&lt;/span&gt;
&lt;a id="rest_code_75cef7c9c0ae49b6b325b86f99d62aa7-3" name="rest_code_75cef7c9c0ae49b6b325b86f99d62aa7-3" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-28/#rest_code_75cef7c9c0ae49b6b325b86f99d62aa7-3"&gt;&lt;/a&gt;
&lt;a id="rest_code_75cef7c9c0ae49b6b325b86f99d62aa7-4" name="rest_code_75cef7c9c0ae49b6b325b86f99d62aa7-4" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-28/#rest_code_75cef7c9c0ae49b6b325b86f99d62aa7-4"&gt;&lt;/a&gt;
&lt;a id="rest_code_75cef7c9c0ae49b6b325b86f99d62aa7-5" name="rest_code_75cef7c9c0ae49b6b325b86f99d62aa7-5" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-28/#rest_code_75cef7c9c0ae49b6b325b86f99d62aa7-5"&gt;&lt;/a&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;LU&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;mat&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_75cef7c9c0ae49b6b325b86f99d62aa7-6" name="rest_code_75cef7c9c0ae49b6b325b86f99d62aa7-6" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-28/#rest_code_75cef7c9c0ae49b6b325b86f99d62aa7-6"&gt;&lt;/a&gt;    &lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;_&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;mat&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;shape&lt;/span&gt;
&lt;a id="rest_code_75cef7c9c0ae49b6b325b86f99d62aa7-7" name="rest_code_75cef7c9c0ae49b6b325b86f99d62aa7-7" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-28/#rest_code_75cef7c9c0ae49b6b325b86f99d62aa7-7"&gt;&lt;/a&gt;    &lt;span class="n"&gt;mat&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;mat&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;copy&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a id="rest_code_75cef7c9c0ae49b6b325b86f99d62aa7-8" name="rest_code_75cef7c9c0ae49b6b325b86f99d62aa7-8" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-28/#rest_code_75cef7c9c0ae49b6b325b86f99d62aa7-8"&gt;&lt;/a&gt;    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;col&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;m&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_75cef7c9c0ae49b6b325b86f99d62aa7-9" name="rest_code_75cef7c9c0ae49b6b325b86f99d62aa7-9" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-28/#rest_code_75cef7c9c0ae49b6b325b86f99d62aa7-9"&gt;&lt;/a&gt;        &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;row&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;col&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_75cef7c9c0ae49b6b325b86f99d62aa7-10" name="rest_code_75cef7c9c0ae49b6b325b86f99d62aa7-10" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-28/#rest_code_75cef7c9c0ae49b6b325b86f99d62aa7-10"&gt;&lt;/a&gt;            &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;mat&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;row&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;!=&lt;/span&gt; &lt;span class="mf"&gt;0.0&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a id="rest_code_75cef7c9c0ae49b6b325b86f99d62aa7-11" name="rest_code_75cef7c9c0ae49b6b325b86f99d62aa7-11" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-28/#rest_code_75cef7c9c0ae49b6b325b86f99d62aa7-11"&gt;&lt;/a&gt;                &lt;span class="n"&gt;lam&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;mat&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;row&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;mat&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_75cef7c9c0ae49b6b325b86f99d62aa7-12" name="rest_code_75cef7c9c0ae49b6b325b86f99d62aa7-12" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-28/#rest_code_75cef7c9c0ae49b6b325b86f99d62aa7-12"&gt;&lt;/a&gt;                &lt;span class="n"&gt;mat&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;row&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;col&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;mat&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;row&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;col&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;\
&lt;a id="rest_code_75cef7c9c0ae49b6b325b86f99d62aa7-13" name="rest_code_75cef7c9c0ae49b6b325b86f99d62aa7-13" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-28/#rest_code_75cef7c9c0ae49b6b325b86f99d62aa7-13"&gt;&lt;/a&gt;                                      &lt;span class="n"&gt;lam&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;mat&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;col&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_75cef7c9c0ae49b6b325b86f99d62aa7-14" name="rest_code_75cef7c9c0ae49b6b325b86f99d62aa7-14" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-28/#rest_code_75cef7c9c0ae49b6b325b86f99d62aa7-14"&gt;&lt;/a&gt;                &lt;span class="n"&gt;mat&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;row&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;lam&lt;/span&gt;
&lt;a id="rest_code_75cef7c9c0ae49b6b325b86f99d62aa7-15" name="rest_code_75cef7c9c0ae49b6b325b86f99d62aa7-15" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-28/#rest_code_75cef7c9c0ae49b6b325b86f99d62aa7-15"&gt;&lt;/a&gt;    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;mat&lt;/span&gt;
&lt;a id="rest_code_75cef7c9c0ae49b6b325b86f99d62aa7-16" name="rest_code_75cef7c9c0ae49b6b325b86f99d62aa7-16" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-28/#rest_code_75cef7c9c0ae49b6b325b86f99d62aa7-16"&gt;&lt;/a&gt;
&lt;a id="rest_code_75cef7c9c0ae49b6b325b86f99d62aa7-17" name="rest_code_75cef7c9c0ae49b6b325b86f99d62aa7-17" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-28/#rest_code_75cef7c9c0ae49b6b325b86f99d62aa7-17"&gt;&lt;/a&gt;
&lt;a id="rest_code_75cef7c9c0ae49b6b325b86f99d62aa7-18" name="rest_code_75cef7c9c0ae49b6b325b86f99d62aa7-18" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-28/#rest_code_75cef7c9c0ae49b6b325b86f99d62aa7-18"&gt;&lt;/a&gt;&lt;span class="n"&gt;A&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;array&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;
&lt;a id="rest_code_75cef7c9c0ae49b6b325b86f99d62aa7-19" name="rest_code_75cef7c9c0ae49b6b325b86f99d62aa7-19" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-28/#rest_code_75cef7c9c0ae49b6b325b86f99d62aa7-19"&gt;&lt;/a&gt;    &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;
&lt;a id="rest_code_75cef7c9c0ae49b6b325b86f99d62aa7-20" name="rest_code_75cef7c9c0ae49b6b325b86f99d62aa7-20" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-28/#rest_code_75cef7c9c0ae49b6b325b86f99d62aa7-20"&gt;&lt;/a&gt;    &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;
&lt;a id="rest_code_75cef7c9c0ae49b6b325b86f99d62aa7-21" name="rest_code_75cef7c9c0ae49b6b325b86f99d62aa7-21" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-28/#rest_code_75cef7c9c0ae49b6b325b86f99d62aa7-21"&gt;&lt;/a&gt;    &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;
&lt;a id="rest_code_75cef7c9c0ae49b6b325b86f99d62aa7-22" name="rest_code_75cef7c9c0ae49b6b325b86f99d62aa7-22" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-28/#rest_code_75cef7c9c0ae49b6b325b86f99d62aa7-22"&gt;&lt;/a&gt;    &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]],&lt;/span&gt; &lt;span class="n"&gt;dtype&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nb"&gt;float&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_75cef7c9c0ae49b6b325b86f99d62aa7-23" name="rest_code_75cef7c9c0ae49b6b325b86f99d62aa7-23" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-28/#rest_code_75cef7c9c0ae49b6b325b86f99d62aa7-23"&gt;&lt;/a&gt;&lt;span class="n"&gt;B&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;LU&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/section&gt;
&lt;section id="julia"&gt;
&lt;h3&gt;Julia&lt;/h3&gt;
&lt;div class="code"&gt;&lt;pre class="code julia"&gt;&lt;a id="rest_code_31bc730e08c54c90a34bfb201d36ec5e-1" name="rest_code_31bc730e08c54c90a34bfb201d36ec5e-1" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-28/#rest_code_31bc730e08c54c90a34bfb201d36ec5e-1"&gt;&lt;/a&gt;&lt;span class="k"&gt;function&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;LU&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;mat&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_31bc730e08c54c90a34bfb201d36ec5e-2" name="rest_code_31bc730e08c54c90a34bfb201d36ec5e-2" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-28/#rest_code_31bc730e08c54c90a34bfb201d36ec5e-2"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;_&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;size&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;mat&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_31bc730e08c54c90a34bfb201d36ec5e-3" name="rest_code_31bc730e08c54c90a34bfb201d36ec5e-3" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-28/#rest_code_31bc730e08c54c90a34bfb201d36ec5e-3"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;mat&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;copy&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;mat&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_31bc730e08c54c90a34bfb201d36ec5e-4" name="rest_code_31bc730e08c54c90a34bfb201d36ec5e-4" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-28/#rest_code_31bc730e08c54c90a34bfb201d36ec5e-4"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;for&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_31bc730e08c54c90a34bfb201d36ec5e-5" name="rest_code_31bc730e08c54c90a34bfb201d36ec5e-5" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-28/#rest_code_31bc730e08c54c90a34bfb201d36ec5e-5"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="k"&gt;for&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;row&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_31bc730e08c54c90a34bfb201d36ec5e-6" name="rest_code_31bc730e08c54c90a34bfb201d36ec5e-6" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-28/#rest_code_31bc730e08c54c90a34bfb201d36ec5e-6"&gt;&lt;/a&gt;&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;mat&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;row&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;!=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;0.0&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_31bc730e08c54c90a34bfb201d36ec5e-7" name="rest_code_31bc730e08c54c90a34bfb201d36ec5e-7" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-28/#rest_code_31bc730e08c54c90a34bfb201d36ec5e-7"&gt;&lt;/a&gt;&lt;span class="w"&gt;                &lt;/span&gt;&lt;span class="n"&gt;lam&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;mat&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;row&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;mat&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_31bc730e08c54c90a34bfb201d36ec5e-8" name="rest_code_31bc730e08c54c90a34bfb201d36ec5e-8" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-28/#rest_code_31bc730e08c54c90a34bfb201d36ec5e-8"&gt;&lt;/a&gt;&lt;span class="w"&gt;                &lt;/span&gt;&lt;span class="n"&gt;mat&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;row&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;mat&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;row&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_31bc730e08c54c90a34bfb201d36ec5e-9" name="rest_code_31bc730e08c54c90a34bfb201d36ec5e-9" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-28/#rest_code_31bc730e08c54c90a34bfb201d36ec5e-9"&gt;&lt;/a&gt;&lt;span class="w"&gt;                                      &lt;/span&gt;&lt;span class="n"&gt;lam&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;mat&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_31bc730e08c54c90a34bfb201d36ec5e-10" name="rest_code_31bc730e08c54c90a34bfb201d36ec5e-10" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-28/#rest_code_31bc730e08c54c90a34bfb201d36ec5e-10"&gt;&lt;/a&gt;&lt;span class="w"&gt;                &lt;/span&gt;&lt;span class="n"&gt;mat&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;row&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;lam&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_31bc730e08c54c90a34bfb201d36ec5e-11" name="rest_code_31bc730e08c54c90a34bfb201d36ec5e-11" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-28/#rest_code_31bc730e08c54c90a34bfb201d36ec5e-11"&gt;&lt;/a&gt;&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="k"&gt;end&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_31bc730e08c54c90a34bfb201d36ec5e-12" name="rest_code_31bc730e08c54c90a34bfb201d36ec5e-12" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-28/#rest_code_31bc730e08c54c90a34bfb201d36ec5e-12"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="k"&gt;end&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_31bc730e08c54c90a34bfb201d36ec5e-13" name="rest_code_31bc730e08c54c90a34bfb201d36ec5e-13" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-28/#rest_code_31bc730e08c54c90a34bfb201d36ec5e-13"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;end&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_31bc730e08c54c90a34bfb201d36ec5e-14" name="rest_code_31bc730e08c54c90a34bfb201d36ec5e-14" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-28/#rest_code_31bc730e08c54c90a34bfb201d36ec5e-14"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;return&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;mat&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_31bc730e08c54c90a34bfb201d36ec5e-15" name="rest_code_31bc730e08c54c90a34bfb201d36ec5e-15" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-28/#rest_code_31bc730e08c54c90a34bfb201d36ec5e-15"&gt;&lt;/a&gt;&lt;span class="k"&gt;end&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_31bc730e08c54c90a34bfb201d36ec5e-16" name="rest_code_31bc730e08c54c90a34bfb201d36ec5e-16" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-28/#rest_code_31bc730e08c54c90a34bfb201d36ec5e-16"&gt;&lt;/a&gt;
&lt;a id="rest_code_31bc730e08c54c90a34bfb201d36ec5e-17" name="rest_code_31bc730e08c54c90a34bfb201d36ec5e-17" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-28/#rest_code_31bc730e08c54c90a34bfb201d36ec5e-17"&gt;&lt;/a&gt;
&lt;a id="rest_code_31bc730e08c54c90a34bfb201d36ec5e-18" name="rest_code_31bc730e08c54c90a34bfb201d36ec5e-18" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-28/#rest_code_31bc730e08c54c90a34bfb201d36ec5e-18"&gt;&lt;/a&gt;&lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mf"&gt;1.0&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;1.0&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;0.0&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;3.0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_31bc730e08c54c90a34bfb201d36ec5e-19" name="rest_code_31bc730e08c54c90a34bfb201d36ec5e-19" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-28/#rest_code_31bc730e08c54c90a34bfb201d36ec5e-19"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="mf"&gt;2.0&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;1.0&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;1.0&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;1.0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_31bc730e08c54c90a34bfb201d36ec5e-20" name="rest_code_31bc730e08c54c90a34bfb201d36ec5e-20" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-28/#rest_code_31bc730e08c54c90a34bfb201d36ec5e-20"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="mf"&gt;3.0&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;1.0&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;1.0&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;2.0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_31bc730e08c54c90a34bfb201d36ec5e-21" name="rest_code_31bc730e08c54c90a34bfb201d36ec5e-21" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-28/#rest_code_31bc730e08c54c90a34bfb201d36ec5e-21"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;1.0&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;2.0&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;3.0&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;1.0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_31bc730e08c54c90a34bfb201d36ec5e-22" name="rest_code_31bc730e08c54c90a34bfb201d36ec5e-22" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-28/#rest_code_31bc730e08c54c90a34bfb201d36ec5e-22"&gt;&lt;/a&gt;&lt;span class="n"&gt;B&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;LU&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Como un ejemplo tenemos la matriz&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
A = \begin{bmatrix}
    1 &amp;amp;1 &amp;amp;0 &amp;amp;3\\
    2 &amp;amp;1 &amp;amp;-1 &amp;amp;1\\
    3 &amp;amp;-1 &amp;amp;-1 &amp;amp;2\\
    -1 &amp;amp;2 &amp;amp;3 &amp;amp;-1
    \end{bmatrix} =
    \begin{bmatrix}
    1 &amp;amp;1 &amp;amp;0 &amp;amp;0\\
    2 &amp;amp;1 &amp;amp;0 &amp;amp;0\\
    3 &amp;amp;4 &amp;amp;1 &amp;amp;2\\
    -1 &amp;amp;-3 &amp;amp;0 &amp;amp;1
    \end{bmatrix}
    \begin{bmatrix}
    1 &amp;amp;1 &amp;amp;0 &amp;amp;3\\
    0 &amp;amp;-1 &amp;amp;-1 &amp;amp;-5\\
    0 &amp;amp;0 &amp;amp;3 &amp;amp;13\\
    0 &amp;amp;0 &amp;amp;0 &amp;amp;-13
    \end{bmatrix}
\end{equation*}
&lt;/div&gt;
&lt;p&gt;Y, la respuesta en ámbos códigos es&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code text"&gt;&lt;a id="rest_code_aadd26f4741e4f828939d412fe0d08a2-1" name="rest_code_aadd26f4741e4f828939d412fe0d08a2-1" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-28/#rest_code_aadd26f4741e4f828939d412fe0d08a2-1"&gt;&lt;/a&gt;[[  1.,   1.,   0.,   3.],
&lt;a id="rest_code_aadd26f4741e4f828939d412fe0d08a2-2" name="rest_code_aadd26f4741e4f828939d412fe0d08a2-2" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-28/#rest_code_aadd26f4741e4f828939d412fe0d08a2-2"&gt;&lt;/a&gt; [  2.,  -1.,  -1.,  -5.],
&lt;a id="rest_code_aadd26f4741e4f828939d412fe0d08a2-3" name="rest_code_aadd26f4741e4f828939d412fe0d08a2-3" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-28/#rest_code_aadd26f4741e4f828939d412fe0d08a2-3"&gt;&lt;/a&gt; [  3.,   4.,   3.,  13.],
&lt;a id="rest_code_aadd26f4741e4f828939d412fe0d08a2-4" name="rest_code_aadd26f4741e4f828939d412fe0d08a2-4" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-28/#rest_code_aadd26f4741e4f828939d412fe0d08a2-4"&gt;&lt;/a&gt; [ -1.,  -3.,   0., -13.]]
&lt;/pre&gt;&lt;/div&gt;
&lt;/section&gt;
&lt;section id="comparacion-python-julia"&gt;
&lt;h3&gt;Comparación Python/Julia&lt;/h3&gt;
&lt;p&gt;Respecto al número de líneas tenemos: 23 en Python y 22 en Julia.  La comparación
en tiempo de ejecución se realizó con el comando mágico de IPython &lt;code class="docutils literal"&gt;%timeit&lt;/code&gt;
y con &lt;code class="docutils literal"&gt;@benchmark&lt;/code&gt; en Julia.&lt;/p&gt;
&lt;p&gt;Para Python:&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code IPython"&gt;&lt;a id="rest_code_128ae1e0bd814d9c97858d37be9fd154-1" name="rest_code_128ae1e0bd814d9c97858d37be9fd154-1" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-28/#rest_code_128ae1e0bd814d9c97858d37be9fd154-1"&gt;&lt;/a&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="k"&gt;timeit&lt;/span&gt; LU(np.random.rand(10, 10))
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;con resultado&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code text"&gt;&lt;a id="rest_code_b773dd346e0c4e64864c917ffccec1a3-1" name="rest_code_b773dd346e0c4e64864c917ffccec1a3-1" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-28/#rest_code_b773dd346e0c4e64864c917ffccec1a3-1"&gt;&lt;/a&gt;1000 loops, best of 3: 303 µs per loop
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Para Julia:&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code julia"&gt;&lt;a id="rest_code_8d9f075e635d42759ab01497dc8b2a9b-1" name="rest_code_8d9f075e635d42759ab01497dc8b2a9b-1" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-28/#rest_code_8d9f075e635d42759ab01497dc8b2a9b-1"&gt;&lt;/a&gt;&lt;span class="nd"&gt;@benchmark&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;LU&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;rand&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;con resultado&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code julia"&gt;&lt;a id="rest_code_e18fe33ea5404ce193351d328188ddd8-1" name="rest_code_e18fe33ea5404ce193351d328188ddd8-1" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-28/#rest_code_e18fe33ea5404ce193351d328188ddd8-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;BenchmarkTools&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Trial&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_e18fe33ea5404ce193351d328188ddd8-2" name="rest_code_e18fe33ea5404ce193351d328188ddd8-2" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-28/#rest_code_e18fe33ea5404ce193351d328188ddd8-2"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;memory&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;estimate&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="mf"&gt;29.25&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;KiB&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_e18fe33ea5404ce193351d328188ddd8-3" name="rest_code_e18fe33ea5404ce193351d328188ddd8-3" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-28/#rest_code_e18fe33ea5404ce193351d328188ddd8-3"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;allocs&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;estimate&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="mi"&gt;310&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_e18fe33ea5404ce193351d328188ddd8-4" name="rest_code_e18fe33ea5404ce193351d328188ddd8-4" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-28/#rest_code_e18fe33ea5404ce193351d328188ddd8-4"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="o"&gt;--------------&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_e18fe33ea5404ce193351d328188ddd8-5" name="rest_code_e18fe33ea5404ce193351d328188ddd8-5" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-28/#rest_code_e18fe33ea5404ce193351d328188ddd8-5"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;minimum&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;     &lt;/span&gt;&lt;span class="mf"&gt;9.993&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;μs&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;0.00&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;GC&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_e18fe33ea5404ce193351d328188ddd8-6" name="rest_code_e18fe33ea5404ce193351d328188ddd8-6" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-28/#rest_code_e18fe33ea5404ce193351d328188ddd8-6"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;median&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="mf"&gt;11.725&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;μs&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;0.00&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;GC&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_e18fe33ea5404ce193351d328188ddd8-7" name="rest_code_e18fe33ea5404ce193351d328188ddd8-7" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-28/#rest_code_e18fe33ea5404ce193351d328188ddd8-7"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;mean&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="mf"&gt;14.943&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;μs&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;15.90&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;GC&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_e18fe33ea5404ce193351d328188ddd8-8" name="rest_code_e18fe33ea5404ce193351d328188ddd8-8" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-28/#rest_code_e18fe33ea5404ce193351d328188ddd8-8"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;maximum&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;     &lt;/span&gt;&lt;span class="mf"&gt;3.285&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ms&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;95.64&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;GC&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_e18fe33ea5404ce193351d328188ddd8-9" name="rest_code_e18fe33ea5404ce193351d328188ddd8-9" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-28/#rest_code_e18fe33ea5404ce193351d328188ddd8-9"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="o"&gt;--------------&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_e18fe33ea5404ce193351d328188ddd8-10" name="rest_code_e18fe33ea5404ce193351d328188ddd8-10" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-28/#rest_code_e18fe33ea5404ce193351d328188ddd8-10"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;samples&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;          &lt;/span&gt;&lt;span class="mi"&gt;10000&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_e18fe33ea5404ce193351d328188ddd8-11" name="rest_code_e18fe33ea5404ce193351d328188ddd8-11" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-28/#rest_code_e18fe33ea5404ce193351d328188ddd8-11"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;evals&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;sample&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;     &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;En este caso, podemos decir que el código de Python es alrededor de 30 veces
más lento que el de Julia.&lt;/p&gt;
&lt;/section&gt;
&lt;/section&gt;</description><category>computación científica</category><category>factorización lu</category><category>julia</category><category>métodos numéricos</category><category>python</category><guid>https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-28/</guid><pubDate>Sat, 28 Oct 2017 22:02:38 GMT</pubDate></item><item><title>Reto de métodos numéricos: Día 27</title><link>https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-27/</link><dc:creator>Nicolás Guarín-Zapata</dc:creator><description>&lt;p&gt;Durante octubre (2017) estaré escribiendo un programa por día para algunos
métodos numéricos famosos en Python y Julia. Esto está pensado como
un ejercicio, no esperen que el código sea lo suficientemente bueno para
usarse en la "vida real". Además, también debo mencionar que casi que no
tengo experiencia con Julia, así que probablemente no escriba un Julia
idiomático y se parezca más a Python.&lt;/p&gt;
&lt;section id="integracion-monte-carlo"&gt;
&lt;h2&gt;Integración Monte Carlo&lt;/h2&gt;
&lt;p&gt;Hoy tenemos la &lt;a class="reference external" href="https://en.wikipedia.org/wiki/Monte_Carlo_integration"&gt;integración Monte Carlo&lt;/a&gt;.
En donde usamos muestreo aleatorio para calcular una integral numéricamente.
Este método es importante cuando tenemos que evaluar integrales
multidimensionales ya que las técnicas de cuadratura usuales implican un
crecimiento exponencial con el número de puntos de muestreo.&lt;/p&gt;
&lt;p&gt;El método cálcula una integral&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
I = \int_\Omega f(x) dx
\end{equation*}
&lt;/div&gt;
&lt;p&gt;donde &lt;span class="math"&gt;\(\Omega\)&lt;/span&gt; tiene volumen &lt;span class="math"&gt;\(V\)&lt;/span&gt;.&lt;/p&gt;
&lt;p&gt;La integral es aproximada como&lt;/p&gt;
&lt;div class="math"&gt;
\begin{equation*}
I \approx \frac{V}{N} \sum_{i=1}^{N} f(x_i)
\end{equation*}
&lt;/div&gt;
&lt;p&gt;donde &lt;span class="math"&gt;\(x_i\)&lt;/span&gt; está distribuido de manera uniforme sobre &lt;span class="math"&gt;\(\Omega\)&lt;/span&gt;.&lt;/p&gt;
&lt;p&gt;A continuación se presenta el código.&lt;/p&gt;
&lt;section id="python"&gt;
&lt;h3&gt;Python&lt;/h3&gt;
&lt;div class="code"&gt;&lt;pre class="code python"&gt;&lt;a id="rest_code_bbc8728aab444da4b67b1450c2a57cff-1" name="rest_code_bbc8728aab444da4b67b1450c2a57cff-1" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-27/#rest_code_bbc8728aab444da4b67b1450c2a57cff-1"&gt;&lt;/a&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;__future__&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;division&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;print_function&lt;/span&gt;
&lt;a id="rest_code_bbc8728aab444da4b67b1450c2a57cff-2" name="rest_code_bbc8728aab444da4b67b1450c2a57cff-2" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-27/#rest_code_bbc8728aab444da4b67b1450c2a57cff-2"&gt;&lt;/a&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;numpy&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;np&lt;/span&gt;
&lt;a id="rest_code_bbc8728aab444da4b67b1450c2a57cff-3" name="rest_code_bbc8728aab444da4b67b1450c2a57cff-3" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-27/#rest_code_bbc8728aab444da4b67b1450c2a57cff-3"&gt;&lt;/a&gt;
&lt;a id="rest_code_bbc8728aab444da4b67b1450c2a57cff-4" name="rest_code_bbc8728aab444da4b67b1450c2a57cff-4" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-27/#rest_code_bbc8728aab444da4b67b1450c2a57cff-4"&gt;&lt;/a&gt;
&lt;a id="rest_code_bbc8728aab444da4b67b1450c2a57cff-5" name="rest_code_bbc8728aab444da4b67b1450c2a57cff-5" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-27/#rest_code_bbc8728aab444da4b67b1450c2a57cff-5"&gt;&lt;/a&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;monte_carlo_int&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;fun&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;low&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;high&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;args&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;()):&lt;/span&gt;
&lt;a id="rest_code_bbc8728aab444da4b67b1450c2a57cff-6" name="rest_code_bbc8728aab444da4b67b1450c2a57cff-6" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-27/#rest_code_bbc8728aab444da4b67b1450c2a57cff-6"&gt;&lt;/a&gt;    &lt;span class="n"&gt;ndims&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;low&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_bbc8728aab444da4b67b1450c2a57cff-7" name="rest_code_bbc8728aab444da4b67b1450c2a57cff-7" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-27/#rest_code_bbc8728aab444da4b67b1450c2a57cff-7"&gt;&lt;/a&gt;    &lt;span class="n"&gt;pts&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;random&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;uniform&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;low&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;low&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;high&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;high&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;size&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;ndims&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_bbc8728aab444da4b67b1450c2a57cff-8" name="rest_code_bbc8728aab444da4b67b1450c2a57cff-8" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-27/#rest_code_bbc8728aab444da4b67b1450c2a57cff-8"&gt;&lt;/a&gt;    &lt;span class="n"&gt;V&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;prod&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;asarray&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;high&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;asarray&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;low&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_bbc8728aab444da4b67b1450c2a57cff-9" name="rest_code_bbc8728aab444da4b67b1450c2a57cff-9" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-27/#rest_code_bbc8728aab444da4b67b1450c2a57cff-9"&gt;&lt;/a&gt;    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;V&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sum&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;fun&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;pts&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;args&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;
&lt;a id="rest_code_bbc8728aab444da4b67b1450c2a57cff-10" name="rest_code_bbc8728aab444da4b67b1450c2a57cff-10" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-27/#rest_code_bbc8728aab444da4b67b1450c2a57cff-10"&gt;&lt;/a&gt;
&lt;a id="rest_code_bbc8728aab444da4b67b1450c2a57cff-11" name="rest_code_bbc8728aab444da4b67b1450c2a57cff-11" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-27/#rest_code_bbc8728aab444da4b67b1450c2a57cff-11"&gt;&lt;/a&gt;
&lt;a id="rest_code_bbc8728aab444da4b67b1450c2a57cff-12" name="rest_code_bbc8728aab444da4b67b1450c2a57cff-12" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-27/#rest_code_bbc8728aab444da4b67b1450c2a57cff-12"&gt;&lt;/a&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;circ&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;rad&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a id="rest_code_bbc8728aab444da4b67b1450c2a57cff-13" name="rest_code_bbc8728aab444da4b67b1450c2a57cff-13" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-27/#rest_code_bbc8728aab444da4b67b1450c2a57cff-13"&gt;&lt;/a&gt;    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="mf"&gt;0.5&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sign&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[:,&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[:,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;rad&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_bbc8728aab444da4b67b1450c2a57cff-14" name="rest_code_bbc8728aab444da4b67b1450c2a57cff-14" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-27/#rest_code_bbc8728aab444da4b67b1450c2a57cff-14"&gt;&lt;/a&gt;
&lt;a id="rest_code_bbc8728aab444da4b67b1450c2a57cff-15" name="rest_code_bbc8728aab444da4b67b1450c2a57cff-15" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-27/#rest_code_bbc8728aab444da4b67b1450c2a57cff-15"&gt;&lt;/a&gt;
&lt;a id="rest_code_bbc8728aab444da4b67b1450c2a57cff-16" name="rest_code_bbc8728aab444da4b67b1450c2a57cff-16" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-27/#rest_code_bbc8728aab444da4b67b1450c2a57cff-16"&gt;&lt;/a&gt;&lt;span class="n"&gt;N&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;1000000&lt;/span&gt;
&lt;a id="rest_code_bbc8728aab444da4b67b1450c2a57cff-17" name="rest_code_bbc8728aab444da4b67b1450c2a57cff-17" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-27/#rest_code_bbc8728aab444da4b67b1450c2a57cff-17"&gt;&lt;/a&gt;&lt;span class="n"&gt;low&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_bbc8728aab444da4b67b1450c2a57cff-18" name="rest_code_bbc8728aab444da4b67b1450c2a57cff-18" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-27/#rest_code_bbc8728aab444da4b67b1450c2a57cff-18"&gt;&lt;/a&gt;&lt;span class="n"&gt;high&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a id="rest_code_bbc8728aab444da4b67b1450c2a57cff-19" name="rest_code_bbc8728aab444da4b67b1450c2a57cff-19" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-27/#rest_code_bbc8728aab444da4b67b1450c2a57cff-19"&gt;&lt;/a&gt;&lt;span class="n"&gt;rad&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;
&lt;a id="rest_code_bbc8728aab444da4b67b1450c2a57cff-20" name="rest_code_bbc8728aab444da4b67b1450c2a57cff-20" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-27/#rest_code_bbc8728aab444da4b67b1450c2a57cff-20"&gt;&lt;/a&gt;&lt;span class="n"&gt;inte&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;monte_carlo_int&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;circ&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;low&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;high&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;args&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;rad&lt;/span&gt;&lt;span class="p"&gt;,))&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/section&gt;
&lt;section id="julia"&gt;
&lt;h3&gt;Julia&lt;/h3&gt;
&lt;div class="code"&gt;&lt;pre class="code julia"&gt;&lt;a id="rest_code_986a5b04cbf141ef9b7bd4718807dffc-1" name="rest_code_986a5b04cbf141ef9b7bd4718807dffc-1" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-27/#rest_code_986a5b04cbf141ef9b7bd4718807dffc-1"&gt;&lt;/a&gt;&lt;span class="k"&gt;using&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Distributions&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_986a5b04cbf141ef9b7bd4718807dffc-2" name="rest_code_986a5b04cbf141ef9b7bd4718807dffc-2" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-27/#rest_code_986a5b04cbf141ef9b7bd4718807dffc-2"&gt;&lt;/a&gt;
&lt;a id="rest_code_986a5b04cbf141ef9b7bd4718807dffc-3" name="rest_code_986a5b04cbf141ef9b7bd4718807dffc-3" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-27/#rest_code_986a5b04cbf141ef9b7bd4718807dffc-3"&gt;&lt;/a&gt;
&lt;a id="rest_code_986a5b04cbf141ef9b7bd4718807dffc-4" name="rest_code_986a5b04cbf141ef9b7bd4718807dffc-4" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-27/#rest_code_986a5b04cbf141ef9b7bd4718807dffc-4"&gt;&lt;/a&gt;&lt;span class="k"&gt;function&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;monte_carlo_int&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;fun&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;low&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;high&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;args&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_986a5b04cbf141ef9b7bd4718807dffc-5" name="rest_code_986a5b04cbf141ef9b7bd4718807dffc-5" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-27/#rest_code_986a5b04cbf141ef9b7bd4718807dffc-5"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;ndims&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;length&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;low&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_986a5b04cbf141ef9b7bd4718807dffc-6" name="rest_code_986a5b04cbf141ef9b7bd4718807dffc-6" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-27/#rest_code_986a5b04cbf141ef9b7bd4718807dffc-6"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;pts&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;rand&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Uniform&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ndims&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_986a5b04cbf141ef9b7bd4718807dffc-7" name="rest_code_986a5b04cbf141ef9b7bd4718807dffc-7" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-27/#rest_code_986a5b04cbf141ef9b7bd4718807dffc-7"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;for&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;cont&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="n"&gt;ndims&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_986a5b04cbf141ef9b7bd4718807dffc-8" name="rest_code_986a5b04cbf141ef9b7bd4718807dffc-8" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-27/#rest_code_986a5b04cbf141ef9b7bd4718807dffc-8"&gt;&lt;/a&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;pts&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;cont&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;pts&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;cont&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;high&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;cont&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;low&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;cont&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;low&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;cont&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_986a5b04cbf141ef9b7bd4718807dffc-9" name="rest_code_986a5b04cbf141ef9b7bd4718807dffc-9" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-27/#rest_code_986a5b04cbf141ef9b7bd4718807dffc-9"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;end&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_986a5b04cbf141ef9b7bd4718807dffc-10" name="rest_code_986a5b04cbf141ef9b7bd4718807dffc-10" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-27/#rest_code_986a5b04cbf141ef9b7bd4718807dffc-10"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;V&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;prod&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;high&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;low&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_986a5b04cbf141ef9b7bd4718807dffc-11" name="rest_code_986a5b04cbf141ef9b7bd4718807dffc-11" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-27/#rest_code_986a5b04cbf141ef9b7bd4718807dffc-11"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;return&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;V&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;sum&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;fun&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;pts&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;args&lt;/span&gt;&lt;span class="o"&gt;...&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_986a5b04cbf141ef9b7bd4718807dffc-12" name="rest_code_986a5b04cbf141ef9b7bd4718807dffc-12" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-27/#rest_code_986a5b04cbf141ef9b7bd4718807dffc-12"&gt;&lt;/a&gt;&lt;span class="k"&gt;end&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_986a5b04cbf141ef9b7bd4718807dffc-13" name="rest_code_986a5b04cbf141ef9b7bd4718807dffc-13" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-27/#rest_code_986a5b04cbf141ef9b7bd4718807dffc-13"&gt;&lt;/a&gt;
&lt;a id="rest_code_986a5b04cbf141ef9b7bd4718807dffc-14" name="rest_code_986a5b04cbf141ef9b7bd4718807dffc-14" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-27/#rest_code_986a5b04cbf141ef9b7bd4718807dffc-14"&gt;&lt;/a&gt;
&lt;a id="rest_code_986a5b04cbf141ef9b7bd4718807dffc-15" name="rest_code_986a5b04cbf141ef9b7bd4718807dffc-15" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-27/#rest_code_986a5b04cbf141ef9b7bd4718807dffc-15"&gt;&lt;/a&gt;&lt;span class="k"&gt;function&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;circ&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;rad&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_986a5b04cbf141ef9b7bd4718807dffc-16" name="rest_code_986a5b04cbf141ef9b7bd4718807dffc-16" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-27/#rest_code_986a5b04cbf141ef9b7bd4718807dffc-16"&gt;&lt;/a&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;return&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;0.5&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;sign&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.^&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.^&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;rad&lt;/span&gt;&lt;span class="o"&gt;^&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_986a5b04cbf141ef9b7bd4718807dffc-17" name="rest_code_986a5b04cbf141ef9b7bd4718807dffc-17" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-27/#rest_code_986a5b04cbf141ef9b7bd4718807dffc-17"&gt;&lt;/a&gt;&lt;span class="k"&gt;end&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_986a5b04cbf141ef9b7bd4718807dffc-18" name="rest_code_986a5b04cbf141ef9b7bd4718807dffc-18" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-27/#rest_code_986a5b04cbf141ef9b7bd4718807dffc-18"&gt;&lt;/a&gt;
&lt;a id="rest_code_986a5b04cbf141ef9b7bd4718807dffc-19" name="rest_code_986a5b04cbf141ef9b7bd4718807dffc-19" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-27/#rest_code_986a5b04cbf141ef9b7bd4718807dffc-19"&gt;&lt;/a&gt;
&lt;a id="rest_code_986a5b04cbf141ef9b7bd4718807dffc-20" name="rest_code_986a5b04cbf141ef9b7bd4718807dffc-20" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-27/#rest_code_986a5b04cbf141ef9b7bd4718807dffc-20"&gt;&lt;/a&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1000000&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_986a5b04cbf141ef9b7bd4718807dffc-21" name="rest_code_986a5b04cbf141ef9b7bd4718807dffc-21" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-27/#rest_code_986a5b04cbf141ef9b7bd4718807dffc-21"&gt;&lt;/a&gt;&lt;span class="n"&gt;low&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_986a5b04cbf141ef9b7bd4718807dffc-22" name="rest_code_986a5b04cbf141ef9b7bd4718807dffc-22" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-27/#rest_code_986a5b04cbf141ef9b7bd4718807dffc-22"&gt;&lt;/a&gt;&lt;span class="n"&gt;high&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_986a5b04cbf141ef9b7bd4718807dffc-23" name="rest_code_986a5b04cbf141ef9b7bd4718807dffc-23" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-27/#rest_code_986a5b04cbf141ef9b7bd4718807dffc-23"&gt;&lt;/a&gt;&lt;span class="n"&gt;rad&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_986a5b04cbf141ef9b7bd4718807dffc-24" name="rest_code_986a5b04cbf141ef9b7bd4718807dffc-24" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-27/#rest_code_986a5b04cbf141ef9b7bd4718807dffc-24"&gt;&lt;/a&gt;&lt;span class="n"&gt;inte&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;monte_carlo_int&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;circ&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;low&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;high&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;args&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;rad&lt;/span&gt;&lt;span class="p"&gt;,))&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Una de los ejemplos más comunes es el cálculo de &lt;span class="math"&gt;\(\pi\)&lt;/span&gt;, esto se
ilustra en la siguiente animación.&lt;/p&gt;
&lt;img alt="Aproximación de pi usando Monte Carlo." class="align-center" src="https://upload.wikimedia.org/wikipedia/commons/8/84/Pi_30K.gif" style="width: 500px;"&gt;
&lt;/section&gt;
&lt;section id="comparacion-python-julia"&gt;
&lt;h3&gt;Comparación Python/Julia&lt;/h3&gt;
&lt;p&gt;Respecto al número de líneas tenemos: 20 en Python y 24 en Julia.  La comparación
en tiempo de ejecución se realizó con el comando mágico de IPython &lt;code class="docutils literal"&gt;%timeit&lt;/code&gt;
y con &lt;code class="docutils literal"&gt;@benchmark&lt;/code&gt; en Julia.&lt;/p&gt;
&lt;p&gt;Para Python:&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code IPython"&gt;&lt;a id="rest_code_fcf97075793b49ed9cec2ab1925edf52-1" name="rest_code_fcf97075793b49ed9cec2ab1925edf52-1" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-27/#rest_code_fcf97075793b49ed9cec2ab1925edf52-1"&gt;&lt;/a&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="k"&gt;timeit&lt;/span&gt; monte_carlo_int(circ, N, low, high, args=(rad,))
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;con resultado&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code text"&gt;&lt;a id="rest_code_c8fe13fd02a647c18fc3d8d570ca5203-1" name="rest_code_c8fe13fd02a647c18fc3d8d570ca5203-1" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-27/#rest_code_c8fe13fd02a647c18fc3d8d570ca5203-1"&gt;&lt;/a&gt;10 loops, best of 3: 53.2 ms per loop
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Para Julia:&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code julia"&gt;&lt;a id="rest_code_73bd4c4155324b4393064ac0773c566f-1" name="rest_code_73bd4c4155324b4393064ac0773c566f-1" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-27/#rest_code_73bd4c4155324b4393064ac0773c566f-1"&gt;&lt;/a&gt;&lt;span class="nd"&gt;@benchmark&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;monte_carlo_int&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;circ&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;low&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;high&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;args&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;rad&lt;/span&gt;&lt;span class="p"&gt;,))&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;con result&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code julia"&gt;&lt;a id="rest_code_bd554dc75f134069ac0c4384b8a68bce-1" name="rest_code_bd554dc75f134069ac0c4384b8a68bce-1" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-27/#rest_code_bd554dc75f134069ac0c4384b8a68bce-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;BenchmarkTools&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Trial&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_bd554dc75f134069ac0c4384b8a68bce-2" name="rest_code_bd554dc75f134069ac0c4384b8a68bce-2" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-27/#rest_code_bd554dc75f134069ac0c4384b8a68bce-2"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;memory&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;estimate&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="mf"&gt;129.70&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;MiB&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_bd554dc75f134069ac0c4384b8a68bce-3" name="rest_code_bd554dc75f134069ac0c4384b8a68bce-3" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-27/#rest_code_bd554dc75f134069ac0c4384b8a68bce-3"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;allocs&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;estimate&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="mi"&gt;46&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_bd554dc75f134069ac0c4384b8a68bce-4" name="rest_code_bd554dc75f134069ac0c4384b8a68bce-4" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-27/#rest_code_bd554dc75f134069ac0c4384b8a68bce-4"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="o"&gt;--------------&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_bd554dc75f134069ac0c4384b8a68bce-5" name="rest_code_bd554dc75f134069ac0c4384b8a68bce-5" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-27/#rest_code_bd554dc75f134069ac0c4384b8a68bce-5"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;minimum&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;     &lt;/span&gt;&lt;span class="mf"&gt;60.131&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ms&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;5.15&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;GC&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_bd554dc75f134069ac0c4384b8a68bce-6" name="rest_code_bd554dc75f134069ac0c4384b8a68bce-6" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-27/#rest_code_bd554dc75f134069ac0c4384b8a68bce-6"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;median&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="mf"&gt;164.018&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ms&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;55.64&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;GC&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_bd554dc75f134069ac0c4384b8a68bce-7" name="rest_code_bd554dc75f134069ac0c4384b8a68bce-7" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-27/#rest_code_bd554dc75f134069ac0c4384b8a68bce-7"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;mean&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="mf"&gt;204.366&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ms&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;49.50&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;GC&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_bd554dc75f134069ac0c4384b8a68bce-8" name="rest_code_bd554dc75f134069ac0c4384b8a68bce-8" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-27/#rest_code_bd554dc75f134069ac0c4384b8a68bce-8"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;maximum&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;     &lt;/span&gt;&lt;span class="mf"&gt;357.749&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ms&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;64.04&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;GC&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_bd554dc75f134069ac0c4384b8a68bce-9" name="rest_code_bd554dc75f134069ac0c4384b8a68bce-9" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-27/#rest_code_bd554dc75f134069ac0c4384b8a68bce-9"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="o"&gt;--------------&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_bd554dc75f134069ac0c4384b8a68bce-10" name="rest_code_bd554dc75f134069ac0c4384b8a68bce-10" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-27/#rest_code_bd554dc75f134069ac0c4384b8a68bce-10"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;samples&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;          &lt;/span&gt;&lt;span class="mi"&gt;25&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;a id="rest_code_bd554dc75f134069ac0c4384b8a68bce-11" name="rest_code_bd554dc75f134069ac0c4384b8a68bce-11" href="https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-27/#rest_code_bd554dc75f134069ac0c4384b8a68bce-11"&gt;&lt;/a&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;evals&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;sample&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt;     &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;En este caso, podemos decir que el código de Python es alrededor de 3 veces más
rápido que el de Julia.&lt;/p&gt;
&lt;/section&gt;
&lt;/section&gt;</description><category>computación científica</category><category>julia</category><category>métodos numéricos</category><category>monte carlo</category><category>python</category><guid>https://nicoguaro.github.io/es/posts/numerical_challenge/numerical-27/</guid><pubDate>Sat, 28 Oct 2017 02:27:06 GMT</pubDate></item></channel></rss>