<!DOCTYPE html>
<html prefix="" lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width">
<title>Numerical methods challenge: Day 12 | Nicolás' blog</title>
<link href="../../assets/css/all.css" rel="stylesheet" type="text/css">
<link rel="stylesheet" href="//fonts.googleapis.com/css?family=PT+Serif:400,400italic,700%7CPT+Sans:400">
<link rel="alternate" type="application/rss+xml" title="RSS (en)" href="../../rss.xml">
<link rel="alternate" type="application/rss+xml" title="RSS (es)" href="../../es/rss.xml">
<link rel="canonical" href="https://nicoguaro.github.io/posts/numerical-12/">
<!--[if lt IE 9]><script src="../../assets/js/html5.js"></script><![endif]--><meta name="author" content="Nicolás Guarín-Zapata">
<link rel="prev" href="../numerical-11/" title="Numerical methods challenge: Day 11" type="text/html">
<link rel="next" href="../numerical-13/" title="Numerical methods challenge: Day 13" type="text/html">
<meta property="og:site_name" content="Nicolás' blog">
<meta property="og:title" content="Numerical methods challenge: Day 12">
<meta property="og:url" content="https://nicoguaro.github.io/posts/numerical-12/">
<meta property="og:description" content="During October (2017) I will write a program per day for some well-known
numerical methods in both Python and Julia. It is intended to be an exercise
then don't expect the code to be good enough for r">
<meta property="og:type" content="article">
<meta property="article:published_time" content="2017-10-12T15:06:10-05:00">
<meta property="article:tag" content="interpolation">
<meta property="article:tag" content="julia">
<meta property="article:tag" content="numerical methods">
<meta property="article:tag" content="python">
<meta property="article:tag" content="scientific computing">
<link rel="alternate" hreflang="es" href="../../es/posts/numerical-12/">
</head>
<body>
    <a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>
    <!-- Target for toggling the sidebar `.sidebar-checkbox` is for regular
            styles, `#sidebar-checkbox` for behavior. -->
    <input type="checkbox" class="sidebar-checkbox" id="sidebar-checkbox"><!-- Toggleable sidebar --><div class="sidebar" id="sidebar">
        <div class="sidebar-item">
            <p>A reserved <a href="https://getnikola.com" target="_blank">Nikola</a> theme that places the utmost gravity on content with a hidden drawer. Made by <a href="https://twitter.com/mdo" target="_blank">@mdo</a> for Jekyll,
            ported to Nikola by <a href="https://twitter.com/ralsina" target="_blank">@ralsina</a>.</p>
        </div>
        
    <nav id="menu" role="navigation" class="sidebar-nav"><a class="sidebar-nav-item" href="../../pages/about/">About</a>
        <a class="sidebar-nav-item" href="../../index.html">Blog</a>
        <a class="sidebar-nav-item" href="../../pages/preprints-archive/">Preprints</a>
        <a class="sidebar-nav-item" href="../../pages/links/">Links</a>
        <a class="sidebar-nav-item" href="../../archive.html">Archive</a>
        <a class="sidebar-nav-item" href="../../categories/">Tags</a>
        <a class="sidebar-nav-item" href="../../rss.xml">RSS feed</a>
    
    
    </nav>
</div>

    <!-- Wrap is the content to shift when toggling the sidebar. We wrap the
         content to avoid any CSS collisions with our real content. -->
    <div class="wrap">
      <div class="masthead">
        <div class="container">
          
    <h3 id="brand" class="masthead-title">
      <a href="https://nicoguaro.github.io/" title="Nicolás' blog" rel="home">Nicolás' blog</a>
    </h3>

        </div>
      </div>

      <div class="container content" id="content">
        
<article class="post-text h-entry hentry postpage" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="post-title p-name entry-title" itemprop="headline name"><a href="." class="u-url">Numerical methods challenge: Day 12</a></h1>

        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn">Nicolás Guarín-Zapata</span></p>
            <p class="dateline"><a href="." rel="bookmark"><time class="post-date published dt-published" datetime="2017-10-12T15:06:10-05:00" itemprop="datePublished" title="2017-10-12 15:06">2017-10-12 15:06</time></a></p>
                <p class="commentline">
        
    <a href="#disqus_thread" data-disqus-identifier="cache/posts/numerical-12.html">Comments</a>


        </p>
</div>
        

    </header><div class="e-content entry-content" itemprop="articleBody text">
    <div>
<p>During October (2017) I will write a program per day for some well-known
numerical methods in both Python and Julia. It is intended to be an exercise
then don't expect the code to be good enough for real use. Also,
I should mention that I have almost no experience with Julia, so it
probably won't be idiomatic Julia but more Python-like Julia.</p>
<div class="section" id="hermite-interpolation-inverting-vandermonde-matrix">
<h2>Hermite interpolation: Inverting Vandermonde matrix</h2>
<p>Today we are comparing <a class="reference external" href="posts/numerical-11">Lagrange interpolation</a> with
<a class="reference external" href="https://en.wikipedia.org/wiki/Hermite_interpolation">Hermite interpolation</a>.
For this example we are using the
<a class="reference external" href="https://en.wikipedia.org/wiki/Vandermonde_matrix">confluent Vandermonde matrix</a>
<span class="math">\(V\)</span>. The code is based on an <em>old</em> code of mine that is present
in this <a class="reference external" href="https://github.com/nicoguaro/FEM_resources/terpolation/interp.py">repo</a>.</p>
<p>As in the case of Lagrange interpolation we solve the system</p>
<div class="math">
\begin{equation*}
V\mathbf{c} = I
\end{equation*}
</div>
<p>where <span class="math">\(\mathbf{c}\)</span> is the vector of coefficients and <span class="math">\(I\)</span> is
the identity matrix. This method is not stable and should not be used for the computation of higher order
interpolants, even for optimally chosed sampling. It will start failing
around 20 points. A better approach is to use the
<a class="reference external" href="https://en.wikipedia.org/wiki/Lagrange_polynomial#Barycentric_form">barycentric form</a>
of the interpolation.</p>
<p>In the example below we use
<a class="reference external" href="https://en.wikipedia.org/wiki/Chebyshev_nodes">Chebyshev nodes</a>.
The nodes are given by</p>
<div class="math">
\begin{equation*}
x_k = \cos\left(\frac{2k-1}{2n}\pi\right), \quad k = 1, \ldots, n
\end{equation*}
</div>
<p>where <span class="math">\(n\)</span> is the degree of the polynomial.</p>
<p>Following are the codes.</p>
<div class="section" id="python">
<h3>Python</h3>
<pre class="code python"><a name="rest_code_c1dd9e07acb64a269c94080617392b2e-1"></a><span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">division</span><span class="p">,</span> <span class="n">print_function</span>
<a name="rest_code_c1dd9e07acb64a269c94080617392b2e-2"></a><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<a name="rest_code_c1dd9e07acb64a269c94080617392b2e-3"></a><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<a name="rest_code_c1dd9e07acb64a269c94080617392b2e-4"></a>
<a name="rest_code_c1dd9e07acb64a269c94080617392b2e-5"></a>
<a name="rest_code_c1dd9e07acb64a269c94080617392b2e-6"></a><span class="k">def</span> <span class="nf">vander_mat</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<a name="rest_code_c1dd9e07acb64a269c94080617392b2e-7"></a>    <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="rest_code_c1dd9e07acb64a269c94080617392b2e-8"></a>    <span class="n">van</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">n</span><span class="p">,</span> <span class="n">n</span><span class="p">))</span>
<a name="rest_code_c1dd9e07acb64a269c94080617392b2e-9"></a>    <span class="n">power</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">))</span>
<a name="rest_code_c1dd9e07acb64a269c94080617392b2e-10"></a>    <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
<a name="rest_code_c1dd9e07acb64a269c94080617392b2e-11"></a>        <span class="n">van</span><span class="p">[</span><span class="n">row</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="n">row</span><span class="p">]</span><span class="o">**</span><span class="n">power</span>
<a name="rest_code_c1dd9e07acb64a269c94080617392b2e-12"></a>    <span class="k">return</span> <span class="n">van</span>
<a name="rest_code_c1dd9e07acb64a269c94080617392b2e-13"></a>
<a name="rest_code_c1dd9e07acb64a269c94080617392b2e-14"></a>
<a name="rest_code_c1dd9e07acb64a269c94080617392b2e-15"></a><span class="k">def</span> <span class="nf">conf_vander_mat</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<a name="rest_code_c1dd9e07acb64a269c94080617392b2e-16"></a>    <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="rest_code_c1dd9e07acb64a269c94080617392b2e-17"></a>    <span class="n">conf_van</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">2</span><span class="o">*</span><span class="n">n</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">n</span><span class="p">))</span>
<a name="rest_code_c1dd9e07acb64a269c94080617392b2e-18"></a>    <span class="n">power</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">n</span><span class="p">))</span>
<a name="rest_code_c1dd9e07acb64a269c94080617392b2e-19"></a>    <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
<a name="rest_code_c1dd9e07acb64a269c94080617392b2e-20"></a>        <span class="n">conf_van</span><span class="p">[</span><span class="n">row</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="n">row</span><span class="p">]</span><span class="o">**</span><span class="n">power</span>
<a name="rest_code_c1dd9e07acb64a269c94080617392b2e-21"></a>        <span class="n">conf_van</span><span class="p">[</span><span class="n">row</span> <span class="o">+</span> <span class="n">n</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">power</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="n">row</span><span class="p">]</span><span class="o">**</span><span class="p">(</span><span class="n">power</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
<a name="rest_code_c1dd9e07acb64a269c94080617392b2e-22"></a>    <span class="k">return</span> <span class="n">conf_van</span>
<a name="rest_code_c1dd9e07acb64a269c94080617392b2e-23"></a>
<a name="rest_code_c1dd9e07acb64a269c94080617392b2e-24"></a>
<a name="rest_code_c1dd9e07acb64a269c94080617392b2e-25"></a><span class="k">def</span> <span class="nf">inter_coef</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">inter_type</span><span class="o">=</span><span class="s2">"lagrange"</span><span class="p">):</span>
<a name="rest_code_c1dd9e07acb64a269c94080617392b2e-26"></a>    <span class="k">if</span> <span class="n">inter_type</span> <span class="o">==</span> <span class="s2">"lagrange"</span><span class="p">:</span>
<a name="rest_code_c1dd9e07acb64a269c94080617392b2e-27"></a>        <span class="n">vand_mat</span> <span class="o">=</span> <span class="n">vander_mat</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="rest_code_c1dd9e07acb64a269c94080617392b2e-28"></a>    <span class="k">elif</span> <span class="n">inter_type</span> <span class="o">==</span> <span class="s2">"hermite"</span><span class="p">:</span>
<a name="rest_code_c1dd9e07acb64a269c94080617392b2e-29"></a>        <span class="n">vand_mat</span> <span class="o">=</span> <span class="n">conf_vander_mat</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="rest_code_c1dd9e07acb64a269c94080617392b2e-30"></a>    <span class="n">coef</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">vand_mat</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="n">vand_mat</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
<a name="rest_code_c1dd9e07acb64a269c94080617392b2e-31"></a>    <span class="k">return</span> <span class="n">coef</span>
<a name="rest_code_c1dd9e07acb64a269c94080617392b2e-32"></a>
<a name="rest_code_c1dd9e07acb64a269c94080617392b2e-33"></a>
<a name="rest_code_c1dd9e07acb64a269c94080617392b2e-34"></a><span class="k">def</span> <span class="nf">compute_interp</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">x_eval</span><span class="p">,</span> <span class="n">df</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<a name="rest_code_c1dd9e07acb64a269c94080617392b2e-35"></a>    <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="rest_code_c1dd9e07acb64a269c94080617392b2e-36"></a>    <span class="k">if</span> <span class="n">df</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a name="rest_code_c1dd9e07acb64a269c94080617392b2e-37"></a>        <span class="n">coef</span> <span class="o">=</span> <span class="n">inter_coef</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">inter_type</span><span class="o">=</span><span class="s2">"lagrange"</span><span class="p">)</span>
<a name="rest_code_c1dd9e07acb64a269c94080617392b2e-38"></a>    <span class="k">else</span><span class="p">:</span>
<a name="rest_code_c1dd9e07acb64a269c94080617392b2e-39"></a>        <span class="n">coef</span> <span class="o">=</span> <span class="n">inter_coef</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">inter_type</span><span class="o">=</span><span class="s2">"hermite"</span><span class="p">)</span>
<a name="rest_code_c1dd9e07acb64a269c94080617392b2e-40"></a>    <span class="n">f_eval</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">x_eval</span><span class="p">)</span>
<a name="rest_code_c1dd9e07acb64a269c94080617392b2e-41"></a>    <span class="n">nmat</span> <span class="o">=</span> <span class="n">coef</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<a name="rest_code_c1dd9e07acb64a269c94080617392b2e-42"></a>    <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nmat</span><span class="p">):</span>
<a name="rest_code_c1dd9e07acb64a269c94080617392b2e-43"></a>        <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nmat</span><span class="p">):</span>
<a name="rest_code_c1dd9e07acb64a269c94080617392b2e-44"></a>            <span class="k">if</span> <span class="n">col</span> <span class="o">&lt;</span> <span class="n">n</span> <span class="ow">or</span> <span class="n">nmat</span> <span class="o">==</span> <span class="n">n</span><span class="p">:</span>
<a name="rest_code_c1dd9e07acb64a269c94080617392b2e-45"></a>                <span class="n">f_eval</span> <span class="o">+=</span> <span class="n">coef</span><span class="p">[</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">]</span><span class="o">*</span><span class="n">x_eval</span><span class="o">**</span><span class="n">row</span><span class="o">*</span><span class="n">f</span><span class="p">[</span><span class="n">col</span><span class="p">]</span>
<a name="rest_code_c1dd9e07acb64a269c94080617392b2e-46"></a>            <span class="k">else</span><span class="p">:</span>
<a name="rest_code_c1dd9e07acb64a269c94080617392b2e-47"></a>                <span class="n">f_eval</span> <span class="o">+=</span> <span class="n">coef</span><span class="p">[</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">]</span><span class="o">*</span><span class="n">x_eval</span><span class="o">**</span><span class="n">row</span><span class="o">*</span><span class="n">df</span><span class="p">[</span><span class="n">col</span> <span class="o">-</span> <span class="n">n</span><span class="p">]</span>
<a name="rest_code_c1dd9e07acb64a269c94080617392b2e-48"></a>    <span class="k">return</span> <span class="n">f_eval</span>
<a name="rest_code_c1dd9e07acb64a269c94080617392b2e-49"></a>
<a name="rest_code_c1dd9e07acb64a269c94080617392b2e-50"></a>
<a name="rest_code_c1dd9e07acb64a269c94080617392b2e-51"></a>
<a name="rest_code_c1dd9e07acb64a269c94080617392b2e-52"></a>
<a name="rest_code_c1dd9e07acb64a269c94080617392b2e-53"></a><span class="n">n</span> <span class="o">=</span> <span class="mi">7</span>
<a name="rest_code_c1dd9e07acb64a269c94080617392b2e-54"></a><span class="n">x</span> <span class="o">=</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">n</span><span class="p">))</span>
<a name="rest_code_c1dd9e07acb64a269c94080617392b2e-55"></a><span class="n">f</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="mi">25</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<a name="rest_code_c1dd9e07acb64a269c94080617392b2e-56"></a><span class="n">df</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="o">-</span><span class="mi">50</span><span class="o">*</span><span class="n">x</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="mi">25</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>
<a name="rest_code_c1dd9e07acb64a269c94080617392b2e-57"></a><span class="n">x_eval</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">500</span><span class="p">)</span>
<a name="rest_code_c1dd9e07acb64a269c94080617392b2e-58"></a><span class="n">interp_f</span> <span class="o">=</span> <span class="n">compute_interp</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">x_eval</span><span class="p">,</span> <span class="n">df</span><span class="o">=</span><span class="n">df</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<a name="rest_code_c1dd9e07acb64a269c94080617392b2e-59"></a><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_eval</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">x_eval</span><span class="p">))</span>
<a name="rest_code_c1dd9e07acb64a269c94080617392b2e-60"></a><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_eval</span><span class="p">,</span> <span class="n">interp_f</span><span class="p">)</span>
<a name="rest_code_c1dd9e07acb64a269c94080617392b2e-61"></a><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="s2">"."</span><span class="p">)</span>
<a name="rest_code_c1dd9e07acb64a269c94080617392b2e-62"></a><span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">)</span>
<a name="rest_code_c1dd9e07acb64a269c94080617392b2e-63"></a><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre>
</div>
<div class="section" id="julia">
<h3>Julia</h3>
<pre class="code julia"><a name="rest_code_cb4af7c256d84178824e4392e626cc1f-1"></a><span class="k">using</span> <span class="n">PyPlot</span>
<a name="rest_code_cb4af7c256d84178824e4392e626cc1f-2"></a>
<a name="rest_code_cb4af7c256d84178824e4392e626cc1f-3"></a>
<a name="rest_code_cb4af7c256d84178824e4392e626cc1f-4"></a><span class="k">function</span> <span class="n">vander_mat</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="rest_code_cb4af7c256d84178824e4392e626cc1f-5"></a>    <span class="n">n</span> <span class="o">=</span> <span class="n">length</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="rest_code_cb4af7c256d84178824e4392e626cc1f-6"></a>    <span class="n">van</span> <span class="o">=</span> <span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
<a name="rest_code_cb4af7c256d84178824e4392e626cc1f-7"></a>    <span class="n">power</span> <span class="o">=</span> <span class="mi">0</span><span class="o">:</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span>
<a name="rest_code_cb4af7c256d84178824e4392e626cc1f-8"></a>    <span class="k">for</span> <span class="n">row</span> <span class="o">=</span> <span class="mi">1</span><span class="o">:</span><span class="n">n</span>
<a name="rest_code_cb4af7c256d84178824e4392e626cc1f-9"></a>        <span class="n">van</span><span class="p">[</span><span class="n">row</span><span class="p">,</span> <span class="o">:</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="n">row</span><span class="p">]</span><span class="o">.^</span><span class="n">power</span>
<a name="rest_code_cb4af7c256d84178824e4392e626cc1f-10"></a>    <span class="k">end</span>
<a name="rest_code_cb4af7c256d84178824e4392e626cc1f-11"></a>    <span class="k">return</span> <span class="n">van</span>
<a name="rest_code_cb4af7c256d84178824e4392e626cc1f-12"></a><span class="k">end</span>
<a name="rest_code_cb4af7c256d84178824e4392e626cc1f-13"></a>
<a name="rest_code_cb4af7c256d84178824e4392e626cc1f-14"></a>
<a name="rest_code_cb4af7c256d84178824e4392e626cc1f-15"></a><span class="k">function</span> <span class="n">conf_vander_mat</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="rest_code_cb4af7c256d84178824e4392e626cc1f-16"></a>    <span class="n">n</span> <span class="o">=</span> <span class="n">length</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="rest_code_cb4af7c256d84178824e4392e626cc1f-17"></a>    <span class="n">conf_van</span> <span class="o">=</span> <span class="n">zeros</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">n</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">n</span><span class="p">)</span>
<a name="rest_code_cb4af7c256d84178824e4392e626cc1f-18"></a>    <span class="n">power</span> <span class="o">=</span> <span class="mi">0</span><span class="o">:</span><span class="mi">2</span><span class="o">*</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span>
<a name="rest_code_cb4af7c256d84178824e4392e626cc1f-19"></a>    <span class="k">for</span> <span class="n">row</span> <span class="o">=</span> <span class="mi">1</span><span class="o">:</span><span class="n">n</span>
<a name="rest_code_cb4af7c256d84178824e4392e626cc1f-20"></a>        <span class="n">conf_van</span><span class="p">[</span><span class="n">row</span><span class="p">,</span> <span class="o">:</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="n">row</span><span class="p">]</span><span class="o">.^</span><span class="n">power</span>
<a name="rest_code_cb4af7c256d84178824e4392e626cc1f-21"></a>        <span class="n">conf_van</span><span class="p">[</span><span class="n">row</span> <span class="o">+</span> <span class="n">n</span><span class="p">,</span> <span class="o">:</span><span class="p">]</span> <span class="o">=</span> <span class="n">power</span><span class="o">.*</span><span class="n">x</span><span class="p">[</span><span class="n">row</span><span class="p">]</span><span class="o">.^</span><span class="p">(</span><span class="n">power</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
<a name="rest_code_cb4af7c256d84178824e4392e626cc1f-22"></a>    <span class="k">end</span>
<a name="rest_code_cb4af7c256d84178824e4392e626cc1f-23"></a>    <span class="k">return</span> <span class="n">conf_van</span>
<a name="rest_code_cb4af7c256d84178824e4392e626cc1f-24"></a><span class="k">end</span>
<a name="rest_code_cb4af7c256d84178824e4392e626cc1f-25"></a>
<a name="rest_code_cb4af7c256d84178824e4392e626cc1f-26"></a>
<a name="rest_code_cb4af7c256d84178824e4392e626cc1f-27"></a><span class="k">function</span> <span class="n">inter_coef</span><span class="p">(</span><span class="n">x</span><span class="p">;</span> <span class="n">inter_type</span><span class="o">=</span><span class="s">"lagrange"</span><span class="p">)</span>
<a name="rest_code_cb4af7c256d84178824e4392e626cc1f-28"></a>    <span class="k">if</span> <span class="n">inter_type</span> <span class="o">==</span> <span class="s">"lagrange"</span>
<a name="rest_code_cb4af7c256d84178824e4392e626cc1f-29"></a>        <span class="n">vand_mat</span> <span class="o">=</span> <span class="n">vander_mat</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="rest_code_cb4af7c256d84178824e4392e626cc1f-30"></a>    <span class="k">elseif</span> <span class="n">inter_type</span> <span class="o">==</span> <span class="s">"hermite"</span>
<a name="rest_code_cb4af7c256d84178824e4392e626cc1f-31"></a>        <span class="n">vand_mat</span> <span class="o">=</span> <span class="n">conf_vander_mat</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="rest_code_cb4af7c256d84178824e4392e626cc1f-32"></a>    <span class="k">end</span>
<a name="rest_code_cb4af7c256d84178824e4392e626cc1f-33"></a>    <span class="n">coef</span> <span class="o">=</span> <span class="n">vand_mat</span> <span class="o">\</span> <span class="n">eye</span><span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="n">vand_mat</span><span class="p">)[</span><span class="mi">1</span><span class="p">])</span>
<a name="rest_code_cb4af7c256d84178824e4392e626cc1f-34"></a>    <span class="k">return</span> <span class="n">coef</span>
<a name="rest_code_cb4af7c256d84178824e4392e626cc1f-35"></a><span class="k">end</span>
<a name="rest_code_cb4af7c256d84178824e4392e626cc1f-36"></a>
<a name="rest_code_cb4af7c256d84178824e4392e626cc1f-37"></a>
<a name="rest_code_cb4af7c256d84178824e4392e626cc1f-38"></a><span class="k">function</span> <span class="n">compute_interp</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">x_eval</span><span class="p">;</span> <span class="n">df</span><span class="o">=</span><span class="nb">nothing</span><span class="p">)</span>
<a name="rest_code_cb4af7c256d84178824e4392e626cc1f-39"></a>    <span class="n">n</span> <span class="o">=</span> <span class="n">length</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a name="rest_code_cb4af7c256d84178824e4392e626cc1f-40"></a>    <span class="k">if</span> <span class="n">df</span> <span class="o">==</span> <span class="nb">nothing</span>
<a name="rest_code_cb4af7c256d84178824e4392e626cc1f-41"></a>        <span class="n">coef</span> <span class="o">=</span> <span class="n">inter_coef</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">inter_type</span><span class="o">=</span><span class="s">"lagrange"</span><span class="p">)</span>
<a name="rest_code_cb4af7c256d84178824e4392e626cc1f-42"></a>    <span class="k">else</span>
<a name="rest_code_cb4af7c256d84178824e4392e626cc1f-43"></a>        <span class="n">coef</span> <span class="o">=</span> <span class="n">inter_coef</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">inter_type</span><span class="o">=</span><span class="s">"hermite"</span><span class="p">)</span>
<a name="rest_code_cb4af7c256d84178824e4392e626cc1f-44"></a>    <span class="k">end</span>
<a name="rest_code_cb4af7c256d84178824e4392e626cc1f-45"></a>    <span class="n">f_eval</span> <span class="o">=</span> <span class="n">zeros</span><span class="p">(</span><span class="n">x_eval</span><span class="p">)</span>
<a name="rest_code_cb4af7c256d84178824e4392e626cc1f-46"></a>    <span class="n">nmat</span> <span class="o">=</span> <span class="n">size</span><span class="p">(</span><span class="n">coef</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
<a name="rest_code_cb4af7c256d84178824e4392e626cc1f-47"></a>    <span class="k">for</span> <span class="n">row</span> <span class="o">=</span> <span class="mi">1</span><span class="o">:</span><span class="n">nmat</span>
<a name="rest_code_cb4af7c256d84178824e4392e626cc1f-48"></a>        <span class="k">for</span> <span class="n">col</span> <span class="o">=</span> <span class="mi">1</span><span class="o">:</span><span class="n">nmat</span>
<a name="rest_code_cb4af7c256d84178824e4392e626cc1f-49"></a>            <span class="k">if</span> <span class="n">col</span> <span class="o">&lt;=</span> <span class="n">n</span> <span class="o">||</span> <span class="n">nmat</span> <span class="o">==</span> <span class="n">n</span>
<a name="rest_code_cb4af7c256d84178824e4392e626cc1f-50"></a>                <span class="n">f_eval</span> <span class="o">+=</span> <span class="n">coef</span><span class="p">[</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">]</span><span class="o">*</span><span class="n">x_eval</span><span class="o">.^</span><span class="p">(</span><span class="n">row</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">f</span><span class="p">[</span><span class="n">col</span><span class="p">]</span>
<a name="rest_code_cb4af7c256d84178824e4392e626cc1f-51"></a>            <span class="k">else</span>
<a name="rest_code_cb4af7c256d84178824e4392e626cc1f-52"></a>                <span class="n">f_eval</span> <span class="o">+=</span> <span class="n">coef</span><span class="p">[</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">]</span><span class="o">*</span><span class="n">x_eval</span><span class="o">.^</span><span class="p">(</span><span class="n">row</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">df</span><span class="p">[</span><span class="n">col</span> <span class="o">-</span> <span class="n">n</span><span class="p">]</span>
<a name="rest_code_cb4af7c256d84178824e4392e626cc1f-53"></a>            <span class="k">end</span>
<a name="rest_code_cb4af7c256d84178824e4392e626cc1f-54"></a>        <span class="k">end</span>
<a name="rest_code_cb4af7c256d84178824e4392e626cc1f-55"></a>    <span class="k">end</span>
<a name="rest_code_cb4af7c256d84178824e4392e626cc1f-56"></a>    <span class="k">return</span> <span class="n">f_eval</span>
<a name="rest_code_cb4af7c256d84178824e4392e626cc1f-57"></a><span class="k">end</span>
<a name="rest_code_cb4af7c256d84178824e4392e626cc1f-58"></a>
<a name="rest_code_cb4af7c256d84178824e4392e626cc1f-59"></a>
<a name="rest_code_cb4af7c256d84178824e4392e626cc1f-60"></a><span class="n">n</span> <span class="o">=</span> <span class="mi">7</span>
<a name="rest_code_cb4af7c256d84178824e4392e626cc1f-61"></a><span class="n">x</span> <span class="o">=</span> <span class="o">-</span><span class="n">cos</span><span class="o">.</span><span class="p">(</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">pi</span><span class="p">,</span> <span class="n">n</span><span class="p">))</span>
<a name="rest_code_cb4af7c256d84178824e4392e626cc1f-62"></a><span class="n">f</span> <span class="o">=</span> <span class="mf">1.</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="mi">25</span><span class="o">*</span><span class="n">x</span><span class="o">.^</span><span class="mi">2</span><span class="p">)</span>
<a name="rest_code_cb4af7c256d84178824e4392e626cc1f-63"></a><span class="n">df</span> <span class="o">=</span> <span class="o">-</span><span class="mi">50</span><span class="o">*</span><span class="n">x</span><span class="o">./</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="mi">25</span><span class="o">*</span><span class="n">x</span><span class="o">.^</span><span class="mi">2</span><span class="p">)</span><span class="o">.^</span><span class="mi">2</span>
<a name="rest_code_cb4af7c256d84178824e4392e626cc1f-64"></a><span class="n">x_eval</span> <span class="o">=</span> <span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">500</span><span class="p">)</span>
<a name="rest_code_cb4af7c256d84178824e4392e626cc1f-65"></a><span class="n">interp_f</span> <span class="o">=</span> <span class="n">compute_interp</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">x_eval</span><span class="p">,</span> <span class="n">df</span><span class="o">=</span><span class="n">df</span><span class="p">)</span>
<a name="rest_code_cb4af7c256d84178824e4392e626cc1f-66"></a><span class="n">plot</span><span class="p">(</span><span class="n">x_eval</span><span class="p">,</span> <span class="mf">1.</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="mi">25</span><span class="o">*</span><span class="n">x_eval</span><span class="o">.^</span><span class="mi">2</span><span class="p">))</span>
<a name="rest_code_cb4af7c256d84178824e4392e626cc1f-67"></a><span class="n">plot</span><span class="p">(</span><span class="n">x_eval</span><span class="p">,</span> <span class="n">interp_f</span><span class="p">)</span>
<a name="rest_code_cb4af7c256d84178824e4392e626cc1f-68"></a><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="s">"."</span><span class="p">)</span>
<a name="rest_code_cb4af7c256d84178824e4392e626cc1f-69"></a><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">)</span>
<a name="rest_code_cb4af7c256d84178824e4392e626cc1f-70"></a><span class="n">show</span><span class="p">()</span>
</pre>
<p>In both cases the result is the plot below.</p>
<img alt="Hermite interpolation using Vandermonde matrix." class="align-center" src="../../images/hermite_vandermonde.svg" style="width: 500px;"><p>And, if we try with a high <span class="math">\(n\)</span>, say <span class="math">\(n=43\)</span>, we can see the
problems.</p>
<img alt="Hermite interpolation using Vandermonde matrix." class="align-center" src="../../images/hermite_vandermonde-n-23.svg" style="width: 500px;">
</div>
<div class="section" id="comparison-python-julia">
<h3>Comparison Python/Julia</h3>
<p>Regarding number of lines we have: 61 in Python and 70 in Julia. The comparison
in execution time is done with <code class="docutils literal">%%timeit</code> magic command in IPython and
<code class="docutils literal">@benchmark</code> in Julia.</p>
<p>For Python:</p>
<pre class="code IPython"><a name="rest_code_83b41ad0ad40422f987a0a09bec01ca4-1"></a><span class="o">%%time</span>it -n 100
<a name="rest_code_83b41ad0ad40422f987a0a09bec01ca4-2"></a><span class="n">n</span> <span class="o">=</span> <span class="mi">7</span>
<a name="rest_code_83b41ad0ad40422f987a0a09bec01ca4-3"></a><span class="n">x</span> <span class="o">=</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">n</span><span class="p">))</span>
<a name="rest_code_83b41ad0ad40422f987a0a09bec01ca4-4"></a><span class="n">f</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="mi">25</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<a name="rest_code_83b41ad0ad40422f987a0a09bec01ca4-5"></a><span class="n">df</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="o">-</span><span class="mi">50</span><span class="o">*</span><span class="n">x</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="mi">25</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>
<a name="rest_code_83b41ad0ad40422f987a0a09bec01ca4-6"></a><span class="n">x_eval</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">500</span><span class="p">)</span>
<a name="rest_code_83b41ad0ad40422f987a0a09bec01ca4-7"></a><span class="n">interp_f</span> <span class="o">=</span> <span class="n">compute_interp</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">x_eval</span><span class="p">,</span> <span class="n">df</span><span class="o">=</span><span class="n">df</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
</pre>
<p>with result</p>
<pre class="code text"><a name="rest_code_6cbb22ed15c34db5a0f2ebd89f9b049f-1"></a>100 loops, best of 3: 18.1 ms per loop
</pre>
<p>For Julia:</p>
<pre class="code julia"><a name="rest_code_e1faef57cc1c40debb1dfeb1503f85af-1"></a><span class="k">function</span> <span class="n">bench</span><span class="p">()</span>
<a name="rest_code_e1faef57cc1c40debb1dfeb1503f85af-2"></a>   <span class="n">n</span> <span class="o">=</span> <span class="mi">7</span>
<a name="rest_code_e1faef57cc1c40debb1dfeb1503f85af-3"></a>   <span class="n">x</span> <span class="o">=</span> <span class="o">-</span><span class="n">cos</span><span class="o">.</span><span class="p">(</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">pi</span><span class="p">,</span> <span class="n">n</span><span class="p">))</span>
<a name="rest_code_e1faef57cc1c40debb1dfeb1503f85af-4"></a>   <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">=</span> <span class="mf">1.</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="mi">25</span><span class="o">*</span><span class="n">x</span><span class="o">.^</span><span class="mi">2</span><span class="p">)</span>
<a name="rest_code_e1faef57cc1c40debb1dfeb1503f85af-5"></a>   <span class="n">df</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">=</span> <span class="o">-</span><span class="mi">50</span><span class="o">*</span><span class="n">x</span><span class="o">./</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="mi">25</span><span class="o">*</span><span class="n">x</span><span class="o">.^</span><span class="mi">2</span><span class="p">)</span><span class="o">.^</span><span class="mi">2</span>
<a name="rest_code_e1faef57cc1c40debb1dfeb1503f85af-6"></a>   <span class="n">x_eval</span> <span class="o">=</span> <span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">500</span><span class="p">)</span>
<a name="rest_code_e1faef57cc1c40debb1dfeb1503f85af-7"></a>   <span class="n">interp_f</span> <span class="o">=</span> <span class="n">compute_interp</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">x_eval</span><span class="p">,</span> <span class="n">df</span><span class="o">=</span><span class="n">df</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<a name="rest_code_e1faef57cc1c40debb1dfeb1503f85af-8"></a><span class="k">end</span>
<a name="rest_code_e1faef57cc1c40debb1dfeb1503f85af-9"></a><span class="nd">@benchmark</span> <span class="n">bench</span><span class="p">()</span>
</pre>
<p>with result</p>
<pre class="code julia"><a name="rest_code_dbb61e0f7818404a8f967a1fe88a4935-1"></a><span class="n">BenchmarkTools</span><span class="o">.</span><span class="n">Trial</span><span class="o">:</span>
<a name="rest_code_dbb61e0f7818404a8f967a1fe88a4935-2"></a>  <span class="n">memory</span> <span class="n">estimate</span><span class="o">:</span>  <span class="mf">3.13</span> <span class="n">MiB</span>
<a name="rest_code_dbb61e0f7818404a8f967a1fe88a4935-3"></a>  <span class="n">allocs</span> <span class="n">estimate</span><span class="o">:</span>  <span class="mi">836</span>
<a name="rest_code_dbb61e0f7818404a8f967a1fe88a4935-4"></a>  <span class="o">--------------</span>
<a name="rest_code_dbb61e0f7818404a8f967a1fe88a4935-5"></a>  <span class="n">minimum</span> <span class="n">time</span><span class="o">:</span>     <span class="mf">10.318</span> <span class="n">ms</span> <span class="p">(</span><span class="mf">0.00</span><span class="o">%</span> <span class="n">GC</span><span class="p">)</span>
<a name="rest_code_dbb61e0f7818404a8f967a1fe88a4935-6"></a>  <span class="n">median</span> <span class="n">time</span><span class="o">:</span>      <span class="mf">10.449</span> <span class="n">ms</span> <span class="p">(</span><span class="mf">0.00</span><span class="o">%</span> <span class="n">GC</span><span class="p">)</span>
<a name="rest_code_dbb61e0f7818404a8f967a1fe88a4935-7"></a>  <span class="n">mean</span> <span class="n">time</span><span class="o">:</span>        <span class="mf">11.362</span> <span class="n">ms</span> <span class="p">(</span><span class="mf">1.74</span><span class="o">%</span> <span class="n">GC</span><span class="p">)</span>
<a name="rest_code_dbb61e0f7818404a8f967a1fe88a4935-8"></a>  <span class="n">maximum</span> <span class="n">time</span><span class="o">:</span>     <span class="mf">26.646</span> <span class="n">ms</span> <span class="p">(</span><span class="mf">0.00</span><span class="o">%</span> <span class="n">GC</span><span class="p">)</span>
<a name="rest_code_dbb61e0f7818404a8f967a1fe88a4935-9"></a>  <span class="o">--------------</span>
<a name="rest_code_dbb61e0f7818404a8f967a1fe88a4935-10"></a>  <span class="n">samples</span><span class="o">:</span>          <span class="mi">100</span>
<a name="rest_code_dbb61e0f7818404a8f967a1fe88a4935-11"></a>  <span class="n">evals</span><span class="o">/</span><span class="n">sample</span><span class="o">:</span>     <span class="mi">1</span>
</pre>
<p>In this case, we can say that the Python code is roughly as fast as
the Julia one.</p>
</div>
<div class="section" id="comparison-hermite-lagrange-interpolation">
<h3>Comparison Hermite/Lagrange interpolation</h3>
<p>We want to compare Hermite interpolation with Lagrange interpolation for
the same number of degrees of freedom. We use the same function for test
purposes</p>
<div class="math">
\begin{equation*}
f(x) = \frac{1}{1 + 25x^2}
\end{equation*}
</div>
<p>This is the Python code that does that part</p>
<pre class="code Python"><a name="rest_code_f64ffade3d144a1488ebe72c4855df43-1"></a><span class="n">n_dof</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">20</span><span class="p">))</span>
<a name="rest_code_f64ffade3d144a1488ebe72c4855df43-2"></a><span class="n">error_herm</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">19</span><span class="p">)</span>
<a name="rest_code_f64ffade3d144a1488ebe72c4855df43-3"></a><span class="n">error_lag</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">19</span><span class="p">)</span>
<a name="rest_code_f64ffade3d144a1488ebe72c4855df43-4"></a><span class="k">for</span> <span class="n">cont</span><span class="p">,</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">n_dof</span><span class="p">):</span>
<a name="rest_code_f64ffade3d144a1488ebe72c4855df43-5"></a>    <span class="n">f</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="mi">25</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<a name="rest_code_f64ffade3d144a1488ebe72c4855df43-6"></a>    <span class="n">df</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="o">-</span><span class="mi">50</span><span class="o">*</span><span class="n">x</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="mi">25</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>
<a name="rest_code_f64ffade3d144a1488ebe72c4855df43-7"></a>    <span class="n">x</span> <span class="o">=</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">n</span><span class="p">))</span>
<a name="rest_code_f64ffade3d144a1488ebe72c4855df43-8"></a>    <span class="n">x2</span> <span class="o">=</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">n</span><span class="p">))</span>
<a name="rest_code_f64ffade3d144a1488ebe72c4855df43-9"></a>    <span class="n">x_eval</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">500</span><span class="p">)</span>
<a name="rest_code_f64ffade3d144a1488ebe72c4855df43-10"></a>    <span class="n">herm</span> <span class="o">=</span> <span class="n">compute_interp</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">x_eval</span><span class="p">,</span> <span class="n">df</span><span class="o">=</span><span class="n">df</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<a name="rest_code_f64ffade3d144a1488ebe72c4855df43-11"></a>    <span class="n">lag</span> <span class="o">=</span> <span class="n">compute_interp</span><span class="p">(</span><span class="n">x2</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">x2</span><span class="p">),</span> <span class="n">x_eval</span><span class="p">)</span>
<a name="rest_code_f64ffade3d144a1488ebe72c4855df43-12"></a>    <span class="n">fun</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">x_eval</span><span class="p">)</span>
<a name="rest_code_f64ffade3d144a1488ebe72c4855df43-13"></a>    <span class="n">error_herm</span><span class="p">[</span><span class="n">cont</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">fun</span> <span class="o">-</span> <span class="n">herm</span><span class="p">)</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">fun</span><span class="p">)</span>
<a name="rest_code_f64ffade3d144a1488ebe72c4855df43-14"></a>    <span class="n">error_lag</span><span class="p">[</span><span class="n">cont</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">fun</span> <span class="o">-</span> <span class="n">lag</span><span class="p">)</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">fun</span><span class="p">)</span>
<a name="rest_code_f64ffade3d144a1488ebe72c4855df43-15"></a>
<a name="rest_code_f64ffade3d144a1488ebe72c4855df43-16"></a><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">n_dof</span><span class="p">,</span> <span class="n">error_lag</span><span class="p">)</span>
<a name="rest_code_f64ffade3d144a1488ebe72c4855df43-17"></a><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">n_dof</span><span class="p">,</span> <span class="n">error_herm</span><span class="p">)</span>
<a name="rest_code_f64ffade3d144a1488ebe72c4855df43-18"></a><span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">"Number of degrees of freedom"</span><span class="p">)</span>
<a name="rest_code_f64ffade3d144a1488ebe72c4855df43-19"></a><span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">"Relative error"</span><span class="p">)</span>
<a name="rest_code_f64ffade3d144a1488ebe72c4855df43-20"></a><span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s2">"Lagrange"</span><span class="p">,</span> <span class="s2">"Hermite"</span><span class="p">])</span>
<a name="rest_code_f64ffade3d144a1488ebe72c4855df43-21"></a><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre>
<p>And this is the comparison of the relative errors</p>
<img alt="Comparison of errors between Lagrange and Hermite interpolation." class="align-center" src="../../images/hermite_lagrange_error.svg" style="width: 500px;"><p>In general, the Lagrange approximation is closer for this function.</p>
</div>
</div>
</div>
    </div>
    <aside class="postpromonav"><nav><ul itemprop="keywords" class="tags">
<li><a class="tag p-category" href="../../categories/interpolation/" rel="tag">interpolation</a></li>
            <li><a class="tag p-category" href="../../categories/julia/" rel="tag">julia</a></li>
            <li><a class="tag p-category" href="../../categories/numerical-methods/" rel="tag">numerical methods</a></li>
            <li><a class="tag p-category" href="../../categories/python/" rel="tag">python</a></li>
            <li><a class="tag p-category" href="../../categories/scientific-computing/" rel="tag">scientific computing</a></li>
        </ul>
<ul class="pager hidden-print">
<li class="previous">
                <a href="../numerical-11/" rel="prev" title="Numerical methods challenge: Day 11">Previous post</a>
            </li>
            <li class="next">
                <a href="../numerical-13/" rel="next" title="Numerical methods challenge: Day 13">Next post</a>
            </li>
        </ul></nav></aside><section class="comments hidden-print"><h2>Comments</h2>
        
        
        <div id="disqus_thread"></div>
        <script>
        var disqus_shortname ="nicoguaro-github",
            disqus_url="https://nicoguaro.github.io/posts/numerical-12/",
        disqus_title="Numerical methods challenge: Day 12",
        disqus_identifier="cache/posts/numerical-12.html",
        disqus_config = function () {
            this.language = "en";
        };
        (function() {
            var dsq = document.createElement('script'); dsq.async = true;
            dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script><noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a>
</noscript>
    <a href="https://disqus.com" class="dsq-brlink" rel="nofollow">Comments powered by <span class="logo-disqus">Disqus</span></a>


        </section><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML" integrity="sha384-3lJUsx1TJHt7BA4udB5KPnDrlkO8T6J6v/op7ui0BbCjvZ9WqV4Xm6DTP6kQ/iBH" crossorigin="anonymous"></script><script type="text/x-mathjax-config">
        MathJax.Hub.Config({tex2jax: {inlineMath: [['$latex ','$'], ['\\(','\\)']]}});
        </script></article><script>var disqus_shortname="nicoguaro-github";(function(){var a=document.createElement("script");a.async=true;a.src="https://"+disqus_shortname+".disqus.com/count.js";(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(a)}());</script><footer id="footer"><p>Contents © 2021 <a href="mailto:nicoguarin@gmail.com">Nicolás Guarín-Zapata</a> - Powered by <a href="https://getnikola.com" rel="nofollow">Nikola</a> 
<a rel="license" href="http://creativecommons.org/licenses/by/4.0/">
<img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by/4.0/88x31.png"></a></p>
            
        </footer>
</div>
    </div>
    <label for="sidebar-checkbox" class="sidebar-toggle"></label>
    
<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-145359674-1', 'auto');
ga('send', 'pageview');
</script><script src="../../assets/js/all-nocdn.js"></script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates -->
</body>
</html>
