<!DOCTYPE html>
<html prefix="" lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width">
<title>Numerical methods challenge: Day 4 | Nicolás' blog</title>
<link href="../../../assets/css/all.css" rel="stylesheet" type="text/css">
<link rel="stylesheet" href="//fonts.googleapis.com/css?family=PT+Serif:400,400italic,700%7CPT+Sans:400">
<link rel="alternate" type="application/rss+xml" title="RSS (en)" href="../../../rss.xml">
<link rel="alternate" type="application/rss+xml" title="RSS (es)" href="../../../es/rss.xml">
<link rel="canonical" href="https://nicoguaro.github.io/posts/numerical_challenge/numerical-04/">
<!--[if lt IE 9]><script src="../../../assets/js/html5.js"></script><![endif]--><meta name="author" content="Nicolás Guarín-Zapata">
<link rel="prev" href="../numerical-03/" title="Numerical methods challenge: Day 3" type="text/html">
<link rel="next" href="../numerical-05/" title="Numerical methods challenge: Day 5" type="text/html">
<meta property="og:site_name" content="Nicolás' blog">
<meta property="og:title" content="Numerical methods challenge: Day 4">
<meta property="og:url" content="https://nicoguaro.github.io/posts/numerical_challenge/numerical-04/">
<meta property="og:description" content="During October (2017) I will write a program per day for some well-known
numerical methods in both Python and Julia. It is intended to be an exercise
then don't expect the code to be good enough for r">
<meta property="og:type" content="article">
<meta property="article:published_time" content="2017-10-04T21:30:15-05:00">
<meta property="article:tag" content="julia">
<meta property="article:tag" content="numerical methods">
<meta property="article:tag" content="python">
<meta property="article:tag" content="root finding">
<meta property="article:tag" content="scientific computing">
<link rel="alternate" hreflang="es" href="../../../es/posts/numerical_challenge/numerical-04/">
</head>
<body>
    <a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>
    <!-- Target for toggling the sidebar `.sidebar-checkbox` is for regular
            styles, `#sidebar-checkbox` for behavior. -->
    <input type="checkbox" class="sidebar-checkbox" id="sidebar-checkbox"><!-- Toggleable sidebar --><div class="sidebar" id="sidebar">
        <div class="sidebar-item">
            <p>This is my personal website and blog.</p>
        </div>
        
    <nav id="menu" role="navigation" class="sidebar-nav"><a class="sidebar-nav-item" href="../../../pages/about/">About</a>
        <a class="sidebar-nav-item" href="../../../index.html">Blog</a>
        <a class="sidebar-nav-item" href="../../../pages/preprints-archive/">Preprints</a>
        <a class="sidebar-nav-item" href="../../../pages/links/">Links</a>
        <a class="sidebar-nav-item" href="../../../archive.html">Archive</a>
        <a class="sidebar-nav-item" href="../../../categories/">Tags</a>
        <a class="sidebar-nav-item" href="../../../rss.xml">RSS feed</a>
    
    
    </nav>
</div>

    <!-- Wrap is the content to shift when toggling the sidebar. We wrap the
         content to avoid any CSS collisions with our real content. -->
    <div class="wrap">
      <div class="masthead">
        <div class="container">
          
    <h3 id="brand" class="masthead-title">
      <a href="https://nicoguaro.github.io/" title="Nicolás' blog" rel="home">Nicolás' blog</a>
    </h3>

        </div>
      </div>

      <div class="container content" id="content">
        
<article class="post-text h-entry hentry postpage" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="post-title p-name entry-title" itemprop="headline name"><a href="." class="u-url">Numerical methods challenge: Day 4</a></h1>

        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn">Nicolás Guarín-Zapata</span></p>
            <p class="dateline"><a href="." rel="bookmark"><time class="post-date published dt-published" datetime="2017-10-04T21:30:15-05:00" itemprop="datePublished" title="2017-10-04 21:30">2017-10-04 21:30</time></a></p>
                <p class="commentline">
    
    <a href="#disqus_thread" data-disqus-identifier="cache/posts/numerical_challenge/numerical-04.html">Comments</a>


        </p>
</div>
        
        <div class="metadata posttranslations translations">
            <h3 class="posttranslations-intro">Also available in:</h3>
                <p><a href="../../../es/posts/numerical_challenge/numerical-04/" rel="alternate" hreflang="es">Español</a></p>
        </div>

    </header><div class="e-content entry-content" itemprop="articleBody text">
    <p>During October (2017) I will write a program per day for some well-known
numerical methods in both Python and Julia. It is intended to be an exercise
then don't expect the code to be good enough for real use. Also,
I should mention that I have almost no experience with Julia, so it
probably won't be idiomatic Julia but more Python-like Julia.</p>
<section id="newton-s-method-vector-case"><h2>Newton's method: vector case</h2>
<p>Today we have
<a class="reference external" href="https://en.wikipedia.org/wiki/Newton%27s_method">Newton's method</a>
one more time. In this case, the function is vector-valued. This implies
a slight modification over the original post. The new approximation is
computed from the old one using</p>
<div class="math">
\begin{equation*}
\mathbf{x}_k = \mathbf{x}_{k-1} -
    J(\mathbf{x}_k)^{-1} \mathbf{F}(\mathbf{x_k})
\end{equation*}
</div>
<p>where we need to use the Jacobian matrix <span class="math">\(J\)</span>.</p>
<p>We will test the method with the function
<span class="math">\(\mathbf{F}(x, y) = (x + 2y - 2, x^2 + 4x - 4)\)</span>
with solution <span class="math">\(\mathbf{x} = (0, 1)\)</span>.</p>
<p>Following are the codes.</p>
<section id="python"><h3>Python</h3>
<div class="code"><pre class="code python"><a id="rest_code_a2f08ef5f7c34a7f8179484ca306c694-1" name="rest_code_a2f08ef5f7c34a7f8179484ca306c694-1" href="#rest_code_a2f08ef5f7c34a7f8179484ca306c694-1"></a><span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">division</span><span class="p">,</span> <span class="n">print_function</span>
<a id="rest_code_a2f08ef5f7c34a7f8179484ca306c694-2" name="rest_code_a2f08ef5f7c34a7f8179484ca306c694-2" href="#rest_code_a2f08ef5f7c34a7f8179484ca306c694-2"></a><span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="n">array</span>
<a id="rest_code_a2f08ef5f7c34a7f8179484ca306c694-3" name="rest_code_a2f08ef5f7c34a7f8179484ca306c694-3" href="#rest_code_a2f08ef5f7c34a7f8179484ca306c694-3"></a><span class="kn">from</span> <span class="nn">numpy.linalg</span> <span class="kn">import</span> <span class="n">solve</span><span class="p">,</span> <span class="n">norm</span><span class="p">,</span> <span class="n">det</span>
<a id="rest_code_a2f08ef5f7c34a7f8179484ca306c694-4" name="rest_code_a2f08ef5f7c34a7f8179484ca306c694-4" href="#rest_code_a2f08ef5f7c34a7f8179484ca306c694-4"></a>
<a id="rest_code_a2f08ef5f7c34a7f8179484ca306c694-5" name="rest_code_a2f08ef5f7c34a7f8179484ca306c694-5" href="#rest_code_a2f08ef5f7c34a7f8179484ca306c694-5"></a><span class="k">def</span> <span class="nf">newton</span><span class="p">(</span><span class="n">fun</span><span class="p">,</span> <span class="n">jaco</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">niter</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">ftol</span><span class="o">=</span><span class="mf">1e-12</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<a id="rest_code_a2f08ef5f7c34a7f8179484ca306c694-6" name="rest_code_a2f08ef5f7c34a7f8179484ca306c694-6" href="#rest_code_a2f08ef5f7c34a7f8179484ca306c694-6"></a>    <span class="n">msg</span> <span class="o">=</span> <span class="s2">"Maximum number of iterations reached."</span>
<a id="rest_code_a2f08ef5f7c34a7f8179484ca306c694-7" name="rest_code_a2f08ef5f7c34a7f8179484ca306c694-7" href="#rest_code_a2f08ef5f7c34a7f8179484ca306c694-7"></a>    <span class="k">for</span> <span class="n">cont</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">niter</span><span class="p">):</span>
<a id="rest_code_a2f08ef5f7c34a7f8179484ca306c694-8" name="rest_code_a2f08ef5f7c34a7f8179484ca306c694-8" href="#rest_code_a2f08ef5f7c34a7f8179484ca306c694-8"></a>        <span class="n">J</span> <span class="o">=</span> <span class="n">jaco</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a id="rest_code_a2f08ef5f7c34a7f8179484ca306c694-9" name="rest_code_a2f08ef5f7c34a7f8179484ca306c694-9" href="#rest_code_a2f08ef5f7c34a7f8179484ca306c694-9"></a>        <span class="n">f</span> <span class="o">=</span> <span class="n">fun</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a id="rest_code_a2f08ef5f7c34a7f8179484ca306c694-10" name="rest_code_a2f08ef5f7c34a7f8179484ca306c694-10" href="#rest_code_a2f08ef5f7c34a7f8179484ca306c694-10"></a>        <span class="k">if</span> <span class="n">det</span><span class="p">(</span><span class="n">J</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">ftol</span><span class="p">:</span>
<a id="rest_code_a2f08ef5f7c34a7f8179484ca306c694-11" name="rest_code_a2f08ef5f7c34a7f8179484ca306c694-11" href="#rest_code_a2f08ef5f7c34a7f8179484ca306c694-11"></a>            <span class="n">x</span> <span class="o">=</span> <span class="kc">None</span>
<a id="rest_code_a2f08ef5f7c34a7f8179484ca306c694-12" name="rest_code_a2f08ef5f7c34a7f8179484ca306c694-12" href="#rest_code_a2f08ef5f7c34a7f8179484ca306c694-12"></a>            <span class="n">msg</span> <span class="o">=</span> <span class="s2">"Derivative near to zero."</span>
<a id="rest_code_a2f08ef5f7c34a7f8179484ca306c694-13" name="rest_code_a2f08ef5f7c34a7f8179484ca306c694-13" href="#rest_code_a2f08ef5f7c34a7f8179484ca306c694-13"></a>            <span class="k">break</span>
<a id="rest_code_a2f08ef5f7c34a7f8179484ca306c694-14" name="rest_code_a2f08ef5f7c34a7f8179484ca306c694-14" href="#rest_code_a2f08ef5f7c34a7f8179484ca306c694-14"></a>        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
<a id="rest_code_a2f08ef5f7c34a7f8179484ca306c694-15" name="rest_code_a2f08ef5f7c34a7f8179484ca306c694-15" href="#rest_code_a2f08ef5f7c34a7f8179484ca306c694-15"></a>            <span class="nb">print</span><span class="p">(</span><span class="s2">"n: </span><span class="si">{}</span><span class="s2">, x: </span><span class="si">{}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">cont</span><span class="p">,</span> <span class="n">x</span><span class="p">))</span>
<a id="rest_code_a2f08ef5f7c34a7f8179484ca306c694-16" name="rest_code_a2f08ef5f7c34a7f8179484ca306c694-16" href="#rest_code_a2f08ef5f7c34a7f8179484ca306c694-16"></a>        <span class="n">x</span> <span class="o">=</span> <span class="n">x</span> <span class="o">-</span> <span class="n">solve</span><span class="p">(</span><span class="n">J</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
<a id="rest_code_a2f08ef5f7c34a7f8179484ca306c694-17" name="rest_code_a2f08ef5f7c34a7f8179484ca306c694-17" href="#rest_code_a2f08ef5f7c34a7f8179484ca306c694-17"></a>        <span class="k">if</span> <span class="n">norm</span><span class="p">(</span><span class="n">f</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">ftol</span><span class="p">:</span>
<a id="rest_code_a2f08ef5f7c34a7f8179484ca306c694-18" name="rest_code_a2f08ef5f7c34a7f8179484ca306c694-18" href="#rest_code_a2f08ef5f7c34a7f8179484ca306c694-18"></a>            <span class="n">msg</span> <span class="o">=</span> <span class="s2">"Root found with desired accuracy."</span>
<a id="rest_code_a2f08ef5f7c34a7f8179484ca306c694-19" name="rest_code_a2f08ef5f7c34a7f8179484ca306c694-19" href="#rest_code_a2f08ef5f7c34a7f8179484ca306c694-19"></a>            <span class="k">break</span>
<a id="rest_code_a2f08ef5f7c34a7f8179484ca306c694-20" name="rest_code_a2f08ef5f7c34a7f8179484ca306c694-20" href="#rest_code_a2f08ef5f7c34a7f8179484ca306c694-20"></a>    <span class="k">return</span> <span class="n">x</span><span class="p">,</span> <span class="n">msg</span>
<a id="rest_code_a2f08ef5f7c34a7f8179484ca306c694-21" name="rest_code_a2f08ef5f7c34a7f8179484ca306c694-21" href="#rest_code_a2f08ef5f7c34a7f8179484ca306c694-21"></a>
<a id="rest_code_a2f08ef5f7c34a7f8179484ca306c694-22" name="rest_code_a2f08ef5f7c34a7f8179484ca306c694-22" href="#rest_code_a2f08ef5f7c34a7f8179484ca306c694-22"></a>
<a id="rest_code_a2f08ef5f7c34a7f8179484ca306c694-23" name="rest_code_a2f08ef5f7c34a7f8179484ca306c694-23" href="#rest_code_a2f08ef5f7c34a7f8179484ca306c694-23"></a><span class="k">def</span> <span class="nf">fun</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<a id="rest_code_a2f08ef5f7c34a7f8179484ca306c694-24" name="rest_code_a2f08ef5f7c34a7f8179484ca306c694-24" href="#rest_code_a2f08ef5f7c34a7f8179484ca306c694-24"></a>    <span class="k">return</span> <span class="n">array</span><span class="p">([</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">4</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">4</span><span class="p">])</span>
<a id="rest_code_a2f08ef5f7c34a7f8179484ca306c694-25" name="rest_code_a2f08ef5f7c34a7f8179484ca306c694-25" href="#rest_code_a2f08ef5f7c34a7f8179484ca306c694-25"></a>
<a id="rest_code_a2f08ef5f7c34a7f8179484ca306c694-26" name="rest_code_a2f08ef5f7c34a7f8179484ca306c694-26" href="#rest_code_a2f08ef5f7c34a7f8179484ca306c694-26"></a>
<a id="rest_code_a2f08ef5f7c34a7f8179484ca306c694-27" name="rest_code_a2f08ef5f7c34a7f8179484ca306c694-27" href="#rest_code_a2f08ef5f7c34a7f8179484ca306c694-27"></a><span class="k">def</span> <span class="nf">jaco</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<a id="rest_code_a2f08ef5f7c34a7f8179484ca306c694-28" name="rest_code_a2f08ef5f7c34a7f8179484ca306c694-28" href="#rest_code_a2f08ef5f7c34a7f8179484ca306c694-28"></a>    <span class="k">return</span> <span class="n">array</span><span class="p">([</span>
<a id="rest_code_a2f08ef5f7c34a7f8179484ca306c694-29" name="rest_code_a2f08ef5f7c34a7f8179484ca306c694-29" href="#rest_code_a2f08ef5f7c34a7f8179484ca306c694-29"></a>            <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
<a id="rest_code_a2f08ef5f7c34a7f8179484ca306c694-30" name="rest_code_a2f08ef5f7c34a7f8179484ca306c694-30" href="#rest_code_a2f08ef5f7c34a7f8179484ca306c694-30"></a>            <span class="p">[</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">8</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]]])</span>
<a id="rest_code_a2f08ef5f7c34a7f8179484ca306c694-31" name="rest_code_a2f08ef5f7c34a7f8179484ca306c694-31" href="#rest_code_a2f08ef5f7c34a7f8179484ca306c694-31"></a>
<a id="rest_code_a2f08ef5f7c34a7f8179484ca306c694-32" name="rest_code_a2f08ef5f7c34a7f8179484ca306c694-32" href="#rest_code_a2f08ef5f7c34a7f8179484ca306c694-32"></a>
<a id="rest_code_a2f08ef5f7c34a7f8179484ca306c694-33" name="rest_code_a2f08ef5f7c34a7f8179484ca306c694-33" href="#rest_code_a2f08ef5f7c34a7f8179484ca306c694-33"></a><span class="nb">print</span><span class="p">(</span><span class="n">newton</span><span class="p">(</span><span class="n">fun</span><span class="p">,</span> <span class="n">jaco</span><span class="p">,</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">10.0</span><span class="p">]))</span>
</pre></div>
</section><section id="julia"><h3>Julia</h3>
<div class="code"><pre class="code julia"><a id="rest_code_94cb45ea88024114af82831915466b8d-1" name="rest_code_94cb45ea88024114af82831915466b8d-1" href="#rest_code_94cb45ea88024114af82831915466b8d-1"></a><span class="k">function</span><span class="w"> </span><span class="n">newton</span><span class="p">(</span><span class="n">fun</span><span class="p">,</span><span class="w"> </span><span class="n">jaco</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">niter</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span><span class="w"> </span><span class="n">ftol</span><span class="o">=</span><span class="mf">1e-12</span><span class="p">,</span><span class="w"> </span><span class="n">verbose</span><span class="o">=</span><span class="nb">false</span><span class="p">)</span><span class="w"></span>
<a id="rest_code_94cb45ea88024114af82831915466b8d-2" name="rest_code_94cb45ea88024114af82831915466b8d-2" href="#rest_code_94cb45ea88024114af82831915466b8d-2"></a><span class="w">    </span><span class="n">msg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"Maximum number of iterations reached."</span><span class="w"></span>
<a id="rest_code_94cb45ea88024114af82831915466b8d-3" name="rest_code_94cb45ea88024114af82831915466b8d-3" href="#rest_code_94cb45ea88024114af82831915466b8d-3"></a><span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="n">cont</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="n">niter</span><span class="w"></span>
<a id="rest_code_94cb45ea88024114af82831915466b8d-4" name="rest_code_94cb45ea88024114af82831915466b8d-4" href="#rest_code_94cb45ea88024114af82831915466b8d-4"></a><span class="w">        </span><span class="n">J</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">jaco</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w"></span>
<a id="rest_code_94cb45ea88024114af82831915466b8d-5" name="rest_code_94cb45ea88024114af82831915466b8d-5" href="#rest_code_94cb45ea88024114af82831915466b8d-5"></a><span class="w">        </span><span class="n">f</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fun</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w"></span>
<a id="rest_code_94cb45ea88024114af82831915466b8d-6" name="rest_code_94cb45ea88024114af82831915466b8d-6" href="#rest_code_94cb45ea88024114af82831915466b8d-6"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">det</span><span class="p">(</span><span class="n">J</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">ftol</span><span class="w"></span>
<a id="rest_code_94cb45ea88024114af82831915466b8d-7" name="rest_code_94cb45ea88024114af82831915466b8d-7" href="#rest_code_94cb45ea88024114af82831915466b8d-7"></a><span class="w">            </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">nothing</span><span class="w"></span>
<a id="rest_code_94cb45ea88024114af82831915466b8d-8" name="rest_code_94cb45ea88024114af82831915466b8d-8" href="#rest_code_94cb45ea88024114af82831915466b8d-8"></a><span class="w">            </span><span class="n">msg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"Derivative near to zero."</span><span class="w"></span>
<a id="rest_code_94cb45ea88024114af82831915466b8d-9" name="rest_code_94cb45ea88024114af82831915466b8d-9" href="#rest_code_94cb45ea88024114af82831915466b8d-9"></a><span class="w">            </span><span class="k">break</span><span class="w"></span>
<a id="rest_code_94cb45ea88024114af82831915466b8d-10" name="rest_code_94cb45ea88024114af82831915466b8d-10" href="#rest_code_94cb45ea88024114af82831915466b8d-10"></a><span class="w">        </span><span class="k">end</span><span class="w"></span>
<a id="rest_code_94cb45ea88024114af82831915466b8d-11" name="rest_code_94cb45ea88024114af82831915466b8d-11" href="#rest_code_94cb45ea88024114af82831915466b8d-11"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">verbose</span><span class="w"></span>
<a id="rest_code_94cb45ea88024114af82831915466b8d-12" name="rest_code_94cb45ea88024114af82831915466b8d-12" href="#rest_code_94cb45ea88024114af82831915466b8d-12"></a><span class="w">            </span><span class="n">println</span><span class="p">(</span><span class="s">"n: </span><span class="si">$</span><span class="p">(</span><span class="n">cont</span><span class="p">)</span><span class="s">, x: </span><span class="si">$</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="s">"</span><span class="p">)</span><span class="w"></span>
<a id="rest_code_94cb45ea88024114af82831915466b8d-13" name="rest_code_94cb45ea88024114af82831915466b8d-13" href="#rest_code_94cb45ea88024114af82831915466b8d-13"></a><span class="w">        </span><span class="k">end</span><span class="w"></span>
<a id="rest_code_94cb45ea88024114af82831915466b8d-14" name="rest_code_94cb45ea88024114af82831915466b8d-14" href="#rest_code_94cb45ea88024114af82831915466b8d-14"></a><span class="w">        </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">J</span><span class="o">\</span><span class="n">f</span><span class="w"></span>
<a id="rest_code_94cb45ea88024114af82831915466b8d-15" name="rest_code_94cb45ea88024114af82831915466b8d-15" href="#rest_code_94cb45ea88024114af82831915466b8d-15"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">norm</span><span class="p">(</span><span class="n">f</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">ftol</span><span class="w"></span>
<a id="rest_code_94cb45ea88024114af82831915466b8d-16" name="rest_code_94cb45ea88024114af82831915466b8d-16" href="#rest_code_94cb45ea88024114af82831915466b8d-16"></a><span class="w">            </span><span class="n">msg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"Root found with desired accuracy."</span><span class="w"></span>
<a id="rest_code_94cb45ea88024114af82831915466b8d-17" name="rest_code_94cb45ea88024114af82831915466b8d-17" href="#rest_code_94cb45ea88024114af82831915466b8d-17"></a><span class="w">            </span><span class="k">break</span><span class="w"></span>
<a id="rest_code_94cb45ea88024114af82831915466b8d-18" name="rest_code_94cb45ea88024114af82831915466b8d-18" href="#rest_code_94cb45ea88024114af82831915466b8d-18"></a><span class="w">        </span><span class="k">end</span><span class="w"></span>
<a id="rest_code_94cb45ea88024114af82831915466b8d-19" name="rest_code_94cb45ea88024114af82831915466b8d-19" href="#rest_code_94cb45ea88024114af82831915466b8d-19"></a><span class="w">    </span><span class="k">end</span><span class="w"></span>
<a id="rest_code_94cb45ea88024114af82831915466b8d-20" name="rest_code_94cb45ea88024114af82831915466b8d-20" href="#rest_code_94cb45ea88024114af82831915466b8d-20"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">msg</span><span class="w"></span>
<a id="rest_code_94cb45ea88024114af82831915466b8d-21" name="rest_code_94cb45ea88024114af82831915466b8d-21" href="#rest_code_94cb45ea88024114af82831915466b8d-21"></a><span class="k">end</span><span class="w"></span>
<a id="rest_code_94cb45ea88024114af82831915466b8d-22" name="rest_code_94cb45ea88024114af82831915466b8d-22" href="#rest_code_94cb45ea88024114af82831915466b8d-22"></a>
<a id="rest_code_94cb45ea88024114af82831915466b8d-23" name="rest_code_94cb45ea88024114af82831915466b8d-23" href="#rest_code_94cb45ea88024114af82831915466b8d-23"></a>
<a id="rest_code_94cb45ea88024114af82831915466b8d-24" name="rest_code_94cb45ea88024114af82831915466b8d-24" href="#rest_code_94cb45ea88024114af82831915466b8d-24"></a><span class="k">function</span><span class="w"> </span><span class="n">fun</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w"></span>
<a id="rest_code_94cb45ea88024114af82831915466b8d-25" name="rest_code_94cb45ea88024114af82831915466b8d-25" href="#rest_code_94cb45ea88024114af82831915466b8d-25"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">^</span><span class="mi">2</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">4</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">^</span><span class="mi">2</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">4</span><span class="p">]</span><span class="w"></span>
<a id="rest_code_94cb45ea88024114af82831915466b8d-26" name="rest_code_94cb45ea88024114af82831915466b8d-26" href="#rest_code_94cb45ea88024114af82831915466b8d-26"></a><span class="k">end</span><span class="w"></span>
<a id="rest_code_94cb45ea88024114af82831915466b8d-27" name="rest_code_94cb45ea88024114af82831915466b8d-27" href="#rest_code_94cb45ea88024114af82831915466b8d-27"></a>
<a id="rest_code_94cb45ea88024114af82831915466b8d-28" name="rest_code_94cb45ea88024114af82831915466b8d-28" href="#rest_code_94cb45ea88024114af82831915466b8d-28"></a>
<a id="rest_code_94cb45ea88024114af82831915466b8d-29" name="rest_code_94cb45ea88024114af82831915466b8d-29" href="#rest_code_94cb45ea88024114af82831915466b8d-29"></a><span class="k">function</span><span class="w"> </span><span class="n">jaco</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w"></span>
<a id="rest_code_94cb45ea88024114af82831915466b8d-30" name="rest_code_94cb45ea88024114af82831915466b8d-30" href="#rest_code_94cb45ea88024114af82831915466b8d-30"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">[</span><span class="mf">1.0</span><span class="w"> </span><span class="mf">2.0</span><span class="p">;</span><span class="w"></span>
<a id="rest_code_94cb45ea88024114af82831915466b8d-31" name="rest_code_94cb45ea88024114af82831915466b8d-31" href="#rest_code_94cb45ea88024114af82831915466b8d-31"></a><span class="w">            </span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="mi">8</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">]]</span><span class="w"></span>
<a id="rest_code_94cb45ea88024114af82831915466b8d-32" name="rest_code_94cb45ea88024114af82831915466b8d-32" href="#rest_code_94cb45ea88024114af82831915466b8d-32"></a><span class="k">end</span><span class="w"></span>
<a id="rest_code_94cb45ea88024114af82831915466b8d-33" name="rest_code_94cb45ea88024114af82831915466b8d-33" href="#rest_code_94cb45ea88024114af82831915466b8d-33"></a>
<a id="rest_code_94cb45ea88024114af82831915466b8d-34" name="rest_code_94cb45ea88024114af82831915466b8d-34" href="#rest_code_94cb45ea88024114af82831915466b8d-34"></a>
<a id="rest_code_94cb45ea88024114af82831915466b8d-35" name="rest_code_94cb45ea88024114af82831915466b8d-35" href="#rest_code_94cb45ea88024114af82831915466b8d-35"></a><span class="n">println</span><span class="p">(</span><span class="n">newton</span><span class="p">(</span><span class="n">fun</span><span class="p">,</span><span class="w"> </span><span class="n">jaco</span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="mf">1.0</span><span class="p">,</span><span class="w"> </span><span class="mf">10.0</span><span class="p">]))</span><span class="w"></span>
</pre></div>
</section><section id="comparison"><h3>Comparison</h3>
<p>Regarding number of lines we have: 31 in Python and 33 in Julia. The comparison
in execution time is done with <code class="docutils literal">%timeit</code> magic command in IPython and
<code class="docutils literal">@benchmark</code> in Julia.</p>
<p>For Python:</p>
<div class="code"><pre class="code IPython"><a id="rest_code_abab7377bea848e8abb82c2a0c4fcfdf-1" name="rest_code_abab7377bea848e8abb82c2a0c4fcfdf-1" href="#rest_code_abab7377bea848e8abb82c2a0c4fcfdf-1"></a><span class="o">%</span><span class="k">timeit</span> newton(fun, jaco, [1.0, 10.0])
</pre></div>
<p>with result</p>
<div class="code"><pre class="code IPython"><a id="rest_code_d4e325e8b2114a67bd3ab09e6698381a-1" name="rest_code_d4e325e8b2114a67bd3ab09e6698381a-1" href="#rest_code_d4e325e8b2114a67bd3ab09e6698381a-1"></a><span class="mi">1000</span> <span class="n">loops</span><span class="p">,</span> <span class="n">best</span> <span class="n">of</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">284</span> <span class="n">µs</span> <span class="n">per</span> <span class="n">loop</span>
</pre></div>
<p>For Julia:</p>
<div class="code"><pre class="code julia"><a id="rest_code_effbf286153c420d8b418e182f6edf4e-1" name="rest_code_effbf286153c420d8b418e182f6edf4e-1" href="#rest_code_effbf286153c420d8b418e182f6edf4e-1"></a><span class="nd">@benchmark</span><span class="w"> </span><span class="n">newton</span><span class="p">(</span><span class="n">fun</span><span class="p">,</span><span class="w"> </span><span class="n">jaco</span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="mf">1.0</span><span class="p">,</span><span class="w"> </span><span class="mf">10.0</span><span class="p">])</span><span class="w"></span>
</pre></div>
<p>with result</p>
<div class="code"><pre class="code julia"><a id="rest_code_ca1c6e9452fc4bedaf10809b169b436b-1" name="rest_code_ca1c6e9452fc4bedaf10809b169b436b-1" href="#rest_code_ca1c6e9452fc4bedaf10809b169b436b-1"></a><span class="n">BenchmarkTools</span><span class="o">.</span><span class="n">Trial</span><span class="o">:</span><span class="w"></span>
<a id="rest_code_ca1c6e9452fc4bedaf10809b169b436b-2" name="rest_code_ca1c6e9452fc4bedaf10809b169b436b-2" href="#rest_code_ca1c6e9452fc4bedaf10809b169b436b-2"></a><span class="w">  </span><span class="n">memory</span><span class="w"> </span><span class="n">estimate</span><span class="o">:</span><span class="w">  </span><span class="mf">10.44</span><span class="w"> </span><span class="n">KiB</span><span class="w"></span>
<a id="rest_code_ca1c6e9452fc4bedaf10809b169b436b-3" name="rest_code_ca1c6e9452fc4bedaf10809b169b436b-3" href="#rest_code_ca1c6e9452fc4bedaf10809b169b436b-3"></a><span class="w">  </span><span class="n">allocs</span><span class="w"> </span><span class="n">estimate</span><span class="o">:</span><span class="w">  </span><span class="mi">192</span><span class="w"></span>
<a id="rest_code_ca1c6e9452fc4bedaf10809b169b436b-4" name="rest_code_ca1c6e9452fc4bedaf10809b169b436b-4" href="#rest_code_ca1c6e9452fc4bedaf10809b169b436b-4"></a><span class="w">  </span><span class="o">--------------</span><span class="w"></span>
<a id="rest_code_ca1c6e9452fc4bedaf10809b169b436b-5" name="rest_code_ca1c6e9452fc4bedaf10809b169b436b-5" href="#rest_code_ca1c6e9452fc4bedaf10809b169b436b-5"></a><span class="w">  </span><span class="n">minimum</span><span class="w"> </span><span class="n">time</span><span class="o">:</span><span class="w">     </span><span class="mf">6.818</span><span class="w"> </span><span class="n">μs</span><span class="w"> </span><span class="p">(</span><span class="mf">0.00</span><span class="o">%</span><span class="w"> </span><span class="n">GC</span><span class="p">)</span><span class="w"></span>
<a id="rest_code_ca1c6e9452fc4bedaf10809b169b436b-6" name="rest_code_ca1c6e9452fc4bedaf10809b169b436b-6" href="#rest_code_ca1c6e9452fc4bedaf10809b169b436b-6"></a><span class="w">  </span><span class="n">median</span><span class="w"> </span><span class="n">time</span><span class="o">:</span><span class="w">      </span><span class="mf">7.167</span><span class="w"> </span><span class="n">μs</span><span class="w"> </span><span class="p">(</span><span class="mf">0.00</span><span class="o">%</span><span class="w"> </span><span class="n">GC</span><span class="p">)</span><span class="w"></span>
<a id="rest_code_ca1c6e9452fc4bedaf10809b169b436b-7" name="rest_code_ca1c6e9452fc4bedaf10809b169b436b-7" href="#rest_code_ca1c6e9452fc4bedaf10809b169b436b-7"></a><span class="w">  </span><span class="n">mean</span><span class="w"> </span><span class="n">time</span><span class="o">:</span><span class="w">        </span><span class="mf">9.607</span><span class="w"> </span><span class="n">μs</span><span class="w"> </span><span class="p">(</span><span class="mf">16.53</span><span class="o">%</span><span class="w"> </span><span class="n">GC</span><span class="p">)</span><span class="w"></span>
<a id="rest_code_ca1c6e9452fc4bedaf10809b169b436b-8" name="rest_code_ca1c6e9452fc4bedaf10809b169b436b-8" href="#rest_code_ca1c6e9452fc4bedaf10809b169b436b-8"></a><span class="w">  </span><span class="n">maximum</span><span class="w"> </span><span class="n">time</span><span class="o">:</span><span class="w">     </span><span class="mf">2.953</span><span class="w"> </span><span class="n">ms</span><span class="w"> </span><span class="p">(</span><span class="mf">97.40</span><span class="o">%</span><span class="w"> </span><span class="n">GC</span><span class="p">)</span><span class="w"></span>
<a id="rest_code_ca1c6e9452fc4bedaf10809b169b436b-9" name="rest_code_ca1c6e9452fc4bedaf10809b169b436b-9" href="#rest_code_ca1c6e9452fc4bedaf10809b169b436b-9"></a><span class="w">  </span><span class="o">--------------</span><span class="w"></span>
<a id="rest_code_ca1c6e9452fc4bedaf10809b169b436b-10" name="rest_code_ca1c6e9452fc4bedaf10809b169b436b-10" href="#rest_code_ca1c6e9452fc4bedaf10809b169b436b-10"></a><span class="w">  </span><span class="n">samples</span><span class="o">:</span><span class="w">          </span><span class="mi">10000</span><span class="w"></span>
<a id="rest_code_ca1c6e9452fc4bedaf10809b169b436b-11" name="rest_code_ca1c6e9452fc4bedaf10809b169b436b-11" href="#rest_code_ca1c6e9452fc4bedaf10809b169b436b-11"></a><span class="w">  </span><span class="n">evals</span><span class="o">/</span><span class="n">sample</span><span class="o">:</span><span class="w">     </span><span class="mi">4</span><span class="w"></span>
</pre></div>
<p>In this case, we can say that the Python code is roughly 40 times slower
than the Julia one. This is an improvement compared to the previous examples,
where the ratio was around 100. The reason for this "improvement" might be
in the inversion of the Jacobian, that calls a <code class="docutils literal">numpy</code> routine, doing
the weight-lifting for us.</p>
</section></section>
</div>
    <aside class="postpromonav"><nav><ul itemprop="keywords" class="tags">
<li><a class="tag p-category" href="../../../categories/julia/" rel="tag">julia</a></li>
            <li><a class="tag p-category" href="../../../categories/numerical-methods/" rel="tag">numerical methods</a></li>
            <li><a class="tag p-category" href="../../../categories/python/" rel="tag">python</a></li>
            <li><a class="tag p-category" href="../../../categories/root-finding/" rel="tag">root finding</a></li>
            <li><a class="tag p-category" href="../../../categories/scientific-computing/" rel="tag">scientific computing</a></li>
        </ul>
<ul class="pager hidden-print">
<li class="previous">
                <a href="../numerical-03/" rel="prev" title="Numerical methods challenge: Day 3">Previous post</a>
            </li>
            <li class="next">
                <a href="../numerical-05/" rel="next" title="Numerical methods challenge: Day 5">Next post</a>
            </li>
        </ul></nav></aside><section class="comments hidden-print"><h2>Comments</h2>
        
    
        <div id="disqus_thread"></div>
        <script>
        var disqus_shortname ="nicoguaro-github",
            disqus_url="https://nicoguaro.github.io/posts/numerical_challenge/numerical-04/",
        disqus_title="Numerical methods challenge: Day 4",
        disqus_identifier="cache/posts/numerical_challenge/numerical-04.html",
        disqus_config = function () {
            this.language = "en";
        };
        (function() {
            var dsq = document.createElement('script'); dsq.async = true;
            dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script><noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a>
</noscript>
    <a href="https://disqus.com" class="dsq-brlink" rel="nofollow">Comments powered by <span class="logo-disqus">Disqus</span></a>


        </section><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML" integrity="sha384-3lJUsx1TJHt7BA4udB5KPnDrlkO8T6J6v/op7ui0BbCjvZ9WqV4Xm6DTP6kQ/iBH" crossorigin="anonymous"></script><script type="text/x-mathjax-config">
        MathJax.Hub.Config({tex2jax: {inlineMath: [['$latex ','$'], ['\\(','\\)']]}});
        </script></article><script>var disqus_shortname="nicoguaro-github";(function(){var a=document.createElement("script");a.async=true;a.src="https://"+disqus_shortname+".disqus.com/count.js";(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(a)}());</script><footer id="footer"><p><a href="https://creativecommons.org/licenses/by/4.0/" rel="nofollow">CC BY 4.0</a> © 2022 <a href="mailto:nicoguarin@gmail.com">Nicolás Guarín-Zapata</a>- Powered by <a href="https://getnikola.com" rel="nofollow">Nikola</a></p>
            
        </footer>
</div>
    </div>
    <label for="sidebar-checkbox" class="sidebar-toggle"></label>
    
<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-145359674-1', 'auto');
ga('send', 'pageview');
</script><script src="../../../assets/js/all-nocdn.js"></script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates -->
</body>
</html>
